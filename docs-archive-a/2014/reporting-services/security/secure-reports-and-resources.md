---
title: 保護報表和資源的安全 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- security [Reporting Services], reports
- security [Reporting Services], resources
- reports [Reporting Services], security
- confidential reports [Reporting Services]
- resources [Reporting Services], security
ms.assetid: 63cd55c7-fd2a-49e3-a3f8-59eb1a1c6e83
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 6c8eef86da2fe9c7dcc92488a08516a73aa37e92
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87596475"
---
# <a name="secure-reports-and-resources"></a><span data-ttu-id="94192-102">保護報表和資源的安全</span><span class="sxs-lookup"><span data-stu-id="94192-102">Secure Reports and Resources</span></span>
  <span data-ttu-id="94192-103">您可以設定個別報表以及資源的安全性，來控制使用者必須對這些項目擁有的存取權程度。</span><span class="sxs-lookup"><span data-stu-id="94192-103">You can set security for individual reports and resources to control the degree of access that users have to these items.</span></span> <span data-ttu-id="94192-104">依預設，只有屬於 **管理員** 內建群組成員的使用者才可以執行報表、檢視資源、修改屬性及刪除項目。</span><span class="sxs-lookup"><span data-stu-id="94192-104">By default, only users who are members of the **Administrators** built-in group can run reports, view resources, modify properties, and delete the items.</span></span> <span data-ttu-id="94192-105">其他所有使用者都必須具有針對他們所建立的角色指派，好讓他們存取報表或資源。</span><span class="sxs-lookup"><span data-stu-id="94192-105">All other users must have role assignments created for them that allow access to a report or resource.</span></span>  
  
## <a name="role-based-access-to-reports-and-resources"></a><span data-ttu-id="94192-106">以角色為基礎之報表和資源的存取</span><span class="sxs-lookup"><span data-stu-id="94192-106">Role-based Access to Reports and Resources</span></span>  
 <span data-ttu-id="94192-107">若要授與報表和資源的存取權，您可以讓使用者從父資料夾繼承現有的角色指派，或是在項目本身上建立新的角色指派。</span><span class="sxs-lookup"><span data-stu-id="94192-107">To grant access to reports and resources, you can allow users to inherit existing role assignments from a parent folder or create a new role assignment on the item itself.</span></span>  
  
 <span data-ttu-id="94192-108">在大多數情況下，您可能會想要使用從父資料夾繼承而來的權限。</span><span class="sxs-lookup"><span data-stu-id="94192-108">In most cases, you will probably want to use the permissions that are inherited from a parent folder.</span></span> <span data-ttu-id="94192-109">只有在您想要針對不需要知道報表或資源存在的使用者來隱藏報表或資源，或是要提高報表或項目的存取層級時，才應該需要對個別的報表和資源設定安全性。</span><span class="sxs-lookup"><span data-stu-id="94192-109">Setting security on individual reports and resources should only be necessary if you want to hide the report or resource from users who do not need to know that the report or resource exists, or to increase the level of access for a report or item.</span></span> <span data-ttu-id="94192-110">這些目標不會互斥。</span><span class="sxs-lookup"><span data-stu-id="94192-110">These objectives are not mutually exclusive.</span></span> <span data-ttu-id="94192-111">您可以將報表的存取權限制成較小組的使用者，然後提供全部或一部分使用者額外的權限來管理報表。</span><span class="sxs-lookup"><span data-stu-id="94192-111">You can restrict access to a report to a smaller set of users, and provide all or some of them with additional privileges to manage the report.</span></span>  
  
 <span data-ttu-id="94192-112">您可能需要建立多個角色指派來達成目標。</span><span class="sxs-lookup"><span data-stu-id="94192-112">You may need to create multiple role assignments to achieve your objectives.</span></span> <span data-ttu-id="94192-113">例如，假設您有一份報表要讓 Ann 與 Fernando 這兩位使用者，以及 Human Resource Managers 群組能夠存取。</span><span class="sxs-lookup"><span data-stu-id="94192-113">For example, suppose you have a report that you want to make accessible to two users, Ann and Fernando, and to the Human Resource Managers group.</span></span> <span data-ttu-id="94192-114">Ann 與 Fernando 必須能夠管理報表，但是 Human Resource Managers 成員只需要執行報表。</span><span class="sxs-lookup"><span data-stu-id="94192-114">Ann and Fernando must be able to manage the report, but the Human Resource Managers members need only to run it.</span></span> <span data-ttu-id="94192-115">為了配合所有這些使用者，您要建立三個不同的角色指派：一個讓 Ann 成為報表的內容管理員、一個讓 Fernando 成為報表的內容管理員、一個則支援 Human Resource Managers 群組的僅供檢視工作。</span><span class="sxs-lookup"><span data-stu-id="94192-115">To accommodate all of these users, you would create three separate role assignments: one to make Ann a content manager of the report, one to make Fernando a content manager of the report, and one to support view-only tasks for the Human Resource Managers group.</span></span>  
  
 <span data-ttu-id="94192-116">在報表或資源設定安全性之後，即使將項目移至新位置，這些設定值仍會保留在項目。</span><span class="sxs-lookup"><span data-stu-id="94192-116">Once you set security on a report or resource, those settings stay with the item even if you move the item to a new location.</span></span> <span data-ttu-id="94192-117">例如，若您移動僅少數人擁有存取權的報表，即使將報表移至安全性原則較開放的資料夾，報表仍舊僅供這些使用者使用。</span><span class="sxs-lookup"><span data-stu-id="94192-117">For example, if you move a report that only a few people are authorized to access, the report continues to be available to just those users even if you move it to a folder that has a relatively open security policy.</span></span>  
  
## <a name="mitigating-html-injection-attacks-in-a-published-report-or-document"></a><span data-ttu-id="94192-118">減少已發行報表或文件中的 HTML 資料隱碼攻擊</span><span class="sxs-lookup"><span data-stu-id="94192-118">Mitigating HTML Injection Attacks in a Published Report or Document</span></span>  
 <span data-ttu-id="94192-119">在 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]中，會在執行報表之使用者的安全性識別之下處理報表和資源。</span><span class="sxs-lookup"><span data-stu-id="94192-119">In [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], reports and resources are processed under the security identity of the user who is running the report.</span></span> <span data-ttu-id="94192-120">如果報表包含運算式、指令碼、自訂報表項目或自訂組件，則程式碼會在該使用者認證之下執行。</span><span class="sxs-lookup"><span data-stu-id="94192-120">If the report contains expressions, script, custom report items, or custom assemblies, the code runs under the user's credentials.</span></span> <span data-ttu-id="94192-121">如果資源為包含指令碼的 HTML 文件，則當使用者在報表伺服器上開啟該文件時，將會執行該指令碼。</span><span class="sxs-lookup"><span data-stu-id="94192-121">If a resource is an HTML document that contains script, the script will run when the user opens the document on the report server.</span></span> <span data-ttu-id="94192-122">在報表內執行指令碼或程式碼的能力是某些風險層級所隨附的一項強大功能；</span><span class="sxs-lookup"><span data-stu-id="94192-122">The ability to run script or code within a report is a powerful feature that comes with a certain level of risk.</span></span> <span data-ttu-id="94192-123">如果程式碼為惡意程式碼，則報表伺服器及執行報表的使用者很容易受到攻擊。</span><span class="sxs-lookup"><span data-stu-id="94192-123">If the code is malicious, the report server and the user who is running the report are vulnerable to attack.</span></span>  
  
 <span data-ttu-id="94192-124">當您授與以 HTML 形式處理之報表和資源的存取權時，務必要記得報表是在完全信任的模式中處理，而且可能會將潛在的惡意指令碼傳送到用戶端。</span><span class="sxs-lookup"><span data-stu-id="94192-124">When granting access to reports and to resources that are processed as HTML, it is important to remember that reports are processed in full trust and that potentially malicious script might be sent to the client.</span></span> <span data-ttu-id="94192-125">根據瀏覽器設定而定，用戶端將會在瀏覽器中指定的信任層級上執行 HTML。</span><span class="sxs-lookup"><span data-stu-id="94192-125">Depending on browser settings, the client will execute the HTML at the level of trust that is specified in the browser.</span></span>  
  
 <span data-ttu-id="94192-126">您可以採取下列預防措施，以減少執行惡意指令碼的風險：</span><span class="sxs-lookup"><span data-stu-id="94192-126">You can mitigate the risk of running malicious script by taking the following precautions:</span></span>  
  
-   <span data-ttu-id="94192-127">當您決定哪些人可以發行內容到報表伺服器時，要有選擇性；</span><span class="sxs-lookup"><span data-stu-id="94192-127">Be selective when deciding who can publish content to a report server.</span></span> <span data-ttu-id="94192-128">由於存在著發行惡意內容的可能性，所以應該將可以發行內容的使用者限制為少量的受信任使用者。</span><span class="sxs-lookup"><span data-stu-id="94192-128">Because the potential for publishing malicious content exists, you should limit users who can publish content to a small number of trusted users.</span></span>  
  
-   <span data-ttu-id="94192-129">所有發行者都應該避免發行來自未知或未受信任之來源的報表和資源；</span><span class="sxs-lookup"><span data-stu-id="94192-129">All publishers should avoid publishing reports and resources that come from unknown or untrusted sources.</span></span> <span data-ttu-id="94192-130">必要時，請在文字編輯器中開啟檔案，並尋找可疑的指令碼和 URL。</span><span class="sxs-lookup"><span data-stu-id="94192-130">If necessary, open the file in a text editor and look for suspicious script and URLs.</span></span>  
  
## <a name="report-parameters-and-script-injection"></a><span data-ttu-id="94192-131">報表參數和指令碼資料隱碼</span><span class="sxs-lookup"><span data-stu-id="94192-131">Report Parameters and Script Injection</span></span>  
 <span data-ttu-id="94192-132">報表參數會針對整體報表設計和執行提供彈性。</span><span class="sxs-lookup"><span data-stu-id="94192-132">Report Parameters provide flexibility for the overall report design and execution.</span></span> <span data-ttu-id="94192-133">但是，同樣的彈性在某些情況下，可能會遭到攻擊者的引誘攻擊。</span><span class="sxs-lookup"><span data-stu-id="94192-133">However, this same flexibility can, in some cases be used by an attacker in luring attacks.</span></span> <span data-ttu-id="94192-134">若要消除不小心執行惡意指令碼的風險，請只從信任的來源開啟轉譯的報表。</span><span class="sxs-lookup"><span data-stu-id="94192-134">To mitigate the risk of inadvertently running malicious scripts, only open rendered reports from trusted sources.</span></span> <span data-ttu-id="94192-135">建議您考量潛在 HTML 轉譯器指令碼資料隱碼攻擊的下列情況：</span><span class="sxs-lookup"><span data-stu-id="94192-135">It is recommended you consider the following scenario that is a potential HTML Renderer script injection attack:</span></span>  
  
1.  <span data-ttu-id="94192-136">報表包含了具有超連結動作的文字方塊，此動作設定為可能包含惡意文字的參數值。</span><span class="sxs-lookup"><span data-stu-id="94192-136">A report contains a text box with the hyperlink action set to the value of a parameter which could contain malicious text.</span></span>  
  
2.  <span data-ttu-id="94192-137">報表會發行到報表伺服器或者提供給人使用，好讓報表參數值可以從網頁的 URL 加以控制。</span><span class="sxs-lookup"><span data-stu-id="94192-137">The report is published to a report server or otherwise made available in such a way that the report parameter value can be controlled from the URL of a web page.</span></span>  
  
3.  <span data-ttu-id="94192-138">攻擊者會建立網頁或報表伺服器的連結，並以 "javascript：" 格式指定參數的值 \<malicious script here> ，並將該連結傳送給引誘攻擊中的其他人。</span><span class="sxs-lookup"><span data-stu-id="94192-138">An attacker creates a link to the web page or report server specifying the value of the parameter in the form "javascript:\<malicious script here>" and sends that link to someone else in a luring attack.</span></span>  
  
## <a name="mitigating-script-injection-attacks-in-a-hyperlink-in-a-published-report-or-document"></a><span data-ttu-id="94192-139">減少已發行之報表或文件中的超連結內指令碼資料隱碼攻擊</span><span class="sxs-lookup"><span data-stu-id="94192-139">Mitigating Script Injection Attacks in a Hyperlink in a Published Report or Document</span></span>  
 <span data-ttu-id="94192-140">報表可以在報表項目或是部分報表項目的 Action 屬性值中包含內嵌超連結。</span><span class="sxs-lookup"><span data-stu-id="94192-140">Reports can contain embedded hyperlinks in the value of the Action property on a report item or part of a report item.</span></span> <span data-ttu-id="94192-141">當處理報表時，超連結可以繫結至取自外部資料來源的資料。</span><span class="sxs-lookup"><span data-stu-id="94192-141">Hyperlinks can be bound to data that is retrieved from an external data source when the report is processed.</span></span> <span data-ttu-id="94192-142">當惡意使用者修改基礎資料時，超連結可能會遇到指令碼遭人利用的風險。</span><span class="sxs-lookup"><span data-stu-id="94192-142">If a malicious user modifies the underlying data, the hyperlink might be at risk for scripting exploits.</span></span> <span data-ttu-id="94192-143">如果使用者在發行或匯出的報表中按一下連結，惡意指令碼就可能會執行。</span><span class="sxs-lookup"><span data-stu-id="94192-143">If a user clicks the link in the published or exported report, malicious script could run.</span></span>  
  
 <span data-ttu-id="94192-144">若要消除不小心執行惡意指令碼的風險，包括報表中的連結，只能將超連結繫結至信任來源中的資料。</span><span class="sxs-lookup"><span data-stu-id="94192-144">To mitigate the risk of including links in a report that inadvertently run malicious scripts, only bind hyperlinks to data from trusted sources.</span></span> <span data-ttu-id="94192-145">確認查詢結果中的資料以及將資料繫結至超連結的運算式不會建立可能遭到利用的連結。</span><span class="sxs-lookup"><span data-stu-id="94192-145">Verify that data from the query results and the expressions that bind data to hyperlinks do not create links that can be exploited.</span></span> <span data-ttu-id="94192-146">例如，請勿讓超連結根據可串連多個資料集欄位資料的運算式。</span><span class="sxs-lookup"><span data-stu-id="94192-146">For example, do not base a hyperlink on an expression that concatenates data from multiple dataset fields.</span></span> <span data-ttu-id="94192-147">必要時瀏覽至報表，並使用 [檢視原始檔] 來檢查可疑的指令碼和 URL。</span><span class="sxs-lookup"><span data-stu-id="94192-147">If necessary, browse to the report and use "View Source" to check for suspicious scripts and URLs.</span></span>  
  
## <a name="mitigating-sql-injection-attacks-in-a-parameterized-report"></a><span data-ttu-id="94192-148">減少參數化報表中的 SQL 資料隱碼攻擊</span><span class="sxs-lookup"><span data-stu-id="94192-148">Mitigating SQL Injection Attacks in a Parameterized Report</span></span>  
 <span data-ttu-id="94192-149">在任何含有 `String` 類型參數的報表中，請務必使用可用的值清單 (也稱為有效值清單)，並且確認可執行報表的任一使用者只具有檢視報表資料的必要權限。</span><span class="sxs-lookup"><span data-stu-id="94192-149">In any report that includes a parameter of type `String`, be sure to use an available values list (also known as a valid values list) and ensure that any user running the report has only the permissions required to view the data in the report.</span></span> <span data-ttu-id="94192-150">當您將參數定義為 `String` 類型時，使用者會看到一個可接受任何值的文字方塊。</span><span class="sxs-lookup"><span data-stu-id="94192-150">When you define a parameter of type `String`, the user is presented with a text box that can take any value.</span></span> <span data-ttu-id="94192-151">可用的值清單會限制可輸入的值。</span><span class="sxs-lookup"><span data-stu-id="94192-151">An available values list limits the values that can be entered.</span></span> <span data-ttu-id="94192-152">如果報表參數繫結至查詢參數，而且您不要使用可用的值清單，則報表使用者可以在文字方塊中輸入 SQL 語法，如此可能會使您的報表及伺服器暴露在 SQL 資料隱碼攻擊的危險之下。</span><span class="sxs-lookup"><span data-stu-id="94192-152">If the report parameter is tied to a query parameter and you do not use an available values list, it is possible for a report user to type SQL syntax into the text box, potentially opening the report and your server to a SQL injection attack.</span></span> <span data-ttu-id="94192-153">如果使用者的權限足以執行新的 SQL 陳述式，伺服器可能會出現不良的結果。</span><span class="sxs-lookup"><span data-stu-id="94192-153">If the user has sufficient permissions to execute the new SQL statement, it may produce unwanted results on the server.</span></span>  
  
 <span data-ttu-id="94192-154">如果報表參數未繫結至查詢參數，且參數值有包含在報表中，則報表使用者就可以在參數值中輸入運算式語法或 URL，並將報表轉譯為 Excel 或 HTML。</span><span class="sxs-lookup"><span data-stu-id="94192-154">If a report parameter is not tied to a query parameter and the parameter values are included in the report, it is possible for a report user to type expression syntax or a URL into the parameter value and render the report to Excel or HTML.</span></span> <span data-ttu-id="94192-155">如果另一個使用者接著檢視報表並按一下轉譯的參數內容，該使用者可能會不小心執行惡意指令碼或連結。</span><span class="sxs-lookup"><span data-stu-id="94192-155">If another user then views the report and clicks the rendered parameter contents, the user may inadvertently execute the malicious script or link.</span></span>  
  
 <span data-ttu-id="94192-156">若要減輕不小心執行惡意指令碼的風險，請只從信任的來源開啟轉譯的報表。</span><span class="sxs-lookup"><span data-stu-id="94192-156">To mitigate the risk of inadvertently running malicious scripts, open rendered reports only from trusted sources.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="94192-157">在舊版的文件集中，有包含將動態查詢建立為運算式的範例；</span><span class="sxs-lookup"><span data-stu-id="94192-157">In previous releases of the documentation, an example of creating a dynamic query as an expression was included.</span></span> <span data-ttu-id="94192-158">這種查詢類型會產生 SQL 資料隱碼攻擊的弱點，所以不建議使用。</span><span class="sxs-lookup"><span data-stu-id="94192-158">This type of query creates a vulnerability to SQL injection attacks and therefore is not recommended.</span></span>  
  
## <a name="securing-confidential-reports"></a><span data-ttu-id="94192-159">保護機密報表的安全</span><span class="sxs-lookup"><span data-stu-id="94192-159">Securing Confidential Reports</span></span>  
 <span data-ttu-id="94192-160">包含機密資訊的報表應該在資料存取層級受到保護，方法是要求使用者提供存取敏感性資料的認證。</span><span class="sxs-lookup"><span data-stu-id="94192-160">Reports that contain confidential information should be secured at the data-access level, by requiring users to provide credentials to access sensitive data.</span></span> <span data-ttu-id="94192-161">如需詳細資訊，請參閱 [指定報表資料來源的認證及連接資訊](../report-data/specify-credential-and-connection-information-for-report-data-sources.md)。</span><span class="sxs-lookup"><span data-stu-id="94192-161">For more information, see [Specify Credential and Connection Information for Report Data Sources](../report-data/specify-credential-and-connection-information-for-report-data-sources.md).</span></span> <span data-ttu-id="94192-162">您也可以保護資料夾的安全，讓未經授權的使用者無法使用它。</span><span class="sxs-lookup"><span data-stu-id="94192-162">You can also secure a folder to make it inaccessible to unauthorized users.</span></span> <span data-ttu-id="94192-163">如需詳細資訊，請參閱 [保護資料夾的安全](secure-folders.md)。</span><span class="sxs-lookup"><span data-stu-id="94192-163">For more information, see [Secure Folders](secure-folders.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="94192-164">另請參閱</span><span class="sxs-lookup"><span data-stu-id="94192-164">See Also</span></span>  
 <span data-ttu-id="94192-165"> (create-and-manage-role-assignments.md) </span><span class="sxs-lookup"><span data-stu-id="94192-165">(create-and-manage-role-assignments.md)</span></span>   
 <span data-ttu-id="94192-166">[設定報表產生器存取](../report-server/configure-report-builder-access.md) </span><span class="sxs-lookup"><span data-stu-id="94192-166">[Configure Report Builder Access](../report-server/configure-report-builder-access.md) </span></span>  
 <span data-ttu-id="94192-167">[在原生模式報表伺服器上授與權限](granting-permissions-on-a-native-mode-report-server.md) </span><span class="sxs-lookup"><span data-stu-id="94192-167">[Granting Permissions on a Native Mode Report Server](granting-permissions-on-a-native-mode-report-server.md) </span></span>  
 <span data-ttu-id="94192-168">[保護共用資料來源專案的安全](secure-shared-data-source-items.md) </span><span class="sxs-lookup"><span data-stu-id="94192-168">[Secure Shared Data Source Items](secure-shared-data-source-items.md) </span></span>  
 [<span data-ttu-id="94192-169">Store Credentials in a Reporting Services Data Source</span><span class="sxs-lookup"><span data-stu-id="94192-169">Store Credentials in a Reporting Services Data Source</span></span>](../report-data/store-credentials-in-a-reporting-services-data-source.md)  
  
  
