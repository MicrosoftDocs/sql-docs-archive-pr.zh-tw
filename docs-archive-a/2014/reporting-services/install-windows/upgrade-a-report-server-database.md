---
title: 升級報表伺服器資料庫 | Microsoft Docs
ms.custom: ''
ms.date: 08/10/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
helpviewer_keywords:
- upgrading databases
- report server database
- upgrading Reporting Services
ms.assetid: 4091cf87-9d97-4048-a393-67f1f9207401
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 28e382de505781f4155204fcc652d1308dacce76
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87606637"
---
# <a name="upgrade-a-report-server-database"></a><span data-ttu-id="f50f8-102">升級報表伺服器資料庫</span><span class="sxs-lookup"><span data-stu-id="f50f8-102">Upgrade a Report Server Database</span></span>
  <span data-ttu-id="f50f8-103">報表伺服器資料庫為一個或多個報表伺服器執行個體提供了儲存裝置。</span><span class="sxs-lookup"><span data-stu-id="f50f8-103">The report server database provides storage for one or more report server instances.</span></span> <span data-ttu-id="f50f8-104">由於報表伺服器資料庫結構描述可隨著每個新的 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]版本一起變更，所以此資料庫版本必須符合您所使用的報表伺服器執行個體版本。</span><span class="sxs-lookup"><span data-stu-id="f50f8-104">Because the report server database schema can change with each new release of [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], it is required that the database version match the version of the report server instance you are using.</span></span> <span data-ttu-id="f50f8-105">在大多數情況下，報表伺服器資料庫可以自動升級，而不需要您採取特定的動作。</span><span class="sxs-lookup"><span data-stu-id="f50f8-105">In most cases, a report server database can be upgraded automatically with no specific action on your part.</span></span>  
  
 <span data-ttu-id="f50f8-106">**原生模式：** 在 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 原生模式中，報表伺服器資料庫實際上是由兩個預設名稱為 "ReportServer And ReportServerTempDB" 的資料庫所組成。</span><span class="sxs-lookup"><span data-stu-id="f50f8-106">**Native Mode:** In [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Native mode, the report server database is actually comprised of two database that have default names of "ReportServer and ReportServerTempDB".</span></span>  
  
 <span data-ttu-id="f50f8-107">**SharePoint 模式：** 在 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] SharePoint 模式中，報表伺服器資料庫實際上是針對每個服務應用程式實例所建立的資料庫集合 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="f50f8-107">**SharePoint mode:** In [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)][!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] SharePoint mode the report server database is actually a collection of databases that is created for each instance of the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] service application.</span></span>  
  
## <a name="ways-to-upgrade-a-native-mode-report-server-database"></a><span data-ttu-id="f50f8-108">升級原生模式報表伺服器資料庫的方法</span><span class="sxs-lookup"><span data-stu-id="f50f8-108">Ways to Upgrade a Native Mode Report Server Database</span></span>  
 <span data-ttu-id="f50f8-109">下列清單會識別升級報表伺服器資料庫的狀況：</span><span class="sxs-lookup"><span data-stu-id="f50f8-109">The following list identifies the conditions under which a report server database is upgraded:</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="f50f8-110">安裝程式會升級報表伺服器的單一執行個體。</span><span class="sxs-lookup"><span data-stu-id="f50f8-110">Setup upgrades a single instance of a report server.</span></span> <span data-ttu-id="f50f8-111">報表伺服器資料庫結構描述會在服務啟動之後自動升級，而且報表伺服器會判斷此資料庫結構描述是否與伺服器版本不符。</span><span class="sxs-lookup"><span data-stu-id="f50f8-111">The report server database schema is automatically upgraded after service startup and the report server determines that the database schema version does not match the server version.</span></span>  
  
     <span data-ttu-id="f50f8-112">當服務啟動時，報表伺服器會檢查資料庫結構描述版本，以便確認它是否符合伺服器版本。</span><span class="sxs-lookup"><span data-stu-id="f50f8-112">At service startup, the report server checks the database schema version to verify that it matches the server version.</span></span> <span data-ttu-id="f50f8-113">如果資料庫結構描述版本是較舊的版本，它就會自動升級為報表伺服器所需的結構描述版本。</span><span class="sxs-lookup"><span data-stu-id="f50f8-113">If the database schema version is an older version, it is automatically upgraded to the schema version that is required by the report server.</span></span> <span data-ttu-id="f50f8-114">如果您還原或附加舊版的報表伺服器資料庫，自動升級會特別實用。</span><span class="sxs-lookup"><span data-stu-id="f50f8-114">Automatic upgrade is especially useful if you restored or attached an older report server database.</span></span> <span data-ttu-id="f50f8-115">報表伺服器追蹤記錄檔中會輸入一則訊息，表示資料庫結構描述版本已升級。</span><span class="sxs-lookup"><span data-stu-id="f50f8-115">A message is entered in the report server trace log file indicating that the database schema version was upgraded.</span></span>  
  
-   <span data-ttu-id="f50f8-116">當您選取要搭配新的報表伺服器執行個體使用的舊版時， [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 組態管理員會升級本機或遠端報表伺服器資料庫。</span><span class="sxs-lookup"><span data-stu-id="f50f8-116">The [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration Manager upgrades a local or remote report server database when you select an older version to use with a newer report server instance.</span></span> <span data-ttu-id="f50f8-117">若為上述情況，您就必須在升級動作發生之前先進行確認。</span><span class="sxs-lookup"><span data-stu-id="f50f8-117">In this case, you must confirm the upgrade action before it happens.</span></span>  
  
     <span data-ttu-id="f50f8-118">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 組態管理員不再提供個別的 [升級] 按鈕或升級指令碼。</span><span class="sxs-lookup"><span data-stu-id="f50f8-118">The [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration Manager no longer provides a separate Upgrade button or upgrade script.</span></span> <span data-ttu-id="f50f8-119">這些功能從 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 開始已過時，因為報表伺服器服務有自動升級功能。</span><span class="sxs-lookup"><span data-stu-id="f50f8-119">Those features are obsolete starting with [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] due to the automatic upgrade feature of the Report Server service.</span></span>  
  
 <span data-ttu-id="f50f8-120">在更新結構描述之後，便無法將此項升級回復成先前的版本。</span><span class="sxs-lookup"><span data-stu-id="f50f8-120">After the schema is updated, you cannot rollback the upgrade to an earlier version.</span></span> <span data-ttu-id="f50f8-121">一定要備份報表伺服器資料庫，以防之後需要重新建立先前的安裝。</span><span class="sxs-lookup"><span data-stu-id="f50f8-121">Always backup the report server database in case you need to recreate a previous installation.</span></span>  
  
## <a name="how-the-schema-metadata-and-report-server-content-is-updated"></a><span data-ttu-id="f50f8-122">如何升級結構描述、中繼資料和報表伺服器內容</span><span class="sxs-lookup"><span data-stu-id="f50f8-122">How the Schema, Metadata, and Report Server Content is Updated</span></span>  
 <span data-ttu-id="f50f8-123">報表伺服器資料庫的升級作業共分三個階段：</span><span class="sxs-lookup"><span data-stu-id="f50f8-123">The report server database is upgraded in three stages:</span></span>  
  
1.  <span data-ttu-id="f50f8-124">在安裝和服務啟動之後，或是當您在舊版 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 組態管理員中選取 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 原生模式報表伺服器資料庫時，結構描述會自動升級。</span><span class="sxs-lookup"><span data-stu-id="f50f8-124">The schema is upgraded automatically after setup and service startup, or when you select a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native mode report server database in the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration Manager that is an older version.</span></span> <span data-ttu-id="f50f8-125">此外，報表伺服器服務會在啟動時檢查資料庫版本。</span><span class="sxs-lookup"><span data-stu-id="f50f8-125">In addition, the Report Server service checks the database version at startup.</span></span> <span data-ttu-id="f50f8-126">如果報表伺服器連接到舊版的資料庫，報表伺服器將會在啟動時更新此資料庫。</span><span class="sxs-lookup"><span data-stu-id="f50f8-126">If the report server is connected to a database that is an earlier version, the report server will update the database during startup.</span></span>  
  
2.  <span data-ttu-id="f50f8-127">安全性描述項會在更新結構描述之後第一次使用報表伺服器資料庫時升級。</span><span class="sxs-lookup"><span data-stu-id="f50f8-127">Security descriptors are upgraded on first use of the report server database after the schema is updated.</span></span>  
  
3.  <span data-ttu-id="f50f8-128">已發行的報表和已編譯的報表快照集都在第一次使用時升級。</span><span class="sxs-lookup"><span data-stu-id="f50f8-128">Published reports and compiled report snapshots are updated on first use.</span></span> <span data-ttu-id="f50f8-129">如需詳細資訊，請參閱 [Upgrade Reports](upgrade-reports.md)。</span><span class="sxs-lookup"><span data-stu-id="f50f8-129">For more information, see [Upgrade Reports](upgrade-reports.md).</span></span>  
  
 <span data-ttu-id="f50f8-130">除了報表伺服器資料庫之外，報表伺服器也使用暫存資料庫。</span><span class="sxs-lookup"><span data-stu-id="f50f8-130">In addition to the report server database, a report server also uses a temporary database.</span></span> <span data-ttu-id="f50f8-131">當您升級報表伺服器資料庫時，會自動升級暫存資料庫。</span><span class="sxs-lookup"><span data-stu-id="f50f8-131">The temporary database is upgraded automatically when you upgrade the report server database.</span></span>  
  
## <a name="permissions-required-to-upgrade-a-report-server-database"></a><span data-ttu-id="f50f8-132">升級報表伺服器資料庫所需的權限</span><span class="sxs-lookup"><span data-stu-id="f50f8-132">Permissions required to upgrade a Report Server Database</span></span>  
 <span data-ttu-id="f50f8-133">如果您正在升級的 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 安裝包含報表伺服器資料庫，則當執行資料庫升級時具備的權限不足時，您可能會看到錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="f50f8-133">If you are upgrading a [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] installation that includes a report server database, you may see an error message if the database upgrade is performed with insufficient permissions.</span></span> <span data-ttu-id="f50f8-134">依預設，安裝程式會使用執行安裝程式之使用者的安全性 Token，以連接到遠端 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體並更新結構描述。</span><span class="sxs-lookup"><span data-stu-id="f50f8-134">By default, Setup uses the security token of the user who is running the Setup program to connect to the remote [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance and update the schema.</span></span> <span data-ttu-id="f50f8-135">如果您在主控報表伺服器資料庫的資料庫伺服器上擁有 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **系統管理員**權限，則資料庫升級將會成功。</span><span class="sxs-lookup"><span data-stu-id="f50f8-135">If you have [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **sysadmin** permissions on the database server that hosts the report server databases, the database upgrade will succeed.</span></span> <span data-ttu-id="f50f8-136">同樣地，如果您從命令提示字元執行安裝程式，並為具有修改遠端電腦結構描述之 **系統管理員** 權限的帳戶指定 RSUPGRADEDATABASEACCOUNT 和 RSUPGRADEPASSWORD 引數，資料庫升級將會成功。</span><span class="sxs-lookup"><span data-stu-id="f50f8-136">Similarly, if you run Setup from the command prompt and specify the RSUPGRADEDATABASEACCOUNT and RSUPGRADEPASSWORD arguments for an account that has **sysadmin** permission to modify the schema on the remote computer, the database upgrade will succeed.</span></span>  
  
 <span data-ttu-id="f50f8-137">然而，如果您沒有遠端電腦之資料庫的 **系統管理員** 權限，則連線會遭到拒絕，並傳回下列錯誤：</span><span class="sxs-lookup"><span data-stu-id="f50f8-137">However, if you do not have **sysadmin** permission to the database on the remote computer, the connection will be refused with the following error:</span></span>  
  
 `"Setup was not able to upgrade the report server database schema. You must update the database schema manually after setup is finished. To update the schema, run the Reporting Services Configuration Manager, open the Database Setup page, re-select the database, and click Apply. The database will be upgraded automatically."`  
  
 <span data-ttu-id="f50f8-138">在此時，報表伺服器程式檔案將會升級，但報表伺服器資料庫則為舊版格式。</span><span class="sxs-lookup"><span data-stu-id="f50f8-138">At this point, the report server program files will be upgraded, but the report server database will be in the format of the previous version.</span></span> <span data-ttu-id="f50f8-139">在您手動升級資料庫來完成升級程序之前，將無法使用此報表伺服器。</span><span class="sxs-lookup"><span data-stu-id="f50f8-139">The report server will be unavailable until you finish the upgrade process by upgrading the database manually.</span></span>  
  
#### <a name="to-upgrade-a-native-mode-database-with-scripts"></a><span data-ttu-id="f50f8-140">若要使用指令碼升級原生模式資料庫</span><span class="sxs-lookup"><span data-stu-id="f50f8-140">To upgrade a Native Mode database With Scripts</span></span>  
 <span data-ttu-id="f50f8-141">您可以使用 WMI 指令碼來升級報表伺服器資料庫。</span><span class="sxs-lookup"><span data-stu-id="f50f8-141">You can use WMI scripts to upgrade a report server database.</span></span> <span data-ttu-id="f50f8-142">如需詳細資訊，請參閱 [GenerateDatabaseUpgradeScript 方法 &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabaseupgradescript.md)</span><span class="sxs-lookup"><span data-stu-id="f50f8-142">For more information, see [GenerateDatabaseUpgradeScript Method &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabaseupgradescript.md)</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f50f8-143">另請參閱</span><span class="sxs-lookup"><span data-stu-id="f50f8-143">See Also</span></span>  
 <span data-ttu-id="f50f8-144">[Reporting Services 組態管理員 &#40;原生模式&#41;](../../sql-server/install/reporting-services-configuration-manager-native-mode.md) </span><span class="sxs-lookup"><span data-stu-id="f50f8-144">[Reporting Services Configuration Manager &#40;Native Mode&#41;](../../sql-server/install/reporting-services-configuration-manager-native-mode.md) </span></span>  
 <span data-ttu-id="f50f8-145">[建立 &#40;SSRS Configuration Manager 的報表伺服器資料庫&#41;](../../sql-server/install/create-a-report-server-database-ssrs-configuration-manager.md) </span><span class="sxs-lookup"><span data-stu-id="f50f8-145">[Create a Report Server Database  &#40;SSRS Configuration Manager&#41;](../../sql-server/install/create-a-report-server-database-ssrs-configuration-manager.md) </span></span>  
 <span data-ttu-id="f50f8-146">[&#40;SSRS 原生模式的變更資料庫 Wizard&#41;](../../sql-server/install/change-database-wizard-ssrs-native-mode.md) </span><span class="sxs-lookup"><span data-stu-id="f50f8-146">[Change Database Wizard &#40;SSRS Native Mode&#41;](../../sql-server/install/change-database-wizard-ssrs-native-mode.md) </span></span>  
 <span data-ttu-id="f50f8-147">[升級和移轉 Reporting Services](upgrade-and-migrate-reporting-services.md) </span><span class="sxs-lookup"><span data-stu-id="f50f8-147">[Upgrade and Migrate Reporting Services](upgrade-and-migrate-reporting-services.md) </span></span>  
 [<span data-ttu-id="f50f8-148">遷移 Reporting Services 安裝 &#40;原生模式&#41;</span><span class="sxs-lookup"><span data-stu-id="f50f8-148">Migrate a Reporting Services Installation &#40;Native Mode&#41;</span></span>](migrate-a-reporting-services-installation-native-mode.md)  
  
  
