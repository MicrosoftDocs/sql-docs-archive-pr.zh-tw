---
title: 在網路負載平衡叢集上設定報表伺服器 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- report servers [Reporting Services], network load balancing
ms.assetid: 6bfa5698-de65-43c3-b940-044f41c162d3
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 5de36ab620db63294d2a5ec98fad6c45af201d26
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87597606"
---
# <a name="configure-a-report-server-on-a-network-load-balancing-cluster"></a><span data-ttu-id="74575-102">在網路負載平衡叢集上設定報表伺服器</span><span class="sxs-lookup"><span data-stu-id="74575-102">Configure a Report Server on a Network Load Balancing Cluster</span></span>
  <span data-ttu-id="74575-103">如果您要將報表伺服器向外延展設定為在網路負載平衡 (NLB) 叢集上執行，就必須進行下列動作：</span><span class="sxs-lookup"><span data-stu-id="74575-103">If you are configuring a report server scale-out to run on a Network Load Balancing (NLB) cluster, you must do the following:</span></span>  
  
-   <span data-ttu-id="74575-104">確定此 NLB 叢集可透過對應至虛擬伺服器 IP 位址的虛擬伺服器名稱存取。</span><span class="sxs-lookup"><span data-stu-id="74575-104">Ensure that the NLB cluster is accessible through a virtual server name that maps to the virtual server IP address.</span></span> <span data-ttu-id="74575-105">虛擬伺服器名稱是必要的項目，如此您才能夠設定 NLB 叢集的單一進入點。</span><span class="sxs-lookup"><span data-stu-id="74575-105">A virtual server name is necessary so that you can configure a single point of entry to the NLB cluster.</span></span> <span data-ttu-id="74575-106">當您針對每個報表伺服器執行個體設定 URL 時，就會將此虛擬伺服器名稱指定為主機。</span><span class="sxs-lookup"><span data-stu-id="74575-106">When you configure a URL for each report server instance, you will specify the virtual server name as the host.</span></span>  
  
-   <span data-ttu-id="74575-107">設定檢視狀態驗證，以便支援互動式報表檢視。</span><span class="sxs-lookup"><span data-stu-id="74575-107">Configure view state validation to support interactive report viewing.</span></span> <span data-ttu-id="74575-108">為了回應使用者動作，互動式報表通常會在單一使用者工作階段期間轉譯許多次，以便視覺化全新或不同的資料。</span><span class="sxs-lookup"><span data-stu-id="74575-108">Interactive reports are typically rendered numerous times during a single user session to visualize new or different data in response to user actions.</span></span> <span data-ttu-id="74575-109">透過設定檢視狀態驗證，不論哪一個報表伺服器服務實際的要求，接近程度都會保留在使用者工作階段中。</span><span class="sxs-lookup"><span data-stu-id="74575-109">By configuring view state validation, continuity is preserved within the user session regardless of which report server services the actual request.</span></span>  
  
 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] <span data-ttu-id="74575-110">不會提供用於向外延展部署的負載平衡或是用於透過共用 URL 定義單一存取點的功能。</span><span class="sxs-lookup"><span data-stu-id="74575-110">does not provide functionality for load balancing a scale-out deployment or for defining a single point of access through a shared URL.</span></span> <span data-ttu-id="74575-111">您必須實作個別的軟體或硬體 NLB 叢集方案，以便支援 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 向外延展部署。</span><span class="sxs-lookup"><span data-stu-id="74575-111">You must implement a separate software or hardware NLB cluster solution to support a [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] scale-out deployment.</span></span>  
  
 <span data-ttu-id="74575-112">您可以將 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 安裝在已經屬於 NLB 叢集之一部分的節點上，也可以先設定向外延展部署，然後再安裝叢集軟體。</span><span class="sxs-lookup"><span data-stu-id="74575-112">You can install [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] on nodes that are already part of an NLB cluster, or you can configure a scale-out deployment first and then install cluster software.</span></span>  
  
## <a name="steps-for-report-server-deployment-on-an-nlb-cluster"></a><span data-ttu-id="74575-113">在 NLB 叢集上部署報表伺服器的步驟</span><span class="sxs-lookup"><span data-stu-id="74575-113">Steps for Report Server Deployment on an NLB Cluster</span></span>  
 <span data-ttu-id="74575-114">您可以使用下列指導方針來安裝和設定部署：</span><span class="sxs-lookup"><span data-stu-id="74575-114">Use the following guidelines to install and configure your deployment:</span></span>  
  
|<span data-ttu-id="74575-115">步驟</span><span class="sxs-lookup"><span data-stu-id="74575-115">Step</span></span>|<span data-ttu-id="74575-116">描述</span><span class="sxs-lookup"><span data-stu-id="74575-116">Description</span></span>|<span data-ttu-id="74575-117">詳細資訊</span><span class="sxs-lookup"><span data-stu-id="74575-117">More information</span></span>|  
|----------|-----------------|----------------------|  
|<span data-ttu-id="74575-118">1</span><span class="sxs-lookup"><span data-stu-id="74575-118">1</span></span>|<span data-ttu-id="74575-119">在 NLB 叢集的伺服器節點上安裝 Reporting Services 之前，請先檢查向外延展部署的需求。</span><span class="sxs-lookup"><span data-stu-id="74575-119">Before you install Reporting Services on server nodes in an NLB cluster, check the requirements for scale-out deployment.</span></span>|<span data-ttu-id="74575-120">[設定原生模式報表伺服器向外延展部署 &#40;SSRS Configuration Manager&#41;](../install-windows/configure-a-native-mode-report-server-scale-out-deployment.md) [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]線上叢書</span><span class="sxs-lookup"><span data-stu-id="74575-120">[Configure a Native Mode Report Server Scale-Out Deployment &#40;SSRS Configuration Manager&#41;](../install-windows/configure-a-native-mode-report-server-scale-out-deployment.md) [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Books Online</span></span>|  
|<span data-ttu-id="74575-121">2</span><span class="sxs-lookup"><span data-stu-id="74575-121">2</span></span>|<span data-ttu-id="74575-122">設定 NLB 叢集並確認它是否正常運作。</span><span class="sxs-lookup"><span data-stu-id="74575-122">Configure the NLB cluster and verify it is working correctly.</span></span><br /><br /> <span data-ttu-id="74575-123">請務必將主機標頭名稱對應至 NLB 叢集的虛擬伺服器 IP。</span><span class="sxs-lookup"><span data-stu-id="74575-123">Be sure to map a host header name to the virtual server IP of the NLB cluster.</span></span> <span data-ttu-id="74575-124">此主機標頭名稱會用於報表伺服器 URL 中，而且比 IP 位址更容易記得和輸入。</span><span class="sxs-lookup"><span data-stu-id="74575-124">The host header name is used in the report server URL, and is easier to remember and type than an IP address.</span></span>|<span data-ttu-id="74575-125">如需詳細資訊，請參閱 Windows Server 產品文件集來了解您所執行的 Windows 作業系統版本。</span><span class="sxs-lookup"><span data-stu-id="74575-125">For more information, see the Windows Server product documentation for the version of the Windows operating system that you run.</span></span>|  
|<span data-ttu-id="74575-126">3</span><span class="sxs-lookup"><span data-stu-id="74575-126">3</span></span>|<span data-ttu-id="74575-127">將主機標頭的 NetBIOS 和完整網域名稱 (FQDN) 加入至 Windows 登錄內儲存的 **BackConnectionHostNames** 清單。</span><span class="sxs-lookup"><span data-stu-id="74575-127">Add the NetBIOS and Fully Qualified Domain Name (FQDN) for the host header to the list of **BackConnectionHostNames** stored in the Windows Registry.</span></span> <span data-ttu-id="74575-128">使用 [KB 896861](https://support.microsoft.com/kb/896861) (https://support.microsoft.com/kb/896861) 中的**方法 2：指定主機名稱**，並進行下列調整。</span><span class="sxs-lookup"><span data-stu-id="74575-128">Use the steps in **Method 2: Specify host names** in [KB 896861](https://support.microsoft.com/kb/896861) (https://support.microsoft.com/kb/896861), with the following adjustment.</span></span> <span data-ttu-id="74575-129">KB 文章中的**步驟 7** 說「Quit Registry Editor, and then restart the IISAdmin service. (結束登錄編輯程式，然後重新啟動 IISAdmin 服務)。」</span><span class="sxs-lookup"><span data-stu-id="74575-129">**Step 7** of the KB article says "Quit Registry Editor, and then restart the IISAdmin service."</span></span> <span data-ttu-id="74575-130">而不是將電腦重新開機以確認變更是否生效。</span><span class="sxs-lookup"><span data-stu-id="74575-130">Instead, reboot the computer to ensure the changes take effect.</span></span><br /><br /> <span data-ttu-id="74575-131">例如，如果主機標頭名稱 \<MyServer> 是 "contoso" 之 Windows 電腦名稱稱的虛擬名稱，您或許可以參考 FQDN 形式的 "contoso.domain.com"。</span><span class="sxs-lookup"><span data-stu-id="74575-131">For example, if the host header name \<MyServer> is a virtual name for the Windows computer name of "contoso", you can probably reference the FQDN form as "contoso.domain.com".</span></span> <span data-ttu-id="74575-132">您需要將主機標頭名稱 (MyServer) 及 FQDN 名稱 (contoso.domain.com) 均加入 **BackConnectionHostNames**中的清單。</span><span class="sxs-lookup"><span data-stu-id="74575-132">You will need to add both the hostheader name (MyServer ) and FQDN name (contoso.domain.com) to the list in **BackConnectionHostNames**.</span></span>|<span data-ttu-id="74575-133">若您伺服器環境中包含本機電腦上的 NTLM 驗證，則必須執行此步驟，以建立回送連接。</span><span class="sxs-lookup"><span data-stu-id="74575-133">This step is required if your server environment involves NTLM authentication on the local computer, creating a loop back connection.</span></span><br /><br /> <span data-ttu-id="74575-134">在此情況下，您將發現報表管理員與報表伺服器之間的要求會是失敗的 401 狀態 (未經授權)。</span><span class="sxs-lookup"><span data-stu-id="74575-134">If this is the case, you will experience the requests between Report Manager and Report Server to fail with 401 (Unauthorized).</span></span>|  
|<span data-ttu-id="74575-135">4</span><span class="sxs-lookup"><span data-stu-id="74575-135">4</span></span>|<span data-ttu-id="74575-136">在僅限檔案模式中，於已經屬於 NLB 叢集之一部分的節點上安裝 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] ，並設定報表伺服器執行個體來進行向外延展部署。</span><span class="sxs-lookup"><span data-stu-id="74575-136">Install [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] in files-only mode on nodes that are already part of a NLB cluster, and configure the report server instances for scale-out deployment.</span></span><br /><br /> <span data-ttu-id="74575-137">您所設定的向外延展可能不會回應導向虛擬伺服器 IP 的要求。</span><span class="sxs-lookup"><span data-stu-id="74575-137">The scale-out that you configure might not respond to requests that are directed to the virtual server IP.</span></span> <span data-ttu-id="74575-138">將向外延展設定為使用虛擬伺服器 IP 的作業會在您設定檢視狀態驗證之後的步驟進行。</span><span class="sxs-lookup"><span data-stu-id="74575-138">Configuring the scale-out to use the virtual server IP occurs at a later step, after you configure view state validation.</span></span>|[<span data-ttu-id="74575-139">設定原生模式報表伺服器向外延展部署 &#40;SSRS 設定管理員&#41;</span><span class="sxs-lookup"><span data-stu-id="74575-139">Configure a Native Mode Report Server Scale-Out Deployment &#40;SSRS Configuration Manager&#41;</span></span>](../install-windows/configure-a-native-mode-report-server-scale-out-deployment.md)|  
|<span data-ttu-id="74575-140">5</span><span class="sxs-lookup"><span data-stu-id="74575-140">5</span></span>|<span data-ttu-id="74575-141">設定檢視狀態驗證</span><span class="sxs-lookup"><span data-stu-id="74575-141">Configure view state validation.</span></span><br /><br /> <span data-ttu-id="74575-142">為了獲得最佳結果，請在您設定向外延展部署之後，而在將報表伺服器執行個體設定為使用虛擬伺服器 IP 之前，執行這個步驟。</span><span class="sxs-lookup"><span data-stu-id="74575-142">For best results, perform this step after you configure the scale-out deployment, and before you configure the report server instances to use the virtual server IP.</span></span> <span data-ttu-id="74575-143">先設定檢視狀態驗證，就可以在使用者嘗試存取互動式報表時，避免發生有關狀態驗證失敗的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="74575-143">By configuring view state validation first, you can avoid exceptions about failed state validation when users attempt to access interactive reports.</span></span>|<span data-ttu-id="74575-144">本主題中的[如何設定檢視狀態驗證](#ViewState) 。</span><span class="sxs-lookup"><span data-stu-id="74575-144">[How to Configure View State Validation](#ViewState) in this topic.</span></span>|  
|<span data-ttu-id="74575-145">6</span><span class="sxs-lookup"><span data-stu-id="74575-145">6</span></span>|<span data-ttu-id="74575-146">將 `Hostname` 和 `UrlRoot` 設定為使用 NLB 叢集的虛擬伺服器 IP。</span><span class="sxs-lookup"><span data-stu-id="74575-146">Configure `Hostname` and `UrlRoot` to use the virtual server IP of the NLB cluster.</span></span>|<span data-ttu-id="74575-147">本主題中的[如何設定 Hostname 和 UrlRoot](#SpecifyingVirtualServerName) 。</span><span class="sxs-lookup"><span data-stu-id="74575-147">[How to Configure Hostname and UrlRoot](#SpecifyingVirtualServerName) in this topic.</span></span>|  
|<span data-ttu-id="74575-148">7</span><span class="sxs-lookup"><span data-stu-id="74575-148">7</span></span>|<span data-ttu-id="74575-149">確認伺服器可透過您指定的主機名稱存取。</span><span class="sxs-lookup"><span data-stu-id="74575-149">Verify the servers are accessible through the host name you specified.</span></span>|<span data-ttu-id="74575-150">本主題中的[確認報表伺服器存取](#Verify) 。</span><span class="sxs-lookup"><span data-stu-id="74575-150">[Verify Report Server Access](#Verify) in this topic.</span></span>|  
  
##  <a name="how-to-configure-view-state-validation"></a><a name="ViewState"></a><span data-ttu-id="74575-151">如何設定檢視狀態驗證</span><span class="sxs-lookup"><span data-stu-id="74575-151">How to Configure View State Validation</span></span>  
 <span data-ttu-id="74575-152">若要在 NLB 叢集上執行向外延展部署，您必須設定檢視狀態驗證，好讓使用者可以檢視互動式 HTML 報表。</span><span class="sxs-lookup"><span data-stu-id="74575-152">To run a scale-out deployment on an NLB cluster, you must configure view state validation so that users can view interactive HTML reports.</span></span> <span data-ttu-id="74575-153">您必須針對報表伺服器和報表管理員執行這項工作。</span><span class="sxs-lookup"><span data-stu-id="74575-153">You must do this for the report server and for Report Manager.</span></span>  
  
 <span data-ttu-id="74575-154">檢視狀態驗證是由 ASP.NET 所控制。</span><span class="sxs-lookup"><span data-stu-id="74575-154">View state validation is controlled by the ASP.NET.</span></span> <span data-ttu-id="74575-155">依預設會啟用檢視狀態驗證，並使用 Web 服務的識別來執行驗證。</span><span class="sxs-lookup"><span data-stu-id="74575-155">By default, view state validation is enabled and uses the identity of the Web service to perform the validation.</span></span> <span data-ttu-id="74575-156">但是在 NLB 叢集案例中，會有多個服務執行個體和 Web 服務識別在不同的電腦上執行。</span><span class="sxs-lookup"><span data-stu-id="74575-156">However, in an NLB cluster scenario, there are multiple service instances and web service identities that run on different computers.</span></span> <span data-ttu-id="74575-157">因為此服務識別會因每個節點而異，所以您不能依賴單一處理序識別來執行驗證。</span><span class="sxs-lookup"><span data-stu-id="74575-157">Because the service identity varies for each node, you cannot rely on a single process identity to perform the validation.</span></span>  
  
 <span data-ttu-id="74575-158">為了解決此問題，您可以產生任意驗證金鑰來支援檢視狀態驗證，然後手動將每個報表伺服器節點設定為使用相同的金鑰。</span><span class="sxs-lookup"><span data-stu-id="74575-158">To work around this issue, you can generate an arbitrary validation key to support view state validation, and then manually configure each report server node to use the same key.</span></span> <span data-ttu-id="74575-159">您可以使用任何隨機產生的十六進位序列。</span><span class="sxs-lookup"><span data-stu-id="74575-159">You can use any randomly generated hexadecimal sequence.</span></span> <span data-ttu-id="74575-160">驗證演算法 (例如 SHA1) 會決定十六進位序列必須包含的長度。</span><span class="sxs-lookup"><span data-stu-id="74575-160">The validation algorithm (such as SHA1) determines how long the hexadecimal sequence must be.</span></span>  
  
1.  <span data-ttu-id="74575-161">使用 [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)]提供的自動產生功能來產生驗證金鑰和解密金鑰。</span><span class="sxs-lookup"><span data-stu-id="74575-161">Generate a validation key and decryption key by using the autogenerate functionality provided by the [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="74575-162">最後，您必須擁有單一 <`machineKey`> 專案，您可以針對向外延展部署中的每個報表管理員實例，貼到 Web.config 檔案中。</span><span class="sxs-lookup"><span data-stu-id="74575-162">In the end, you must have a single <`machineKey`> entry that you can paste into the Web.config file for each Report Manager instance in the scale-out deployment.</span></span>  
  
     <span data-ttu-id="74575-163">下列範例說明您必須取得的值。</span><span class="sxs-lookup"><span data-stu-id="74575-163">The following example provides an illustration of the value you must obtain.</span></span> <span data-ttu-id="74575-164">請勿將此範例複製到組態檔中，因為這些金鑰值是無效的。</span><span class="sxs-lookup"><span data-stu-id="74575-164">Do not copy the example into your configuration files; the key values are not valid.</span></span>  
  
    ```  
    <machineKey validationKey="123455555" decryptionKey="678999999" validation="SHA1" decryption="AES"/>  
    ```  
  
2.  <span data-ttu-id="74575-165">開啟報表管理員的 Web.config 檔案，然後在 [<>] 區段中， `system.web` 貼上 `machineKey` 您所產生的 <> 元素。</span><span class="sxs-lookup"><span data-stu-id="74575-165">Open the Web.config file for Report Manager, and in the <`system.web`> section paste the <`machineKey`> element that you generated.</span></span> <span data-ttu-id="74575-166">根據預設，報表管理員的 Web.config 檔案位於 \Program Files\Microsoft SQL Server\MSRS10_50.MSSQLSERVER\Reporting Services\ReportManager\Web.config。</span><span class="sxs-lookup"><span data-stu-id="74575-166">By default, the Report Manager Web.config file is located in \Program Files\Microsoft SQL Server\MSRS10_50.MSSQLSERVER\Reporting Services\ReportManager\Web.config.</span></span>  
  
3.  <span data-ttu-id="74575-167">儲存檔案。</span><span class="sxs-lookup"><span data-stu-id="74575-167">Save the file.</span></span>  
  
4.  <span data-ttu-id="74575-168">針對向外延展部署中的每個報表伺服器重複以上步驟。</span><span class="sxs-lookup"><span data-stu-id="74575-168">Repeat the previous step for each report server in the scale-out deployment.</span></span>  
  
5.  <span data-ttu-id="74575-169">確認 \Reporting Services\Report Manager 資料夾中的所有 Web.Config 檔案都包含 `machineKey` <> 區段中相同的 <> 元素 `system.web` 。</span><span class="sxs-lookup"><span data-stu-id="74575-169">Verify that all Web.Config files in the \Reporting Services\Report Manager folders contain identical <`machineKey`> elements in the <`system.web`> section.</span></span>  
  
##  <a name="how-to-configure-hostname-and-urlroot"></a><a name="SpecifyingVirtualServerName"></a><span data-ttu-id="74575-170">如何設定主機名稱和 UrlRoot</span><span class="sxs-lookup"><span data-stu-id="74575-170">How to Configure Hostname and UrlRoot</span></span>  
 <span data-ttu-id="74575-171">若要在 NLB 叢集上設定報表伺服器向外延展部署，您必須定義單一虛擬伺服器名稱，以便提供伺服器叢集的單一存取點。</span><span class="sxs-lookup"><span data-stu-id="74575-171">To configure a report server scale-out deployment on an NLB cluster, you must define a single virtual server name that provides a single point of access to the server cluster.</span></span> <span data-ttu-id="74575-172">然後向您所在環境中的網域名稱伺服器 (DNS) 註冊這個虛擬伺服器名稱。</span><span class="sxs-lookup"><span data-stu-id="74575-172">Then register this virtual server name with the Domain Name Server (DNS) in your environment.</span></span>  
  
 <span data-ttu-id="74575-173">定義虛擬伺服器名稱之後，您必須在 RSReportServer.config 檔案中設定 `Hostname` 和 `UrlRoot` 屬性，以便將虛擬伺服器名稱包含在報表伺服器 URL 中。</span><span class="sxs-lookup"><span data-stu-id="74575-173">After you define the virtual server name, you can configure the `Hostname` and `UrlRoot` properties in the RSReportServer.config file to include the virtual server name in the report server URL.</span></span>  
  
 <span data-ttu-id="74575-174">當您在報表環境中使用萬用字元 URL 保留項目時，請設定 `Hostname` 屬性。</span><span class="sxs-lookup"><span data-stu-id="74575-174">Configure the `Hostname` property when you are using wildcard URL reservations in your reporting environment.</span></span> <span data-ttu-id="74575-175">當您指定 `Hostname` 屬性做為 NLB 伺服器的虛擬伺服器名稱時，報表環境的網路流量會導向 NLB 伺服器。</span><span class="sxs-lookup"><span data-stu-id="74575-175">When you specify the `Hostname` property to be the virtual server name of the NLB server, network traffic for the reporting environment is directed to the NLB server.</span></span> <span data-ttu-id="74575-176">然後 NLB 會將要求散發到報表伺服器節點。</span><span class="sxs-lookup"><span data-stu-id="74575-176">The NLB then distributes requests among the report server nodes.</span></span>  
  
 <span data-ttu-id="74575-177">另外，請設定 `UrlRoot` 屬性，好讓報表連結可以在已匯出到靜態報表的報表中工作 (例如 Excel 或 PDF 格式) 或是在訂閱所產生的報表中工作 (例如電子郵件訂閱)。</span><span class="sxs-lookup"><span data-stu-id="74575-177">Additionally, configure the `UrlRoot` property so that report links work in reports that have been exported to static reports, such as in an Excel or PDF format, or in reports that are generated by subscriptions, such as e-mail subscriptions.</span></span>  
  
 <span data-ttu-id="74575-178">如果您整合 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 了 [!INCLUDE[winSPServ](../../includes/winspserv-md.md)] 3.0 或 [!INCLUDE[offSPServ](../../includes/offspserv-md.md)] 2007，或您在自訂 Web 應用程式中主控報表，您可能只需要設定 `UrlRoot` 屬性。</span><span class="sxs-lookup"><span data-stu-id="74575-178">If you integrate [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] with [!INCLUDE[winSPServ](../../includes/winspserv-md.md)] 3.0 or [!INCLUDE[offSPServ](../../includes/offspserv-md.md)] 2007, or you host your reports in a custom Web application, you might need to configure only the `UrlRoot` property.</span></span> <span data-ttu-id="74575-179">在此範例中，將 `UrlRoot` 屬性設定為 SharePoint 網站或 Web 應用程式的 URL。</span><span class="sxs-lookup"><span data-stu-id="74575-179">In this case, configure the `UrlRoot` property to be the URL of the SharePoint site or Web application.</span></span> <span data-ttu-id="74575-180">這樣會將報表環境的網路流量導向可處理報表的應用程式，而不是報表伺服器或 NLB 叢集。</span><span class="sxs-lookup"><span data-stu-id="74575-180">This will direct network traffic for the reporting environment to the application that handles the reports rather than to the report server or NLB cluster.</span></span>  
  
 <span data-ttu-id="74575-181">請勿修改 `ReportServerUrl`。</span><span class="sxs-lookup"><span data-stu-id="74575-181">Do not modify `ReportServerUrl`.</span></span> <span data-ttu-id="74575-182">如果您修改這個 URL，就會在每次處理內部要求時增加虛擬伺服器之間的額外往返。</span><span class="sxs-lookup"><span data-stu-id="74575-182">If you modify this URL, you will introduce an extra roundtrip through the virtual server each time an internal request is handled.</span></span> <span data-ttu-id="74575-183">如需詳細資訊，請參閱[設定檔中的 URL &#40;SSRS 設定管理員&#41;](../install-windows/urls-in-configuration-files-ssrs-configuration-manager.md)。</span><span class="sxs-lookup"><span data-stu-id="74575-183">For more information, see [URLs in Configuration Files  &#40;SSRS Configuration Manager&#41;](../install-windows/urls-in-configuration-files-ssrs-configuration-manager.md).</span></span> <span data-ttu-id="74575-184">如需編輯設定檔的詳細資訊，請參閱《[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 線上叢書》中的[修改 Reporting Services 設定檔 &#40;RSreportserver.config&#41;](modify-a-reporting-services-configuration-file-rsreportserver-config.md)。</span><span class="sxs-lookup"><span data-stu-id="74575-184">For more information about editing the configuration file, see [Modify a Reporting Services Configuration File &#40;RSreportserver.config&#41;](modify-a-reporting-services-configuration-file-rsreportserver-config.md) in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Books Online.</span></span>  
  
1.  <span data-ttu-id="74575-185">在文字編輯器中開啟 RSReportServer.config。</span><span class="sxs-lookup"><span data-stu-id="74575-185">Open RSReportServer.config in a text editor.</span></span>  
  
2.  <span data-ttu-id="74575-186">尋找 **\<Service>** 區段，並將下列資訊新增至設定檔，並將值取代 `Hostname` 為 NLB 伺服器的虛擬伺服器名稱：</span><span class="sxs-lookup"><span data-stu-id="74575-186">Find the **\<Service>** section, and add the following information to the configuration file, replacing the `Hostname` value with the virtual server name for your NLB server:</span></span>  
  
    ```  
    <Hostname>virtual_server</Hostname>  
    ```  
  
3.  <span data-ttu-id="74575-187">尋找 `UrlRoot`。</span><span class="sxs-lookup"><span data-stu-id="74575-187">Find `UrlRoot`.</span></span> <span data-ttu-id="74575-188">在設定檔中未指定專案，但使用的預設值是下列格式的 URL： HTTP://或 HTTPs:// \<*computername*> / \<*reportserver*> ，其中 \<*reportserver*> 是報表伺服器 Web 服務的虛擬目錄名稱。</span><span class="sxs-lookup"><span data-stu-id="74575-188">The element is unspecified in the configuration file, but the default value used is a URL in this format: http:// or https://\<*computername*>/\<*reportserver*>, where \<*reportserver*> is the virtual directory name of the Report Server Web service.</span></span>  
  
4.  <span data-ttu-id="74575-189">輸入的值 `UrlRoot` ，其中包括叢集的虛擬名稱，格式如下： HTTP://或 HTTPs:// \<*virtual_server*> / \<*reportserver*> 。</span><span class="sxs-lookup"><span data-stu-id="74575-189">Type a value for `UrlRoot` that includes the virtual name of the cluster in this format: http:// or https://\<*virtual_server*>/\<*reportserver*>.</span></span>  
  
5.  <span data-ttu-id="74575-190">儲存檔案。</span><span class="sxs-lookup"><span data-stu-id="74575-190">Save the file.</span></span>  
  
6.  <span data-ttu-id="74575-191">針對向外延展部署中的每個報表伺服器，在每個 RSReportServer.config 檔案中重複這些步驟。</span><span class="sxs-lookup"><span data-stu-id="74575-191">Repeat these steps in each RSReportServer.config file for each report server in the scale-out deployment.</span></span>  
  
##  <a name="verify-report-server-access"></a><a name="Verify"></a> <span data-ttu-id="74575-192">確認報表伺服器存取</span><span class="sxs-lookup"><span data-stu-id="74575-192">Verify Report Server Access</span></span>  
 <span data-ttu-id="74575-193">請確認您可以透過虛擬伺服器名稱存取向外延展部署 (例如， https://MyVirtualServerName/reportserver 和 https://MyVirtualServerName/reports) 。</span><span class="sxs-lookup"><span data-stu-id="74575-193">Verify that you can access the scale-out deployment through the virtual server name (for example, https://MyVirtualServerName/reportserver and https://MyVirtualServerName/reports).</span></span>  
  
 <span data-ttu-id="74575-194">您可以查看報表伺服器記錄檔，或檢查 RS 執行記錄 (執行記錄資料表包含稱為 **InstanceName** 的資料行，它會顯示哪一個執行個體處理特定要求)，藉以檢查實際上是哪一個節點在處理報表。</span><span class="sxs-lookup"><span data-stu-id="74575-194">You can check which node actually processes reports by looking at the report server log files or by checking the RS execution log (the execution log table contains a column called **InstanceName** that shows which instance processed a particular request).</span></span> <span data-ttu-id="74575-195">如需詳細資訊，請參閱《 [線上叢書》中的](../report-server/reporting-services-log-files-and-sources.md) Reporting Services 記錄檔和來源 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="74575-195">For more information, see [Reporting Services Log Files and Sources](../report-server/reporting-services-log-files-and-sources.md) in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Books Online.</span></span>  
  
 <span data-ttu-id="74575-196">如果您無法連接到報表伺服器，請檢查 NLB 來確定要求有傳送到報表伺服器，並檢視報表伺服器 HTTP 記錄來確認伺服器正在接收要求。</span><span class="sxs-lookup"><span data-stu-id="74575-196">If you cannot connect to the report server, check the NLB to ensure that requests are sent to the report server and view the report server HTTP log to ensure that the server is receiving the requests.</span></span>  
  
#### <a name="troubleshooting-failed-requests"></a><span data-ttu-id="74575-197">疑難排解失敗的要求</span><span class="sxs-lookup"><span data-stu-id="74575-197">Troubleshooting Failed Requests</span></span>  
 <span data-ttu-id="74575-198">如果要求沒有送達報表伺服器執行個體，請檢查 RSReportServer.config 檔案來確認虛擬伺服器名稱是否指定為報表伺服器 URL 的主機名稱：</span><span class="sxs-lookup"><span data-stu-id="74575-198">If requests do not reach the report server instances, check the RSReportServer.config file to verify that the virtual server name is specified as the host name for the report server URLs:</span></span>  
  
1.  <span data-ttu-id="74575-199">在文字編輯器中開啟 RSReportServer.config 檔。</span><span class="sxs-lookup"><span data-stu-id="74575-199">Open the RSReportServer.config file in a text editor.</span></span>  
  
2.  <span data-ttu-id="74575-200">尋找 <`Hostname`>、<`ReportServerUrl`> 和 <`UrlRoot`>，並檢查每個設定的主機名稱。</span><span class="sxs-lookup"><span data-stu-id="74575-200">Find <`Hostname`>, <`ReportServerUrl`>, and <`UrlRoot`>, and check the host name for each settings.</span></span> <span data-ttu-id="74575-201">如果此值不是您所預期的主機名稱，請將它取代成正確的主機名稱。</span><span class="sxs-lookup"><span data-stu-id="74575-201">If the value is not the host name you expect, replace it with the correct host name.</span></span>  
  
 <span data-ttu-id="74575-202">如果您在進行這些變更之後啟動 Reporting Services 設定工具，此工具可能會將 <`ReportServerUrl`> 設定變更為預設值。</span><span class="sxs-lookup"><span data-stu-id="74575-202">If you start the Reporting Services Configuration tool after making these changes, the tool might change the <`ReportServerUrl`> settings to the default value.</span></span> <span data-ttu-id="74575-203">一律保存組態檔的備份副本，以防您需要將它們取代成內含欲使用之設定的版本。</span><span class="sxs-lookup"><span data-stu-id="74575-203">Always keep a backup copy of the configuration files in case you need to replace them with the version that contains the settings you want to use.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="74575-204">另請參閱</span><span class="sxs-lookup"><span data-stu-id="74575-204">See Also</span></span>  
 <span data-ttu-id="74575-205">[Reporting Services 組態管理員 &#40;原生模式&#41;](../../sql-server/install/reporting-services-configuration-manager-native-mode.md) </span><span class="sxs-lookup"><span data-stu-id="74575-205">[Reporting Services Configuration Manager &#40;Native Mode&#41;](../../sql-server/install/reporting-services-configuration-manager-native-mode.md) </span></span>  
 <span data-ttu-id="74575-206">[設定 SSRS Configuration Manager &#40;的 URL&#41;](../install-windows/configure-a-url-ssrs-configuration-manager.md) </span><span class="sxs-lookup"><span data-stu-id="74575-206">[Configure a URL  &#40;SSRS Configuration Manager&#41;](../install-windows/configure-a-url-ssrs-configuration-manager.md) </span></span>  
 <span data-ttu-id="74575-207">[設定原生模式報表伺服器向外延展部署 &#40;SSRS Configuration Manager&#41;](../install-windows/configure-a-native-mode-report-server-scale-out-deployment.md) </span><span class="sxs-lookup"><span data-stu-id="74575-207">[Configure a Native Mode Report Server Scale-Out Deployment &#40;SSRS Configuration Manager&#41;](../install-windows/configure-a-native-mode-report-server-scale-out-deployment.md) </span></span>  
 [<span data-ttu-id="74575-208">管理 Reporting Services 原生模式報表伺服器</span><span class="sxs-lookup"><span data-stu-id="74575-208">Manage a Reporting Services Native Mode Report Server</span></span>](manage-a-reporting-services-native-mode-report-server.md)  
  
  
