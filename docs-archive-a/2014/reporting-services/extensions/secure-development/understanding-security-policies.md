---
title: 了解安全性原則 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services
ms.topic: reference
helpviewer_keywords:
- code groups [Reporting Services]
- code access security [Reporting Services], security policies
- Execution permission set
- custom assemblies [Reporting Services], security
- permission sets [Reporting Services]
- expressions [Reporting Services], security
- evidence [Reporting Services]
- FullTrust permission set
- security policies [Reporting Services]
- named permission sets [Reporting Services]
ms.assetid: a9bf043a-139a-4929-9a58-244815323df0
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: e03f2ca7aae75f692ba2c888d1fb6bd3f60fb4a4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87606640"
---
# <a name="understanding-security-policies"></a><span data-ttu-id="61976-102">了解安全性原則</span><span class="sxs-lookup"><span data-stu-id="61976-102">Understanding Security Policies</span></span>
  <span data-ttu-id="61976-103">報表伺服器所執行的任何程式碼都必須屬於特定程式碼存取安全性原則的一部分。</span><span class="sxs-lookup"><span data-stu-id="61976-103">Any code that is executed by a report server must be part of a specific code access security policy.</span></span> <span data-ttu-id="61976-104">這些安全性原則包含將辨識項對應至一組具名使用權限集合的程式碼群組。</span><span class="sxs-lookup"><span data-stu-id="61976-104">These security policies consist of code groups that map evidence to a set of named permission sets.</span></span> <span data-ttu-id="61976-105">通常，程式碼群組會與為該群組中程式碼指定允許權限的具名使用權限集合產生關聯。</span><span class="sxs-lookup"><span data-stu-id="61976-105">Often, code groups are associated with a named permission set that specifies the allowable permissions for code in that group.</span></span> <span data-ttu-id="61976-106">執行階段會使用受信任主應用程式或載入程式所提供的辨識項來決定程式碼所屬的程式碼群組，以及因此授與程式碼的權限。</span><span class="sxs-lookup"><span data-stu-id="61976-106">The runtime uses evidence provided by a trusted host or by the loader to determine which code groups the code belongs to and, therefore, which permissions to grant the code.</span></span> [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] <span data-ttu-id="61976-107">會遵守 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 通用語言執行平台 (CLR) 所定義的安全性原則架構。</span><span class="sxs-lookup"><span data-stu-id="61976-107">adheres to this security policy architecture as defined by the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] common language runtime (CLR).</span></span> <span data-ttu-id="61976-108">下列各節將描述 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 中的各種程式碼類型以及與它們相關聯的原則規則。</span><span class="sxs-lookup"><span data-stu-id="61976-108">The following sections describe the various types of code in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] and the policy rules associated with them.</span></span>  
  
## <a name="report-server-assemblies"></a><span data-ttu-id="61976-109">報表伺服器組件</span><span class="sxs-lookup"><span data-stu-id="61976-109">Report Server Assemblies</span></span>  
 <span data-ttu-id="61976-110">報表伺服器組件是包含屬於 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 產品一部分之程式碼的組件。</span><span class="sxs-lookup"><span data-stu-id="61976-110">Report server assemblies are those that contain code that is part of the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] product.</span></span> [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] <span data-ttu-id="61976-111">是使用 Managed 程式碼組件撰寫而成。所有這些組件都是強式名稱 (亦即，經過數位簽署)。</span><span class="sxs-lookup"><span data-stu-id="61976-111">is written using managed code assemblies; all of these assemblies are strong-named (that is, digitally signed).</span></span> <span data-ttu-id="61976-112">這些組件的程式碼群組都是使用 **StrongNameMembershipCondition** 所定義，可根據組件強式名稱的公開金鑰資訊提供辨識項。</span><span class="sxs-lookup"><span data-stu-id="61976-112">The code groups for these assemblies are defined using the **StrongNameMembershipCondition**, which provides evidence based on public key information for the assembly's strong name.</span></span> <span data-ttu-id="61976-113">此程式碼群組會被授與 **FullTrust** 權限集合。</span><span class="sxs-lookup"><span data-stu-id="61976-113">The code group is granted the **FullTrust** permission set.</span></span>  
  
## <a name="report-server-extensions-rendering-data-delivery-and-security"></a><span data-ttu-id="61976-114">報表伺服器延伸模組 (轉譯、資料、傳遞和安全性)</span><span class="sxs-lookup"><span data-stu-id="61976-114">Report Server Extensions (Rendering, Data, Delivery, and Security)</span></span>  
 <span data-ttu-id="61976-115">報表伺服器延伸模組是指您或其他協力廠商為了擴充 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 功能而建立的自訂資料、傳遞、轉譯和安全性延伸模組。</span><span class="sxs-lookup"><span data-stu-id="61976-115">Report server extensions are custom data, delivery, rendering, and security extensions that you or other third-parties create in order to extend the functionality of [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span></span> <span data-ttu-id="61976-116">在與您要擴充之 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 元件建立關聯的原則設定檔中，您必須將 **FullTrust** 授與這些延伸模組或組件程式碼。</span><span class="sxs-lookup"><span data-stu-id="61976-116">You must grant **FullTrust** to these extensions or assembly code in the policy configuration files associated with the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] component you are extending.</span></span> <span data-ttu-id="61976-117">隨附於 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 的延伸模組會以報表伺服器公開金鑰簽署並接收 **FullTrust** 權限集合。</span><span class="sxs-lookup"><span data-stu-id="61976-117">Extensions shipped as a part of [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] are signed with the report server public key and receive the **FullTrust** permission set.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="61976-118">您必須修改 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 原則設定檔，以便允許任何協力廠商延伸模組的 **FullTrust**。</span><span class="sxs-lookup"><span data-stu-id="61976-118">You must modify the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] policy configuration files to allow **FullTrust** for any third-party extensions.</span></span> <span data-ttu-id="61976-119">如果您沒有針對自訂延伸模組加入具有 **FullTrust** 的程式碼群組，報表伺服器就無法使用它們。</span><span class="sxs-lookup"><span data-stu-id="61976-119">If you do not add a code group with **FullTrust** for your custom extensions, they cannot be used by the report server.</span></span>  
  
 <span data-ttu-id="61976-120">如需 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 原則設定檔的詳細資訊，請參閱[使用 Reporting Services 安全性原則檔](using-reporting-services-security-policy-files.md)。</span><span class="sxs-lookup"><span data-stu-id="61976-120">For more information about the policy configuration files in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)], see [Using Reporting Services Security Policy Files](using-reporting-services-security-policy-files.md).</span></span>  
  
## <a name="expressions-used-in-reports"></a><span data-ttu-id="61976-121">在報表中使用的運算式</span><span class="sxs-lookup"><span data-stu-id="61976-121">Expressions Used in Reports</span></span>  
 <span data-ttu-id="61976-122">報表運算式是指包含在報表定義語言檔案之 **Code** 項目中的內嵌程式碼運算式或使用者定義方法。</span><span class="sxs-lookup"><span data-stu-id="61976-122">Report expressions are inline code expressions or user-defined methods contained within the **Code** element of a report definition language file.</span></span> <span data-ttu-id="61976-123">有一個已經在原則檔中設定的程式碼群組，它預設會將 **Execution** 權限集合授與這些運算式。</span><span class="sxs-lookup"><span data-stu-id="61976-123">There is a code group that is already configured in the policy files that grants these expressions the **Execution** permission set by default.</span></span> <span data-ttu-id="61976-124">此程式碼群組如下所示：</span><span class="sxs-lookup"><span data-stu-id="61976-124">The code group looks like the following:</span></span>  
  
```  
<CodeGroup  
   class="UnionCodeGroup"  
   version="1"  
   PermissionSetName="Execution"  
   Name="Report_Expressions_Default_Permissions"  
   Description="This code group grants default permissions for code in report expressions and Code element. ">  
    <IMembershipCondition  
       class="StrongNameMembershipCondition"  
       version="1"  
       PublicKeyBlob="002400..."  
    />  
</CodeGroup>  
```  
  
 <span data-ttu-id="61976-125">**Execution** 權限允許程式碼執行，但不允許使用受保護的資源。</span><span class="sxs-lookup"><span data-stu-id="61976-125">**Execution** permission allows code to run (execute), but not to use protected resources.</span></span> <span data-ttu-id="61976-126">在報表內發現的所有運算式都會編譯成一個組件 (稱為「運算式主機」組件)，而該組件會儲存成已編譯報表的一部分。</span><span class="sxs-lookup"><span data-stu-id="61976-126">All expressions found within a report are compiled into an assembly (called an "expression host" assembly) that is stored as a part of the compiled report.</span></span> <span data-ttu-id="61976-127">執行此報表時，報表伺服器會載入運算式主機組件並呼叫該組件以執行運算式。</span><span class="sxs-lookup"><span data-stu-id="61976-127">When the report is executed, the report server loads the expression host assembly and makes calls into that assembly to execute expressions.</span></span> <span data-ttu-id="61976-128">運算式主機組件會以用來定義所有運算式主機之程式碼群組的特定金鑰進行簽署。</span><span class="sxs-lookup"><span data-stu-id="61976-128">Expression host assemblies are signed with a specific key that is used to define the code group for all expression hosts.</span></span>  
  
 <span data-ttu-id="61976-129">報表運算式會參考報表物件模型集合 (欄位、參數等等)，然後執行簡單的工作 (例如算術和字串作業)。</span><span class="sxs-lookup"><span data-stu-id="61976-129">Report expressions reference report object model collections (fields, parameters, etc.) and perform simple tasks like arithmetic and string operations.</span></span> <span data-ttu-id="61976-130">執行這些簡單作業的程式碼只需要 **Execution** 權限。</span><span class="sxs-lookup"><span data-stu-id="61976-130">Code that performs these simple operations only requires **Execution** permission.</span></span> <span data-ttu-id="61976-131">根據預設，**Code** 項目中的使用者定義方法和任何自訂組件都會被授與 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 中的 **Execution** 權限。</span><span class="sxs-lookup"><span data-stu-id="61976-131">By default, user-defined methods in the **Code** element and any custom assemblies are granted **Execution** permission in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span></span> <span data-ttu-id="61976-132">因此，對於大部分運算式而言，目前的組態不需要您修改任何安全性原則檔案。</span><span class="sxs-lookup"><span data-stu-id="61976-132">Thus, for most expressions, the current configuration does not require that you modify any security policy files.</span></span> <span data-ttu-id="61976-133">若要將其他權限授與運算式主機組件，系統管理員必須修改報表伺服器和報表設計師的原則組態檔，以及變更報表運算式程式碼群組。</span><span class="sxs-lookup"><span data-stu-id="61976-133">To grant additional permissions to expression host assemblies, an administrator needs to modify the policy configuration files of the report server and Report Designer, and change the report expressions code group.</span></span> <span data-ttu-id="61976-134">由於它是全域設定，所以變更運算式主機的預設權限就會影響所有報表。</span><span class="sxs-lookup"><span data-stu-id="61976-134">Because it is a global setting, changing default permissions for the expression hosts affects all reports.</span></span> <span data-ttu-id="61976-135">因此，強烈建議您將需要其他安全性的所有程式碼都放入自訂組件中。</span><span class="sxs-lookup"><span data-stu-id="61976-135">For this reason, it is highly recommended that you place all code that requires additional security into a custom assembly.</span></span> <span data-ttu-id="61976-136">如此一來，只有這個組件會被授與您所需的權限。</span><span class="sxs-lookup"><span data-stu-id="61976-136">Only this assembly will be granted the permissions you need.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="61976-137">呼叫外部組件或受保護資源的程式碼應該併入自訂組件中，以便用於報表內。</span><span class="sxs-lookup"><span data-stu-id="61976-137">Code that calls external assemblies or protected resources should be incorporated into a custom assembly for use in reports.</span></span> <span data-ttu-id="61976-138">這樣做可讓您更有效地控制程式碼所要求和判斷提示的權限。</span><span class="sxs-lookup"><span data-stu-id="61976-138">Doing so gives you more control over the permissions requested and asserted by your code.</span></span> <span data-ttu-id="61976-139">您不應該呼叫 **Code** 項目內部的安全方法。</span><span class="sxs-lookup"><span data-stu-id="61976-139">You should not make calls to secure methods within the **Code** element.</span></span> <span data-ttu-id="61976-140">這樣做會需要您將 **FullTrust** 授與報表運算式主機並將所有自訂程式碼完整存取權授與 CLR。</span><span class="sxs-lookup"><span data-stu-id="61976-140">Doing so requires you to grant **FullTrust** to the report expression host and grants all custom code full access to the CLR.</span></span>  
  
> [!CAUTION]  
>  <span data-ttu-id="61976-141">請勿將 **FullTrust** 授與報表運算式主機的程式碼群組。</span><span class="sxs-lookup"><span data-stu-id="61976-141">Do not grant **FullTrust** to the code group for a report expression host.</span></span> <span data-ttu-id="61976-142">如果您這樣做，就會讓所有報表運算式進行受保護的系統呼叫。</span><span class="sxs-lookup"><span data-stu-id="61976-142">If you do, you enable all report expressions to make protected system calls.</span></span>  
  
## <a name="custom-assemblies-referenced-in-reports"></a><span data-ttu-id="61976-143">在報表中參考的自訂組件</span><span class="sxs-lookup"><span data-stu-id="61976-143">Custom Assemblies Referenced in Reports</span></span>  
 <span data-ttu-id="61976-144">某些報表運算式可以呼叫協力廠商程式碼組件 (在 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 中也稱為自訂組件)。</span><span class="sxs-lookup"><span data-stu-id="61976-144">Some report expressions can call third-party code assemblies, also known in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] as custom assemblies.</span></span> <span data-ttu-id="61976-145">報表伺服器會預期這些組件在原則設定檔中至少具有 **Execution** 權限。</span><span class="sxs-lookup"><span data-stu-id="61976-145">The report server expects these assemblies to have at least **Execution** permission in the policy configuration files.</span></span> <span data-ttu-id="61976-146">根據預設，[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 隨附的原則檔案會將 **Execution** 權限授與所有組件，從「我的電腦」區域開始。</span><span class="sxs-lookup"><span data-stu-id="61976-146">By default, policy files that ship with [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] grant **Execution** permission to all assemblies starting from the 'My Computer' zone.</span></span> <span data-ttu-id="61976-147">您可以視需要將其他權限授與自訂組件。</span><span class="sxs-lookup"><span data-stu-id="61976-147">You can grant additional permissions to custom assemblies as needed.</span></span>  
  
 <span data-ttu-id="61976-148">在某些情況下，您可能必須執行在報表運算式中需要特定程式碼權限的作業。</span><span class="sxs-lookup"><span data-stu-id="61976-148">In some cases, you may need to perform an operation that requires specific code permissions in a report expression.</span></span> <span data-ttu-id="61976-149">一般而言，這表示報表運算式需要呼叫安全的 CLR 程式庫方法 (例如，存取檔案或系統登錄的方法)。</span><span class="sxs-lookup"><span data-stu-id="61976-149">Typically, this means that a report expression needs to make a call to a secured CLR library method (such as one that accesses files or the system registry).</span></span> <span data-ttu-id="61976-150">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 文件集描述了進行此安全呼叫所需的程式碼權限。若要執行此呼叫，呼叫的程式碼必須被授與這些特定且安全的權限。</span><span class="sxs-lookup"><span data-stu-id="61976-150">The [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] documentation describes the code permissions that are required to make this secure call; to execute the call, the calling code must be granted these specific, secure permissions.</span></span> <span data-ttu-id="61976-151">如果您從報表運算式或 **Code** 項目進行此呼叫，運算式主機組件就必須被授與適當的權限。</span><span class="sxs-lookup"><span data-stu-id="61976-151">If you make the call from a report expression or the **Code** element, the expression host assembly must be granted the appropriate permissions.</span></span> <span data-ttu-id="61976-152">不過，一旦您將這些權限授與運算式主機，在任何報表之任何運算式中執行的所有程式碼現在都會被授與該特定權限。</span><span class="sxs-lookup"><span data-stu-id="61976-152">However, once you grant the expression host the permissions, all code that runs in any expression in any report is now granted that specific permission.</span></span> <span data-ttu-id="61976-153">從自訂組件進行呼叫以及將特定權限授與該自訂組件是比較安全的做法。</span><span class="sxs-lookup"><span data-stu-id="61976-153">It is much more secure to make the call from a custom assembly and grant that custom assembly the specific permissions.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="61976-154">另請參閱</span><span class="sxs-lookup"><span data-stu-id="61976-154">See Also</span></span>  
 <span data-ttu-id="61976-155">[Reporting Services 中的程式碼存取安全性](code-access-security-in-reporting-services.md) </span><span class="sxs-lookup"><span data-stu-id="61976-155">[Code Access Security in Reporting Services](code-access-security-in-reporting-services.md) </span></span>  
 [<span data-ttu-id="61976-156">安全開發 &#40;Reporting Services&#41;</span><span class="sxs-lookup"><span data-stu-id="61976-156">Secure Development &#40;Reporting Services&#41;</span></span>](secure-development-reporting-services.md)  
  
  
