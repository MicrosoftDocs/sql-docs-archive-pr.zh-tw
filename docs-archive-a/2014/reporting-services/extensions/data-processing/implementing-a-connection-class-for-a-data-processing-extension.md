---
title: 為資料處理延伸模組實作連線類別 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services
ms.topic: reference
helpviewer_keywords:
- connections [Reporting Services], data processing extensions
- Connection class
- data processing extensions [Reporting Services], connections
ms.assetid: 7047d29e-a2c9-4e6f-ad02-635851a38ed7
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 84caac40ec8df198d5c26ed89bf35fad71ad914f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87708949"
---
# <a name="implementing-a-connection-class-for-a-data-processing-extension"></a><span data-ttu-id="a2ecf-102">為資料處理延伸模組實作 Connection 類別</span><span class="sxs-lookup"><span data-stu-id="a2ecf-102">Implementing a Connection Class for a Data Processing Extension</span></span>
  <span data-ttu-id="a2ecf-103">**Connection** 物件代表資料庫連線或是類似的資源，而且是 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 資料處理延伸模組之使用者的起點。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-103">The **Connection** object represents a database connection or similar resource and is the starting point for users of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] data processing extension.</span></span> <span data-ttu-id="a2ecf-104">它代表資料庫伺服器的連接，不過任何具有類似行為的實體都可以公開成 **Connection**。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-104">It represents connections to database servers, though any entity with similar behavior can be exposed as a **Connection**.</span></span>  
  
 <span data-ttu-id="a2ecf-105">若要實作 **Connection** 物件，請建立實作 <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> 的類別，並選擇性地實作 <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension>。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-105">To implement a **Connection** object, create a class that implements <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> and optionally implements <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension>.</span></span>  
  
 <span data-ttu-id="a2ecf-106">在您的實作中，您必須確保在執行命令之前先建立和開啟連接。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-106">In your implementation, you must ensure that a connection is created and opened before commands can be executed.</span></span> <span data-ttu-id="a2ecf-107">請確保實作要求用戶端明確地開啟和關閉連接，而不是讓您的實作隱含地為用戶端開啟和關閉連接。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-107">Ensure that your implementation requires clients to open and close connections explicitly, rather than having your implementation open and close connections implicitly for the client.</span></span> <span data-ttu-id="a2ecf-108">在取得連接時執行您的安全性檢查。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-108">Perform your security checks when the connection is obtained.</span></span> <span data-ttu-id="a2ecf-109">在 [!INCLUDE[ssRS](../../../includes/ssrs.md)] 資料處理延伸模組中需要其他類別的現有連接，將可確保在與資料來源搭配使用時永遠執行安全性檢查。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-109">Requiring an existing connection for the other classes in your [!INCLUDE[ssRS](../../../includes/ssrs.md)] data processing extension will then ensure that security checks are always performed when working with your data source.</span></span>  
  
 <span data-ttu-id="a2ecf-110">所需連接的屬性是以連接字串來表示。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-110">The properties of the desired connection are represented as a connection string.</span></span> <span data-ttu-id="a2ecf-111">強烈建議 [!INCLUDE[ssRS](../../../includes/ssrs.md)] 資料處理延伸模組使用由 OLE DB 定義的熟悉名稱/值組系統來支援 <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection.ConnectionString%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-111">It is strongly recommended that [!INCLUDE[ssRS](../../../includes/ssrs.md)] data processing extensions support the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection.ConnectionString%2A> property using the familiar name/value pair system defined by OLE DB.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a2ecf-112">**Connection** 物件通常需要大量資源才能取得，因此您可能會想要考慮共用連線或是其他技術來減輕這個問題。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-112">**Connection** objects are often resource-intensive to obtain, so you may want to consider pooling connections or other techniques to mitigate this.</span></span>  
  
 <span data-ttu-id="a2ecf-113"><xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> 繼承自 <xref:Microsoft.ReportingServices.Interfaces.IExtension>。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-113"><xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> inherits from <xref:Microsoft.ReportingServices.Interfaces.IExtension>.</span></span> <span data-ttu-id="a2ecf-114">您必須將 <xref:Microsoft.ReportingServices.Interfaces.IExtension> 介面實作為連接類別實作的一部分。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-114">You must implement the <xref:Microsoft.ReportingServices.Interfaces.IExtension> interface as part of your connection class implementation.</span></span> <span data-ttu-id="a2ecf-115"><xref:Microsoft.ReportingServices.Interfaces.IExtension> 介面允許類別實作當地語系化的延伸模組名稱，並處理在 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 組態檔中儲存的延伸模組特定組態資訊。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-115">The <xref:Microsoft.ReportingServices.Interfaces.IExtension> interface enables a class to implement a localized extension name and to process extension-specific configuration information stored in the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] configuration file.</span></span>  
  
 <span data-ttu-id="a2ecf-116">您的 **Connection** 物件透過其 <xref:Microsoft.ReportingServices.Interfaces.IExtension> 的實作，包含 <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-116">Your **Connection** object contains the <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A> property through its implementation of <xref:Microsoft.ReportingServices.Interfaces.IExtension>.</span></span> <span data-ttu-id="a2ecf-117">強烈建議 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 資料處理延伸模組支援 <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A> 屬性，這樣使用者便會在使用者介面遇到熟悉且當地語系化的延伸模組名稱，例如報表管理員。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-117">It is strongly recommended that [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] data processing extensions support the <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A> property, so that users encounter a familiar, localized name for the extension in a user interface, such as Report Manager.</span></span>  
  
 <span data-ttu-id="a2ecf-118"><xref:Microsoft.ReportingServices.Interfaces.IExtension> 也允許您的 **Connection** 物件擷取和處理儲存在 RSReportServer.config 檔案中的自訂設定資料。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-118"><xref:Microsoft.ReportingServices.Interfaces.IExtension> also enables your **Connection** object to retrieve and process custom configuration data stored in the RSReportServer.config file.</span></span> <span data-ttu-id="a2ecf-119">如需有關處理自訂組態資料的詳細資訊，請參閱＜<xref:Microsoft.ReportingServices.Interfaces.IExtension.SetConfiguration%2A>＞方法。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-119">For more information about processing custom configuration data, see the <xref:Microsoft.ReportingServices.Interfaces.IExtension.SetConfiguration%2A> method.</span></span>  
  
 <span data-ttu-id="a2ecf-120">當未卸載其餘的資料處理延伸模組類別時，實作 <xref:Microsoft.ReportingServices.Interfaces.IExtension> 的類別不會從記憶體卸載。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-120">The class that implements <xref:Microsoft.ReportingServices.Interfaces.IExtension> is not unloaded from memory when the rest of your data processing extension classes are unloaded.</span></span> <span data-ttu-id="a2ecf-121">因此，您可以使用 **Extension** 類別來儲存跨連線的狀態資訊，或是儲存可以在記憶體中快取的資料。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-121">Because of this, you can use your **Extension** class to store cross-connection state information or to store data that can be cached in memory.</span></span> <span data-ttu-id="a2ecf-122">只要報表伺服器正在執行，您的 **Extension** 類別仍然會在記憶體中。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-122">Your **Extension** class remains in memory as long as the report server is running.</span></span>  
  
 <span data-ttu-id="a2ecf-123">您可以透過實作 <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> 來擴充 **Connection** 類別，以包含對 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 中認證的支援。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-123">You can extend your **Connection** class to include support for credentials in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] by implementing <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension>.</span></span> <span data-ttu-id="a2ecf-124">當您實作 <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> 介面的 <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.IntegratedSecurity%2A>、<xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.UserName%2A> 和 <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.Password%2A> 屬性時，可以啟用 [整合式安全性] 核取方塊，以及在報表設計師 [資料來源] 對話方塊的 [使用者名稱] 與 [密碼] 文字方塊。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-124">When you implement the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.IntegratedSecurity%2A>, <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.UserName%2A>, and <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.Password%2A> properties of the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> interface, you enable the **Integrated Security** check box and **Username** and **Password** text boxes of the **Data Source** dialog in Report Designer.</span></span> <span data-ttu-id="a2ecf-125">這允許報表設計師儲存和擷取支援驗證的資料來源之認證。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-125">This enables Report Designer to store and retrieve credentials for data sources that support authentication.</span></span> <span data-ttu-id="a2ecf-126">會將認證安全地儲存並在預覽模式中轉譯報表時使用。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-126">The credentials are stored securely and used when rendering reports in preview mode.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a2ecf-127">若要隱含實作 <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension>，您必須實作 <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> 與 <xref:Microsoft.ReportingServices.Interfaces.IExtension> 介面的成員。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-127">Implementing <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> implicitly requires you to implement the members of the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> and <xref:Microsoft.ReportingServices.Interfaces.IExtension> interfaces.</span></span>  
>   
>  <span data-ttu-id="a2ecf-128">如需範例 **Connection** 類別的實作，請參閱 [SQL Server Reporting Services 產品範例](https://go.microsoft.com/fwlink/?LinkId=177889)。</span><span class="sxs-lookup"><span data-stu-id="a2ecf-128">For a sample **Connection** class implementation, see [SQL Server Reporting Services Product Samples](https://go.microsoft.com/fwlink/?LinkId=177889).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a2ecf-129">另請參閱</span><span class="sxs-lookup"><span data-stu-id="a2ecf-129">See Also</span></span>  
 <span data-ttu-id="a2ecf-130">[Reporting Services 延伸模組](../reporting-services-extensions.md) </span><span class="sxs-lookup"><span data-stu-id="a2ecf-130">[Reporting Services Extensions](../reporting-services-extensions.md) </span></span>  
 <span data-ttu-id="a2ecf-131">[實作資料處理延伸模組](implementing-a-data-processing-extension.md) </span><span class="sxs-lookup"><span data-stu-id="a2ecf-131">[Implementing a Data Processing Extension](implementing-a-data-processing-extension.md) </span></span>  
 [<span data-ttu-id="a2ecf-132">Reporting Services 延伸模組程式庫</span><span class="sxs-lookup"><span data-stu-id="a2ecf-132">Reporting Services Extension Library</span></span>](../reporting-services-extension-library.md)  
  
  
