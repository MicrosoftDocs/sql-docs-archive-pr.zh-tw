---
title: 編寫部署和管理工作的指令碼 | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- scripts [Reporting Services]
- moving reports
- report servers [Reporting Services], duplicating settings
- deploying [Reporting Services], scripts
- copying report server settings
- administrative tasks [Reporting Services]
- duplicating report server environment
- migrating reports [Reporting Services]
- scripts [Reporting Services], deployments
- transferrng reports
- reports [Reporting Services], migrating
ms.assetid: d0416c9e-e3f9-456d-9870-2cfd2c49039b
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 7562bec3211824d5e84441434b4696a44d51fa9b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87597026"
---
# <a name="script-deployment-and-administrative-tasks"></a><span data-ttu-id="ba3c0-102">編寫部署和管理工作的指令碼</span><span class="sxs-lookup"><span data-stu-id="ba3c0-102">Script Deployment and Administrative Tasks</span></span>
  [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] <span data-ttu-id="ba3c0-103">支援使用指令碼，以自動執行例行安裝、部署和管理工作。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-103">supports the use of scripts to automate routine installation, deployment, and administrative tasks.</span></span> <span data-ttu-id="ba3c0-104">部署報表伺服器是一個多步驟的程序，</span><span class="sxs-lookup"><span data-stu-id="ba3c0-104">Deploying a report server is a multi-step process.</span></span> <span data-ttu-id="ba3c0-105">您必須使用數個工具和程序來設定部署；並沒有單一程式或方法可用來自動化處理所有工作。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-105">You must use several tools and processes to configure a deployment; there is no single program or approach that can be used to automate all the tasks.</span></span>  
  
 <span data-ttu-id="ba3c0-106">不是每一個步驟都應該自動化；</span><span class="sxs-lookup"><span data-stu-id="ba3c0-106">Not every step should be automated.</span></span> <span data-ttu-id="ba3c0-107">在某些情況下，手動執行步驟或是透過圖形工具是最簡單且最有效的方法。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-107">In some cases, performing a step manually or through a graphical tool is the simplest and most effective approach.</span></span> <span data-ttu-id="ba3c0-108">例如，如果您想要部署大量的報表和模型，則複製報表伺服器資料庫要比撰寫程式碼來重新建立報表伺服器環境更為理想。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-108">For example, if you want to deploy a large number of reports and models, it is better to copy the report server databases rather than write code that recreates report server environment.</span></span>  
  
 <span data-ttu-id="ba3c0-109">某些步驟需要自訂程式碼；</span><span class="sxs-lookup"><span data-stu-id="ba3c0-109">Some steps require custom code.</span></span> <span data-ttu-id="ba3c0-110">例如，只有當您撰寫自訂程式碼來呼叫報表伺服器 Windows Management Instrumentation (WMI) 提供者時，才可以讓 Web 服務和報表管理員的 URL 設定自動化。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-110">For example, configuring the URLs for the Web service and Report Manager can be automated, but only if you write custom code that makes calls into the Report Server Windows Management Instrumentation (WMI) provider.</span></span> <span data-ttu-id="ba3c0-111">如果您不想要撰寫程式碼，必須使用 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 組態工具來執行此步驟。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-111">If you do not want to write code, you must use the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration tool to perform the step.</span></span>  
  
 <span data-ttu-id="ba3c0-112">若要執行設定報表伺服器的指令碼，您必須是設定電腦上的本機管理員。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-112">To run script that configures a report server, you must be a local administrator on the computer that you are configuring.</span></span> <span data-ttu-id="ba3c0-113">如需詳細資訊，請參閱 [設定報表伺服器來進行遠端管理](../report-server/configure-a-report-server-for-remote-administration.md)。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-113">For more information, see [Configure a Report Server for Remote Administration](../report-server/configure-a-report-server-for-remote-administration.md).</span></span>  
  
 <span data-ttu-id="ba3c0-114">此主題描述自動化特定步驟的建議方法。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-114">This topic describes recommended approaches for automating specific steps.</span></span> <span data-ttu-id="ba3c0-115">其中會提及數個程式和程式設計介面，此主題稍後會描述各程式和程式設計介面。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-115">Several programs and programmatic interfaces are mentioned; descriptions of each one are provided later in this topic.</span></span>  
  
## <a name="deployment-tasks-and-how-to-automate-them"></a><span data-ttu-id="ba3c0-116">部署工作及自動化這些工作的方式</span><span class="sxs-lookup"><span data-stu-id="ba3c0-116">Deployment Tasks and How to Automate Them</span></span>  
 <span data-ttu-id="ba3c0-117">下表摘要列出部署報表伺服器所需的安裝和組態工作。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-117">The following table summarizes the installation and configuration tasks that are necessary for deploying a report server.</span></span> <span data-ttu-id="ba3c0-118">您可以使用這個表，比對特定的工作以及讓您自動化或自主 (Unattended) 執行工作的方法。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-118">You can use the table to match a specific task to an approach that allows you to automate or perform the task unattended.</span></span>  
  
|<span data-ttu-id="ba3c0-119">Task</span><span class="sxs-lookup"><span data-stu-id="ba3c0-119">Task</span></span>|<span data-ttu-id="ba3c0-120">方法</span><span class="sxs-lookup"><span data-stu-id="ba3c0-120">Approach</span></span>|  
|----------|--------------|  
|<span data-ttu-id="ba3c0-121">安裝 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-121">Install [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span></span>|<span data-ttu-id="ba3c0-122">您可以從命令列執行安裝程式，以執行自動安裝。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-122">You can run setup from the command line to perform an unattended installation.</span></span><br /><br /> <span data-ttu-id="ba3c0-123">只有當您指定預設組態選項，而且系統符合該安裝類型的所有需求時，才可以使用安裝程式來安裝及設定報表伺服器。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-123">You can use Setup to both install and configure a report server, but only if you specify the default configuration option and your system meets all the requirements for this installation type.</span></span> <span data-ttu-id="ba3c0-124">如果您無法安裝預設組態，必須執行僅限檔案的安裝。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-124">If you cannot install the default configuration, you must perform a files-only installation.</span></span>|  
|<span data-ttu-id="ba3c0-125">設定服務帳戶。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-125">Configure the service account.</span></span>|<span data-ttu-id="ba3c0-126">服務帳戶一開始是透過安裝程式設定的。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-126">The service account is initially configured through Setup.</span></span> <span data-ttu-id="ba3c0-127">若要讓服務帳戶的變更當做安裝後工作自動化，您必須撰寫呼叫報表伺服器 WMI 提供者的自訂程式碼。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-127">To automate changes to the service account as a post-Setup task, you must write custom code that makes calls into the Report Server WMI provider.</span></span> <span data-ttu-id="ba3c0-128">並沒有任何命令提示公用程式或指令碼範本可以使用程式設計方式設定服務帳戶。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-128">There are no command-prompt utilities or script templates for configuring the service account programmatically.</span></span><br /><br /> <span data-ttu-id="ba3c0-129">如果編碼需求讓您無法自動化這個步驟，您可以藉由執行 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 組態工具，以手動方式輕鬆地設定帳戶。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-129">If coding requirements prevent you from automating this step, you can easily configure the account manually by running the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration tool.</span></span> <span data-ttu-id="ba3c0-130">如需詳細資訊，請參閱[設定服務帳戶 &#40;SSRS 設定管理員&#41;](../../sql-server/install/configure-a-service-account-ssrs-configuration-manager.md)。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-130">For more information, see [Configure a Service Account &#40;SSRS Configuration Manager&#41;](../../sql-server/install/configure-a-service-account-ssrs-configuration-manager.md).</span></span>|  
|<span data-ttu-id="ba3c0-131">設定報表伺服器 Web 服務與報表管理員 URL。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-131">Configure the Report Server Web service and Report Manager URLs.</span></span>|<span data-ttu-id="ba3c0-132">您必須撰寫自訂程式碼來呼叫報表伺服器 WMI 提供者。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-132">You must write custom code that makes calls into the Report Server WMI provider.</span></span> <span data-ttu-id="ba3c0-133">並沒有任何命令列公用程式或指令碼範本可以用來設定 URL。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-133">There are no command line utilities or script templates for configuring the URLs.</span></span><br /><br /> <span data-ttu-id="ba3c0-134">如果您想要避免撰寫程式碼，您可以執行 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 組態工具手動設定 URL。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-134">If you want to avoid writing code, you can configure the URLs manually by running the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration tool.</span></span> <span data-ttu-id="ba3c0-135">如需詳細資訊，請參閱[設定 URL &#40;SSRS 組態管理員&#41;](../install-windows/configure-a-url-ssrs-configuration-manager.md)。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-135">For more information, see [Configure a URL  &#40;SSRS Configuration Manager&#41;](../install-windows/configure-a-url-ssrs-configuration-manager.md).</span></span>|  
|<span data-ttu-id="ba3c0-136">建立報表伺服器資料庫。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-136">Create the report server database.</span></span>|<span data-ttu-id="ba3c0-137">您必須撰寫自訂程式碼來呼叫報表伺服器 WMI 提供者。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-137">You must write custom code that makes calls into the Report Server WMI provider.</span></span> <span data-ttu-id="ba3c0-138">並沒有任何命令提示公用程式或指令碼範本可以用來建立報表伺服器資料庫和 RSExecRole。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-138">There are no command-prompt utilities or script templates for creating the report server databases and RSExecRole.</span></span><br /><br /> <span data-ttu-id="ba3c0-139">如果您想要避免撰寫程式碼，您可以執行 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 組態工具手動建立資料庫。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-139">If you want to avoid writing code, you can create the database manually by running the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration tool.</span></span> <span data-ttu-id="ba3c0-140">如需詳細資訊，請參閱[建立原生模式報表伺服器資料庫 &#40;SSRS 設定管理員&#41;](../install-windows/ssrs-report-server-create-a-native-mode-report-server-database.md)。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-140">For more information, see [Create a Native Mode Report Server Database  &#40;SSRS Configuration Manager&#41;](../install-windows/ssrs-report-server-create-a-native-mode-report-server-database.md).</span></span>|  
|<span data-ttu-id="ba3c0-141">設定報表伺服器資料庫連接。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-141">Configure the report server database connection.</span></span>|<span data-ttu-id="ba3c0-142">如果您要變更連接字串、帳戶或密碼，或驗證類型，請執行 **rsconfig** 公用程式來設定連接。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-142">If you are changing the connection string, account or password, or the authentication type, run the **rsconfig** utility to configure the connection.</span></span> <span data-ttu-id="ba3c0-143">如需詳細資訊，請參閱[設定報表伺服器資料庫連線 &#40;SSRS 設定管理員&#41;](../../sql-server/install/configure-a-report-server-database-connection-ssrs-configuration-manager.md) 和 [rsconfig 公用程式 &#40;SSRS&#41;](rsconfig-utility-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-143">For more information, see [Configure a Report Server Database Connection  &#40;SSRS Configuration Manager&#41;](../../sql-server/install/configure-a-report-server-database-connection-ssrs-configuration-manager.md) and [rsconfig Utility &#40;SSRS&#41;](rsconfig-utility-ssrs.md).</span></span><br /><br /> <span data-ttu-id="ba3c0-144">但是不能使用 rsconfig.exe 來建立或升級資料庫。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-144">You cannot use rsconfig.exe to create or upgrade the database.</span></span> <span data-ttu-id="ba3c0-145">資料庫和 RSExecRole 必須已經存在。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-145">The database and RSExecRole must already exist.</span></span>|  
|<span data-ttu-id="ba3c0-146">設定向外延展部署。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-146">Configure a scale-out deployment.</span></span>|<span data-ttu-id="ba3c0-147">請從下列自動化向外延展部署的方法中進行選擇：</span><span class="sxs-lookup"><span data-stu-id="ba3c0-147">Choose from the following approaches to automate scale-out deployment:</span></span><br /><br /> <span data-ttu-id="ba3c0-148">執行 rskeymgmt.exe 公用程式，將報表伺服器執行個體聯結到現有的安裝。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-148">Run the rskeymgmt.exe utility to join report server instances to an existing installation.</span></span> <span data-ttu-id="ba3c0-149">如需詳細資訊，請參閱[新增和移除向外延展部署的加密金鑰 &#40;SSRS 設定管理員&#41;](../install-windows/add-and-remove-encryption-keys-for-scale-out-deployment.md)。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-149">For more information, see [Add and Remove Encryption Keys for Scale-Out Deployment &#40;SSRS Configuration Manager&#41;](../install-windows/add-and-remove-encryption-keys-for-scale-out-deployment.md).</span></span><br /><br /> <span data-ttu-id="ba3c0-150">撰寫可對報表伺服器 WMI 提供者執行的自訂程式碼。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-150">Write custom code that runs against the Report Server WMI provider.</span></span>|  
|<span data-ttu-id="ba3c0-151">備份加密金鑰。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-151">Backup encryption keys.</span></span>|<span data-ttu-id="ba3c0-152">請從下列自動化加密金鑰備份的方法中進行選擇：</span><span class="sxs-lookup"><span data-stu-id="ba3c0-152">Choose from the following approaches to automate encryption key backup:</span></span><br /><br /> <span data-ttu-id="ba3c0-153">執行 rskeymgmt.exe 公用程式來備份這些金鑰。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-153">Run the rskeymgmt.exe utility to back up the keys.</span></span> <span data-ttu-id="ba3c0-154">如需詳細資訊，請參閱 [備份與還原 Reporting Services 加密金鑰](../install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md)。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-154">For more information, see [Back Up and Restore Reporting Services Encryption Keys](../install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md).</span></span><br /><br /> <span data-ttu-id="ba3c0-155">撰寫可對報表伺服器 WMI 提供者執行的自訂程式碼。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-155">Write custom code that runs against the Report Server WMI provider.</span></span>|  
|<span data-ttu-id="ba3c0-156">設定報表伺服器電子郵件。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-156">Configure Report Server E-mail.</span></span>|<span data-ttu-id="ba3c0-157">撰寫可對 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI 提供者執行的自訂程式碼。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-157">Write custom code that runs against the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI provider.</span></span> <span data-ttu-id="ba3c0-158">提供者支援電子郵件組態設定的子集。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-158">The provider supports a subset of the e-mail configuration settings.</span></span><br /><br /> <span data-ttu-id="ba3c0-159">雖然 RSReportServer.config 檔案包含所有設定，但請不要以自動方式使用檔案。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-159">Although the RSReportServer.config file includes all the settings, do not use the file in an automated manner.</span></span> <span data-ttu-id="ba3c0-160">亦即，請不要使用批次檔複製檔案到其他報表伺服器。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-160">Specifically, do not use a batch file to copy the file to another report server.</span></span> <span data-ttu-id="ba3c0-161">每個組態檔都包含適用於目前執行個體的值。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-161">Each configuration file includes values that are specific to the current instance.</span></span> <span data-ttu-id="ba3c0-162">這些值對其他報表伺服器執行個體無效。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-162">Those values will not be valid on other report server instances.</span></span><br /><br /> <span data-ttu-id="ba3c0-163">如需設定的詳細資訊，請參閱[設定報表伺服器以進行電子郵件傳遞 &#40;SSRS Configuration Manager&#41;](../../sql-server/install/configure-a-report-server-for-e-mail-delivery-ssrs-configuration-manager.md)。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-163">For more information about the settings, see [Configure a Report Server for E-Mail Delivery &#40;SSRS Configuration Manager&#41;](../../sql-server/install/configure-a-report-server-for-e-mail-delivery-ssrs-configuration-manager.md).</span></span>|  
|<span data-ttu-id="ba3c0-164">設定自動執行帳戶。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-164">Configure the unattended execution account.</span></span>|<span data-ttu-id="ba3c0-165">請從下列讓自動處理帳戶組態自動化的方法中進行選擇：</span><span class="sxs-lookup"><span data-stu-id="ba3c0-165">Choose from the following approaches to automate unattended processing account configuration:</span></span><br /><br /> <span data-ttu-id="ba3c0-166">執行 rsconfig.exe 公用程式來設定此帳戶。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-166">Run the rsconfig.exe utility to configure the account.</span></span> <span data-ttu-id="ba3c0-167">如需詳細資訊，請參閱[設定自動執行帳戶 &#40;SSRS 組態管理員&#41;](../install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md)。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-167">For more information, see [Configure the Unattended Execution Account &#40;SSRS Configuration Manager&#41;](../install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md).</span></span><br /><br /> <span data-ttu-id="ba3c0-168">撰寫可呼叫報表伺服器 WMI 提供者的自訂程式碼。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-168">Write custom code that makes calls into the Report Server WMI provider.</span></span>|  
|<span data-ttu-id="ba3c0-169">在另一部報表伺服器上部署現有的內容，包括資料夾階層、角色指派、報表、訂閱、排程、資料來源和資源。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-169">Deploy existing content on another report server, including the folder hierarchy, role assignments, reports, subscriptions, schedules, data sources, and resources.</span></span>|<span data-ttu-id="ba3c0-170">重新建立現有報表伺服器環境的最佳方式，就是將報表伺服器資料庫複製到新的報表伺服器執行個體。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-170">The best way to re-create an existing report server environment is to copy the report server database to a new report server instance.</span></span><br /><br /> <span data-ttu-id="ba3c0-171">替代方式是撰寫以程式設計方式重新建立現有報表伺服器內容的自訂程式碼。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-171">An alternative approach is to write custom code that recreates existing report server content programmatically.</span></span> <span data-ttu-id="ba3c0-172">不過，請注意，訂閱、報表快照集和報表記錄不能以程式設計方式重新建立。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-172">However, be aware that subscriptions, report snapshots, and report history cannot be recreated programmatically.</span></span><br /><br /> <span data-ttu-id="ba3c0-173">某些部署會因為將這兩種技術一起使用而獲益 (也就是還原報表伺服器資料庫，然後執行會針對特定安裝而修改報表伺服器資料庫的自訂程式碼)。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-173">Some deployments can benefit from using both techniques together (that is, restore a report server database, and then run custom code that modifies the report server database for a specific installation).</span></span><br /><br /> <span data-ttu-id="ba3c0-174"> 如需詳細的範例，請參閱＜ [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md)＞。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-174">For a detailed example, see [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md).</span></span><br /><br /> <span data-ttu-id="ba3c0-175">如需重新放置報表伺服器資料庫的詳細資訊，請參閱[將報表伺服器資料庫移至其他電腦 &#40;SSRS 原生模式&#41;](../report-server/moving-the-report-server-databases-to-another-computer-ssrs-native-mode.md)。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-175">For more information about relocating a report server database, see [Moving the Report Server Databases to Another Computer &#40;SSRS Native Mode&#41;](../report-server/moving-the-report-server-databases-to-another-computer-ssrs-native-mode.md).</span></span> <span data-ttu-id="ba3c0-176">如需有關以程式設計方式建立報表伺服器環境的詳細資訊，請參閱本主題的「使用指令碼來移轉報表伺服器內容和資料夾」一節。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-176">For more information about creating report serer environment programmatically, see the section "Using Script to Migrate Report Server Content and Folders" in this topic.</span></span>|  
  
## <a name="tools-and-technologies-for-automating-server-deployment"></a><span data-ttu-id="ba3c0-177">自動化伺服器部署的工具和技術</span><span class="sxs-lookup"><span data-stu-id="ba3c0-177">Tools and Technologies for Automating Server deployment</span></span>  
 <span data-ttu-id="ba3c0-178">下列清單摘要列出可用來自動化部署和維護工作的程式與介面。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-178">The following list summarizes the programs and interfaces that can be used to automate deployment and maintenance tasks:</span></span>  
  
-   <span data-ttu-id="ba3c0-179">安裝程式可以在自動模式中執行，以便安裝報表伺服器元件，有時也可以進行設定。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-179">The Setup program can be run in unattended mode to install and sometimes configure report server components.</span></span> <span data-ttu-id="ba3c0-180">您必須使用「僅限檔案」安裝選項，才能讓安裝程式設定報表伺服器執行個體。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-180">You must use the Files-Only installation option to have Setup configure a report server instance.</span></span>  
  
-   <span data-ttu-id="ba3c0-181">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI 提供者和 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 命令列公用程式可用於本機和遠端伺服器組態。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-181">The [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI provider and [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] command line utilities can be used for local and remote server configuration.</span></span>  
  
     <span data-ttu-id="ba3c0-182">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI 提供者會公開類別、屬性和方法，讓您能夠設定 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 安裝的所有層面，包括指定服務帳戶、設定 URL、建立及設定報表伺服器資料庫，或是設定報表伺服器以進行電子郵件傳遞。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-182">The [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI provider exposes classes, properties, and methods that allow you to configure all aspects of a [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] installation including specifying the service account, configuring URLs, creating and configuring the report server database, or configuring a report server for e-mail delivery.</span></span> <span data-ttu-id="ba3c0-183">您必須撰寫自訂程式碼或指令碼，才能使用 WMI 提供者。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-183">You must write custom code or script to use the WMI provider.</span></span> <span data-ttu-id="ba3c0-184">如需詳細資訊，請參閱 [存取 Reporting Services WMI 提供者](access-the-reporting-services-wmi-provider.md)。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-184">For more information, see [Access the Reporting Services WMI Provider](access-the-reporting-services-wmi-provider.md).</span></span>  
  
     <span data-ttu-id="ba3c0-185">撰寫程式碼的替代方案是使用命令列公用程式 (rsconfig.exe 和 rskeymgmt.exe)，</span><span class="sxs-lookup"><span data-stu-id="ba3c0-185">An alternative to writing code is to use the command line utilities (rsconfig.exe and rskeymgmt.exe).</span></span> <span data-ttu-id="ba3c0-186">您可以撰寫批次檔來執行這些公用程式，</span><span class="sxs-lookup"><span data-stu-id="ba3c0-186">You can write batch files that run the utilities.</span></span> <span data-ttu-id="ba3c0-187">這些公用程式可用來自動化某些組態工作，而不是所有組態工作。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-187">You can use the utilities to automate some but not all configuration tasks.</span></span>  
  
-   <span data-ttu-id="ba3c0-188">報表伺服器 Script Host 工具 (rs.exe) 可以執行您可能會撰寫的自訂 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] 程式碼，以便重新建立現有內容，或在報表伺服器之間移動現有內容。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-188">The report server script host tool (rs.exe) can run custom [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] code that you might write to re-create or move existing content from one report server to another.</span></span> <span data-ttu-id="ba3c0-189">當您使用這個方式時，會使用 [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]撰寫指令碼，並將其另存為 .rss 檔案，然後在目標報表伺服器上使用 rs.exe 來執行此指令碼。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-189">With this approach, you write script in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)], save it as an .rss file, and use rs.exe to run the script on the target report server.</span></span> <span data-ttu-id="ba3c0-190">您所撰寫的指令碼可以呼叫報表伺服器 Web 服務的 SOAP 介面。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-190">The script you write can call the SOAP interface to the Report Server Web service.</span></span> <span data-ttu-id="ba3c0-191">部署指令碼是使用這種方法所撰寫，因為它可讓您重新建立報表伺服器資料夾命名空間與內容，以及重新建立以角色為基礎的安全性。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-191">Deployment scripts are written using this approach because it allows you to re-create a report server folder namespace and content, and re-create role-based security.</span></span>  
  
-   <span data-ttu-id="ba3c0-192">[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 版引進了適用於 SharePoint 整合模式的 PowerShell 指令程式。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-192">The [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] release introduced PowerShell cmdlets for SharePoint integrated mode.</span></span> <span data-ttu-id="ba3c0-193">您可以使用 PowerShell 設定和管理 SharePoint 整合。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-193">You can use PowerShell to configure and administer the SharePoint integration.</span></span>  <span data-ttu-id="ba3c0-194">如需詳細資訊，請參閱 [Reporting Services SharePoint 模式的 PowerShell Cmdlet](../powershell-cmdlets-for-reporting-services-sharepoint-mode.md)。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-194">For more information, see [PowerShell cmdlets for Reporting Services SharePoint Mode](../powershell-cmdlets-for-reporting-services-sharepoint-mode.md).</span></span>  
  
## <a name="use-scripts-to-migrate-report-server-content-and-folders"></a><span data-ttu-id="ba3c0-195">使用指令碼來移轉報表伺服器內容和資料夾</span><span class="sxs-lookup"><span data-stu-id="ba3c0-195">Use Scripts to Migrate Report Server Content and Folders</span></span>  
 <span data-ttu-id="ba3c0-196">您可以撰寫指令碼來複製另一個報表伺服器執行個體上的報表伺服器環境。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-196">You can write scripts that duplicate a report server environment on another report server instance.</span></span> <span data-ttu-id="ba3c0-197">部署指令碼通常是以 [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] 撰寫，然後使用報表伺服器 Script Host 公用程式處理。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-197">Deployment scripts are generally written in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] and then processed using the report server script host utility.</span></span>  
  
 <span data-ttu-id="ba3c0-198"> 如需詳細的範例，請參閱＜ [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md)＞。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-198">For a detailed example, see [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md).</span></span>  
  
 <span data-ttu-id="ba3c0-199">使用指令碼，即可將資料夾、共用資料來源、資源、報表、角色指派以及設定從一部伺服器複製到另一部伺服器。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-199">Use scripts to copy folders, shared data sources, resources, reports, role assignments, and settings from one server to another.</span></span> <span data-ttu-id="ba3c0-200">您為某個報表伺服器執行個體撰寫一個指令碼，然後在另一部伺服器上執行此指令碼，以重新建立報表伺服器命名空間。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-200">You write a script for one report server instance, and then run it on another server to re-create the report server namespace.</span></span> <span data-ttu-id="ba3c0-201">如果您的 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 部署中有多個報表伺服器，可以分別在每一個伺服器上執行指令碼，以相同方式設定所有伺服器。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-201">If you have multiple report servers in your [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] deployment, you can run the script on each server individually to configure all servers in the same way.</span></span>  
  
 <span data-ttu-id="ba3c0-202">下列清單描述將報表從一部伺服器移轉到另一部伺服器的步驟。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-202">The following list describes the steps for migrating reports from one server to another.</span></span>  
  
1.  <span data-ttu-id="ba3c0-203">將您的指令碼變數設定為來源報表伺服器的 URL。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-203">Set your script variable to the URL of the source report server.</span></span>  
  
2.  <span data-ttu-id="ba3c0-204">使用 <xref:ReportService2010.ReportingService2010.GetItemDefinition%2A> 和 <xref:ReportService2010.ReportingService2010.GetProperties%2A> 方法，即可擷取報表的報表定義與屬性。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-204">Use the <xref:ReportService2010.ReportingService2010.GetItemDefinition%2A> and <xref:ReportService2010.ReportingService2010.GetProperties%2A> methods to retrieve the report definition and the properties of the report.</span></span>  
  
3.  <span data-ttu-id="ba3c0-205">將 URL 設定為指向目的地伺服器。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-205">Set the URL to point to the destination server.</span></span>  
  
4.  <span data-ttu-id="ba3c0-206">使用 <xref:ReportService2010.ReportingService2010.CreateCatalogItem%2A> 方法，傳遞從 <xref:ReportService2010.ReportingService2010.GetProperties%2A> 傳回的屬性和 <xref:ReportService2010.ReportingService2010.GetItemDefinition%2A>。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-206">Use <xref:ReportService2010.ReportingService2010.CreateCatalogItem%2A> method, passing the properties returned from <xref:ReportService2010.ReportingService2010.GetProperties%2A> and the report definition returned by <xref:ReportService2010.ReportingService2010.GetItemDefinition%2A>.</span></span>  
  
 <span data-ttu-id="ba3c0-207">藉由使用各種 get 與 create 方法的組合，您可以執行類似的步驟來移轉設定、資料夾、共用資料來源以及資源。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-207">By using a combination of get and create methods, you can perform similar steps to migrate settings, folders, shared data sources, and resources.</span></span> <span data-ttu-id="ba3c0-208">如需您可以使用之方法的詳細資訊，請參閱[技術參考 &#40;SSRS&#41;](../technical-reference-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-208">For more information about the methods available to you, see [Technical Reference &#40;SSRS&#41;](../technical-reference-ssrs.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ba3c0-209">除非明確設定認證，否則指令碼便會利用執行指令碼之使用者的 [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows 認證來執行。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-209">Scripts run under the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows credentials of the user running the script unless credentials are explicitly set.</span></span>  
  
 <span data-ttu-id="ba3c0-210">如需如何格式化和執行指令碼檔案的詳細資訊，請參閱 [利用 rs.exe 公用程式與 Web 服務編寫指令碼](script-with-the-rs-exe-utility-and-the-web-service.md)。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-210">For more information about how to format and run a script file, see [Script with the rs.exe Utility and the Web Service](script-with-the-rs-exe-utility-and-the-web-service.md).</span></span>  
  
## <a name="using-scripts-to-set-server-properties"></a><span data-ttu-id="ba3c0-211">使用指令碼來設定伺服器屬性</span><span class="sxs-lookup"><span data-stu-id="ba3c0-211">Using Scripts to Set Server Properties</span></span>  
 <span data-ttu-id="ba3c0-212">您可以撰寫在報表伺服器上設定系統屬性的指令碼。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-212">You can write scripts that set system properties on the report server.</span></span> <span data-ttu-id="ba3c0-213">下列 [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] .NET 指令碼會示範設定屬性的一個方式。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-213">The following [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] .NET script shows one way to set properties.</span></span> <span data-ttu-id="ba3c0-214">這個範例會停用 RSClientPrint ActiveX 控制項，但是您可以用任何有效的屬性名稱和值來取代 `EnableClientPrinting` 和 `False`。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-214">This example disables the RSClientPrint ActiveX control, but you can replace `EnableClientPrinting` and `False` with any valid property name and value.</span></span> <span data-ttu-id="ba3c0-215">若要檢視完整的伺服器屬性清單，請參閱 [報表伺服器系統屬性](../report-server-web-service/net-framework/reporting-services-properties-report-server-system-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-215">To view a complete list of server properties, see [Report Server System Properties](../report-server-web-service/net-framework/reporting-services-properties-report-server-system-properties.md).</span></span>  
  
 <span data-ttu-id="ba3c0-216">若要使用此指令碼，請將它儲存為 .rss 副檔名的檔案，然後使用 rs.exe 命令提示字元公用程式，在報表伺服器上執行這個檔案。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-216">To use the script, save it to a file that has an .rss extension, and then use the rs.exe command prompt utility to run the file on the report server.</span></span> <span data-ttu-id="ba3c0-217">系統不會編譯此指令碼，所以不需要安裝 [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-217">The script is not compiled, so it is not necessary to have an installation of [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)].</span></span> <span data-ttu-id="ba3c0-218">這個範例假設您具有主控報表伺服器之本機電腦的權限。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-218">This example assumes that you have permissions on the local computer that hosts the report server.</span></span> <span data-ttu-id="ba3c0-219">如果您不是在具有權限的帳戶之下登入，您必須透過其他命令列引數來指定帳戶資訊。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-219">If you are not logged on under an account that has permissions, you must specify account information through additional command line arguments.</span></span> <span data-ttu-id="ba3c0-220">如需詳細資訊，請參閱 [RS.exe 公用程式 &#40;SSRS&#41;](rs-exe-utility-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-220">For more information, see [RS.exe Utility &#40;SSRS&#41;](rs-exe-utility-ssrs.md).</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="ba3c0-221"> 如需詳細的範例，請參閱＜ [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md)＞。</span><span class="sxs-lookup"><span data-stu-id="ba3c0-221">For a detailed example, see [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md).</span></span>  
  
```vb
Public Sub Main()  
        Dim props(0) As [Property]  
        Dim setProp As New [Property]  
        setProp.Name = "EnableClientPrinting"  
        setProp.Value = "False"   
        props(0) = setProp  
        Try  
            rs.SetSystemProperties(props)  
        Catch ex As System.Web.Services.Protocols.SoapException  
            Console.Write(ex.Detail.InnerXml)  
        Catch e as Exception  
            Console.Write(e.Message)  
        End Try  
End Sub  
```  
  
## <a name="see-also"></a><span data-ttu-id="ba3c0-222">另請參閱</span><span class="sxs-lookup"><span data-stu-id="ba3c0-222">See Also</span></span>  
 <span data-ttu-id="ba3c0-223">[GenerateDatabaseCreationScript 方法 &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabasecreationscript.md) </span><span class="sxs-lookup"><span data-stu-id="ba3c0-223">[GenerateDatabaseCreationScript Method &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabasecreationscript.md) </span></span>  
 <span data-ttu-id="ba3c0-224">[GenerateDatabaseRightsScript 方法 &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabaserightsscript.md) </span><span class="sxs-lookup"><span data-stu-id="ba3c0-224">[GenerateDatabaseRightsScript Method &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabaserightsscript.md) </span></span>  
 <span data-ttu-id="ba3c0-225">[GenerateDatabaseUpgradeScript 方法 &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabaseupgradescript.md) </span><span class="sxs-lookup"><span data-stu-id="ba3c0-225">[GenerateDatabaseUpgradeScript Method &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabaseupgradescript.md) </span></span>  
 <span data-ttu-id="ba3c0-226">[從命令提示字元安裝 SQL Server 2014](../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md) </span><span class="sxs-lookup"><span data-stu-id="ba3c0-226">[Install SQL Server 2014 from the Command Prompt](../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md) </span></span>  
 <span data-ttu-id="ba3c0-227">[安裝 Reporting Services 原生模式報表伺服器](../install-windows/install-reporting-services-native-mode-report-server.md) </span><span class="sxs-lookup"><span data-stu-id="ba3c0-227">[Install Reporting Services Native Mode Report Server](../install-windows/install-reporting-services-native-mode-report-server.md) </span></span>  
 <span data-ttu-id="ba3c0-228">[Reporting Services 報表伺服器 &#40;原生模式&#41;](../report-server/reporting-services-report-server-native-mode.md) </span><span class="sxs-lookup"><span data-stu-id="ba3c0-228">[Reporting Services Report Server &#40;Native Mode&#41;](../report-server/reporting-services-report-server-native-mode.md) </span></span>  
 <span data-ttu-id="ba3c0-229">[報表伺服器命令提示字元公用程式 &#40;SSRS&#41;](report-server-command-prompt-utilities-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="ba3c0-229">[Report Server Command Prompt Utilities &#40;SSRS&#41;](report-server-command-prompt-utilities-ssrs.md) </span></span>  
 <span data-ttu-id="ba3c0-230">[規劃 Reporting Services 和 Power View 瀏覽器支援 &#40;Reporting Services 2014&#41;](../browser-support-for-reporting-services-and-power-view.md) </span><span class="sxs-lookup"><span data-stu-id="ba3c0-230">[Planning for Reporting Services and Power View Browser Support &#40;Reporting Services 2014&#41;](../browser-support-for-reporting-services-and-power-view.md) </span></span>  
 [<span data-ttu-id="ba3c0-231">Reporting Services 工具</span><span class="sxs-lookup"><span data-stu-id="ba3c0-231">Reporting Services Tools</span></span>](reporting-services-tools.md)  
