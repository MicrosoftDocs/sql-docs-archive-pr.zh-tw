---
title: Reporting Services 中的資料連線、資料來源和連接字串 |Microsoft Docs
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- connections [Reporting Services], data sources
- reports [Reporting Services], data
- expressions [Reporting Services], data sources
- data sources [Reporting Services], connections
- connection strings [Reporting Services]
- shared data sources [Reporting Services]
- Reporting Services, data sources
- logins [Reporting Services]
ms.assetid: 4d8f0ae1-102b-4b3d-9155-fa584c962c9e
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 320d538ea7d2b4fa971f3df8c8e1e4165052b79f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87596551"
---
# <a name="data-connections-data-sources-and-connection-strings-in-reporting-services"></a><span data-ttu-id="cf3d1-102">Data Connections, Data Sources, and Connection Strings in Reporting Services</span><span class="sxs-lookup"><span data-stu-id="cf3d1-102">Data Connections, Data Sources, and Connection Strings in Reporting Services</span></span>
  <span data-ttu-id="cf3d1-103">若要在 [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] 報表中包括資料，您必須先建立「資料來源」 \*\* 與「資料集」 \*\*。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-103">To include data in a [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] report, you must first create *data sources* and *datasets*.</span></span> <span data-ttu-id="cf3d1-104">本主題說明資料來源的類型、如何建立資料來源，以及與資料來源認證相關的重要資訊。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-104">This topic explains the type of data sources, how to create data sources, and important information related to data source credentials.</span></span> <span data-ttu-id="cf3d1-105">資料來源包括資料來源類型、連接資訊，以及要使用的認證類型。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-105">A data source includes the data source type, connection information, and the type of credentials to use.</span></span> <span data-ttu-id="cf3d1-106">資料來源有兩種類型：內嵌和共用。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-106">There are two types of data sources: embedded and shared.</span></span> <span data-ttu-id="cf3d1-107">內嵌資料來源是定義在報表中，而且只能供該報表使用。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-107">An embedded data source is defined in the report and used only by that report.</span></span> <span data-ttu-id="cf3d1-108">共用資料來源則與報表分開定義，而且可以供多個報表使用。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-108">A shared data source is defined independently from a report and can be used by multiple reports.</span></span> <span data-ttu-id="cf3d1-109">如需詳細資訊，請參閱[內嵌和共用資料連接或資料來源 &#40;報表產生器及 SSRS&#41;](../../2014/reporting-services/embedded-and-shared-data-connections-or-data-sources-report-builder-and-ssrs.md) 和[內嵌和共用資料集 &#40;報表產生器及 SSRS&#41;](report-data/embedded-and-shared-datasets-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-109">For more information, see [Embedded and Shared Data Connections or Data Sources &#40;Report Builder and SSRS&#41;](../../2014/reporting-services/embedded-and-shared-data-connections-or-data-sources-report-builder-and-ssrs.md) and [Embedded and Shared Datasets &#40;Report Builder and SSRS&#41;](report-data/embedded-and-shared-datasets-report-builder-and-ssrs.md).</span></span>

||
|-|
|<span data-ttu-id="cf3d1-110">**[!INCLUDE[applies](../includes/applies-md.md)]** [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] 原生模式 &#124; [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] SharePoint 模式</span><span class="sxs-lookup"><span data-stu-id="cf3d1-110">**[!INCLUDE[applies](../includes/applies-md.md)]**  [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] Native mode &#124; [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] SharePoint mode</span></span>|

> [!NOTE]
>  [!INCLUDE[ssRBRDDup](../includes/ssrbrddup-md.md)]



##  <a name="embedded-and-shared-data-sources"></a><a name="bkmk_data_sources"></a><span data-ttu-id="cf3d1-111">內嵌和共用資料來源</span><span class="sxs-lookup"><span data-stu-id="cf3d1-111">Embedded and shared data sources</span></span>
 <span data-ttu-id="cf3d1-112">內嵌與共用資料來源之間的差異在於建立、儲存和管理的方式。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-112">The difference between the embedded and shared data sources is in how they are created, stored, and managed.</span></span>

-   <span data-ttu-id="cf3d1-113">在報表設計師中，您可以將內嵌或共用資料來源建立成 [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] 專案的一部分。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-113">In Report Designer, create embedded or shared data sources as part of a [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] project.</span></span> <span data-ttu-id="cf3d1-114">您可以控制要在本機使用它們進行預覽，還是將它們當做專案的一部分部署至報表伺服器或 SharePoint 網站。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-114">You can control whether to use them locally for preview or to deploy them as part of the project to a report server or SharePoint site.</span></span> <span data-ttu-id="cf3d1-115">您可以使用已經安裝在電腦以及報表伺服器或 SharePoint 網站 (部署報表的所在位置) 上的自訂資料延伸模組。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-115">You can use custom data extensions that have been installed on your computer and on the report server or SharePoint site where you deploy your reports.</span></span>

     <span data-ttu-id="cf3d1-116">系統管理員可以安裝與設定其他資料處理延伸模組以及 .NET Framework 資料提供者。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-116">System administrators can install and configure additional data processing extensions and .NET Framework data providers.</span></span> <span data-ttu-id="cf3d1-117">如需詳細資訊，請參閱[資料處理延伸模組與 .NET Framework Data Providers &#40;SSRS&#41;](report-data/data-processing-extensions-and-net-framework-data-providers-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-117">For more information, see [Data Processing Extensions and .NET Framework Data Providers &#40;SSRS&#41;](report-data/data-processing-extensions-and-net-framework-data-providers-ssrs.md).</span></span>

     <span data-ttu-id="cf3d1-118">開發人員可以使用 <xref:Microsoft.ReportingServices.DataProcessing> API 建立資料處理延伸模組，以支援其他類型的資料來源。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-118">Developers can use the <xref:Microsoft.ReportingServices.DataProcessing> API to create data processing extensions to support additional types of data sources.</span></span>

-   <span data-ttu-id="cf3d1-119">在報表產生器中，您可以瀏覽至報表伺服器或 SharePoint 網站，然後選取共用資料來源或在報表中建立內嵌資料來源。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-119">In Report Builder, browse to a report server or SharePoint site and select shared data sources or create embedded data sources in the report.</span></span> <span data-ttu-id="cf3d1-120">您無法在報表產生器中建立共用資料來源。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-120">You cannot create a shared data source in Report Builder.</span></span> <span data-ttu-id="cf3d1-121">您無法在報表產生器中使用自訂資料延伸模組。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-121">You cannot use custom data extensions in Report Builder</span></span>

##  <a name="built-in-data-extensions"></a><a name="bkmk_DataConnections"></a><span data-ttu-id="cf3d1-122">內建資料延伸模組</span><span class="sxs-lookup"><span data-stu-id="cf3d1-122">Built-in data extensions</span></span>
 <span data-ttu-id="cf3d1-123">[!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] 中預設的資料延伸模組包括下列資料連接類型：</span><span class="sxs-lookup"><span data-stu-id="cf3d1-123">Default data extensions in [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] include the following types of data connections:</span></span>

-   <span data-ttu-id="cf3d1-124">Microsoft SQL Server</span><span class="sxs-lookup"><span data-stu-id="cf3d1-124">Microsoft SQL Server</span></span>

-   <span data-ttu-id="cf3d1-125">Microsoft SQL Server Analysis Services</span><span class="sxs-lookup"><span data-stu-id="cf3d1-125">Microsoft SQL Server Analysis Services</span></span>

-   <span data-ttu-id="cf3d1-126">Microsoft SharePoint 清單</span><span class="sxs-lookup"><span data-stu-id="cf3d1-126">Microsoft SharePoint List</span></span>

-   [!INCLUDE[ssSDSfull](../includes/sssdsfull-md.md)]

-   <span data-ttu-id="cf3d1-127">Microsoft SQL Server Parallel Data Warehouse</span><span class="sxs-lookup"><span data-stu-id="cf3d1-127">Microsoft SQL Server Parallel Data Warehouse</span></span>

-   <span data-ttu-id="cf3d1-128">OLE DB</span><span class="sxs-lookup"><span data-stu-id="cf3d1-128">OLE DB</span></span>

-   <span data-ttu-id="cf3d1-129">Oracle</span><span class="sxs-lookup"><span data-stu-id="cf3d1-129">Oracle</span></span>

-   <span data-ttu-id="cf3d1-130">SAP NetWeaver BI</span><span class="sxs-lookup"><span data-stu-id="cf3d1-130">SAP NetWeaver BI</span></span>

-   <span data-ttu-id="cf3d1-131">Hyperion Essbase</span><span class="sxs-lookup"><span data-stu-id="cf3d1-131">Hyperion Essbase</span></span>

-   <span data-ttu-id="cf3d1-132">Teradata</span><span class="sxs-lookup"><span data-stu-id="cf3d1-132">Teradata</span></span>

-   <span data-ttu-id="cf3d1-133">XML</span><span class="sxs-lookup"><span data-stu-id="cf3d1-133">XML</span></span>

-   <span data-ttu-id="cf3d1-134">ODBC</span><span class="sxs-lookup"><span data-stu-id="cf3d1-134">ODBC</span></span>

-   <span data-ttu-id="cf3d1-135">Power View 的 Microsoft BI 語意模型：在已為 PowerPivot 圖庫與 [!INCLUDE[ssCrescent](../includes/sscrescent-md.md)]設定 SharePoint 的網站上，可以使用此資料來源。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-135">Microsoft BI Semantic Model for Power View : On a SharePoint site that has been configured for a PowerPivot gallery and [!INCLUDE[ssCrescent](../includes/sscrescent-md.md)], this data source type is available.</span></span> <span data-ttu-id="cf3d1-136">此資料來源類型僅用於 [!INCLUDE[ssCrescent](../includes/sscrescent-md.md)] 簡報。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-136">This data source type is used only for [!INCLUDE[ssCrescent](../includes/sscrescent-md.md)] presentations.</span></span> <span data-ttu-id="cf3d1-137">如需詳細資訊，請參閱 [建立 Power View 的完整 BI 語意表格式模型](https://technet.microsoft.com/video/building-the-perfect-bi-semantic-tabular-models-for-power-view.aspx)。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-137">For more information, see [Building the Perfect BI Semantic Tabular Models for Power View](https://technet.microsoft.com/video/building-the-perfect-bi-semantic-tabular-models-for-power-view.aspx).</span></span>

 <span data-ttu-id="cf3d1-138">如需 [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] 支援之資料來源與版本的完整清單，請參閱 [Reporting Services 支援的資料來源 &#40;SSRS&#41;](create-deploy-and-manage-mobile-and-paginated-reports.md)。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-138">For a full list of data sources and versions [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] supports, see [Data Sources Supported by Reporting Services &#40;SSRS&#41;](create-deploy-and-manage-mobile-and-paginated-reports.md).</span></span>

##  <a name="create-a-data-source"></a><a name="bkmk_create_data_source"></a><span data-ttu-id="cf3d1-139">建立資料來源</span><span class="sxs-lookup"><span data-stu-id="cf3d1-139">Create a data source</span></span>
 <span data-ttu-id="cf3d1-140">若要建立資料來源，您必須擁有下列資訊：</span><span class="sxs-lookup"><span data-stu-id="cf3d1-140">To create a data source, you must have the following information:</span></span>

-   <span data-ttu-id="cf3d1-141">**資料來源類型**連線類型，例如 [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-141">**Data source type** The connection type, for example, [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="cf3d1-142">請從連接類型的下拉式清單中選擇此值。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-142">Choose this value from the drop-down list of connection types.</span></span>

-   <span data-ttu-id="cf3d1-143">**連接資訊** 連接資訊包括資料來源的名稱與位置，以及每個資料提供者專屬的連接屬性。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-143">**Connection information** Connection information includes the name and location of the data source, and connection properties that are specific to each data provider.</span></span> <span data-ttu-id="cf3d1-144">*「連接字串」* (Connection String) 是連接資訊的文字表示。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-144">The *connection string* is the text representation of connection information.</span></span> <span data-ttu-id="cf3d1-145">例如，如果資料來源是 SQL Server 資料庫，您就可以指定資料庫的名稱。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-145">For example, if the data source is a SQL Server database, you can specify the name of the database.</span></span> <span data-ttu-id="cf3d1-146">若是內嵌的資料來源，您也可以撰寫以運算式為基礎的連接字串，在執行階段接受評估。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-146">For embedded data sources, you can also write expression-based connection strings that are evaluated at run time.</span></span> <span data-ttu-id="cf3d1-147">如需詳細資訊，請參閱本主題稍後的 [以運算式為基礎的連接字串](#bkmk_Expressions_in_connection_strings) 。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-147">For more information, see [Expression-based Connection Strings](#bkmk_Expressions_in_connection_strings) later in this topic.</span></span>

-   <span data-ttu-id="cf3d1-148">**認證** 您可以提供存取資料所需的認證。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-148">**Credentials** You provide the credentials that are needed to access the data.</span></span> <span data-ttu-id="cf3d1-149">資料來源擁有者必須已經授與您適當的權限，您才能同時存取資料來源及資料來源上的特定資料。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-149">The data source owner must have granted you the appropriate permissions to access both the data source and the specific data on the data source.</span></span> <span data-ttu-id="cf3d1-150">例如，若要連接到網路伺服器上所安裝的 [!INCLUDE[ssSampleDBnormal](../includes/sssampledbnormal-md.md)] 範例資料庫，您必須擁有連接伺服器的權限，以及存取資料庫的唯讀權限。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-150">For example, to connect to the [!INCLUDE[ssSampleDBnormal](../includes/sssampledbnormal-md.md)] sample database installed on a network server, you must have permission to connect to the server and also read-only permission to access the database.</span></span>

    > [!NOTE]
    >  <span data-ttu-id="cf3d1-151">根據設計，認證會與資料來源分開管理。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-151">By design, credentials are managed independently from data sources.</span></span> <span data-ttu-id="cf3d1-152">在本機系統上用於預覽報表的認證可能與檢視已發行之報表所需的認證不同。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-152">Credentials that you use to preview your report on a local system may differ from credentials you need to view your published report.</span></span> <span data-ttu-id="cf3d1-153">將資料來源儲存至報表伺服器或 SharePoint 網站之後，您可能必須變更認證，才能從該位置工作。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-153">After you save a data source to the report server or SharePoint site, you might need to change the credentials to work from that location.</span></span> <span data-ttu-id="cf3d1-154">如需詳細資訊，請參閱＜ [資料來源的認證](#bkmk_credentials)＞。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-154">For more information, see [Credentials for Data Sources](#bkmk_credentials).</span></span>

> [!NOTE]
>  <span data-ttu-id="cf3d1-155">當您在 [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)]中，為報表建立內嵌資料來源時，就必須在 [方案總管] 或 [報表資料] 窗格 (而非 [伺服器總管]) 的報表設計師中建立資料來源。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-155">When you create an embedded data source for a report in [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)], you must create the data source in Report Designer in either Solution Explorer or the Report Data pane, but not in Server Explorer.</span></span> [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="cf3d1-156">報表設計師不支援在 [伺服器總管] 中建立的 [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] 資料來源。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-156">Report Designer does not support [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] data sources created in Server Explorer.</span></span>

 <span data-ttu-id="cf3d1-157">[報表資料] 窗格會顯示內嵌資料來源以及已經加入至報表之共用資料來源的參考。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-157">The Report Data pane displays embedded data sources and references to shared data sources that have been added to the report.</span></span> <span data-ttu-id="cf3d1-158">在報表產生器中，共用資料來源參考會指向報表伺服器或 SharePoint 網站上的共用資料來源。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-158">In Report Builder, a shared data source reference points to a shared data source on a report server or SharePoint site.</span></span> <span data-ttu-id="cf3d1-159">在報表設計師中，共用資料來源參考會指向 [方案總管] 中 [共用資料來源] 資料夾底下的共用資料來源。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-159">In Report Designer, a shared data source reference points to a shared data source in Solution Explorer under the Shared Data Source folder.</span></span>

##  <a name="credentials-for-data-sources"></a><a name="bkmk_credentials"></a><span data-ttu-id="cf3d1-160">資料來源的認證</span><span class="sxs-lookup"><span data-stu-id="cf3d1-160">Credentials for data sources</span></span>
 <span data-ttu-id="cf3d1-161">根據設計，認證可以與連接資訊分開儲存和管理。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-161">By design, credentials can be saved and managed independently from connection information.</span></span> <span data-ttu-id="cf3d1-162">認證是用來建立資料來源、執行資料集查詢，以及預覽報表。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-162">Credentials are used to create a data source, to run a dataset query, and to preview a report.</span></span>

> [!NOTE]
>  <span data-ttu-id="cf3d1-163">我們建議您不要在資料來源的連接屬性中加入登入資訊，例如登入名稱和密碼。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-163">We recommend that you do not include login information, such as login names and passwords, to the connection properties of the data source.</span></span> <span data-ttu-id="cf3d1-164">請盡可能使用共用資料來源搭配預存認證。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-164">Use shared data sources with stored credentials whenever possible.</span></span> <span data-ttu-id="cf3d1-165">在撰寫環境中，當您建立資料連接或執行資料集查詢時，請使用 **[資料來源]** 對話方塊的 [認證] 頁面來輸入認證。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-165">In an authoring environment, use the Credentials page of the **Data Source** dialog box to enter credentials when you create a data connection or run a dataset query.</span></span>

 <span data-ttu-id="cf3d1-166">您針對從電腦進行資料存取所輸入的認證會安全地儲存在本機專案組態檔中，而且是該電腦專用的。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-166">Credentials that you enter for data access from your computer are stored securely in the local project configuration file and are specific to your computer.</span></span> <span data-ttu-id="cf3d1-167">如果您將專案檔案複製到其他電腦，則必須重新定義資料來源的認證。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-167">If you copy the project files to another computer, you must redefine the credentials for the data source.</span></span>

 <span data-ttu-id="cf3d1-168">當您將報表部署至報表伺服器或 SharePoint 網站時，其內嵌和共用資料來源就會分開管理。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-168">When you deploy a report to the report server or SharePoint site, its embedded and shared data sources are managed independently.</span></span> <span data-ttu-id="cf3d1-169">從電腦存取資料所需的資料來源認證可能與報表伺服器存取資料所需的認證不同。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-169">The data source credentials needed to access the data from your computer may differ from the credentials needed for the report server to access the data.</span></span>

 <span data-ttu-id="cf3d1-170">![注意](media/rs-fyinote.png "注意")最好的作法是在發行報表之後，確認資料來源連接是否繼續連接成功。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-170">![note](media/rs-fyinote.png "note")A good practice is to verify that the data source connections continue to connect successfully after you publish a report.</span></span> <span data-ttu-id="cf3d1-171">如果您需要變更認證，可以直接在報表伺服器上進行修改。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-171">If you need to change the credentials, you can modify them directly on the report server.</span></span>

 <span data-ttu-id="cf3d1-172">若要變更報表所使用的資料來源，您可以在原生模式中修改報告屬性，報表管理員或從 SharePoint 模式的文件庫。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-172">To change the data sources that a report uses, you can modify the report properties in Native mode Report Manager or from document libraries in SharePoint mode.</span></span> <span data-ttu-id="cf3d1-173">如需詳細資訊，請參閱下列：</span><span class="sxs-lookup"><span data-stu-id="cf3d1-173">For more information, see the following:</span></span>

-   <span data-ttu-id="cf3d1-174">[將認證儲存在](report-data/store-credentials-in-a-reporting-services-data-source.md) [Reporting Services 資料來源中](report-data/store-credentials-in-a-reporting-services-data-source.md)的 Reporting Services 資料來源存放區認證</span><span class="sxs-lookup"><span data-stu-id="cf3d1-174">[Store Credentials in a Reporting Services Data Source](report-data/store-credentials-in-a-reporting-services-data-source.md) [Store Credentials in a Reporting Services Data Source](report-data/store-credentials-in-a-reporting-services-data-source.md)</span></span>

-   [<span data-ttu-id="cf3d1-175">指定報表資料來源的認證及連線資訊</span><span class="sxs-lookup"><span data-stu-id="cf3d1-175">Specify Credential and Connection Information for Report Data Sources</span></span>](report-data/specify-credential-and-connection-information-for-report-data-sources.md)

-   [<span data-ttu-id="cf3d1-176">為自訂資料處理延伸模組指定連接</span><span class="sxs-lookup"><span data-stu-id="cf3d1-176">Specify Connections for Custom Data Processing Extensions</span></span>](report-data/specify-connections-for-custom-data-processing-extensions.md)

-   [<span data-ttu-id="cf3d1-177">在報表產生器中指定認證</span><span class="sxs-lookup"><span data-stu-id="cf3d1-177">Specify Credentials in Report Builder</span></span>](../../2014/reporting-services/specify-credentials-in-report-builder.md)

-   [<span data-ttu-id="cf3d1-178">加入及驗證資料連線或資料來源 &#40;報表產生器和 SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="cf3d1-178">Add and Verify a Data Connection or Data Source &#40;Report Builder and SSRS&#41;</span></span>](report-data/add-and-verify-a-data-connection-report-builder-and-ssrs.md)

##  <a name="common-connection-string-examples"></a><a name="bkmk_connection_examples"></a> <span data-ttu-id="cf3d1-179">一般連接字串範例</span><span class="sxs-lookup"><span data-stu-id="cf3d1-179">Common connection string examples</span></span>
 <span data-ttu-id="cf3d1-180">連接字串是資料提供者之連接屬性的文字表示。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-180">Connection strings are the text representation of connection properties for a data provider.</span></span> <span data-ttu-id="cf3d1-181">下表列出各種資料連接類型之連接字串的範例。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-181">The following table lists examples of connections strings for various data connection types.</span></span>

|<span data-ttu-id="cf3d1-182">**資料來源**</span><span class="sxs-lookup"><span data-stu-id="cf3d1-182">**Data source**</span></span>|<span data-ttu-id="cf3d1-183">**範例**</span><span class="sxs-lookup"><span data-stu-id="cf3d1-183">**Example**</span></span>|<span data-ttu-id="cf3d1-184">**說明**</span><span class="sxs-lookup"><span data-stu-id="cf3d1-184">**Description**</span></span>|
|---------------------|-----------------|---------------------|
|<span data-ttu-id="cf3d1-185">本機伺服器上的 SQL Server 資料庫</span><span class="sxs-lookup"><span data-stu-id="cf3d1-185">SQL Server database on the local server</span></span>|`data source="(local)";initial catalog=AdventureWorks`|<span data-ttu-id="cf3d1-186">將資料來源類型設定為 `Microsoft SQL Server`。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-186">Set data source type to `Microsoft SQL Server`.</span></span> <span data-ttu-id="cf3d1-187">如需詳細資訊，請參閱 [SQL Server 連接類型 &#40;SSRS&#41;](report-data/sql-server-connection-type-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-187">For more information, see [SQL Server Connection Type &#40;SSRS&#41;](report-data/sql-server-connection-type-ssrs.md).</span></span>|
|<span data-ttu-id="cf3d1-188">本機伺服器上的 SQL Server 資料庫</span><span class="sxs-lookup"><span data-stu-id="cf3d1-188">SQL Server database on the local server</span></span>|`data source="(local)";initial catalog=AdventureWorks`|<span data-ttu-id="cf3d1-189">將資料來源類型設定為 `Microsoft SQL Server`。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-189">Set data source type to `Microsoft SQL Server`.</span></span>|
|<span data-ttu-id="cf3d1-190">SQL Server 執行個體</span><span class="sxs-lookup"><span data-stu-id="cf3d1-190">SQL Server Instance</span></span><br /><br /> <span data-ttu-id="cf3d1-191">[資料庫]</span><span class="sxs-lookup"><span data-stu-id="cf3d1-191">database</span></span>|`Data Source=localhost\MSSQL10_50.InstanceName; Initial Catalog=AdventureWorks`|<span data-ttu-id="cf3d1-192">將資料來源類型設定為 `Microsoft SQL Server`。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-192">Set data source type to `Microsoft SQL Server`.</span></span>|
|<span data-ttu-id="cf3d1-193">SQL Server Express 資料庫</span><span class="sxs-lookup"><span data-stu-id="cf3d1-193">SQL Server Express database</span></span>|`Data Source=localhost\MSSQL10_50.SQLEXPRESS; Initial Catalog=AdventureWorks`|<span data-ttu-id="cf3d1-194">將資料來源類型設定為 `Microsoft SQL Server`。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-194">Set data source type to `Microsoft SQL Server`.</span></span>|
|[!INCLUDE[ssSDS](../includes/sssds-md.md)]<span data-ttu-id="cf3d1-195">在雲端中</span><span class="sxs-lookup"><span data-stu-id="cf3d1-195">in the cloud</span></span>|`Data Source=<host>;Initial Catalog=AdventureWorks; Encrypt=True`|<span data-ttu-id="cf3d1-196">將資料來源類型設定為 `Azure SQL Database`。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-196">Set data source type to `Azure SQL Database`.</span></span> <span data-ttu-id="cf3d1-197">如需詳細資訊，請參閱 [SQL Azure 連接類型 &#40;SSRS&#41;](report-data/sql-azure-connection-type-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-197">For more information, see [SQL Azure Connection Type &#40;SSRS&#41;](report-data/sql-azure-connection-type-ssrs.md).</span></span>|
|<span data-ttu-id="cf3d1-198">SQL Server 平行資料倉儲</span><span class="sxs-lookup"><span data-stu-id="cf3d1-198">SQL Server Parallel Data Warehouse</span></span>|`HOST=<IP address>;database= AdventureWorks; port=<port>`|<span data-ttu-id="cf3d1-199">將資料來源類型設定為 `Microsoft SQL Server Parallel Data Warehouse`。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-199">Set data source type to `Microsoft SQL Server Parallel Data Warehouse`.</span></span> <span data-ttu-id="cf3d1-200">如需詳細資訊，請參閱 [SQL Server 平行資料倉儲連接類型 &#40;SSRS&#41;](report-data/sql-server-parallel-data-warehouse-connection-type-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-200">For more information, see [SQL Server Parallel Data Warehouse Connection Type &#40;SSRS&#41;](report-data/sql-server-parallel-data-warehouse-connection-type-ssrs.md).</span></span>|
|<span data-ttu-id="cf3d1-201">本機伺服器上的 Analysis Services 資料庫</span><span class="sxs-lookup"><span data-stu-id="cf3d1-201">Analysis Services database on the local server</span></span>|`data source=localhost;initial catalog=Adventure Works DW`|<span data-ttu-id="cf3d1-202">將資料來源類型設定為 `Microsoft SQL Server Analysis Services`。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-202">Set data source type to `Microsoft SQL Server Analysis Services`.</span></span> <span data-ttu-id="cf3d1-203">如需詳細資訊，請參閱 [MDX 的 Analysis Services 連線類型 &#40;SSRS&#41;](report-data/analysis-services-connection-type-for-mdx-ssrs.md) 或 [DMX 的 Analysis Services 連線類型 &#40;SSRS&#41;](report-data/analysis-services-connection-type-for-dmx-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-203">For more information, see [Analysis Services Connection Type for MDX &#40;SSRS&#41;](report-data/analysis-services-connection-type-for-mdx-ssrs.md) or [Analysis Services Connection Type for DMX &#40;SSRS&#41;](report-data/analysis-services-connection-type-for-dmx-ssrs.md).</span></span>|
|<span data-ttu-id="cf3d1-204">具有 Sales 檢視方塊的 Analysis Services 表格式模型資料庫</span><span class="sxs-lookup"><span data-stu-id="cf3d1-204">Analysis Services tabular model database with Sales perspective</span></span>|`Data source=<servername>;initial catalog= Adventure Works DW;cube='Sales'`|<span data-ttu-id="cf3d1-205">將資料來源類型設定為 `Microsoft SQL Server Analysis Services`。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-205">Set data source type to `Microsoft SQL Server Analysis Services`.</span></span> <span data-ttu-id="cf3d1-206">在 cube= 設定中指定檢視方塊名稱。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-206">Specify perspective name in cube= setting.</span></span> <span data-ttu-id="cf3d1-207">如需詳細資訊，請參閱 [檢視方塊 &#40;SSAS 表格式&#41;](https://docs.microsoft.com/analysis-services/tabular-models/perspectives-ssas-tabular)。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-207">For more information, see [Perspectives &#40;SSAS Tabular&#41;](https://docs.microsoft.com/analysis-services/tabular-models/perspectives-ssas-tabular).</span></span>|
|<span data-ttu-id="cf3d1-208">在原生模式設定之報表伺服器上的報表模型資料來源</span><span class="sxs-lookup"><span data-stu-id="cf3d1-208">Report model data source on a report server configured in native mode</span></span>|`Server=http://myreportservername/reportserver; datasource=/models/Adventure Works`|<span data-ttu-id="cf3d1-209">指定報表伺服器或文件庫 URL 以及報表伺服器資料或文件庫資料夾命名空間中已發行模型的路徑。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-209">Specify the report server or document library URL and the path to the published model in the report server folder or document library folder namespace.</span></span>
|<span data-ttu-id="cf3d1-210">在 SharePoint 整合模式設定之報表伺服器上的報表模型資料來源</span><span class="sxs-lookup"><span data-stu-id="cf3d1-210">Report model data source on a report server configured in SharePoint integrated mode</span></span>|`Server=http://server; datasource=http://server/site/documents/models/Adventure Works.smdl`|<span data-ttu-id="cf3d1-211">指定報表伺服器或文件庫 URL 以及報表伺服器資料或文件庫資料夾命名空間中已發行模型的路徑。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-211">Specify the report server or document library URL and the path to the published model in the report server folder or document library folder namespace.</span></span>|
|[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="cf3d1-212">2000 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 伺服器</span><span class="sxs-lookup"><span data-stu-id="cf3d1-212">2000 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] server</span></span>|`provider=MSOLAP.2;data source=<remote server name>;initial catalog=FoodMart 2000`|<span data-ttu-id="cf3d1-213">將資料來源類型設定為 `OLE DB Provider for OLAP Services 8.0`。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-213">Set the data source type to `OLE DB Provider for OLAP Services 8.0`.</span></span><br /><br /> <span data-ttu-id="cf3d1-214">如果將 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 屬性設定為 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)]，則可以加快 `ConnectTo` 2000 `8.0` 資料來源的連接。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-214">You can achieve a faster connection to [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2000 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] data sources if you set the `ConnectTo` property to `8.0`.</span></span> <span data-ttu-id="cf3d1-215">若要設定這個屬性，請使用 **[連接屬性]** 對話方塊的 **[進階屬性]** 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-215">To set this property, use the **Connection Properties** dialog box, **Advanced Properties** tab.</span></span>|
|<span data-ttu-id="cf3d1-216">Oracle 伺服器</span><span class="sxs-lookup"><span data-stu-id="cf3d1-216">Oracle server</span></span>|`data source=myserver`|<span data-ttu-id="cf3d1-217">將資料來源類型設定為 `Oracle`。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-217">Set the data source type to `Oracle`.</span></span> <span data-ttu-id="cf3d1-218">Oracle 用戶端工具必須安裝在報表設計師電腦和報表伺服器上。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-218">The Oracle client tools must be installed on the Report Designer computer and on the report server.</span></span> <span data-ttu-id="cf3d1-219">如需詳細資訊，請參閱 [Oracle 連接類型 &#40;SSRS&#41;](report-data/oracle-connection-type-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-219">For more information, see [Oracle Connection Type &#40;SSRS&#41;](report-data/oracle-connection-type-ssrs.md).</span></span>|
|<span data-ttu-id="cf3d1-220">SAP NetWeaver BI 資料來源</span><span class="sxs-lookup"><span data-stu-id="cf3d1-220">SAP NetWeaver BI data source</span></span>|`DataSource=http://mySAPNetWeaverBIServer:8000/sap/bw/xml/soap/xmla`|<span data-ttu-id="cf3d1-221">將資料來源類型設定為 `SAP NetWeaver BI`。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-221">Set the data source type to `SAP NetWeaver BI`.</span></span> <span data-ttu-id="cf3d1-222">如需詳細資訊，請參閱 [SAP NetWeaver BI 連接類型 &#40;SSRS&#41;](report-data/sap-netweaver-bi-connection-type-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-222">For more information, see [SAP NetWeaver BI Connection Type &#40;SSRS&#41;](report-data/sap-netweaver-bi-connection-type-ssrs.md).</span></span>|
|<span data-ttu-id="cf3d1-223">Hyperion Essbase 資料來源</span><span class="sxs-lookup"><span data-stu-id="cf3d1-223">Hyperion Essbase data source</span></span>|`Data Source=http://localhost:13080/aps/XMLA; Initial Catalog=Sample`|<span data-ttu-id="cf3d1-224">將資料來源類型設定為 `Hyperion Essbase`。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-224">Set the data source type to `Hyperion Essbase`.</span></span> <span data-ttu-id="cf3d1-225">如需詳細資訊，請參閱 [Hyperion Essbase 連接類型 &#40;SSRS&#41;](report-data/hyperion-essbase-connection-type-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-225">For more information, see [Hyperion Essbase Connection Type &#40;SSRS&#41;](report-data/hyperion-essbase-connection-type-ssrs.md).</span></span>|
|<span data-ttu-id="cf3d1-226">Teradata 資料來源</span><span class="sxs-lookup"><span data-stu-id="cf3d1-226">Teradata data source</span></span>|<span data-ttu-id="cf3d1-227">`data source=`\<NNN>.\<NNN>.\<NNN>.\<NNN>`;`</span><span class="sxs-lookup"><span data-stu-id="cf3d1-227">`data source=`\<NNN>.\<NNN>.\<NNN>.\<NNN>`;`</span></span>|<span data-ttu-id="cf3d1-228">將資料來源類型設定為 `Teradata`。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-228">Set the data source type to `Teradata`.</span></span> <span data-ttu-id="cf3d1-229">連接字串是四個欄位形式的網際網路通訊協定 (IP) 位址，其中每個欄位都可以是 1 到 3 位數。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-229">The connection string is an Internet Protocol (IP) address in the form of four fields, where each field can be from one to three digits.</span></span> <span data-ttu-id="cf3d1-230">如需詳細資訊，請參閱 [Teradata 連線類型 &#40;SSRS&#41;](report-data/teradata-connection-type-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-230">For more information, see [Teradata Connection Type &#40;SSRS&#41;](report-data/teradata-connection-type-ssrs.md).</span></span>|
|<span data-ttu-id="cf3d1-231">XML 資料來源, Web 服務</span><span class="sxs-lookup"><span data-stu-id="cf3d1-231">XML data source, Web service</span></span>|`data source=http://adventure-works.com/results.aspx`|<span data-ttu-id="cf3d1-232">將資料來源類型設定為 `XML`。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-232">Set the data source type to `XML`.</span></span> <span data-ttu-id="cf3d1-233">連接字串是支援 Web 服務定義語言 (WSDL) 之 Web 服務的 URL。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-233">The connection string is a URL for a web service that supports Web Services Definition Language (WSDL).</span></span> <span data-ttu-id="cf3d1-234">如需詳細資訊，請參閱 [XML 連線類型 &#40;SSRS&#41;](report-data/xml-connection-type-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-234">For more information, see [XML Connection Type &#40;SSRS&#41;](report-data/xml-connection-type-ssrs.md).</span></span>|
|<span data-ttu-id="cf3d1-235">XML 資料來源、XML 文件</span><span class="sxs-lookup"><span data-stu-id="cf3d1-235">XML data source, XML document</span></span>|`http://localhost/XML/Customers.xml`|<span data-ttu-id="cf3d1-236">將資料來源類型設定為 `XML`。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-236">Set the data source type to `XML`.</span></span> <span data-ttu-id="cf3d1-237">連接字串是 XML 文件的 URL。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-237">The connection string is a URL to the XML document.</span></span>|
|<span data-ttu-id="cf3d1-238">XML 資料來源, 內嵌 XML 文件</span><span class="sxs-lookup"><span data-stu-id="cf3d1-238">XML data source, embedded XML document</span></span>|<span data-ttu-id="cf3d1-239">*空白*</span><span class="sxs-lookup"><span data-stu-id="cf3d1-239">*Empty*</span></span>|<span data-ttu-id="cf3d1-240">將資料來源類型設定為 `XML`。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-240">Set the data source type to `XML`.</span></span> <span data-ttu-id="cf3d1-241">XML 資料內嵌在報表定義中。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-241">The XML data is embedded in the report definition.</span></span>|

<span data-ttu-id="cf3d1-242">如果無法使用 `localhost` 連接到報表伺服器，請檢查 TCP/IP 通訊協定的網路通訊協定是否已啟用。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-242">If you fail to connect to a report server using `localhost`, check that the network protocol for TCP/IP protocol is enabled.</span></span> <span data-ttu-id="cf3d1-243">如需詳細資訊，請參閱 [Configure Client Protocols](../database-engine/configure-windows/configure-client-protocols.md)。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-243">For more information, see [Configure Client Protocols](../database-engine/configure-windows/configure-client-protocols.md).</span></span>

##  <a name="special-characters-in-a-password"></a><a name="bkmk_special_password_characters"></a> <span data-ttu-id="cf3d1-244">密碼中的特殊字元</span><span class="sxs-lookup"><span data-stu-id="cf3d1-244">Special characters in a password</span></span>
 <span data-ttu-id="cf3d1-245">如果您設定 ODBC 或 SQL 資料來源以提示密碼或將密碼包含在連接字串中，則當使用者輸入含有特殊字元 (例如：標點符號) 的密碼時，某些基礎資料來源驅動程式無法驗證這些特殊字元。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-245">If you configure your ODBC or SQL data source to prompt for a password or to include the password in the connection string, and a user enters the password with special characters like punctuation marks, some underlying data source drivers cannot validate the special characters.</span></span> <span data-ttu-id="cf3d1-246">當您處理報表時，訊息「不是有效密碼」可能會指出此問題。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-246">When you process the report, the message "Not a valid password" may indicate this problem.</span></span> <span data-ttu-id="cf3d1-247">如果無法變更密碼，您可以洽詢資料庫管理員，將適當的認證儲存在伺服器上，做為系統 ODBC 資料來源名稱 (DSN) 的一部分。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-247">If changing the password is impractical, you can work with your database administrator to store the appropriate credentials on the server as part of a system ODBC data source name (DSN).</span></span> <span data-ttu-id="cf3d1-248">如需詳細資訊，請參閱 [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] SDK 文件集中的＜OdbcConnection.ConnectionString＞。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-248">For more information, see "OdbcConnection.ConnectionString" in the [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] SDK documentation.</span></span>

##  <a name="expression-based-connection-strings"></a><a name="bkmk_Expressions_in_connection_strings"></a><span data-ttu-id="cf3d1-249">以運算式為基礎的連接字串</span><span class="sxs-lookup"><span data-stu-id="cf3d1-249">Expression-based Connection Strings</span></span>
 <span data-ttu-id="cf3d1-250">以運算式為基礎的連接字串是在執行階段進行評估。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-250">Expression-based connection strings are evaluated at run time.</span></span> <span data-ttu-id="cf3d1-251">例如，您可以將資料來源指定為參數，包括連接字串中的參數參考，並允許使用者選擇報表的資料來源。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-251">For example, you can specify the data source as a parameter, include the parameter reference in the connection string, and allow the user to choose a data source for the report.</span></span> <span data-ttu-id="cf3d1-252">例如，假設有一家跨國企業，在許多國家 (地區) 有資料伺服器。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-252">For example, suppose a multinational firm has data servers in several countries.</span></span> <span data-ttu-id="cf3d1-253">執行銷售報表的使用者可以在執行報表之前，使用以運算式為基礎的連接字串，來選取特定國家 (地區) 的資料來源。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-253">With an expression-based connection string, a user who is running a sales report can select a data source for a particular country before running the report.</span></span>

 <span data-ttu-id="cf3d1-254">下列範例說明在 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 連接字串中，使用資料來源運算式。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-254">The following example illustrates the use of a data source expression in a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] connection string.</span></span> <span data-ttu-id="cf3d1-255">本範例假設您已經建立一個名為 `ServerName`的報表參數：</span><span class="sxs-lookup"><span data-stu-id="cf3d1-255">The example assumes you have created a report parameter named `ServerName`:</span></span>

```
="data source=" & Parameters!ServerName.Value & ";initial catalog=AdventureWorks"
```

 <span data-ttu-id="cf3d1-256">資料來源運算式是在執行階段，或者在預覽報表時處理。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-256">Data source expressions are processed at run time or when a report is previewed.</span></span> <span data-ttu-id="cf3d1-257">運算式必須以 [!INCLUDE[vbprvb](../includes/vbprvb-md.md)]撰寫。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-257">The expression must be written in [!INCLUDE[vbprvb](../includes/vbprvb-md.md)].</span></span> <span data-ttu-id="cf3d1-258">定義資料來源運算式時，請使用下列指導方針：</span><span class="sxs-lookup"><span data-stu-id="cf3d1-258">Use the following guidelines when defining a data source expression:</span></span>

-   <span data-ttu-id="cf3d1-259">使用靜態連接字串設計報表。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-259">Design the report using a static connection string.</span></span> <span data-ttu-id="cf3d1-260">靜態連接字串是指未透過運算式設定的連接字串 (例如，您遵循建立報表特定或共用資料來源的步驟執行時，所定義的就是靜態連接字串)。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-260">A static connection string refers to a connection string that is not set through an expression (for example, when you follow the steps for creating a report-specific or shared data source, you are defining a static connection string).</span></span> <span data-ttu-id="cf3d1-261">使用靜態連接字串可以讓您連接到報表設計師中的資料來源，以便取得建立報表所需的查詢結果。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-261">Using a static connection string allows you to connect to the data source in Report Designer so that you can get the query results you need to create the report.</span></span>

-   <span data-ttu-id="cf3d1-262">定義資料來源連接時，請勿使用共用資料來源。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-262">When defining the data source connection, do not use a shared data source.</span></span> <span data-ttu-id="cf3d1-263">您不能在共用資料來源中使用資料來源運算式。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-263">You cannot use a data source expression in a shared data source.</span></span> <span data-ttu-id="cf3d1-264">您必須為報表定義內嵌的資料來源。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-264">You must define an embedded data source for the report.</span></span>

-   <span data-ttu-id="cf3d1-265">分開指定認證與連接字串。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-265">Specify credentials separately from the connection string.</span></span> <span data-ttu-id="cf3d1-266">您可以使用預存認證、提示認證或整合式安全性。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-266">You can use stored credentials, prompted credentials, or integrated security.</span></span>

-   <span data-ttu-id="cf3d1-267">加入報表參數，以指定資料來源。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-267">Add a report parameter to specify a data source.</span></span> <span data-ttu-id="cf3d1-268">針對參數值，您可以提供靜態可用的值清單 (在此情況下，可用的值應為可以搭配報表使用的資料來源)，或者定義在執行階段擷取資料來源清單的查詢。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-268">For parameter values, you can either provide a static list of available values (in this case, the available values should be data sources you can use with the report) or define a query that retrieves a list of data sources at run time.</span></span>

-   <span data-ttu-id="cf3d1-269">請確定資料來源清單共用相同的資料庫結構描述。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-269">Be sure that the list of data sources shares the same database schema.</span></span> <span data-ttu-id="cf3d1-270">所有的報表設計都是從結構描述資訊開始。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-270">All report design begins with schema information.</span></span> <span data-ttu-id="cf3d1-271">如果用於定義報表的結構描述，和報表在執行階段使用的實際結構描述不符，報表可能不會執行。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-271">If there is a mismatch between the schema used to define the report and the actual schema used by the report at run time, the report might not run.</span></span>

-   <span data-ttu-id="cf3d1-272">發行報表之前，請以運算式取代靜態連接字串。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-272">Before publishing the report, replace the static connection string with an expression.</span></span> <span data-ttu-id="cf3d1-273">等到設計好報表之後，再以運算式取代靜態連接字串。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-273">Wait until you are finished designing the report before you replace the static connection string with an expression.</span></span> <span data-ttu-id="cf3d1-274">一旦使用運算式，就不能在報表設計師中執行查詢。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-274">Once you use an expression, you cannot execute the query in Report Designer.</span></span> <span data-ttu-id="cf3d1-275">此外，[報表資料] 窗格中的欄位清單與 [參數] 清單也不會自動更新。</span><span class="sxs-lookup"><span data-stu-id="cf3d1-275">Furthermore, the field list in the Report Data pane and the Parameters list will not update automatically.</span></span>

## <a name="see-also"></a><span data-ttu-id="cf3d1-276">另請參閱</span><span class="sxs-lookup"><span data-stu-id="cf3d1-276">See Also</span></span>
 <span data-ttu-id="cf3d1-277">[內嵌和共用資料連線或資料來源 &#40;報表產生器和 ssrs&#41;](../../2014/reporting-services/embedded-and-shared-data-connections-or-data-sources-report-builder-and-ssrs.md) [管理報表資料](report-data/manage-report-data-sources.md)源 [[資料來源屬性] 對話方塊、[認證](../../2014/reporting-services/data-source-properties-dialog-box-credentials.md) [] [共用資料來源屬性] 對話方塊、[認證] [](../../2014/reporting-services/shared-data-source-properties-dialog-box-credentials.md) [建立]、[修改] 和 [刪除共用資料來源] &#40;SSRS&#41;](report-data/create-modify-and-delete-shared-data-sources-ssrs.md) [設定部署屬性 &#40;Reporting Services](tools/set-deployment-properties-reporting-services.md)&#41;[指定報表資料來源的認證和連接資訊](report-data/specify-credential-and-connection-information-for-report-data-sources.md)&#40;[報表產生器和 SSRS&#41;](report-data/add-and-verify-a-data-connection-report-builder-and-ssrs.md)</span><span class="sxs-lookup"><span data-stu-id="cf3d1-277">[Embedded and Shared Data Connections or Data Sources &#40;Report Builder and SSRS&#41;](../../2014/reporting-services/embedded-and-shared-data-connections-or-data-sources-report-builder-and-ssrs.md) [Manage Report Data Sources](report-data/manage-report-data-sources.md) [Data Source Properties Dialog Box, Credentials](../../2014/reporting-services/data-source-properties-dialog-box-credentials.md) [Shared Data Source Properties Dialog Box, Credentials](../../2014/reporting-services/shared-data-source-properties-dialog-box-credentials.md) [Create, Modify, and Delete Shared Data Sources &#40;SSRS&#41;](report-data/create-modify-and-delete-shared-data-sources-ssrs.md) [Set Deployment Properties &#40;Reporting Services&#41;](tools/set-deployment-properties-reporting-services.md) [Specify Credential and Connection Information for Report Data Sources](report-data/specify-credential-and-connection-information-for-report-data-sources.md) [Add and Verify a Data Connection or Data Source &#40;Report Builder and SSRS&#41;](report-data/add-and-verify-a-data-connection-report-builder-and-ssrs.md)</span></span>
