---
title: 彙總函式參考 (報表產生器及 SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: db6542ee-02d0-4073-90e6-cba8f9510fbb
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: b7c88935b303d36e73741bee17e966ec6616a030
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87704893"
---
# <a name="aggregate-functions-reference-report-builder-and-ssrs"></a><span data-ttu-id="8b4ec-102">彙總函式參考 (報表產生器及 SSRS)</span><span class="sxs-lookup"><span data-stu-id="8b4ec-102">Aggregate Functions Reference (Report Builder and SSRS)</span></span>
  <span data-ttu-id="8b4ec-103">若要在報表中加入彙總值，您可以在運算式中使用內建彙總函式。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-103">To include aggregated values in your report, you can use built-in aggregate functions in expressions.</span></span> <span data-ttu-id="8b4ec-104">數值欄位的預設彙總函式是 SUM。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-104">The default aggregate function for numeric fields is SUM.</span></span> <span data-ttu-id="8b4ec-105">您可以編輯運算式，並使用不同的內建彙總函式或指定不同的範圍。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-105">You can edit the expression and use a different built-in aggregate function or specify a different scope.</span></span> <span data-ttu-id="8b4ec-106">範圍會識別用於計算的資料集。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-106">Scope identifies which set of data to use for the calculation.</span></span>  
  
 <span data-ttu-id="8b4ec-107">當報表處理器結合報表資料和報表配置時，將會評估每一個報表項目的運算式。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-107">As the report processor combines report data and the report layout, the expressions for each report item are evaluated.</span></span> <span data-ttu-id="8b4ec-108">當您檢視報表的每一頁時，您會在轉譯的報表項目中看到每一個運算式的結果。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-108">As you view each page of the report, you see the results for each expression in the rendered report items.</span></span>  
  
 <span data-ttu-id="8b4ec-109">下表列出可以包含在運算式中的內建函數類別：</span><span class="sxs-lookup"><span data-stu-id="8b4ec-109">The following table lists categories of built-in functions that you can include in an expression:</span></span>  
  
-   [<span data-ttu-id="8b4ec-110">內建彙總函式</span><span class="sxs-lookup"><span data-stu-id="8b4ec-110">Built-in Aggregate Functions</span></span>](#CalculatingAggregates)  
  
-   [<span data-ttu-id="8b4ec-111">內建欄位、集合和彙總函式的限制</span><span class="sxs-lookup"><span data-stu-id="8b4ec-111">Restrictions on Built-in Fields, Collections, and Aggregate Functions</span></span>](#Restrictions)  
  
-   [<span data-ttu-id="8b4ec-112">巢狀彙總的限制</span><span class="sxs-lookup"><span data-stu-id="8b4ec-112">Restrictions on Nested Aggregates</span></span>](#NestedRestrictions)  
  
-   [<span data-ttu-id="8b4ec-113">計算執行值</span><span class="sxs-lookup"><span data-stu-id="8b4ec-113">Calculating Running Values</span></span>](#CalculatingRunningValues)  
  
-   [<span data-ttu-id="8b4ec-114">擷取資料列計數</span><span class="sxs-lookup"><span data-stu-id="8b4ec-114">Retrieving Row Counts</span></span>](#RetrievingRowCounts)  
  
-   [<span data-ttu-id="8b4ec-115">從其他資料集查詢值</span><span class="sxs-lookup"><span data-stu-id="8b4ec-115">Looking Up Values from Another Dataset</span></span>](#LookupFunctions)  
  
-   [<span data-ttu-id="8b4ec-116">擷取與排序相依的值</span><span class="sxs-lookup"><span data-stu-id="8b4ec-116">Retrieving Sort-Dependent Values</span></span>](#RetrievingPostsortValues)  
  
-   [<span data-ttu-id="8b4ec-117">擷取伺服器彙總</span><span class="sxs-lookup"><span data-stu-id="8b4ec-117">Retrieving Server Aggregates</span></span>](#RetrievingServerAggregates)  
  
-   [<span data-ttu-id="8b4ec-118">擷取遞迴層級</span><span class="sxs-lookup"><span data-stu-id="8b4ec-118">Retrieving Recursive Level</span></span>](#RetrievingRecursiveLevel)  
  
-   [<span data-ttu-id="8b4ec-119">測試範圍</span><span class="sxs-lookup"><span data-stu-id="8b4ec-119">Testing for Scope</span></span>](#TestingforScope)  
  
 <span data-ttu-id="8b4ec-120">若要決定函數的有效範圍，請參閱個別的函數參考主題。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-120">To determine the valid scopes for a function, see the individual function reference topic.</span></span> <span data-ttu-id="8b4ec-121">如需詳細資訊和範例，請參閱 [總計、彙總與內建集合的運算式範圍 &#40;報表產生器及 SSRS&#41;](expression-scope-for-totals-aggregates-and-built-in-collections.md)。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-121">For more information and for examples, see [Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;](expression-scope-for-totals-aggregates-and-built-in-collections.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
##  <a name="built-in-aggregate-functions"></a><a name="CalculatingAggregates"></a> <span data-ttu-id="8b4ec-122">內建彙總函式</span><span class="sxs-lookup"><span data-stu-id="8b4ec-122">Built-in Aggregate Functions</span></span>  
 <span data-ttu-id="8b4ec-123">下列內建函數會針對預設範圍或具名範圍，計算非 Null 數值資料集的摘要值。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-123">The following built-in functions calculate summary values for a set of non-null numeric data in the default scope or the named scope.</span></span>  
  
|<span data-ttu-id="8b4ec-124">**Function**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-124">**Function**</span></span>|<span data-ttu-id="8b4ec-125">**說明**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-125">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="8b4ec-126">Avg</span><span class="sxs-lookup"><span data-stu-id="8b4ec-126">Avg</span></span>](report-builder-functions-avg-function.md)|<span data-ttu-id="8b4ec-127">傳回運算式指定的所有非 Null 數值的平均值 (在給定範圍中評估)。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-127">Returns the average of all non-null numeric values specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="8b4ec-128">Count</span><span class="sxs-lookup"><span data-stu-id="8b4ec-128">Count</span></span>](report-builder-functions-count-function.md)|<span data-ttu-id="8b4ec-129">傳回運算式指定的非 Null 值的計數 (在給定範圍的內容中評估)。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-129">Returns a count of non-null values specified by the expression, evaluated in the context of the given scope.</span></span>|  
|[<span data-ttu-id="8b4ec-130">CountDistinct</span><span class="sxs-lookup"><span data-stu-id="8b4ec-130">CountDistinct</span></span>](report-builder-functions-countdistinct-function.md)|<span data-ttu-id="8b4ec-131">傳回運算式指定的所有非 Null 相異值的計數 (在給定範圍的內容中評估)。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-131">Returns a count of all distinct non-null values specified by the expression, evaluated in the context of the given scope.</span></span>|  
|[<span data-ttu-id="8b4ec-132">Max</span><span class="sxs-lookup"><span data-stu-id="8b4ec-132">Max</span></span>](report-builder-functions-max-function.md)|<span data-ttu-id="8b4ec-133">傳回運算式指定的所有非 Null 數值的最大值 (在給定範圍的內容中)。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-133">Returns the maximum value of all non-null numeric values specified by the expression, in the context of the given scope.</span></span> <span data-ttu-id="8b4ec-134">這個函數可用來指定圖表軸的最大值以控制刻度。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-134">You can use this for specifying a chart axis maximum value to control the scale.</span></span>|  
|[<span data-ttu-id="8b4ec-135">Min</span><span class="sxs-lookup"><span data-stu-id="8b4ec-135">Min</span></span>](report-builder-functions-min-function.md)|<span data-ttu-id="8b4ec-136">傳回運算式指定的所有非 Null 數值的最小值 (在給定範圍的內容中)。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-136">Returns the minimum value of all non-null numeric values specified by the expression, in the context of the given scope.</span></span> <span data-ttu-id="8b4ec-137">這個函數可用來指定圖表軸的最小值以控制刻度。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-137">You can use this for specifying a chart axis minimum value to control the scale.</span></span>|  
|[<span data-ttu-id="8b4ec-138">StDev</span><span class="sxs-lookup"><span data-stu-id="8b4ec-138">StDev</span></span>](report-builder-functions-stdev-function.md)|<span data-ttu-id="8b4ec-139">傳回運算式指定的所有非 Null 數值的標準差 (在給定範圍中評估)。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-139">Returns the standard deviation of all non-null numeric values specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="8b4ec-140">StDevP</span><span class="sxs-lookup"><span data-stu-id="8b4ec-140">StDevP</span></span>](report-builder-functions-stdevp-function.md)|<span data-ttu-id="8b4ec-141">傳回運算式指定的所有非 Null 數值的母體標準差 (在給定範圍的內容中評估)。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-141">Returns the population standard deviation of all non-null numeric values specified by the expression, evaluated in the context of the given scope.</span></span>|  
|[<span data-ttu-id="8b4ec-142">Sum</span><span class="sxs-lookup"><span data-stu-id="8b4ec-142">Sum</span></span>](report-builder-functions-sum-function.md)|<span data-ttu-id="8b4ec-143">傳回運算式指定之所有非 Null 數值的總和 (在給定範圍中評估)。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-143">Returns the sum of all the non-null numeric values specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="8b4ec-144">Union</span><span class="sxs-lookup"><span data-stu-id="8b4ec-144">Union</span></span>](report-builder-functions-union-function.md)|<span data-ttu-id="8b4ec-145">傳回運算式所指定之 `SqlGeometry` 或 `SqlGeography` 類型的所有非 Null 空間資料值聯集 (在給定的範圍中評估)。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-145">Returns the union of all the non-null spatial data values of type `SqlGeometry` or `SqlGeography` that are specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="8b4ec-146">Var</span><span class="sxs-lookup"><span data-stu-id="8b4ec-146">Var</span></span>](report-builder-functions-var-function.md)|<span data-ttu-id="8b4ec-147">傳回運算式指定的所有非 Null 數值的變異數 (在給定範圍中評估)。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-147">Returns the variance of all non-null numeric values specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="8b4ec-148">VarP</span><span class="sxs-lookup"><span data-stu-id="8b4ec-148">VarP</span></span>](report-builder-functions-varp-function.md)|<span data-ttu-id="8b4ec-149">傳回運算式指定的所有非 Null 數值的母體擴展變異數 (在給定範圍的內容中評估)。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-149">Returns the population variance of all non-null numeric values specified by the expression, evaluated in the context of the given scope.</span></span>|  
  
##  <a name="restrictions-on-built-in-fields-collections-and-aggregate-functions"></a><a name="Restrictions"></a><span data-ttu-id="8b4ec-150">內建欄位、集合和彙總函式的限制</span><span class="sxs-lookup"><span data-stu-id="8b4ec-150">Restrictions on Built-in Fields, Collections, and Aggregate Functions</span></span>  
 <span data-ttu-id="8b4ec-151">下表摘要列出您可以加入運算式之報表位置的限制，該運算式包含全域內建集合的參考。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-151">The following table summarizes restrictions in report locations on where you can add expressions that contain references to global built-in collections.</span></span>  
  
|<span data-ttu-id="8b4ec-152">報表中的位置</span><span class="sxs-lookup"><span data-stu-id="8b4ec-152">Location in Report</span></span>|<span data-ttu-id="8b4ec-153">欄位</span><span class="sxs-lookup"><span data-stu-id="8b4ec-153">Fields</span></span>|<span data-ttu-id="8b4ec-154">參數</span><span class="sxs-lookup"><span data-stu-id="8b4ec-154">Parameters</span></span>|<span data-ttu-id="8b4ec-155">ReportItems</span><span class="sxs-lookup"><span data-stu-id="8b4ec-155">ReportItems</span></span>|<span data-ttu-id="8b4ec-156">PageNumber</span><span class="sxs-lookup"><span data-stu-id="8b4ec-156">PageNumber</span></span><br /><br /> <span data-ttu-id="8b4ec-157">TotalPages</span><span class="sxs-lookup"><span data-stu-id="8b4ec-157">TotalPages</span></span>|<span data-ttu-id="8b4ec-158">DataSource</span><span class="sxs-lookup"><span data-stu-id="8b4ec-158">DataSource</span></span><br /><br /> <span data-ttu-id="8b4ec-159">DataSet</span><span class="sxs-lookup"><span data-stu-id="8b4ec-159">DataSet</span></span>|<span data-ttu-id="8b4ec-160">變數</span><span class="sxs-lookup"><span data-stu-id="8b4ec-160">Variables</span></span>|<span data-ttu-id="8b4ec-161">RenderFormat</span><span class="sxs-lookup"><span data-stu-id="8b4ec-161">RenderFormat</span></span>|  
|------------------------|------------|----------------|-----------------|-------------------------------|----------------------------|---------------|------------------|  
|<span data-ttu-id="8b4ec-162">頁首</span><span class="sxs-lookup"><span data-stu-id="8b4ec-162">Page Header</span></span><br /><br /> <span data-ttu-id="8b4ec-163">頁尾</span><span class="sxs-lookup"><span data-stu-id="8b4ec-163">Page Footer</span></span>|<span data-ttu-id="8b4ec-164">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-164">Yes</span></span>|<span data-ttu-id="8b4ec-165">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-165">Yes</span></span>|<span data-ttu-id="8b4ec-166">最多一個</span><span class="sxs-lookup"><span data-stu-id="8b4ec-166">At most one</span></span><br /><br /> <span data-ttu-id="8b4ec-167">附註 1</span><span class="sxs-lookup"><span data-stu-id="8b4ec-167">Note 1</span></span>|<span data-ttu-id="8b4ec-168">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-168">Yes</span></span>|<span data-ttu-id="8b4ec-169">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-169">Yes</span></span>|<span data-ttu-id="8b4ec-170">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-170">Yes</span></span>|<span data-ttu-id="8b4ec-171">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-171">Yes</span></span>|  
|<span data-ttu-id="8b4ec-172">主體</span><span class="sxs-lookup"><span data-stu-id="8b4ec-172">Body</span></span>|<span data-ttu-id="8b4ec-173">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-173">Yes</span></span><br /><br /> <span data-ttu-id="8b4ec-174">附註 2</span><span class="sxs-lookup"><span data-stu-id="8b4ec-174">Note 2</span></span>|<span data-ttu-id="8b4ec-175">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-175">Yes</span></span>|<span data-ttu-id="8b4ec-176">只有目前範圍或包含範圍內的項目</span><span class="sxs-lookup"><span data-stu-id="8b4ec-176">Only items in the currnet scope or a containing scope</span></span><br /><br /> <span data-ttu-id="8b4ec-177">附註 3</span><span class="sxs-lookup"><span data-stu-id="8b4ec-177">Note 3</span></span>|<span data-ttu-id="8b4ec-178">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-178">No</span></span>|<span data-ttu-id="8b4ec-179">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-179">Yes</span></span>|<span data-ttu-id="8b4ec-180">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-180">Yes</span></span>|<span data-ttu-id="8b4ec-181">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-181">Yes</span></span>|  
|<span data-ttu-id="8b4ec-182">報表參數</span><span class="sxs-lookup"><span data-stu-id="8b4ec-182">Report Parameter</span></span>|<span data-ttu-id="8b4ec-183">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-183">No</span></span>|<span data-ttu-id="8b4ec-184">只有清單中稍早的參數</span><span class="sxs-lookup"><span data-stu-id="8b4ec-184">Only parameters earlier in the list</span></span><br /><br /> <span data-ttu-id="8b4ec-185">附註 4</span><span class="sxs-lookup"><span data-stu-id="8b4ec-185">Note 4</span></span>|<span data-ttu-id="8b4ec-186">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-186">No</span></span>|<span data-ttu-id="8b4ec-187">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-187">No</span></span>|<span data-ttu-id="8b4ec-188">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-188">No</span></span>|<span data-ttu-id="8b4ec-189">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-189">No</span></span>|<span data-ttu-id="8b4ec-190">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-190">No</span></span>|  
|<span data-ttu-id="8b4ec-191">欄位</span><span class="sxs-lookup"><span data-stu-id="8b4ec-191">Field</span></span>|<span data-ttu-id="8b4ec-192">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-192">Yes</span></span>|<span data-ttu-id="8b4ec-193">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-193">Yes</span></span>|<span data-ttu-id="8b4ec-194">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-194">No</span></span>|<span data-ttu-id="8b4ec-195">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-195">No</span></span>|<span data-ttu-id="8b4ec-196">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-196">No</span></span>|<span data-ttu-id="8b4ec-197">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-197">No</span></span>|<span data-ttu-id="8b4ec-198">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-198">No</span></span>|  
|<span data-ttu-id="8b4ec-199">查詢參數</span><span class="sxs-lookup"><span data-stu-id="8b4ec-199">Query Parameter</span></span>|<span data-ttu-id="8b4ec-200">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-200">No</span></span>|<span data-ttu-id="8b4ec-201">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-201">Yes</span></span>|<span data-ttu-id="8b4ec-202">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-202">No</span></span>|<span data-ttu-id="8b4ec-203">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-203">No</span></span>|<span data-ttu-id="8b4ec-204">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-204">No</span></span>|<span data-ttu-id="8b4ec-205">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-205">No</span></span>|<span data-ttu-id="8b4ec-206">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-206">No</span></span>|  
|<span data-ttu-id="8b4ec-207">群組運算式</span><span class="sxs-lookup"><span data-stu-id="8b4ec-207">Group Expression</span></span>|<span data-ttu-id="8b4ec-208">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-208">Yes</span></span>|<span data-ttu-id="8b4ec-209">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-209">Yes</span></span>|<span data-ttu-id="8b4ec-210">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-210">No</span></span>|<span data-ttu-id="8b4ec-211">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-211">No</span></span>|<span data-ttu-id="8b4ec-212">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-212">Yes</span></span>|<span data-ttu-id="8b4ec-213">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-213">No</span></span>|<span data-ttu-id="8b4ec-214">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-214">No</span></span>|  
|<span data-ttu-id="8b4ec-215">排序運算式</span><span class="sxs-lookup"><span data-stu-id="8b4ec-215">Sort Expression</span></span>|<span data-ttu-id="8b4ec-216">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-216">Yes</span></span>|<span data-ttu-id="8b4ec-217">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-217">Yes</span></span>|<span data-ttu-id="8b4ec-218">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-218">No</span></span>|<span data-ttu-id="8b4ec-219">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-219">No</span></span>|<span data-ttu-id="8b4ec-220">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-220">Yes</span></span>|<span data-ttu-id="8b4ec-221">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-221">Yes</span></span><br /><br /> <span data-ttu-id="8b4ec-222">附註 5</span><span class="sxs-lookup"><span data-stu-id="8b4ec-222">Note 5</span></span>|<span data-ttu-id="8b4ec-223">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-223">No</span></span>|  
|<span data-ttu-id="8b4ec-224">篩選運算式</span><span class="sxs-lookup"><span data-stu-id="8b4ec-224">Filter Expression</span></span>|<span data-ttu-id="8b4ec-225">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-225">Yes</span></span>|<span data-ttu-id="8b4ec-226">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-226">Yes</span></span>|<span data-ttu-id="8b4ec-227">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-227">No</span></span>|<span data-ttu-id="8b4ec-228">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-228">No</span></span>|<span data-ttu-id="8b4ec-229">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-229">Yes</span></span>|<span data-ttu-id="8b4ec-230">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-230">Yes</span></span><br /><br /> <span data-ttu-id="8b4ec-231">附註 6</span><span class="sxs-lookup"><span data-stu-id="8b4ec-231">Note 6</span></span>|<span data-ttu-id="8b4ec-232">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-232">No</span></span>|  
|<span data-ttu-id="8b4ec-233">程式碼</span><span class="sxs-lookup"><span data-stu-id="8b4ec-233">Code</span></span>|<span data-ttu-id="8b4ec-234">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-234">No</span></span>|<span data-ttu-id="8b4ec-235">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-235">Yes</span></span><br /><br /> <span data-ttu-id="8b4ec-236">附註 7</span><span class="sxs-lookup"><span data-stu-id="8b4ec-236">Note 7</span></span>|<span data-ttu-id="8b4ec-237">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-237">No</span></span>|<span data-ttu-id="8b4ec-238">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-238">No</span></span>|<span data-ttu-id="8b4ec-239">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-239">No</span></span>|<span data-ttu-id="8b4ec-240">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-240">No</span></span>|<span data-ttu-id="8b4ec-241">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-241">No</span></span>|  
|<span data-ttu-id="8b4ec-242">報表語言</span><span class="sxs-lookup"><span data-stu-id="8b4ec-242">Report.Language</span></span>|<span data-ttu-id="8b4ec-243">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-243">No</span></span>|<span data-ttu-id="8b4ec-244">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-244">Yes</span></span>|<span data-ttu-id="8b4ec-245">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-245">No</span></span>|<span data-ttu-id="8b4ec-246">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-246">No</span></span>|<span data-ttu-id="8b4ec-247">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-247">No</span></span>|<span data-ttu-id="8b4ec-248">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-248">No</span></span>|<span data-ttu-id="8b4ec-249">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-249">No</span></span>|  
|<span data-ttu-id="8b4ec-250">變數</span><span class="sxs-lookup"><span data-stu-id="8b4ec-250">Variables</span></span>|<span data-ttu-id="8b4ec-251">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-251">Yes</span></span>|<span data-ttu-id="8b4ec-252">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-252">Yes</span></span>|<span data-ttu-id="8b4ec-253">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-253">No</span></span>|<span data-ttu-id="8b4ec-254">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-254">No</span></span>|<span data-ttu-id="8b4ec-255">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-255">Yes</span></span>|<span data-ttu-id="8b4ec-256">目前範圍或包含的範圍</span><span class="sxs-lookup"><span data-stu-id="8b4ec-256">Current or containing scope</span></span>|<span data-ttu-id="8b4ec-257">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-257">No</span></span>|  
|<span data-ttu-id="8b4ec-258">彙總</span><span class="sxs-lookup"><span data-stu-id="8b4ec-258">Aggregates</span></span>|<span data-ttu-id="8b4ec-259">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-259">Yes</span></span>|<span data-ttu-id="8b4ec-260">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-260">Yes</span></span>|<span data-ttu-id="8b4ec-261">只有在頁首和頁尾</span><span class="sxs-lookup"><span data-stu-id="8b4ec-261">Only in page header/page footer</span></span>|<span data-ttu-id="8b4ec-262">只有在報表項目彙總內</span><span class="sxs-lookup"><span data-stu-id="8b4ec-262">Only in report item aggregates</span></span>|<span data-ttu-id="8b4ec-263">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-263">Yes</span></span>|<span data-ttu-id="8b4ec-264">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-264">No</span></span>|<span data-ttu-id="8b4ec-265">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-265">No</span></span>|  
|<span data-ttu-id="8b4ec-266">查閱函數</span><span class="sxs-lookup"><span data-stu-id="8b4ec-266">Lookup functions</span></span>|<span data-ttu-id="8b4ec-267">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-267">Yes</span></span>|<span data-ttu-id="8b4ec-268">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-268">Yes</span></span>|<span data-ttu-id="8b4ec-269">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-269">Yes</span></span>|<span data-ttu-id="8b4ec-270">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-270">No</span></span>|<span data-ttu-id="8b4ec-271">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-271">Yes</span></span>|<span data-ttu-id="8b4ec-272">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-272">No</span></span>|<span data-ttu-id="8b4ec-273">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-273">No</span></span>|  
  
-   <span data-ttu-id="8b4ec-274">**附注1。**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-274">**Note 1.**</span></span> <span data-ttu-id="8b4ec-275">ReportItems 必須存在於轉譯的報表頁面中，否則其值會是 Null。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-275">ReportItems must exist in the rendered report page, or their value is Null.</span></span> <span data-ttu-id="8b4ec-276">如果報表項目的可見性取決於評估為 False 的運算式，則表示報表項目不存在於頁面上。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-276">If the visibility of a report item depends on an expression that evaluates to False, the report item does not exist on the page.</span></span>  
  
-   <span data-ttu-id="8b4ec-277">**附注2。**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-277">**Note 2.**</span></span> <span data-ttu-id="8b4ec-278">如果欄位參考用於群組範圍中，而且欄位參考未包含在群組運算式中，則表示未定義該欄位的值，除非此範圍內只有一個值。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-278">If a field reference is used in a group scope, and the field reference is not included in the group expression, then the value for the field is undefined, unless there is only one value in the scope.</span></span> <span data-ttu-id="8b4ec-279">若要指定值，請使用 First 或 Last 及群組範圍。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-279">To specify a value, use First or Last and the group scope.</span></span>  
  
-   <span data-ttu-id="8b4ec-280">**注3。**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-280">**Note 3.**</span></span> <span data-ttu-id="8b4ec-281">包含 ReportItems 之參考的運算式可以針對相同群組範圍或包含的群組範圍內的其他 ReportItems 指定值。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-281">Expressions that include a reference to ReportItems can specify values for other ReportItems in the same group scope or in a containing group scope.</span></span>  
  
-   <span data-ttu-id="8b4ec-282">**附註 4。**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-282">**Note 4.**</span></span> <span data-ttu-id="8b4ec-283">之前參數的屬性值可能為 null。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-283">Property values for earlier parameters might be null.</span></span>  
  
-   <span data-ttu-id="8b4ec-284">**注5。**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-284">**Note 5.**</span></span> <span data-ttu-id="8b4ec-285">僅限成員排序。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-285">In Member sorts only.</span></span> <span data-ttu-id="8b4ec-286">無法在資料區排序運算式內使用。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-286">Cannot use in data region sort expressions.</span></span>  
  
-   <span data-ttu-id="8b4ec-287">**附註 6。**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-287">**Note 6.**</span></span> <span data-ttu-id="8b4ec-288">僅限成員篩選。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-288">In Member filters only.</span></span> <span data-ttu-id="8b4ec-289">無法在資料區或資料集篩選運算式內使用。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-289">Cannot use in data region or dataset filter expressions.</span></span>  
  
-   <span data-ttu-id="8b4ec-290">**附註 7。**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-290">**Note 7.**</span></span> <span data-ttu-id="8b4ec-291">處理程式碼區塊之前沒有初始化參數集合，所以無法使用方法來控制初始化的參數。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-291">The Parameters collection is not initialized until after the Code block is processed, so methods cannot be used to control parameters on initialization.</span></span>  
  
-   <span data-ttu-id="8b4ec-292">**附註 8。**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-292">**Note 8.**</span></span> <span data-ttu-id="8b4ec-293">除了 Count 與 CountDistinct 以外的所有彙總之資料類型，所有的值都必須是相同的資料類型或 null。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-293">Data type for all aggregates except Count and CountDistinct must be the same data type, or null, for all values.</span></span>  
  
##  <a name="restrictions-on-nested-aggregates"></a><a name="NestedRestrictions"></a> <span data-ttu-id="8b4ec-294">巢狀彙總的限制</span><span class="sxs-lookup"><span data-stu-id="8b4ec-294">Restrictions on Nested Aggregates</span></span>  
 <span data-ttu-id="8b4ec-295">下表摘要列出彙總函式可以將其他彙總函式指定為巢狀彙總的限制。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-295">The following table summarizes restrictions on which aggregates functions can specify other aggregate functions as nested aggregates.</span></span>  
  
|<span data-ttu-id="8b4ec-296">內容</span><span class="sxs-lookup"><span data-stu-id="8b4ec-296">Context</span></span>|<span data-ttu-id="8b4ec-297">RunningValue</span><span class="sxs-lookup"><span data-stu-id="8b4ec-297">RunningValue</span></span>|<span data-ttu-id="8b4ec-298">RowNumber</span><span class="sxs-lookup"><span data-stu-id="8b4ec-298">RowNumber</span></span>|<span data-ttu-id="8b4ec-299">First</span><span class="sxs-lookup"><span data-stu-id="8b4ec-299">First</span></span><br /><br /> <span data-ttu-id="8b4ec-300">Last</span><span class="sxs-lookup"><span data-stu-id="8b4ec-300">Last</span></span>|<span data-ttu-id="8b4ec-301">上一個</span><span class="sxs-lookup"><span data-stu-id="8b4ec-301">Previous</span></span>|<span data-ttu-id="8b4ec-302">Sum 和其他 Presort 函數</span><span class="sxs-lookup"><span data-stu-id="8b4ec-302">Sum and Other Presort functions</span></span>|<span data-ttu-id="8b4ec-303">ReportItem 彙總</span><span class="sxs-lookup"><span data-stu-id="8b4ec-303">ReportItem aggregates</span></span>|<span data-ttu-id="8b4ec-304">查閱函數</span><span class="sxs-lookup"><span data-stu-id="8b4ec-304">Lookup functions</span></span>|<span data-ttu-id="8b4ec-305">彙總函式</span><span class="sxs-lookup"><span data-stu-id="8b4ec-305">Aggregate Function</span></span>|  
|-------------|------------------|---------------|--------------------|--------------|-------------------------------------|---------------------------|----------------------|------------------------|  
|<span data-ttu-id="8b4ec-306">執行中的值</span><span class="sxs-lookup"><span data-stu-id="8b4ec-306">Running Value</span></span>|<span data-ttu-id="8b4ec-307">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-307">No</span></span>|<span data-ttu-id="8b4ec-308">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-308">No</span></span>|<span data-ttu-id="8b4ec-309">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-309">No</span></span>|<span data-ttu-id="8b4ec-310">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-310">No</span></span>|<span data-ttu-id="8b4ec-311">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-311">Yes</span></span>|<span data-ttu-id="8b4ec-312">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-312">No</span></span>|<span data-ttu-id="8b4ec-313">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-313">Yes</span></span>|<span data-ttu-id="8b4ec-314">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-314">No</span></span>|  
|<span data-ttu-id="8b4ec-315">First</span><span class="sxs-lookup"><span data-stu-id="8b4ec-315">First</span></span><br /><br /> <span data-ttu-id="8b4ec-316">Last</span><span class="sxs-lookup"><span data-stu-id="8b4ec-316">Last</span></span>|<span data-ttu-id="8b4ec-317">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-317">No</span></span>|<span data-ttu-id="8b4ec-318">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-318">No</span></span>|<span data-ttu-id="8b4ec-319">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-319">No</span></span>|<span data-ttu-id="8b4ec-320">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-320">No</span></span>|<span data-ttu-id="8b4ec-321">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-321">Yes</span></span>|<span data-ttu-id="8b4ec-322">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-322">No</span></span>|<span data-ttu-id="8b4ec-323">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-323">No</span></span>|<span data-ttu-id="8b4ec-324">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-324">No</span></span>|  
|<span data-ttu-id="8b4ec-325">上一個</span><span class="sxs-lookup"><span data-stu-id="8b4ec-325">Previous</span></span>|<span data-ttu-id="8b4ec-326">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-326">Yes</span></span>|<span data-ttu-id="8b4ec-327">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-327">Yes</span></span>|<span data-ttu-id="8b4ec-328">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-328">Yes</span></span>|<span data-ttu-id="8b4ec-329">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-329">No</span></span>|<span data-ttu-id="8b4ec-330">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-330">Yes</span></span>|<span data-ttu-id="8b4ec-331">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-331">No</span></span>|<span data-ttu-id="8b4ec-332">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-332">Yes</span></span>|<span data-ttu-id="8b4ec-333">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-333">No</span></span>|  
|<span data-ttu-id="8b4ec-334">Sum 和其他 Presort 函數</span><span class="sxs-lookup"><span data-stu-id="8b4ec-334">Sum and other Presort functions</span></span>|<span data-ttu-id="8b4ec-335">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-335">No</span></span>|<span data-ttu-id="8b4ec-336">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-336">No</span></span>|<span data-ttu-id="8b4ec-337">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-337">No</span></span>|<span data-ttu-id="8b4ec-338">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-338">No</span></span>|<span data-ttu-id="8b4ec-339">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-339">Yes</span></span>|<span data-ttu-id="8b4ec-340">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-340">No</span></span>|<span data-ttu-id="8b4ec-341">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-341">Yes</span></span>|<span data-ttu-id="8b4ec-342">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-342">No</span></span>|  
|<span data-ttu-id="8b4ec-343">ReportItem 彙總</span><span class="sxs-lookup"><span data-stu-id="8b4ec-343">ReportItem aggregates</span></span>|<span data-ttu-id="8b4ec-344">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-344">No</span></span>|<span data-ttu-id="8b4ec-345">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-345">No</span></span>|<span data-ttu-id="8b4ec-346">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-346">No</span></span>|<span data-ttu-id="8b4ec-347">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-347">No</span></span>|<span data-ttu-id="8b4ec-348">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-348">No</span></span>|<span data-ttu-id="8b4ec-349">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-349">No</span></span>|<span data-ttu-id="8b4ec-350">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-350">No</span></span>|<span data-ttu-id="8b4ec-351">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-351">No</span></span>|  
|<span data-ttu-id="8b4ec-352">查閱函數</span><span class="sxs-lookup"><span data-stu-id="8b4ec-352">Lookup functions</span></span>|<span data-ttu-id="8b4ec-353">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-353">Yes</span></span>|<span data-ttu-id="8b4ec-354">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-354">Yes</span></span><br /><br /> <span data-ttu-id="8b4ec-355">附註 1</span><span class="sxs-lookup"><span data-stu-id="8b4ec-355">Note 1</span></span>|<span data-ttu-id="8b4ec-356">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-356">Yes</span></span><br /><br /> <span data-ttu-id="8b4ec-357">附註 1</span><span class="sxs-lookup"><span data-stu-id="8b4ec-357">Note 1</span></span>|<span data-ttu-id="8b4ec-358">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-358">Yes</span></span><br /><br /> <span data-ttu-id="8b4ec-359">附註 1</span><span class="sxs-lookup"><span data-stu-id="8b4ec-359">Note 1</span></span>|<span data-ttu-id="8b4ec-360">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-360">Yes</span></span><br /><br /> <span data-ttu-id="8b4ec-361">附註 1</span><span class="sxs-lookup"><span data-stu-id="8b4ec-361">Note 1</span></span>|<span data-ttu-id="8b4ec-362">是</span><span class="sxs-lookup"><span data-stu-id="8b4ec-362">Yes</span></span><br /><br /> <span data-ttu-id="8b4ec-363">附註 1</span><span class="sxs-lookup"><span data-stu-id="8b4ec-363">Note 1</span></span>|<span data-ttu-id="8b4ec-364">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-364">No</span></span>|<span data-ttu-id="8b4ec-365">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-365">No</span></span>|  
|<span data-ttu-id="8b4ec-366">彙總函式</span><span class="sxs-lookup"><span data-stu-id="8b4ec-366">Aggregate Function</span></span>|<span data-ttu-id="8b4ec-367">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-367">No</span></span>|<span data-ttu-id="8b4ec-368">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-368">No</span></span>|<span data-ttu-id="8b4ec-369">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-369">No</span></span>|<span data-ttu-id="8b4ec-370">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-370">No</span></span>|<span data-ttu-id="8b4ec-371">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-371">No</span></span>|<span data-ttu-id="8b4ec-372">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-372">No</span></span>|<span data-ttu-id="8b4ec-373">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-373">No</span></span>|<span data-ttu-id="8b4ec-374">否</span><span class="sxs-lookup"><span data-stu-id="8b4ec-374">No</span></span>|  
  
-   <span data-ttu-id="8b4ec-375">**附注1。**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-375">**Note 1.**</span></span> <span data-ttu-id="8b4ec-376">如果查閱函數未包含在彙總內，則只有查閱函數的 *Source* 運算式中才允許彙總函式。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-376">Aggregate functions are only allowed inside the *Source* expression of a Lookup function if the Lookup function is not contained in an aggregate.</span></span> <span data-ttu-id="8b4ec-377">查閱函數的 *Destination* 或 *Result* 運算式內不允許彙總函式。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-377">Aggregate functions are not allowed inside the *Destination* or *Result* expressions of a Lookup function.</span></span>  
  
##  <a name="calculating-running-values"></a><a name="CalculatingRunningValues"></a><span data-ttu-id="8b4ec-378">計算執行的值</span><span class="sxs-lookup"><span data-stu-id="8b4ec-378">Calculating Running Values</span></span>  
 <span data-ttu-id="8b4ec-379">下列的內建函數會計算資料集的執行值。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-379">The following built-in functions calculate running values for a set of data.</span></span> <span data-ttu-id="8b4ec-380">`RowNumber` 與 `RunningValue` 類似，會傳回累加包含範圍內每個資料列的計數執行值。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-380">`RowNumber` is like `RunningValue` in that it returns the running value of a count that increments for each row within the containing scope.</span></span> <span data-ttu-id="8b4ec-381">這些函數的範圍參數必須指定包含範圍，這個範圍控制何時重新開始計數。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-381">The scope parameter for these functions must specify a containing scope, which controls when the count restarts.</span></span>  
  
|<span data-ttu-id="8b4ec-382">**Function**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-382">**Function**</span></span>|<span data-ttu-id="8b4ec-383">**說明**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-383">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="8b4ec-384">RowNumber</span><span class="sxs-lookup"><span data-stu-id="8b4ec-384">RowNumber</span></span>](report-builder-functions-rownumber-function.md)|<span data-ttu-id="8b4ec-385">傳回指定範圍中資料列數的執行計數。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-385">Returns a running count of the number of rows for the specified scope.</span></span> <span data-ttu-id="8b4ec-386">`RowNumber` 函數從 1 開始重新計數，而不是 0。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-386">The `RowNumber` function restarts counting at 1, not 0.</span></span>|  
|[<span data-ttu-id="8b4ec-387">RunningValue</span><span class="sxs-lookup"><span data-stu-id="8b4ec-387">RunningValue</span></span>](report-builder-functions-runningvalue-function.md)|<span data-ttu-id="8b4ec-388">傳回運算式指定的所有非 Null 數值的執行彙總 (在給定範圍中評估)。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-388">Returns a running aggregate of all non-null numeric values specified by the expression, evaluated for the given scope.</span></span>|  
  
##  <a name="retrieving-row-counts"></a><a name="RetrievingRowCounts"></a><span data-ttu-id="8b4ec-389">正在抓取資料列計數</span><span class="sxs-lookup"><span data-stu-id="8b4ec-389">Retrieving Row Counts</span></span>  
 <span data-ttu-id="8b4ec-390">下列的內建函數會計算給定範圍中的資料列數。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-390">The following built-in function calculates the number of rows in the given scope.</span></span> <span data-ttu-id="8b4ec-391">這個函數可用來計算所有資料列的數目，包括具有 Null 值的資料列。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-391">Use this function to count all rows, including rows with null values.</span></span>  
  
|<span data-ttu-id="8b4ec-392">**Function**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-392">**Function**</span></span>|<span data-ttu-id="8b4ec-393">**說明**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-393">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="8b4ec-394">CountRows</span><span class="sxs-lookup"><span data-stu-id="8b4ec-394">CountRows</span></span>](report-builder-functions-countrows-function.md)|<span data-ttu-id="8b4ec-395">傳回指定之範圍中的資料列數目，包括具有 Null 值的資料列。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-395">Returns the number of rows in the specified scope, including rows with null values.</span></span>|  
  
##  <a name="looking-up-values-from-another-dataset"></a><a name="LookupFunctions"></a><span data-ttu-id="8b4ec-396">從另一個資料集查閱值</span><span class="sxs-lookup"><span data-stu-id="8b4ec-396">Looking Up Values from Another Dataset</span></span>  
 <span data-ttu-id="8b4ec-397">下列查閱函數會從指定的資料集擷取值。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-397">The following lookup functions retrieve values from a specified dataset.</span></span>  
  
|<span data-ttu-id="8b4ec-398">**Function**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-398">**Function**</span></span>|<span data-ttu-id="8b4ec-399">**說明**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-399">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="8b4ec-400">Lookup 函數</span><span class="sxs-lookup"><span data-stu-id="8b4ec-400">Lookup Function</span></span>](report-builder-functions-lookup-function.md)|<span data-ttu-id="8b4ec-401">從指定之運算式的資料集傳回值。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-401">Returns a value from a dataset for a specified expression.</span></span>|  
|[<span data-ttu-id="8b4ec-402">LookupSet 函數</span><span class="sxs-lookup"><span data-stu-id="8b4ec-402">LookupSet Function</span></span>](report-builder-functions-lookupset-function.md)|<span data-ttu-id="8b4ec-403">從指定之運算式的資料集傳回一組值。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-403">Returns a set of values from a dataset for a specified expression.</span></span>|  
|[<span data-ttu-id="8b4ec-404">Multilookup 函數</span><span class="sxs-lookup"><span data-stu-id="8b4ec-404">Multilookup Function</span></span>](report-builder-functions-multilookup-function.md)|<span data-ttu-id="8b4ec-405">從包含名稱/值組的資料集傳回第一組符合某一組名稱的值。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-405">Returns the set of first-match values for a set of names from a dataset that contains name/value pairs.</span></span>|  
  
##  <a name="retrieving-sort-dependent-values"></a><a name="RetrievingPostsortValues"></a><span data-ttu-id="8b4ec-406">正在抓取排序相依的值</span><span class="sxs-lookup"><span data-stu-id="8b4ec-406">Retrieving Sort-Dependent Values</span></span>  
 <span data-ttu-id="8b4ec-407">下列的內建函數會傳回給定範圍內的第一個、最後一個或上一個值。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-407">The following built-in functions return the first, last, or previous value within a given scope.</span></span> <span data-ttu-id="8b4ec-408">這些函數會視資料值的排序次序而定。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-408">These functions depend on the sort order of the data values.</span></span> <span data-ttu-id="8b4ec-409">舉例而言，這些函數可用來尋找頁面上的第一個和最後一個值，以建立字典樣式的頁首。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-409">Use these functions, for example, to find the first and last values on a page to create a dictionary-style page header.</span></span> <span data-ttu-id="8b4ec-410">`Previous` 可用來比較特定範圍內一個資料列的值與上一個資料列的值，以在資料表中找出年的成長百分比。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-410">Use `Previous` to compare a value in one row to the previous row's value within a specific scope, for example, to find percentage year over year values in a table.</span></span>  
  
|<span data-ttu-id="8b4ec-411">**Function**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-411">**Function**</span></span>|<span data-ttu-id="8b4ec-412">**說明**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-412">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="8b4ec-413">First</span><span class="sxs-lookup"><span data-stu-id="8b4ec-413">First</span></span>](report-builder-functions-first-function.md)|<span data-ttu-id="8b4ec-414">傳回所指定運算式給定範圍中的第一個值。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-414">Returns the first value in the given scope of the specified expression.</span></span>|  
|[<span data-ttu-id="8b4ec-415">次</span><span class="sxs-lookup"><span data-stu-id="8b4ec-415">Last</span></span>](report-builder-functions-last-function.md)|<span data-ttu-id="8b4ec-416">傳回所指定運算式給定範圍中的最後一個值。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-416">Returns the last value in the given scope of the specified expression.</span></span>|  
|[<span data-ttu-id="8b4ec-417">上一步</span><span class="sxs-lookup"><span data-stu-id="8b4ec-417">Previous</span></span>](report-builder-functions-previous-function.md)|<span data-ttu-id="8b4ec-418">傳回某個項目在指定之範圍內上一個執行個體的值或指定的彙總值。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-418">Returns the value or the specified aggregate value for the previous instance of an item within the specified scope.</span></span>|  
  
##  <a name="retrieving-server-aggregates"></a><a name="RetrievingServerAggregates"></a><span data-ttu-id="8b4ec-419">正在抓取伺服器匯總</span><span class="sxs-lookup"><span data-stu-id="8b4ec-419">Retrieving Server Aggregates</span></span>  
 <span data-ttu-id="8b4ec-420">下列的內建函數將從資料提供者擷取自訂彙總。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-420">The following built-in function retrieves custom aggregates from the data provider.</span></span> <span data-ttu-id="8b4ec-421">例如，您可以使用 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 資料來源類型擷取在資料來源伺服器上計算的彙總，以用於群組頁首。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-421">For example, using an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data source type, you can retrieve aggregates calculated on the data source server for use in a group header.</span></span>  
  
|<span data-ttu-id="8b4ec-422">**Function**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-422">**Function**</span></span>|<span data-ttu-id="8b4ec-423">**說明**</span><span class="sxs-lookup"><span data-stu-id="8b4ec-423">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="8b4ec-424">彙總</span><span class="sxs-lookup"><span data-stu-id="8b4ec-424">Aggregate</span></span>](report-builder-functions-aggregate-function.md)|<span data-ttu-id="8b4ec-425">傳回指定之運算式的自訂彙總，由資料提供者定義。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-425">Returns a custom aggregate of the specified expression, as defined by the data provider.</span></span>|  
  
##  <a name="testing-for-scope"></a><a name="TestingforScope"></a><span data-ttu-id="8b4ec-426">測試範圍</span><span class="sxs-lookup"><span data-stu-id="8b4ec-426">Testing for Scope</span></span>  
 <span data-ttu-id="8b4ec-427">下列的內建函數會測試報表項目目前的內容，查看是否為特定範圍的成員。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-427">The following built-in function tests the current context of a report item to see if it is a member of a specific scope.</span></span>  
  
|<span data-ttu-id="8b4ec-428">函式</span><span class="sxs-lookup"><span data-stu-id="8b4ec-428">Function</span></span>|<span data-ttu-id="8b4ec-429">描述</span><span class="sxs-lookup"><span data-stu-id="8b4ec-429">Description</span></span>|  
|--------------|-----------------|  
|[<span data-ttu-id="8b4ec-430">InScope</span><span class="sxs-lookup"><span data-stu-id="8b4ec-430">InScope</span></span>](report-builder-functions-inscope-function.md)|<span data-ttu-id="8b4ec-431">指出目前項目的執行個體是否在指定的範圍內。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-431">Indicates whether the current instance of an item is within the specified scope.</span></span>|  
  
##  <a name="retrieving-recursive-level"></a><a name="RetrievingRecursiveLevel"></a><span data-ttu-id="8b4ec-432">正在抓取遞迴層級</span><span class="sxs-lookup"><span data-stu-id="8b4ec-432">Retrieving Recursive Level</span></span>  
 <span data-ttu-id="8b4ec-433">下列的內建函數會在系統處理遞迴階層時，擷取目前的層級。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-433">The following built-in function retrieves the current level when a recursive hierarchy is processed.</span></span> <span data-ttu-id="8b4ec-434">在文字方塊中以 `Padding` 屬性使用此函數的結果，即可控制遞迴群組視覺階層的縮排層級。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-434">Use the result of this function with the `Padding` property in a text box to control the indent level of a visual hierarchy for a recursive group.</span></span> <span data-ttu-id="8b4ec-435">如需詳細資訊，請參閱[建立遞迴階層群組 &#40;報表產生器及 SSRS&#41;](creating-recursive-hierarchy-groups-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-435">For more information, see [Creating Recursive Hierarchy Groups &#40;Report Builder and SSRS&#41;](creating-recursive-hierarchy-groups-report-builder-and-ssrs.md).</span></span>  
  
|<span data-ttu-id="8b4ec-436">函式</span><span class="sxs-lookup"><span data-stu-id="8b4ec-436">Function</span></span>|<span data-ttu-id="8b4ec-437">描述</span><span class="sxs-lookup"><span data-stu-id="8b4ec-437">Description</span></span>|  
|--------------|-----------------|  
|[<span data-ttu-id="8b4ec-438">Level</span><span class="sxs-lookup"><span data-stu-id="8b4ec-438">Level</span></span>](report-builder-functions-level-function.md)|<span data-ttu-id="8b4ec-439">傳回遞迴階層中之目前所在的層級。</span><span class="sxs-lookup"><span data-stu-id="8b4ec-439">Returns the current level of depth in a recursive hierarchy.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="8b4ec-440">另請參閱</span><span class="sxs-lookup"><span data-stu-id="8b4ec-440">See Also</span></span>  
 <span data-ttu-id="8b4ec-441">[運算式用於報表 &#40;報表產生器和 SSRS&#41;](expression-uses-in-reports-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="8b4ec-441">[Expression Uses in Reports &#40;Report Builder and SSRS&#41;](expression-uses-in-reports-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="8b4ec-442">[運算式範例 &#40;報表產生器及 SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="8b4ec-442">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="8b4ec-443">總計、彙總與內建集合的運算式範圍 &#40;報表產生器及 SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="8b4ec-443">Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;</span></span>](expression-scope-for-totals-aggregates-and-built-in-collections.md)  
  
  
