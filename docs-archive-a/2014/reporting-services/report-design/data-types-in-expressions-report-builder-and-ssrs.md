---
title: 運算式中的資料類型 (報表產生器及 SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 94fdf921-270c-4c12-87b3-46b1cc98fae5
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 86aa646865ecfe3da6ed1ad4bacb75907ab39472
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87704933"
---
# <a name="data-types-in-expressions-report-builder-and-ssrs"></a><span data-ttu-id="72aed-102">運算式中的資料類型 (報表產生器及 SSRS)</span><span class="sxs-lookup"><span data-stu-id="72aed-102">Data Types in Expressions (Report Builder and SSRS)</span></span>
  <span data-ttu-id="72aed-103">資料類型代表不同種類的資料，以便讓系統能夠有效率地儲存和處理資料。</span><span class="sxs-lookup"><span data-stu-id="72aed-103">Data types represent different kinds of data so that it can be stored and processed efficiently.</span></span> <span data-ttu-id="72aed-104">一般資料類型包括文字 (也稱為字串)、含與不含小數位數的數字、日期和時間，以及影像。</span><span class="sxs-lookup"><span data-stu-id="72aed-104">Typical data types include text (also known as strings), numbers with and without decimal places, dates and times, and images.</span></span> <span data-ttu-id="72aed-105">報表中的值必須是報表定義語言 (RDL) 資料類型。</span><span class="sxs-lookup"><span data-stu-id="72aed-105">Values in a report must be an Report Definition Language (RDL) data type.</span></span> <span data-ttu-id="72aed-106">當您在報表中顯示值時，可以根據您的喜好設定來格式化值。</span><span class="sxs-lookup"><span data-stu-id="72aed-106">You can format a value according to your preference when you display it in a report.</span></span> <span data-ttu-id="72aed-107">例如，代表貨幣的欄位會當做浮點數儲存在報表定義中，但是可能會根據您選擇的格式屬性，以各種格式顯示此欄位。</span><span class="sxs-lookup"><span data-stu-id="72aed-107">For example, a field that represents currency is stored in the report definition as a floating point number, but can be displayed in a variety of formats depending on the format property you choose.</span></span>  
  
 <span data-ttu-id="72aed-108">如需顯示格式的詳細資訊，請參閱 [設定報表項目的格式 &#40;報表產生器及 SSRS&#41;](formatting-report-items-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="72aed-108">For more information about display formats, see [Formatting Report Items &#40;Report Builder and SSRS&#41;](formatting-report-items-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="report-definition-language-rdl-data-types-and-common-language-runtime-clr-data-types"></a><span data-ttu-id="72aed-109">報表定義語言 (RDL) 資料類型與 Common Language Runtime (CLR) 資料類型</span><span class="sxs-lookup"><span data-stu-id="72aed-109">Report Definition Language (RDL) Data Types and Common Language Runtime (CLR) Data Types</span></span>  
 <span data-ttu-id="72aed-110">RDL 檔案中所指定的值必須是 RDL 資料類型。</span><span class="sxs-lookup"><span data-stu-id="72aed-110">Values that are specified in an RDL file must be an RDL data type.</span></span> <span data-ttu-id="72aed-111">當報表進行編譯和處理時，RDL 資料類型會轉換成 CLR 資料類型。</span><span class="sxs-lookup"><span data-stu-id="72aed-111">When the report is compiled and processed, RDL data types are converted to CLR data types.</span></span> <span data-ttu-id="72aed-112">下表會顯示標示為預設值的轉換：</span><span class="sxs-lookup"><span data-stu-id="72aed-112">The following table displays the conversion, which is marked Default:</span></span>  
  
|<span data-ttu-id="72aed-113">RDL 類型</span><span class="sxs-lookup"><span data-stu-id="72aed-113">RDL Type</span></span>|<span data-ttu-id="72aed-114">CLR 類型</span><span class="sxs-lookup"><span data-stu-id="72aed-114">CLR Types</span></span>|  
|--------------|---------------|  
|<span data-ttu-id="72aed-115">String</span><span class="sxs-lookup"><span data-stu-id="72aed-115">String</span></span>|<span data-ttu-id="72aed-116">預設值：String</span><span class="sxs-lookup"><span data-stu-id="72aed-116">Default: String</span></span><br /><br /> <span data-ttu-id="72aed-117">Chart、GUID、Timespan</span><span class="sxs-lookup"><span data-stu-id="72aed-117">Chart, GUID, Timespan</span></span>|  
|<span data-ttu-id="72aed-118">Boolean</span><span class="sxs-lookup"><span data-stu-id="72aed-118">Boolean</span></span>|<span data-ttu-id="72aed-119">預設值：Boolean</span><span class="sxs-lookup"><span data-stu-id="72aed-119">Default: Boolean</span></span>|  
|<span data-ttu-id="72aed-120">整數</span><span class="sxs-lookup"><span data-stu-id="72aed-120">Integer</span></span>|<span data-ttu-id="72aed-121">預設值：Int64</span><span class="sxs-lookup"><span data-stu-id="72aed-121">Default: Int64</span></span><br /><br /> <span data-ttu-id="72aed-122">Int16、Int32、Uint16、Uint64、Byte、Sbyte</span><span class="sxs-lookup"><span data-stu-id="72aed-122">Int16, Int32, Uint16, Uint64, Byte, Sbyte</span></span>|  
|<span data-ttu-id="72aed-123">Datetime</span><span class="sxs-lookup"><span data-stu-id="72aed-123">DateTime</span></span>|<span data-ttu-id="72aed-124">預設值：DateTime</span><span class="sxs-lookup"><span data-stu-id="72aed-124">Default: DateTime</span></span><br /><br /> <span data-ttu-id="72aed-125">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="72aed-125">DateTimeOffset</span></span>|  
|<span data-ttu-id="72aed-126">Float</span><span class="sxs-lookup"><span data-stu-id="72aed-126">Float</span></span>|<span data-ttu-id="72aed-127">預設值：Double</span><span class="sxs-lookup"><span data-stu-id="72aed-127">Default: Double</span></span><br /><br /> <span data-ttu-id="72aed-128">Single、Decimal</span><span class="sxs-lookup"><span data-stu-id="72aed-128">Single, Decimal</span></span>|  
|<span data-ttu-id="72aed-129">Binary</span><span class="sxs-lookup"><span data-stu-id="72aed-129">Binary</span></span>|<span data-ttu-id="72aed-130">預設值：Byte[]</span><span class="sxs-lookup"><span data-stu-id="72aed-130">Default: Byte[]</span></span>|  
|<span data-ttu-id="72aed-131">變數</span><span class="sxs-lookup"><span data-stu-id="72aed-131">Variant</span></span>|<span data-ttu-id="72aed-132">除了 Byte[] 之外，以上任何一種</span><span class="sxs-lookup"><span data-stu-id="72aed-132">Any of the above except Byte[]</span></span>|  
|<span data-ttu-id="72aed-133">VariantArray</span><span class="sxs-lookup"><span data-stu-id="72aed-133">VariantArray</span></span>|<span data-ttu-id="72aed-134">變數的陣列</span><span class="sxs-lookup"><span data-stu-id="72aed-134">Array of Variant</span></span>|  
|<span data-ttu-id="72aed-135">可序列化</span><span class="sxs-lookup"><span data-stu-id="72aed-135">Serializable</span></span>|<span data-ttu-id="72aed-136">標示為 Serializable 或實作 ISerializable 的變數或類型。</span><span class="sxs-lookup"><span data-stu-id="72aed-136">Variant or types marked with Serializable or that implement ISerializable.</span></span>|  
  
## <a name="understanding-data-types-and-writing-expressions"></a><span data-ttu-id="72aed-137">了解資料類型與撰寫運算式</span><span class="sxs-lookup"><span data-stu-id="72aed-137">Understanding Data Types and Writing Expressions</span></span>  
 <span data-ttu-id="72aed-138">當您撰寫運算式來比較或結合值 (例如，定義群組或篩選運算式，或者計算彙總) 時，了解資料類型便相當重要。</span><span class="sxs-lookup"><span data-stu-id="72aed-138">It is important to understand data types when you write expressions to compare or combine values, for example, when you define group or filter expressions, or calculate aggregates.</span></span> <span data-ttu-id="72aed-139">比較和計算作業只能在相同資料類型的項目之間進行。</span><span class="sxs-lookup"><span data-stu-id="72aed-139">Comparisons and calculations are valid only between items of the same data type.</span></span> <span data-ttu-id="72aed-140">如果資料類型不相符，您就必須使用運算式來明確轉換報表項目中的資料類型。</span><span class="sxs-lookup"><span data-stu-id="72aed-140">If the data types do not match, you must explicitly convert the data type in the report item by using an expression.</span></span>  
  
 <span data-ttu-id="72aed-141">下列清單將描述您必須將資料轉換成不同資料類型的情況：</span><span class="sxs-lookup"><span data-stu-id="72aed-141">The following list describes cases when you may need to convert data to a different data type:</span></span>  
  
-   <span data-ttu-id="72aed-142">比較某種資料類型的報表參數值與不同資料類型的資料集欄位。</span><span class="sxs-lookup"><span data-stu-id="72aed-142">Comparing the value of a report parameter of one data type to a dataset field of a different data type.</span></span>  
  
-   <span data-ttu-id="72aed-143">撰寫比較不同資料類型之值的篩選運算式。</span><span class="sxs-lookup"><span data-stu-id="72aed-143">Writing filter expressions that compare values of different data types.</span></span>  
  
-   <span data-ttu-id="72aed-144">撰寫結合不同資料類型之欄位的排序運算式。</span><span class="sxs-lookup"><span data-stu-id="72aed-144">Writing sort expressions that combine fields of different data types.</span></span>  
  
-   <span data-ttu-id="72aed-145">撰寫結合不同資料類型之欄位的群組運算式。</span><span class="sxs-lookup"><span data-stu-id="72aed-145">Writing group expressions that combine fields of different data types.</span></span>  
  
-   <span data-ttu-id="72aed-146">將資料來源中擷取的值，從某種資料類型轉換成不同的資料類型。</span><span class="sxs-lookup"><span data-stu-id="72aed-146">Converting a value retrieved from the data source from one data type to a different data type.</span></span>  
  
## <a name="determining-the-data-type-of-report-data"></a><span data-ttu-id="72aed-147">判斷報表資料的資料類型</span><span class="sxs-lookup"><span data-stu-id="72aed-147">Determining the Data Type of Report Data</span></span>  
 <span data-ttu-id="72aed-148">若要判斷報表項目的資料類型，您可以撰寫傳回其資料類型的運算式。</span><span class="sxs-lookup"><span data-stu-id="72aed-148">To determine the data type of a report item, you can write an expression that returns its data type.</span></span> <span data-ttu-id="72aed-149">例如，若要顯示欄位 `MyField`的資料類型，請將下列運算式加入至資料表的資料格： `=Fields!MyField.Value.GetType().ToString()`。</span><span class="sxs-lookup"><span data-stu-id="72aed-149">For example, to show the data type for the field `MyField`, add the following expression to a table cell: `=Fields!MyField.Value.GetType().ToString()`.</span></span> <span data-ttu-id="72aed-150">結果會顯示用來代表 `MyField` 的 CLR 資料類型，例如 `System.String` 或 `System.DateTime`。</span><span class="sxs-lookup"><span data-stu-id="72aed-150">The result displays the CLR data type used to represent `MyField`, for example, `System.String` or `System.DateTime`.</span></span>  
  
## <a name="converting-dataset-fields-to-a-different-data-type"></a><span data-ttu-id="72aed-151">將資料集欄位轉換成不同的資料類型</span><span class="sxs-lookup"><span data-stu-id="72aed-151">Converting Dataset Fields to a Different Data Type</span></span>  
 <span data-ttu-id="72aed-152">您也可以先轉換資料集欄位，然後再將它們用於報表中。</span><span class="sxs-lookup"><span data-stu-id="72aed-152">You can also convert dataset fields before you use them in a report.</span></span> <span data-ttu-id="72aed-153">下列清單將描述您可以轉換現有資料集欄位的方式：</span><span class="sxs-lookup"><span data-stu-id="72aed-153">The following list describes ways that you can convert an existing dataset field:</span></span>  
  
-   <span data-ttu-id="72aed-154">修改資料集查詢，以便加入含有已轉換資料的新查詢欄位。</span><span class="sxs-lookup"><span data-stu-id="72aed-154">Modify the dataset query to add a new query field with the converted data.</span></span> <span data-ttu-id="72aed-155">若為關聯式或多維度資料來源，這項作業會使用資料來源資源來執行轉換。</span><span class="sxs-lookup"><span data-stu-id="72aed-155">For relational or multidimensional data sources, this uses data source resources to perform the conversion.</span></span>  
  
-   <span data-ttu-id="72aed-156">透過撰寫將某個結果集資料行中所有資料轉換成含有不同資料類型之新資料行的運算式，根據現有的報表資料集欄位建立導出欄位。</span><span class="sxs-lookup"><span data-stu-id="72aed-156">Create a calculated field based on an existing report dataset field by writing an expression that converts all the data in one result set column to a new column with a different data type.</span></span> <span data-ttu-id="72aed-157">例如，下列運算式會將欄位 Year 從整數值轉換成字串值： `=CStr(Fields!Year.Value)`。</span><span class="sxs-lookup"><span data-stu-id="72aed-157">For example, the following expression converts the field Year from an integer value to a string value: `=CStr(Fields!Year.Value)`.</span></span> <span data-ttu-id="72aed-158">如需詳細資訊，請參閱[加入、編輯、重新整理報表資料窗格中的欄位 &#40;報表產生器及 SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="72aed-158">For more information, see [Add, Edit, Refresh Fields in the Report Data Pane &#40;Report Builder and SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span></span>  
  
-   <span data-ttu-id="72aed-159">檢查您所使用的資料處理延伸模組是否包含擷取預先格式化資料的中繼資料。</span><span class="sxs-lookup"><span data-stu-id="72aed-159">Check whether the data processing extension you are using includes metadata for retrieving preformatted data.</span></span> <span data-ttu-id="72aed-160">例如，[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] MDX 查詢包含在處理 Cube 時已經格式化的 Cube 值 FORMATTED_VALUE 擴充屬性。</span><span class="sxs-lookup"><span data-stu-id="72aed-160">For example, a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] MDX query includes a FORMATTED_VALUE extended property for cube values that have already been formatted when processing the cube.</span></span> <span data-ttu-id="72aed-161">如需詳細資訊，請參閱 [Analysis Services 資料庫的擴充欄位屬性 &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="72aed-161">For more information, see [Extended Field Properties for an Analysis Services Database &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span></span>  
  
## <a name="understanding-parameter-data-types"></a><span data-ttu-id="72aed-162">了解參數資料類型</span><span class="sxs-lookup"><span data-stu-id="72aed-162">Understanding Parameter Data Types</span></span>  
 <span data-ttu-id="72aed-163">報表參數必須屬於下列其中一種資料類型：Boolean、DateTime、Integer、Float 或 Text (也稱為 String)。</span><span class="sxs-lookup"><span data-stu-id="72aed-163">Report parameters must be one of five data types: Boolean, DateTime, Integer, Float, or Text (also known as String).</span></span> <span data-ttu-id="72aed-164">當資料集查詢包含查詢參數時，系統就會自動建立報表參數並將它們連結至查詢參數。</span><span class="sxs-lookup"><span data-stu-id="72aed-164">When a dataset query includes query parameters, report parameters are automatically created and linked to the query parameters.</span></span> <span data-ttu-id="72aed-165">報表參數的預設資料類型為 String。</span><span class="sxs-lookup"><span data-stu-id="72aed-165">The default data type for a report parameter is String.</span></span> <span data-ttu-id="72aed-166">若要變更報表參數的預設資料類型，請在 [報表參數屬性] 對話方塊的 [一般] 頁面上，從 [資料類型] 下拉式清單中選取正確的值。</span><span class="sxs-lookup"><span data-stu-id="72aed-166">To change the default data type of a report parameter, select the correct value from the **Data type** drop-down list on the **General** page of the **Report Parameter Properties** dialog box.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="72aed-167">屬於 DateTime 資料類型的報表參數不支援毫秒。</span><span class="sxs-lookup"><span data-stu-id="72aed-167">Report parameters that are DateTime data types do not support milliseconds.</span></span> <span data-ttu-id="72aed-168">雖然您可以根據包含毫秒的值建立參數，但是無法從包含毫秒之日期或時間值的可用值下拉式清單中選取值。</span><span class="sxs-lookup"><span data-stu-id="72aed-168">Although you can create a parameter based on values that include milliseconds, you cannot select a value from an available values drop-down list that includes Date or Time values that include milliseconds.</span></span>  
  
## <a name="writing-expressions-that-convert-data-types-or-extract-parts-of-data"></a><span data-ttu-id="72aed-169">撰寫轉換資料類型或擷取部分資料的運算式</span><span class="sxs-lookup"><span data-stu-id="72aed-169">Writing Expressions that Convert Data Types or Extract Parts of Data</span></span>  
 <span data-ttu-id="72aed-170">當您使用串連運算子 (&) 來結合文字和資料集欄位時，Common Language Runtime (CLR) 通常會提供預設格式。</span><span class="sxs-lookup"><span data-stu-id="72aed-170">When you combine text and dataset fields using the concatenation operator (&), the common language runtime (CLR) generally provides default formats.</span></span> <span data-ttu-id="72aed-171">當您必須將資料集欄位或參數轉換成特定資料類型時，就必須使用 CLR 方法或 Visual Basic 執行階段程式庫函數來轉換資料。</span><span class="sxs-lookup"><span data-stu-id="72aed-171">When you need to explicitly convert a dataset field or parameter to a specific data type, you must use a CLR method or a Visual Basic runtime library function to convert the data.</span></span>  
  
 <span data-ttu-id="72aed-172">下表將顯示轉換資料類型的範例。</span><span class="sxs-lookup"><span data-stu-id="72aed-172">The following table shows examples of converting data types.</span></span>  
  
|<span data-ttu-id="72aed-173">轉換的類型</span><span class="sxs-lookup"><span data-stu-id="72aed-173">Type of conversion</span></span>|<span data-ttu-id="72aed-174">範例</span><span class="sxs-lookup"><span data-stu-id="72aed-174">Example</span></span>|  
|------------------------|-------------|  
|<span data-ttu-id="72aed-175">DateTime 轉換成 String</span><span class="sxs-lookup"><span data-stu-id="72aed-175">DateTime to String</span></span>|`=CStr(Fields!Date.Value)`|  
|<span data-ttu-id="72aed-176">String 轉換成 DateTime</span><span class="sxs-lookup"><span data-stu-id="72aed-176">String to DateTime</span></span>|`=DateTime.Parse(Fields!DateTimeinStringFormat.Value)`|  
|<span data-ttu-id="72aed-177">String 轉換成 DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="72aed-177">String to DateTimeOffset</span></span>|`=DateTimeOffset.Parse(Fields!DateTimeOffsetinStringFormat.Value)`|  
|<span data-ttu-id="72aed-178">擷取年份</span><span class="sxs-lookup"><span data-stu-id="72aed-178">Extracting the Year</span></span>|`=Year(Fields!TimeinStringFormat.Value)`<br /><br /> `-- or --`<br /><br /> `=Year(Fields!TimeinDateTimeFormat.Value)`|  
|<span data-ttu-id="72aed-179">Boolean 轉換成 Integer</span><span class="sxs-lookup"><span data-stu-id="72aed-179">Boolean to Integer</span></span>|`=CInt(Parameters!BooleanField.Value)`<br /><br /> <span data-ttu-id="72aed-180">-1 為 True 而 0 為 False。</span><span class="sxs-lookup"><span data-stu-id="72aed-180">-1 is True and 0 is False.</span></span>|  
|<span data-ttu-id="72aed-181">Boolean 轉換成 Integer</span><span class="sxs-lookup"><span data-stu-id="72aed-181">Boolean to Integer</span></span>|`=System.Convert.ToInt32(Fields!BooleanFormat.Value)`<br /><br /> <span data-ttu-id="72aed-182">1 為 True 而 0 為 False。</span><span class="sxs-lookup"><span data-stu-id="72aed-182">1 is True and 0 is False.</span></span>|  
|<span data-ttu-id="72aed-183">只有 DateTimeOffset 值的 DateTime 部分</span><span class="sxs-lookup"><span data-stu-id="72aed-183">Just the DateTime part of a DateTimeOffset value</span></span>|`=Fields!MyDatetimeOffset.Value.DateTime`|  
|<span data-ttu-id="72aed-184">只有 DateTimeOffset 值的 Offset 部分</span><span class="sxs-lookup"><span data-stu-id="72aed-184">Just the Offset part of a DateTimeOffset value</span></span>|`=Fields!MyDatetimeOffset.Value.Offset`|  
  
 <span data-ttu-id="72aed-185">您也可以使用 Format 函數來控制值的顯示格式。</span><span class="sxs-lookup"><span data-stu-id="72aed-185">You can also use the Format function to control the display format for value.</span></span> <span data-ttu-id="72aed-186">如需詳細資訊，請參閱 [函式 (Visual Basic)](https://go.microsoft.com/fwlink/?linkid=111483)。</span><span class="sxs-lookup"><span data-stu-id="72aed-186">For more information, see [Functions (Visual Basic)](https://go.microsoft.com/fwlink/?linkid=111483).</span></span>  
  
## <a name="advanced-examples"></a><span data-ttu-id="72aed-187">進階範例</span><span class="sxs-lookup"><span data-stu-id="72aed-187">Advanced Examples</span></span>  
 <span data-ttu-id="72aed-188">當您連接至某個資料來源，但是所使用的資料提供者並未提供該資料來源之所有資料類型的轉換支援時，不支援之資料來源類型的預設資料類型就是 String。</span><span class="sxs-lookup"><span data-stu-id="72aed-188">When you connect to a data source with a data provider that does not provide conversion support for all the data types on the data source, the default data type for unsupported data source types is String.</span></span> <span data-ttu-id="72aed-189">下列範例會提供當做字串傳回之特定資料類型的解決方案。</span><span class="sxs-lookup"><span data-stu-id="72aed-189">The following examples provide solutions to specific data types that are returned as a string.</span></span>  
  
### <a name="concatenating-a-string-and-a-clr-datetimeoffset-data-type"></a><span data-ttu-id="72aed-190">串連 String 和 CLR DateTimeOffset 資料類型</span><span class="sxs-lookup"><span data-stu-id="72aed-190">Concatenating a String and a CLR DateTimeOffset Data Type</span></span>  
 <span data-ttu-id="72aed-191">CLR 會針對大部分資料類型提供預設轉換，讓您能夠使用 & 運算子，將不同資料類型的值串連成單一字串。</span><span class="sxs-lookup"><span data-stu-id="72aed-191">For most data types, the CLR provides default conversions so that you can concatenate values that are different data types into one string by using the & operator.</span></span> <span data-ttu-id="72aed-192">例如，下列運算式會串連文字 "The date and time are: " 與資料集欄位 StartDate (它是 <xref:System.DateTime> 值)： `="The date and time are: " & Fields!StartDate.Value`。</span><span class="sxs-lookup"><span data-stu-id="72aed-192">For example, the following expression concatenates the text "The date and time are: " with a dataset field StartDate, which is a <xref:System.DateTime> value: `="The date and time are: " & Fields!StartDate.Value`.</span></span>  
  
 <span data-ttu-id="72aed-193">若為某些資料類型，您可能就必須加入 ToString 函數。</span><span class="sxs-lookup"><span data-stu-id="72aed-193">For some data types, you may need to include the ToString function.</span></span> <span data-ttu-id="72aed-194">例如，下列運算式會使用 CLR 資料類型 <xref:System.DateTimeOffset>來顯示相同的範例，其中包含日期、時間和相對於 UTC 時區的時區時差： `="The time is: " & Fields!StartDate.Value.ToString()`。</span><span class="sxs-lookup"><span data-stu-id="72aed-194">For example, the following expression shows the same example using the CLR data type <xref:System.DateTimeOffset>, which include the date, the time, and a time-zone offset relative to the UTC time zone: `="The time is: " & Fields!StartDate.Value.ToString()`.</span></span>  
  
### <a name="converting-a-string-data-type-to-a-clr-datetime-data-type"></a><span data-ttu-id="72aed-195">將 String 資料類型轉換成 CLR DateTime 資料類型</span><span class="sxs-lookup"><span data-stu-id="72aed-195">Converting a String Data Type to a CLR DateTime Data Type</span></span>  
 <span data-ttu-id="72aed-196">如果資料處理延伸模組不支援針對資料來源所定義的所有資料類型，系統可能會將資料擷取成文字。</span><span class="sxs-lookup"><span data-stu-id="72aed-196">If a data processing extension does not support all data types defined on a data source, the data may be retrieved as text.</span></span> <span data-ttu-id="72aed-197">例如，`datetimeoffset(7)` 資料類型值可能會擷取成 String 資料類型。</span><span class="sxs-lookup"><span data-stu-id="72aed-197">For example, a `datetimeoffset(7)` data type value may be retrieved as a String data type.</span></span> <span data-ttu-id="72aed-198">在澳大利亞的伯斯省，代表 2008 年 7 月 1 日上午 6:05:07.9999999 的字串值</span><span class="sxs-lookup"><span data-stu-id="72aed-198">In Perth, Australia, the string value for July 1, 2008, at 6:05:07.9999999 A.M.</span></span> <span data-ttu-id="72aed-199">會類似下列內容：</span><span class="sxs-lookup"><span data-stu-id="72aed-199">would resemble:</span></span>  
  
 `2008-07-01 06:05:07.9999999 +08:00`  
  
 <span data-ttu-id="72aed-200">這個範例會顯示日期 (2008 年 7 月 1 日)、接著 7 位數精確度的時間 (上午 6:05:07.9999999)，然後接著以小時和分鐘為單位的 UTC 時區時差 (加上 8 小時，0 分)。</span><span class="sxs-lookup"><span data-stu-id="72aed-200">This example shows the date (July 1, 2008), followed by the time to a 7-digit precision (6:05:07.9999999 A.M.), followed by a UTC time zone offset in hours and minutes (plus 8 hours, 0 minutes).</span></span> <span data-ttu-id="72aed-201">在下列範例中，這個值已經放置於稱為 `MyDateTime.Value` 的 `String` 欄位中。</span><span class="sxs-lookup"><span data-stu-id="72aed-201">For the following examples, this value has been placed in a `String` field called `MyDateTime.Value`.</span></span>  
  
 <span data-ttu-id="72aed-202">您可以使用下列其中一種策略，將這項資料轉換成一個或多個 CLR 值：</span><span class="sxs-lookup"><span data-stu-id="72aed-202">You can use one of the following strategies to convert this data to one or more CLR values:</span></span>  
  
-   <span data-ttu-id="72aed-203">在文字方塊中，使用運算式來擷取部分字串。</span><span class="sxs-lookup"><span data-stu-id="72aed-203">In a text box, use an expression to extract parts of the string.</span></span> <span data-ttu-id="72aed-204">例如：</span><span class="sxs-lookup"><span data-stu-id="72aed-204">For example:</span></span>  
  
    -   <span data-ttu-id="72aed-205">下列運算式只會擷取 UTC 時區時差的小時部分，並將它轉換成分鐘： `=CInt(Fields!MyDateTime.Value.Substring(Fields!MyDateTime.Value.Length-5,2)) * 60`</span><span class="sxs-lookup"><span data-stu-id="72aed-205">The following expression extracts just the hour part of the UTC time zone offset and converts it to minutes: `=CInt(Fields!MyDateTime.Value.Substring(Fields!MyDateTime.Value.Length-5,2)) * 60`</span></span>  
  
         <span data-ttu-id="72aed-206">結果為 `480`。</span><span class="sxs-lookup"><span data-stu-id="72aed-206">The result is `480`.</span></span>  
  
    -   <span data-ttu-id="72aed-207">下列運算式會將字串轉換成日期和時間值： `=DateTime.Parse(Fields!MyDateTime.Value)`</span><span class="sxs-lookup"><span data-stu-id="72aed-207">The following expression converts the string to a date and time value: `=DateTime.Parse(Fields!MyDateTime.Value)`</span></span>  
  
         <span data-ttu-id="72aed-208">如果 `MyDateTime.Value` 字串具有 UTC 時差， `DateTime.Parse` 函數會先針對 UTC 時差調整 (上午 7 點</span><span class="sxs-lookup"><span data-stu-id="72aed-208">If the `MyDateTime.Value` string has a UTC offset, the `DateTime.Parse` function first adjusts for the UTC offset (7 A.M.</span></span> <span data-ttu-id="72aed-209">- [`+08:00`] 調整成前一晚 11 點的 UTC</span><span class="sxs-lookup"><span data-stu-id="72aed-209">- [`+08:00`] to the UTC time of 11 P.M.</span></span> <span data-ttu-id="72aed-210">時間)。</span><span class="sxs-lookup"><span data-stu-id="72aed-210">the night before).</span></span> <span data-ttu-id="72aed-211">然後， `DateTime.Parse` 函數會套用本機報表伺服器 UTC 時差，並在必要時，再次針對日光節約時間調整時間。</span><span class="sxs-lookup"><span data-stu-id="72aed-211">The `DateTime.Parse` function then applies the local report server UTC offset and, if necessary, adjusts the time again for Daylight Saving Time.</span></span> <span data-ttu-id="72aed-212">例如，在華盛頓州的雷德蒙市，針對日光節約時間調整的本地時間時差是 `[-07:00]`，或下午 11 點之前的 7 個小時。</span><span class="sxs-lookup"><span data-stu-id="72aed-212">For example, in Redmond, Washington, the local time offset adjusted for Daylight Saving Time is `[-07:00]`, or 7 hours earlier than 11 PM.</span></span> <span data-ttu-id="72aed-213">結果就是下列 `DateTime` 值：`2007-07-06 04:07:07 PM` (2007 年 7 月 6 日下午 4:07)。</span><span class="sxs-lookup"><span data-stu-id="72aed-213">The result is the following `DateTime` value: `2007-07-06 04:07:07 PM` (July 6, 2007 at 4:07 P.M).</span></span>  
  
 <span data-ttu-id="72aed-214">如需將字串轉換成資料類型的詳細資訊 `DateTime` ，請參閱[剖析日期和時間字串](https://go.microsoft.com/fwlink/?LinkId=89703)、[格式化特定文化特性的日期和時間](https://go.microsoft.com/fwlink/?LinkId=89704)，以及在 MSDN 上的[DateTime、DateTimeOffset 和 TimeZoneInfo 之間選擇](https://go.microsoft.com/fwlink/?linkid=110652)。</span><span class="sxs-lookup"><span data-stu-id="72aed-214">For more information about converting strings to `DateTime` data types, see [Parsing Date and Time Strings](https://go.microsoft.com/fwlink/?LinkId=89703), [Formatting Date and Time for a Specific Culture](https://go.microsoft.com/fwlink/?LinkId=89704), and [Choosing Between DateTime, DateTimeOffset, and TimeZoneInfo](https://go.microsoft.com/fwlink/?linkid=110652) on MSDN.</span></span>  
  
-   <span data-ttu-id="72aed-215">將新的導出欄位加入至報表資料集，以便使用運算式來擷取部分字串。</span><span class="sxs-lookup"><span data-stu-id="72aed-215">Add a new calculated field to the report dataset that uses an expression to extract parts of the string.</span></span> <span data-ttu-id="72aed-216">如需詳細資訊，請參閱[加入、編輯、重新整理報表資料窗格中的欄位 &#40;報表產生器及 SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="72aed-216">For more information, see [Add, Edit, Refresh Fields in the Report Data Pane &#40;Report Builder and SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span></span>  
  
-   <span data-ttu-id="72aed-217">將報表資料集查詢變更成使用 [!INCLUDE[tsql](../../includes/tsql-md.md)] 函數來獨立擷取日期與時間值，以便建立個別的資料行。</span><span class="sxs-lookup"><span data-stu-id="72aed-217">Change the report dataset query to use [!INCLUDE[tsql](../../includes/tsql-md.md)] functions to extract the date and time values independently to create separate columns.</span></span> <span data-ttu-id="72aed-218">下列範例將示範如何使用函數 `DatePart` 來加入代表年份的資料行，以及轉換成分鐘之 UTC 時區的資料行：</span><span class="sxs-lookup"><span data-stu-id="72aed-218">The following example shows how to use the function `DatePart` to add a column for the year and a column for the UTC time zone converted to minutes:</span></span>  
  
     `SELECT`  
  
     `MyDateTime,`  
  
     `DATEPART(year, MyDateTime) AS Year,`  
  
     `DATEPART(tz, MyDateTime) AS OffsetinMinutes`  
  
     `FROM MyDates`  
  
     <span data-ttu-id="72aed-219">結果集含有三個資料行。</span><span class="sxs-lookup"><span data-stu-id="72aed-219">The result set has three columns.</span></span> <span data-ttu-id="72aed-220">第一個資料行是日期和時間、第二個資料行是年份，而第三個資料行是 UTC 時差 (以分鐘為單位)。</span><span class="sxs-lookup"><span data-stu-id="72aed-220">The first column is the date and time, the second column is the year, and the third column is the UTC offset in minutes.</span></span> <span data-ttu-id="72aed-221">以下資料列是範例資料示範：</span><span class="sxs-lookup"><span data-stu-id="72aed-221">The following row shows example data:</span></span>  
  
     `2008-07-01 06:05:07             2008                   480`  
  
 <span data-ttu-id="72aed-222">如需 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資料庫資料類型的詳細資訊，請參閱 [SQL Server 線上叢書](https://go.microsoft.com/fwlink/?linkid=120955)中的[資料類型 &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql) 及[日期和時間資料類型與函數 &#40;Transact-SQL&#41;](/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="72aed-222">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database data types, see [Data Types &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql), and [Date and Time Data Types and Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql) in [SQL Server Books Online](https://go.microsoft.com/fwlink/?linkid=120955).</span></span>  
  
 <span data-ttu-id="72aed-223">如需 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 資料類型的詳細資訊，請參閱《 [SQL Server 線上叢書](https://docs.microsoft.com/analysis-services/multidimensional-models/olap-physical/data-types-in-analysis-services) 》中的 [SQL Server Books Onl》中的e](https://go.microsoft.com/fwlink/?linkid=120955)。</span><span class="sxs-lookup"><span data-stu-id="72aed-223">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data types, see [Data Types in Analysis Services](https://docs.microsoft.com/analysis-services/multidimensional-models/olap-physical/data-types-in-analysis-services) in [SQL Server Books Online](https://go.microsoft.com/fwlink/?linkid=120955).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="72aed-224">另請參閱</span><span class="sxs-lookup"><span data-stu-id="72aed-224">See Also</span></span>  
 [<span data-ttu-id="72aed-225">設定報表項目的格式 &#40;報表產生器及 SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="72aed-225">Formatting Report Items &#40;Report Builder and SSRS&#41;</span></span>](formatting-report-items-report-builder-and-ssrs.md)  
  
  
