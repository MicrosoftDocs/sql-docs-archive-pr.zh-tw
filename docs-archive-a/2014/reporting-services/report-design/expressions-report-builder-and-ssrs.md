---
title: 運算式 (報表產生器及 SSRS) | Microsoft Docs
ms.prod: sql-server-2014
ms.technology: reporting-services
ms.topic: conceptual
ms.assetid: 76d3ac86-650c-46fe-8086-8b3edcea3882
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.reviewer: ''
ms.custom: ''
ms.date: 06/13/2017
ms.openlocfilehash: afd1b21986d0400ec8861520f3e86d1a80269036
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87594400"
---
# <a name="expressions-report-builder-and-ssrs"></a><span data-ttu-id="816eb-102">運算式 (報表產生器及 SSRS)</span><span class="sxs-lookup"><span data-stu-id="816eb-102">Expressions (Report Builder and SSRS)</span></span>

<span data-ttu-id="816eb-103">報表中從頭到尾都廣泛利用運算式來擷取、計算、顯示、分組、排序、篩選、參數化及格式化資料。</span><span class="sxs-lookup"><span data-stu-id="816eb-103">Expressions are widely used throughout a report to retrieve, calculate, display, group, sort, filter, parameterize, and format data.</span></span> <span data-ttu-id="816eb-104">許多報表項目屬性都可以設定為運算式。</span><span class="sxs-lookup"><span data-stu-id="816eb-104">Many report item properties can be set to an expression.</span></span> <span data-ttu-id="816eb-105">運算式可協助您控制報表的內容、設計與互動性。</span><span class="sxs-lookup"><span data-stu-id="816eb-105">Expressions help you control the content, design, and interactivity of your report.</span></span> <span data-ttu-id="816eb-106">運算式會以 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)] 撰寫、儲存在報表定義中，然後在您執行報表時由報表處理器評估。</span><span class="sxs-lookup"><span data-stu-id="816eb-106">Expressions are written in [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)], saved in the report definition, and evaluated by the report processor when you run the report.</span></span>  

<span data-ttu-id="816eb-107">報表與 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Office Excel 之類的應用程式不同，後者會直接使用工作表中的資料，而前者則使用資料預留位置的運算式。</span><span class="sxs-lookup"><span data-stu-id="816eb-107">Unlike applications such as [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Office Excel where you work with data directly in a worksheet, in a report, you work with expressions that are placeholders for data.</span></span> <span data-ttu-id="816eb-108">若要從評估的運算式查看實際資料，您必須預覽報表。</span><span class="sxs-lookup"><span data-stu-id="816eb-108">To see the actual data from the evaluated expressions, you must preview the report.</span></span> <span data-ttu-id="816eb-109">當您執行報表時，報表處理器會評估每個運算式，因為它會結合資料與報表配置元素，例如資料表和圖表。</span><span class="sxs-lookup"><span data-stu-id="816eb-109">When you run the report, the report processor evaluates each expression as it combines report data and report layout elements such as tables and charts.</span></span>  

<span data-ttu-id="816eb-110">當您設計報表時，系統會為您設定許多報表項目的運算式。</span><span class="sxs-lookup"><span data-stu-id="816eb-110">As you design a report, many expressions for report items are set for you.</span></span> <span data-ttu-id="816eb-111">例如，當您將欄位從資料窗格拖曳到報表設計介面上的資料表資料格時，文字方塊值會設定為欄位的簡單運算式。</span><span class="sxs-lookup"><span data-stu-id="816eb-111">For example, when you drag a field from the data pane to a table cell on the report design surface, the text box value is set to a simple expression for the field.</span></span> <span data-ttu-id="816eb-112">在下圖中，[報表資料] 窗格會顯示 ID、Name、SalesTerritory、Code 和 Sales 資料集欄位。</span><span class="sxs-lookup"><span data-stu-id="816eb-112">In the following figure, the Report Data pane displays the dataset fields ID, Name, SalesTerritory, Code, and Sales.</span></span> <span data-ttu-id="816eb-113">有三個欄位已加入資料表中：[Name]、[Code] 和 [Sales]。</span><span class="sxs-lookup"><span data-stu-id="816eb-113">Three fields have been added to the table: [Name], [Code], and [Sales].</span></span> <span data-ttu-id="816eb-114">設計介面上的標記 [Name] 代表基礎運算式 `=Fields!Name.Value`。</span><span class="sxs-lookup"><span data-stu-id="816eb-114">The notation [Name] on the design surface represents the underlying expression `=Fields!Name.Value`.</span></span>  

<span data-ttu-id="816eb-115">![rs_DataDesignandPreview](../media/rs-datadesignandpreview.gif "rs_DataDesignandPreview")</span><span class="sxs-lookup"><span data-stu-id="816eb-115">![rs_DataDesignandPreview](../media/rs-datadesignandpreview.gif "rs_DataDesignandPreview")</span></span>  

<span data-ttu-id="816eb-116">當您預覽報表時，報表處理器會結合資料表資料區與資料連接中的實際資料，並針對結果集中的每個資料列顯示資料表中的資料列。</span><span class="sxs-lookup"><span data-stu-id="816eb-116">When you preview the report, the report processor combines the table data region with the actual data from the data connection and displays a row in the table for every row in the result set.</span></span>  

<span data-ttu-id="816eb-117">若要手動輸入運算式，請在設計介面上選取項目，然後使用快速鍵功能表和對話方塊來設定此項目的屬性。</span><span class="sxs-lookup"><span data-stu-id="816eb-117">To enter expressions manually, select an item on the design surface, and use shortcut menus and dialog boxes to set the properties of the item.</span></span> <span data-ttu-id="816eb-118">當您在下拉式清單中看到 ***(fx)*** 按鈕或 `<Expression>` 值時，就會知道可以將此屬性設定為運算式。</span><span class="sxs-lookup"><span data-stu-id="816eb-118">When you see the ***(fx)*** button or the value `<Expression>` in a drop-down list, you know that you can set the property to an expression.</span></span> <span data-ttu-id="816eb-119">如需詳細資訊，請參閱 [加入運算式 &#40;報表產生器及 SSRS&#41;](add-an-expression-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="816eb-119">For more information, see [Add an Expression &#40;Report Builder and SSRS&#41;](add-an-expression-report-builder-and-ssrs.md).</span></span>  

<span data-ttu-id="816eb-120">如需詳細資訊和範例，請參閱下列主題：</span><span class="sxs-lookup"><span data-stu-id="816eb-120">For more information and examples, see the following topics:</span></span>  

-   [<span data-ttu-id="816eb-121">報表中的運算式用法 &#40;報表產生器及 SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="816eb-121">Expression Uses in Reports &#40;Report Builder and SSRS&#41;</span></span>](expression-uses-in-reports-report-builder-and-ssrs.md)  

-   [<span data-ttu-id="816eb-122">運算式範例 &#40;報表產生器及 SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="816eb-122">Expression Examples &#40;Report Builder and SSRS&#41;</span></span>](expression-examples-report-builder-and-ssrs.md)  

-   [<span data-ttu-id="816eb-123">篩選方程式範例 &#40;報表產生器及 SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="816eb-123">Filter Equation Examples &#40;Report Builder and SSRS&#41;</span></span>](filter-equation-examples-report-builder-and-ssrs.md)  

-   [<span data-ttu-id="816eb-124">群組運算式範例 &#40;報表產生器及 SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="816eb-124">Group Expression Examples &#40;Report Builder and SSRS&#41;</span></span>](group-expression-examples-report-builder-and-ssrs.md)  

-   [<span data-ttu-id="816eb-125">教學課程 &#40;報表產生器&#41;</span><span class="sxs-lookup"><span data-stu-id="816eb-125">Tutorials &#40;Report Builder&#41;</span></span>](../report-builder-tutorials.md)  

-   [<span data-ttu-id="816eb-126">Reporting Services 教學課程 &#40;SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="816eb-126">Reporting Services Tutorials &#40;SSRS&#41;</span></span>](../reporting-services-tutorials-ssrs.md)  

-   [<span data-ttu-id="816eb-127">報表範例 (報表產生器和 SSRS)</span><span class="sxs-lookup"><span data-stu-id="816eb-127">Report Samples (Report Builder and SSRS)</span></span>](https://go.microsoft.com/fwlink/?LinkId=198283)  

<span data-ttu-id="816eb-128">若要開發複雜運算式或使用自訂程式碼或自訂組件的運算式，建議您使用 [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)]中的報表設計師。</span><span class="sxs-lookup"><span data-stu-id="816eb-128">To develop complex expressions or expressions that use custom code or custom assemblies, we recommend that you use Report Designer in [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="816eb-129">如需詳細資訊，請參閱 [報表設計師中運算式的自訂程式碼及組件參考 &#40;SSRS&#41;](custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="816eb-129">For more information, see [Custom Code and Assembly References in Expressions in Report Designer &#40;SSRS&#41;](custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md).</span></span>  

> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  

##  <a name="understanding-simple-and-complex-expressions"></a><a name="Types"></a> <span data-ttu-id="816eb-130">了解簡單和複雜運算式</span><span class="sxs-lookup"><span data-stu-id="816eb-130">Understanding Simple and Complex Expressions</span></span>  
<span data-ttu-id="816eb-131">運算式是以等號 (=) 開頭，而且是以撰寫 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="816eb-131">Expressions begin with an equal sign (=) and are written in [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)].</span></span> <span data-ttu-id="816eb-132">運算式可以包含常數、運算子及內建值 (欄位、集合和函數) 和外部或自訂程式碼參考的組合。</span><span class="sxs-lookup"><span data-stu-id="816eb-132">Expressions can include a combination of constants, operators, and references to built-in values (fields, collections, and functions), and to external or custom code.</span></span>  

<span data-ttu-id="816eb-133">您可以使用運算式來指定許多報表項目屬性的值。</span><span class="sxs-lookup"><span data-stu-id="816eb-133">You can use expressions to specify the value of many report item properties.</span></span> <span data-ttu-id="816eb-134">最常見的屬性為文字方塊與預留位置文字的值。</span><span class="sxs-lookup"><span data-stu-id="816eb-134">The most common properties are values for text boxes and placeholder text.</span></span> <span data-ttu-id="816eb-135">如果文字方塊只包含一個運算式，該運算式通常就是文字方塊屬性的值。</span><span class="sxs-lookup"><span data-stu-id="816eb-135">Typically, if a text box contains only one expression, the expression is the value of the text box property.</span></span> <span data-ttu-id="816eb-136">如果文字方塊包含多個運算式，每個運算式都是文字方塊中的預留位置文字值。</span><span class="sxs-lookup"><span data-stu-id="816eb-136">If a text box contains multiple expressions, each expression is the value of placeholder text in the text box.</span></span>  

<span data-ttu-id="816eb-137">根據預設，運算式在報表設計介面上會顯示成「簡單運算式」\*\* 或「複雜運算式」\*\*。</span><span class="sxs-lookup"><span data-stu-id="816eb-137">By default, expressions appear on the report design surface as *simple* or *complex expressions*.</span></span>  

-   <span data-ttu-id="816eb-138">**簡單** ：簡單運算式包含內建集合中單一項目的參考，例如資料集欄位、參數或內建欄位。</span><span class="sxs-lookup"><span data-stu-id="816eb-138">**Simple** A simple expression contains a reference to a single item in a built-in collection, for example, a dataset field, a parameter, or a built-in field.</span></span> <span data-ttu-id="816eb-139">在設計介面上，簡單運算式會以方括號的形式出現。</span><span class="sxs-lookup"><span data-stu-id="816eb-139">On the design surface, a simple expression appears in brackets.</span></span> <span data-ttu-id="816eb-140">例如， `[FieldName]` 相當於基礎運算式 `=Fields!FieldName.Value`。</span><span class="sxs-lookup"><span data-stu-id="816eb-140">For example, `[FieldName]` corresponds to the underlying expression `=Fields!FieldName.Value`.</span></span> <span data-ttu-id="816eb-141">當您建立報表配置，並將項目從 [報表資料] 窗格拖曳到設計介面時，系統會為您自動建立簡單運算式。</span><span class="sxs-lookup"><span data-stu-id="816eb-141">Simple expressions are created for you automatically as you create the report layout and drag items from the Report Data pane to the design surface.</span></span> <span data-ttu-id="816eb-142">如需代表不同內建集合之符號的詳細資訊，請參閱 [了解簡單運算式中的字首符號](#DisplayText)。</span><span class="sxs-lookup"><span data-stu-id="816eb-142">For more information about the symbols that represent different built-in collections, see [Understanding Prefix Symbols for Simple Expressions](#DisplayText).</span></span>  

-   <span data-ttu-id="816eb-143">**複雜** ：複雜運算式包含多個內建參考、運算子和函數呼叫的參考。</span><span class="sxs-lookup"><span data-stu-id="816eb-143">**Complex** A complex expression contains references to multiple built-in references, operators, and function calls.</span></span> <span data-ttu-id="816eb-144">\<Expr>當運算式值包含多個簡單參考時，複雜運算式會顯示為 <>。</span><span class="sxs-lookup"><span data-stu-id="816eb-144">A complex expression appears as <\<Expr>> when the expression value includes more than a simple reference.</span></span> <span data-ttu-id="816eb-145">若要檢視運算式，請將滑鼠指標停留在該運算式上，然後使用工具提示。</span><span class="sxs-lookup"><span data-stu-id="816eb-145">To view the expression, hover over it and use the tooltip.</span></span> <span data-ttu-id="816eb-146">若要編輯運算式，在 [運算式]\*\*\*\* 對話方塊中開啟該運算式。</span><span class="sxs-lookup"><span data-stu-id="816eb-146">To edit the expression, open it in the **Expression** dialog box.</span></span>  

<span data-ttu-id="816eb-147">下圖同時針對文字方塊和預留位置文字顯示一般的簡單運算式和複雜運算式。</span><span class="sxs-lookup"><span data-stu-id="816eb-147">The following figure shows typical simple and complex expressions for both text boxes and placeholder text.</span></span>  

<span data-ttu-id="816eb-148">![rs_ExpressionDefaultFormat](../media/rs-expressiondefaultformat.gif "rs_ExpressionDefaultFormat")</span><span class="sxs-lookup"><span data-stu-id="816eb-148">![rs_ExpressionDefaultFormat](../media/rs-expressiondefaultformat.gif "rs_ExpressionDefaultFormat")</span></span>  

<span data-ttu-id="816eb-149">若要顯示範例值而非運算式的文字，請將格式套用到文字方塊或預留位置文字。</span><span class="sxs-lookup"><span data-stu-id="816eb-149">To display sample values instead of text for expressions, apply formatting to the text box or placeholder text.</span></span> <span data-ttu-id="816eb-150">下圖顯示切換為顯示範例值的報表設計介面：</span><span class="sxs-lookup"><span data-stu-id="816eb-150">The following figure shows the report design surface toggled to show sample values:</span></span>  

<span data-ttu-id="816eb-151">![rs_ExpressionSampleValuesFormat](../media/rs-expressionsamplevaluesformat.gif "rs_ExpressionSampleValuesFormat")</span><span class="sxs-lookup"><span data-stu-id="816eb-151">![rs_ExpressionSampleValuesFormat](../media/rs-expressionsamplevaluesformat.gif "rs_ExpressionSampleValuesFormat")</span></span>  

<span data-ttu-id="816eb-152">如需詳細資訊，請參閱 [格式化文字和預留位置 &#40;報表產生器及 SSRS&#41;](formatting-text-and-placeholders-report-builder-and-ssrs.md)(建立發票和表單的清單)。</span><span class="sxs-lookup"><span data-stu-id="816eb-152">For more information, see [Formatting Text and Placeholders &#40;Report Builder and SSRS&#41;](formatting-text-and-placeholders-report-builder-and-ssrs.md).</span></span>  

## <a name="understanding-prefix-symbols-in-simple-expressions"></a><a name="DisplayText"></a><span data-ttu-id="816eb-153">瞭解簡單運算式中的前置詞符號</span><span class="sxs-lookup"><span data-stu-id="816eb-153">Understanding Prefix Symbols in Simple Expressions</span></span>  

<span data-ttu-id="816eb-154">簡單運算式會使用符號來指示參考是指向欄位、參數、內建集合還是報表項目集合。</span><span class="sxs-lookup"><span data-stu-id="816eb-154">Simple expressions use symbols to indicate whether the reference is to a field, a parameter, a built-in collection, or the ReportItems collection.</span></span> <span data-ttu-id="816eb-155">下表顯示了顯示和運算式文字的範例：</span><span class="sxs-lookup"><span data-stu-id="816eb-155">The following table shows examples of display and expression text:</span></span>  

|<span data-ttu-id="816eb-156">項目</span><span class="sxs-lookup"><span data-stu-id="816eb-156">Item</span></span>|<span data-ttu-id="816eb-157">顯示文字範例</span><span class="sxs-lookup"><span data-stu-id="816eb-157">Display text example</span></span>|<span data-ttu-id="816eb-158">運算式文字範例</span><span class="sxs-lookup"><span data-stu-id="816eb-158">Expression text example</span></span>|  
|----------|--------------------------|-----------------------------|  
|<span data-ttu-id="816eb-159">資料集欄位</span><span class="sxs-lookup"><span data-stu-id="816eb-159">Dataset fields</span></span>|`[Sales]`<br /><br /> `[SUM(Sales)]`<br /><br /> `[FIRST(Store)]`|`=Fields!Sales.Value`<br /><br /> `=Sum(Fields!Sales.Value)`<br /><br /> `=First(Fields!Store.Value)`|  
|<span data-ttu-id="816eb-160">報表參數</span><span class="sxs-lookup"><span data-stu-id="816eb-160">Report parameters</span></span>|`[@Param]`<br /><br /> `[@Param.Label]`|`=Parameters!Param.Value`<br /><br /> `=Parameters!Param.Label`|  
|<span data-ttu-id="816eb-161">內建欄位</span><span class="sxs-lookup"><span data-stu-id="816eb-161">Built-in fields</span></span>|`[&ReportName]`|`=Globals!ReportName.Value`|  
|<span data-ttu-id="816eb-162">用於顯示文字的常值字元</span><span class="sxs-lookup"><span data-stu-id="816eb-162">Literal characters used for display text</span></span>|`\[Sales\]`|`[Sales]`|  



##  <a name="writing-complex-expressions"></a><a name="References"></a><span data-ttu-id="816eb-163">撰寫複雜運算式</span><span class="sxs-lookup"><span data-stu-id="816eb-163">Writing Complex Expressions</span></span>  
<span data-ttu-id="816eb-164">運算式可以包含函數、運算子、常數、欄位、參數、內建集合的項目，以及內嵌自訂程式碼或自訂組件的參考。</span><span class="sxs-lookup"><span data-stu-id="816eb-164">Expressions can include references to functions, operators, constants, fields, parameters, items from built-in collections, and to embedded custom code or custom assemblies.</span></span>  

> [!NOTE]
>  <span data-ttu-id="816eb-165">若要開發複雜運算式或使用自訂程式碼或自訂組件的運算式，建議您使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)]中的報表設計師。</span><span class="sxs-lookup"><span data-stu-id="816eb-165">To develop complex expressions or expressions that use custom code or custom assemblies, we recommend that you use Report Designer in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="816eb-166">如需詳細資訊，請參閱 [報表設計師中運算式的自訂程式碼及組件參考 &#40;SSRS&#41;](custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="816eb-166">For more information, see [Custom Code and Assembly References in Expressions in Report Designer &#40;SSRS&#41;](custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md).</span></span>  

<span data-ttu-id="816eb-167">下表列出可以包含在運算式中的參考種類：</span><span class="sxs-lookup"><span data-stu-id="816eb-167">The following table lists the kinds of references you can include in an expression:</span></span>  

|<span data-ttu-id="816eb-168">參考</span><span class="sxs-lookup"><span data-stu-id="816eb-168">References</span></span>|<span data-ttu-id="816eb-169">描述</span><span class="sxs-lookup"><span data-stu-id="816eb-169">Description</span></span>|<span data-ttu-id="816eb-170">範例</span><span class="sxs-lookup"><span data-stu-id="816eb-170">Example</span></span>|  
|----------------|-----------------|-------------|  
|[<span data-ttu-id="816eb-171">常數</span><span class="sxs-lookup"><span data-stu-id="816eb-171">Constants</span></span>](expressions-report-builder-and-ssrs.md)|<span data-ttu-id="816eb-172">描述可透過互動方式針對需要常數值的屬性而存取的常數，例如字型色彩。</span><span class="sxs-lookup"><span data-stu-id="816eb-172">Describes the constants you can access interactively for properties that require constant values, such as font colors.</span></span>|`="Blue"`|  
|[<span data-ttu-id="816eb-173">運算子</span><span class="sxs-lookup"><span data-stu-id="816eb-173">Operators</span></span>](operators-in-expressions-report-builder-and-ssrs.md)|<span data-ttu-id="816eb-174">描述您可以用來結合運算式中參考的運算子。</span><span class="sxs-lookup"><span data-stu-id="816eb-174">Describes the operators you can use to combine references in an expression.</span></span> <span data-ttu-id="816eb-175">例如，`&` 運算子用於串連字串。</span><span class="sxs-lookup"><span data-stu-id="816eb-175">For example, the `&` operator is used for concatenating strings.</span></span>|`="The report ran at: " & Globals!ExecutionTime & "."`|  
|[<span data-ttu-id="816eb-176">內建集合</span><span class="sxs-lookup"><span data-stu-id="816eb-176">Built-in Collections</span></span>](built-in-collections-in-expressions-report-builder.md)|<span data-ttu-id="816eb-177">描述可以包含在運算式中的內建集合，例如， `Fields`、 `Parameters`和 `Variables`。</span><span class="sxs-lookup"><span data-stu-id="816eb-177">Describes the built-in collections that you can include in an expression, such as `Fields`, `Parameters`, and `Variables`.</span></span>|`=Fields!Sales.Value`<br /><br /> `=Parameters!Store.Value`<br /><br /> `=Variables!MyCalculation.Value`|  
|[<span data-ttu-id="816eb-178">內建報表和彙總函式</span><span class="sxs-lookup"><span data-stu-id="816eb-178">Built-in Report and Aggregate Functions</span></span>](report-builder-functions-aggregate-functions-reference.md)|<span data-ttu-id="816eb-179">描述可以從運算式存取的內建函數，例如， `Sum` 或 `Previous`。</span><span class="sxs-lookup"><span data-stu-id="816eb-179">Describes the built-in functions, such as `Sum` or `Previous`, that you can access from an expression.</span></span>|`=Previous(Sum(Fields!Sales.Value))`|  
|[<span data-ttu-id="816eb-180">報表設計師中運算式的自訂程式碼及組件參考 &#40;SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="816eb-180">Custom Code and Assembly References in Expressions in Report Designer &#40;SSRS&#41;</span></span>](custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md)|<span data-ttu-id="816eb-181">描述如何存取內建的 CLR 類別 <xref:System.Math> 和 <xref:System.Convert>、其他的 CLR 類別、 [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)] 執行階段程式庫函數，或來自外部組件的方法。</span><span class="sxs-lookup"><span data-stu-id="816eb-181">Describes how you can access the built-in CLR classes <xref:System.Math> and <xref:System.Convert>, other CLR classes, [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)] run-time library functions, or methods from an external assembly.</span></span><br /><br /> <span data-ttu-id="816eb-182">描述如何存取內嵌於報表，或在編譯後安裝在報表用戶端和報表伺服器上做為自訂組件的自訂程式碼。</span><span class="sxs-lookup"><span data-stu-id="816eb-182">Describes how you can access custom code that is embedded in your report, or that you compile and install as a custom assembly on both the report client and the report server.</span></span>|`=Sum(Fields!Sales.Value)`<br /><br /> `=CDate(Fields!SalesDate.Value)`<br /><br /> `=DateAdd("d",3,Fields!BirthDate.Value)`<br /><br /> `=Code.ToUSD(Fields!StandardCost.Value)`|  



##  <a name="validating-expressions"></a><a name="Valid"></a><span data-ttu-id="816eb-183">驗證運算式</span><span class="sxs-lookup"><span data-stu-id="816eb-183">Validating Expressions</span></span>  
<span data-ttu-id="816eb-184">為特定的報表項目屬性建立運算式時，包含在運算式中的參考取決於報表項目屬性可以接受的值，以及評估屬性的範圍。</span><span class="sxs-lookup"><span data-stu-id="816eb-184">When you create an expression for a specific report item property, the references that you can include in an expression depend on the values that the report item property can accept and the scope in which the property is evaluated.</span></span> <span data-ttu-id="816eb-185">例如：</span><span class="sxs-lookup"><span data-stu-id="816eb-185">For example:</span></span>  

-   <span data-ttu-id="816eb-186">根據預設，運算式 [Sum] 會計算評估運算式時範圍內資料的總和。</span><span class="sxs-lookup"><span data-stu-id="816eb-186">By default, the expression [Sum] calculates the sum of data that is in scope at the time the expression is evaluated.</span></span> <span data-ttu-id="816eb-187">若是資料表資料格，範圍則視資料列和資料行群組成員資格而定。</span><span class="sxs-lookup"><span data-stu-id="816eb-187">For a table cell, the scope depends on row and column group memberships.</span></span> <span data-ttu-id="816eb-188">如需詳細資訊，請參閱 [總計、彙總與內建集合的運算式範圍 &#40;報表產生器及 SSRS&#41;](expression-scope-for-totals-aggregates-and-built-in-collections.md)。</span><span class="sxs-lookup"><span data-stu-id="816eb-188">For more information, see [Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;](expression-scope-for-totals-aggregates-and-built-in-collections.md).</span></span>  

-   <span data-ttu-id="816eb-189">若是 Font 屬性的值，此值必須評估為字型的名稱。</span><span class="sxs-lookup"><span data-stu-id="816eb-189">For the value for a Font property, the value must evaluate to the name of a font.</span></span>  

-   <span data-ttu-id="816eb-190">運算式語法是在設計階段進行驗證。</span><span class="sxs-lookup"><span data-stu-id="816eb-190">Expression syntax is validated at design time.</span></span> <span data-ttu-id="816eb-191">當您發行報表時，便會驗證運算式範圍。</span><span class="sxs-lookup"><span data-stu-id="816eb-191">Expression scope validation occurs when you publish the report.</span></span> <span data-ttu-id="816eb-192">若是與實際資料相關的驗證，則只能在執行階段偵測錯誤。</span><span class="sxs-lookup"><span data-stu-id="816eb-192">For validation that depends on the actual data, errors can only be detected at run-time.</span></span> <span data-ttu-id="816eb-193">其中部分運算式在轉譯的報表中會產生 #Error 做為錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="816eb-193">Some of these expressions produce #Error as an error message in the rendered report.</span></span> <span data-ttu-id="816eb-194">為協助判斷此種錯誤的相關問題，您必須使用 [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)]中的報表設計師。</span><span class="sxs-lookup"><span data-stu-id="816eb-194">To help determine the issues for this kind of error, you must use Report Designer in [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="816eb-195">報表設計師提供的 [輸出] 視窗可提供有關這些錯誤的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="816eb-195">Report Designer provides an Output window that provides more information about these errors.</span></span>  

<span data-ttu-id="816eb-196">如需詳細資訊，請參閱 [運算式參考 &#40;報表產生器及 SSRS&#41;](expression-reference-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="816eb-196">For more information, see [Expression Reference &#40;Report Builder and SSRS&#41;](expression-reference-report-builder-and-ssrs.md).</span></span>  

## <a name="in-this-section"></a><a name="Section"></a> <span data-ttu-id="816eb-197">本節內容</span><span class="sxs-lookup"><span data-stu-id="816eb-197">In This Section</span></span>

[<span data-ttu-id="816eb-198">加入運算式 &#40;報表產生器及 SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="816eb-198">Add an Expression &#40;Report Builder and SSRS&#41;</span></span>](add-an-expression-report-builder-and-ssrs.md)  

[<span data-ttu-id="816eb-199">報表中的運算式用法 &#40;報表產生器及 SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="816eb-199">Expression Uses in Reports &#40;Report Builder and SSRS&#41;</span></span>](expression-uses-in-reports-report-builder-and-ssrs.md)  

[<span data-ttu-id="816eb-200">總計、彙總與內建集合的運算式範圍 &#40;報表產生器及 SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="816eb-200">Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;</span></span>](expression-scope-for-totals-aggregates-and-built-in-collections.md)  

[<span data-ttu-id="816eb-201">運算式參考 &#40;報表產生器及 SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="816eb-201">Expression Reference &#40;Report Builder and SSRS&#41;</span></span>](expression-reference-report-builder-and-ssrs.md)  

## <a name="see-also"></a><span data-ttu-id="816eb-202">另請參閱</span><span class="sxs-lookup"><span data-stu-id="816eb-202">See Also</span></span>

- [<span data-ttu-id="816eb-203">運算式對話方塊</span><span class="sxs-lookup"><span data-stu-id="816eb-203">Expression Dialog Box</span></span>](../expression-dialog-box.md)   
- [<span data-ttu-id="816eb-204">運算式對話方塊 &#40;報表產生器&#41;</span><span class="sxs-lookup"><span data-stu-id="816eb-204">Expression Dialog Box &#40;Report Builder&#41;</span></span>](../expression-dialog-box-report-builder.md)