---
title: 運算式中的內建集合 (報表產生器及 SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 78d5e3b8-9320-4e4b-a025-e2de3cf7afa7
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 55ceebd69d98506bb461cf4fc55b4d395453b652
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87596507"
---
# <a name="built-in-collections-in-expressions-report-builder-and-ssrs"></a><span data-ttu-id="cbef1-102">運算式中的內建集合 (報表產生器及 SSRS)</span><span class="sxs-lookup"><span data-stu-id="cbef1-102">Built-in Collections in Expressions (Report Builder and SSRS)</span></span>
  <span data-ttu-id="cbef1-103">在報表的運算式中，您可以包含下列內建集合的參考：ReportItems、Parameters、Fields、DataSets、DataSources、Variables，以及類似報表名稱等全域資訊的內建欄位。</span><span class="sxs-lookup"><span data-stu-id="cbef1-103">In an expression in a report, you can include references to the following built-in collections: ReportItems, Parameters, Fields, DataSets, DataSources, Variables, and built-in fields for global information such as the report name.</span></span> <span data-ttu-id="cbef1-104">並不是所有的集合都會顯示在 **[運算式]** 對話方塊中。</span><span class="sxs-lookup"><span data-stu-id="cbef1-104">Not all collections appear in the **Expression** dialog box.</span></span> <span data-ttu-id="cbef1-105">只有報表伺服器上已發行的報表，才可以在執行階段使用 DataSets 和 DataSources 集合。</span><span class="sxs-lookup"><span data-stu-id="cbef1-105">The DataSets and DataSources collections are available only at run-time for published reports on a report server.</span></span> <span data-ttu-id="cbef1-106">ReportItems 集合是報表區域中的文字方塊集合，例如在頁面或頁首中的文字方塊。</span><span class="sxs-lookup"><span data-stu-id="cbef1-106">The ReportItems collection is collection of text boxes in a report region, for example, the text boxes on a page or in a page header.</span></span>  
  
 <span data-ttu-id="cbef1-107">如需詳細資訊，請參閱[運算式 &#40;報表產生器及 SSRS&#41;](expressions-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="cbef1-107">For more information, see [Expressions &#40;Report Builder and SSRS&#41;](expressions-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
##  <a name="understanding-built-in-collections"></a><a name="Collections"></a> <span data-ttu-id="cbef1-108">了解內建集合</span><span class="sxs-lookup"><span data-stu-id="cbef1-108">Understanding Built-in Collections</span></span>  
 <span data-ttu-id="cbef1-109">下表列出可在撰寫運算式時使用的內建集合。</span><span class="sxs-lookup"><span data-stu-id="cbef1-109">The following table lists the built-in collections available when you write an expression.</span></span> <span data-ttu-id="cbef1-110">每一列都包含該集合的區分大小寫程式設計名稱，以及您是否可以使用 [運算式] 對話方塊以互動的方式加入集合的參考、範例及描述 (包含初始化及提供集合值的時間)。</span><span class="sxs-lookup"><span data-stu-id="cbef1-110">Each row includes the case-sensitive programmatic name for the collection, whether you can use the Expression dialog box to interactively add a reference to the collection, an example, and a description that includes when the collection values are initialized and available for use.</span></span>  
  
|<span data-ttu-id="cbef1-111">內建集合</span><span class="sxs-lookup"><span data-stu-id="cbef1-111">Built-in Collection</span></span>|<span data-ttu-id="cbef1-112">[運算式] 對話方塊中的類別目錄</span><span class="sxs-lookup"><span data-stu-id="cbef1-112">Category in the Expression dialog box</span></span>|<span data-ttu-id="cbef1-113">範例</span><span class="sxs-lookup"><span data-stu-id="cbef1-113">Example</span></span>|<span data-ttu-id="cbef1-114">描述</span><span class="sxs-lookup"><span data-stu-id="cbef1-114">Description</span></span>|  
|--------------------------|-------------------------------------------|-------------|-----------------|  
|`Globals`|<span data-ttu-id="cbef1-115">內建欄位</span><span class="sxs-lookup"><span data-stu-id="cbef1-115">Built-in Fields</span></span>|`=Globals.ReportName`<br /><br /> `- or -`<br /><br /> `=Globals.PageNumber`|<span data-ttu-id="cbef1-116">代表對報表很有用的全域變數，例如：報表名稱或頁碼。</span><span class="sxs-lookup"><span data-stu-id="cbef1-116">Represents global variables useful for reports, such as the report name or page number.</span></span> <span data-ttu-id="cbef1-117">永遠可以使用。</span><span class="sxs-lookup"><span data-stu-id="cbef1-117">Always available.</span></span><br /><br /> <span data-ttu-id="cbef1-118">如需詳細資訊，請參閱[內建的全域和使用者參考 &#40;報表產生器及 SSRS&#41;](built-in-collections-built-in-globals-and-users-references-report-builder.md)。</span><span class="sxs-lookup"><span data-stu-id="cbef1-118">For more information, see [Built-in Globals and Users References &#40;Report Builder and SSRS&#41;](built-in-collections-built-in-globals-and-users-references-report-builder.md).</span></span>|  
|`User`|<span data-ttu-id="cbef1-119">內建欄位</span><span class="sxs-lookup"><span data-stu-id="cbef1-119">Built-in Fields</span></span>|`=User.UserID`<br /><br /> <span data-ttu-id="cbef1-120">- 或 -</span><span class="sxs-lookup"><span data-stu-id="cbef1-120">- or -</span></span><br /><br /> `=User.Language`|<span data-ttu-id="cbef1-121">代表有關執行報表之使用者的資料集合，例如，語言設定或使用者識別碼。</span><span class="sxs-lookup"><span data-stu-id="cbef1-121">Represents a collection of data about the user running the report, such as the language setting or the user ID.</span></span> <span data-ttu-id="cbef1-122">永遠可以使用。</span><span class="sxs-lookup"><span data-stu-id="cbef1-122">Always available.</span></span><br /><br /> <span data-ttu-id="cbef1-123">如需詳細資訊，請參閱[內建的全域和使用者參考 &#40;報表產生器及 SSRS&#41;](built-in-collections-built-in-globals-and-users-references-report-builder.md)。</span><span class="sxs-lookup"><span data-stu-id="cbef1-123">For more information, see [Built-in Globals and Users References &#40;Report Builder and SSRS&#41;](built-in-collections-built-in-globals-and-users-references-report-builder.md).</span></span>|  
|`Parameters`|<span data-ttu-id="cbef1-124">參數</span><span class="sxs-lookup"><span data-stu-id="cbef1-124">Parameters</span></span>|`=Parameters("ReportMonth").Value`<br /><br /> <span data-ttu-id="cbef1-125">- 或 -</span><span class="sxs-lookup"><span data-stu-id="cbef1-125">- or -</span></span><br /><br /> `=Parameters!ReportYear.Value`|<span data-ttu-id="cbef1-126">代表報表參數的集合，每個參數都可以是單一值或多重值。</span><span class="sxs-lookup"><span data-stu-id="cbef1-126">Represents the collection of report parameters, each of which can be single-value or multivalue.</span></span> <span data-ttu-id="cbef1-127">處理初始化完成後才可以使用。</span><span class="sxs-lookup"><span data-stu-id="cbef1-127">Not available until processing initialization is complete.</span></span> <span data-ttu-id="cbef1-128">如需詳細資訊，請參閱[參數集合參考 &#40;報表產生器及 SSRS&#41;](built-in-collections-parameters-collection-references-report-builder.md)。</span><span class="sxs-lookup"><span data-stu-id="cbef1-128">For more information, see [Parameters Collection References &#40;Report Builder and SSRS&#41;](built-in-collections-parameters-collection-references-report-builder.md).</span></span>|  
|<span data-ttu-id="cbef1-129">`Fields(` *\<Dataset>* `)`</span><span class="sxs-lookup"><span data-stu-id="cbef1-129">`Fields(` *\<Dataset>* `)`</span></span>|<span data-ttu-id="cbef1-130">欄位</span><span class="sxs-lookup"><span data-stu-id="cbef1-130">Fields</span></span>|`=Fields!Sales.Value`|<span data-ttu-id="cbef1-131">代表可供報表使用之資料集的欄位集合。</span><span class="sxs-lookup"><span data-stu-id="cbef1-131">Represents the collection of fields of the dataset that are available to the report.</span></span> <span data-ttu-id="cbef1-132">可在從資料來源將資料擷取至資料集之後使用。</span><span class="sxs-lookup"><span data-stu-id="cbef1-132">Available after data is retrieved from a data source into a dataset.</span></span> <span data-ttu-id="cbef1-133">如需詳細資訊，請參閱[資料集 Fields 集合參考 &#40;報表產生器及 SSRS&#41;](built-in-collections-dataset-fields-collection-references-report-builder.md)。</span><span class="sxs-lookup"><span data-stu-id="cbef1-133">For more information, see [Dataset Fields Collection References &#40;Report Builder and SSRS&#41;](built-in-collections-dataset-fields-collection-references-report-builder.md).</span></span>|  
|`DataSets`|<span data-ttu-id="cbef1-134">不顯示</span><span class="sxs-lookup"><span data-stu-id="cbef1-134">Not Displayed</span></span>|`=DataSets("TopEmployees").CommandText`|<span data-ttu-id="cbef1-135">代表從報表定義的主體所參考的資料集集合。</span><span class="sxs-lookup"><span data-stu-id="cbef1-135">Represents the collection of datasets referenced from the body of a report definition.</span></span> <span data-ttu-id="cbef1-136">不包含只用於頁首或頁尾的資料來源。</span><span class="sxs-lookup"><span data-stu-id="cbef1-136">Does not include data sources used only in page headers or page footers.</span></span> <span data-ttu-id="cbef1-137">不適用於本機預覽。</span><span class="sxs-lookup"><span data-stu-id="cbef1-137">Not available in local preview.</span></span> <span data-ttu-id="cbef1-138">如需詳細資訊，請參閱 [DataSources 和 DataSets 集合參考 &#40;報表產生器及 SSRS&#41;](built-in-collections-datasources-and-datasets-references-report-builder.md)。</span><span class="sxs-lookup"><span data-stu-id="cbef1-138">For more information, see [DataSources and DataSets Collection References &#40;Report Builder and SSRS&#41;](built-in-collections-datasources-and-datasets-references-report-builder.md).</span></span>|  
|`DataSources`|<span data-ttu-id="cbef1-139">不顯示</span><span class="sxs-lookup"><span data-stu-id="cbef1-139">Not Displayed</span></span>|`=DataSources("AdventureWorks2012").Type`|<span data-ttu-id="cbef1-140">代表從報表主體內所參考的資料來源集合。</span><span class="sxs-lookup"><span data-stu-id="cbef1-140">Represents the collection of data sources referenced from within the body of a report.</span></span> <span data-ttu-id="cbef1-141">不包含只用於頁首或頁尾的資料來源。</span><span class="sxs-lookup"><span data-stu-id="cbef1-141">Does not include data sources used only in page headers or page footers.</span></span> <span data-ttu-id="cbef1-142">不適用於本機預覽。</span><span class="sxs-lookup"><span data-stu-id="cbef1-142">Not available in local preview.</span></span> <span data-ttu-id="cbef1-143">如需詳細資訊，請參閱 [DataSources 和 DataSets 集合參考 &#40;報表產生器及 SSRS&#41;](built-in-collections-datasources-and-datasets-references-report-builder.md)。</span><span class="sxs-lookup"><span data-stu-id="cbef1-143">For more information, see [DataSources and DataSets Collection References &#40;Report Builder and SSRS&#41;](built-in-collections-datasources-and-datasets-references-report-builder.md).</span></span>|  
|`Variables`|`Variables`|`=Variables!CustomTimeStamp.Value`|<span data-ttu-id="cbef1-144">代表報表變數和群組變數的集合。</span><span class="sxs-lookup"><span data-stu-id="cbef1-144">Represents the collection of report variables and group variables.</span></span> <span data-ttu-id="cbef1-145">如需詳細資訊，請參閱[報表和群組變數集合參考 &#40;報表產生器及 SSRS&#41;](built-in-collections-report-and-group-variables-references-report-builder.md)。</span><span class="sxs-lookup"><span data-stu-id="cbef1-145">For more information, see [Report and Group Variables Collections References &#40;Report Builder and SSRS&#41;](built-in-collections-report-and-group-variables-references-report-builder.md).</span></span>|  
|`ReportItems`|<span data-ttu-id="cbef1-146">不顯示</span><span class="sxs-lookup"><span data-stu-id="cbef1-146">Not Displayed</span></span>|`=ReportItems("Textbox1").Value`|<span data-ttu-id="cbef1-147">代表報表項目的文字方塊集合。</span><span class="sxs-lookup"><span data-stu-id="cbef1-147">Represents the collection of text boxes for a report item.</span></span> <span data-ttu-id="cbef1-148">這個集合可以用來摘要頁面上的項目，以包含在頁首或頁尾中。</span><span class="sxs-lookup"><span data-stu-id="cbef1-148">This collection can be used to summarize items on the page for including in a page header or page footer.</span></span> <span data-ttu-id="cbef1-149">如需詳細資訊，請參閱 [ReportItems 集合參考 &#40;報表產生器及 SSRS&#41;](built-in-collections-reportitems-collection-references-report-builder.md)。</span><span class="sxs-lookup"><span data-stu-id="cbef1-149">For more information, see [ReportItems Collection References &#40;Report Builder and SSRS&#41;](built-in-collections-reportitems-collection-references-report-builder.md).</span></span>|  
  
##  <a name="using-collection-syntax-in-an-expression"></a><a name="Syntax"></a> <span data-ttu-id="cbef1-150">在運算式中使用集合語法</span><span class="sxs-lookup"><span data-stu-id="cbef1-150">Using Collection Syntax in an Expression</span></span>  
 <span data-ttu-id="cbef1-151">若要從運算式參考集合，請 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] 針對集合中的專案使用標準語法。</span><span class="sxs-lookup"><span data-stu-id="cbef1-151">To refer to a collection from an expression, use standard [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] syntax for an item in a collection.</span></span> <span data-ttu-id="cbef1-152">下表顯示集合語法的範例。</span><span class="sxs-lookup"><span data-stu-id="cbef1-152">The following table shows examples of collection syntax.</span></span>  
  
|<span data-ttu-id="cbef1-153">語法</span><span class="sxs-lookup"><span data-stu-id="cbef1-153">Syntax</span></span>|<span data-ttu-id="cbef1-154">範例</span><span class="sxs-lookup"><span data-stu-id="cbef1-154">Example</span></span>|  
|------------|-------------|  
|<span data-ttu-id="cbef1-155">*集合!ObjectName. Property*</span><span class="sxs-lookup"><span data-stu-id="cbef1-155">*Collection!ObjectName.Property*</span></span>|`=Fields!Sales.Value`|  
|<span data-ttu-id="cbef1-156">\*集合!ObjectName ( "Property" ) \*</span><span class="sxs-lookup"><span data-stu-id="cbef1-156">*Collection!ObjectName("Property")*</span></span>|`=Fields!Sales("Value")`|  
|<span data-ttu-id="cbef1-157">*Collection("物件名稱").Property*</span><span class="sxs-lookup"><span data-stu-id="cbef1-157">*Collection("ObjectName").Property*</span></span>|`=Fields("Sales").Value`|  
|<span data-ttu-id="cbef1-158">*Collection("成員")*</span><span class="sxs-lookup"><span data-stu-id="cbef1-158">*Collection("Member")*</span></span>|`=User("Language")`|  
|<span data-ttu-id="cbef1-159">*集合。成員*</span><span class="sxs-lookup"><span data-stu-id="cbef1-159">*Collection.Member*</span></span>|`=User.Language`|  
  
## <a name="see-also"></a><span data-ttu-id="cbef1-160">另請參閱</span><span class="sxs-lookup"><span data-stu-id="cbef1-160">See Also</span></span>  
 <span data-ttu-id="cbef1-161">[&#40;報表產生器和 SSRS 新增運算式&#41;](add-an-expression-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="cbef1-161">[Add an Expression &#40;Report Builder and SSRS&#41;](add-an-expression-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="cbef1-162">運算式範例 &#40;報表產生器及 SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="cbef1-162">Expression Examples &#40;Report Builder and SSRS&#41;</span></span>](expression-examples-report-builder-and-ssrs.md)  
  
  
