---
title: 內嵌和共用資料集 (報表產生器及 SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: adc95cc0-d15a-413d-bc5a-302eab37a069
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 21b6136433d3fca56f3a98825e3d0ab9c0cf42e8
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87710245"
---
# <a name="embedded-and-shared-datasets-report-builder-and-ssrs"></a><span data-ttu-id="bf427-102">內嵌和共用資料集 (報表產生器及 SSRS)</span><span class="sxs-lookup"><span data-stu-id="bf427-102">Embedded and Shared Datasets (Report Builder and SSRS)</span></span>
  <span data-ttu-id="bf427-103">在報表中，資料集代表在外部資料來源上執行查詢時所傳回的報表資料。</span><span class="sxs-lookup"><span data-stu-id="bf427-103">In a report, a dataset represents report data that is returned from running a query on an external data source.</span></span> <span data-ttu-id="bf427-104">資料集取決於包含外部資料來源之相關資訊的資料連接。</span><span class="sxs-lookup"><span data-stu-id="bf427-104">The dataset depends on the data connection that contains information about the external data source.</span></span> <span data-ttu-id="bf427-105">資料本身不會包含在報表定義中。</span><span class="sxs-lookup"><span data-stu-id="bf427-105">The data itself is not included in the report definition.</span></span> <span data-ttu-id="bf427-106">資料集包含查詢命令、欄位集合、參數、篩選，以及包含區分大小寫和定序的資料選項。</span><span class="sxs-lookup"><span data-stu-id="bf427-106">The dataset contains a query command, a field collection, parameters, filters, and data options that include case sensitivity and collation.</span></span> <span data-ttu-id="bf427-107">資料集有以下兩種不同的類型：</span><span class="sxs-lookup"><span data-stu-id="bf427-107">There are two types of datasets:</span></span>  
  
-   <span data-ttu-id="bf427-108">**共用資料集。**</span><span class="sxs-lookup"><span data-stu-id="bf427-108">**Shared datasets.**</span></span> <span data-ttu-id="bf427-109">共用資料集是在報表伺服器上發行，可供多個報表使用。</span><span class="sxs-lookup"><span data-stu-id="bf427-109">A shared dataset is published on a report server and can be used by multiple reports.</span></span> <span data-ttu-id="bf427-110">共用資料集必須以共用資料來源為基礎。</span><span class="sxs-lookup"><span data-stu-id="bf427-110">A shared dataset must be based on a shared data source.</span></span> <span data-ttu-id="bf427-111">共用資料集可透過建立快取重新整理計劃的方式快取和排程。</span><span class="sxs-lookup"><span data-stu-id="bf427-111">A shared dataset can be cached and scheduled by creating a cache refresh plan.</span></span>  
  
-   <span data-ttu-id="bf427-112">**內嵌資料集。**</span><span class="sxs-lookup"><span data-stu-id="bf427-112">**Embedded datasets.**</span></span> <span data-ttu-id="bf427-113">內嵌資料集是在單一報表中定義，只供單一報表使用。</span><span class="sxs-lookup"><span data-stu-id="bf427-113">Embedded datasets are defined in and used by a single report.</span></span>  
  
 <span data-ttu-id="bf427-114">這兩種資料集之間的差異在於建立、儲存和管理的方式。</span><span class="sxs-lookup"><span data-stu-id="bf427-114">The difference between the two is in how they are created, stored, and managed.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="shared-datasets"></a><span data-ttu-id="bf427-115">共用資料集</span><span class="sxs-lookup"><span data-stu-id="bf427-115">Shared Datasets</span></span>  
 <span data-ttu-id="bf427-116">您可以使用共用資料集來提供多個報表能夠使用的查詢。</span><span class="sxs-lookup"><span data-stu-id="bf427-116">Use a shared dataset to provide a query that can be used by more than one report.</span></span> <span data-ttu-id="bf427-117">共用資料集會儲存在報表伺服器上，並且與報表或共用資料來源分開管理。</span><span class="sxs-lookup"><span data-stu-id="bf427-117">Shared datasets are stored on the report server and managed separately from reports or shared data sources.</span></span> <span data-ttu-id="bf427-118">例如，報表伺服器管理員可能會更新查詢以利用改善的索引或其他最佳化查詢效能的方法。</span><span class="sxs-lookup"><span data-stu-id="bf427-118">For example, a report server administrator might update the query to take advantage of improved indexing or other query performance optimization.</span></span>  
  
 <span data-ttu-id="bf427-119">建議您盡量使用共用資料集。</span><span class="sxs-lookup"><span data-stu-id="bf427-119">We recommend that you use shared datasets as much as possible.</span></span> <span data-ttu-id="bf427-120">您可以最佳化查詢或快取查詢結果，以獲得更佳的報表效能。</span><span class="sxs-lookup"><span data-stu-id="bf427-120">You can optimize a query or cache query results to benefit report performance.</span></span> <span data-ttu-id="bf427-121">共用資料集可讓資料存取的管理更輕鬆，並且有助於提升報表和報表所存取資料集的安全性，以及提高效能。</span><span class="sxs-lookup"><span data-stu-id="bf427-121">Shared datasets make data access easier to manage, and help to keep reports and the datasets they access more secure and more performant.</span></span>  
  
 <span data-ttu-id="bf427-122">在報表設計師中，您可以建立共用資料集做為報表專案的一部分，以及控制是否要將它們部署至報表伺服器。</span><span class="sxs-lookup"><span data-stu-id="bf427-122">In Report Designer, you can create shared datasets as part of a report project, and control whether to deploy them to a report server.</span></span> <span data-ttu-id="bf427-123">但是，您無法瀏覽至報表伺服器，然後選取要加入至報表的共用資料集。</span><span class="sxs-lookup"><span data-stu-id="bf427-123">You cannot browse to a report server and select a shared dataset to add to your report.</span></span>  
  
 <span data-ttu-id="bf427-124">在報表產生器中，您可以執行下列作業：</span><span class="sxs-lookup"><span data-stu-id="bf427-124">In Report Builder, you can do the following:</span></span>  
  
1.  <span data-ttu-id="bf427-125">若要建立共用資料集，請使用共用資料集設計檢視。</span><span class="sxs-lookup"><span data-stu-id="bf427-125">To create a shared dataset, use Shared Dataset Design View.</span></span> <span data-ttu-id="bf427-126">您可以將它儲存至報表伺服器或 SharePoint 網站，以便與其他報表共用。</span><span class="sxs-lookup"><span data-stu-id="bf427-126">You can save it to a report server or SharePoint site to share with other reports.</span></span> <span data-ttu-id="bf427-127">您也可以瀏覽至報表伺服器，然後編輯現有的共用資料集。</span><span class="sxs-lookup"><span data-stu-id="bf427-127">You can also browse to the report server and edit and existing shared dataset.</span></span> <span data-ttu-id="bf427-128">在此檢視中，您可以建立查詢並設定所有資料集選項。</span><span class="sxs-lookup"><span data-stu-id="bf427-128">In this view, you can build a query and set all dataset options.</span></span> <span data-ttu-id="bf427-129">如需詳細資訊，請參閱[共用資料集設計檢視 &#40;報表產生器&#41;](../report-builder/shared-dataset-design-view-report-builder.md)。</span><span class="sxs-lookup"><span data-stu-id="bf427-129">For more information, see [Shared Dataset Design View &#40;Report Builder&#41;](../report-builder/shared-dataset-design-view-report-builder.md).</span></span>  
  
2.  <span data-ttu-id="bf427-130">若要將共用資料集加入至報表，請在 [報表設計檢視] 中開啟報表產生器。</span><span class="sxs-lookup"><span data-stu-id="bf427-130">To add a shared dataset to your report, open Report Builder in Report Design View.</span></span> <span data-ttu-id="bf427-131">從精靈或 [報表資料] 窗格中，瀏覽到報表伺服器，並選取您要加入至報表的共用資料集。</span><span class="sxs-lookup"><span data-stu-id="bf427-131">From a wizard or from the Report Data pane, browse to the report server and select the shared dataset to add to your report.</span></span> <span data-ttu-id="bf427-132">在此檢視中，除非加入欄位，否則您無法變更查詢。</span><span class="sxs-lookup"><span data-stu-id="bf427-132">In this view, you cannot change the query except to add fields.</span></span> <span data-ttu-id="bf427-133">您可以覆寫其他資料選項和加入篩選。</span><span class="sxs-lookup"><span data-stu-id="bf427-133">You can override other data options and add filters.</span></span> <span data-ttu-id="bf427-134">不過不能移除篩選。</span><span class="sxs-lookup"><span data-stu-id="bf427-134">You cannot remove filters.</span></span>  
  
3.  <span data-ttu-id="bf427-135">下表比較可在報表伺服器上針對共用資料集的定義設定的屬性，以及針對報表定義中共用資料集的執行個體設定的屬性。</span><span class="sxs-lookup"><span data-stu-id="bf427-135">The following table compares the properties that can be configured for the definition of the shared dataset on the report server and the instance of the shared dataset in the report definition.</span></span>  
  
    |<span data-ttu-id="bf427-136">屬性</span><span class="sxs-lookup"><span data-stu-id="bf427-136">Property</span></span>|<span data-ttu-id="bf427-137">定義的設定注意事項</span><span class="sxs-lookup"><span data-stu-id="bf427-137">Configuration Notes for the Definition</span></span>|<span data-ttu-id="bf427-138">執行個體的設定注意事項</span><span class="sxs-lookup"><span data-stu-id="bf427-138">Configuration Notes for the Instance</span></span>|  
    |--------------|--------------------------------------------|------------------------------------------|  
    |<span data-ttu-id="bf427-139">查詢文字</span><span class="sxs-lookup"><span data-stu-id="bf427-139">Query text</span></span>|<span data-ttu-id="bf427-140">設定查詢，包括將它定義為運算式。</span><span class="sxs-lookup"><span data-stu-id="bf427-140">Configure the query, including defining it as expression.</span></span>|<span data-ttu-id="bf427-141">無法變更查詢。</span><span class="sxs-lookup"><span data-stu-id="bf427-141">Cannot change the query.</span></span>|  
    |<span data-ttu-id="bf427-142">查詢參數</span><span class="sxs-lookup"><span data-stu-id="bf427-142">Query parameters</span></span>|<span data-ttu-id="bf427-143">無法參考報表參數</span><span class="sxs-lookup"><span data-stu-id="bf427-143">Cannot reference report parameters</span></span><br /><br /> <span data-ttu-id="bf427-144">包含預設值</span><span class="sxs-lookup"><span data-stu-id="bf427-144">Includes default values</span></span><br /><br /> <span data-ttu-id="bf427-145">包含唯讀旗標</span><span class="sxs-lookup"><span data-stu-id="bf427-145">Includes a Read Only flag</span></span>|<span data-ttu-id="bf427-146">設定未在定義中標記為唯讀的參數</span><span class="sxs-lookup"><span data-stu-id="bf427-146">Configure parameters that are not marked Read Only in the definition</span></span>|  
    |<span data-ttu-id="bf427-147">篩選器</span><span class="sxs-lookup"><span data-stu-id="bf427-147">Filters</span></span>|<span data-ttu-id="bf427-148">定義篩選條件</span><span class="sxs-lookup"><span data-stu-id="bf427-148">Define filters</span></span>|<span data-ttu-id="bf427-149">無法檢視或變更屬於定義之一部分的資料集篩選</span><span class="sxs-lookup"><span data-stu-id="bf427-149">Cannot view or change dataset filters that are part of the definition</span></span><br /><br /> <span data-ttu-id="bf427-150">可以建立其他篩選</span><span class="sxs-lookup"><span data-stu-id="bf427-150">Can create additional filters</span></span>|  
    |<span data-ttu-id="bf427-151">資料來源</span><span class="sxs-lookup"><span data-stu-id="bf427-151">Data Source</span></span>|<span data-ttu-id="bf427-152">必須為共用資料來源</span><span class="sxs-lookup"><span data-stu-id="bf427-152">Must be a shared data source</span></span>|<span data-ttu-id="bf427-153">無法變更資料來源</span><span class="sxs-lookup"><span data-stu-id="bf427-153">Cannot change the data source</span></span>|  
    |<span data-ttu-id="bf427-154">欄位</span><span class="sxs-lookup"><span data-stu-id="bf427-154">Fields</span></span>|<span data-ttu-id="bf427-155">來自查詢命令的欄位</span><span class="sxs-lookup"><span data-stu-id="bf427-155">Fields from the query command</span></span><br /><br /> <span data-ttu-id="bf427-156">導出欄位不屬於資料集定義的一部分</span><span class="sxs-lookup"><span data-stu-id="bf427-156">Calculated fields are not part of the dataset definition</span></span>|<span data-ttu-id="bf427-157">檢視欄位，但是無法變更欄位</span><span class="sxs-lookup"><span data-stu-id="bf427-157">View fields, but cannot change them</span></span><br /><br /> <span data-ttu-id="bf427-158">根據您將共用資料集加入至報表時的查詢，欄位集合是靜態的。</span><span class="sxs-lookup"><span data-stu-id="bf427-158">The field collection is static based on the query at the time you added the shared dataset to the report.</span></span> <span data-ttu-id="bf427-159">若要更新，請按一下 **[資料集屬性]** 對話方塊中的 **[重新整理欄位]** 。</span><span class="sxs-lookup"><span data-stu-id="bf427-159">To update, click **Refresh Fields** in the **Dataset Properties** dialog box.</span></span> <span data-ttu-id="bf427-160">實際的欄位集合是定義中目前的查詢所傳回的任何內容。</span><span class="sxs-lookup"><span data-stu-id="bf427-160">The actual field collection is whatever the current query in the definition returns.</span></span><br /><br /> <span data-ttu-id="bf427-161">加入導出欄位</span><span class="sxs-lookup"><span data-stu-id="bf427-161">Add calculated fields</span></span>|  
    |<span data-ttu-id="bf427-162">資料集</span><span class="sxs-lookup"><span data-stu-id="bf427-162">Dataset</span></span>|<span data-ttu-id="bf427-163">資料選項，例如區分大小寫</span><span class="sxs-lookup"><span data-stu-id="bf427-163">Data options such as case sensitivity</span></span>|<span data-ttu-id="bf427-164">覆寫執行個體中的資料選項</span><span class="sxs-lookup"><span data-stu-id="bf427-164">Override data options in the instance</span></span>|  
  
## <a name="embedded-datasets"></a><span data-ttu-id="bf427-165">內嵌資料集</span><span class="sxs-lookup"><span data-stu-id="bf427-165">Embedded Datasets</span></span>  
 <span data-ttu-id="bf427-166">如果您要從外部資料來源取得資料，並且僅用於一個報表中，則使用內嵌資料集。</span><span class="sxs-lookup"><span data-stu-id="bf427-166">Use an embedded dataset when you want to get data from an external data source to be used only in one report.</span></span> <span data-ttu-id="bf427-167">當您想要建立的查詢沒有其他相依性而且不需要用於多個報表時，內嵌資料集將會很實用。</span><span class="sxs-lookup"><span data-stu-id="bf427-167">Embedded datasets are useful when you want to create a query that has no other dependencies and that you do not need to use for multiple reports.</span></span>  
  
 <span data-ttu-id="bf427-168">若要建立或編輯內嵌資料集，請使用 [報表資料] 窗格。</span><span class="sxs-lookup"><span data-stu-id="bf427-168">To create or edit an embedded dataset, use the Report Data pane.</span></span> <span data-ttu-id="bf427-169">建立資料集之後，您可以在 **[資料集屬性]** 對話方塊中設定屬性。</span><span class="sxs-lookup"><span data-stu-id="bf427-169">After you create a dataset, you can configure the properties in the **Dataset Properties** dialog box.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bf427-170">另請參閱</span><span class="sxs-lookup"><span data-stu-id="bf427-170">See Also</span></span>  
 <span data-ttu-id="bf427-171">[內嵌和共用資料連線或資料來源 &#40;報表產生器和 SSRS&#41;](../embedded-and-shared-data-connections-or-data-sources-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="bf427-171">[Embedded and Shared Data Connections or Data Sources &#40;Report Builder and SSRS&#41;](../embedded-and-shared-data-connections-or-data-sources-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="bf427-172">[建立共用資料集或內嵌資料集 &#40;報表產生器和 SSRS&#41;](create-a-shared-dataset-or-embedded-dataset-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="bf427-172">[Create a Shared Dataset or Embedded Dataset &#40;Report Builder and SSRS&#41;](create-a-shared-dataset-or-embedded-dataset-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="bf427-173">[將資料加入報表 &#40;報表產生器和 SSRS&#41;](report-datasets-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="bf427-173">[Add Data to a Report &#40;Report Builder and SSRS&#41;](report-datasets-ssrs.md) </span></span>  
 <span data-ttu-id="bf427-174">[資料集欄位集合 &#40;報表產生器及 SSRS&#41;](dataset-fields-collection-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="bf427-174">[Dataset Fields Collection &#40;Report Builder and SSRS&#41;](dataset-fields-collection-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="bf427-175">[報表產生器中的資料連線、資料來源及連接字串](../data-connections-data-sources-and-connection-strings-in-report-builder.md) </span><span class="sxs-lookup"><span data-stu-id="bf427-175">[Data Connections, Data Sources, and Connection Strings in Report Builder](../data-connections-data-sources-and-connection-strings-in-report-builder.md) </span></span>  
 [<span data-ttu-id="bf427-176">Data Connections, Data Sources, and Connection Strings in Reporting Services</span><span class="sxs-lookup"><span data-stu-id="bf427-176">Data Connections, Data Sources, and Connection Strings in Reporting Services</span></span>](../data-connections-data-sources-and-connection-strings-in-reporting-services.md)  
  
  
