---
title: 圖形化查詢設計工具使用者介面 | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
f1_keywords:
- "10012"
- sql12.rtp.rptdesigner.dataview.vdtquerydesigner.f1
helpviewer_keywords:
- graphical query designer [Reporting Services]
- data sources [Reporting Services], creating
- text-based query designer [Reporting Services]
- query designers [Reporting Services]
- Reporting Services, query designers
ms.assetid: 5022ae33-03a3-48de-8ac1-82742f48cebe
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 12cc3cdc2a5a36ebcadd01f61c6a04ea66b0e4f4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87593812"
---
# <a name="graphical-query-designer-user-interface"></a><span data-ttu-id="56de4-102">圖形化查詢設計工具使用者介面</span><span class="sxs-lookup"><span data-stu-id="56de4-102">Graphical Query Designer User Interface</span></span>
  [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] <span data-ttu-id="56de4-103">同時提供了圖形化查詢設計工具以及以文字為基礎的查詢設計工具來建立查詢，以便從關聯式資料庫中擷取資料作為報表設計師中的報表資料集。</span><span class="sxs-lookup"><span data-stu-id="56de4-103">provides both a graphical query designer and a text-based query designer for creating queries to retrieve data from a relational database for a report dataset in Report Designer.</span></span> <span data-ttu-id="56de4-104">使用圖形化查詢設計工具，可透過互動方式建立查詢及檢視 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]、Oracle、OLE DB 和 ODBC 資料來源類型的結果。</span><span class="sxs-lookup"><span data-stu-id="56de4-104">Use the graphical query designer to interactively build a query and view the results for data source types [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], Oracle, OLE DB, and ODBC.</span></span> <span data-ttu-id="56de4-105">使用以文字為基礎的查詢設計工具，可指定多個 [!INCLUDE[tsql](../../../includes/tsql-md.md)] 陳述式、複雜查詢或命令語法以及以運算式為基礎的查詢。</span><span class="sxs-lookup"><span data-stu-id="56de4-105">Use the text-based query designer to specify multiple [!INCLUDE[tsql](../../../includes/tsql-md.md)] statements, complex query or command syntax, and expression-based queries.</span></span> <span data-ttu-id="56de4-106">如需詳細資訊，請參閱 [以文字為基礎的查詢設計工具使用者介面](../text-based-query-designer-user-interface.md)。</span><span class="sxs-lookup"><span data-stu-id="56de4-106">For more information, see [Text-based Query Designer User Interface](../text-based-query-designer-user-interface.md).</span></span> <span data-ttu-id="56de4-107">如需有關使用特定資料來源類型的詳細資訊，請參閱[將資料加入報表 &#40;報表產生器和 SSRS&#41;](report-datasets-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="56de4-107">For more information about working with specific data source types, see [Add Data to a Report &#40;Report Builder and SSRS&#41;](report-datasets-ssrs.md).</span></span>

 <span data-ttu-id="56de4-108">。</span><span class="sxs-lookup"><span data-stu-id="56de4-108">.</span></span>

## <a name="graphical-query-designer"></a><span data-ttu-id="56de4-109">圖形化查詢設計工具</span><span class="sxs-lookup"><span data-stu-id="56de4-109">Graphical Query Designer</span></span>
 <span data-ttu-id="56de4-110">此圖形化查詢設計工具支援三種查詢命令：**Text**、**StoredProcedure** 或 **TableDirect**。</span><span class="sxs-lookup"><span data-stu-id="56de4-110">This graphical query designer supports three types of query commands: **Text**, **StoredProcedure**, or **TableDirect**.</span></span> <span data-ttu-id="56de4-111">在您為資料集建立查詢之前，您必須先在 [ [資料集屬性](../dataset-properties-dialog-box-query.md) ] 對話方塊的 [查詢] 頁面上選取命令類型選項。</span><span class="sxs-lookup"><span data-stu-id="56de4-111">Before you create a query for your dataset, you must select a command type option on the Query page of the [Dataset Properties](../dataset-properties-dialog-box-query.md) dialog box.</span></span>

 <span data-ttu-id="56de4-112">下列選項可用於查詢類型：</span><span class="sxs-lookup"><span data-stu-id="56de4-112">The following options are available for query type:</span></span>

-   <span data-ttu-id="56de4-113">**Text** 可支援關聯式資料庫資料來源的標準 [!INCLUDE[tsql](../../../includes/tsql-md.md)] 查詢文字，包括 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 和 Oracle 的資料處理延伸模組。</span><span class="sxs-lookup"><span data-stu-id="56de4-113">**Text** Supports standard [!INCLUDE[tsql](../../../includes/tsql-md.md)] query text for relational database data sources, including data processing extensions for [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and Oracle.</span></span>

-   <span data-ttu-id="56de4-114">**TableDirect** ：從指定的資料表中選取所有資料行。</span><span class="sxs-lookup"><span data-stu-id="56de4-114">**TableDirect** Selects all the columns from the specified table.</span></span> <span data-ttu-id="56de4-115">例如，如果是名為 Customers 的資料表，這就等於 [!INCLUDE[tsql](../../../includes/tsql-md.md)] 陳述式 `SELECT * FROM Customers`。</span><span class="sxs-lookup"><span data-stu-id="56de4-115">For example, for a table named Customers, this is the equivalent of the [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement `SELECT * FROM Customers`.</span></span>

-   <span data-ttu-id="56de4-116">**StoredProcedure** ：可支援資料來源上預存程序的呼叫。</span><span class="sxs-lookup"><span data-stu-id="56de4-116">**StoredProcedure** Supports calls to stored procedures on the data source.</span></span> <span data-ttu-id="56de4-117">若要使用這個選項，您必須已經獲得資料來源的資料庫管理員授與對預存程序的 Execute 權限。</span><span class="sxs-lookup"><span data-stu-id="56de4-117">To use this option, you must have been granted Execute permissions on the stored procedure by the database administrator on the data source.</span></span>

 <span data-ttu-id="56de4-118">預設的命令類型為 **Text**。</span><span class="sxs-lookup"><span data-stu-id="56de4-118">The default command type is **Text**.</span></span>

> [!NOTE]
>  <span data-ttu-id="56de4-119">並不是所有資料處理延伸模組都支援所有的類型。</span><span class="sxs-lookup"><span data-stu-id="56de4-119">Not all data processing extensions support all types.</span></span> <span data-ttu-id="56de4-120">基礎資料提供者必須支援某種命令類型，才能使用此選項。</span><span class="sxs-lookup"><span data-stu-id="56de4-120">The underlying data provider must support a command type before the option is available.</span></span>

### <a name="command-type-text"></a><span data-ttu-id="56de4-121">Text 命令類型</span><span class="sxs-lookup"><span data-stu-id="56de4-121">Command Type Text</span></span>
 <span data-ttu-id="56de4-122">在 **Text** 類型中，圖形化查詢設計工具提供了四個區域，或稱窗格。</span><span class="sxs-lookup"><span data-stu-id="56de4-122">In **Text** type, the graphical query designer presents four areas, or panes.</span></span> <span data-ttu-id="56de4-123">您可以指定 [!INCLUDE[tsql](../../../includes/tsql-md.md)] 查詢的資料行、別名、排序值和篩選值。</span><span class="sxs-lookup"><span data-stu-id="56de4-123">You can specify columns, aliases, sort values, and filter values for a [!INCLUDE[tsql](../../../includes/tsql-md.md)] query.</span></span> <span data-ttu-id="56de4-124">您也可以檢視依據選取項目所產生的查詢文字、執行查詢，以及檢視結果集。</span><span class="sxs-lookup"><span data-stu-id="56de4-124">You can view the query text generated from your selections, run the query, and view the result set.</span></span> <span data-ttu-id="56de4-125">下圖顯示了這四個窗格。</span><span class="sxs-lookup"><span data-stu-id="56de4-125">The following figure shows the four panes.</span></span>

 <span data-ttu-id="56de4-126">![適用於 SQL 查詢的圖形化查詢設計工具](../media/rsqd-dsaw-sql.gif "SQL 查詢適用的圖形化查詢設計工具")</span><span class="sxs-lookup"><span data-stu-id="56de4-126">![Graphical query designer for sql query](../media/rsqd-dsaw-sql.gif "Graphical query designer for sql query")</span></span>

 <span data-ttu-id="56de4-127">下表會描述各個窗格的功能。</span><span class="sxs-lookup"><span data-stu-id="56de4-127">The following table describes the function of each pane.</span></span>

|<span data-ttu-id="56de4-128">窗格</span><span class="sxs-lookup"><span data-stu-id="56de4-128">Pane</span></span>|<span data-ttu-id="56de4-129">函式</span><span class="sxs-lookup"><span data-stu-id="56de4-129">Function</span></span>|
|----------|--------------|
|<span data-ttu-id="56de4-130">圖表</span><span class="sxs-lookup"><span data-stu-id="56de4-130">Diagram</span></span>|<span data-ttu-id="56de4-131">顯示查詢中之資料表的圖形表示。</span><span class="sxs-lookup"><span data-stu-id="56de4-131">Displays graphic representations of the tables in the query.</span></span> <span data-ttu-id="56de4-132">使用此窗格，即可選取欄位並定義資料表之間的關聯性。</span><span class="sxs-lookup"><span data-stu-id="56de4-132">Use this pane to select fields and define relationships between tables.</span></span>|
|<span data-ttu-id="56de4-133">方格</span><span class="sxs-lookup"><span data-stu-id="56de4-133">Grid</span></span>|<span data-ttu-id="56de4-134">顯示查詢傳回的欄位清單。</span><span class="sxs-lookup"><span data-stu-id="56de4-134">Displays a list of fields returned by the query.</span></span> <span data-ttu-id="56de4-135">使用此窗格，即可定義別名、排序次序、篩選、群組和參數。</span><span class="sxs-lookup"><span data-stu-id="56de4-135">Use this pane to define aliases, sort order, filters, groups, and parameters.</span></span>|
|<span data-ttu-id="56de4-136">SQL</span><span class="sxs-lookup"><span data-stu-id="56de4-136">SQL</span></span>|<span data-ttu-id="56de4-137">顯示以 [圖表] 和 [方格] 窗格表示的 [!INCLUDE[tsql](../../../includes/tsql-md.md)] 查詢。</span><span class="sxs-lookup"><span data-stu-id="56de4-137">Displays the [!INCLUDE[tsql](../../../includes/tsql-md.md)] query represented by the diagram and Grid panes.</span></span> <span data-ttu-id="56de4-138">使用此窗格，即可利用 [!INCLUDE[tsql](../../../includes/tsql-md.md)]來撰寫或更新查詢。</span><span class="sxs-lookup"><span data-stu-id="56de4-138">Use this pane to write or update a query using [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span>|
|<span data-ttu-id="56de4-139">結果</span><span class="sxs-lookup"><span data-stu-id="56de4-139">Result</span></span>|<span data-ttu-id="56de4-140">顯示查詢的結果。</span><span class="sxs-lookup"><span data-stu-id="56de4-140">Displays the results of the query.</span></span> <span data-ttu-id="56de4-141">若要執行查詢，請以滑鼠右鍵按一下任何窗格，然後按一下 [執行]  ，或是按一下工具列上的 [執行]  按鈕。</span><span class="sxs-lookup"><span data-stu-id="56de4-141">To run the query, right-click in any pane, and then click **Run**, or click the **Run** button on the toolbar.</span></span>|

 <span data-ttu-id="56de4-142">當您在前三個窗格中的任何一個窗格內變更資訊時，那些變更將會出現在其他窗格中。</span><span class="sxs-lookup"><span data-stu-id="56de4-142">When you change information in any one of the first three panes, those changes will appear in the other panes.</span></span> <span data-ttu-id="56de4-143">例如，如果您在 [圖表] 窗格中加入資料表，則也會將該資料表自動加入至 [SQL] 窗格中的 [!INCLUDE[tsql](../../../includes/tsql-md.md)] 查詢。</span><span class="sxs-lookup"><span data-stu-id="56de4-143">For example, if you add a table in the Diagram pane, it will automatically be added to the [!INCLUDE[tsql](../../../includes/tsql-md.md)] query in the SQL pane.</span></span> <span data-ttu-id="56de4-144">如果將欄位加入至 [SQL] 窗格中的查詢，則也會將該欄位自動加入至 [方格] 窗格中的清單，以及更新 [圖表] 窗格中的資料表。</span><span class="sxs-lookup"><span data-stu-id="56de4-144">Adding a field to the query in the SQL pane will automatically add the field to the list in the Grid pane and update the table in the Diagram pane.</span></span>

 <span data-ttu-id="56de4-145">如需詳細資訊，請參閱[查詢和檢視表設計工具 &#40;Visual Database Tools&#41;](../../ssms/visual-db-tools/visual-database-tools.md)。</span><span class="sxs-lookup"><span data-stu-id="56de4-145">For more information, see [Query and View Designer Tools &#40;Visual Database Tools&#41;](../../ssms/visual-db-tools/visual-database-tools.md).</span></span>

#### <a name="toolbar-for-the-graphical-query-designer"></a><span data-ttu-id="56de4-146">圖形化查詢設計工具工具列</span><span class="sxs-lookup"><span data-stu-id="56de4-146">Toolbar for the Graphical Query Designer</span></span>
 <span data-ttu-id="56de4-147">圖形化查詢設計工具工具列會提供按鈕，協助您使用圖形化介面設計 [!INCLUDE[tsql](../../../includes/tsql-md.md)] 查詢。</span><span class="sxs-lookup"><span data-stu-id="56de4-147">The graphical query designer toolbar provides buttons to help you design [!INCLUDE[tsql](../../../includes/tsql-md.md)] queries using the graphical interface.</span></span>

|<span data-ttu-id="56de4-148">按鈕</span><span class="sxs-lookup"><span data-stu-id="56de4-148">Button</span></span>|<span data-ttu-id="56de4-149">描述</span><span class="sxs-lookup"><span data-stu-id="56de4-149">Description</span></span>|
|------------|-----------------|
|<span data-ttu-id="56de4-150">**當成文字編輯**</span><span class="sxs-lookup"><span data-stu-id="56de4-150">**Edit As Text**</span></span>|<span data-ttu-id="56de4-151">在以文字為基礎的查詢設計工具和圖形化查詢設計工具之間切換。</span><span class="sxs-lookup"><span data-stu-id="56de4-151">Toggle between the text-based query designer and the graphical query designer.</span></span>|
|<span data-ttu-id="56de4-152">**匯入**</span><span class="sxs-lookup"><span data-stu-id="56de4-152">**Import**</span></span>|<span data-ttu-id="56de4-153">從檔案或報表匯入現有的查詢。</span><span class="sxs-lookup"><span data-stu-id="56de4-153">Import an existing query from a file or report.</span></span> <span data-ttu-id="56de4-154">只支援 .sql 和 .rdl 檔案類型。</span><span class="sxs-lookup"><span data-stu-id="56de4-154">Only file types .sql and .rdl are supported.</span></span> <span data-ttu-id="56de4-155">如需詳細資訊，請參閱 [報表內嵌資料集和共用資料集 &#40;報表產生器及 SSRS&#41;](report-embedded-datasets-and-shared-datasets-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="56de4-155">For more information, see [Report Embedded Datasets and Shared Datasets &#40;Report Builder and SSRS&#41;](report-embedded-datasets-and-shared-datasets-report-builder-and-ssrs.md).</span></span>|
|<span data-ttu-id="56de4-156">![顯示/隱藏 [圖表] 窗格切換按鈕](../media/rsqdicon-showhidediagram.gif "顯示/隱藏 [圖表] 窗格切換按鈕")</span><span class="sxs-lookup"><span data-stu-id="56de4-156">![Show/Hide diagram pane toggle button](../media/rsqdicon-showhidediagram.gif "Show/Hide diagram pane toggle button")</span></span>|<span data-ttu-id="56de4-157">顯示或隱藏 [圖表] 窗格。</span><span class="sxs-lookup"><span data-stu-id="56de4-157">Show or hide the Diagram pane.</span></span>|
|<span data-ttu-id="56de4-158">![顯示或隱藏 [方格] 窗格切換](../media/rsqdicon-showhidegrid.gif "顯示或隱藏 [方格] 窗格切換")</span><span class="sxs-lookup"><span data-stu-id="56de4-158">![Show or Hide Grid pane toggle](../media/rsqdicon-showhidegrid.gif "Show or Hide Grid pane toggle")</span></span>|<span data-ttu-id="56de4-159">顯示或隱藏 [方格] 窗格。</span><span class="sxs-lookup"><span data-stu-id="56de4-159">Show or hide the Grid pane.</span></span>|
|<span data-ttu-id="56de4-160">![顯示或隱藏 [SQL] 窗格切換](../media/rsqdicon-showhidesql.gif "顯示或隱藏 [SQL] 窗格切換")</span><span class="sxs-lookup"><span data-stu-id="56de4-160">![Show or hide sql pane toggle](../media/rsqdicon-showhidesql.gif "Show or hide sql pane toggle")</span></span>|<span data-ttu-id="56de4-161">顯示或隱藏 [SQL] 窗格。</span><span class="sxs-lookup"><span data-stu-id="56de4-161">Show or hide the SQL pane.</span></span>|
|<span data-ttu-id="56de4-162">![顯示或隱藏 [結果] 窗格切換](../media/rsqdicon-showhideresult.gif "顯示或隱藏 [結果] 窗格切換")</span><span class="sxs-lookup"><span data-stu-id="56de4-162">![Show or Hide Result pane toggle](../media/rsqdicon-showhideresult.gif "Show or Hide Result pane toggle")</span></span>|<span data-ttu-id="56de4-163">顯示或隱藏 [結果] 窗格。</span><span class="sxs-lookup"><span data-stu-id="56de4-163">Show or hide the Result pane.</span></span>|
|<span data-ttu-id="56de4-164">![執行查詢](../../analysis-services/media/rsqdicon-run.gif "執行查詢")</span><span class="sxs-lookup"><span data-stu-id="56de4-164">![Run the query](../../analysis-services/media/rsqdicon-run.gif "Run the query")</span></span>|<span data-ttu-id="56de4-165">執行查詢。</span><span class="sxs-lookup"><span data-stu-id="56de4-165">Run the query.</span></span>|
|<span data-ttu-id="56de4-166">![以 [SQL] 窗格按鈕驗證 SQL](../media/rsqdicon-verifysql.gif "以 [SQL] 窗格按鈕驗證 SQL")</span><span class="sxs-lookup"><span data-stu-id="56de4-166">![Verify SQL in SQL pane button](../media/rsqdicon-verifysql.gif "Verify SQL in SQL pane button")</span></span>|<span data-ttu-id="56de4-167">檢查查詢文字的語法是否正確。</span><span class="sxs-lookup"><span data-stu-id="56de4-167">Check that the syntax of the query text is correct.</span></span>|
|<span data-ttu-id="56de4-168">![在選取欄位上設定遞增排序](../media/rsqdicon-sortascending.gif "在選取欄位上設定遞增排序")</span><span class="sxs-lookup"><span data-stu-id="56de4-168">![Set Sort Ascending on selected field](../media/rsqdicon-sortascending.gif "Set Sort Ascending on selected field")</span></span>|<span data-ttu-id="56de4-169">將 [圖表] 窗格中選取之資料行的排序次序，設定為 [遞增排序]  。</span><span class="sxs-lookup"><span data-stu-id="56de4-169">Set the sort order to **Sort Ascending** for the selected column in the Diagram pane,</span></span>|
|<span data-ttu-id="56de4-170">![在選取欄位上設定遞減排序](../media/rsqdicon-sortdescending.gif "在選取欄位上設定遞減排序")</span><span class="sxs-lookup"><span data-stu-id="56de4-170">![Set Sort Descending on selected field](../media/rsqdicon-sortdescending.gif "Set Sort Descending on selected field")</span></span>|<span data-ttu-id="56de4-171">將 [圖表] 窗格中選取之資料行的排序次序，設定為 [遞減排序]  。</span><span class="sxs-lookup"><span data-stu-id="56de4-171">Set the sort order to **Sort Descending** for the selected column in the Diagram pane,</span></span>|
|<span data-ttu-id="56de4-172">![移除選取欄位上的篩選](../media/rsqdicon-removefilter.gif "移除選取欄位上的篩選")</span><span class="sxs-lookup"><span data-stu-id="56de4-172">![Remove filter on selected field](../media/rsqdicon-removefilter.gif "Remove filter on selected field")</span></span>|<span data-ttu-id="56de4-173">在標記為有篩選 (![所選篩選資料行旁邊的篩選圖形](../media/rsqdicon-filter.gif "在選取篩選資料行旁邊的篩選圖形")) 的 [圖表] 窗格中，移除所選資料行的篩選。</span><span class="sxs-lookup"><span data-stu-id="56de4-173">Remove the filter for the selected column in the Diagram pane that is marked as having a filter (![Filter graphic next to selected filter column](../media/rsqdicon-filter.gif "Filter graphic next to selected filter column")).</span></span>|
|<span data-ttu-id="56de4-174">![為選取欄位使用群組依據](../media/rsqdicon-usegroupby.gif "為選取欄位使用群組依據")</span><span class="sxs-lookup"><span data-stu-id="56de4-174">![Use Group By for the selected field](../media/rsqdicon-usegroupby.gif "Use Group By for the selected field")</span></span>|<span data-ttu-id="56de4-175">顯示或隱藏 [方格] 窗格中的 [群組依據]  資料行。</span><span class="sxs-lookup"><span data-stu-id="56de4-175">Show or hide the **Group By** column in the Grid pane.</span></span> <span data-ttu-id="56de4-176">當 [分組依據]  切換為開啟時，[方格] 窗格中會出現一個名稱為 [分組依據]  的額外資料行，而且查詢中所選資料行的每一個值都會預設為 [分組依據]  ，這樣就會將選取的資料行包含在 SQL 文字的 Group By 子句中。</span><span class="sxs-lookup"><span data-stu-id="56de4-176">When the **Group By** toggle is on, an extra column named **Group By** appears in the Grid pane, and each value for the selected columns in the query defaults to **Group By**, which causes the selected column to be included in a Group By clause in the SQL text.</span></span> <span data-ttu-id="56de4-177">使用 [群組依據] 按鈕即可自動加入 GROUP BY 子句，該子句會包含 SELECT 子句中的所有資料行。</span><span class="sxs-lookup"><span data-stu-id="56de4-177">Use the Group By button to automatically add a GROUP BY clause that includes all columns in the SELECT clause.</span></span> <span data-ttu-id="56de4-178">如果 SELECT 子句中包含的是彙總函式呼叫 (例如 SUM(ColumnName))，但是您希望非彙總資料行也出現在結果集中，則請將其包含在 GROUP BY 子句中。</span><span class="sxs-lookup"><span data-stu-id="56de4-178">When your SELECT clause includes aggregate function calls (for example, SUM(ColumnName)), include each non-aggregate column in the GROUP BY clause if you want it to appear in the result set.</span></span><br /><br /> <span data-ttu-id="56de4-179">查詢中的每個資料行都必須定義彙總函式，用以計算要顯示在 [結果] 窗格中的值，或者必須在 SQL 查詢的 GROUP BY 子句中指定查詢的資料行，這樣資料行才會出現在 [結果] 窗格中。</span><span class="sxs-lookup"><span data-stu-id="56de4-179">To appear in the Result pane, each column in the query must have an aggregate function defined for use in calculating the value to display in the Result pane, or the column in the query has to be specified in the GROUP BY clause of the SQL query.</span></span>|
|<span data-ttu-id="56de4-180">![在 [圖表] 窗格中新增資料表](../media/rsqdicon-addtable.gif "在 [圖表] 窗格中新增資料表")</span><span class="sxs-lookup"><span data-stu-id="56de4-180">![Add a new table to the diagram pane](../media/rsqdicon-addtable.gif "Add a new table to the diagram pane")</span></span>|<span data-ttu-id="56de4-181">將資料來源中的新資料表加入至 [圖表] 窗格中。</span><span class="sxs-lookup"><span data-stu-id="56de4-181">Add a new table from the data source to the Diagram pane.</span></span><br /><br /> <span data-ttu-id="56de4-182">**注意** ：當您加入新資料表時，查詢設計工具會嘗試比對資料來源中的外部索引鍵關聯性。</span><span class="sxs-lookup"><span data-stu-id="56de4-182">**Note** When you add a new table, the query designer tries to match up foreign key relationships from the data source.</span></span> <span data-ttu-id="56de4-183">因此，在加入資料表之後，請確認以資料表之間的連結所表示的外部索引鍵關聯性是否正確。</span><span class="sxs-lookup"><span data-stu-id="56de4-183">After you add a table, confirm that the foreign key relationships represented by linkages between the tables are correct.</span></span>|

#### <a name="example"></a><span data-ttu-id="56de4-184">範例</span><span class="sxs-lookup"><span data-stu-id="56de4-184">Example</span></span>
 <span data-ttu-id="56de4-185">下列查詢會從 [!INCLUDE[ssSampleDBobject](../../../includes/sssampledbobject-md.md)] 資料庫的 **Person** 資料表傳回姓氏清單：</span><span class="sxs-lookup"><span data-stu-id="56de4-185">The following query returns the list of last names from the [!INCLUDE[ssSampleDBobject](../../../includes/sssampledbobject-md.md)] database **Person** table:</span></span>

```
SELECT LastName FROM Person.Person;
```

 <span data-ttu-id="56de4-186">您也可以從 [SQL] 窗格中執行預存程序。</span><span class="sxs-lookup"><span data-stu-id="56de4-186">You can also run stored procedures from the SQL pane.</span></span> <span data-ttu-id="56de4-187">下列查詢會在 **資料庫中執行** uspGetEmployeeManagers [!INCLUDE[ssSampleDBobject](../../../includes/sssampledbobject-md.md)] 預存程序：</span><span class="sxs-lookup"><span data-stu-id="56de4-187">The following query runs the stored procedure **uspGetEmployeeManagers** in the [!INCLUDE[ssSampleDBobject](../../../includes/sssampledbobject-md.md)] database:</span></span>

```
EXEC uspGetEmployeeManagers '1';
```

### <a name="command-type-tabledirect"></a><span data-ttu-id="56de4-188">TableDirect 命令類型</span><span class="sxs-lookup"><span data-stu-id="56de4-188">Command Type TableDirect</span></span>
 <span data-ttu-id="56de4-189">在 **TableDirect** 類型中，圖形化查詢設計工具會顯示資料來源中可用的資料表下拉式清單和 [結果] 窗格。</span><span class="sxs-lookup"><span data-stu-id="56de4-189">In **TableDirect** type, the graphical query designer displays a drop-down list of the available tables from the data source and a Result pane.</span></span> <span data-ttu-id="56de4-190">如果選取資料表並按一下 [執行]  按鈕，便會傳回該資料表的所有資料行。</span><span class="sxs-lookup"><span data-stu-id="56de4-190">If you select a table and click the **Run** button, all the columns for that table are returned.</span></span>

> [!NOTE]
>  <span data-ttu-id="56de4-191">只有 **OLE DB** 和 **ODBC** 資料來源類型才支援 TableDirect 功能。</span><span class="sxs-lookup"><span data-stu-id="56de4-191">the TableDirect feature is supported only by **OLE DB** and **ODBC** data source types.</span></span>

 <span data-ttu-id="56de4-192">下表會描述各個窗格的功能。</span><span class="sxs-lookup"><span data-stu-id="56de4-192">The following table describes the function of each pane.</span></span>

|<span data-ttu-id="56de4-193">窗格</span><span class="sxs-lookup"><span data-stu-id="56de4-193">Pane</span></span>|<span data-ttu-id="56de4-194">函式</span><span class="sxs-lookup"><span data-stu-id="56de4-194">Function</span></span>|
|----------|--------------|
|<span data-ttu-id="56de4-195">資料表下拉式清單</span><span class="sxs-lookup"><span data-stu-id="56de4-195">Table drop-down list</span></span>|<span data-ttu-id="56de4-196">列出資料來源中所有可使用的資料表。</span><span class="sxs-lookup"><span data-stu-id="56de4-196">Lists all the available tables from the data source.</span></span> <span data-ttu-id="56de4-197">從清單中選取一項，即可使其變成使用中狀態。</span><span class="sxs-lookup"><span data-stu-id="56de4-197">Select one from the list to make it active.</span></span>|
|<span data-ttu-id="56de4-198">結果</span><span class="sxs-lookup"><span data-stu-id="56de4-198">Result</span></span>|<span data-ttu-id="56de4-199">顯示選取之資料表中的所有資料行。</span><span class="sxs-lookup"><span data-stu-id="56de4-199">Displays all columns from the selected table.</span></span> <span data-ttu-id="56de4-200">若要執行資料表查詢，請按一下工具列上的 [執行]  按鈕。</span><span class="sxs-lookup"><span data-stu-id="56de4-200">To run the table query, click the **Run** button on the toolbar.</span></span>|

#### <a name="toolbar-buttons-for-the-command-type-tabledirect"></a><span data-ttu-id="56de4-201">TableDirect 命令類型的工具列按鈕</span><span class="sxs-lookup"><span data-stu-id="56de4-201">Toolbar Buttons for the Command Type TableDirect</span></span>
 <span data-ttu-id="56de4-202">圖形化查詢設計工具工具列會提供資料來源中的資料表下拉式清單。</span><span class="sxs-lookup"><span data-stu-id="56de4-202">The graphical query designer toolbar provides a drop-down list of tables on the data source.</span></span> <span data-ttu-id="56de4-203">下表列出每一個按鈕以及該按鈕的功能。</span><span class="sxs-lookup"><span data-stu-id="56de4-203">The following table lists each button and its function.</span></span>

|<span data-ttu-id="56de4-204">按鈕</span><span class="sxs-lookup"><span data-stu-id="56de4-204">Button</span></span>|<span data-ttu-id="56de4-205">描述</span><span class="sxs-lookup"><span data-stu-id="56de4-205">Description</span></span>|
|------------|-----------------|
|<span data-ttu-id="56de4-206">**當成文字編輯**</span><span class="sxs-lookup"><span data-stu-id="56de4-206">**Edit As Text**</span></span>|<span data-ttu-id="56de4-207">在以文字為基礎的查詢設計工具和圖形化查詢設計工具之間切換。</span><span class="sxs-lookup"><span data-stu-id="56de4-207">Toggle between the text-based query designer and the graphical query designer.</span></span>|
|<span data-ttu-id="56de4-208">**匯入**</span><span class="sxs-lookup"><span data-stu-id="56de4-208">**Import**</span></span>|<span data-ttu-id="56de4-209">從檔案或報表匯入現有的查詢。</span><span class="sxs-lookup"><span data-stu-id="56de4-209">Import an existing query from a file or report.</span></span> <span data-ttu-id="56de4-210">只支援 .sql 和 .rdl 檔案類型。</span><span class="sxs-lookup"><span data-stu-id="56de4-210">Only file types .sql and .rdl are supported.</span></span> <span data-ttu-id="56de4-211">如需詳細資訊，請參閱 [報表內嵌資料集和共用資料集 &#40;報表產生器及 SSRS&#41;](report-embedded-datasets-and-shared-datasets-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="56de4-211">For more information, see [Report Embedded Datasets and Shared Datasets &#40;Report Builder and SSRS&#41;](report-embedded-datasets-and-shared-datasets-report-builder-and-ssrs.md).</span></span>|
|<span data-ttu-id="56de4-212">![一般查詢設計工具按鈕的圖示](../media/icongenericquerydesigner.gif "一般查詢設計工具按鈕的圖示")</span><span class="sxs-lookup"><span data-stu-id="56de4-212">![Icon of the Generic Query Designer button](../media/icongenericquerydesigner.gif "Icon of the Generic Query Designer button")</span></span>|<span data-ttu-id="56de4-213">在一般查詢設計工具與圖形化查詢設計工具之間切換，並保留查詢文字或預存程序檢視。</span><span class="sxs-lookup"><span data-stu-id="56de4-213">Toggle between generic query designer and graphical query designer, preserving the query text or stored procedure view.</span></span>|
|<span data-ttu-id="56de4-214">![執行查詢](../../analysis-services/media/rsqdicon-run.gif "執行查詢")</span><span class="sxs-lookup"><span data-stu-id="56de4-214">![Run the query](../../analysis-services/media/rsqdicon-run.gif "Run the query")</span></span>|<span data-ttu-id="56de4-215">從選取的資料表中選取所有的資料行。</span><span class="sxs-lookup"><span data-stu-id="56de4-215">Select all columns from the selected table.</span></span>|

### <a name="command-type-storedprocedure"></a><span data-ttu-id="56de4-216">StoredProcedure 命令類型</span><span class="sxs-lookup"><span data-stu-id="56de4-216">Command Type StoredProcedure</span></span>
 <span data-ttu-id="56de4-217">在 **StoredProcedure** 類型中，圖形化查詢設計工具會顯示資料來源中可用的預存程序下拉式清單和 [結果] 窗格。</span><span class="sxs-lookup"><span data-stu-id="56de4-217">In **StoredProcedure** type, the graphical query designer displays a drop-down list of the available stored procedures from the data source and a Result pane.</span></span> <span data-ttu-id="56de4-218">下表會描述各個窗格的功能。</span><span class="sxs-lookup"><span data-stu-id="56de4-218">The following table describes the function of each pane.</span></span>

|<span data-ttu-id="56de4-219">窗格</span><span class="sxs-lookup"><span data-stu-id="56de4-219">Pane</span></span>|<span data-ttu-id="56de4-220">函式</span><span class="sxs-lookup"><span data-stu-id="56de4-220">Function</span></span>|
|----------|--------------|
|<span data-ttu-id="56de4-221">預存程序下拉式清單</span><span class="sxs-lookup"><span data-stu-id="56de4-221">Stored procedure drop-down list</span></span>|<span data-ttu-id="56de4-222">列出資料來源中所有可使用的預存程序。</span><span class="sxs-lookup"><span data-stu-id="56de4-222">Lists all the available stored procedures from the data source.</span></span> <span data-ttu-id="56de4-223">從清單中選取一項，即可使其變成使用中狀態。</span><span class="sxs-lookup"><span data-stu-id="56de4-223">Select one from the list to make it active.</span></span>|
|<span data-ttu-id="56de4-224">結果</span><span class="sxs-lookup"><span data-stu-id="56de4-224">Result</span></span>|<span data-ttu-id="56de4-225">顯示執行預存程序的結果。</span><span class="sxs-lookup"><span data-stu-id="56de4-225">Displays the result of running the stored procedure.</span></span> <span data-ttu-id="56de4-226">若要執行選取的預存程序，請按一下工具列上的 [執行]  按鈕。</span><span class="sxs-lookup"><span data-stu-id="56de4-226">To run the selected stored procedure, click the **Run** button on the toolbar.</span></span>|

#### <a name="toolbar-buttons-for-command-type-storedprocedure"></a><span data-ttu-id="56de4-227">StoredProcedure 命令類型的工具列按鈕</span><span class="sxs-lookup"><span data-stu-id="56de4-227">Toolbar Buttons for Command Type StoredProcedure</span></span>
 <span data-ttu-id="56de4-228">圖形化查詢設計工具工具列會提供資料來源中的預存程序下拉式清單。</span><span class="sxs-lookup"><span data-stu-id="56de4-228">The graphical query designer toolbar provides a drop-down list of stored procedures on the data source.</span></span> <span data-ttu-id="56de4-229">下表列出每一個按鈕以及該按鈕的功能。</span><span class="sxs-lookup"><span data-stu-id="56de4-229">The following table lists each button and its function.</span></span>

|<span data-ttu-id="56de4-230">按鈕</span><span class="sxs-lookup"><span data-stu-id="56de4-230">Button</span></span>|<span data-ttu-id="56de4-231">描述</span><span class="sxs-lookup"><span data-stu-id="56de4-231">Description</span></span>|
|------------|-----------------|
|<span data-ttu-id="56de4-232">**當成文字編輯**</span><span class="sxs-lookup"><span data-stu-id="56de4-232">**Edit As Text**</span></span>|<span data-ttu-id="56de4-233">在以文字為基礎的查詢設計工具和圖形化查詢設計工具之間切換。</span><span class="sxs-lookup"><span data-stu-id="56de4-233">Toggle between the text-based query designer and the graphical query designer.</span></span>|
|<span data-ttu-id="56de4-234">**匯入**</span><span class="sxs-lookup"><span data-stu-id="56de4-234">**Import**</span></span>|<span data-ttu-id="56de4-235">從檔案或報表匯入現有的查詢。</span><span class="sxs-lookup"><span data-stu-id="56de4-235">Import an existing query from a file or report.</span></span> <span data-ttu-id="56de4-236">只支援 .sql 和 .rdl 檔案類型。</span><span class="sxs-lookup"><span data-stu-id="56de4-236">Only file types .sql and .rdl are supported.</span></span> <span data-ttu-id="56de4-237">如需詳細資訊，請參閱 [報表內嵌資料集和共用資料集 &#40;報表產生器及 SSRS&#41;](report-embedded-datasets-and-shared-datasets-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="56de4-237">For more information, see [Report Embedded Datasets and Shared Datasets &#40;Report Builder and SSRS&#41;](report-embedded-datasets-and-shared-datasets-report-builder-and-ssrs.md).</span></span>|
|<span data-ttu-id="56de4-238">![執行查詢](../../analysis-services/media/rsqdicon-run.gif "執行查詢")</span><span class="sxs-lookup"><span data-stu-id="56de4-238">![Run the query](../../analysis-services/media/rsqdicon-run.gif "Run the query")</span></span>|<span data-ttu-id="56de4-239">執行選取的預存程序。</span><span class="sxs-lookup"><span data-stu-id="56de4-239">Run the selected stored procedure.</span></span>|
|<span data-ttu-id="56de4-240">預存程序下拉式清單</span><span class="sxs-lookup"><span data-stu-id="56de4-240">Stored procedure drop-down list</span></span>|<span data-ttu-id="56de4-241">按一下向下箭頭，即可顯示資料來源中可使用的預存程序清單。</span><span class="sxs-lookup"><span data-stu-id="56de4-241">Click the down arrow to display a list of available stored procedures from the data source.</span></span> <span data-ttu-id="56de4-242">按一下清單中的任何一個預存程序，以選取它。</span><span class="sxs-lookup"><span data-stu-id="56de4-242">Click any stored procedure from the list to select it.</span></span>|

#### <a name="example"></a><span data-ttu-id="56de4-243">範例</span><span class="sxs-lookup"><span data-stu-id="56de4-243">Example</span></span>
 <span data-ttu-id="56de4-244">下列預存程序會從 [!INCLUDE[ssSampleDBobject](../../../includes/sssampledbobject-md.md)] 資料庫中呼叫員工經理的命令鏈結清單。</span><span class="sxs-lookup"><span data-stu-id="56de4-244">The following stored procedure calls a chain-of-command list of managers from the [!INCLUDE[ssSampleDBobject](../../../includes/sssampledbobject-md.md)] database.</span></span> <span data-ttu-id="56de4-245">這個預存程序會接受 *BusinessEntityID* 作為參數。</span><span class="sxs-lookup"><span data-stu-id="56de4-245">This stored procedure accepts *BusinessEntityID* as parameter.</span></span> <span data-ttu-id="56de4-246">您可以輸入任何較小的整數。</span><span class="sxs-lookup"><span data-stu-id="56de4-246">You can enter any small integer.</span></span>

 `uspGetEmployeeManagers '1';`

## <a name="see-also"></a><span data-ttu-id="56de4-247">另請參閱</span><span class="sxs-lookup"><span data-stu-id="56de4-247">See Also</span></span>
 <span data-ttu-id="56de4-248">[報表設計師 SQL Server Data Tools 中的查詢設計工具 &#40;ssrs&#41;](query-design-tools-ssrs.md) [將資料加入至報表 &#40;報表產生器和 ssrs](report-datasets-ssrs.md)&#41;[SQL Server ssrs &#40;](sql-server-connection-type-ssrs.md) [&#41;連線類型](ole-db-connection-type-ssrs.md)OLE DB ssrs &#40;[將資料加入至報表](report-datasets-ssrs.md)&#41;&#40;和 Ssrs 報表產生器[Oracle](oracle-connection-type-ssrs.md)連線類型&#41;Ssrs &#40;[rsreportdesigner.config 設定檔](../report-server/rsreportdesigner-configuration-file.md)[設計查詢和 Views 如何主題&#41;Visual Database Tools &#40;](../../ssms/visual-db-tools/design-queries-and-views-how-to-topics-visual-database-tools.md)</span><span class="sxs-lookup"><span data-stu-id="56de4-248">[Query Design Tools in Report Designer SQL Server Data Tools &#40;SSRS&#41;](query-design-tools-ssrs.md) [Add Data to a Report &#40;Report Builder and SSRS&#41;](report-datasets-ssrs.md) [SQL Server Connection Type &#40;SSRS&#41;](sql-server-connection-type-ssrs.md) [OLE DB Connection Type &#40;SSRS&#41;](ole-db-connection-type-ssrs.md) [Add Data to a Report &#40;Report Builder and SSRS&#41;](report-datasets-ssrs.md) [Oracle Connection Type &#40;SSRS&#41;](oracle-connection-type-ssrs.md) [RSReportDesigner Configuration File](../report-server/rsreportdesigner-configuration-file.md) [Design Queries and Views How-to Topics &#40;Visual Database Tools&#41;](../../ssms/visual-db-tools/design-queries-and-views-how-to-topics-visual-database-tools.md)</span></span>


