---
title: 指定報表資料來源的認證及連線資訊 | Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- no credentials option [Reporting Services]
- impersonation [Reporting Services]
- user impersonation [Reporting Services]
- Windows authentication [Reporting Services]
- data sources [Reporting Services], security
- connection strings [Reporting Services]
- unattended report processing [Reporting Services]
- reports [Reporting Services], security
- remote data sources [Reporting Services]
- credentials [Reporting Services]
- authentication [Reporting Services]
- external data sources [Reporting Services]
- prompted credentials [Reporting Services]
- multiple connections
- stored credentials [Reporting Services]
- security [Reporting Services], data sources
- Windows integrated security [Reporting Services]
ms.assetid: fee1a663-a313-424a-aed2-5082bfd114b3
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 2d1e804282459972b21303cf795a9c3a88ea93d5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87598235"
---
# <a name="specify-credential-and-connection-information-for-report-data-sources"></a><span data-ttu-id="aa6ca-102">指定報表資料來源的認證及連接資訊</span><span class="sxs-lookup"><span data-stu-id="aa6ca-102">Specify Credential and Connection Information for Report Data Sources</span></span>
  <span data-ttu-id="aa6ca-103">報表伺服器使用認證以連接到外部資料來源，其中提供內容給報表或提供收件者資訊給資料驅動訂閱。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-103">A report server uses credentials to connect to external data sources that provide content to reports or recipient information to a data-driven subscription.</span></span> <span data-ttu-id="aa6ca-104">您可以指定認證來使用 Windows 驗證、資料庫驗證、無驗證或自訂驗證。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-104">You can specify credentials that use Windows Authentication, database authentication, no authentication, or custom authentication.</span></span> <span data-ttu-id="aa6ca-105">透過網路傳送連接要求時，報表伺服器會模擬使用者帳戶或自動執行帳戶。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-105">When sending a connection request over the network, the report server will either impersonate a user account or the unattended execution account.</span></span> <span data-ttu-id="aa6ca-106">如需安全性內容 (連接要求會在其底下進行) 的詳細資訊，請參閱本主題之後的 [資料來源組態和網路連接](#DataSourceConfigurationConnections) 。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-106">For more information about the security context under which a connection request is made, see [Data Source Configuration and Network Connections](#DataSourceConfigurationConnections) further on in this topic.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="aa6ca-107">認證也用於驗證存取報表伺服器的使用者。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-107">Credentials are also used to authenticate users who access a report server.</span></span> <span data-ttu-id="aa6ca-108">有關報表伺服器驗證使用者的資訊，會在另一個主題中提供。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-108">Information about authenticating users to a report server is provided in another topic.</span></span>  
  
 <span data-ttu-id="aa6ca-109">當您建立報表時，會定義與外部資料來源之間的連接。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-109">The connection to an external data source is defined when you create the report.</span></span> <span data-ttu-id="aa6ca-110">當報表發行之後，可以個別管理此連接。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-110">It can be managed separately after the report is published.</span></span> <span data-ttu-id="aa6ca-111">您可以指定靜態連接字串或運算式，好讓使用者可以從動態清單中選取資料來源。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-111">You can specify a static connection string or an expression that allows users to select a data source from a dynamic list.</span></span> <span data-ttu-id="aa6ca-112">如需如何指定資料來源類型和連接字串的詳細資訊，請參閱[Reporting Services 中的資料連線、資料來源和連接字串](../data-connections-data-sources-and-connection-strings-in-reporting-services.md)。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-112">For more information about how to specify a data source type and connection string, see [Data Connections, Data Sources, and Connection Strings in Reporting Services](../data-connections-data-sources-and-connection-strings-in-reporting-services.md).</span></span>  
  
## <a name="using-remote-data-sources"></a><span data-ttu-id="aa6ca-113">使用遠端資料來源</span><span class="sxs-lookup"><span data-stu-id="aa6ca-113">Using Remote Data Sources</span></span>  
 <span data-ttu-id="aa6ca-114">如果報表會從遠端資料庫伺服器擷取資料，請確認下列項目：</span><span class="sxs-lookup"><span data-stu-id="aa6ca-114">If the report retrieves data from a remote database server, verify the following:</span></span>  
  
-   <span data-ttu-id="aa6ca-115">提供給資料庫伺服器的認證有效。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-115">The credentials provided to the database server are valid.</span></span> <span data-ttu-id="aa6ca-116">如果您要使用 Windows 使用者認證，請確定該使用者擁有伺服器和資料庫的權限。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-116">If you are using Windows user credentials, make sure that the user has permission to the server and database.</span></span>  
  
-   <span data-ttu-id="aa6ca-117">資料庫伺服器所使用的通訊埠是開啟的。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-117">Ports used by the database server are open.</span></span> <span data-ttu-id="aa6ca-118">如果您要存取外部電腦上的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 關聯式資料庫，或者報表伺服器資料庫位於外部 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體上，您就必須開啟外部電腦上的通訊埠 1433 和 1434。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-118">If you are accessing [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] relational databases on external computers, or if the report server database is on an external [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance, you must open port 1433 and 1434 on the external computer.</span></span> <span data-ttu-id="aa6ca-119">開啟這些通訊埠之後，請務必重新啟動伺服器。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-119">Be sure to restart the server after you open ports.</span></span> <span data-ttu-id="aa6ca-120">如需詳細資訊，請參閱 [設定用於 Database Engine 存取的 Windows 防火牆](../../database-engine/configure-windows/configure-a-windows-firewall-for-database-engine-access.md)。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-120">For more information, see [Configure a Windows Firewall for Database Engine Access](../../database-engine/configure-windows/configure-a-windows-firewall-for-database-engine-access.md).</span></span>  
  
-   <span data-ttu-id="aa6ca-121">遠端連接必須已啟用。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-121">Remote connections must be enabled.</span></span> <span data-ttu-id="aa6ca-122">如果您要存取外部電腦上的 SQL Server 關聯式資料庫，可以使用 SQL Server 組態管理員工具來確認透過 TCP 進行遠端連接的功能是否已啟用。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-122">If you are accessing SQL Server relational databases on external computers, you can use SQL Server Configuration Manager tool to verify that remote connections over TCP are enabled.</span></span>  
  
## <a name="ways-to-specify-credentials-for-connecting-to-remote-data-sources"></a><span data-ttu-id="aa6ca-123">指定認證以便連接至遠端資料來源的方式</span><span class="sxs-lookup"><span data-stu-id="aa6ca-123">Ways to Specify Credentials for Connecting to Remote Data Sources</span></span>  
 <span data-ttu-id="aa6ca-124">提供內容給報表的資料來源，通常是在遠端伺服器上主控。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-124">The data sources that provide content to reports are usually hosted on remote servers.</span></span> <span data-ttu-id="aa6ca-125">若要擷取報表的資料，報表伺服器必須利用您事先提供或在執行階段取得的一組認證來連接到伺服器。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-125">To retrieve data for a report, a report server must connect to the server using a set of credentials that you provide in advance or that are obtained at run time.</span></span> <span data-ttu-id="aa6ca-126">設定資料來源時，您可以採用下列方式來指定認證：</span><span class="sxs-lookup"><span data-stu-id="aa6ca-126">When configuring a data source, you can specify credentials in the following ways:</span></span>  
  
-   <span data-ttu-id="aa6ca-127">提示使用者提供認證。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-127">Prompt the user for credentials.</span></span>  
  
-   <span data-ttu-id="aa6ca-128">儲存認證。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-128">Store credentials.</span></span>  
  
-   <span data-ttu-id="aa6ca-129">使用 Windows 整合式安全性。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-129">Use Windows integrated security.</span></span>  
  
-   <span data-ttu-id="aa6ca-130">不使用認證。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-130">Use no credentials.</span></span>  
  
 <span data-ttu-id="aa6ca-131">網路環境決定您可以支援的連接類型。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-131">The network environment determines the kinds of connections you can support.</span></span> <span data-ttu-id="aa6ca-132">例如，如果 Kerberos 第 5 版通訊協定已啟用，您可以使用 Windows 驗證中提供的委派和模擬功能來支援跨多部伺服器的連接。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-132">For example, if the Kerberos version 5 protocol is enabled, you might be able to use the delegation and impersonation features available in Windows Authentication to support connections across multiple servers.</span></span> <span data-ttu-id="aa6ca-133">如果您的網路不支援這些安全性功能，您就必須解決連接條件約束。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-133">If your network does not support these security features, you will need to work around connection constraints.</span></span> <span data-ttu-id="aa6ca-134">如果委派和模擬尚未啟用，您可以在 Windows 認證過期之前，透過單一電腦連接傳遞這些認證。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-134">If delegation and impersonation are not enabled, Windows credentials can be passed across one computer connection before they expire.</span></span> <span data-ttu-id="aa6ca-135">用戶端電腦與報表伺服器電腦的使用者連接會當成第一個連接。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-135">A user connection from a client computer to a report server computer counts as the first connection.</span></span> <span data-ttu-id="aa6ca-136">如果使用者開啟從遠端伺服器擷取資料的報表，該登入會當成第二個連接，而如果您在未啟用委派時指定要使用整合式安全性的連接，則連接會失敗。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-136">If the user opens a report that retrieves data from a remote server, that login counts as a second connection and will fail if you specified the connection to use integrated security when delegation is not enabled.</span></span>  
  
 <span data-ttu-id="aa6ca-137">如果需要多個連接來完成從用戶端電腦至外部報表資料來源的往返，請從下列策略中選擇，讓連接能夠成功。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-137">If multiple connections are required to complete a round trip from the client computer to an external report data source, choose from the following strategies to make the connections succeed.</span></span>  
  
-   <span data-ttu-id="aa6ca-138">在網域中啟用模擬和委派功能，使認證能夠無限制地委派給其他電腦。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-138">Enable impersonation and delegation features in your domain so that credentials can be delegated to other computers without limit.</span></span>  
  
-   <span data-ttu-id="aa6ca-139">使用預存認證或提示認證，即可查詢報表資料的外部資料來源。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-139">Use stored credentials or prompted credentials to query external data sources for report data.</span></span> <span data-ttu-id="aa6ca-140">認證可以是 Windows 網域帳戶或資料庫登入。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-140">The credentials can be either a Windows domain account or a database login.</span></span>  
  
### <a name="prompted-credentials"></a><span data-ttu-id="aa6ca-141">提示認證</span><span class="sxs-lookup"><span data-stu-id="aa6ca-141">Prompted Credentials</span></span>  
 <span data-ttu-id="aa6ca-142">當您將報表資料來源連接設定為使用提示認證時，存取此報表的每位使用者都必須輸入使用者名稱和密碼，才能擷取資料。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-142">When you configure a report data source connection to use prompted credentials, each user who access the report must enter a user name and password to retrieve the data.</span></span> <span data-ttu-id="aa6ca-143">此方法建議用於包含機密資料的報表。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-143">This approach is recommended for reports that contain confidential data.</span></span> <span data-ttu-id="aa6ca-144">提示認證只能用於視需要執行的報表上。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-144">Prompted credentials can be used only on reports that run on demand.</span></span> <span data-ttu-id="aa6ca-145">提示認證可以是 Windows 帳戶或資料庫登入。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-145">Prompted credentials can be a Windows account or a database login.</span></span> <span data-ttu-id="aa6ca-146">若要使用 Windows 驗證，必須選取 [連線到資料來源時作為 Windows 認證]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-146">To use Windows Authentication, you must select **Use as Windows credentials when connecting to the data source**.</span></span> <span data-ttu-id="aa6ca-147">否則，報表伺服器會將認證傳遞至資料庫伺服器以供使用者驗證。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-147">Otherwise, the report server passes credentials to the database server for user authentication.</span></span> <span data-ttu-id="aa6ca-148">如果資料庫伺服器無法驗證您所提供的認證，連接將會失敗。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-148">If the database server cannot authenticate the credentials that you provide, the connection will fail.</span></span>  
  
### <a name="windows-integrated-security"></a><span data-ttu-id="aa6ca-149">Windows 整合式安全性</span><span class="sxs-lookup"><span data-stu-id="aa6ca-149">Windows Integrated Security</span></span>  
 <span data-ttu-id="aa6ca-150">當您使用 [Windows 整合式安全性]\*\*\*\* 選項時，報表伺服器會將存取報表之使用者的安全性權杖，傳遞至主控外部資料來源的伺服器。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-150">When you use the **Windows Integrated Security** option, the report server passes the security token of the user accessing the report to the server hosting the external data source.</span></span> <span data-ttu-id="aa6ca-151">在此情況下，不會提示使用者輸入使用者名稱或密碼。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-151">In this case, the user is not prompted to type a user name or password.</span></span> <span data-ttu-id="aa6ca-152">如果模擬和委派功能已啟用，建議您使用此方法。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-152">This approach is recommended if impersonation and delegation features are enabled.</span></span> <span data-ttu-id="aa6ca-153">如果這些功能未啟用，只有當所有您想要存取的伺服器都位於相同電腦上時，才應該使用此方法。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-153">If these features are not enabled, you should only use this approach if all the servers that you want to access are located on the same computer.</span></span>  
  
### <a name="stored-credentials"></a><span data-ttu-id="aa6ca-154">預存認證</span><span class="sxs-lookup"><span data-stu-id="aa6ca-154">Stored Credentials</span></span>  
 <span data-ttu-id="aa6ca-155">您可以儲存用於存取外部資料來源的認證。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-155">You can store the credentials used to access an external data source.</span></span> <span data-ttu-id="aa6ca-156">認證是以可回復加密的方式，儲存在報表伺服器資料庫中。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-156">Credentials are stored in reversible encryption in the report server database.</span></span> <span data-ttu-id="aa6ca-157">您可以為用於報表中的每一個資料來源，指定一組預存認證。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-157">You can specify one set of stored credentials for each data source used in a report.</span></span> <span data-ttu-id="aa6ca-158">您提供的認證會為執行報表的每一個使用者擷取相同的資料。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-158">The credentials you provide retrieve the same data for every user who runs the report.</span></span>  
  
 <span data-ttu-id="aa6ca-159">建議存取遠端資料庫伺服器時，將預存認證當成策略的一部分。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-159">Stored credentials are recommended as part of a strategy for accessing remote database servers.</span></span> <span data-ttu-id="aa6ca-160">如果您想要支援訂閱、產生排程報表記錄，或重新整理報表快照集，就需要預存認證。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-160">Stored credentials are required if you want to support subscriptions, or schedule report history generation or report snapshot refreshes.</span></span> <span data-ttu-id="aa6ca-161">以背景處理序執行報表時，報表伺服器為執行報表的代理程式。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-161">When a report runs as a background process, the report server is the agent that executes the report.</span></span> <span data-ttu-id="aa6ca-162">因為沒有使用者內容，所以報表伺服器必須從報表伺服器資料庫取得認證資訊，以便連接到資料來源。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-162">Because there is no user context in place, the report server must get credential information from the report server database in order to connect to a data source.</span></span>  
  
 <span data-ttu-id="aa6ca-163">您指定的使用者名稱和密碼可以是 Windows 認證或資料庫登入。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-163">The user name and password that you specify can be Windows credentials or a database login.</span></span> <span data-ttu-id="aa6ca-164">如果您指定 Windows 認證，則報表伺服器會將認證傳遞至 Windows 以供後續驗證。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-164">If you specify Windows credentials, the report server passes the credentials to Windows for subsequent authentication.</span></span> <span data-ttu-id="aa6ca-165">否則，它會將認證傳遞至資料庫伺服器以供驗證。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-165">Otherwise, the credentials are passed to the database server for authentication.</span></span>  
  
#### <a name="how-to-grant-allow-log-on-locally-permissions-to-domain-user-accounts"></a><span data-ttu-id="aa6ca-166">如何將「允許本機登入」權限授與網域使用者帳戶</span><span class="sxs-lookup"><span data-stu-id="aa6ca-166">How to Grant "Allow log on locally" Permissions to Domain User Accounts</span></span>  
 <span data-ttu-id="aa6ca-167">如果您使用預存認證來連接至外部資料來源，Windows 網域使用者帳戶就必須擁有本機登入的權限。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-167">If you use stored credentials to connect to an external data source, the Windows domain user account must have permission to log on locally.</span></span> <span data-ttu-id="aa6ca-168">這個權限可讓報表伺服器模擬報表伺服器的使用者，而且以該模擬使用者的身分將要求傳送至外部資料來源。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-168">This permission allows the report server to impersonate the user on the report server and send the request to the external data source as that impersonated user.</span></span>  
  
 <span data-ttu-id="aa6ca-169">若要授與此權限，請執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="aa6ca-169">To grant this permission, do the following:</span></span>  
  
1.  <span data-ttu-id="aa6ca-170">在報表伺服器電腦的 [系統管理工具]\*\*\*\* 中，開啟 [本機安全性原則]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-170">On the report server computer, in **Administrative Tools**, open **Local Security Policy**.</span></span>  
  
2.  <span data-ttu-id="aa6ca-171">在 [安全性設定]\*\*\*\* 底下，展開 [本機原則]\*\*\*\*，然後按一下 [使用者權限指派]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-171">Under **Security Settings**, expand **Local Policies**, and then click **User Rights Assignment**.</span></span>  
  
3.  <span data-ttu-id="aa6ca-172">在詳細資料窗格中，以滑鼠右鍵按一下 [允許本機登入]\*\*\*\*，然後以滑鼠右鍵按一下 [內容]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-172">In the details pane, right-click **Allow log on locally** and then right-click **Properties**.</span></span>  
  
4.  <span data-ttu-id="aa6ca-173">按一下 [新增使用者或群組]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-173">Click **Add User or Group**.</span></span>  
  
5.  <span data-ttu-id="aa6ca-174">按一下 [位置]\*\*\*\*，指定要搜尋的網域或其他位置，然後按一下 [確定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-174">Click **Locations**, specify a domain or other location that you want to search, and then click **OK**.</span></span>  
  
6.  <span data-ttu-id="aa6ca-175">輸入允許互動式登入的 Windows 帳戶，然後按一下 [確定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-175">Enter the Windows account for which you want to allow interactive login, and then click **OK**.</span></span>  
  
7.  <span data-ttu-id="aa6ca-176">在 [允許本機登入內容]\*\*\*\* 對話方塊中，按一下 [確定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-176">In the **Allow log on locally Properties** dialog box, click **OK**.</span></span>  
  
8.  <span data-ttu-id="aa6ca-177">確定您選取的帳戶沒有拒絕權限：</span><span class="sxs-lookup"><span data-stu-id="aa6ca-177">Verify that the account you selected does not also have deny permissions:</span></span>  
  
    1.  <span data-ttu-id="aa6ca-178">以滑鼠右鍵按一下 [拒絕本機登入]\*\*\*\*，然後以滑鼠右鍵按一下 [內容]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-178">Right-click **Deny log on locally** and then right-click **Properties**.</span></span>  
  
    2.  <span data-ttu-id="aa6ca-179">如果帳戶列於其中，請選取帳戶，然後按一下 [移除]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-179">If the account is listed, select it and then click **Remove**.</span></span>  
  
#### <a name="using-impersonation-with-stored-credentials"></a><span data-ttu-id="aa6ca-180">以預存認證使用模擬</span><span class="sxs-lookup"><span data-stu-id="aa6ca-180">Using Impersonation with Stored Credentials</span></span>  
 <span data-ttu-id="aa6ca-181">您也可以使用認證來模擬其他使用者的身分。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-181">You can also use credentials to impersonate the identity of another user.</span></span> <span data-ttu-id="aa6ca-182">針對 SQL Server 資料庫，使用模擬選項會設定 [SETUSER](/sql/t-sql/statements/setuser-transact-sql) 函數。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-182">For SQL Server databases, using the impersonation options sets the [SETUSER](/sql/t-sql/statements/setuser-transact-sql) function.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="aa6ca-183">針對支援訂閱的報表，或者使用排程來產生報表記錄或重新整理報表執行快照集的報表，都不要使用模擬。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-183">Do not use impersonation for reports that support subscriptions or that use schedules to generate report history or refresh a report execution snapshot.</span></span>  
  
### <a name="no-credentials"></a><span data-ttu-id="aa6ca-184">無認證</span><span class="sxs-lookup"><span data-stu-id="aa6ca-184">No Credentials</span></span>  
 <span data-ttu-id="aa6ca-185">您可以設定資料來源連接，以使用無認證。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-185">You can configure a data source connection to use no credentials.</span></span> <span data-ttu-id="aa6ca-186">Microsoft 建議您永遠利用認證來存取資料來源；不建議使用無認證。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-186">Microsoft recommends that you always use credentials to access a data sources; using no credentials is not advised.</span></span> <span data-ttu-id="aa6ca-187">不過，在下列情況下，您可以選擇使用無認證來執行報表：</span><span class="sxs-lookup"><span data-stu-id="aa6ca-187">However, you may choose to run a report with no credentials in the following cases:</span></span>  
  
-   <span data-ttu-id="aa6ca-188">遠端資料來源不需要認證。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-188">The remote data source does not require credentials.</span></span>  
  
-   <span data-ttu-id="aa6ca-189">認證會在連接字串中傳遞 (僅建議用於保護連接的安全)。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-189">The credentials are passed in the connection string (recommended only for secure connections).</span></span>  
  
-   <span data-ttu-id="aa6ca-190">報表是使用父報表之認證的子報表。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-190">The report is a subreport that uses the credentials of the parent report.</span></span>  
  
 <span data-ttu-id="aa6ca-191">在這些狀況下，報表伺服器會使用您必須事先定義的自動執行帳戶連接到遠端資料來源。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-191">Under these conditions, the report server connects to a remote data source using the unattended execution account that you must define in advance.</span></span> <span data-ttu-id="aa6ca-192">報表伺服器未利用它的服務認證連接到遠端伺服器，因此，您必須指定帳戶，讓報表伺服器能夠用於進行連接。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-192">Because the report server does not connect to a remote server using its service credentials, you must specify an account that the report server can use to make the connection.</span></span> <span data-ttu-id="aa6ca-193">如需建立此帳戶的詳細資訊，請參閱[設定自動執行帳戶 &#40;SSRS 設定管理員&#41;](../install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md)。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-193">For more information about creating this account, see [Configure the Unattended Execution Account &#40;SSRS Configuration Manager&#41;](../install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md).</span></span>  
  
##  <a name="data-source-configuration-and-network-connections"></a><a name="DataSourceConfigurationConnections"></a> <span data-ttu-id="aa6ca-194">資料來源組態和網路連接</span><span class="sxs-lookup"><span data-stu-id="aa6ca-194">Data Source Configuration and Network Connections</span></span>  
 <span data-ttu-id="aa6ca-195">下表顯示如何為認證類型和資料處理延伸模組的特定組合進行連接。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-195">The following table shows how connections are made for specific combinations of credential types and data processing extensions.</span></span> <span data-ttu-id="aa6ca-196">如果您要使用自訂資料處理延伸模組，請參閱 [為自訂資料處理延伸模組指定連接](specify-connections-for-custom-data-processing-extensions.md)。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-196">If you are using a custom data processing extension, see [Specify Connections for Custom Data Processing Extensions](specify-connections-for-custom-data-processing-extensions.md).</span></span>  
  
|<span data-ttu-id="aa6ca-197">**型別**</span><span class="sxs-lookup"><span data-stu-id="aa6ca-197">**Type**</span></span>|<span data-ttu-id="aa6ca-198">**網路連接的內容**</span><span class="sxs-lookup"><span data-stu-id="aa6ca-198">**Context for network connection**</span></span>|<span data-ttu-id="aa6ca-199">**資料來源類型**</span><span class="sxs-lookup"><span data-stu-id="aa6ca-199">**Data Source Types**</span></span><br /><br /> <span data-ttu-id="aa6ca-200">**(SQL Server、Oracle、ODBC、OLE DB、Analysis Services、XML、SAP NetWeaver BI、Hyperion Essbase)**</span><span class="sxs-lookup"><span data-stu-id="aa6ca-200">**(SQL Server, Oracle, ODBC, OLE DB, Analysis Services, XML, SAP NetWeaver BI, Hyperion Essbase)**</span></span>|  
|--------------|----------------------------------------|------------------------------------------------------------------------------------------------------------------------------------|  
|<span data-ttu-id="aa6ca-201">整合式安全性</span><span class="sxs-lookup"><span data-stu-id="aa6ca-201">Integrated security</span></span>|<span data-ttu-id="aa6ca-202">模擬目前的使用者</span><span class="sxs-lookup"><span data-stu-id="aa6ca-202">Impersonate the current user</span></span>|<span data-ttu-id="aa6ca-203">針對所有資料來源類型，利用目前的使用者帳戶來連接。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-203">For all data source types, connect using the current user account.</span></span>|  
|<span data-ttu-id="aa6ca-204">Windows 認證</span><span class="sxs-lookup"><span data-stu-id="aa6ca-204">Windows credentials</span></span>|<span data-ttu-id="aa6ca-205">模擬指定的使用者</span><span class="sxs-lookup"><span data-stu-id="aa6ca-205">Impersonate the specified user</span></span>|<span data-ttu-id="aa6ca-206">若為 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]、Oracle、ODBC 和 OLE DB：使用模擬使用者帳戶進行連接。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-206">For [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], Oracle, ODBC, and OLE DB: connect using the impersonated user account.</span></span>|  
|<span data-ttu-id="aa6ca-207">資料庫認證</span><span class="sxs-lookup"><span data-stu-id="aa6ca-207">Database credentials</span></span>|<span data-ttu-id="aa6ca-208">模擬自動執行帳戶或服務帳戶。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-208">Impersonate the unattended execution account or the service account.</span></span><br /><br /> <span data-ttu-id="aa6ca-209">(利用服務識別傳送連接要求時，Reporting Services 會移除管理員權限)。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-209">(Reporting Services removes administrator permissions when sending the connection request using the service identity).</span></span>|<span data-ttu-id="aa6ca-210">若為 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]、Oracle、ODBC 和 OLE DB：</span><span class="sxs-lookup"><span data-stu-id="aa6ca-210">For [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], Oracle, ODBC, and OLE DB:</span></span><br /><br /> <span data-ttu-id="aa6ca-211">將使用者名稱和密碼附加至連接字串。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-211">Append the user name and password on the connection string.</span></span><br /><br /> <span data-ttu-id="aa6ca-212">針對 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]：</span><span class="sxs-lookup"><span data-stu-id="aa6ca-212">For [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]:</span></span><br /><br /> <span data-ttu-id="aa6ca-213">使用 TCP/IP 通訊協定時，連接會成功，否則會失敗。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-213">The connection succeeds if you are using the TCP/IP protocol, otherwise it fails.</span></span><br /><br /> <span data-ttu-id="aa6ca-214">如果是 XML：</span><span class="sxs-lookup"><span data-stu-id="aa6ca-214">For XML:</span></span><br /><br /> <span data-ttu-id="aa6ca-215">使用資料庫認證時，會使報表伺服器上的連接失敗。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-215">Fail the connection on the report server if database credentials are used.</span></span>|  
|<span data-ttu-id="aa6ca-216">None</span><span class="sxs-lookup"><span data-stu-id="aa6ca-216">None</span></span>|<span data-ttu-id="aa6ca-217">模擬自動執行帳戶。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-217">Impersonate the unattended execution account.</span></span>|<span data-ttu-id="aa6ca-218">若為 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]、Oracle、ODBC 和 OLE DB：</span><span class="sxs-lookup"><span data-stu-id="aa6ca-218">For [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], Oracle, ODBC, and OLE DB:</span></span><br /><br /> <span data-ttu-id="aa6ca-219">使用連接字串中定義的認證。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-219">Use the credentials defined in the connection string.</span></span> <span data-ttu-id="aa6ca-220">如果未定義自動執行帳戶，報表伺服器上的連接會失敗。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-220">The connection fails on the report server if the unattended execution account is undefined.</span></span><br /><br /> <span data-ttu-id="aa6ca-221">針對 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]：</span><span class="sxs-lookup"><span data-stu-id="aa6ca-221">For [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]:</span></span><br /><br /> <span data-ttu-id="aa6ca-222">指定無認證或定義自動執行帳戶時，永遠會使連接失敗。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-222">Always fail the connection if no credentials are specified, even if the unattended execution account is defined.</span></span><br /><br /> <span data-ttu-id="aa6ca-223">如果是 XML：</span><span class="sxs-lookup"><span data-stu-id="aa6ca-223">For XML:</span></span><br /><br /> <span data-ttu-id="aa6ca-224">如果已定義自動執行帳戶，則以匿名使用者連接；否則會使連接失敗。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-224">Connect as Anonymous User if the unattended execution account is defined; otherwise, fail the connection.</span></span>|  
  
## <a name="setting-credentials-programmatically"></a><span data-ttu-id="aa6ca-225">以設計程式的方式設定認證</span><span class="sxs-lookup"><span data-stu-id="aa6ca-225">Setting Credentials Programmatically</span></span>  
 <span data-ttu-id="aa6ca-226">您可以在您的程式碼中設定認證，來控制報表和報表伺服器的存取。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-226">You can set credentials in your code to control access to reports and to the report server.</span></span> <span data-ttu-id="aa6ca-227">如需詳細資訊，請參閱 [資料來源和連接方法](../report-server-web-service/methods/data-sources-and-connection-methods.md)。</span><span class="sxs-lookup"><span data-stu-id="aa6ca-227">For more information, see [Data Sources and Connection Methods](../report-server-web-service/methods/data-sources-and-connection-methods.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="aa6ca-228">另請參閱</span><span class="sxs-lookup"><span data-stu-id="aa6ca-228">See Also</span></span>  
 <span data-ttu-id="aa6ca-229">[Reporting Services &#40;SSRS 支援的資料來源&#41;](../create-deploy-and-manage-mobile-and-paginated-reports.md) </span><span class="sxs-lookup"><span data-stu-id="aa6ca-229">[Data Sources Supported by Reporting Services &#40;SSRS&#41;](../create-deploy-and-manage-mobile-and-paginated-reports.md) </span></span>  
 <span data-ttu-id="aa6ca-230">[Reporting Services 中的資料連線、資料來源及連接字串](../data-connections-data-sources-and-connection-strings-in-reporting-services.md) </span><span class="sxs-lookup"><span data-stu-id="aa6ca-230">[Data Connections, Data Sources, and Connection Strings in Reporting Services](../data-connections-data-sources-and-connection-strings-in-reporting-services.md) </span></span>  
 <span data-ttu-id="aa6ca-231">[管理報表資料來源](../../integration-services/connection-manager/data-sources.md) </span><span class="sxs-lookup"><span data-stu-id="aa6ca-231">[Manage Report Data Sources](../../integration-services/connection-manager/data-sources.md) </span></span>  
 <span data-ttu-id="aa6ca-232">[報表管理員 &#40;SSRS 原生模式&#41;](../report-manager-ssrs-native-mode.md) </span><span class="sxs-lookup"><span data-stu-id="aa6ca-232">[Report Manager  &#40;SSRS Native Mode&#41;](../report-manager-ssrs-native-mode.md) </span></span>  
 <span data-ttu-id="aa6ca-233">[建立、刪除或修改共用資料來源 &#40;報表管理員&#41;](../create-delete-or-modify-a-shared-data-source-report-manager.md) </span><span class="sxs-lookup"><span data-stu-id="aa6ca-233">[Create, Delete, or Modify a Shared Data Source &#40;Report Manager&#41;](../create-delete-or-modify-a-shared-data-source-report-manager.md) </span></span>  
 [<span data-ttu-id="aa6ca-234">設定報表的資料來源屬性 &#40;報表管理員&#41;</span><span class="sxs-lookup"><span data-stu-id="aa6ca-234">Configure Data Source Properties for a Report  &#40;Report Manager&#41;</span></span>](configure-data-source-properties-for-a-report-report-manager.md)  
  
  
