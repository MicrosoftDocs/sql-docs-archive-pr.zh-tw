---
title: 運算式對話方塊 |Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
f1_keywords:
- "10040"
- sql12.rtp.rptdesigner.expression.f1
helpviewer_keywords:
- Expression dialog box [Reporting Services]
ms.assetid: e6c74ccb-4594-4d4f-b958-618d710e34eb
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 241939efe7e56c77adf7f7ab0407b7222908329e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87687542"
---
# <a name="expression-dialog-box"></a><span data-ttu-id="9b400-102">運算式對話方塊</span><span class="sxs-lookup"><span data-stu-id="9b400-102">Expression Dialog Box</span></span>
  <span data-ttu-id="9b400-103">使用 [**運算式**] 對話方塊可為 [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[vbprvb](../includes/vbprvb-md.md)] 報表專案屬性撰寫運算式。</span><span class="sxs-lookup"><span data-stu-id="9b400-103">Use the **Expression** dialog box to write [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[vbprvb](../includes/vbprvb-md.md)] expressions for report item properties.</span></span> <span data-ttu-id="9b400-104">您可以使用運算式來設定許多屬性，包含色彩、字型和框線等。</span><span class="sxs-lookup"><span data-stu-id="9b400-104">You can use expressions to set many properties, including color, font, and borders.</span></span> <span data-ttu-id="9b400-105">在執行階段，報表處理器會評估運算式並取代屬性值的結果。</span><span class="sxs-lookup"><span data-stu-id="9b400-105">At run time, the report processor evaluates expressions and substitutes the result for the value of the property.</span></span>  
  
 <span data-ttu-id="9b400-106">運算式可能很簡單或很複雜。</span><span class="sxs-lookup"><span data-stu-id="9b400-106">An expression can be simple or complex.</span></span> <span data-ttu-id="9b400-107">您可以在設計介面上或對話方塊中的文字方塊中，直接輸入簡單的運算式。</span><span class="sxs-lookup"><span data-stu-id="9b400-107">You can type simple expressions directly in a text box on the design surface or in a dialog box.</span></span> <span data-ttu-id="9b400-108">若要建立複雜運算式，請使用 [**運算式**] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="9b400-108">To create complex expressions, use the **Expression** dialog box.</span></span> <span data-ttu-id="9b400-109">您可以一次建立一個運算式。</span><span class="sxs-lookup"><span data-stu-id="9b400-109">You can create one expression at a time.</span></span> <span data-ttu-id="9b400-110">如需詳細資訊，請參閱[運算式 &#40;報表產生器及 SSRS&#41;](report-design/expressions-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="9b400-110">For more information, see [Expressions &#40;Report Builder and SSRS&#41;](report-design/expressions-report-builder-and-ssrs.md).</span></span>  
  
 <span data-ttu-id="9b400-111">若要開啟 [運算式]\*\*\*\* 對話方塊，請按一下對話方塊中的 [運算式] (**fx**) 按鈕，或從 [屬性] 窗格的快速鍵功能表或下拉式清單選取 [運算式]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="9b400-111">To open the **Expression** dialog box, click the Expression (**fx**) button in dialog boxes, or select **Expression** from the shortcut menu or drop-down lists in the Properties pane.</span></span> <span data-ttu-id="9b400-112">如需詳細資訊，請參閱[&#40;報表產生器和 SSRS&#41;報表中的運算式使用](report-design/expression-uses-in-reports-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="9b400-112">For more information, see [Expression Uses in Reports &#40;Report Builder and SSRS&#41;](report-design/expression-uses-in-reports-report-builder-and-ssrs.md).</span></span>  
  
 <span data-ttu-id="9b400-113">[運算式]\*\*\*\* 對話方塊包含程式碼視窗、類別目錄樹狀結構、類別目錄項目、描述窗格和範例窗格。</span><span class="sxs-lookup"><span data-stu-id="9b400-113">The **Expression** dialog box includes a code window, category tree, category items, description pane, and example pane.</span></span>  
  
 <span data-ttu-id="9b400-114">[運算式]\*\*\*\* 對話方塊會區分內容。類別目錄項目和描述會根據您正在處理的運算式類別目錄而變更。</span><span class="sxs-lookup"><span data-stu-id="9b400-114">The **Expression** dialog box is context-sensitive; the category items and descriptions change according to the expression category that you are working with.</span></span> <span data-ttu-id="9b400-115">它支援 IntelliSense、陳述式完成、函數呼叫範例和語法著色，讓您能夠輕易偵測出語法錯誤。</span><span class="sxs-lookup"><span data-stu-id="9b400-115">It supports IntelliSense, statement completions, function call examples, and syntax coloring to help you detect syntax errors.</span></span>  
  
## <a name="expression-constructs"></a><span data-ttu-id="9b400-116">運算式建構</span><span class="sxs-lookup"><span data-stu-id="9b400-116">Expression Constructs</span></span>  
 <span data-ttu-id="9b400-117">運算式是以等號 (=) 開始，可以包含常數、常值、運算子，以及內建欄位、內建集合、內建函數、 [!INCLUDE[vbprvb](../includes/vbprvb-md.md)] 執行階段程式庫函數、 [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] Common Language Runtime 類別和自訂函數的參考。</span><span class="sxs-lookup"><span data-stu-id="9b400-117">Expressions begin with an equal sign (=) and can include constants, literals, operators, and references to built-in fields, built-in collections, built-in functions, [!INCLUDE[vbprvb](../includes/vbprvb-md.md)] run-time library functions, [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] common language runtime classes, and custom functions.</span></span> <span data-ttu-id="9b400-118">下列清單描述可加入運算式的類別目錄和值。</span><span class="sxs-lookup"><span data-stu-id="9b400-118">The following list describes the categories and values you can add to an expression.</span></span>  
  
 <span data-ttu-id="9b400-119">**設定運算式：**  _\<PropertyName>_</span><span class="sxs-lookup"><span data-stu-id="9b400-119">**Set expression for:**  _\<PropertyName>_</span></span>  
 <span data-ttu-id="9b400-120">為其定義運算式的屬性名稱。</span><span class="sxs-lookup"><span data-stu-id="9b400-120">The name of the property that you are defining an expression for.</span></span> <span data-ttu-id="9b400-121">您也可以在 [屬性] 窗格中依名稱設定這個屬性。</span><span class="sxs-lookup"><span data-stu-id="9b400-121">You can also set this property, by name, in the Properties pane.</span></span>  
  
 <span data-ttu-id="9b400-122">**常數**</span><span class="sxs-lookup"><span data-stu-id="9b400-122">**Constants**</span></span>  
 <span data-ttu-id="9b400-123">針對以常數為基礎的屬性，提供對此屬性有效之預先定義值的清單。</span><span class="sxs-lookup"><span data-stu-id="9b400-123">Provides a list of predefined values valid for this property for properties that are based on constants.</span></span> <span data-ttu-id="9b400-124">例如，以色彩為基礎的屬性會顯示有效的色彩名稱。</span><span class="sxs-lookup"><span data-stu-id="9b400-124">For example, a property based on color shows valid color names.</span></span> <span data-ttu-id="9b400-125">對於是布林資料類型的屬性而言，值為 `True` 和 `False`。</span><span class="sxs-lookup"><span data-stu-id="9b400-125">For a property that is a Boolean data type, values are `True` and `False`.</span></span>  
  
 <span data-ttu-id="9b400-126">並非所有支援運算式的項目都可設為常數。</span><span class="sxs-lookup"><span data-stu-id="9b400-126">Not all items that support expressions can be set to a constant.</span></span> <span data-ttu-id="9b400-127">如果屬性無法設為常數值，描述窗格會提供這項資訊。</span><span class="sxs-lookup"><span data-stu-id="9b400-127">If a property cannot be set to constant value, the description pane provides this information.</span></span>  
  
 <span data-ttu-id="9b400-128">**內建欄位**</span><span class="sxs-lookup"><span data-stu-id="9b400-128">**Built-in Fields**</span></span>  
 <span data-ttu-id="9b400-129">提供全域集合裡您可以在運算式中使用之項目的清單。</span><span class="sxs-lookup"><span data-stu-id="9b400-129">Provides a list of the items in the global collection that you can use in an expression.</span></span> <span data-ttu-id="9b400-130">有些集合只有在報表發行至伺服器後，才受到支援。</span><span class="sxs-lookup"><span data-stu-id="9b400-130">Some collections are only supported after the report is published to the server.</span></span> <span data-ttu-id="9b400-131">如需詳細資訊，請參閱[內建的全域和使用者參考 &#40;報表產生器及 SSRS&#41;](report-design/built-in-collections-built-in-globals-and-users-references-report-builder.md)。</span><span class="sxs-lookup"><span data-stu-id="9b400-131">For more information, see [Built-in Globals and Users References &#40;Report Builder and SSRS&#41;](report-design/built-in-collections-built-in-globals-and-users-references-report-builder.md).</span></span>  
  
 <span data-ttu-id="9b400-132">**參數**</span><span class="sxs-lookup"><span data-stu-id="9b400-132">**Parameters**</span></span>  
 <span data-ttu-id="9b400-133">提供報表參數清單。</span><span class="sxs-lookup"><span data-stu-id="9b400-133">Provides a list of report parameters.</span></span>  
  
 <span data-ttu-id="9b400-134">**欄位 (** _\<selected Dataset>_\*\*) \*\*</span><span class="sxs-lookup"><span data-stu-id="9b400-134">**Fields(** _\<selected Dataset>_ **)**</span></span>  
 <span data-ttu-id="9b400-135">顯示在 [資料集] 類別目錄中所選取之資料集的欄位清單。</span><span class="sxs-lookup"><span data-stu-id="9b400-135">Displays the list of fields for the dataset selected in the Datasets category.</span></span> <span data-ttu-id="9b400-136">按兩下欄位，即可將欄位複製至 [運算式]\*\*\*\* 方塊。</span><span class="sxs-lookup"><span data-stu-id="9b400-136">Double-click a field to copy the field to the **Expression** box.</span></span>  
  
 <span data-ttu-id="9b400-137">**資料集**</span><span class="sxs-lookup"><span data-stu-id="9b400-137">**Datasets**</span></span>  
 <span data-ttu-id="9b400-138">提供可用資料集的清單，並顯示做為資料集之成員的欄位。</span><span class="sxs-lookup"><span data-stu-id="9b400-138">Provides a list of available datasets and shows the fields that are members of the dataset.</span></span>  
  
 <span data-ttu-id="9b400-139">**變數**</span><span class="sxs-lookup"><span data-stu-id="9b400-139">**Variables**</span></span>  
 <span data-ttu-id="9b400-140">顯示報表變數的清單。</span><span class="sxs-lookup"><span data-stu-id="9b400-140">Displays a list of report variables.</span></span> <span data-ttu-id="9b400-141">如需詳細資訊，請參閱[報表和群組變數集合參考 &#40;報表產生器及 SSRS&#41;](report-design/built-in-collections-report-and-group-variables-references-report-builder.md)。</span><span class="sxs-lookup"><span data-stu-id="9b400-141">For more information, see [Report and Group Variables Collections References &#40;Report Builder and SSRS&#41;](report-design/built-in-collections-report-and-group-variables-references-report-builder.md).</span></span>  
  
 <span data-ttu-id="9b400-142">**運算子**</span><span class="sxs-lookup"><span data-stu-id="9b400-142">**Operators**</span></span>  
 <span data-ttu-id="9b400-143">顯示您可以包含在計算或字串操作中的運算子。</span><span class="sxs-lookup"><span data-stu-id="9b400-143">Displays the operators you can include in a calculation or string manipulation.</span></span> <span data-ttu-id="9b400-144">如需詳細資訊，請參閱[運算式中的運算子 &#40;報表產生器及 SSRS&#41;](report-design/operators-in-expressions-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="9b400-144">For more information, see [Operators in Expressions &#40;Report Builder and SSRS&#41;](report-design/operators-in-expressions-report-builder-and-ssrs.md).</span></span>  
  
 <span data-ttu-id="9b400-145">**一般功能**</span><span class="sxs-lookup"><span data-stu-id="9b400-145">**Common Functions**</span></span>  
 <span data-ttu-id="9b400-146">顯示一般函數，依類型分組。</span><span class="sxs-lookup"><span data-stu-id="9b400-146">Displays common functions, grouped by type.</span></span> <span data-ttu-id="9b400-147">當您在 [項目] 窗格中選取函數時，描述及範例就會顯示。</span><span class="sxs-lookup"><span data-stu-id="9b400-147">When you select a function in the Item pane, a description and example appear.</span></span>  
  
 <span data-ttu-id="9b400-148">一般函數包含內建報表和彙總函式、[!INCLUDE[vbprvb](../includes/vbprvb-md.md)] 執行階段程式庫函數，以及 <xref:System.Math> 和 <xref:System.Convert> 命名空間中的 [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] Common Language Runtime (CLR) 類別。</span><span class="sxs-lookup"><span data-stu-id="9b400-148">Common functions include built-in report and aggregate functions, [!INCLUDE[vbprvb](../includes/vbprvb-md.md)] run-time library functions, and [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] common language runtime classes (CLR) in the <xref:System.Math> and <xref:System.Convert> namespace.</span></span> <span data-ttu-id="9b400-149">您也可以加入未出現在類別目錄清單中的 CLR 類別以及外部組件的參考。</span><span class="sxs-lookup"><span data-stu-id="9b400-149">You can also add references to CLR classes and external assemblies that do not appear in the category list.</span></span> <span data-ttu-id="9b400-150">如需詳細資訊，請參閱 [報表設計師中運算式的自訂程式碼及組件參考 &#40;SSRS&#41;](report-design/custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="9b400-150">For more information, see [Custom Code and Assembly References in Expressions in Report Designer &#40;SSRS&#41;](report-design/custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md).</span></span>  
  
## <a name="options"></a><span data-ttu-id="9b400-151">選項</span><span class="sxs-lookup"><span data-stu-id="9b400-151">Options</span></span>  
 <span data-ttu-id="9b400-152">程式碼視窗</span><span class="sxs-lookup"><span data-stu-id="9b400-152">Code window</span></span>  
 <span data-ttu-id="9b400-153">使用上方窗格中的程式碼視窗，來輸入運算式。</span><span class="sxs-lookup"><span data-stu-id="9b400-153">Use the code window in the top pane to type an expression.</span></span> <span data-ttu-id="9b400-154">當您開啟 [運算式]\*\*\*\* 對話方塊時，程式碼視窗會包含運算式。</span><span class="sxs-lookup"><span data-stu-id="9b400-154">When you open the **Expression** dialog box, the code window contains the expression.</span></span> <span data-ttu-id="9b400-155">您可以取代或修訂運算式。</span><span class="sxs-lookup"><span data-stu-id="9b400-155">You can replace or revise the expression.</span></span> <span data-ttu-id="9b400-156">您可以加入函數呼叫、運算子、常數、欄位、參數、全域集合的項目以及自訂程式碼的參考。</span><span class="sxs-lookup"><span data-stu-id="9b400-156">You can add function calls, operators, constants, fields, parameters, items from the global collections, and references to custom code.</span></span> <span data-ttu-id="9b400-157">程式碼視窗會在您進行變更時顯示出變更。</span><span class="sxs-lookup"><span data-stu-id="9b400-157">The code window displays your changes as you make them.</span></span>  
  
 <span data-ttu-id="9b400-158">波浪式紅色底線指出發生語法錯誤。</span><span class="sxs-lookup"><span data-stu-id="9b400-158">A wavy red underline indicates a syntax error.</span></span> <span data-ttu-id="9b400-159">把滑鼠游標暫留在加底線文字上方，以查看錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="9b400-159">Hover over the underlined text to see the error message.</span></span>  
  
 <span data-ttu-id="9b400-160">輸入後面接有標點符號分隔符號的全域集合詞彙時，您會看到可用成員或屬性的下拉式清單。</span><span class="sxs-lookup"><span data-stu-id="9b400-160">When you type in global collection terms followed by a punctuation separator, you will see a drop-down list of available members or properties.</span></span> <span data-ttu-id="9b400-161">從下拉式清單中，您可輸入後面接有 Tab 的前幾個字元，以自動填入選項。</span><span class="sxs-lookup"><span data-stu-id="9b400-161">From the drop-down list, you can type the first few characters followed by a tab to automatically fill the selection.</span></span>  
  
 <span data-ttu-id="9b400-162">輸入函數名稱且在後面加上左括號時，您會看到工具提示提供有關參數和函數傳回值的資訊。</span><span class="sxs-lookup"><span data-stu-id="9b400-162">When you type in a function name followed by a left parenthesis, you will see a tooltip that provides information about the parameters and function return values.</span></span>  
  
 <span data-ttu-id="9b400-163">**類別**</span><span class="sxs-lookup"><span data-stu-id="9b400-163">**Category**</span></span>  
 <span data-ttu-id="9b400-164">顯示運算式的類別目錄。</span><span class="sxs-lookup"><span data-stu-id="9b400-164">Displays categories of expressions.</span></span> <span data-ttu-id="9b400-165">選擇類別目錄會為運算式的建立奠立內容，並會變更 [項目] 窗格中的有效值清單。</span><span class="sxs-lookup"><span data-stu-id="9b400-165">Choosing a category establishes a context for creating an expression and changes the list of valid values in the Item pane.</span></span> <span data-ttu-id="9b400-166">例如，針對文字方塊值的運算式，展開 [一般函數]，然後選取 [彙總函式 `Avg` ]，以顯示、 `Count` 和 [**專案**] 窗格中的其他函數。</span><span class="sxs-lookup"><span data-stu-id="9b400-166">For example, for an expression for a text box value, expand Common functions and select Aggregate functions to display `Avg`, `Count`, and other functions in the **Item** pane.</span></span>  
  
 <span data-ttu-id="9b400-167">**Item**</span><span class="sxs-lookup"><span data-stu-id="9b400-167">**Item**</span></span>  
 <span data-ttu-id="9b400-168">顯示所選取類別目錄的有效值清單。</span><span class="sxs-lookup"><span data-stu-id="9b400-168">Displays the list of valid values for the selected category.</span></span> <span data-ttu-id="9b400-169">請在項目上按兩下，以在程式碼視窗中的插入點加入這個項目的運算式文字。</span><span class="sxs-lookup"><span data-stu-id="9b400-169">Double-click on an item to add the expression text for this item at the insertion point in the code window.</span></span>  
  
 <span data-ttu-id="9b400-170">**值**</span><span class="sxs-lookup"><span data-stu-id="9b400-170">**Values**</span></span>  
 <span data-ttu-id="9b400-171">第三個窗格會包含描述、範例運算式或有效值清單，依您選取的類別目錄和項目而定。</span><span class="sxs-lookup"><span data-stu-id="9b400-171">Depending on the category and item you select, the third pane contains a description, a sample expression, or a list of valid values.</span></span> <span data-ttu-id="9b400-172">拖曳對話方塊的邊緣可加寬範例區域。</span><span class="sxs-lookup"><span data-stu-id="9b400-172">Drag the edge of the dialog box to widen the sample area.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9b400-173">另請參閱</span><span class="sxs-lookup"><span data-stu-id="9b400-173">See Also</span></span>  
 <span data-ttu-id="9b400-174">[運算式 &#40;報表產生器及 SSRS&#41;](report-design/expressions-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="9b400-174">[Expressions &#40;Report Builder and SSRS&#41;](report-design/expressions-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="9b400-175">[運算式範例 &#40;報表產生器及 SSRS&#41;](report-design/expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="9b400-175">[Expression Examples &#40;Report Builder and SSRS&#41;](report-design/expression-examples-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="9b400-176">[運算式用於報表 &#40;報表產生器和 SSRS&#41;](report-design/expression-uses-in-reports-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="9b400-176">[Expression Uses in Reports &#40;Report Builder and SSRS&#41;](report-design/expression-uses-in-reports-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="9b400-177">[將數位和日期格式化 &#40;報表產生器和 SSRS&#41;](report-design/formatting-numbers-and-dates-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="9b400-177">[Formatting Numbers and Dates &#40;Report Builder and SSRS&#41;](report-design/formatting-numbers-and-dates-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="9b400-178">[參數集合參考 &#40;報表產生器和 SSRS&#41;](report-design/built-in-collections-parameters-collection-references-report-builder.md) </span><span class="sxs-lookup"><span data-stu-id="9b400-178">[Parameters Collection References &#40;Report Builder and SSRS&#41;](report-design/built-in-collections-parameters-collection-references-report-builder.md) </span></span>  
 <span data-ttu-id="9b400-179">[群組運算式範例 &#40;報表產生器和 SSRS&#41;](report-design/group-expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="9b400-179">[Group Expression Examples &#40;Report Builder and SSRS&#41;](report-design/group-expression-examples-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="9b400-180">[篩選方程式範例 &#40;報表產生器和 SSRS&#41;](report-design/filter-equation-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="9b400-180">[Filter Equation Examples &#40;Report Builder and SSRS&#41;](report-design/filter-equation-examples-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="9b400-181">[運算式中的資料類型 &#40;報表產生器和 SSRS&#41;](report-design/data-types-in-expressions-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="9b400-181">[Data Types in Expressions &#40;Report Builder and SSRS&#41;](report-design/data-types-in-expressions-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="9b400-182">[運算式中的內建集合 &#40;報表產生器和 SSRS&#41;](report-design/built-in-collections-in-expressions-report-builder.md) </span><span class="sxs-lookup"><span data-stu-id="9b400-182">[Built-in Collections in Expressions &#40;Report Builder and SSRS&#41;](report-design/built-in-collections-in-expressions-report-builder.md) </span></span>  
 [<span data-ttu-id="9b400-183">加入運算式 &#40;報表產生器及 SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="9b400-183">Add an Expression &#40;Report Builder and SSRS&#41;</span></span>](report-design/add-an-expression-report-builder-and-ssrs.md)  
  
  
