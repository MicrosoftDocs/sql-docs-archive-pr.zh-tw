---
title: 排程 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- schedules [Reporting Services]
- schedules [Reporting Services], about schedules
- published reports [Reporting Services], schedules
- reports [Reporting Services], scheduling
- subscriptions [Reporting Services], scheduling
- automatic report processing
ms.assetid: ecccd16b-eba9-4e95-b55d-f15c621e003f
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 99bcfbf6559c0f3b59bede54eae6224b4973797b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87706997"
---
# <a name="schedules"></a><span data-ttu-id="a320e-102">排程</span><span class="sxs-lookup"><span data-stu-id="a320e-102">Schedules</span></span>
  <span data-ttu-id="a320e-103"> 會提供共用排程和報表特定排程來協助您控制報表的處理和散發。</span><span class="sxs-lookup"><span data-stu-id="a320e-103">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] provides shared schedules and report-specific schedules to help you control processing and distribution of reports.</span></span> <span data-ttu-id="a320e-104">這兩種排程類型之間的差異是定義、儲存和管理它們的方式。</span><span class="sxs-lookup"><span data-stu-id="a320e-104">The difference between the two types of schedules is how they are defined, stored, and managed.</span></span> <span data-ttu-id="a320e-105">兩種排程類型的內部建構則相同。</span><span class="sxs-lookup"><span data-stu-id="a320e-105">The internal construction of the two types of schedules is the same.</span></span> <span data-ttu-id="a320e-106">所有排程都會指定一個循環類型：每月、每週或每日。</span><span class="sxs-lookup"><span data-stu-id="a320e-106">All schedules specify a type of recurrence: monthly, weekly, or daily.</span></span> <span data-ttu-id="a320e-107">在循環類型內，您可以設定發生事件之頻率的間隔和範圍。</span><span class="sxs-lookup"><span data-stu-id="a320e-107">Within the recurrence type, you set the intervals and range for how often an event is to occur.</span></span> <span data-ttu-id="a320e-108">不論您是建立共用排程還是報表特定排程，循環模式的類型和指定這些模式的方式相同。</span><span class="sxs-lookup"><span data-stu-id="a320e-108">The type of recurrence pattern and how those patterns are specified is the same whether you create a shared schedule or a report-specific schedule.</span></span>  
  
 <span data-ttu-id="a320e-109">本主題內容：</span><span class="sxs-lookup"><span data-stu-id="a320e-109">In this topic:</span></span>  
  
-   [<span data-ttu-id="a320e-110">您可以使用排程執行的工作</span><span class="sxs-lookup"><span data-stu-id="a320e-110">What you can do with Schedules</span></span>](#bkmk_whatyoucando)  
  
-   [<span data-ttu-id="a320e-111">比較共用和報表特定排程</span><span class="sxs-lookup"><span data-stu-id="a320e-111">Comparing Shared and Report-Specific Schedules</span></span>](#bkmk_compare)  
  
-   [<span data-ttu-id="a320e-112">設定資料來源</span><span class="sxs-lookup"><span data-stu-id="a320e-112">Configure the Data Sources</span></span>](#bkmk_configuredatasources)  
  
-   [<span data-ttu-id="a320e-113">儲存認證和處理帳戶</span><span class="sxs-lookup"><span data-stu-id="a320e-113">Store Credentials and Processing accounts</span></span>](#bkmk_credentials)  
  
-   [<span data-ttu-id="a320e-114">排程和傳遞處理的運作方式</span><span class="sxs-lookup"><span data-stu-id="a320e-114">How Scheduling and Delivery Processing Works</span></span>](#bkmk_how_scheduling_works)  
  
-   [<span data-ttu-id="a320e-115">伺服器相依性</span><span class="sxs-lookup"><span data-stu-id="a320e-115">Server Dependencies</span></span>](#bkmk_serverdependencies)  
  
-   [<span data-ttu-id="a320e-116">停止 SQL Server Agent 的影響</span><span class="sxs-lookup"><span data-stu-id="a320e-116">Effects of Stopping the SQL Server Agent</span></span>](#bkmk_stoppingagent)  
  
-   [<span data-ttu-id="a320e-117">停止報表伺服器服務的影響</span><span class="sxs-lookup"><span data-stu-id="a320e-117">Effects of Stopping the Report Server Service</span></span>](#bkmk_stoppingservice)  
  
  
##  <a name="what-you-can-do-with-schedules"></a><a name="bkmk_whatyoucando"></a> <span data-ttu-id="a320e-118">可以使用排程執行的工作</span><span class="sxs-lookup"><span data-stu-id="a320e-118">What you can do with Schedules</span></span>  
 <span data-ttu-id="a320e-119">您可以在原生模式下使用報表管理員以及在 SharePoint 模式下使用 SharePoint 網站管理頁面，以建立及管理您的排程。</span><span class="sxs-lookup"><span data-stu-id="a320e-119">You can use Report Manager in Native mode and SharePoint site administration pages in SharePoint mode to create and manage your schedules.</span></span> <span data-ttu-id="a320e-120">您可以：</span><span class="sxs-lookup"><span data-stu-id="a320e-120">You can:</span></span>  
  
-   <span data-ttu-id="a320e-121">以標準訂閱或資料驅動訂閱的方式，排程報表的傳遞。</span><span class="sxs-lookup"><span data-stu-id="a320e-121">Schedule report delivery in a standard or data-driven subscription.</span></span>  
  
-   <span data-ttu-id="a320e-122">排程報表記錄，好讓新的快照集能夠在固定的週期加入至報表記錄中。</span><span class="sxs-lookup"><span data-stu-id="a320e-122">Schedule report history so that new snapshots are added to report history at regular intervals.</span></span>  
  
-   <span data-ttu-id="a320e-123">排程何時重新整理報表快照集的資料。</span><span class="sxs-lookup"><span data-stu-id="a320e-123">Schedule when to refresh the data of a report snapshot.</span></span>  
  
-   <span data-ttu-id="a320e-124">排程何時重新整理共用資料集的資料</span><span class="sxs-lookup"><span data-stu-id="a320e-124">Schedule when to refresh the data of a shared dataset</span></span>  
  
-   <span data-ttu-id="a320e-125">排程在預先定義的時間讓快取報表或共用資料集過期，以便之後可以重新整理。</span><span class="sxs-lookup"><span data-stu-id="a320e-125">Schedule the expiration of a cached report or shared dataset to occur at a predefined time so that it can be subsequently refreshed.</span></span>  
  
 <span data-ttu-id="a320e-126">如果您想要針對許多報表或訂閱使用相同的排程資訊，可以建立共用排程。</span><span class="sxs-lookup"><span data-stu-id="a320e-126">You can create a shared schedule if you want to use the same schedule information for many reports or subscriptions.</span></span> <span data-ttu-id="a320e-127">共用排程是分開定義的，然後再從需要排程資訊的報表、共用資料集與訂閱中參考。</span><span class="sxs-lookup"><span data-stu-id="a320e-127">Shared schedules are defined separately, and then referenced in reports, shared datasets, and subscriptions that need schedule information.</span></span>  
  
 <span data-ttu-id="a320e-128">當您建立排程時，報表會將排程資訊儲存在報表伺服器資料庫中；如果是 SharePoint 模式，則會儲存在服務應用程式資料庫中。</span><span class="sxs-lookup"><span data-stu-id="a320e-128">When you create a schedule, the report saves the schedule information in the report server database or for SharePoint mode, the service application database.</span></span> <span data-ttu-id="a320e-129">報表伺服器也會建立用來觸發排程的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 作業。</span><span class="sxs-lookup"><span data-stu-id="a320e-129">The report server also creates a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job that is used to trigger the schedule.</span></span> <span data-ttu-id="a320e-130">排程的處理會依據包含該排程之報表伺服器的本地時間。</span><span class="sxs-lookup"><span data-stu-id="a320e-130">Schedule processing is based on the local time of the report server that contains the schedule.</span></span> <span data-ttu-id="a320e-131">時間的格式會依照 [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows 作業系統的標準。</span><span class="sxs-lookup"><span data-stu-id="a320e-131">The time format follows the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows operating system standard.</span></span>  
  
 <span data-ttu-id="a320e-132">如需如何建立及管理排程的詳細資訊，請參閱＜ [Create, Modify, and Delete Schedules](create-modify-and-delete-schedules.md)＞。</span><span class="sxs-lookup"><span data-stu-id="a320e-132">For details on how to create and manage schedules, see [Create, Modify, and Delete Schedules](create-modify-and-delete-schedules.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a320e-133">並非所有 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]版本都提供排程作業。</span><span class="sxs-lookup"><span data-stu-id="a320e-133">Schedule operations are not available in every edition of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="a320e-134">如需版本支援的功能清單 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ，請參閱[SQL Server 2012 (版本支援的功能](https://go.microsoft.com/fwlink/?linkid=232473) https://go.microsoft.com/fwlink/?linkid=232473) 。</span><span class="sxs-lookup"><span data-stu-id="a320e-134">For a list of features that are supported by the editions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], see [Features Supported by the Editions of SQL Server 2012](https://go.microsoft.com/fwlink/?linkid=232473) (https://go.microsoft.com/fwlink/?linkid=232473).</span></span>  
  
##  <a name="comparing-shared-and-report-specific-schedules"></a><a name="bkmk_compare"></a> <span data-ttu-id="a320e-135">比較共用排程與報表特定排程</span><span class="sxs-lookup"><span data-stu-id="a320e-135">Comparing Shared and Report-Specific Schedules</span></span>  
 <span data-ttu-id="a320e-136">這兩種排程類型會產生相同的輸出：</span><span class="sxs-lookup"><span data-stu-id="a320e-136">Both types of schedules yield the same output:.</span></span>  
  
-   <span data-ttu-id="a320e-137">**共用排程** 是多用途的可攜式項目，包含立即可用的排程資訊。</span><span class="sxs-lookup"><span data-stu-id="a320e-137">**Shared schedules** are portable, multipurpose items that contain ready-to-use schedule information.</span></span> <span data-ttu-id="a320e-138">因為共用排程是系統層級項目，所以建立共用排程需要系統層級權限。</span><span class="sxs-lookup"><span data-stu-id="a320e-138">Because shared schedules are system-level items, creating a shared schedule requires system-level permissions.</span></span> <span data-ttu-id="a320e-139">基於這個原因，報表伺服器管理員或內容管理員一般會在您的報表伺服器上建立可以使用的共用排程。</span><span class="sxs-lookup"><span data-stu-id="a320e-139">For this reason, a report server administrator or content manager typically creates the shared schedules that are available on your report server.</span></span> <span data-ttu-id="a320e-140">共用排程是在報表伺服器上，使用報表管理員或 SharePoint 網站設定儲存及管理。</span><span class="sxs-lookup"><span data-stu-id="a320e-140">Shared schedules are stored and managed on the report server by using Report Manager or SharePoint site settings.</span></span>  
  
     <span data-ttu-id="a320e-141">與您透過報表、共用資料集或訂閱屬性定義的特定排程相較之下，共用排程比較容易管理和維護，原因如下：</span><span class="sxs-lookup"><span data-stu-id="a320e-141">In contrast with specific schedules that you define through report, shared dataset, or subscription properties, shared schedules are easier to manage and maintain for the following reasons:</span></span>  
  
    -   <span data-ttu-id="a320e-142">如果排程作業的執行間隔過短或與伺服器上的其他處理序發生衝突，您可以從中央位置管理共用排程，以便更容易比較排程屬性和調整頻率與循環模式。</span><span class="sxs-lookup"><span data-stu-id="a320e-142">Shared schedules can be managed from a central location, making it easier to compare schedule properties and adjust frequency and recurrence patterns if scheduled operations are running too close together or conflicting with other processes on your server.</span></span>  
  
    -   <span data-ttu-id="a320e-143">允許您快速地適應運算環境的變更。</span><span class="sxs-lookup"><span data-stu-id="a320e-143">Allows you to quickly adapt to changes in the computing environment.</span></span> <span data-ttu-id="a320e-144">例如，假設您在重新整理資料倉儲後，</span><span class="sxs-lookup"><span data-stu-id="a320e-144">For example, suppose you have a set of reports that run at 4:00 A.M.</span></span> <span data-ttu-id="a320e-145">有一組在上午 4:00 執行的報表。</span><span class="sxs-lookup"><span data-stu-id="a320e-145">after a data warehouse is refreshed.</span></span> <span data-ttu-id="a320e-146">如果資料重新整理作業重新排程或延遲，您就可以透過更新單一共用排程中的排程資訊，輕易地配合該項變更。</span><span class="sxs-lookup"><span data-stu-id="a320e-146">If the data refresh operation is rescheduled or is delayed, you can easily accommodate that change by updating the schedule information in a single shared schedule.</span></span>  
  
    -   <span data-ttu-id="a320e-147">如果您只有使用共用排程，就可以精確地知道進行排程作業的時間。</span><span class="sxs-lookup"><span data-stu-id="a320e-147">If you use only shared schedules, you know precisely when scheduled operations occur.</span></span> <span data-ttu-id="a320e-148">這可在發生效能問題之前，讓您更容易地預期和配合伺服器負載。</span><span class="sxs-lookup"><span data-stu-id="a320e-148">This makes it easier to anticipate and accommodate server loads before performance issues occur.</span></span> <span data-ttu-id="a320e-149">例如，如果您決定要以特定時間排程電腦備份，就可以調整共用排程，以便於不同的時間執行。</span><span class="sxs-lookup"><span data-stu-id="a320e-149">For example, if you decide to schedule computer backups at a specific hour, you can adjust shared schedules to run at different times.</span></span>  
  
-   <span data-ttu-id="a320e-150">**報表特定排程** 會定義在個別報表、訂閱或報表執行作業的內容中，用以決定快取過期或快照集更新。</span><span class="sxs-lookup"><span data-stu-id="a320e-150">**Report-specific schedules** are defined in the context of an individual report, subscription, or report execution operation to determine cache expiration or snapshot updates.</span></span> <span data-ttu-id="a320e-151">當您定義訂閱或設定報表執行屬性時，會以內嵌的方式建立這些排程。</span><span class="sxs-lookup"><span data-stu-id="a320e-151">These schedules are created inline when you define a subscription or set report execution properties.</span></span> <span data-ttu-id="a320e-152">若共用排程未提供您需要的頻率或循環模式，您可以建立報表特定排程。</span><span class="sxs-lookup"><span data-stu-id="a320e-152">You can create a report-specific schedule if a shared schedule does not provide the frequency or recurrence pattern that you need.</span></span> <span data-ttu-id="a320e-153">若要防止報表執行，您必須手動編輯報表特定排程。</span><span class="sxs-lookup"><span data-stu-id="a320e-153">To prevent a report from running, you must edit a report-specific schedule manually.</span></span> <span data-ttu-id="a320e-154">報表特定排程可以由個別的使用者建立。</span><span class="sxs-lookup"><span data-stu-id="a320e-154">Report-specific schedules can be created by individual users.</span></span>  
  
##  <a name="configure-the-data-sources"></a><a name="bkmk_configuredatasources"></a> <span data-ttu-id="a320e-155">設定資料來源</span><span class="sxs-lookup"><span data-stu-id="a320e-155">Configure the Data Sources</span></span>  
 <span data-ttu-id="a320e-156">您必須先將報表資料來源設定成使用預存認證或自動報表處理帳戶，才能排程報表的資料或訂閱處理。</span><span class="sxs-lookup"><span data-stu-id="a320e-156">Before you can schedule data or subscription processing for a report, you must configure the report data source to use stored credentials or the unattended report processing account.</span></span> <span data-ttu-id="a320e-157">如果您使用預存認證，則只能儲存一組認證，而且該組認證將會由所有執行報表的使用者使用。</span><span class="sxs-lookup"><span data-stu-id="a320e-157">If you use stored credentials, you can only store one set of credentials, and they will be used by all users who run the report.</span></span> <span data-ttu-id="a320e-158">預存認證可以是 Windows 使用者帳戶或資料庫使用者帳戶。</span><span class="sxs-lookup"><span data-stu-id="a320e-158">The credentials can be a Windows user account or a database user account.</span></span>  
  
 <span data-ttu-id="a320e-159">自動報表處理帳戶是在報表伺服器上設定的特殊目的帳戶。</span><span class="sxs-lookup"><span data-stu-id="a320e-159">The unattended report processing account is a special-purpose account that is configured on the report server.</span></span> <span data-ttu-id="a320e-160">此帳戶是報表伺服器在排程的作業需要擷取外部檔案或處理時，用來連接遠端電腦的帳戶。</span><span class="sxs-lookup"><span data-stu-id="a320e-160">It is used by the report server to connect to remote computers when a scheduled operation requires the retrieval of an external file or processing.</span></span> <span data-ttu-id="a320e-161">如果您設定此帳戶，即可用它來連接提供資料給報表的外部資料來源。</span><span class="sxs-lookup"><span data-stu-id="a320e-161">If you configure the account, you can use it to connect to external data sources that provide data to a report.</span></span>  
  
 <span data-ttu-id="a320e-162">若要指定預存認證或自動報表處理帳戶，請編輯報表的資料來源屬性。</span><span class="sxs-lookup"><span data-stu-id="a320e-162">To specify stored credentials or the unattended report processing account, edit the data source properties of the report.</span></span> <span data-ttu-id="a320e-163">如果報表使用共用資料來源，則請改為編輯該共用資料來源。</span><span class="sxs-lookup"><span data-stu-id="a320e-163">If the report uses a shared data source, edit the shared data source instead.</span></span>  
  
##  <a name="store-credentials-and-processing-accounts"></a><a name="bkmk_credentials"></a> <span data-ttu-id="a320e-164">儲存認證和處理帳戶</span><span class="sxs-lookup"><span data-stu-id="a320e-164">Store Credentials and Processing accounts</span></span>  
 <span data-ttu-id="a320e-165">您使用排程的方式會視您的角色指派的工作而定。</span><span class="sxs-lookup"><span data-stu-id="a320e-165">How you work with a schedule depends on tasks that are part of your role assignment.</span></span> <span data-ttu-id="a320e-166">如果您要使用預先定義的角色，屬於內容管理員和系統管理員的使用者就可以建立和管理任何排程。</span><span class="sxs-lookup"><span data-stu-id="a320e-166">If you are using predefined roles, users who are Content Managers and System Administrators can create and manage any schedule.</span></span> <span data-ttu-id="a320e-167">如果您使用自訂角色指派，角色指派就必須包括支援排程作業的工作。</span><span class="sxs-lookup"><span data-stu-id="a320e-167">If you use custom role assignments, the role assignment must include tasks that support scheduled operations.</span></span>  
  
|<span data-ttu-id="a320e-168">作法</span><span class="sxs-lookup"><span data-stu-id="a320e-168">To do this</span></span>|<span data-ttu-id="a320e-169">包括這個工作</span><span class="sxs-lookup"><span data-stu-id="a320e-169">Include this task</span></span>|<span data-ttu-id="a320e-170">原生模式預先定義的角色</span><span class="sxs-lookup"><span data-stu-id="a320e-170">Native Mode Predefined roles</span></span>|<span data-ttu-id="a320e-171">SharePoint 模式群組</span><span class="sxs-lookup"><span data-stu-id="a320e-171">SharePoint mode Groups</span></span>|  
|----------------|-----------------------|----------------------------------|----------------------------|  
|<span data-ttu-id="a320e-172">建立、修改或刪除共用排程</span><span class="sxs-lookup"><span data-stu-id="a320e-172">Create, modify, or delete shared schedules</span></span>|<span data-ttu-id="a320e-173">管理共用排程</span><span class="sxs-lookup"><span data-stu-id="a320e-173">Manage shared schedules</span></span>|<span data-ttu-id="a320e-174">系統管理員</span><span class="sxs-lookup"><span data-stu-id="a320e-174">System Administrator</span></span>|<span data-ttu-id="a320e-175">擁有者</span><span class="sxs-lookup"><span data-stu-id="a320e-175">Owners</span></span>|  
|<span data-ttu-id="a320e-176">選取共用排程</span><span class="sxs-lookup"><span data-stu-id="a320e-176">Select shared schedules</span></span>|<span data-ttu-id="a320e-177">檢視共用排程</span><span class="sxs-lookup"><span data-stu-id="a320e-177">View shared schedules</span></span>|<span data-ttu-id="a320e-178">系統使用者</span><span class="sxs-lookup"><span data-stu-id="a320e-178">System User</span></span>|<span data-ttu-id="a320e-179">成員</span><span class="sxs-lookup"><span data-stu-id="a320e-179">Members</span></span>|  
|<span data-ttu-id="a320e-180">建立、修改或刪除使用者自訂訂閱中的報表特定排程</span><span class="sxs-lookup"><span data-stu-id="a320e-180">Create, modify, or delete report-specific schedules in a user-defined subscription</span></span>|<span data-ttu-id="a320e-181">管理個別訂閱</span><span class="sxs-lookup"><span data-stu-id="a320e-181">Manage individual subscriptions</span></span>|<span data-ttu-id="a320e-182">瀏覽器、報表產生器、我的報表和內容管理員</span><span class="sxs-lookup"><span data-stu-id="a320e-182">Browser, Report Builder, My Reports, Content Manager</span></span>|<span data-ttu-id="a320e-183">訪客、成員</span><span class="sxs-lookup"><span data-stu-id="a320e-183">Visitors, Members</span></span>|  
|<span data-ttu-id="a320e-184">建立、修改或刪除所有其他已排程之作業的報表特定排程</span><span class="sxs-lookup"><span data-stu-id="a320e-184">Create, modify, or delete report-specific schedules for all other scheduled operations</span></span>|<span data-ttu-id="a320e-185">管理報表記錄、管理所有訂閱、管理報表</span><span class="sxs-lookup"><span data-stu-id="a320e-185">Manage report history, manage all subscriptions, manage reports</span></span>|<span data-ttu-id="a320e-186">內容管理員</span><span class="sxs-lookup"><span data-stu-id="a320e-186">Content Manager</span></span>|<span data-ttu-id="a320e-187">擁有者</span><span class="sxs-lookup"><span data-stu-id="a320e-187">Owners</span></span>|  
  
 <span data-ttu-id="a320e-188">如需原生模式 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]中安全性的詳細資訊，請參閱 [Predefined Roles](../security/role-definitions-predefined-roles.md)(預先定義的角色)、 [在原生模式報表伺服器上授與權限](../security/granting-permissions-on-a-native-mode-report-server.md) 和 [工作和權限](../security/tasks-and-permissions.md)。</span><span class="sxs-lookup"><span data-stu-id="a320e-188">For more information about security in Native mode [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], see [Predefined Roles](../security/role-definitions-predefined-roles.md), [Granting Permissions on a Native Mode Report Server](../security/granting-permissions-on-a-native-mode-report-server.md) and [Tasks and Permissions](../security/tasks-and-permissions.md).</span></span> <span data-ttu-id="a320e-189">如果是 SharePoint 模式，請參閱＜ [將 Reporting Services 中的角色和工作與 SharePoint 群組和權限做比較](../reporting-services-roles-tasks-vs-sharepoint-groups-permissions.md)＞</span><span class="sxs-lookup"><span data-stu-id="a320e-189">For SharePoint mode, see [Compare Roles and Tasks in Reporting Services to SharePoint Groups and Permissions](../reporting-services-roles-tasks-vs-sharepoint-groups-permissions.md)</span></span>  
  
##  <a name="how-scheduling-and-delivery-processing-works"></a><a name="bkmk_how_scheduling_works"></a> <span data-ttu-id="a320e-190">排程與傳遞處理器的運作方式</span><span class="sxs-lookup"><span data-stu-id="a320e-190">How Scheduling and Delivery Processing Works</span></span>  
 <span data-ttu-id="a320e-191">排程與傳遞處理器提供下列功能：</span><span class="sxs-lookup"><span data-stu-id="a320e-191">The Scheduling and Delivery Processor provides the following functionality:</span></span>  
  
-   <span data-ttu-id="a320e-192">在報表伺服器資料庫中維護事件與通知的佇列。</span><span class="sxs-lookup"><span data-stu-id="a320e-192">Maintains a queue of events and notifications in the report server database.</span></span> <span data-ttu-id="a320e-193">在向外延展部署中，佇列會在部署中的所有報表伺服器間共用。</span><span class="sxs-lookup"><span data-stu-id="a320e-193">In a scale-out deployment, the queue is shared across all of the report servers in the deployment.</span></span>  
  
-   <span data-ttu-id="a320e-194">呼叫報表處理器以執行報表、處理訂閱或清除快取報表。</span><span class="sxs-lookup"><span data-stu-id="a320e-194">Calls the Report Processor to execute reports, process subscriptions, or clear a cached report.</span></span> <span data-ttu-id="a320e-195">因為排程事件而發生的所有報表處理都會當做都會當做背景處理來執行。</span><span class="sxs-lookup"><span data-stu-id="a320e-195">All report processing that occurs as a result of a schedule event is performed as a background process.</span></span> <span data-ttu-id="a320e-196">SharePoint 模式會使用計時器工作執行作業。</span><span class="sxs-lookup"><span data-stu-id="a320e-196">SharePoint mode utilizes timer jobs to .</span></span>  
  
-   <span data-ttu-id="a320e-197">呼叫在訂閱中指定的傳遞延伸模組，以便可以傳遞報表。</span><span class="sxs-lookup"><span data-stu-id="a320e-197">Calls the delivery extension that is specified in a subscription so that the report can be delivered.</span></span>  
  
 <span data-ttu-id="a320e-198">排程和傳遞作業的其他層面是由使用「排程與傳遞處理器」的其他元件和服務所處理。</span><span class="sxs-lookup"><span data-stu-id="a320e-198">Other aspects of a scheduling and delivery operation are handled by other components and services that work with the Scheduling and Delivery Processor.</span></span> <span data-ttu-id="a320e-199">明確地說，「排程與傳遞處理器」會在報表伺服器服務中執行，並使用 SQL Server Agent 做為計時器來產生排程的事件。</span><span class="sxs-lookup"><span data-stu-id="a320e-199">Specifically, the Scheduling and Delivery Processor runs in the Report Server service and uses SQL Server Agent as a timer to generate scheduled events.</span></span> <span data-ttu-id="a320e-200">下列逐步描述會說明排程的作業如何在 Reporting Services 部署中運作：</span><span class="sxs-lookup"><span data-stu-id="a320e-200">The following step-by-step description explains how the scheduled operations work in a Reporting Services deployment:</span></span>  
  
1.  <span data-ttu-id="a320e-201">當使用者建立排程時，會定義排程的作業。</span><span class="sxs-lookup"><span data-stu-id="a320e-201">A scheduled operation is defined when a user creates a schedule.</span></span> <span data-ttu-id="a320e-202">排程會定義將用於觸發報表傳遞之訂閱、重新整理快照集，或是讓快取到期的日期和時間。</span><span class="sxs-lookup"><span data-stu-id="a320e-202">The schedule defines a date and time that will be used to trigger a subscription for report delivery, refresh a snapshot, or expire a cache.</span></span>  
  
2.  <span data-ttu-id="a320e-203">報表伺服器會將排程資訊儲存在報表伺服器資料庫中。</span><span class="sxs-lookup"><span data-stu-id="a320e-203">The report server saves the schedule information in the report server database.</span></span>  
  
3.  <span data-ttu-id="a320e-204">報表伺服器會在包含所提供之排程資訊的 SQL Server Agent 中，建立對應的工作。</span><span class="sxs-lookup"><span data-stu-id="a320e-204">The report server creates a corresponding job in SQL Server Agent that includes the schedule information provided.</span></span> <span data-ttu-id="a320e-205">系統會使用與報表伺服器資料庫之間的現有開啟連接，透過預存程序建立工作。</span><span class="sxs-lookup"><span data-stu-id="a320e-205">The jobs are created through a stored procedure, using the existing open connection to the report server database.</span></span>  
  
4.  <span data-ttu-id="a320e-206">SQL Server Agent 會在排程中指定的日期和時間執行作業，</span><span class="sxs-lookup"><span data-stu-id="a320e-206">SQL Server Agent runs the job on the date and time specified in the schedule.</span></span> <span data-ttu-id="a320e-207">而此作業會建立一個事件，該事件會加入到由 Reporting Services 所維護的佇列中。</span><span class="sxs-lookup"><span data-stu-id="a320e-207">The job creates an event that is added to a queue maintained by Reporting Services.</span></span>  
  
5.  <span data-ttu-id="a320e-208">事件導致報表或訂閱程序執行。</span><span class="sxs-lookup"><span data-stu-id="a320e-208">The event causes a report or subscription process to occur.</span></span> <span data-ttu-id="a320e-209">在佇列中偵測到事件時會加以處理，而且會相對應地處理或傳遞報表。</span><span class="sxs-lookup"><span data-stu-id="a320e-209">Events are processed when they are detected in the queue, and the report is processed or delivered accordingly.</span></span>  
  
     <span data-ttu-id="a320e-210">處理事件前，排程與傳遞處理器會執行驗證步驟，以確認訂閱擁有者具有檢視報表的權限。</span><span class="sxs-lookup"><span data-stu-id="a320e-210">Before the events are processed, the Scheduling and Delivery Processor performs an authentication step to verify that the subscription owner has permission to view the report.</span></span>  
  
 <span data-ttu-id="a320e-211">Reporting Services 會針對所有排程的作業維護事件佇列，</span><span class="sxs-lookup"><span data-stu-id="a320e-211">Reporting Services maintains an event queue for all scheduled operations.</span></span> <span data-ttu-id="a320e-212">也會定期輪詢此佇列，以檢查是否有新的事件。</span><span class="sxs-lookup"><span data-stu-id="a320e-212">It polls the queue at regular intervals to check for new events.</span></span> <span data-ttu-id="a320e-213">依預設，每隔 10 秒鐘會掃描一次佇列。</span><span class="sxs-lookup"><span data-stu-id="a320e-213">By default, the queue is scanned at 10 second intervals.</span></span> <span data-ttu-id="a320e-214">您可以變更此間隔，其方式是在 RSReportServer.config 檔中修改 `PollingInterval`、`IsNotificationService` 和 `IsEventService` 組態設定。</span><span class="sxs-lookup"><span data-stu-id="a320e-214">You can change the interval by modifying the `PollingInterval`, `IsNotificationService`, and `IsEventService` configuration settings in the RSReportServer.config file.</span></span> <span data-ttu-id="a320e-215">SharePoint 模式也會將 RSreporserver.config 用於這些設定，而且這些值會套用到所有 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 服務應用程式。</span><span class="sxs-lookup"><span data-stu-id="a320e-215">SharePoint mode also uses the RSreporserver.config for these settings and the values apply to all [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] service applications.</span></span> <span data-ttu-id="a320e-216">如需詳細資訊，請參閱 [RSReportServer Configuration File](../report-server/rsreportserver-config-configuration-file.md)。</span><span class="sxs-lookup"><span data-stu-id="a320e-216">For more information, see [RSReportServer Configuration File](../report-server/rsreportserver-config-configuration-file.md).</span></span>  
  
##  <a name="server-dependencies"></a><a name="bkmk_serverdependencies"></a> <span data-ttu-id="a320e-217">伺服器相依性</span><span class="sxs-lookup"><span data-stu-id="a320e-217">Server Dependencies</span></span>  
 <span data-ttu-id="a320e-218">排程與傳遞處理器需要啟動報表伺服器服務與 SQL Server Agent。</span><span class="sxs-lookup"><span data-stu-id="a320e-218">The Scheduling and Delivery Processor requires that the Report Server service and SQL Server Agent are started.</span></span> <span data-ttu-id="a320e-219">排程和傳遞處理功能必須透過 `ScheduleEventsAndReportDeliveryEnabled` 以原則為基礎的管理中的**Reporting Services Facet 介面區**設定的屬性來啟用。</span><span class="sxs-lookup"><span data-stu-id="a320e-219">The Schedule and Delivery Processing feature must be enabled through the `ScheduleEventsAndReportDeliveryEnabled` property of the **Surface Area Configuration for Reporting Services** facet in Policy-Based Management.</span></span> <span data-ttu-id="a320e-220">SQL Server Agent 與報表伺服器服務都必須執行，排程的作業才會發生。</span><span class="sxs-lookup"><span data-stu-id="a320e-220">Both SQL Server Agent and the Report Server service must running in order for scheduled operations to occur.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a320e-221">您可以使用 **[Reporting Services 的介面區組態]** Facet，暫時或永久地停止排程的作業。</span><span class="sxs-lookup"><span data-stu-id="a320e-221">You can use the **Surface Area Configuration for Reporting Services** facet to stop scheduled operations on a temporary or permanent basis.</span></span> <span data-ttu-id="a320e-222">您可以建立與部署自訂傳遞擴充模組，但排程與傳遞處理器無法藉由本身擴充。</span><span class="sxs-lookup"><span data-stu-id="a320e-222">Although you can create and deploy custom delivery extensions, by itself the Scheduling and Delivery Processor is not extensible.</span></span> <span data-ttu-id="a320e-223">您無法變更它管理事件與通知的方式。</span><span class="sxs-lookup"><span data-stu-id="a320e-223">You cannot change how it manages events and notifications.</span></span> <span data-ttu-id="a320e-224">如需有關關閉功能的詳細資訊，請參閱＜ **Turn Reporting Services Features On or Off** ＞的＜ [排程的事件和傳遞](../report-server/turn-reporting-services-features-on-or-off.md)＞一節。</span><span class="sxs-lookup"><span data-stu-id="a320e-224">For more information about turn off features, see the **Scheduled Events and Delivery** section of [Turn Reporting Services Features On or Off](../report-server/turn-reporting-services-features-on-or-off.md).</span></span>  
  
###  <a name="effects-of-stopping-the-sql-server-agent"></a><a name="bkmk_stoppingagent"></a> <span data-ttu-id="a320e-225">停止 SQL Server Agent 的影響</span><span class="sxs-lookup"><span data-stu-id="a320e-225">Effects of Stopping the SQL Server Agent</span></span>  
 <span data-ttu-id="a320e-226">依預設，排程的報表是使用 SQL Server Agent。</span><span class="sxs-lookup"><span data-stu-id="a320e-226">Scheduled report processing uses SQL Server Agent by default.</span></span> <span data-ttu-id="a320e-227">如果您停止服務，則除非您透過 <xref:ReportService2010.ReportingService2010.FireEvent%2A> 方法，以程式設計方式加入處理要求，否則不會有新處理要求加入佇列。</span><span class="sxs-lookup"><span data-stu-id="a320e-227">If you stop the service, no new processing requests are added to the queue unless you add them programmatically through the <xref:ReportService2010.ReportingService2010.FireEvent%2A> method.</span></span> <span data-ttu-id="a320e-228">您重新啟動服務後，建立報表處理要求的作業就會繼續。</span><span class="sxs-lookup"><span data-stu-id="a320e-228">When you restart the service, the jobs that create report processing requests are resumed.</span></span> <span data-ttu-id="a320e-229">報表伺服器不會嘗試重新建立可能在 SQL Server Agent 離線期間所發生的報表處理作業。</span><span class="sxs-lookup"><span data-stu-id="a320e-229">The report server does not try to recreate report processing jobs that might have occurred in the past, while SQL Server Agent was offline.</span></span> <span data-ttu-id="a320e-230">如果您停止 SQL Server Agent 一個星期，那個星期內所有排程的作業都會遺失。</span><span class="sxs-lookup"><span data-stu-id="a320e-230">If you stop SQL Server Agent for a week, all scheduled operations are lost for that week.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a320e-231">SQL Server Agent 為 Reporting Services 提供的功能，可以由使用 <xref:ReportService2010.ReportingService2010.FireEvent%2A> 方法的自訂程式碼取代，來將排程事件加入佇列。</span><span class="sxs-lookup"><span data-stu-id="a320e-231">The functionality that SQL Server Agent provides to Reporting Services can be replaced with custom code that uses the <xref:ReportService2010.ReportingService2010.FireEvent%2A> method to add schedule events to the queue.</span></span>  
  
###  <a name="effects-of-stopping-the-report-server-service"></a><a name="bkmk_stoppingservice"></a> <span data-ttu-id="a320e-232">停止報表伺服器服務的影響</span><span class="sxs-lookup"><span data-stu-id="a320e-232">Effects of Stopping the Report Server Service</span></span>  
 <span data-ttu-id="a320e-233">如果停止報表伺服器服務，SQL Server Agent 會繼續將報表處理要求加入佇列。</span><span class="sxs-lookup"><span data-stu-id="a320e-233">If you stop the Report Server service, SQL Server Agent continues to add report processing requests to the queue.</span></span> <span data-ttu-id="a320e-234">SQL Server Agent 中的狀態資訊會指出作業成功。</span><span class="sxs-lookup"><span data-stu-id="a320e-234">Status information from SQL Server Agent indicates that the job succeeded.</span></span> <span data-ttu-id="a320e-235">但是，因為報表伺服器服務已停止，因此實際上沒有任何報表處理發生。</span><span class="sxs-lookup"><span data-stu-id="a320e-235">However, because the Report Server service is stopped, no report processing actually occurs.</span></span> <span data-ttu-id="a320e-236">要求將繼續在佇列中累積，直到您重新啟動報表伺服器服務為止。</span><span class="sxs-lookup"><span data-stu-id="a320e-236">The requests will continue to accumulate in the queue until you restart the Report Server service.</span></span> <span data-ttu-id="a320e-237">一旦您重新啟動報表伺服器服務之後，佇列中的所有報表處理要求都會依照順序處理。</span><span class="sxs-lookup"><span data-stu-id="a320e-237">Once you restart the Report Server service, all report processing requests that are in the queue are processed in order.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a320e-238">另請參閱</span><span class="sxs-lookup"><span data-stu-id="a320e-238">See Also</span></span>  
 <span data-ttu-id="a320e-239">[建立、修改及刪除報表記錄中的快照集](../report-server/create-modify-and-delete-snapshots-in-report-history.md) </span><span class="sxs-lookup"><span data-stu-id="a320e-239">[Create, Modify, and Delete Snapshots in Report History](../report-server/create-modify-and-delete-snapshots-in-report-history.md) </span></span>  
 <span data-ttu-id="a320e-240">[訂閱與傳遞 &#40;Reporting Services&#41;](subscriptions-and-delivery-reporting-services.md) </span><span class="sxs-lookup"><span data-stu-id="a320e-240">[Subscriptions and Delivery &#40;Reporting Services&#41;](subscriptions-and-delivery-reporting-services.md) </span></span>  
 <span data-ttu-id="a320e-241">[Data-Driven Subscriptions](data-driven-subscriptions.md) </span><span class="sxs-lookup"><span data-stu-id="a320e-241">[Data-Driven Subscriptions](data-driven-subscriptions.md) </span></span>  
 <span data-ttu-id="a320e-242">[快取多個報表 &#40;SSRS&#41;](../report-server/caching-reports-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="a320e-242">[Caching Reports &#40;SSRS&#41;](../report-server/caching-reports-ssrs.md) </span></span>  
 <span data-ttu-id="a320e-243">[報表伺服器內容管理 &#40;SSRS 原生模式&#41;](../report-server/report-server-content-management-ssrs-native-mode.md) </span><span class="sxs-lookup"><span data-stu-id="a320e-243">[Report Server Content Management &#40;SSRS Native Mode&#41;](../report-server/report-server-content-management-ssrs-native-mode.md) </span></span>  
 [<span data-ttu-id="a320e-244">快取共用資料集 &#40;SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="a320e-244">Cache Shared Datasets &#40;SSRS&#41;</span></span>](../report-server/cache-shared-datasets-ssrs.md)  
  
  
