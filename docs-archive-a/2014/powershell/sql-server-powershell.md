---
title: SQL Server PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 01/19/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: scripting
ms.topic: conceptual
ms.assetid: 89b70725-bbe7-4ffe-a27d-2a40005a97e7
author: stevestein
ms.author: sstein
ms.openlocfilehash: 87b4a21bf46bb27fba604c81af633576da6342c9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87699871"
---
# <a name="sql-server-powershell"></a><span data-ttu-id="f332b-102">SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="f332b-102">SQL Server PowerShell</span></span>
  [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] <span data-ttu-id="f332b-103">支援 Windows PowerShell，它是功能強大的指令碼處理介面，可讓系統管理員和開發人員將伺服器管理和應用程式部署自動化。</span><span class="sxs-lookup"><span data-stu-id="f332b-103">supports Windows PowerShell, which is a powerful scripting shell that lets administrators and developers automate server administration and application deployment.</span></span> <span data-ttu-id="f332b-104">Windows PowerShell 語言可支援比 [!INCLUDE[tsql](../includes/tsql-md.md)] 指令碼更複雜的邏輯，讓 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 管理員能夠建立功能強大的管理指令碼。</span><span class="sxs-lookup"><span data-stu-id="f332b-104">The Windows PowerShell language supports more complex logic than [!INCLUDE[tsql](../includes/tsql-md.md)] scripts, giving [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] administrators the ability to build robust administration scripts.</span></span> <span data-ttu-id="f332b-105">Windows PowerShell 指令碼也可用來管理其他 [!INCLUDE[msCoName](../includes/msconame-md.md)] 伺服器產品。</span><span class="sxs-lookup"><span data-stu-id="f332b-105">Windows PowerShell scripts can also be used to administer other [!INCLUDE[msCoName](../includes/msconame-md.md)] server products.</span></span> <span data-ttu-id="f332b-106">如此可為管理員提供跨伺服器的通用指令碼語言。</span><span class="sxs-lookup"><span data-stu-id="f332b-106">This gives administrators a common scripting language across servers.</span></span>  
  
## <a name="sql-server-powershell-components"></a><span data-ttu-id="f332b-107">SQL Server PowerShell 元件</span><span class="sxs-lookup"><span data-stu-id="f332b-107">SQL Server PowerShell Components</span></span>  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="f332b-108">提供名稱為 `sqlps` 的 Windows PowerShell 模組，用來將 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 元件匯入 Windows PowerShell 2.0 環境或指令碼。</span><span class="sxs-lookup"><span data-stu-id="f332b-108">provides a Windows PowerShell module named `sqlps` that is used to import the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] components into a Windows PowerShell 2.0 environment or script.</span></span> <span data-ttu-id="f332b-109"> 模組載入兩個 Windows PowerShell 嵌入式管理單元，可用來實作：</span><span class="sxs-lookup"><span data-stu-id="f332b-109">The `sqlps` module loads two Windows PowerShell snap-ins that implement:</span></span>  
  
-   <span data-ttu-id="f332b-110">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 提供者，可啟用類似於檔案系統路徑的簡單導覽機制。</span><span class="sxs-lookup"><span data-stu-id="f332b-110">A [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provider, which enables a simple navigation mechanism similar to file system paths.</span></span> <span data-ttu-id="f332b-111">您可以建立類似於檔案系統路徑的路徑，其中的磁碟機與 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 管理物件模型有關聯，而且節點是根據物件模型類別。</span><span class="sxs-lookup"><span data-stu-id="f332b-111">You can build paths similar to file system paths, where the drive is associated with a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] management object model, and the nodes are based on the object model classes.</span></span> <span data-ttu-id="f332b-112">然後，您可以使用熟悉的命令 (例如 **cd** 和 **dir** ) 來巡覽路徑，其方式類似於在命令提示字元視窗中巡覽資料夾。</span><span class="sxs-lookup"><span data-stu-id="f332b-112">You can then use familiar commands such as **cd** and **dir** to navigate the paths similar to the way you navigate folders in a command prompt window.</span></span> <span data-ttu-id="f332b-113">您可以使用其他命令 (例如 **ren** 或 **del**)，在路徑中的節點上執行動作。</span><span class="sxs-lookup"><span data-stu-id="f332b-113">You can use other commands, such as **ren** or **del**, to perform actions on the nodes in the path.</span></span>  
  
-   <span data-ttu-id="f332b-114">一組 Cmdlet，這些是 Windows PowerShell 指令碼中用來指定 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 動作的命令。</span><span class="sxs-lookup"><span data-stu-id="f332b-114">A set of cmdlets, which are commands used in Windows PowerShell scripts to specify a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] action.</span></span> <span data-ttu-id="f332b-115">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Cmdlet 可支援一些動作，例如執行包含 **或 XQuery 陳述式的** sqlcmd [!INCLUDE[tsql](../includes/tsql-md.md)] 指令碼。</span><span class="sxs-lookup"><span data-stu-id="f332b-115">The [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cmdlets support actions such as running a **sqlcmd** script containing [!INCLUDE[tsql](../includes/tsql-md.md)] or XQuery statements.</span></span>  
  
 <span data-ttu-id="f332b-116">若要了解有關 Windows PowerShell 的相關資訊，請參閱 [Windows PowerShell 開始使用手冊](https://msdn.microsoft.com/library/hh857337.aspx)。</span><span class="sxs-lookup"><span data-stu-id="f332b-116">To learn about Windows PowerShell, see the [Windows PowerShell Getting Started Guide](https://msdn.microsoft.com/library/hh857337.aspx).</span></span>  
  
## <a name="sql-server-versions"></a><span data-ttu-id="f332b-117">SQL Server 版本</span><span class="sxs-lookup"><span data-stu-id="f332b-117">SQL Server Versions</span></span>  
 <span data-ttu-id="f332b-118">[!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell 元件可用來管理 [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] 或更新版本的執行個體。</span><span class="sxs-lookup"><span data-stu-id="f332b-118">The [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell components can be used to manage instances of [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] or later.</span></span> <span data-ttu-id="f332b-119">[!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] 的執行個體必須執行 SP2 或更新版本。</span><span class="sxs-lookup"><span data-stu-id="f332b-119">Instances of [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] must be running SP2 or later.</span></span> <span data-ttu-id="f332b-120">[!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] 的執行個體必須執行 SP4 或更新版本。</span><span class="sxs-lookup"><span data-stu-id="f332b-120">Instances of [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] must be running SP4 or later.</span></span> <span data-ttu-id="f332b-121">當 [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell 元件搭配舊版的 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]使用時，其功能限制為這些版本中的可用功能。</span><span class="sxs-lookup"><span data-stu-id="f332b-121">When the [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell components are used with earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], they are limited to the functionality available in those versions.</span></span>  
  
## <a name="sql-server-powershell-tasks"></a><span data-ttu-id="f332b-122">SQL Server PowerShell 工作</span><span class="sxs-lookup"><span data-stu-id="f332b-122">SQL Server PowerShell Tasks</span></span>  
  
|<span data-ttu-id="f332b-123">工作描述</span><span class="sxs-lookup"><span data-stu-id="f332b-123">Task Description</span></span>|<span data-ttu-id="f332b-124">主題</span><span class="sxs-lookup"><span data-stu-id="f332b-124">Topic</span></span>|  
|----------------------|-----------|  
|<span data-ttu-id="f332b-125">描述用於執行 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell 元件的慣用機制、開啟 PowerShell 工作階段，以及載入 `sqlps` 模組。</span><span class="sxs-lookup"><span data-stu-id="f332b-125">Describes the preferred mechanism for running the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell components; to open a PowerShell session and load the `sqlps` module.</span></span> <span data-ttu-id="f332b-126"> 模組會在  PowerShell 提供者和 Cmdllet 中載入，以及提供者和 Cmdllet 所使用的 SQL Server 管理物件 (SMO) 組件。</span><span class="sxs-lookup"><span data-stu-id="f332b-126">The `sqlps` module loads in the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell provider and cmdlets, and the SQL Server Management Object (SMO) assemblies used by the provider and cmdlets.</span></span>|[<span data-ttu-id="f332b-127">匯入 SQLPS 模組</span><span class="sxs-lookup"><span data-stu-id="f332b-127">Import the SQLPS Module</span></span>](../database-engine/import-the-sqlps-module.md)|  
|<span data-ttu-id="f332b-128">描述如何在沒有提供者或 Cmdllet 的情況下，只載入 SMO 組件。</span><span class="sxs-lookup"><span data-stu-id="f332b-128">Describes how to load only the SMO assemblies without the provider or cmdlets.</span></span>|[<span data-ttu-id="f332b-129">載入 Windows PowerShell 中的 SMO 組件</span><span class="sxs-lookup"><span data-stu-id="f332b-129">Load the SMO Assemblies in Windows PowerShell</span></span>](load-the-smo-assemblies-in-windows-powershell.md)|  
|<span data-ttu-id="f332b-130">描述如何以滑鼠右鍵按一下 **物件總管**中的節點，來執行 Windows PowerShell 工作階段。</span><span class="sxs-lookup"><span data-stu-id="f332b-130">Describes how to run a Windows PowerShell session by right-clicking a node in **Object Explorer**.</span></span> [!INCLUDE[ssManStudio](../includes/ssmanstudio-md.md)]<span data-ttu-id="f332b-131">會啟動 Windows PowerShell 會話、載入 `sqlps` 模組，並將 SQL Server 提供者路徑設定為選取的物件。</span><span class="sxs-lookup"><span data-stu-id="f332b-131">launches a Windows PowerShell session, loads the `sqlps` module, and sets the SQL Server provider path to the object selected.</span></span>|[<span data-ttu-id="f332b-132">從 SQL Server Management Studio 執行 Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f332b-132">Run Windows PowerShell from SQL Server Management Studio</span></span>](run-windows-powershell-from-sql-server-management-studio.md)|  
|<span data-ttu-id="f332b-133">描述如何建立可執行 Windows PowerShell 指令碼的 SQL Server Agent 作業步驟。</span><span class="sxs-lookup"><span data-stu-id="f332b-133">Describes how to create SQL Server Agent job steps that run a Windows PowerShell script.</span></span> <span data-ttu-id="f332b-134">然後，就可以排程在特定時間或為回應事件而執行作業。</span><span class="sxs-lookup"><span data-stu-id="f332b-134">The jobs can then be scheduled to run at specific times or in response to events.</span></span>|[<span data-ttu-id="f332b-135">在 SQL Server Agent 中執行 Windows PowerShell 步驟</span><span class="sxs-lookup"><span data-stu-id="f332b-135">Run Windows PowerShell Steps in SQL Server Agent</span></span>](run-windows-powershell-steps-in-sql-server-agent.md)|  
|<span data-ttu-id="f332b-136">描述如何使用 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 提供者來導覽 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 物件的階層。</span><span class="sxs-lookup"><span data-stu-id="f332b-136">Describes how to use the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provider to navigate a hierarchy of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] objects.</span></span>|[<span data-ttu-id="f332b-137">SQL Server PowerShell 提供者</span><span class="sxs-lookup"><span data-stu-id="f332b-137">SQL Server PowerShell Provider</span></span>](sql-server-powershell-provider.md)|  
|<span data-ttu-id="f332b-138">描述如何使用 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Cmdllet，以指定 [!INCLUDE[ssDE](../includes/ssde-md.md)] 動作 (例如，執行 [!INCLUDE[tsql](../includes/tsql-md.md)] 指令碼)。</span><span class="sxs-lookup"><span data-stu-id="f332b-138">Describes how to use the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cmdlets that specify [!INCLUDE[ssDE](../includes/ssde-md.md)] actions such as running a [!INCLUDE[tsql](../includes/tsql-md.md)] script.</span></span>|[<span data-ttu-id="f332b-139">使用 Database Engine Cmdlet</span><span class="sxs-lookup"><span data-stu-id="f332b-139">Use the Database Engine cmdlets</span></span>](../database-engine/use-the-database-engine-cmdlets.md)|  
|<span data-ttu-id="f332b-140">描述如何指定含有 Windows PowerShell 不支援字元的 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 分隔識別碼。</span><span class="sxs-lookup"><span data-stu-id="f332b-140">Describes how to specify [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] delimited identifiers that contain characters not supported by Windows PowerShell.</span></span>|[<span data-ttu-id="f332b-141">PowerShell 中的 SQL Server 識別碼</span><span class="sxs-lookup"><span data-stu-id="f332b-141">SQL Server Identifiers in PowerShell</span></span>](sql-server-identifiers-in-powershell.md)|  
|<span data-ttu-id="f332b-142">描述如何進行 SQL Server 驗證連接。</span><span class="sxs-lookup"><span data-stu-id="f332b-142">Describes how to make SQL Server Authentication connections.</span></span> <span data-ttu-id="f332b-143">依預設，SQL Server PowerShell 元件會以執行 Windows PowerShell 之處理序的 Windows 認證來使用 Windows 驗證連接。</span><span class="sxs-lookup"><span data-stu-id="f332b-143">By default, the SQL Server PowerShell components use Windows Authentication connections using the Windows credentials of the process running Windows PowerShell.</span></span>|[<span data-ttu-id="f332b-144">管理 Database Engine PowerShell 中的驗證</span><span class="sxs-lookup"><span data-stu-id="f332b-144">Manage Authentication in Database Engine PowerShell</span></span>](manage-authentication-in-database-engine-powershell.md)|  
|<span data-ttu-id="f332b-145">描述如何使用 SQL Server PowerShell 提供者所實作的變數來控制使用 Windows PowerShell Tab 完成時列出的物件數目。</span><span class="sxs-lookup"><span data-stu-id="f332b-145">Describes how to use variables implemented by the SQL Server PowerShell provider to control how many objects are listed when using Windows PowerShell tab completion.</span></span> <span data-ttu-id="f332b-146">這對於處理包含大量物件的資料庫特別有用。</span><span class="sxs-lookup"><span data-stu-id="f332b-146">This is particularly useful when working on databases that contain large numbers of objects.</span></span>|[<span data-ttu-id="f332b-147">管理 TAB 鍵自動完成 &#40;SQL Server PowerShell&#41;</span><span class="sxs-lookup"><span data-stu-id="f332b-147">Manage Tab Completion &#40;SQL Server PowerShell&#41;</span></span>](manage-tab-completion-sql-server-powershell.md)|  
|<span data-ttu-id="f332b-148">描述如何使用 Get-Help 取得 Windows PowerShell 環境中 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 元件的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="f332b-148">Describes how to use Get-Help to get information about the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] components in the Windows PowerShell environment.</span></span>|[<span data-ttu-id="f332b-149">Get Help SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="f332b-149">Get Help SQL Server PowerShell</span></span>](../database-engine/get-help-sql-server-powershell.md)|  
  
  
