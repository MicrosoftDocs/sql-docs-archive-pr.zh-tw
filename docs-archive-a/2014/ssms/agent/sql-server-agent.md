---
title: SQL Server Agent | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- SQL Server Agent, about SQL Server Agent
- automatic administration steps
ms.assetid: 8d1dc600-aabb-416f-b3af-fbc9fccfd0ec
author: stevestein
ms.author: sstein
ms.openlocfilehash: e9de43e6bbb62deecd83b80095689c0ccbb8aedc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87705854"
---
# <a name="sql-server-agent"></a><span data-ttu-id="2a580-102">SQL Server Agent</span><span class="sxs-lookup"><span data-stu-id="2a580-102">SQL Server Agent</span></span>
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="2a580-103">Agent 是 Microsoft Windows 服務，它會執行排程的管理工作 (在 *中稱為* 「作業」 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)](Job))。</span><span class="sxs-lookup"><span data-stu-id="2a580-103">Agent is a Microsoft Windows service that executes scheduled administrative tasks, which are called *jobs* in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span>  
  
 <span data-ttu-id="2a580-104">**本主題內容**</span><span class="sxs-lookup"><span data-stu-id="2a580-104">**In This Topic**</span></span>  
  
-   [<span data-ttu-id="2a580-105">SQL Server Agent 的優點</span><span class="sxs-lookup"><span data-stu-id="2a580-105">Benefits of SQL Server Agent</span></span>](#Benefits)  
  
-   [<span data-ttu-id="2a580-106">SQL Server Agent 的元件</span><span class="sxs-lookup"><span data-stu-id="2a580-106">Components of SQL Server Agent</span></span>](#Components)  
  
-   [<span data-ttu-id="2a580-107">SQL Server Agent 管理的安全性</span><span class="sxs-lookup"><span data-stu-id="2a580-107">Security for SQL Server Agent Administration</span></span>](#Security)  
  
##  <a name="benefits-of-sql-server-agent"></a><a name="Benefits"></a><span data-ttu-id="2a580-108">SQL Server Agent 的優點</span><span class="sxs-lookup"><span data-stu-id="2a580-108">Benefits of SQL Server Agent</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="2a580-109">Agent 使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 來儲存作業資訊。</span><span class="sxs-lookup"><span data-stu-id="2a580-109">Agent uses [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to store job information.</span></span> <span data-ttu-id="2a580-110">作業包含了一個或多個作業步驟。</span><span class="sxs-lookup"><span data-stu-id="2a580-110">Jobs contain one or more job steps.</span></span> <span data-ttu-id="2a580-111">每一個步驟包含它自己的工作 (例如備份資料庫)。</span><span class="sxs-lookup"><span data-stu-id="2a580-111">Each step contains its own task, for example, backing up a database.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="2a580-112">Agent 可以按照排程、為了回應特定事件或視需要來執行作業。</span><span class="sxs-lookup"><span data-stu-id="2a580-112">Agent can run a job on a schedule, in response to a specific event, or on demand.</span></span> <span data-ttu-id="2a580-113">例如，假設您要在每個工作日結束後備份公司的所有伺服器，您可以讓這項工作自動執行。</span><span class="sxs-lookup"><span data-stu-id="2a580-113">For example, if you want to back up all the company servers every weekday after hours, you can automate this task.</span></span> <span data-ttu-id="2a580-114">將備份排程在星期一至星期五 22:00 之後執行，如果備份發生問題，SQL Server Agent 可以記錄事件並通知您。</span><span class="sxs-lookup"><span data-stu-id="2a580-114">Schedule the backup to run after 22:00 Monday through Friday; if the backup encounters a problem, SQL Server Agent can record the event and notify you.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="2a580-115">根據預設，除非使用者明確地選擇要自動啟動服務，否則在安裝 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 時， [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Agent 服務是停用的。</span><span class="sxs-lookup"><span data-stu-id="2a580-115">By default, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service is disabled when [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] is installed unless the user explicitly chooses to autostart the service.</span></span>  
  
##  <a name="sql-server-agent-components"></a><a name="Components"></a><span data-ttu-id="2a580-116">SQL Server Agent 元件</span><span class="sxs-lookup"><span data-stu-id="2a580-116">SQL Server Agent Components</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="2a580-117">Agent 使用下列元件來定義要執行的工作，何時執行工作以及報告工作成功或失敗的方式。</span><span class="sxs-lookup"><span data-stu-id="2a580-117">Agent uses the following components to define the tasks to be performed, when to perform the tasks, and how to report the success or failure of the tasks.</span></span>  
  
### <a name="jobs"></a><span data-ttu-id="2a580-118">工作</span><span class="sxs-lookup"><span data-stu-id="2a580-118">Jobs</span></span>  
 <span data-ttu-id="2a580-119">「*作業*」是 Agent 執行的一系列指定動作 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="2a580-119">A *job* is a specified series of actions that [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent performs.</span></span> <span data-ttu-id="2a580-120">使用作業來定義可執行一或多次並監視成功或失敗的系統管理工作。</span><span class="sxs-lookup"><span data-stu-id="2a580-120">Use jobs to define an administrative task that can be run one or more times and monitored for success or failure.</span></span> <span data-ttu-id="2a580-121">一個作業可以在一部本機伺服器或在多部遠端伺服器上執行。</span><span class="sxs-lookup"><span data-stu-id="2a580-121">A job can run on one local server or on multiple remote servers.</span></span>  
  
> [!IMPORTANT]  
>  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="2a580-122">容錯移轉叢集執行個體的容錯移轉事件期間執行的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 作業，並不會在容錯移轉至另一個容錯移轉叢集節點後繼續。</span><span class="sxs-lookup"><span data-stu-id="2a580-122">Agent jobs that are running at the time of a failover event on a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] failover cluster instance do not resume after failover to another failover cluster node.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="2a580-123">於 Hyper-V 暫停期間執行的 Agent 作業，如果該此暫停會造成容錯移轉至另一個節點，那麼這些作業並不會繼續。</span><span class="sxs-lookup"><span data-stu-id="2a580-123">Agent jobs that are running at the time a Hyper-V node is paused do not resume if the pause causes a failover to another node.</span></span> <span data-ttu-id="2a580-124">已開始的工作卻因為容錯移轉事件而無法完成，會記錄為已啟動，但是不會顯其他表示完成或失敗的記錄項目。</span><span class="sxs-lookup"><span data-stu-id="2a580-124">Jobs that begin but fail to complete because of a failover event are logged as started, but do not show additional log entries for completion or failure.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="2a580-125">Agent 作業看起來永遠不會結束。</span><span class="sxs-lookup"><span data-stu-id="2a580-125">Agent jobs in these scenarios appear to have never ended.</span></span>  
  
 <span data-ttu-id="2a580-126">執行作業有數種方式：</span><span class="sxs-lookup"><span data-stu-id="2a580-126">You can run jobs in several ways:</span></span>  
  
-   <span data-ttu-id="2a580-127">依照一個或多個排程。</span><span class="sxs-lookup"><span data-stu-id="2a580-127">According to one or more schedules.</span></span>  
  
-   <span data-ttu-id="2a580-128">回應一個或多個警示。</span><span class="sxs-lookup"><span data-stu-id="2a580-128">In response to one or more alerts.</span></span>  
  
-   <span data-ttu-id="2a580-129">執行 sp_start_job 預存程序。</span><span class="sxs-lookup"><span data-stu-id="2a580-129">By executing the sp_start_job stored procedure.</span></span>  
  
 <span data-ttu-id="2a580-130">作業中的每個動作都是 *「作業步驟」*(Job Step)。</span><span class="sxs-lookup"><span data-stu-id="2a580-130">Each action in a job is a *job step*.</span></span> <span data-ttu-id="2a580-131">例如，作業步驟可能是由執行 [!INCLUDE[tsql](../../includes/tsql-md.md)] 陳述式、執行 [!INCLUDE[ssIS](../../includes/ssis-md.md)] 封裝或對 Analysis Services 伺服器發出命令等動作構成。</span><span class="sxs-lookup"><span data-stu-id="2a580-131">For example, a job step might consist of running a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement, executing an [!INCLUDE[ssIS](../../includes/ssis-md.md)] package, or issuing a command to an Analysis Services server.</span></span> <span data-ttu-id="2a580-132">作業步驟會視為作業的一部份來管理。</span><span class="sxs-lookup"><span data-stu-id="2a580-132">Job steps are managed as part of a job.</span></span>  
  
 <span data-ttu-id="2a580-133">每個作業步驟都是在特定的安全性內容中執行。</span><span class="sxs-lookup"><span data-stu-id="2a580-133">Each job step runs in a specific security context.</span></span> <span data-ttu-id="2a580-134">對於使用 [!INCLUDE[tsql](../../includes/tsql-md.md)]的作業步驟，請使用 EXECUTE AS 陳述式來設定作業步驟的安全性內容。</span><span class="sxs-lookup"><span data-stu-id="2a580-134">For job steps that use [!INCLUDE[tsql](../../includes/tsql-md.md)], use the EXECUTE AS statement to set the security context for the job step.</span></span> <span data-ttu-id="2a580-135">對其他作業步驟類型，可以使用 Proxy 帳戶來設定作業步驟的安全性內容。</span><span class="sxs-lookup"><span data-stu-id="2a580-135">For other types of job steps, use a proxy account to set the security context for the job step.</span></span>  
  
### <a name="schedules"></a><span data-ttu-id="2a580-136">排程</span><span class="sxs-lookup"><span data-stu-id="2a580-136">Schedules</span></span>  
 <span data-ttu-id="2a580-137">*排程*會指定作業的執行時間。</span><span class="sxs-lookup"><span data-stu-id="2a580-137">A *schedule* specifies when a job runs.</span></span> <span data-ttu-id="2a580-138">您可以依照相同的排程執行一項以上的作業，而且可以將一個以上的排程套用至相同的作業。</span><span class="sxs-lookup"><span data-stu-id="2a580-138">More than one job can run on the same schedule, and more than one schedule can apply to the same job.</span></span> <span data-ttu-id="2a580-139">排程可以針對作業的執行時間定義下列條件：</span><span class="sxs-lookup"><span data-stu-id="2a580-139">A schedule can define the following conditions for the time when a job runs:</span></span>  
  
-   <span data-ttu-id="2a580-140">每當 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 啟動時。</span><span class="sxs-lookup"><span data-stu-id="2a580-140">Whenever [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent starts.</span></span>  
  
-   <span data-ttu-id="2a580-141">每當電腦的 CPU 使用率達到您定義為閒置的等級時。</span><span class="sxs-lookup"><span data-stu-id="2a580-141">Whenever CPU utilization of the computer is at a level you have defined as idle.</span></span>  
  
-   <span data-ttu-id="2a580-142">某個特定的日期和時間。</span><span class="sxs-lookup"><span data-stu-id="2a580-142">One time, at a specific date and time.</span></span>  
  
-   <span data-ttu-id="2a580-143">依照週期性排程。</span><span class="sxs-lookup"><span data-stu-id="2a580-143">On a recurring schedule.</span></span>  
  
 <span data-ttu-id="2a580-144">如需詳細資訊，請參閱 [建立及附加排程至作業](create-and-attach-schedules-to-jobs.md)。</span><span class="sxs-lookup"><span data-stu-id="2a580-144">For more information, see [Create and Attach Schedules to Jobs](create-and-attach-schedules-to-jobs.md).</span></span>  
  
### <a name="alerts"></a><span data-ttu-id="2a580-145">警示</span><span class="sxs-lookup"><span data-stu-id="2a580-145">Alerts</span></span>  
 <span data-ttu-id="2a580-146">*「警示」* 是針對特定事件的自動回應。</span><span class="sxs-lookup"><span data-stu-id="2a580-146">An *alert* is an automatic response to a specific event.</span></span> <span data-ttu-id="2a580-147">例如，事件可能是啟動某項作業，或是系統資源即將接近特定臨界值。</span><span class="sxs-lookup"><span data-stu-id="2a580-147">For example, an event can be a job that starts or system resources that reach a specific threshold.</span></span> <span data-ttu-id="2a580-148">您要定義在什麼條件下會產生警示。</span><span class="sxs-lookup"><span data-stu-id="2a580-148">You define the conditions under which an alert occurs.</span></span>  
  
 <span data-ttu-id="2a580-149">警示可回應下列條件之一：</span><span class="sxs-lookup"><span data-stu-id="2a580-149">An alert can respond to one of the following conditions:</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="2a580-150">事件</span><span class="sxs-lookup"><span data-stu-id="2a580-150">events</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="2a580-151">效能條件</span><span class="sxs-lookup"><span data-stu-id="2a580-151">performance conditions</span></span>  
  
-   <span data-ttu-id="2a580-152">在執行 SQL Server Agent 之電腦上的 Microsoft Windows Management Instrumentation (WMI) 事件</span><span class="sxs-lookup"><span data-stu-id="2a580-152">Microsoft Windows Management Instrumentation (WMI) events on the computer where SQL Server Agent is running</span></span>  
  
 <span data-ttu-id="2a580-153">警示可執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="2a580-153">An alert can perform the following actions:</span></span>  
  
-   <span data-ttu-id="2a580-154">通知一或多個操作員</span><span class="sxs-lookup"><span data-stu-id="2a580-154">Notify one or more operators</span></span>  
  
-   <span data-ttu-id="2a580-155">執行作業</span><span class="sxs-lookup"><span data-stu-id="2a580-155">Run a job</span></span>  
  
 <span data-ttu-id="2a580-156">如需詳細資訊，請參閱 [警示](alerts.md)。</span><span class="sxs-lookup"><span data-stu-id="2a580-156">For more information, see [Alerts](alerts.md).</span></span>  
  
### <a name="operators"></a><span data-ttu-id="2a580-157">操作員</span><span class="sxs-lookup"><span data-stu-id="2a580-157">Operators</span></span>  
 <span data-ttu-id="2a580-158">*「操作員」* (Operator) 會定義負責維護一個或多個 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]執行個體之人員的連絡資訊。</span><span class="sxs-lookup"><span data-stu-id="2a580-158">An *operator* defines contact information for an individual responsible for the maintenance of one or more instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="2a580-159">某些企業將操作員責任指派給一個人。</span><span class="sxs-lookup"><span data-stu-id="2a580-159">In some enterprises, operator responsibilities are assigned to one individual.</span></span> <span data-ttu-id="2a580-160">在具有多個伺服器的企業中，很多人可以共同擔任操作員的任務。</span><span class="sxs-lookup"><span data-stu-id="2a580-160">In enterprises with multiple servers, many individuals can share operator responsibilities.</span></span> <span data-ttu-id="2a580-161">操作員不包含安全性資訊，並不會定義安全性主體。</span><span class="sxs-lookup"><span data-stu-id="2a580-161">An operator does not contain security information, and does not define a security principal.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="2a580-162">可以透過下列一或多種方式，通知操作員發生警示：</span><span class="sxs-lookup"><span data-stu-id="2a580-162">can notify operators of alerts through one or more of the following:</span></span>  
  
-   <span data-ttu-id="2a580-163">電子郵件</span><span class="sxs-lookup"><span data-stu-id="2a580-163">E-mail</span></span>  
  
-   <span data-ttu-id="2a580-164">呼叫器 (透過電子郵件)</span><span class="sxs-lookup"><span data-stu-id="2a580-164">Pager (through e-mail)</span></span>  
  
-   <span data-ttu-id="2a580-165">**net send**</span><span class="sxs-lookup"><span data-stu-id="2a580-165">**net send**</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="2a580-166">若要使用 **net send**來傳送通知，則必須在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 所在的電腦上啟動 Windows Messenger 服務。</span><span class="sxs-lookup"><span data-stu-id="2a580-166">To send notifications by using **net send**, the Windows Messenger service must be started on the computer where [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent resides.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="2a580-167">呼叫器和 **net send** 選項會從 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 未來版本的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="2a580-167">The Pager and **net send** options will be removed from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent in a future version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="2a580-168">請避免在新的開發工作中使用這些功能，並規劃修改目前使用這些功能的應用程式。</span><span class="sxs-lookup"><span data-stu-id="2a580-168">Avoid using these features in new development work, and plan to modify applications that currently use these features.</span></span>  
  
 <span data-ttu-id="2a580-169">若要使用電子郵件或呼叫器來傳送通知給操作員，則必須設定 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 以使用 Database Mail。</span><span class="sxs-lookup"><span data-stu-id="2a580-169">To send notifications to operators by using e-mail or pagers, you must configure [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent to use Database Mail.</span></span> <span data-ttu-id="2a580-170">如需詳細資訊，請參閱 [Database Mail](../../relational-databases/database-mail/database-mail.md)。</span><span class="sxs-lookup"><span data-stu-id="2a580-170">For more information, see [Database Mail](../../relational-databases/database-mail/database-mail.md).</span></span>  
  
 <span data-ttu-id="2a580-171">您可以將操作員定義成一群人員的別名。</span><span class="sxs-lookup"><span data-stu-id="2a580-171">You can define an operator as the alias for a group of individuals.</span></span> <span data-ttu-id="2a580-172">用這種方法，可以同時告知具有該別名的所有成員。</span><span class="sxs-lookup"><span data-stu-id="2a580-172">In this way, all members of that alias are notified at the same time.</span></span> <span data-ttu-id="2a580-173">如需詳細資訊，請參閱 [運算子](operators.md)。</span><span class="sxs-lookup"><span data-stu-id="2a580-173">For more information, see [Operators](operators.md).</span></span>  
  
##  <a name="security-for-sql-server-agent-administration"></a><a name="Security"></a><span data-ttu-id="2a580-174">SQL Server Agent 管理的安全性</span><span class="sxs-lookup"><span data-stu-id="2a580-174">Security for SQL Server Agent Administration</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="2a580-175">Agent 會使用**msdb**資料庫中的**SQLAgentUserRole**、 **SQLAgentReaderRole**和**SQLAgentOperatorRole**固定資料庫角色，來控制 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 不是系統管理員（） `sysadmin` 固定伺服器角色成員之使用者的 Agent 存取權。</span><span class="sxs-lookup"><span data-stu-id="2a580-175">Agent uses the **SQLAgentUserRole**, **SQLAgentReaderRole**, and **SQLAgentOperatorRole** fixed database roles in the **msdb** database to control access to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent for users who are not members of the `sysadmin` fixed server role.</span></span> <span data-ttu-id="2a580-176">除了這些固定資料庫角色之外，子系統與 Proxy 可協助資料庫管理員確保每一個作業步驟都以執行工作所需的最小權限來執行。</span><span class="sxs-lookup"><span data-stu-id="2a580-176">In addition to these fixed database roles, subsystems and proxies help database administrators ensure that each job step runs with the minimum permissions required to perform its task.</span></span>  
  
### <a name="roles"></a><span data-ttu-id="2a580-177">角色</span><span class="sxs-lookup"><span data-stu-id="2a580-177">Roles</span></span>  
 <span data-ttu-id="2a580-178">**Msdb**中**SQLAgentUserRole**、 **SQLAgentReaderRole**和**SQLAgentOperatorRole**固定資料庫角色的成員，以及固定伺服器角色的成員， `sysadmin` 都具有 Agent 的存取權 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="2a580-178">Members of the **SQLAgentUserRole**, **SQLAgentReaderRole**, and **SQLAgentOperatorRole** fixed database roles in **msdb**, and members of the `sysadmin` fixed server role have access to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span></span> <span data-ttu-id="2a580-179">不屬於以上任一角色的成員，都無法使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent。</span><span class="sxs-lookup"><span data-stu-id="2a580-179">A user that does not belong to any of these roles cannot use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span></span> <span data-ttu-id="2a580-180">如需 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 所使用角色的詳細資訊，請參閱 [實作 SQL Server Agent 安全性](implement-sql-server-agent-security.md)。</span><span class="sxs-lookup"><span data-stu-id="2a580-180">For more information on the roles used by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent, see [Implement SQL Server Agent Security](implement-sql-server-agent-security.md).</span></span>  
  
### <a name="subsystems"></a><span data-ttu-id="2a580-181">子系統</span><span class="sxs-lookup"><span data-stu-id="2a580-181">Subsystems</span></span>  
 <span data-ttu-id="2a580-182">子系統是預先定義的物件，代表作業步驟可用的功能。</span><span class="sxs-lookup"><span data-stu-id="2a580-182">A subsystem is a predefined object that represents functionality that is available to a job step.</span></span> <span data-ttu-id="2a580-183">每個 Proxy 都具有一或多個子系統的存取權。</span><span class="sxs-lookup"><span data-stu-id="2a580-183">Each proxy has access to one or more subsystems.</span></span> <span data-ttu-id="2a580-184">子系統可提供安全性，因為它們會將 Proxy 可用的功能存取加以分隔。</span><span class="sxs-lookup"><span data-stu-id="2a580-184">Subsystems provide security because they delimit access to the functionality that is available to a proxy.</span></span> <span data-ttu-id="2a580-185">每種作業步驟都可在 Proxy 的內容中執行，除了 [!INCLUDE[tsql](../../includes/tsql-md.md)] 作業步驟以外；</span><span class="sxs-lookup"><span data-stu-id="2a580-185">Each job step runs in the context of a proxy, except for [!INCLUDE[tsql](../../includes/tsql-md.md)] job steps.</span></span> [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="2a580-186">作業步驟使用 EXECUTE AS 命令來設定安全性內容。</span><span class="sxs-lookup"><span data-stu-id="2a580-186">job steps use the EXECUTE AS command to set the security context.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="2a580-187">定義了下表所列的子系統：</span><span class="sxs-lookup"><span data-stu-id="2a580-187">defines the subsystems listed in the following table:</span></span>  
  
|<span data-ttu-id="2a580-188">子系統名稱</span><span class="sxs-lookup"><span data-stu-id="2a580-188">Subsystem name</span></span>|<span data-ttu-id="2a580-189">描述</span><span class="sxs-lookup"><span data-stu-id="2a580-189">Description</span></span>|  
|--------------------|-----------------|  
|<span data-ttu-id="2a580-190">Microsoft ActiveX Script</span><span class="sxs-lookup"><span data-stu-id="2a580-190">Microsoft ActiveX Script</span></span>|<span data-ttu-id="2a580-191">執行 ActiveX Scripting 作業步驟。</span><span class="sxs-lookup"><span data-stu-id="2a580-191">Run an ActiveX scripting job step.</span></span><br /><br /> <span data-ttu-id="2a580-192">\*\* \* \* 重要 \* 事項 \* \*\* ：在未來版本的中，將會從 Agent 中移除 ActiveX 腳本子系統 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="2a580-192">**\*\* Important \*\*** The ActiveX Scripting subsystem will be removed from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent in a future version of [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="2a580-193">請避免在新的開發工作中使用這項功能，並規劃修改目前使用這項功能的應用程式。</span><span class="sxs-lookup"><span data-stu-id="2a580-193">Avoid using this feature in new development work, and plan to modify applications that currently use this feature.</span></span>|  
|<span data-ttu-id="2a580-194">作業系統 (**CmdExec**)</span><span class="sxs-lookup"><span data-stu-id="2a580-194">Operating System (**CmdExec**)</span></span>|<span data-ttu-id="2a580-195">執行可執行的程式。</span><span class="sxs-lookup"><span data-stu-id="2a580-195">Run an executable program.</span></span>|  
|<span data-ttu-id="2a580-196">PowerShell</span><span class="sxs-lookup"><span data-stu-id="2a580-196">PowerShell</span></span>|<span data-ttu-id="2a580-197">執行 PowerShell 指令碼作業步驟。</span><span class="sxs-lookup"><span data-stu-id="2a580-197">Run a PowerShell scripting job step.</span></span>|  
|<span data-ttu-id="2a580-198">複寫散發者</span><span class="sxs-lookup"><span data-stu-id="2a580-198">Replication Distributor</span></span>|<span data-ttu-id="2a580-199">執行可啟動複寫「散發代理程式」的作業步驟。</span><span class="sxs-lookup"><span data-stu-id="2a580-199">Run a job step that activates the replication Distribution Agent.</span></span>|  
|<span data-ttu-id="2a580-200">複寫合併</span><span class="sxs-lookup"><span data-stu-id="2a580-200">Replication Merge</span></span>|<span data-ttu-id="2a580-201">執行可啟動複寫「合併代理程式」的作業步驟。</span><span class="sxs-lookup"><span data-stu-id="2a580-201">Run a job step that activates the replication Merge Agent.</span></span>|  
|<span data-ttu-id="2a580-202">複寫佇列讀取器</span><span class="sxs-lookup"><span data-stu-id="2a580-202">Replication Queue Reader</span></span>|<span data-ttu-id="2a580-203">執行可啟動複寫「佇列讀取器代理程式」的作業步驟。</span><span class="sxs-lookup"><span data-stu-id="2a580-203">Run a job step that activates the replication Queue Reader Agent.</span></span>|  
|<span data-ttu-id="2a580-204">複寫快照</span><span class="sxs-lookup"><span data-stu-id="2a580-204">Replication Snapshot</span></span>|<span data-ttu-id="2a580-205">執行可啟動複寫「快照代理程式」的作業步驟。</span><span class="sxs-lookup"><span data-stu-id="2a580-205">Run a job step that activates the replication Snapshot Agent.</span></span>|  
|<span data-ttu-id="2a580-206">複寫交易記錄讀取器</span><span class="sxs-lookup"><span data-stu-id="2a580-206">Replication Transaction Log Reader</span></span>|<span data-ttu-id="2a580-207">執行可啟動複寫「記錄讀取器代理程式」的作業步驟。</span><span class="sxs-lookup"><span data-stu-id="2a580-207">Run a job step that activates the replication Log Reader Agent.</span></span>|  
|[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="2a580-208">命令</span><span class="sxs-lookup"><span data-stu-id="2a580-208">Command</span></span>|<span data-ttu-id="2a580-209">執行 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 命令。</span><span class="sxs-lookup"><span data-stu-id="2a580-209">Run an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] command.</span></span>|  
|[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="2a580-210">查詢</span><span class="sxs-lookup"><span data-stu-id="2a580-210">Query</span></span>|<span data-ttu-id="2a580-211">執行 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 查詢。</span><span class="sxs-lookup"><span data-stu-id="2a580-211">Run an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] query.</span></span>|  
|[!INCLUDE[ssIS](../../includes/ssis-md.md)] <span data-ttu-id="2a580-212">封裝執行</span><span class="sxs-lookup"><span data-stu-id="2a580-212">package execution</span></span>|<span data-ttu-id="2a580-213">執行 [!INCLUDE[ssIS](../../includes/ssis-md.md)] 封裝。</span><span class="sxs-lookup"><span data-stu-id="2a580-213">Run an [!INCLUDE[ssIS](../../includes/ssis-md.md)] package.</span></span>|  
  
> [!NOTE]  
>  <span data-ttu-id="2a580-214">由於 [!INCLUDE[tsql](../../includes/tsql-md.md)] 作業步驟不使用 Proxy，因此沒有 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 作業步驟適用的 [!INCLUDE[tsql](../../includes/tsql-md.md)] Agent 子系統。</span><span class="sxs-lookup"><span data-stu-id="2a580-214">Because [!INCLUDE[tsql](../../includes/tsql-md.md)] job steps do not use proxies, there is no [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent subsystem for [!INCLUDE[tsql](../../includes/tsql-md.md)] job steps.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="2a580-215">Agent 會強制執行子系統限制，即使 Proxy 的安全性主體通常具有可執行作業步驟中工作的權限，亦是如此。</span><span class="sxs-lookup"><span data-stu-id="2a580-215">Agent enforces subsystem restrictions even when the security principal for the proxy would normally have permission to run the task in the job step.</span></span> <span data-ttu-id="2a580-216">例如，屬於系統管理員 (sysadmin) 固定伺服器角色成員之使用者的 Proxy，若沒有 [!INCLUDE[ssIS](../../includes/ssis-md.md)] 子系統的存取權，即無法執行 [!INCLUDE[ssIS](../../includes/ssis-md.md)] 作業步驟，即使使用者可執行 [!INCLUDE[ssIS](../../includes/ssis-md.md)] 封裝亦然。</span><span class="sxs-lookup"><span data-stu-id="2a580-216">For example, a proxy for a user that is a member of the sysadmin fixed server role cannot run an [!INCLUDE[ssIS](../../includes/ssis-md.md)] job step unless the proxy has access to the [!INCLUDE[ssIS](../../includes/ssis-md.md)] subsystem, even though the user can run [!INCLUDE[ssIS](../../includes/ssis-md.md)] packages.</span></span>  
  
### <a name="proxies"></a><span data-ttu-id="2a580-217">Proxy</span><span class="sxs-lookup"><span data-stu-id="2a580-217">Proxies</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="2a580-218">Agent 使用 Proxy 來管理安全性內容。</span><span class="sxs-lookup"><span data-stu-id="2a580-218">Agent uses proxies to manage security contexts.</span></span> <span data-ttu-id="2a580-219">一個 Proxy 可用於多個作業步驟。</span><span class="sxs-lookup"><span data-stu-id="2a580-219">A proxy can be used in more than one job step.</span></span> <span data-ttu-id="2a580-220">`sysadmin`固定伺服器角色的成員可以建立 proxy。</span><span class="sxs-lookup"><span data-stu-id="2a580-220">Members of the `sysadmin` fixed server role can create proxies.</span></span>  
  
 <span data-ttu-id="2a580-221">每個 Proxy 都對應於一個安全性認證。</span><span class="sxs-lookup"><span data-stu-id="2a580-221">Each proxy corresponds to a security credential.</span></span> <span data-ttu-id="2a580-222">每一個 Proxy 可以與一組子系統和一組登入產生關聯。</span><span class="sxs-lookup"><span data-stu-id="2a580-222">Each proxy can be associated with a set of subsystems and a set of logins.</span></span> <span data-ttu-id="2a580-223">Proxy 僅適用於使用該 Proxy 相關聯子系統的作業步驟。</span><span class="sxs-lookup"><span data-stu-id="2a580-223">The proxy can be used only for job steps that use a subsystem associated with the proxy.</span></span> <span data-ttu-id="2a580-224">若要建立使用特定 Proxy 的作業步驟，則作業擁有者必須使用與該 Proxy 相關的登入，或為可無限制存取 Proxy 的角色成員。</span><span class="sxs-lookup"><span data-stu-id="2a580-224">To create a job step that uses a specific proxy, the job owner must either use a login associated with that proxy or be a member of a role with unrestricted access to proxies.</span></span> <span data-ttu-id="2a580-225">固定伺服器角色的成員對 proxy `sysadmin` 具有不受限制的存取權。</span><span class="sxs-lookup"><span data-stu-id="2a580-225">Members of the `sysadmin` fixed server role have unrestricted access to proxies.</span></span> <span data-ttu-id="2a580-226">**SQLAgentUserRole**、 **SQLAgentReaderRole**或 **SQLAgentOperatorRole** 的成員，則只能使用他們已被授與特定存取權的 Proxy。</span><span class="sxs-lookup"><span data-stu-id="2a580-226">Members of **SQLAgentUserRole**, **SQLAgentReaderRole**, or **SQLAgentOperatorRole** can only use proxies to which they have been granted specific access.</span></span> <span data-ttu-id="2a580-227">屬於這些 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 固定資料庫角色成員的每一個使用者，必須被授與特定 Proxy 的存取權，才能建立使用這些 Proxy 的作業步驟。</span><span class="sxs-lookup"><span data-stu-id="2a580-227">Each user that is a member of any of these [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent fixed database roles must be granted access to specific proxies so that the user can create job steps that use those proxies.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="2a580-228">相關工作</span><span class="sxs-lookup"><span data-stu-id="2a580-228">Related Tasks</span></span>  
 <span data-ttu-id="2a580-229">您可以使用下列步驟設定 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent，以便自動化 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 管理：</span><span class="sxs-lookup"><span data-stu-id="2a580-229">Use the following steps to configure [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent to automate [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] administration:</span></span>  
  
1.  <span data-ttu-id="2a580-230">確認哪些管理工作或伺服器事件會定期發生，以及是否可以程式設計的方式管理這些工作或事件。</span><span class="sxs-lookup"><span data-stu-id="2a580-230">Establish which administrative tasks or server events occur regularly and whether these tasks or events can be administered programmatically.</span></span> <span data-ttu-id="2a580-231">如果工作包含一連串可預期的步驟，且在特定時間或為了回應特定事件而發生，則此工作就很適合自動執行。</span><span class="sxs-lookup"><span data-stu-id="2a580-231">A task is a good candidate for automation if it involves a predictable sequence of steps and occurs at a specific time or in response to a specific event.</span></span>  
  
2.  <span data-ttu-id="2a580-232">使用 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]、 [!INCLUDE[tsql](../../includes/tsql-md.md)] 指令碼或 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 管理物件 (SMO)，定義一組作業、排程、警示及運算子。</span><span class="sxs-lookup"><span data-stu-id="2a580-232">Define a set of jobs, schedules, alerts, and operators by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)] scripts, or [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Management Objects (SMO).</span></span> <span data-ttu-id="2a580-233">如需詳細資訊，請參閱 [建立作業](create-jobs.md)。</span><span class="sxs-lookup"><span data-stu-id="2a580-233">For more information, see [Create Jobs](create-jobs.md).</span></span>  
  
3.  <span data-ttu-id="2a580-234">執行您已定義的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 作業。</span><span class="sxs-lookup"><span data-stu-id="2a580-234">Run the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent jobs you have defined.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="2a580-235">針對 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]的預設執行個體而言， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 服務的名稱為 SQLSERVERAGENT。</span><span class="sxs-lookup"><span data-stu-id="2a580-235">For the default instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service is named SQLSERVERAGENT.</span></span> <span data-ttu-id="2a580-236">對於具名執行個體來說， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 服務的名稱為 SQLAgent$*instancename*。</span><span class="sxs-lookup"><span data-stu-id="2a580-236">For named instances, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service is named SQLAgent$*instancename*.</span></span>  
  
 <span data-ttu-id="2a580-237">如果您執行多個 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]執行個體，您可以利用多伺服器管理來自動化所有執行個體間通用的工作。</span><span class="sxs-lookup"><span data-stu-id="2a580-237">If you are running multiple instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], you can use multiserver administration to automate tasks common across all instances.</span></span> <span data-ttu-id="2a580-238">如需詳細資訊，請參閱 [將整個企業的管理自動化](automated-administration-across-an-enterprise.md)。</span><span class="sxs-lookup"><span data-stu-id="2a580-238">For more information, see [Automated Administration Across an Enterprise](automated-administration-across-an-enterprise.md).</span></span>  
  
 <span data-ttu-id="2a580-239">若要開始使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent，請使用下列工作：</span><span class="sxs-lookup"><span data-stu-id="2a580-239">Use the following tasks to get started with [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent:</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="2a580-240">**說明**</span><span class="sxs-lookup"><span data-stu-id="2a580-240">**Description**</span></span>|<span data-ttu-id="2a580-241">**主題**</span><span class="sxs-lookup"><span data-stu-id="2a580-241">**Topic**</span></span>|  
|<span data-ttu-id="2a580-242">描述如何設定 SQL Server Agent。</span><span class="sxs-lookup"><span data-stu-id="2a580-242">Describes how to configure SQL Server Agent.</span></span>|[<span data-ttu-id="2a580-243">設定 SQL Server Agent</span><span class="sxs-lookup"><span data-stu-id="2a580-243">Configure SQL Server Agent</span></span>](configure-sql-server-agent.md)|  
|<span data-ttu-id="2a580-244">描述如何啟動、停止和暫停 SQL Server Agent 服務。</span><span class="sxs-lookup"><span data-stu-id="2a580-244">Describes how to start, stop, and pause the SQL Server Agent service.</span></span>|[<span data-ttu-id="2a580-245">啟動、停止或暫停 SQL Server Agent 服務</span><span class="sxs-lookup"><span data-stu-id="2a580-245">Start, Stop, or Pause the SQL Server Agent Service</span></span>](start-stop-or-pause-the-sql-server-agent-service.md)|  
|<span data-ttu-id="2a580-246">描述指定 SQL Server Agent 服務之帳戶的考量。</span><span class="sxs-lookup"><span data-stu-id="2a580-246">Describes considerations for specifying an account for the SQL Server Agent service.</span></span>|[<span data-ttu-id="2a580-247">選取 SQL Server Agent 服務的帳戶</span><span class="sxs-lookup"><span data-stu-id="2a580-247">Select an Account for the SQL Server Agent Service</span></span>](select-an-account-for-the-sql-server-agent-service.md)|  
|<span data-ttu-id="2a580-248">描述如何使用 SQL Server Agent 錯誤記錄檔。</span><span class="sxs-lookup"><span data-stu-id="2a580-248">Describes how to use the SQL Server Agent error log.</span></span>|[<span data-ttu-id="2a580-249">SQL Server Agent 錯誤記錄檔</span><span class="sxs-lookup"><span data-stu-id="2a580-249">SQL Server Agent Error Log</span></span>](sql-server-agent-error-log.md)|  
|||  
|<span data-ttu-id="2a580-250">描述如何使用效能物件。</span><span class="sxs-lookup"><span data-stu-id="2a580-250">Describes how to use performance objects.</span></span>|[<span data-ttu-id="2a580-251">使用效能物件</span><span class="sxs-lookup"><span data-stu-id="2a580-251">Use Performance Objects</span></span>](use-performance-objects.md)|  
|<span data-ttu-id="2a580-252">描述維護計畫精靈，它是一個公用程式，可協助您用來建立作業、警示和操作員來自動化管理 SQL Server 的執行個體。</span><span class="sxs-lookup"><span data-stu-id="2a580-252">Describes the Maintenance Plan Wizard, which is a utility that you can use to help create jobs, alerts, and operators to automate administration of an instance of SQL Server.</span></span>|[<span data-ttu-id="2a580-253">使用維護計畫精靈</span><span class="sxs-lookup"><span data-stu-id="2a580-253">Use the Maintenance Plan Wizard</span></span>](../../relational-databases/maintenance-plans/use-the-maintenance-plan-wizard.md)|  
|<span data-ttu-id="2a580-254">描述如何使用 SQL Server Agent 自動化管理工作。</span><span class="sxs-lookup"><span data-stu-id="2a580-254">Describes how to automate administrative tasks using SQL Server Agent.</span></span>|[<span data-ttu-id="2a580-255">自動化管理工作 &#40;SQL Server Agent&#41;</span><span class="sxs-lookup"><span data-stu-id="2a580-255">Automated Administration Tasks &#40;SQL Server Agent&#41;</span></span>](automated-administration-tasks-sql-server-agent.md)|  
  
## <a name="see-also"></a><span data-ttu-id="2a580-256">另請參閱</span><span class="sxs-lookup"><span data-stu-id="2a580-256">See Also</span></span>  
 [<span data-ttu-id="2a580-257">介面區組態</span><span class="sxs-lookup"><span data-stu-id="2a580-257">Surface Area Configuration</span></span>](../../relational-databases/security/surface-area-configuration.md)  
  
  
