---
title: 摺疊資料列群組 (Visual Database Tools) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- group collapsing [SQL Server]
- collapsing rows
- row collapsing [SQL Server]
ms.assetid: 7338dad0-965d-44ba-8c1a-b993acb7156d
author: stevestein
ms.author: sstein
ms.openlocfilehash: f7ec2f3072f9fea7c96179934924421080e75821
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87594295"
---
# <a name="collapse-groups-of-rows-visual-database-tools"></a><span data-ttu-id="b27db-102">摺疊資料列群組 (Visual Database Tools)</span><span class="sxs-lookup"><span data-stu-id="b27db-102">Collapse Groups of Rows (Visual Database Tools)</span></span>
  <span data-ttu-id="b27db-103">可以建立一種查詢結果，其中各結果資料列對應至原始資料的完整資料列群組。</span><span class="sxs-lookup"><span data-stu-id="b27db-103">You can create a query result in which each result row corresponds to an entire group of rows from the original data.</span></span> <span data-ttu-id="b27db-104">摺疊資料列時，請注意下列事項：</span><span class="sxs-lookup"><span data-stu-id="b27db-104">When collapsing rows, there are several things to keep in mind:</span></span>  
  
-   <span data-ttu-id="b27db-105">**您可以排除重複的資料列** ：有些查詢建立的結果集中會產生許多完全相同的資料列。</span><span class="sxs-lookup"><span data-stu-id="b27db-105">**You can eliminate duplicate rows** Some queries can create result sets in which multiple identical rows appear.</span></span> <span data-ttu-id="b27db-106">例如，您可以建立結果集，其中每個資料列都包含城市以及某個城市 (含有一個作者) 所在的州名；但如果某個城市含有數個作者，則將產生數個相同的資料列。</span><span class="sxs-lookup"><span data-stu-id="b27db-106">For example, you can create a result set in which each row contains the city and state name of a city containing an author - but if a city contains several authors, there will be several identical rows.</span></span> <span data-ttu-id="b27db-107">產生的 SQL 將如下所示：</span><span class="sxs-lookup"><span data-stu-id="b27db-107">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state  
    FROM authors  
    ```  
  
     <span data-ttu-id="b27db-108">上述查詢產生的結果集並不是很有用。</span><span class="sxs-lookup"><span data-stu-id="b27db-108">The result set generated by the preceding query is not very useful.</span></span> <span data-ttu-id="b27db-109">如果某個城市含有四個作者，該結果集將包含四個完全一樣的資料列。</span><span class="sxs-lookup"><span data-stu-id="b27db-109">If a city contains four authors, the result set will include four identical rows.</span></span> <span data-ttu-id="b27db-110">由於結果列不包含城市和州以外的資料行，因此無法進一步區分這些完全相同的資料行。</span><span class="sxs-lookup"><span data-stu-id="b27db-110">Since the result set does not include any columns other than city and state, there is no way to distinguish the identical rows from each other.</span></span> <span data-ttu-id="b27db-111">要避免這種重複的資料列，將其他可區分這些資料列的其他資料行納入結果集。</span><span class="sxs-lookup"><span data-stu-id="b27db-111">One way to avoid such duplicate rows is to include additional columns that can make the rows different.</span></span> <span data-ttu-id="b27db-112">例如，如果您納入作者名稱，則每個資料列都將變成不同 (假設任何一個城市中並沒有兩個命名相似的作者)。</span><span class="sxs-lookup"><span data-stu-id="b27db-112">For example, if you include author name, each row will be different (provided no two like-named authors live within any one city).</span></span> <span data-ttu-id="b27db-113">產生的 SQL 將如下所示：</span><span class="sxs-lookup"><span data-stu-id="b27db-113">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state, fname, minit, lname  
    FROM authors  
  
    ```  
  
     <span data-ttu-id="b27db-114">當然上述查詢只可排除這個問題，但無法真正解決該問題。</span><span class="sxs-lookup"><span data-stu-id="b27db-114">Of course, the preceding query eliminates the symptom, but does not really solve the problem.</span></span> <span data-ttu-id="b27db-115">也就是說，雖然該結果集中沒有重複項目，但它再也不是城市的結果集了。</span><span class="sxs-lookup"><span data-stu-id="b27db-115">That is, the result set has no duplicates, but it is no longer a result set about cities.</span></span> <span data-ttu-id="b27db-116">若要排除原始結果集中的重複項目，但同時仍然保有每個說明城市的資料列，您可以建立僅傳回不同資料列的查詢。</span><span class="sxs-lookup"><span data-stu-id="b27db-116">To eliminate duplicates in the original result set, and still have each row describe a city, you can create a query returning only distinct rows.</span></span> <span data-ttu-id="b27db-117">產生的 SQL 將如下所示：</span><span class="sxs-lookup"><span data-stu-id="b27db-117">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT DISTINCT city, state  
    FROM authors  
  
    ```  
  
     <span data-ttu-id="b27db-118">如需排除重複項目的詳細資訊，請參閱[排除重複的資料列 &#40;Visual Database Tools&#41;](visual-database-tools.md)。</span><span class="sxs-lookup"><span data-stu-id="b27db-118">For details about eliminating duplicates, see [Exclude Duplicate Rows &#40;Visual Database Tools&#41;](visual-database-tools.md).</span></span>  
  
-   <span data-ttu-id="b27db-119">**您可以計算資料列群組**：也就是說，您可以摘要報告資料列群組的資訊。</span><span class="sxs-lookup"><span data-stu-id="b27db-119">**You can calculate on groups of rows** That is, you can summarize information in groups of rows.</span></span> <span data-ttu-id="b27db-120">例如，您可以建立結果集，其中每個資料列都含有城市和含有某位作者的城市所在州名，以及該城市所含之作者數目。</span><span class="sxs-lookup"><span data-stu-id="b27db-120">For example, you can create a result set in which each row contains the city and state name of a city containing an author, plus a count of the number of authors contained in that city.</span></span> <span data-ttu-id="b27db-121">產生的 SQL 將如下所示：</span><span class="sxs-lookup"><span data-stu-id="b27db-121">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state, COUNT(*)  
    FROM authors  
    GROUP BY city, state  
  
    ```  
  
     <span data-ttu-id="b27db-122">如需計算資料列群組的詳細資訊，請參閱[摘要查詢結果 &#40;Visual Database Tools&#41;](summarize-query-results-visual-database-tools.md) 和 [排序及分組查詢結果 &#40;Visual Database Tools&#41;](sort-and-group-query-results-visual-database-tools.md)。</span><span class="sxs-lookup"><span data-stu-id="b27db-122">For details about calculating on groups of rows, see [Summarize Query Results &#40;Visual Database Tools&#41;](summarize-query-results-visual-database-tools.md) and [Sort and Group Query Results &#40;Visual Database Tools&#41;](sort-and-group-query-results-visual-database-tools.md).</span></span>  
  
-   <span data-ttu-id="b27db-123">**您可以使用選擇標準來包含資料列群組**：例如，您可以建立結果集，其中每個資料列都包含城市和含有數位作者的城市所在州名，以及該城市所含之作者數目。</span><span class="sxs-lookup"><span data-stu-id="b27db-123">**You can use selection criteria to include groups of rows** For example, you can create a result set in which each row contains the city and state name of a city containing several authors, plus a count of the number of authors contained in that city.</span></span> <span data-ttu-id="b27db-124">產生的 SQL 將如下所示：</span><span class="sxs-lookup"><span data-stu-id="b27db-124">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state, COUNT(*)  
    FROM authors  
    GROUP BY city, state  
    HAVING COUNT(*) > 1  
  
    ```  
  
     <span data-ttu-id="b27db-125">如需對資料列群組套用選取準則的詳細資訊，請參閱[指定群組條件 &#40;Visual Database Tools&#41;](specify-conditions-for-groups-visual-database-tools.md) 和[在相同查詢中使用 HAVING 和 WHERE 子句 &#40;Visual Database Tools&#41;](use-having-and-where-clauses-in-the-same-query-visual-database-tools.md)。</span><span class="sxs-lookup"><span data-stu-id="b27db-125">For details about applying selection criteria on groups of rows, see [Specify Conditions for Groups &#40;Visual Database Tools&#41;](specify-conditions-for-groups-visual-database-tools.md) and [Use HAVING and WHERE Clauses in the Same Query &#40;Visual Database Tools&#41;](use-having-and-where-clauses-in-the-same-query-visual-database-tools.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b27db-126">另請參閱</span><span class="sxs-lookup"><span data-stu-id="b27db-126">See Also</span></span>  
 <span data-ttu-id="b27db-127">[&#40;Visual Database Tools 指定搜尋準則&#41;](specify-search-criteria-visual-database-tools.md) </span><span class="sxs-lookup"><span data-stu-id="b27db-127">[Specify Search Criteria &#40;Visual Database Tools&#41;](specify-search-criteria-visual-database-tools.md) </span></span>  
 [<span data-ttu-id="b27db-128">設計查詢和檢視使用說明主題 &#40;Visual Database Tools&#41;</span><span class="sxs-lookup"><span data-stu-id="b27db-128">Design Queries and Views How-to Topics &#40;Visual Database Tools&#41;</span></span>](design-queries-and-views-how-to-topics-visual-database-tools.md)  
  
  
