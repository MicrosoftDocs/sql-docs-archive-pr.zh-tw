---
title: 在 SQL Server Profiler 中使用 SHOWPLAN 結果分析查詢 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: profiler
ms.topic: conceptual
helpviewer_keywords:
- events [SQL Server], Showplan
- Profiler [SQL Server Profiler], Showplan results
- SQL Server Profiler, Showplan results
ms.assetid: 6a2f7727-141c-4f59-8613-2e452bc78467
author: stevestein
ms.author: sstein
ms.openlocfilehash: 2ada8b565a307bf636e06c7b5acb5fd4da5f30df
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87686610"
---
# <a name="analyze-queries-with-showplan-results-in-sql-server-profiler"></a><span data-ttu-id="a38d7-102">在 SQL Server Profiler 中使用 SHOWPLAN 結果分析查詢</span><span class="sxs-lookup"><span data-stu-id="a38d7-102">Analyze Queries with SHOWPLAN Results in SQL Server Profiler</span></span>
  <span data-ttu-id="a38d7-103">您可以將 Showplan 事件類別加入至追蹤定義中，讓 [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] 蒐集查詢計畫資訊並顯示在追蹤中。</span><span class="sxs-lookup"><span data-stu-id="a38d7-103">You can add Showplan event classes to a trace definition that cause [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] to gather and display query plan information in the trace.</span></span> <span data-ttu-id="a38d7-104">您也可以從追蹤所收集的其他事件中擷取顯示計畫事件，並將這些顯示計畫事件儲存在個別的 XML 檔案中。</span><span class="sxs-lookup"><span data-stu-id="a38d7-104">It is also possible to extract Showplan events from the other events collected in the trace and to save these Showplan events in a separate XML file.</span></span>  
  
 <span data-ttu-id="a38d7-105">若要從追蹤中擷取顯示計畫事件，可以使用下列其中一個方式來進行：</span><span class="sxs-lookup"><span data-stu-id="a38d7-105">Extracting Showplan events from the trace can be done in any of the following ways:</span></span>  
  
-   <span data-ttu-id="a38d7-106">在追蹤組態時，使用 [事件擷取設定]  索引標籤。請注意，必須先選取 [事件選取範圍]  索引標籤上的其中一個 Showplan 事件，此索引標籤才會顯示。</span><span class="sxs-lookup"><span data-stu-id="a38d7-106">At trace configuration time, using the **Events Extraction Settings** tab. Note that this tab does not appear until you select a one of the Showplan events on the **Events Selection** tab.</span></span>  
  
-   <span data-ttu-id="a38d7-107">使用 [檔案]  功能表上的 [擷取 SQL Server 事件]  選項。</span><span class="sxs-lookup"><span data-stu-id="a38d7-107">Using the **Extract SQL Server Events** option on the **File** menu.</span></span>  
  
-   <span data-ttu-id="a38d7-108">您可以用滑鼠右鍵按一下個別事件，然後選擇 [擷取事件資料]  ，以擷取並儲存個別事件。</span><span class="sxs-lookup"><span data-stu-id="a38d7-108">By extracting and saving individual events by right-clicking a specific event and choosing **Extract Event Data**.</span></span>  
  
## <a name="showplan-events"></a><span data-ttu-id="a38d7-109">顯示計畫事件</span><span class="sxs-lookup"><span data-stu-id="a38d7-109">Showplan Events</span></span>  
 <span data-ttu-id="a38d7-110">下表列出並說明顯示計畫追蹤事件。</span><span class="sxs-lookup"><span data-stu-id="a38d7-110">The Showplan trace events are listed and described in the following table.</span></span>  
  
|<span data-ttu-id="a38d7-111">事件名稱</span><span class="sxs-lookup"><span data-stu-id="a38d7-111">Event name</span></span>|<span data-ttu-id="a38d7-112">描述</span><span class="sxs-lookup"><span data-stu-id="a38d7-112">Description</span></span>|  
|----------------|-----------------|  
|<span data-ttu-id="a38d7-113">**Performance statistics**</span><span class="sxs-lookup"><span data-stu-id="a38d7-113">**Performance statistics**</span></span>|<span data-ttu-id="a38d7-114">指出第一次快取已編譯顯示計畫的時間、其重新編譯的時間，以及從計畫快取中卸除的時間。</span><span class="sxs-lookup"><span data-stu-id="a38d7-114">Indicates the first time a compiled Showplan is cached, when it is recompiled, and when it is dropped from the plan cache.</span></span> <span data-ttu-id="a38d7-115">**TextData** 資料行中包含了 XML 格式的顯示計畫。</span><span class="sxs-lookup"><span data-stu-id="a38d7-115">The **TextData** column contains the Showplan in XML format.</span></span> <span data-ttu-id="a38d7-116">如需詳細資訊，請參閱 [Performance Statistics 事件類別](../../relational-databases/event-classes/performance-statistics-event-class.md)。</span><span class="sxs-lookup"><span data-stu-id="a38d7-116">For more information, see [Performance Statistics Event Class](../../relational-databases/event-classes/performance-statistics-event-class.md).</span></span>|  
|<span data-ttu-id="a38d7-117">**Showplan All**</span><span class="sxs-lookup"><span data-stu-id="a38d7-117">**Showplan All**</span></span>|<span data-ttu-id="a38d7-118">所顯示的查詢計畫，含有已執行之 [!INCLUDE[tsql](../../includes/tsql-md.md)] 陳述式的完整編譯詳細資料。</span><span class="sxs-lookup"><span data-stu-id="a38d7-118">Displays the query plan with full compilation details of the executed [!INCLUDE[tsql](../../includes/tsql-md.md)] statement.</span></span> <span data-ttu-id="a38d7-119">例如，其中可能會顯示成本估計與資料行清單。</span><span class="sxs-lookup"><span data-stu-id="a38d7-119">For example, it might display costing estimates and column lists.</span></span> <span data-ttu-id="a38d7-120">如需詳細資訊，請參閱 [Showplan All 事件類別](../../relational-databases/event-classes/showplan-all-event-class.md)。</span><span class="sxs-lookup"><span data-stu-id="a38d7-120">For more information, see [Showplan All Event Class](../../relational-databases/event-classes/showplan-all-event-class.md).</span></span>|  
|<span data-ttu-id="a38d7-121">**Showplan All For Query Compile**</span><span class="sxs-lookup"><span data-stu-id="a38d7-121">**Showplan All For Query Compile**</span></span>|<span data-ttu-id="a38d7-122">會在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]上編譯或重新編譯查詢時發生。</span><span class="sxs-lookup"><span data-stu-id="a38d7-122">Occurs when a query is compiled or recompiled on [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="a38d7-123">這是 **Showplan All** 事件的編譯時間對應項目。</span><span class="sxs-lookup"><span data-stu-id="a38d7-123">This is the compile time counterpart of the **Showplan All** event.</span></span> <span data-ttu-id="a38d7-124">**Showplan All** 在執行查詢時發生。</span><span class="sxs-lookup"><span data-stu-id="a38d7-124">**Showplan All** occurs when a query is executed.</span></span> <span data-ttu-id="a38d7-125">**Showplan All For Query Compile** 則在編譯查詢時發生。</span><span class="sxs-lookup"><span data-stu-id="a38d7-125">**Showplan All For Query Compile** occurs when a query is compiled.</span></span> <span data-ttu-id="a38d7-126">如需詳細資訊，請參閱 [Showplan All for Query Compile 事件類別](../../relational-databases/event-classes/showplan-all-for-query-compile-event-class.md)。</span><span class="sxs-lookup"><span data-stu-id="a38d7-126">For more information, see [Showplan All for Query Compile Event Class](../../relational-databases/event-classes/showplan-all-for-query-compile-event-class.md).</span></span>|  
|<span data-ttu-id="a38d7-127">**Showplan Statistics Profile**</span><span class="sxs-lookup"><span data-stu-id="a38d7-127">**Showplan Statistics Profile**</span></span>|<span data-ttu-id="a38d7-128">顯示含有執行中 [!INCLUDE[tsql](../../includes/tsql-md.md)] 陳述式之完整執行階段詳細資料的查詢計畫，包括從每個作業所傳遞的實際資料列數目。</span><span class="sxs-lookup"><span data-stu-id="a38d7-128">Displays the query plan with full run-time details of the [!INCLUDE[tsql](../../includes/tsql-md.md)] statement being executed, including the actual number of rows passing through each operation.</span></span> <span data-ttu-id="a38d7-129">如需詳細資訊，請參閱 [Showplan Statistics Profile 事件類別](../../relational-databases/event-classes/showplan-statistics-profile-event-class.md)。</span><span class="sxs-lookup"><span data-stu-id="a38d7-129">For more information, see [Showplan Statistics Profile Event Class](../../relational-databases/event-classes/showplan-statistics-profile-event-class.md).</span></span>|  
|<span data-ttu-id="a38d7-130">**Showplan Text**</span><span class="sxs-lookup"><span data-stu-id="a38d7-130">**Showplan Text**</span></span>|<span data-ttu-id="a38d7-131">以二進位資料顯示執行中 [!INCLUDE[tsql](../../includes/tsql-md.md)] 陳述式的查詢計畫樹狀目錄。</span><span class="sxs-lookup"><span data-stu-id="a38d7-131">Displays as binary data the query plan tree of the [!INCLUDE[tsql](../../includes/tsql-md.md)] statement being executed.</span></span> <span data-ttu-id="a38d7-132">如需詳細資訊，請參閱 [Showplan Text 事件類別](../../relational-databases/event-classes/showplan-text-event-class.md)。</span><span class="sxs-lookup"><span data-stu-id="a38d7-132">For more information, see [Showplan Text Event Class](../../relational-databases/event-classes/showplan-text-event-class.md).</span></span>|  
|<span data-ttu-id="a38d7-133">**Showplan Text (Unencoded)**</span><span class="sxs-lookup"><span data-stu-id="a38d7-133">**Showplan Text (Unencoded)**</span></span>|<span data-ttu-id="a38d7-134">以文字形式顯示執行中 [!INCLUDE[tsql](../../includes/tsql-md.md)] 陳述式的查詢計畫樹狀目錄。</span><span class="sxs-lookup"><span data-stu-id="a38d7-134">Displays as text the query plan tree of the [!INCLUDE[tsql](../../includes/tsql-md.md)] statement being executed.</span></span> <span data-ttu-id="a38d7-135">此事件類別會顯示與 Showplan Text 相同的資訊，差別在於此事件類別顯示的是文字，而非二進位資料。</span><span class="sxs-lookup"><span data-stu-id="a38d7-135">This event class displays the same information as Showplan Text, except that this event class displays text instead of binary data.</span></span> <span data-ttu-id="a38d7-136">如需詳細資訊，請參閱 [Showplan Text &#40;Unencoded&#41; 事件類別](../../relational-databases/event-classes/showplan-text-unencoded-event-class.md)。</span><span class="sxs-lookup"><span data-stu-id="a38d7-136">For more information, see [Showplan Text &#40;Unencoded&#41; Event Class](../../relational-databases/event-classes/showplan-text-unencoded-event-class.md).</span></span>|  
|<span data-ttu-id="a38d7-137">**Showplan XML**</span><span class="sxs-lookup"><span data-stu-id="a38d7-137">**Showplan XML**</span></span>|<span data-ttu-id="a38d7-138">顯示的查詢計畫，含有在查詢最佳化期間收集到的完整資料。</span><span class="sxs-lookup"><span data-stu-id="a38d7-138">Displays the query plan with full data collected during query optimization.</span></span> <span data-ttu-id="a38d7-139">只有在查詢計畫最佳化時，才會產生此事件。</span><span class="sxs-lookup"><span data-stu-id="a38d7-139">This event is generated only when a query plan is optimized.</span></span> <span data-ttu-id="a38d7-140">如需詳細資訊，請參閱 [Showplan XML 事件類別](../../relational-databases/event-classes/showplan-xml-event-class.md)。</span><span class="sxs-lookup"><span data-stu-id="a38d7-140">For more information, see [Showplan XML Event Class](../../relational-databases/event-classes/showplan-xml-event-class.md).</span></span>|  
|<span data-ttu-id="a38d7-141">**Showplan XML For Query Compile**</span><span class="sxs-lookup"><span data-stu-id="a38d7-141">**Showplan XML For Query Compile**</span></span>|<span data-ttu-id="a38d7-142">顯示查詢進行編譯時的查詢計畫。</span><span class="sxs-lookup"><span data-stu-id="a38d7-142">Displays the query plan when the query is compiled.</span></span> <span data-ttu-id="a38d7-143">如需詳細資訊，請參閱 [Showplan XML for Query Compile 事件類別](../../relational-databases/event-classes/showplan-xml-for-query-compile-event-class.md)。</span><span class="sxs-lookup"><span data-stu-id="a38d7-143">For more information, see [Showplan XML for Query Compile Event Class](../../relational-databases/event-classes/showplan-xml-for-query-compile-event-class.md).</span></span>|  
|<span data-ttu-id="a38d7-144">**Showplan XML Statistics Profile**</span><span class="sxs-lookup"><span data-stu-id="a38d7-144">**Showplan XML Statistics Profile**</span></span>|<span data-ttu-id="a38d7-145">所顯示的查詢計畫，含有 XML 格式的完整執行時間詳細資料。</span><span class="sxs-lookup"><span data-stu-id="a38d7-145">Displays the query plan with full run-time details in XML format.</span></span> <span data-ttu-id="a38d7-146">例如，此事件類別會擷取執行中 [!INCLUDE[tsql](../../includes/tsql-md.md)] 陳述式中，每個運算子所通過的資料列數。</span><span class="sxs-lookup"><span data-stu-id="a38d7-146">For example, this event class captures the number of rows passing through each operator of the [!INCLUDE[tsql](../../includes/tsql-md.md)] statement that is executed.</span></span> <span data-ttu-id="a38d7-147">如需詳細資訊，請參閱 [Showplan XML Statistics Profile 事件類別](../../relational-databases/event-classes/showplan-xml-statistics-profile-event-class.md)。</span><span class="sxs-lookup"><span data-stu-id="a38d7-147">For more information, see [Showplan XML Statistics Profile Event Class](../../relational-databases/event-classes/showplan-xml-statistics-profile-event-class.md).</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="a38d7-148">另請參閱</span><span class="sxs-lookup"><span data-stu-id="a38d7-148">See Also</span></span>  
 [<span data-ttu-id="a38d7-149">Performance 事件類別目錄</span><span class="sxs-lookup"><span data-stu-id="a38d7-149">Performance Event Category</span></span>](../../relational-databases/event-classes/performance-event-category.md)  
  
  
