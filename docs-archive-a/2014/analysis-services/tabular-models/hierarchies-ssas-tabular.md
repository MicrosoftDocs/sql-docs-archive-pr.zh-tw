---
title: SSAS 表格式) 的階層 (|Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: e3e50e89-f85d-485b-a271-1e0550520212
author: minewiskan
ms.author: owend
ms.openlocfilehash: a50b014dd6096b0bfa66ff34389789fcd34efdae
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87687233"
---
# <a name="hierarchies-ssas-tabular"></a><span data-ttu-id="4fe80-102">階層 (SSAS 表格式)</span><span class="sxs-lookup"><span data-stu-id="4fe80-102">Hierarchies (SSAS Tabular)</span></span>
  <span data-ttu-id="4fe80-103">表格式模型中的階層是中繼資料，可定義資料表中兩個 (含) 以上的資料行之間的關聯性。</span><span class="sxs-lookup"><span data-stu-id="4fe80-103">Hierarchies, in tabular models, are metadata that define relationships between two or more columns in a table.</span></span> <span data-ttu-id="4fe80-104">在報表用戶端欄位清單中，階層可以與其他資料行分開顯示，讓用戶端使用者更易於導覽及包含在報表中。</span><span class="sxs-lookup"><span data-stu-id="4fe80-104">Hierarchies can appear separate from other columns in a reporting client field list, making them easier for client users to navigate and include in a report.</span></span>  
  
 <span data-ttu-id="4fe80-105">本主題的章節：</span><span class="sxs-lookup"><span data-stu-id="4fe80-105">Sections in this topic:</span></span>  
  
-   [<span data-ttu-id="4fe80-106">優點</span><span class="sxs-lookup"><span data-stu-id="4fe80-106">Benefits</span></span>](#bkmk_benefits)  
  
-   [<span data-ttu-id="4fe80-107">定義階層</span><span class="sxs-lookup"><span data-stu-id="4fe80-107">Defining Hierarchies</span></span>](#bkmk_define)  
  
-   [<span data-ttu-id="4fe80-108">相關工作</span><span class="sxs-lookup"><span data-stu-id="4fe80-108">Related Tasks</span></span>](#bkmk_related_tasks)  
  
##  <a name="benefits"></a><a name="bkmk_benefits"></a> <span data-ttu-id="4fe80-109">優點</span><span class="sxs-lookup"><span data-stu-id="4fe80-109">Benefits</span></span>  
 <span data-ttu-id="4fe80-110">資料表可以包含數十個或甚至數百個具有不常見資料行名稱的資料行，且沒有明顯的順序。</span><span class="sxs-lookup"><span data-stu-id="4fe80-110">Tables can include dozens or even hundreds of columns with unusual column names in no apparent order.</span></span> <span data-ttu-id="4fe80-111">這可能會導致未排序的報表用戶端欄位清單外觀，讓使用者很難在報表中尋找及包含資料。</span><span class="sxs-lookup"><span data-stu-id="4fe80-111">This can lead to an unordered appearance in reporting client field lists, making it difficult for users to find and include data in a report.</span></span> <span data-ttu-id="4fe80-112">階層可以針對複雜的資料結構，提供簡單直覺式的檢視。</span><span class="sxs-lookup"><span data-stu-id="4fe80-112">Hierarchies can provide a simple, intuitive view of an otherwise complex data structure.</span></span>  
  
 <span data-ttu-id="4fe80-113">例如，您可以在 Date 資料表中建立 Calendar 階層。</span><span class="sxs-lookup"><span data-stu-id="4fe80-113">For example, in a Date table, you can create a Calendar hierarchy.</span></span> <span data-ttu-id="4fe80-114">Calendar Year 做為最上層的父層級，而 Month、Week 和 Day 則加入做為子層級 (Calendar Year->Month->Week->Day)。</span><span class="sxs-lookup"><span data-stu-id="4fe80-114">Calendar Year is used as the top-most parent level, with Month, Week, and Day included as child levels (Calendar Year->Month->Week->Day).</span></span> <span data-ttu-id="4fe80-115">此階層顯示從 [日曆年度] 到 [天] 的邏輯關聯性。</span><span class="sxs-lookup"><span data-stu-id="4fe80-115">This hierarchy shows a logical relationship from Calendar Year to Day.</span></span> <span data-ttu-id="4fe80-116">用戶端使用者可以接著從 [欄位清單] 中選取 [日曆年度]，以在樞紐分析表中包含所有層級，或者展開階層，然後僅選取要包含在樞紐分析表中的特定層級。</span><span class="sxs-lookup"><span data-stu-id="4fe80-116">A client user can then select Calendar Year from a Field List to include all levels in a PivotTable, or expand the hierarchy, and select only particular levels to be included in the PivotTable.</span></span>  
  
 <span data-ttu-id="4fe80-117">由於階層中的每個層級各代表資料表中的一個資料行，因此您可以重新命名層級。</span><span class="sxs-lookup"><span data-stu-id="4fe80-117">Because each level in a hierarchy is a representation of a column in a table, the level can be renamed.</span></span> <span data-ttu-id="4fe80-118">重新命名並不僅限於階層 (表格式模型中的任何資料行都可以重新命名)，而重新命名階層層級可讓使用者更容易在報表中尋找及包含層級。</span><span class="sxs-lookup"><span data-stu-id="4fe80-118">While not exclusive to hierarchies (any column can be renamed in a tabular model), renaming hierarchy levels can make it easier for users to find and include levels in a report.</span></span> <span data-ttu-id="4fe80-119">重新命名層級只會讓層級更容易識別，並不會重新命名層級參考的資料行。</span><span class="sxs-lookup"><span data-stu-id="4fe80-119">Renaming a level does not rename the column it references; it simply makes the level more identifiable.</span></span> <span data-ttu-id="4fe80-120">以 [日曆年度] 階層為例，在 [資料檢視] 的 Date 資料表中，[CalendarYear]、[CalendarMonth]、[CalendarWeek] 及 [CalendarDay] 資料行已分別重新命名為 [日曆年度]、[月]、[週] 及 [天]，因此更容易識別。</span><span class="sxs-lookup"><span data-stu-id="4fe80-120">In our Calendar Year hierarchy example, in the Date table in Data View, the columns: CalendarYear, CalendarMonth, CalendarWeek, and CalendarDay were renamed to Calendar Year, Month, Week, and Day to make them more easily identifiable.</span></span> <span data-ttu-id="4fe80-121">重新命名層級還有一個優點，那就是提供報表內容的一致性，因為使用者比較不可能需要變更資料行名稱，以便在樞紐分析表、圖表等中更容易閱讀。</span><span class="sxs-lookup"><span data-stu-id="4fe80-121">Renaming levels has the additional benefit of providing consistency in reports, since users will less likely need to change column names to make them more readable in PivotTables, charts, etc.</span></span>  
  
 <span data-ttu-id="4fe80-122">階層可以包含在檢視方塊中。</span><span class="sxs-lookup"><span data-stu-id="4fe80-122">Hierarchies can be included in perspectives.</span></span> <span data-ttu-id="4fe80-123">檢視方塊會定義可檢視之模型子集，對模型提供具體的商務特有或應用程式特有視點。</span><span class="sxs-lookup"><span data-stu-id="4fe80-123">Perspectives define viewable subsets of a model that provide focused, business-specific, or application-specific viewpoints of the model.</span></span> <span data-ttu-id="4fe80-124">例如，檢視方塊可以根據使用者特定的報表需求，提供必要資料項目的可檢視清單 (階層)。</span><span class="sxs-lookup"><span data-stu-id="4fe80-124">A perspective, for example, could provide users a viewable list (hierarchy) of only those data items necessary for their specific reporting requirements.</span></span> <span data-ttu-id="4fe80-125">如需詳細資訊，請參閱 [檢視方塊 &#40;SSAS 表格式&#41;](perspectives-ssas-tabular.md)。</span><span class="sxs-lookup"><span data-stu-id="4fe80-125">For more information, see [Perspectives &#40;SSAS Tabular&#41;](perspectives-ssas-tabular.md).</span></span>  
  
 <span data-ttu-id="4fe80-126">階層並非用來做為安全性機制，而是用來提供較佳使用者體驗的工具。</span><span class="sxs-lookup"><span data-stu-id="4fe80-126">Hierarchies are not meant to be used as a security mechanism, but as a tool for providing a better user experience.</span></span> <span data-ttu-id="4fe80-127">特定階層的所有安全性，都是繼承自基礎模型。</span><span class="sxs-lookup"><span data-stu-id="4fe80-127">All security for a particular hierarchy is inherited from the underlying model.</span></span> <span data-ttu-id="4fe80-128">如果使用者沒有模型物件的存取權，階層也無法提供這些存取權。</span><span class="sxs-lookup"><span data-stu-id="4fe80-128">Hierarchies cannot provide access to model objects to which a user does not already have access.</span></span> <span data-ttu-id="4fe80-129">必須先解決模型資料庫的安全性，才能透過階層提供模型中物件的存取權。</span><span class="sxs-lookup"><span data-stu-id="4fe80-129">Security for the model database must be resolved before access to objects in the model can be provided through a hierarchy.</span></span> <span data-ttu-id="4fe80-130">您可使用安全性角色來保護模型中繼資料和資料的安全。</span><span class="sxs-lookup"><span data-stu-id="4fe80-130">Security roles can be used to secure model metadata and data.</span></span> <span data-ttu-id="4fe80-131">如需詳細資訊，請參閱 [角色 &#40;SSAS 表格式&#41;](roles-ssas-tabular.md)中撰寫的表格式模型專案。</span><span class="sxs-lookup"><span data-stu-id="4fe80-131">For more information, see [Roles &#40;SSAS Tabular&#41;](roles-ssas-tabular.md).</span></span>  
  
##  <a name="defining-hierarchies"></a><a name="bkmk_define"></a><span data-ttu-id="4fe80-132">定義階層</span><span class="sxs-lookup"><span data-stu-id="4fe80-132">Defining Hierarchies</span></span>  
 <span data-ttu-id="4fe80-133">您可以在 [圖表檢視] 中，使用模型設計師建立及管理階層。</span><span class="sxs-lookup"><span data-stu-id="4fe80-133">You create and manage hierarchies by using the model designer in Diagram View.</span></span> <span data-ttu-id="4fe80-134">不支援在模型設計師的 [資料檢視] 中建立及管理階層。</span><span class="sxs-lookup"><span data-stu-id="4fe80-134">Creating and managing hierarchies is not supported in the model designer in Data View.</span></span> <span data-ttu-id="4fe80-135">若要在 [圖表檢視] 中檢視模型設計師，請按一下 **[模型]** 功能表，指向 **[模型檢視]**，然後按一下 **[圖表檢視]**。</span><span class="sxs-lookup"><span data-stu-id="4fe80-135">To view the model designer in Diagram View, click the **Model** menu, then point to **Model View**, and then click **Diagram View**.</span></span>  
  
 <span data-ttu-id="4fe80-136">若要建立階層，請以滑鼠右鍵按一下您要指定為父層級的資料行，然後按一下 [建立階層]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="4fe80-136">To create a hierarchy, right-click a column you want to specify as the parent level, and then click **Create Hierarchy**.</span></span> <span data-ttu-id="4fe80-137">您可以 (在單一資料表內) 複選要包含的任意資料行數目，您也可稍後按一下資料行並拖曳至父層級，以將資料行加入為子層級。</span><span class="sxs-lookup"><span data-stu-id="4fe80-137">You can multi-select any number of columns (within a single table) to include, or you can later add columns as child levels by clicking and dragging columns to the parent level.</span></span> <span data-ttu-id="4fe80-138">選取多個資料行時，會根據基數順序自動加入資料行。</span><span class="sxs-lookup"><span data-stu-id="4fe80-138">When multiple columns are selected, columns are automatically placed in an order based on cardinality.</span></span> <span data-ttu-id="4fe80-139">您可以按一下資料行 (層級) 並拖曳至其他順序，或使用操作功能表上的 [向上] 和 [向下] 導覽控制項，來變更順序。</span><span class="sxs-lookup"><span data-stu-id="4fe80-139">You can change the order by clicking and dragging a column (level) to a different order or by using Up and Down navigation controls on the context menu.</span></span> <span data-ttu-id="4fe80-140">您可以透過將資料行拖放至父層級上，使用自動偵測將資料行加入為子層級。</span><span class="sxs-lookup"><span data-stu-id="4fe80-140">When adding a column as a child level, you can use auto-detect by dragging and dropping the column onto the parent level.</span></span>  
  
 <span data-ttu-id="4fe80-141">一個資料行可以出現在多個階層中。</span><span class="sxs-lookup"><span data-stu-id="4fe80-141">A column can appear in more than one hierarchy.</span></span> <span data-ttu-id="4fe80-142">階層無法包含非資料行物件，例如量值或 KPI。</span><span class="sxs-lookup"><span data-stu-id="4fe80-142">Hierarchies cannot include non-column objects such as measures or KPIs.</span></span> <span data-ttu-id="4fe80-143">階層是僅以單一資料表內的資料行為基礎。</span><span class="sxs-lookup"><span data-stu-id="4fe80-143">A hierarchy can be based on columns from within a single table only.</span></span> <span data-ttu-id="4fe80-144">如果您複選量值及一個或多個資料行，或者選取多個資料表的資料行，即會停用操作功能表中的 [建立階層]\*\*\*\* 命令。</span><span class="sxs-lookup"><span data-stu-id="4fe80-144">If you multi-select a measure along with one or more columns, or if you select columns from multiple tables, the **Create Hierarchy** command is disabled in the context menu.</span></span> <span data-ttu-id="4fe80-145">若要加入不同資料表的資料行，請使用 RELATED DAX 函數加入參考相關資料表之資料行的導出資料行。</span><span class="sxs-lookup"><span data-stu-id="4fe80-145">To add a column from a different table, use the RELATED DAX function to add a calculated column that references the column from the related table.</span></span> <span data-ttu-id="4fe80-146">此函數使用下列語法： `=RELATED(TableName[ColumnName])`。</span><span class="sxs-lookup"><span data-stu-id="4fe80-146">The function uses the following syntax: `=RELATED(TableName[ColumnName])`.</span></span> <span data-ttu-id="4fe80-147">如需詳細資訊，請參閱 RELATED 函數。</span><span class="sxs-lookup"><span data-stu-id="4fe80-147">For more information, see RELATED Function.</span></span>  
  
 <span data-ttu-id="4fe80-148">根據預設，新階層會命名為「階層 1」、「階層 2」等。您應變更階層名稱，以反映父子式關聯性的本質，讓使用者更容易識別。</span><span class="sxs-lookup"><span data-stu-id="4fe80-148">By default, new hierarchies are named hierarchy1, hierarchy 2, etc. You should change hierarchy names to reflect the nature of the parent-child relationship, making them more identifiable to users.</span></span>  
  
 <span data-ttu-id="4fe80-149">建立階層之後，您可以使用 [在 Excel 中進行分析] 功能測試階層的功效。</span><span class="sxs-lookup"><span data-stu-id="4fe80-149">After you have created hierarchies, you can test their efficacy by using the Analyze in Excel feature.</span></span> <span data-ttu-id="4fe80-150">如需詳細資訊，請參閱本主題稍後的 [在 Excel 中進行分析 &#40;SSAS 表格式&#41;](analyze-in-excel-ssas-tabular.md)中的 [角色管理員] 對話方塊來定義角色的表格式模型作者。</span><span class="sxs-lookup"><span data-stu-id="4fe80-150">For more information, see [Analyze in Excel &#40;SSAS Tabular&#41;](analyze-in-excel-ssas-tabular.md).</span></span>  
  
##  <a name="related-tasks"></a><a name="bkmk_related_tasks"></a> <span data-ttu-id="4fe80-151">相關工作</span><span class="sxs-lookup"><span data-stu-id="4fe80-151">Related Tasks</span></span>  
  
|<span data-ttu-id="4fe80-152">Task</span><span class="sxs-lookup"><span data-stu-id="4fe80-152">Task</span></span>|<span data-ttu-id="4fe80-153">描述</span><span class="sxs-lookup"><span data-stu-id="4fe80-153">Description</span></span>|  
|----------|-----------------|  
|[<span data-ttu-id="4fe80-154">建立及管理階層 &#40;SSAS 表格式&#41;</span><span class="sxs-lookup"><span data-stu-id="4fe80-154">Create and Manage Hierarchies &#40;SSAS Tabular&#41;</span></span>](hierarchies-ssas-tabular.md)|<span data-ttu-id="4fe80-155">描述如何在 [圖表檢視] 中，使用模型設計師建立及管理階層。</span><span class="sxs-lookup"><span data-stu-id="4fe80-155">Describes how to create and manage hierarchies by using the model designer in Diagram View.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="4fe80-156">另請參閱</span><span class="sxs-lookup"><span data-stu-id="4fe80-156">See Also</span></span>  
 <span data-ttu-id="4fe80-157">[表格式模型設計師 &#40;SSAS 表格式&#41;](../tabular-model-designer-ssas-tabular.md) </span><span class="sxs-lookup"><span data-stu-id="4fe80-157">[Tabular Model Designer &#40;SSAS Tabular&#41;](../tabular-model-designer-ssas-tabular.md) </span></span>  
 <span data-ttu-id="4fe80-158">[SSAS 表格式 &#40;的觀點&#41;](perspectives-ssas-tabular.md) </span><span class="sxs-lookup"><span data-stu-id="4fe80-158">[Perspectives &#40;SSAS Tabular&#41;](perspectives-ssas-tabular.md) </span></span>  
 [<span data-ttu-id="4fe80-159">角色 &#40;SSAS 表格式&#41;</span><span class="sxs-lookup"><span data-stu-id="4fe80-159">Roles &#40;SSAS Tabular&#41;</span></span>](roles-ssas-tabular.md)  
  
  
