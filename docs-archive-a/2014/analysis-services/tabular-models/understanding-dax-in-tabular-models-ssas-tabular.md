---
title: 瞭解表格式模型中的 DAX (SSAS 表格式) |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: b2693985-1bea-4861-a100-cea4761ba809
author: minewiskan
ms.author: owend
ms.openlocfilehash: 4bf7dc2f41a1d42e8b565459c3b094479d937a91
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87599190"
---
# <a name="understanding-dax-in-tabular-models-ssas-tabular"></a><span data-ttu-id="9283c-102">了解表格式模型中的 DAX (SSAS 表格式)</span><span class="sxs-lookup"><span data-stu-id="9283c-102">Understanding DAX in Tabular Models (SSAS Tabular)</span></span>
  <span data-ttu-id="9283c-103">資料分析運算式 (DAX) 是公式語言，可用來在 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Microsoft Excel 活頁簿和 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 表格式模型專案中建立自訂計算。</span><span class="sxs-lookup"><span data-stu-id="9283c-103">Data Analysis Expressions (DAX) is the formula language used to create custom calculations in [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Microsoft Excel workbooks and [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] tabular model projects.</span></span> <span data-ttu-id="9283c-104">DAX 公式包含函數、運算子和值，可對資料表和資料行中的資料執行進階計算。</span><span class="sxs-lookup"><span data-stu-id="9283c-104">DAX formulas include functions, operators, and values to perform advanced calculations on data in tables and columns.</span></span>  
  
 <span data-ttu-id="9283c-105">雖然 DAX 同時適用於 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 活頁簿和表格式模型專案，但本主題更適用於 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]中撰寫的表格式模型專案。</span><span class="sxs-lookup"><span data-stu-id="9283c-105">While DAX applies to both [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] workbooks and tabular model projects, this topic applies more to tabular model projects authored in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="9283c-106">閱讀本主題之前，您應該先充分了解 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]中的表格式模型和表格式模型專案撰寫環境。</span><span class="sxs-lookup"><span data-stu-id="9283c-106">Before reading this topic, you should have a good understanding of tabular models and the tabular model project authoring environment in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span>  
  
 <span data-ttu-id="9283c-107">本主題的章節：</span><span class="sxs-lookup"><span data-stu-id="9283c-107">Sections in this topic:</span></span>  
  
-   [<span data-ttu-id="9283c-108">表格式模型中的 DAX</span><span class="sxs-lookup"><span data-stu-id="9283c-108">DAX in Tabular Models</span></span>](#bkmk_DAXintm)  
  
-   [<span data-ttu-id="9283c-109">導出資料行、量值和資料列篩選中的 DAX 公式</span><span class="sxs-lookup"><span data-stu-id="9283c-109">DAX Formulas in Calculated Columns, Measures, and Row Filters</span></span>](#bkmk_DAX)  
  
-   [<span data-ttu-id="9283c-110">DAX 資料類型</span><span class="sxs-lookup"><span data-stu-id="9283c-110">DAX Data Types</span></span>](#bkmk_DAX_datatypes)  
  
-   [<span data-ttu-id="9283c-111">DAX 運算子</span><span class="sxs-lookup"><span data-stu-id="9283c-111">DAX Operators</span></span>](#bkmk_DAX_opertors)  
  
-   [<span data-ttu-id="9283c-112">DAX 公式</span><span class="sxs-lookup"><span data-stu-id="9283c-112">DAX Formulas</span></span>](#bkmk_DAX_Formulas)  
  
-   [<span data-ttu-id="9283c-113">DAX 函數</span><span class="sxs-lookup"><span data-stu-id="9283c-113">DAX Functions</span></span>](#bkmk_DAX_functions)  
  
-   [<span data-ttu-id="9283c-114">DAX 公式中的內容</span><span class="sxs-lookup"><span data-stu-id="9283c-114">Context in DAX Formulas</span></span>](#bkmk_context)  
  
-   [<span data-ttu-id="9283c-115">公式與表格式模型</span><span class="sxs-lookup"><span data-stu-id="9283c-115">Formulas and the Tabular Model</span></span>](#bkmk_RelModel)  
  
-   [<span data-ttu-id="9283c-116">使用資料表和資料行</span><span class="sxs-lookup"><span data-stu-id="9283c-116">Working with Tables and Columns</span></span>](#bkmk_tables)  
  
-   [<span data-ttu-id="9283c-117">更新公式的結果 (處理序)</span><span class="sxs-lookup"><span data-stu-id="9283c-117">Updating the Results of Formulas (Process)</span></span>](#bkmk_RefreshRecalc)  
  
-   [<span data-ttu-id="9283c-118">疑難排解公式中的錯誤</span><span class="sxs-lookup"><span data-stu-id="9283c-118">Troubleshooting Errors in Formulas</span></span>](#bkmk_troubleshoot)  
  
-   [<span data-ttu-id="9283c-119">其他資源</span><span class="sxs-lookup"><span data-stu-id="9283c-119">Additional Resources</span></span>](#bkmk_addional_resources)  
  
##  <a name="dax-in-tabular-models"></a><a name="bkmk_DAXintm"></a><span data-ttu-id="9283c-120">表格式模型中的 DAX</span><span class="sxs-lookup"><span data-stu-id="9283c-120">DAX in Tabular Models</span></span>  
 <span data-ttu-id="9283c-121">在 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 和表格式模型中，DAX 公式計算值的方式及其個別資料集之間在功能上沒有任何差異。</span><span class="sxs-lookup"><span data-stu-id="9283c-121">In both [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] and tabular models, functionally, there is no difference in how DAX formulas calculate values from their respective data sets.</span></span> <span data-ttu-id="9283c-122">不過，DAX 公式在活頁簿中建立的位置和模型撰寫工具不同，而且評估某些量值內容的位置也不同。</span><span class="sxs-lookup"><span data-stu-id="9283c-122">However, where DAX formulas are created in the workbook and model authoring tools is different, as well as where context in certain measures is evaluated.</span></span>  
  
 <span data-ttu-id="9283c-123">在 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)]中，計算公式通常是由活頁簿使用者所建立，用於自助商業智慧分析。</span><span class="sxs-lookup"><span data-stu-id="9283c-123">In [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)], calculation formulas are typically created by the workbook user for self-service business intelligence analysis.</span></span> <span data-ttu-id="9283c-124">資料表的導出資料行是在 PowerPivot 視窗中建立，量值則是在樞紐分析表或計算區域中建立。</span><span class="sxs-lookup"><span data-stu-id="9283c-124">Calculated columns are created for a table in the PowerPivot window, and measures are created in PivotTables or the calculation area.</span></span> <span data-ttu-id="9283c-125">PowerPivot 活頁簿與表格式模型專案不同，前者不會提供以角色為基礎的安全性，可使用 DAX 公式保護資料安全。</span><span class="sxs-lookup"><span data-stu-id="9283c-125">Unlike tabular model projects, PowerPivot workbooks do not provide role-based security, which can use DAX formulas to secure data.</span></span>  
  
 <span data-ttu-id="9283c-126">在表格式模型專案中，計算公式是由模型作者在 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] 模型設計師中所建立。</span><span class="sxs-lookup"><span data-stu-id="9283c-126">In tabular model projects, calculation formulas are created in the model designer in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] by model authors.</span></span> <span data-ttu-id="9283c-127">導出資料行的值是透過使用 DAX 公式計算的，會立即出現在模型設計師的資料表中 (但量值方格中的量值預覽功能除外)，而量值必須等到使用者在報表用戶端 (例如 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] 或 Microsoft Excel 的樞紐分析表) 中指定篩選之後才會計算。</span><span class="sxs-lookup"><span data-stu-id="9283c-127">While values for calculated columns, calculated by using DAX formulas, appear immediately in the table in the model designer, with exception to the measure preview feature in the measure grid, measures are not calculated until a user specifies a filter in a reporting client such as [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] or in PivotTables in Microsoft Excel.</span></span>  
  
 <span data-ttu-id="9283c-128">如果您使用 [從 PowerPivot 匯入] 專案範本，將 PowerPivot 活頁簿匯入到新的表格式模型專案，則會在新的表格式模型中自動建立導出資料行的 DAX 公式。</span><span class="sxs-lookup"><span data-stu-id="9283c-128">If you import a PowerPivot workbook into a new tabular model project by using the Import from PowerPivot project template, DAX formulas for calculated columns will be automatically created in the new tabular model.</span></span> <span data-ttu-id="9283c-129">系統會在新的表格式模型中自動建立活頁簿中中隱含和明確量值的 DAX 公式，做為明確的量值。</span><span class="sxs-lookup"><span data-stu-id="9283c-129">DAX formulas for implicit and explicit measures in the workbook will be automatically created in the new tabular model as explicit measures.</span></span> <span data-ttu-id="9283c-130">由於角色和安全資料列篩選功能還未存在於 PowerPivot 活頁簿中，因此您至少需要在新的表格式模型中建立一個角色，才能提供模型資料存取給角色成員。</span><span class="sxs-lookup"><span data-stu-id="9283c-130">Because role and secure row filter functionality do not already exist in PowerPivot workbooks, you will need to create at least one role in the new tabular model to provide model data access to role members.</span></span> <span data-ttu-id="9283c-131">只有在您要保護資料列層級之資料表資料的安全性時，才需要在資料列篩選中使用 DAX 公式。</span><span class="sxs-lookup"><span data-stu-id="9283c-131">DAX formulas in row filters are necessary only if you want to secure table data at the row-level.</span></span>  
  
##  <a name="dax-formulas-in-calculated-columns-measures-and-row-filters"></a><a name="bkmk_DAX"></a><span data-ttu-id="9283c-132">計算結果欄、量值和資料列篩選中的 DAX 公式</span><span class="sxs-lookup"><span data-stu-id="9283c-132">DAX Formulas in Calculated Columns, Measures, and Row Filters</span></span>  
 <span data-ttu-id="9283c-133">對於在 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]中撰寫的表格式模型，會在導出資料行、量值和資料列篩選中使用 DAX 公式。</span><span class="sxs-lookup"><span data-stu-id="9283c-133">For tabular models authored in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], DAX formulas are used in calculated columns, measures, and row filters.</span></span>  
  
### <a name="calculated-columns"></a><span data-ttu-id="9283c-134">導出資料行</span><span class="sxs-lookup"><span data-stu-id="9283c-134">Calculated Columns</span></span>  
 <span data-ttu-id="9283c-135">導出資料行是一種資料行，您可以將該資料行加入至現有的資料行 (在模型設計師中)，然後建立定義資料行值的 DAX 公式。</span><span class="sxs-lookup"><span data-stu-id="9283c-135">A calculated column is a column that you add to an existing table (in the model designer) and then create a DAX formula that defines the column values.</span></span> <span data-ttu-id="9283c-136">您可以在模型設計師中使用公式列建立導出資料行的公式。</span><span class="sxs-lookup"><span data-stu-id="9283c-136">You create formulas for calculated columns in the model designer by using the formula bar.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9283c-137">使用 DirectQuery 模式從關聯式資料來源擷取資料的模型不支援導出資料行。</span><span class="sxs-lookup"><span data-stu-id="9283c-137">Calculated columns are not supported for models that retrieve data from a relational data source using DirectQuery mode.</span></span>  
  
 <span data-ttu-id="9283c-138">當導出資料行包含有效的 DAX 公式時，只要輸入公式之後，就會為每個資料列計算值。</span><span class="sxs-lookup"><span data-stu-id="9283c-138">When a calculated column contains a valid DAX formula, values are calculated for each row as soon as the formula is entered.</span></span> <span data-ttu-id="9283c-139">然後值會儲存在資料庫中。</span><span class="sxs-lookup"><span data-stu-id="9283c-139">Values are then stored in the database.</span></span> <span data-ttu-id="9283c-140">例如在 Date 資料表中，將公式 `=[Calendar Year] & " Q" & [Calendar Quarter]` 輸入公式列時，就會計算資料表中每個資料列的值，方法是取出 Calendar Year 資料行 (在相同的 Date 資料表) 中的值、加上空格和大寫字母 Q，然後加入 Calendar Quarter 資料行 (在相同的 Date 資料表) 中的值。</span><span class="sxs-lookup"><span data-stu-id="9283c-140">For example, in a Date table, when the formula `=[Calendar Year] & " Q" & [Calendar Quarter]` is entered into the formula bar, a value for each row in the table is calculated by taking values from the Calendar Year column (in the same Date table), adding a space and the capital letter Q, and then adding the values from the Calendar Quarter column (in the same Date table).</span></span> <span data-ttu-id="9283c-141">系統會立即計算導出資料行中每個資料列的結果，並顯示為 **2010 Q1**。</span><span class="sxs-lookup"><span data-stu-id="9283c-141">The result for each row in the calculated column is calculated immediately and appears, for example, as **2010 Q1**.</span></span> <span data-ttu-id="9283c-142">只有在重新處理資料時，才會重新計算資料行值。</span><span class="sxs-lookup"><span data-stu-id="9283c-142">Column values are only recalculated if the data is re-processed.</span></span>  
  
 <span data-ttu-id="9283c-143">如需詳細資訊，請參閱 [導出資料行 &#40;SSAS 表格式&#41;](ssas-calculated-columns.md)中撰寫的表格式模型專案。</span><span class="sxs-lookup"><span data-stu-id="9283c-143">For more information, see [Calculated Columns &#40;SSAS Tabular&#41;](ssas-calculated-columns.md).</span></span>  
  
### <a name="measures"></a><span data-ttu-id="9283c-144">量值</span><span class="sxs-lookup"><span data-stu-id="9283c-144">Measures</span></span>  
 <span data-ttu-id="9283c-145">量值為動態公式，其結果會根據內容而改變。</span><span class="sxs-lookup"><span data-stu-id="9283c-145">Measures are dynamic formulas where the results change depending on context.</span></span> <span data-ttu-id="9283c-146">量值會在使用多個屬性 (例如 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] 報表、Excel 樞紐分析表或樞紐分析圖) 支援結合與篩選模型資料的報告格式中使用。</span><span class="sxs-lookup"><span data-stu-id="9283c-146">Measures are used in reporting formats that support combining and filtering model data by using multiple attributes such as a [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] report or Excel PivotTable or PivotChart.</span></span> <span data-ttu-id="9283c-147">在表格式模型專案中，量值會由模型作者使用 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]中模型設計師的量值方格 (和公式列) 定義。</span><span class="sxs-lookup"><span data-stu-id="9283c-147">In tabular model projects, measures are defined by the model author by using the measure grid (and formula bar) in the model designer in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span>  
  
 <span data-ttu-id="9283c-148">量值中的公式可以使用由自動加總功能自動建立的標準彙總函式 (例如 COUNT 或 SUM)，或者您可以使用 DAX 自行定義公式。</span><span class="sxs-lookup"><span data-stu-id="9283c-148">A formula in a measure can use standard aggregation functions automatically created by using the Autosum feature, such as COUNT or SUM, or you can define your own formula by using DAX.</span></span> <span data-ttu-id="9283c-149">當您在公式列中定義量值的公式時，工具提示功能會顯示目前內容總計應該有的結果預覽，但是不會在任何地方立即輸出結果。</span><span class="sxs-lookup"><span data-stu-id="9283c-149">When you define a formula for a measure in the formula bar, a Tooltip feature shows a preview of what the results would be for the total in the current context, but otherwise the results are not immediately output anywhere.</span></span> <span data-ttu-id="9283c-150">其他量值詳細資料也會出現在 **[屬性]** 窗格中。</span><span class="sxs-lookup"><span data-stu-id="9283c-150">Other measure details also appear in the **Properties** pane.</span></span>  
  
 <span data-ttu-id="9283c-151">您無法立即看到計算 (已篩選) 結果的原因如下：在沒有內容的情況下無法判定量值的結果。</span><span class="sxs-lookup"><span data-stu-id="9283c-151">The reason you cannot see the (filtered) results of the calculation immediately is because the result of a measure cannot be determined without context.</span></span> <span data-ttu-id="9283c-152">評估量值需要報告用戶端應用程式可以提供擷取每一個資料格之相關資料所需的內容，然後為每一個資料格評估運算式。</span><span class="sxs-lookup"><span data-stu-id="9283c-152">To evaluate a measure requires a reporting client application that can provide the context needed to retrieve the data relevant to each cell and then evaluate the expression for each cell.</span></span> <span data-ttu-id="9283c-153">用戶端可能是 Excel 樞紐分析表或樞紐分析圖、 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] 報表，或是 MDX 查詢。</span><span class="sxs-lookup"><span data-stu-id="9283c-153">That client might be an Excel PivotTable or PivotChart, a [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] report, or an MDX query.</span></span> <span data-ttu-id="9283c-154">不論報告用戶端為何，都會針對結果中的每一個資料格執行個別的查詢。</span><span class="sxs-lookup"><span data-stu-id="9283c-154">Regardless of the reporting client, a separate query is run for each cell in the results.</span></span> <span data-ttu-id="9283c-155">也就是說，樞紐分析表中資料列和資料行標頭的每一個組合或是 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] 報表中交叉分析篩選器和篩選的每一個選擇都會產生不同的資料子集 (量值是針對該子集計算而來)。</span><span class="sxs-lookup"><span data-stu-id="9283c-155">That is to say, each combination of row and column headers in a PivotTable, or each selection of slicers and filters in a [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] report, generates a different subset of data over which the measure is calculated.</span></span> <span data-ttu-id="9283c-156">例如在具有公式 `Total Sales:=SUM([Sales Amount])`的量值中，當使用者將 Total Sales 量值放入樞紐分析表中的 [值] 視窗，然後將 Product Category 資料行從 Product 資料表放入 [篩選] 視窗時，會為每個產品類別目錄計算並顯示 Sales Amount 的加總。</span><span class="sxs-lookup"><span data-stu-id="9283c-156">For example, in a measure with the formula, `Total Sales:=SUM([Sales Amount])`, when a user places the Total Sales measure in the Values window in a PivotTable, and then places the Product Category column from a Product table into the Filters window, the sum of Sales Amount is calculated and displayed for each product category.</span></span>  
  
 <span data-ttu-id="9283c-157">不同於計算結果欄和資料列篩選，量值語法會包含公式前面的量值名稱。</span><span class="sxs-lookup"><span data-stu-id="9283c-157">Unlike calculated columns and row filters, the syntax for a measure includes the measure's name preceding the formula.</span></span> <span data-ttu-id="9283c-158">在剛才提供的範例中，名稱 **Total Sales:** 會出現在公式之前。</span><span class="sxs-lookup"><span data-stu-id="9283c-158">In the example just provided, the name **Total Sales:** appears preceding the formula.</span></span> <span data-ttu-id="9283c-159">當您建立量值之後，名稱及其定義會出現在報告用戶端應用程式的欄位清單中，而且可以提供給模型的所有使用者使用 (視檢視方塊和角色而定)。</span><span class="sxs-lookup"><span data-stu-id="9283c-159">After you have created a measure, the name and its definition appear in the reporting client application Field List and depending on perspectives and roles is available to all users of the model.</span></span>  
  
 <span data-ttu-id="9283c-160">如需詳細資訊，請參閱 [量值 &#40;SSAS 表格式&#41;](measures-ssas-tabular.md)中撰寫的表格式模型專案。</span><span class="sxs-lookup"><span data-stu-id="9283c-160">For more information, see [Measures &#40;SSAS Tabular&#41;](measures-ssas-tabular.md).</span></span>  
  
### <a name="row-filters"></a><span data-ttu-id="9283c-161">資料列篩選</span><span class="sxs-lookup"><span data-stu-id="9283c-161">Row Filters</span></span>  
 <span data-ttu-id="9283c-162">資料列篩選會定義特定角色的成員可以看到的資料表資料列。</span><span class="sxs-lookup"><span data-stu-id="9283c-162">Row filters define which rows in a table are visible to members of a particular role.</span></span> <span data-ttu-id="9283c-163">您可以使用 DAX 公式，為模型中的每個資料表建立資料列篩選。</span><span class="sxs-lookup"><span data-stu-id="9283c-163">Row filters can be created for each table in a model by using DAX formulas.</span></span> <span data-ttu-id="9283c-164">系統會針對特定角色，使用 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]中的角色管理員建立資料列篩選。</span><span class="sxs-lookup"><span data-stu-id="9283c-164">Row filters are created for a particular role by using Role Manager in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="9283c-165">使用 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]中的 [角色屬性] 也可以為已部署的模型定義資料列篩選。</span><span class="sxs-lookup"><span data-stu-id="9283c-165">Row filters can also be defined for a deployed model by using Role Properties in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span>  
  
 <span data-ttu-id="9283c-166">在資料列篩選中，必須評估為布林 TRUE/FALSE 條件的 DAX 公式會定義該特定角色成員的查詢結果可傳回的資料列。</span><span class="sxs-lookup"><span data-stu-id="9283c-166">In a row filter, a DAX formula, which must evaluate to a Boolean TRUE/FALSE condition, defines which rows can be returned by the results of a query by members of that particular role.</span></span> <span data-ttu-id="9283c-167">無法傳回 DAX 公式中未包含的資料列。</span><span class="sxs-lookup"><span data-stu-id="9283c-167">Rows not included in the DAX formula cannot be returned.</span></span> <span data-ttu-id="9283c-168">例如，對於 Sales 角色成員來說，Customers 資料表具有下列 DAX 公式 `=Customers[Country] = "USA"`，因此 Sales 角色成員只能檢視美國客戶的資料，以及彙總，例如只針對美國客戶傳回的 SUM。</span><span class="sxs-lookup"><span data-stu-id="9283c-168">For example, for members of the Sales role, the Customers table with the following DAX formula, `=Customers[Country] = "USA"`, members of the Sales role will only be able to view data for customers in the USA, and aggregates, such as SUM are returned only for customers in the USA.</span></span>  
  
 <span data-ttu-id="9283c-169">當您透過使用 DAX 公式定義資料列篩選時，會建立允許的資料列集。</span><span class="sxs-lookup"><span data-stu-id="9283c-169">When you define a row filter by using DAX formula, you are creating an allowed row set.</span></span> <span data-ttu-id="9283c-170">這並不會拒絕存取其他資料列；而是它們根本不會做為允許的資料列集一部分傳回。</span><span class="sxs-lookup"><span data-stu-id="9283c-170">This does not deny access to other rows; rather, they are simply not returned as part of the allowed row set.</span></span> <span data-ttu-id="9283c-171">其他角色可以允許存取 DAX 公式所排除的資料列。</span><span class="sxs-lookup"><span data-stu-id="9283c-171">Other roles can allow access to the rows excluded by the DAX formula.</span></span> <span data-ttu-id="9283c-172">如果使用者是另一個角色的成員，且該角色的資料列篩選允許存取該特定資料列集，則使用者可以查看該資料列的資料。</span><span class="sxs-lookup"><span data-stu-id="9283c-172">If a user is a member of another role, and that role's row filters allow access to that particular row set, the user can view data for that row.</span></span>  
  
 <span data-ttu-id="9283c-173">資料列篩選會套用至指定的資料列及相關的資料列。</span><span class="sxs-lookup"><span data-stu-id="9283c-173">Row filters apply to the specified rows as well as related rows.</span></span> <span data-ttu-id="9283c-174">當資料表具有多個關聯性時，篩選會對作用中關聯性套用安全性。</span><span class="sxs-lookup"><span data-stu-id="9283c-174">When a table has multiple relationships, filters apply security for the relationship that is active.</span></span> <span data-ttu-id="9283c-175">資料列篩選會與針對相關資料表定義的其他資料列篩選進行交叉篩選。</span><span class="sxs-lookup"><span data-stu-id="9283c-175">Row filters will be intersected with other row filters defined for related tables.</span></span>  
  
 <span data-ttu-id="9283c-176">如需詳細資訊，請參閱 [角色 &#40;SSAS 表格式&#41;](roles-ssas-tabular.md)中撰寫的表格式模型專案。</span><span class="sxs-lookup"><span data-stu-id="9283c-176">For more information, see [Roles &#40;SSAS Tabular&#41;](roles-ssas-tabular.md).</span></span>  
  
##  <a name="dax-data-types"></a><a name="bkmk_DAX_datatypes"></a><span data-ttu-id="9283c-177">DAX 資料類型</span><span class="sxs-lookup"><span data-stu-id="9283c-177">DAX Data Types</span></span>  
 <span data-ttu-id="9283c-178">您可以從可能支援不同資料類型的許多不同資料來源，將資料匯入模型中。</span><span class="sxs-lookup"><span data-stu-id="9283c-178">You can import data into a model from many different data sources that might support different data types.</span></span> <span data-ttu-id="9283c-179">當您將資料匯入模型時，資料會轉換為其中一個表格式模型資料類型。</span><span class="sxs-lookup"><span data-stu-id="9283c-179">When you import data into a model, the data is converted to one of the tabular model data types.</span></span> <span data-ttu-id="9283c-180">當模型資料用於計算時，在計算的持續時間內資料會轉換為 DAX 資料類型做為輸出。</span><span class="sxs-lookup"><span data-stu-id="9283c-180">When the model data is used in a calculation, the data is then converted to a DAX data type for the duration and output of the calculation.</span></span> <span data-ttu-id="9283c-181">當您建立 DAX 公式時，用於公式中的詞彙會自動判斷傳回的值資料類型。</span><span class="sxs-lookup"><span data-stu-id="9283c-181">When you create a DAX formula, the terms used in the formula will automatically determine the value data type returned.</span></span>  
  
 <span data-ttu-id="9283c-182">表格式模型和 DAX 支援下列資料類型：</span><span class="sxs-lookup"><span data-stu-id="9283c-182">Tabular models, and DAX, support the following data types:</span></span>  
  
|<span data-ttu-id="9283c-183">模型中的資料類型</span><span class="sxs-lookup"><span data-stu-id="9283c-183">Data type in model</span></span>|<span data-ttu-id="9283c-184">DAX 中的資料類型</span><span class="sxs-lookup"><span data-stu-id="9283c-184">Data type in DAX</span></span>|<span data-ttu-id="9283c-185">描述</span><span class="sxs-lookup"><span data-stu-id="9283c-185">Description</span></span>|  
|------------------------|----------------------|-----------------|  
|<span data-ttu-id="9283c-186">整數</span><span class="sxs-lookup"><span data-stu-id="9283c-186">Whole Number</span></span>|<span data-ttu-id="9283c-187">64 位元 (八位元組) 整數值 <sup>1、2</sup></span><span class="sxs-lookup"><span data-stu-id="9283c-187">A 64 bit (eight-bytes) integer value <sup>1, 2</sup></span></span>|<span data-ttu-id="9283c-188">沒有小數位數的數字。</span><span class="sxs-lookup"><span data-stu-id="9283c-188">Numbers that have no decimal places.</span></span> <span data-ttu-id="9283c-189">整數可以是正數或負數，但必須是 -9,223,372,036,854,775,808 (-2^63) 到 9,223,372,036,854,775,807 (2^63-1) 之間的整數。</span><span class="sxs-lookup"><span data-stu-id="9283c-189">Integers can be positive or negative numbers, but must be whole numbers between -9,223,372,036,854,775,808 (-2^63) and 9,223,372,036,854,775,807 (2^63-1).</span></span>|  
|<span data-ttu-id="9283c-190">十進位數字</span><span class="sxs-lookup"><span data-stu-id="9283c-190">Decimal Number</span></span>|<span data-ttu-id="9283c-191">64 位元 (八位元組) 實數 <sup>1、2</sup></span><span class="sxs-lookup"><span data-stu-id="9283c-191">A 64 bit (eight-bytes) real number <sup>1, 2</sup></span></span>|<span data-ttu-id="9283c-192">實數是可以有小數位數的數字。</span><span class="sxs-lookup"><span data-stu-id="9283c-192">Real numbers are numbers that can have decimal places.</span></span> <span data-ttu-id="9283c-193">實數涵蓋極廣的值範圍：</span><span class="sxs-lookup"><span data-stu-id="9283c-193">Real numbers cover a wide range of values:</span></span><br /><br /> <span data-ttu-id="9283c-194">負值是從 -1.79E + 308 到 -2.23E - 308</span><span class="sxs-lookup"><span data-stu-id="9283c-194">Negative values from -1.79E +308 through -2.23E -308</span></span><br /><br /> <span data-ttu-id="9283c-195">零</span><span class="sxs-lookup"><span data-stu-id="9283c-195">Zero</span></span><br /><br /> <span data-ttu-id="9283c-196">正值是從 2.23E -308 到 1.79E + 308</span><span class="sxs-lookup"><span data-stu-id="9283c-196">Positive values from 2.23E -308 through 1.79E + 308</span></span><br /><br /> <span data-ttu-id="9283c-197">不過，有效位數的數目限制為 17 個小數位數。</span><span class="sxs-lookup"><span data-stu-id="9283c-197">However, the number of significant digits is limited to 17 decimal digits.</span></span>|  
|<span data-ttu-id="9283c-198">布林值</span><span class="sxs-lookup"><span data-stu-id="9283c-198">Boolean</span></span>|<span data-ttu-id="9283c-199">布林值</span><span class="sxs-lookup"><span data-stu-id="9283c-199">Boolean</span></span>|<span data-ttu-id="9283c-200">True 或 False 值。</span><span class="sxs-lookup"><span data-stu-id="9283c-200">Either a True or False value.</span></span>|  
|<span data-ttu-id="9283c-201">Text</span><span class="sxs-lookup"><span data-stu-id="9283c-201">Text</span></span>|<span data-ttu-id="9283c-202">String</span><span class="sxs-lookup"><span data-stu-id="9283c-202">String</span></span>|<span data-ttu-id="9283c-203">Unicode 字元資料字串。</span><span class="sxs-lookup"><span data-stu-id="9283c-203">A Unicode character data string.</span></span> <span data-ttu-id="9283c-204">可以是字串或數字，或以文字格式表示的日期。</span><span class="sxs-lookup"><span data-stu-id="9283c-204">Can be strings, numbers or dates represented in a text format.</span></span>|  
|<span data-ttu-id="9283c-205">Date</span><span class="sxs-lookup"><span data-stu-id="9283c-205">Date</span></span>|<span data-ttu-id="9283c-206">日期/時間</span><span class="sxs-lookup"><span data-stu-id="9283c-206">Date/time</span></span>|<span data-ttu-id="9283c-207">採用可接受之日期時間表示方式的日期和時間。</span><span class="sxs-lookup"><span data-stu-id="9283c-207">Dates and times in an accepted date-time representation.</span></span><br /><br /> <span data-ttu-id="9283c-208">有效日期為 1900 年 3 月 1 日之後的所有日期。</span><span class="sxs-lookup"><span data-stu-id="9283c-208">Valid dates are all dates after March 1, 1900.</span></span>|  
|<span data-ttu-id="9283c-209">貨幣</span><span class="sxs-lookup"><span data-stu-id="9283c-209">Currency</span></span>|<span data-ttu-id="9283c-210">貨幣</span><span class="sxs-lookup"><span data-stu-id="9283c-210">Currency</span></span>|<span data-ttu-id="9283c-211">貨幣資料類型允許的值是從 -922,337,203,685,477.5808 到 922,337,203,685,477.5807 且固定有效位數為四個小數位數。</span><span class="sxs-lookup"><span data-stu-id="9283c-211">Currency data type allows values between -922,337,203,685,477.5808 to 922,337,203,685,477.5807 with four decimal digits of fixed precision.</span></span>|  
|<span data-ttu-id="9283c-212">N/A</span><span class="sxs-lookup"><span data-stu-id="9283c-212">N/A</span></span>|<span data-ttu-id="9283c-213">空白</span><span class="sxs-lookup"><span data-stu-id="9283c-213">Blank</span></span>|<span data-ttu-id="9283c-214">空白是 DAX 中表示和取代 SQL Null 的資料類型。</span><span class="sxs-lookup"><span data-stu-id="9283c-214">A blank is a data type in DAX that represents and replaces SQL nulls.</span></span> <span data-ttu-id="9283c-215">您可以使用 BLANK 函數建立空白，然後使用邏輯函數 ISBLANK 來測試空白。</span><span class="sxs-lookup"><span data-stu-id="9283c-215">You can create a blank by using the BLANK function, and test for blanks by using the logical function, ISBLANK.</span></span>|  
  
 <span data-ttu-id="9283c-216">表格式模型也包含資料表資料類型，做為許多 DAX 函數的輸入或輸出。</span><span class="sxs-lookup"><span data-stu-id="9283c-216">Tabular models also include the Table data type as the input or output to many DAX functions.</span></span> <span data-ttu-id="9283c-217">例如，FILTER 函數會採用資料表做為輸入，並輸出只包含符合篩選條件之資料列的另一份資料表。</span><span class="sxs-lookup"><span data-stu-id="9283c-217">For example, the FILTER function takes a table as input and outputs another table that contains only the rows that meet the filter conditions.</span></span> <span data-ttu-id="9283c-218">您可以結合資料表函數與彙總函式，透過動態定義的資料集執行複雜的計算。</span><span class="sxs-lookup"><span data-stu-id="9283c-218">By combining table functions with aggregation functions, you can perform complex calculations over dynamically defined data sets.</span></span>  
  
 <span data-ttu-id="9283c-219">資料類型通常會自動設定，因此，了解資料類型以及套用方式 (尤其是套用至 DAX 公式) 相當重要。</span><span class="sxs-lookup"><span data-stu-id="9283c-219">While data types are typically automatically set, it is important to understand data types and how they apply, in-particular, to DAX formulas.</span></span> <span data-ttu-id="9283c-220">例如，公式中的錯誤或非預期的結果通常是因為使用無法搭配引數中指定之資料類型使用的特定運算子所造成。</span><span class="sxs-lookup"><span data-stu-id="9283c-220">Errors in formulas or unexpected results, for example, are often caused by using a particular operator that cannot be used with a data type specified in an argument.</span></span> <span data-ttu-id="9283c-221">例如，公式 `= 1 & 2`會傳回字串結果 12。</span><span class="sxs-lookup"><span data-stu-id="9283c-221">For example, the formula, `= 1 & 2`, returns a string result of 12.</span></span> <span data-ttu-id="9283c-222">不過，公式 `= "1" + "2"`會傳回整數結果 3。</span><span class="sxs-lookup"><span data-stu-id="9283c-222">The formula, `= "1" + "2"`, however, returns an integer result of 3.</span></span>  
  
 <span data-ttu-id="9283c-223">如需 DAX 中表格式模型之資料類型與資料類型的明確和隱含轉換的詳細資訊，請參閱[支援的資料類型 &#40;SSAS 表格式&#41;](data-types-supported-ssas-tabular.md)。</span><span class="sxs-lookup"><span data-stu-id="9283c-223">For detailed information about data types in tabular models and explicit and implicit conversions of data types in DAX, see [Data Types Supported &#40;SSAS Tabular&#41;](data-types-supported-ssas-tabular.md).</span></span>  
  
##  <a name="dax-operators"></a><a name="bkmk_DAX_opertors"></a><span data-ttu-id="9283c-224">DAX 運算子</span><span class="sxs-lookup"><span data-stu-id="9283c-224">DAX Operators</span></span>  
 <span data-ttu-id="9283c-225">DAX 語言會在公式中使用四種不同類型的計算運算子：</span><span class="sxs-lookup"><span data-stu-id="9283c-225">The DAX language uses four different types of calculation operators in formulas:</span></span>  
  
-   <span data-ttu-id="9283c-226">比較運算子，用於比較值並傳回全域 TRUE\FALSE 值。</span><span class="sxs-lookup"><span data-stu-id="9283c-226">Comparison operators to compare values and return a logical TRUE\FALSE value.</span></span>  
  
-   <span data-ttu-id="9283c-227">算術運算子，用於執行傳回數值的算術計算。</span><span class="sxs-lookup"><span data-stu-id="9283c-227">Arithmetic operators to perform arithmetic calculations that return numeric values.</span></span>  
  
-   <span data-ttu-id="9283c-228">加入兩個或多個文字字串的文字串聯運算子。</span><span class="sxs-lookup"><span data-stu-id="9283c-228">Text concatenation operators to join two or more text strings.</span></span>  
  
-   <span data-ttu-id="9283c-229">邏輯運算子，其中會結合兩個或多個運算式以傳回單一結果。</span><span class="sxs-lookup"><span data-stu-id="9283c-229">Logical operators that combine two or more expressions to return a single result.</span></span>  
  
 <span data-ttu-id="9283c-230">如需 DAX 公式中使用之運算子的詳細資訊，請參閱[PowerPivot 的 DAX 運算子參考](/dax/dax-operator-reference)。</span><span class="sxs-lookup"><span data-stu-id="9283c-230">For detailed information about operators used in DAX formulas, see [DAX Operator Reference for PowerPivot](/dax/dax-operator-reference).</span></span>  
  
##  <a name="dax-formulas"></a><a name="bkmk_DAX_Formulas"></a><span data-ttu-id="9283c-231">DAX 公式</span><span class="sxs-lookup"><span data-stu-id="9283c-231">DAX Formulas</span></span>  
 <span data-ttu-id="9283c-232">DAX 公式對於在導出資料行和量值中建立計算，以及使用資料列層級篩選保護資料安全相當重要。</span><span class="sxs-lookup"><span data-stu-id="9283c-232">DAX formulas are essential for creating calculations in calculated columns and measures, and securing your data by using row level filters.</span></span> <span data-ttu-id="9283c-233">若要建立導出資料行和量值的公式，您將使用公式列以及模型設計師視窗的頂端。</span><span class="sxs-lookup"><span data-stu-id="9283c-233">To create formulas for calculated columns and measures, you will use the formula bar along the top of the model designer window.</span></span> <span data-ttu-id="9283c-234">若要建立資料列篩選的公式，您要使用 [角色管理員] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="9283c-234">To create formulas for row filters, you will use the Role Manager dialog box.</span></span> <span data-ttu-id="9283c-235">本節中的資訊是為了讓您開始了解 DAX 公式的基本概念。</span><span class="sxs-lookup"><span data-stu-id="9283c-235">Information in this section is meant to get you started with understanding the basics of DAX formulas.</span></span>  
  
###  <a name="formula-basics"></a><a name="basics"></a><span data-ttu-id="9283c-236">公式基本概念</span><span class="sxs-lookup"><span data-stu-id="9283c-236">Formula Basics</span></span>  
 <span data-ttu-id="9283c-237">DAX 可讓表格式模型作者在兩個模型資料表中定義自訂計算當做導出資料行的一部分，以及當做與資料表相關但是未直接出現在其中之量值的一部分。</span><span class="sxs-lookup"><span data-stu-id="9283c-237">DAX enables tabular model authors to define custom calculations in both model tables, as part of calculated columns, and as measures associated with tables, but not appearing directly in them.</span></span> <span data-ttu-id="9283c-238">DAX 也可讓模型作者保護資料安全，方法是，建立傳回布林值的計算、定義相關聯角色的成員使用者可以在特定或相關資料表中查詢的資料列。</span><span class="sxs-lookup"><span data-stu-id="9283c-238">DAX also enables model authors to secure data, by creating calculations that return a Boolean value defining which rows in a particular or related table can be queried by member users of the associated role.</span></span>  
  
 <span data-ttu-id="9283c-239">DAX 公式可以很簡單也可以很複雜。</span><span class="sxs-lookup"><span data-stu-id="9283c-239">DAX formulas can be very simple or quite complex.</span></span> <span data-ttu-id="9283c-240">下表顯示可能會在導出資料行中使用的一些簡單公式範例。</span><span class="sxs-lookup"><span data-stu-id="9283c-240">The following table shows some examples of simple formulas that could be used in a calculated column.</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="9283c-241">Formula</span><span class="sxs-lookup"><span data-stu-id="9283c-241">Formula</span></span>|<span data-ttu-id="9283c-242">描述</span><span class="sxs-lookup"><span data-stu-id="9283c-242">Description</span></span>|  
|`=TODAY()`|<span data-ttu-id="9283c-243">在資料行的每個資料列中插入今天的日期。</span><span class="sxs-lookup"><span data-stu-id="9283c-243">Inserts today's date in every row of the column.</span></span>|  
|`=3`|<span data-ttu-id="9283c-244">在資料行的每個資料列中，插入 3 這個值。</span><span class="sxs-lookup"><span data-stu-id="9283c-244">Inserts the value 3 in every row of the column.</span></span>|  
|`=[Column1] + [Column2]`|<span data-ttu-id="9283c-245">將 [Column1] 和 [Column2] 同一資料列中的值相加，並將結果放在相同資料列的導出資料行中。</span><span class="sxs-lookup"><span data-stu-id="9283c-245">Adds the values in the same row of [Column1] and [Column2] and puts the results in the calculated column of the same row.</span></span>|  
  
 <span data-ttu-id="9283c-246">無論您建立的公式簡單還是複雜，都可以在建立公式時使用以下步驟：</span><span class="sxs-lookup"><span data-stu-id="9283c-246">Whether the formula you create is simple or complex, you can use the following steps when building a formula:</span></span>  
  
1.  <span data-ttu-id="9283c-247">每個公式開頭都必須為等號。</span><span class="sxs-lookup"><span data-stu-id="9283c-247">Each formula must begin with an equal sign.</span></span>  
  
2.  <span data-ttu-id="9283c-248">您可以輸入或選取函數名稱，或輸入運算式。</span><span class="sxs-lookup"><span data-stu-id="9283c-248">You can either type or select a function name, or type an expression.</span></span>  
  
3.  <span data-ttu-id="9283c-249">開始輸入所需之函數或名稱的前幾個字母，「自動完成」就會顯示可用函數、資料表和資料行的清單。</span><span class="sxs-lookup"><span data-stu-id="9283c-249">Begin to type the first few letters of the function or name you want, and AutoComplete displays a list of available functions, tables, and columns.</span></span> <span data-ttu-id="9283c-250">按 TAB 鍵從「自動完成」清單將項目加入至公式。</span><span class="sxs-lookup"><span data-stu-id="9283c-250">Press TAB to add an item from the AutoComplete list to the formula.</span></span>  
  
     <span data-ttu-id="9283c-251">您也可以按一下 **Fx** 按鈕來顯示可用函數的清單。</span><span class="sxs-lookup"><span data-stu-id="9283c-251">You can also click the **Fx** button to display a list of available functions.</span></span> <span data-ttu-id="9283c-252">若要從下拉式清單中選取函數，使用方向鍵反白顯示該項目，然後按一下 **[確定]** ，就可以將該函數加入至公式中。</span><span class="sxs-lookup"><span data-stu-id="9283c-252">To select a function from the dropdown list, use the arrow keys to highlight the item, and click **OK** to add the function to the formula.</span></span>  
  
4.  <span data-ttu-id="9283c-253">從可能之資料表和資料行的下拉式清單中選取引數，或輸入值來提供函數的引數。</span><span class="sxs-lookup"><span data-stu-id="9283c-253">Supply the arguments to the function by selecting them from a dropdown list of possible tables and columns, or by typing in values.</span></span>  
  
5.  <span data-ttu-id="9283c-254">檢查語法錯誤：請確認所有括號都有成對，而且資料行、資料表和值的參考都正確。</span><span class="sxs-lookup"><span data-stu-id="9283c-254">Check for syntax errors: ensure that all parentheses are closed and columns, tables and values are referenced correctly.</span></span>  
  
6.  <span data-ttu-id="9283c-255">按下 ENTER 鍵接受公式。</span><span class="sxs-lookup"><span data-stu-id="9283c-255">Press ENTER to accept the formula.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9283c-256">在導出資料行中，當您接受公式而且公式已驗證之後，資料行就會立即用值擴展。</span><span class="sxs-lookup"><span data-stu-id="9283c-256">In a calculated column, as soon as you accept the formula and the formula is validated, the column is populated with values.</span></span> <span data-ttu-id="9283c-257">在量值中，按下 ENTER 可將量值定義與資料表一起儲存在量值方格中。</span><span class="sxs-lookup"><span data-stu-id="9283c-257">In a measure, pressing ENTER saves the measure definition in the measure grid with the table.</span></span> <span data-ttu-id="9283c-258">如果公式無效，則會顯示錯誤。</span><span class="sxs-lookup"><span data-stu-id="9283c-258">If a formula is invalid, an error will be displayed.</span></span>  
  
 <span data-ttu-id="9283c-259">在此範例中，我們將會在「當季天數」量值中看到更複雜的公式：</span><span class="sxs-lookup"><span data-stu-id="9283c-259">In this example, we will look at a more complex formula in a measure named Days in Current Quarter:</span></span>  
  
```  
Days in Current Quarter:=COUNTROWS( DATESBETWEEN( 'Date'[Date], STARTOFQUARTER( LASTDATE('Date'[Date])), ENDOFQUARTER('Date'[Date])))  
```  
  
 <span data-ttu-id="9283c-260">這個量值可用來在一個不完整期間與前一個期間之間建立比率。</span><span class="sxs-lookup"><span data-stu-id="9283c-260">This measure is used to create a comparison ratio between an incomplete period and the previous period.</span></span> <span data-ttu-id="9283c-261">此公式必須考慮期間內已經過的比例，並且將它與前一個期間中的相同比例進行比較。</span><span class="sxs-lookup"><span data-stu-id="9283c-261">The formula must take into account the proportion of the period that has elapsed, and compare it to the same proportion in the previous period.</span></span> <span data-ttu-id="9283c-262">在此案例中，[Days Current Quarter to Date]/[Days in Current Quarter] 會得出目前期間內已經過的比例。</span><span class="sxs-lookup"><span data-stu-id="9283c-262">In this case, [Days Current Quarter to Date]/[Days in Current Quarter] gives the proportion elapsed in the current period.</span></span>  
  
 <span data-ttu-id="9283c-263">此公式包含下列元素：</span><span class="sxs-lookup"><span data-stu-id="9283c-263">This formula contains the following elements:</span></span>  
  
|<span data-ttu-id="9283c-264">公式元素</span><span class="sxs-lookup"><span data-stu-id="9283c-264">Formula element</span></span>|<span data-ttu-id="9283c-265">描述</span><span class="sxs-lookup"><span data-stu-id="9283c-265">Description</span></span>|  
|---------------------|-----------------|  
|`Days in Current Quarter:=`|<span data-ttu-id="9283c-266">量值的名稱。</span><span class="sxs-lookup"><span data-stu-id="9283c-266">The name of the measure.</span></span>|  
|`=`|<span data-ttu-id="9283c-267">等號 (=) 開始公式。</span><span class="sxs-lookup"><span data-stu-id="9283c-267">The equals sign (=) begins the formula.</span></span>|  
|`COUNTROWS`|<span data-ttu-id="9283c-268">[COUNTROWS 函數 &#40;DAX&#41;](/dax/countrows-function-dax)計算 Date 資料表中的資料列數目。</span><span class="sxs-lookup"><span data-stu-id="9283c-268">The [COUNTROWS Function &#40;DAX&#41;](/dax/countrows-function-dax) counts the number of rows in the Date table</span></span>|  
|`()`|<span data-ttu-id="9283c-269">左右括號會指定引數。</span><span class="sxs-lookup"><span data-stu-id="9283c-269">Open and closing parenthesis specifies arguments.</span></span>|  
|`DATESBETWEEN`|<span data-ttu-id="9283c-270">DATESBETWEEN 函數會傳回 Date 資料表的 Date 資料行中，每個值最後一個日期間的日期。</span><span class="sxs-lookup"><span data-stu-id="9283c-270">The DATESBETWEEN function returns the dates between the last date for each value in the Date column in the Date table.</span></span>|  
|`'Date'`|<span data-ttu-id="9283c-271">指定 Date 資料表。</span><span class="sxs-lookup"><span data-stu-id="9283c-271">Specifies the Date table.</span></span> <span data-ttu-id="9283c-272">資料表用單引號括住。</span><span class="sxs-lookup"><span data-stu-id="9283c-272">Tables are in single quotes.</span></span>|  
|`[Date]`|<span data-ttu-id="9283c-273">指定 Date 資料表中的 Date 資料行。</span><span class="sxs-lookup"><span data-stu-id="9283c-273">Specifies the Date column in the Date table.</span></span> <span data-ttu-id="9283c-274">資料行用括弧括住。</span><span class="sxs-lookup"><span data-stu-id="9283c-274">Columns are in brackets.</span></span>|  
|`,`||  
|`STARTOFQUARTER`|<span data-ttu-id="9283c-275">STARTOFQUARTER 函數會傳回季度開始的日期。</span><span class="sxs-lookup"><span data-stu-id="9283c-275">The STARTOFQUARTER function returns the date of the start of the quarter.</span></span>|  
|`LASTDATE`|<span data-ttu-id="9283c-276">LASTDATE 函式會傳回季度的最後一個日期。</span><span class="sxs-lookup"><span data-stu-id="9283c-276">The LASTDATE function returns the last date of the quarter.</span></span>|  
|`'Date'`|<span data-ttu-id="9283c-277">指定 Date 資料表。</span><span class="sxs-lookup"><span data-stu-id="9283c-277">Specifies the Date table.</span></span>|  
|`[Date]`|<span data-ttu-id="9283c-278">指定 Date 資料表中的 Date 資料行。</span><span class="sxs-lookup"><span data-stu-id="9283c-278">Specifies the Date column in the Date table.</span></span>|  
|`,`||  
|`ENDOFQUARTER`|<span data-ttu-id="9283c-279">ENDOFQUARTER 函數</span><span class="sxs-lookup"><span data-stu-id="9283c-279">The ENDOFQUARTER function</span></span>|  
|`'Date'`|<span data-ttu-id="9283c-280">指定 Date 資料表。</span><span class="sxs-lookup"><span data-stu-id="9283c-280">Specifies the Date table.</span></span>|  
|`[Date]`|<span data-ttu-id="9283c-281">指定 Date 資料表中的 Date 資料行。</span><span class="sxs-lookup"><span data-stu-id="9283c-281">Specifies the Date column in the Date table.</span></span>|  
  
#### <a name="using-formula-autocomplete"></a><span data-ttu-id="9283c-282">使用公式自動完成</span><span class="sxs-lookup"><span data-stu-id="9283c-282">Using Formula AutoComplete</span></span>  
 <span data-ttu-id="9283c-283">模型設計師中的公式列和 [角色管理員] 對話方塊中的 [資料列篩選公式] 視窗都會提供 [自動完成] 功能。</span><span class="sxs-lookup"><span data-stu-id="9283c-283">Both the formula bar in the model designer and the formula Row Filters window in the Role Manager dialog box provide an AutoComplete feature.</span></span> <span data-ttu-id="9283c-284">[自動完成] 透過提供您公式中每個元素的選項，協助您輸入有效的公式語法。</span><span class="sxs-lookup"><span data-stu-id="9283c-284">AutoComplete helps you enter a valid formula syntax by providing you with options for each element in the formula.</span></span>  
  
-   <span data-ttu-id="9283c-285">您可以透過巢狀函數，在現有的公式中間使用「公式自動完成」功能。</span><span class="sxs-lookup"><span data-stu-id="9283c-285">You can use Formula AutoComplete in the middle of an existing formula with nested functions.</span></span> <span data-ttu-id="9283c-286">插入點前方的文字用於顯示下拉式清單中的值，而在插入點之後的所有文字則維持不變。</span><span class="sxs-lookup"><span data-stu-id="9283c-286">The text immediately before the insertion point is used to display values in the drop-down list, and all of the text after the insertion point remains unchanged.</span></span>  
  
-   <span data-ttu-id="9283c-287">自動完成不會加入函數的右括號，也不會自動比對括號。</span><span class="sxs-lookup"><span data-stu-id="9283c-287">AutoComplete does not add the closing parenthesis of functions or automatically match parentheses.</span></span> <span data-ttu-id="9283c-288">您必須確定每個函數的語法正確，否則您無法儲存或使用公式。</span><span class="sxs-lookup"><span data-stu-id="9283c-288">You must make sure that each function is syntactically correct or you cannot save or use the formula.</span></span>  
  
#### <a name="using-multiple-functions-in-a-formula"></a><span data-ttu-id="9283c-289">在公式中使用多個函數</span><span class="sxs-lookup"><span data-stu-id="9283c-289">Using Multiple Functions in a Formula</span></span>  
 <span data-ttu-id="9283c-290">您可以巢狀函數，也就是說，您可以使用某個函數的結果做為另一個函數的引數。</span><span class="sxs-lookup"><span data-stu-id="9283c-290">You can nest functions, meaning that you use the results from one function as an argument of another function.</span></span> <span data-ttu-id="9283c-291">您最多可以在計算結果欄中巢狀 64 個層級的函數。</span><span class="sxs-lookup"><span data-stu-id="9283c-291">You can nest up to 64 levels of functions in calculated columns.</span></span> <span data-ttu-id="9283c-292">不過，巢狀可能會使公式的建立或疑難排解變得困難。</span><span class="sxs-lookup"><span data-stu-id="9283c-292">However, nesting can make it difficult to create or troubleshoot formulas.</span></span>  
  
 <span data-ttu-id="9283c-293">許多函數的設計都是當做巢狀函數單獨使用。</span><span class="sxs-lookup"><span data-stu-id="9283c-293">Many functions are designed to be used solely as nested functions.</span></span> <span data-ttu-id="9283c-294">這些函數會傳回一個資料表，這個資料表是為了當做資料表函數的輸入而提供，無法直接儲存為結果。</span><span class="sxs-lookup"><span data-stu-id="9283c-294">These functions return a table, which cannot be directly saved as a result; it must be provided as input to a table function.</span></span> <span data-ttu-id="9283c-295">例如，SUMX、AVERAGEX 和 MINX 這些函數都需要使用資料表做為第一個引數。</span><span class="sxs-lookup"><span data-stu-id="9283c-295">For example, the functions SUMX, AVERAGEX, and MINX all require a table as the first argument.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9283c-296">為確保效能不受到資料行間相依性所需之多個計算的影響，在量值中巢狀函數有一些限制。</span><span class="sxs-lookup"><span data-stu-id="9283c-296">Some limits are applied within measures on nesting of functions to ensure that performance is not affected by the many calculations required by dependencies among columns.</span></span>  
  
##  <a name="dax-functions"></a><a name="bkmk_DAX_functions"></a><span data-ttu-id="9283c-297">DAX 函數</span><span class="sxs-lookup"><span data-stu-id="9283c-297">DAX Functions</span></span>  
 <span data-ttu-id="9283c-298">本節提供 DAX 支援之函數類型 \*\* 的概觀。</span><span class="sxs-lookup"><span data-stu-id="9283c-298">This section provides an overview of the *types* of functions supported in DAX.</span></span> <span data-ttu-id="9283c-299">如需詳細資訊，請參閱 [DAX Function Reference](/dax/dax-function-reference)。</span><span class="sxs-lookup"><span data-stu-id="9283c-299">For more detailed information, see [DAX Function Reference](/dax/dax-function-reference).</span></span>  
  
 <span data-ttu-id="9283c-300">DAX 會提供各種函數，您可以使用這些函數來執行使用日期和時間的計算、建立條件式值、處理字串、根據關聯性執行查閱，而且能夠逐一查看資料表以執行遞迴計算。</span><span class="sxs-lookup"><span data-stu-id="9283c-300">DAX provides a variety of functions you can use perform calculations using dates and times, create conditional values, work with strings, perform lookups based on relationships, and the ability to iterate over a table to perform recursive calculations.</span></span> <span data-ttu-id="9283c-301">如果您熟悉 Excel 公式，這些功能很多似乎非常相似，不過，DAX 公式在以下重要方面不同：</span><span class="sxs-lookup"><span data-stu-id="9283c-301">If you are familiar with Excel formulas, many of these functions will appear very similar; however, DAX formulas are different in the following important ways:</span></span>  
  
-   <span data-ttu-id="9283c-302">DAX 函數一律參考完整的資料行或資料表。</span><span class="sxs-lookup"><span data-stu-id="9283c-302">A DAX function always references a complete column or a table.</span></span> <span data-ttu-id="9283c-303">如果您只要使用資料表或資料行中的特定值，可以將篩選加入至公式。</span><span class="sxs-lookup"><span data-stu-id="9283c-303">If you want to use only particular values from a table or column, you can add filters to the formula.</span></span>  
  
-   <span data-ttu-id="9283c-304">如果您需要逐資料列自訂計算，DAX 提供的函數可讓您使用目前的資料列值或相關的值來當做某種參數，以便執行依內容而改變的計算。</span><span class="sxs-lookup"><span data-stu-id="9283c-304">If you need to customize calculations on a row-by-row basis, DAX provides functions that let you use the current row value or a related value as a kind of parameter, to perform calculations that vary by context.</span></span> <span data-ttu-id="9283c-305">若要了解這些函數的運作方式，請參閱本主題稍後的＜DAX 公式中的內容＞。</span><span class="sxs-lookup"><span data-stu-id="9283c-305">To understand how these functions work, see Context in DAX Formulas later in this topic.</span></span>  
  
-   <span data-ttu-id="9283c-306">DAX 包含的許多函數都會傳回資料表，而不是傳回值。</span><span class="sxs-lookup"><span data-stu-id="9283c-306">DAX includes many functions that return a table, rather than a value.</span></span> <span data-ttu-id="9283c-307">此資料表不會顯示在報告用戶端中，但是會用來提供其他函數的輸入。</span><span class="sxs-lookup"><span data-stu-id="9283c-307">The table is not displayed in a reporting client, but is used to provide input to other functions.</span></span> <span data-ttu-id="9283c-308">例如，您可以擷取資料表，然後計算其中相異值的數目，或是計算橫跨篩選資料表或資料行的動態總和。</span><span class="sxs-lookup"><span data-stu-id="9283c-308">For example, you can retrieve a table and then count the distinct values in it, or calculate dynamic sums across filtered tables or columns.</span></span>  
  
-   <span data-ttu-id="9283c-309">DAX 函數包含各種不同的 *「時間智慧」* (Time Intelligence) 函數。</span><span class="sxs-lookup"><span data-stu-id="9283c-309">DAX functions include a variety of *time intelligence* functions.</span></span> <span data-ttu-id="9283c-310">這些函數可讓您定義或選取日期範圍，並根據這些日期或範圍執行動態計算。</span><span class="sxs-lookup"><span data-stu-id="9283c-310">These functions let you define or select date ranges, and perform dynamic calculations based on these dates or range.</span></span> <span data-ttu-id="9283c-311">例如，您可以比較平行期間的總和。</span><span class="sxs-lookup"><span data-stu-id="9283c-311">For example, you can compare sums across parallel periods.</span></span>  
  
### <a name="date-and-time-functions"></a><span data-ttu-id="9283c-312">日期和時間函式</span><span class="sxs-lookup"><span data-stu-id="9283c-312">Date and Time Functions</span></span>  
 <span data-ttu-id="9283c-313">DAX 中的日期和時間函數與 Microsoft Excel 中的日期和時間函數類似。</span><span class="sxs-lookup"><span data-stu-id="9283c-313">The date and time functions in DAX are similar to date and time functions in Microsoft Excel.</span></span> <span data-ttu-id="9283c-314">不過，DAX 函數會以 Microsoft SQL Server 所使用的 `datetime` 資料類型為基礎。</span><span class="sxs-lookup"><span data-stu-id="9283c-314">However, DAX functions are based on the `datetime` data types used by Microsoft SQL Server.</span></span> <span data-ttu-id="9283c-315">如需詳細資訊，請參閱[&#40;DAX&#41;的日期和時間函數](/dax/date-and-time-functions-dax)。</span><span class="sxs-lookup"><span data-stu-id="9283c-315">For more information, see [Date and Time Functions &#40;DAX&#41;](/dax/date-and-time-functions-dax).</span></span>  
  
### <a name="filter-functions"></a><span data-ttu-id="9283c-316">篩選函數</span><span class="sxs-lookup"><span data-stu-id="9283c-316">Filter Functions</span></span>  
 <span data-ttu-id="9283c-317">DAX 中的篩選函數會傳回特定的資料類型、查閱相關資料表中的值，以及依相關值篩選。</span><span class="sxs-lookup"><span data-stu-id="9283c-317">The filter functions in DAX return specific data types, look up values in related tales, and filter by related values.</span></span> <span data-ttu-id="9283c-318">查閱函數會透過使用資料表和關聯性 (例如資料庫) 運作。</span><span class="sxs-lookup"><span data-stu-id="9283c-318">The lookup functions work by using tables and relationships, like a database.</span></span> <span data-ttu-id="9283c-319">篩選函數可讓您操作資料內容來建立動態計算。</span><span class="sxs-lookup"><span data-stu-id="9283c-319">The filtering functions let you manipulate data context to create dynamic calculations.</span></span> <span data-ttu-id="9283c-320">如需詳細資訊，請參閱[&#40;DAX&#41;的篩選函數](/dax/filter-functions-dax)。</span><span class="sxs-lookup"><span data-stu-id="9283c-320">For more information, see [Filter Functions &#40;DAX&#41;](/dax/filter-functions-dax).</span></span>  
  
### <a name="information-functions"></a><span data-ttu-id="9283c-321">資訊函數</span><span class="sxs-lookup"><span data-stu-id="9283c-321">Information Functions</span></span>  
 <span data-ttu-id="9283c-322">資訊函數會查看當做引數提供的資料格或資料列，然後告訴您該值是否符合預期的類型。</span><span class="sxs-lookup"><span data-stu-id="9283c-322">An information function looks at the cell or row that is provided as an argument and tells you whether the value matches the expected type.</span></span> <span data-ttu-id="9283c-323">例如，如果您參考的值包含錯誤，ISERROR 函數會傳回 TRUE。</span><span class="sxs-lookup"><span data-stu-id="9283c-323">For example, the ISERROR function returns TRUE if the value that you reference contains an error.</span></span> <span data-ttu-id="9283c-324">如需詳細資訊，請參閱[&#40;DAX&#41;的資訊函數](/dax/information-functions-dax)。</span><span class="sxs-lookup"><span data-stu-id="9283c-324">For more information, see [Information Functions &#40;DAX&#41;](/dax/information-functions-dax).</span></span>  
  
### <a name="logical-functions"></a><span data-ttu-id="9283c-325">邏輯函數</span><span class="sxs-lookup"><span data-stu-id="9283c-325">Logical Functions</span></span>  
 <span data-ttu-id="9283c-326">邏輯函數會在運算式上作用，以傳回運算式中值的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="9283c-326">Logical functions act upon an expression to return information about the values in the expression.</span></span> <span data-ttu-id="9283c-327">例如，TRUE 函式可讓您知道正在求解的運算式是否會傳回 TRUE 值。</span><span class="sxs-lookup"><span data-stu-id="9283c-327">For example, the TRUE function lets you know whether an expression that you are evaluating returns a TRUE value.</span></span> <span data-ttu-id="9283c-328">如需詳細資訊，請參閱[&#40;DAX&#41;的邏輯函數](/dax/logical-functions-dax)。</span><span class="sxs-lookup"><span data-stu-id="9283c-328">For more information, see [Logical Functions &#40;DAX&#41;](/dax/logical-functions-dax).</span></span>  
  
### <a name="mathematical-and-trigonometric-functions"></a><span data-ttu-id="9283c-329">數學和三角函數</span><span class="sxs-lookup"><span data-stu-id="9283c-329">Mathematical and Trigonometric Functions</span></span>  
 <span data-ttu-id="9283c-330">DAX 中的數學函數與 Excel 的數學和三角函數非常類似。</span><span class="sxs-lookup"><span data-stu-id="9283c-330">The mathematical functions in DAX are very similar to the Excel mathematical and trigonometric functions.</span></span> <span data-ttu-id="9283c-331">在 DAX 函數所使用的數值資料類型中有一些小差異。</span><span class="sxs-lookup"><span data-stu-id="9283c-331">Some minor differences exist in the numeric data types used by DAX functions.</span></span> <span data-ttu-id="9283c-332">如需詳細資訊，請參閱[&#40;DAX&#41;的數學和三角函數](/dax/math-and-trig-functions-dax)。</span><span class="sxs-lookup"><span data-stu-id="9283c-332">For more information, see [Math and Trig Functions &#40;DAX&#41;](/dax/math-and-trig-functions-dax).</span></span>  
  
### <a name="statistical-functions"></a><span data-ttu-id="9283c-333">統計函數</span><span class="sxs-lookup"><span data-stu-id="9283c-333">Statistical Functions</span></span>  
 <span data-ttu-id="9283c-334">DAX 提供執行彙總的統計函數。</span><span class="sxs-lookup"><span data-stu-id="9283c-334">DAX provides statistical functions that perform aggregations.</span></span> <span data-ttu-id="9283c-335">在 DAX 中，除了可以建立加總與平均值，或尋找最小與最大值之外，您還可以先篩選資料行再進行彙總，或是根據相關資料表建立彙總。</span><span class="sxs-lookup"><span data-stu-id="9283c-335">In addition to creating sums and averages, or finding the minimum and maximum values, in DAX you can also filter a column before aggregating or create aggregations based on related tables.</span></span> <span data-ttu-id="9283c-336">如需詳細資訊，請參閱[&#40;DAX&#41;的統計函數](/dax/statistical-functions-dax)。</span><span class="sxs-lookup"><span data-stu-id="9283c-336">For more information, see [Statistical Functions &#40;DAX&#41;](/dax/statistical-functions-dax).</span></span>  
  
### <a name="text-functions"></a><span data-ttu-id="9283c-337">文字函數</span><span class="sxs-lookup"><span data-stu-id="9283c-337">Text Functions</span></span>  
 <span data-ttu-id="9283c-338">DAX 中的文字函數與其在 Excel 中的對應項目非常類似。</span><span class="sxs-lookup"><span data-stu-id="9283c-338">The text functions in DAX are very similar to their counterparts in Excel.</span></span> <span data-ttu-id="9283c-339">您可以傳回字串的一部分、搜尋字串中的文字，或串連字串值。</span><span class="sxs-lookup"><span data-stu-id="9283c-339">You can return part of a string, search for text within a string, or concatenate string values.</span></span> <span data-ttu-id="9283c-340">DAX 也提供了用來控制日期、時間和數字之格式的函數。</span><span class="sxs-lookup"><span data-stu-id="9283c-340">DAX also provides functions for controlling the formats for dates, times, and numbers.</span></span> <span data-ttu-id="9283c-341">如需詳細資訊，請參閱[&#40;DAX&#41;的文字函數](/dax/text-functions-dax)。</span><span class="sxs-lookup"><span data-stu-id="9283c-341">For more information, see [Text Functions &#40;DAX&#41;](/dax/text-functions-dax).</span></span>  
  
### <a name="time-intelligence-functions"></a><span data-ttu-id="9283c-342">時間智慧函數</span><span class="sxs-lookup"><span data-stu-id="9283c-342">Time Intelligence Functions</span></span>  
 <span data-ttu-id="9283c-343">DAX 中所提供的時間智慧函數可讓您建立使用行事曆與日期之內建知識的計算。</span><span class="sxs-lookup"><span data-stu-id="9283c-343">The time intelligence functions provided in DAX let you create calculations that use built-in knowledge about calendars and dates.</span></span> <span data-ttu-id="9283c-344">使用時間和日期範圍結合彙總或計算，您可以針對銷售、清查等，在可比較的時間週期內建置有意義的比較。</span><span class="sxs-lookup"><span data-stu-id="9283c-344">By using time and date ranges in combination with aggregations or calculations, you can build meaningful comparisons across comparable time periods for sales, inventory, and so on.</span></span> <span data-ttu-id="9283c-345">如需詳細資訊，請參閱[&#40;DAX&#41;的時間智慧函數](/dax/time-intelligence-functions-dax)。</span><span class="sxs-lookup"><span data-stu-id="9283c-345">For more information, see [Time Intelligence Functions &#40;DAX&#41;](/dax/time-intelligence-functions-dax).</span></span>  
  
###  <a name="table-valued-functions"></a><a name="bkmk_TableFunc"></a><span data-ttu-id="9283c-346">資料表值函式</span><span class="sxs-lookup"><span data-stu-id="9283c-346">Table-Valued Functions</span></span>  
 <span data-ttu-id="9283c-347">有 DAX 函數可以輸出資料表並 (或) 採用資料表做為輸入。</span><span class="sxs-lookup"><span data-stu-id="9283c-347">There are DAX functions that output tables, take tables as input, or do both.</span></span> <span data-ttu-id="9283c-348">資料表可能會只有單一資料行，因此資料表值函式也會採用單一資料行做為輸入。</span><span class="sxs-lookup"><span data-stu-id="9283c-348">Because a table can have a single column, table-valued functions also take single columns as inputs.</span></span> <span data-ttu-id="9283c-349">了解如何使用這些資料表值函式對於善用 DAX 公式相當重要。</span><span class="sxs-lookup"><span data-stu-id="9283c-349">Understanding how to use these table-valued functions is important for fully utilizing DAX formulas.</span></span> <span data-ttu-id="9283c-350">DAX 包括下列類型的資料表值函式：</span><span class="sxs-lookup"><span data-stu-id="9283c-350">DAX includes the following types of table-valued functions:</span></span>  
  
 <span data-ttu-id="9283c-351">**篩選函數** ：傳回與目前資料列相關的資料行、資料表或值。</span><span class="sxs-lookup"><span data-stu-id="9283c-351">**Filter functions** Return a column, table, or values related to the current row.</span></span>  
  
 <span data-ttu-id="9283c-352">**彙總函式** ：彙總資料表資料列上的任何運算式。</span><span class="sxs-lookup"><span data-stu-id="9283c-352">**Aggregation functions** Aggregate any expression over the rows of a table.</span></span>  
  
 <span data-ttu-id="9283c-353">**時間智慧函數** ：傳回日期的資料表，或使用日期的資料表計算彙總。</span><span class="sxs-lookup"><span data-stu-id="9283c-353">**Time intelligence functions** Return a table of dates, or use a table of dates to calculate an aggregation.</span></span>  
  
##  <a name="context-in-dax-formulas"></a><a name="bkmk_context"></a><span data-ttu-id="9283c-354">DAX 公式中的內容</span><span class="sxs-lookup"><span data-stu-id="9283c-354">Context in DAX Formulas</span></span>  
 <span data-ttu-id="9283c-355">*「內容」* (Context) 是使用 DAX 建立公式時要了解的重要概念。</span><span class="sxs-lookup"><span data-stu-id="9283c-355">*Context* is an important concept to understand when creating formulas using DAX.</span></span> <span data-ttu-id="9283c-356">內容可讓您執行動態分析當做公式變更的結果，以反映目前的資料列或資料格選擇以及任何相關的資料。</span><span class="sxs-lookup"><span data-stu-id="9283c-356">Context is what enables you to perform dynamic analysis, as the results of a formula change to reflect the current row or cell selection and also any related data.</span></span> <span data-ttu-id="9283c-357">了解內容並有效地使用內容對於建立高效能的動態分析及排除公式內的問題而言將會非常關鍵。</span><span class="sxs-lookup"><span data-stu-id="9283c-357">Understanding context and using context effectively are critical for building high-performing, dynamic analyses, and for troubleshooting problems in formulas.</span></span>  
  
 <span data-ttu-id="9283c-358">表格式模型中的公式可以在不同內容中評估，這取決於其他設計元素：</span><span class="sxs-lookup"><span data-stu-id="9283c-358">Formulas in tabular models can be evaluated in a different context, depending on other design elements:</span></span>  
  
-   <span data-ttu-id="9283c-359">在樞紐分析表或報表中套用的篩選</span><span class="sxs-lookup"><span data-stu-id="9283c-359">Filters applied in a PivotTable or report</span></span>  
  
-   <span data-ttu-id="9283c-360">公式中定義的篩選</span><span class="sxs-lookup"><span data-stu-id="9283c-360">Filters defined within a formula</span></span>  
  
-   <span data-ttu-id="9283c-361">使用公式中的特殊函數指定的關聯性</span><span class="sxs-lookup"><span data-stu-id="9283c-361">Relationships specified by using special functions within a formula</span></span>  
  
 <span data-ttu-id="9283c-362">內容可分為以下不同類型： *「資料列內容」*(Row Context)、 *「查詢內容」*(Query Context) 和 *「篩選內容」*(Filter Context)。</span><span class="sxs-lookup"><span data-stu-id="9283c-362">There are different types of context: *row context*, *query context*, and *filter context*.</span></span>  
  
###  <a name="row-context"></a><a name="bkmk_row_context"></a><span data-ttu-id="9283c-363">資料列內容</span><span class="sxs-lookup"><span data-stu-id="9283c-363">Row Context</span></span>  
 <span data-ttu-id="9283c-364">資料*列內容*可以視為「目前的資料列」。</span><span class="sxs-lookup"><span data-stu-id="9283c-364">*Row context* can be thought of as "the current row".</span></span> <span data-ttu-id="9283c-365">如果您已經在導出資料行中建立公式，該公式的「資料列內容」(Row Context) 就會包含目前資料列中所有資料行的值。</span><span class="sxs-lookup"><span data-stu-id="9283c-365">If you create a formula in a calculated column, the row context for that formula includes the values from all columns in the current row.</span></span> <span data-ttu-id="9283c-366">如果資料表與另一個資料表相關，則內容也會包含後者中與目前資料列相關的所有值。</span><span class="sxs-lookup"><span data-stu-id="9283c-366">If the table is related to another table, the content also includes all the values from the other table that are related to the current row.</span></span>  
  
 <span data-ttu-id="9283c-367">例如，假設您建立導出資料行 `=[Freight] + [Tax]`，將相同資料表中兩個資料行 Freight 和 Tax 的值相加。</span><span class="sxs-lookup"><span data-stu-id="9283c-367">For example, suppose you create a calculated column, `=[Freight] + [Tax]`, that adds together values from two columns, Freight and Tax, from the same table.</span></span> <span data-ttu-id="9283c-368">此公式只會從指定之資料行中目前的資料列自動取得值。</span><span class="sxs-lookup"><span data-stu-id="9283c-368">This formula automatically gets only the values from the current row in the specified columns.</span></span>  
  
 <span data-ttu-id="9283c-369">資料列內容也會遵循資料表之間已定義的任何關聯性，包過在導出資料行內使用 DAX 公式所定義的關聯性，以判斷相關資料表中的哪些資料列與目前的資料列相關。</span><span class="sxs-lookup"><span data-stu-id="9283c-369">Row context also follows any relationships that have been defined between tables, including relationships defined within a calculated column by using DAX formulas, to determine which rows in related tables are associated with the current row.</span></span>  
  
 <span data-ttu-id="9283c-370">例如，下列公式會根據訂單的運送區域，使用 RELATED 函數來提取相關資料表中的稅額值。</span><span class="sxs-lookup"><span data-stu-id="9283c-370">For example, the following formula uses the RELATED function to fetch a tax value from a related table, based on the region that the order was shipped to.</span></span> <span data-ttu-id="9283c-371">稅額值的決定方式是使用目前資料表中的區域值，在相關資料表中查閱該區域，然後從相關資料表取得該區域的稅率。</span><span class="sxs-lookup"><span data-stu-id="9283c-371">The tax value is determined by using the value for region in the current table, looking up the region in the related table, and then getting the tax rate for that region from the related table.</span></span>  
  
```  
= [Freight] + RELATED('Region'[TaxRate])  
```  
  
 <span data-ttu-id="9283c-372">此公式會從 Region 資料表取得目前區域的稅率，然後將它加入至 Freight 資料行的值。</span><span class="sxs-lookup"><span data-stu-id="9283c-372">This formula gets the tax rate for the current region from the Region table and adds it to the value of the Freight column.</span></span> <span data-ttu-id="9283c-373">在 DAX 公式中，您不需要知道或指定連接不同資料表的特定關聯性。</span><span class="sxs-lookup"><span data-stu-id="9283c-373">In DAX formulas, you do not need to know or specify the specific relationship that connects the tables.</span></span>  
  
#### <a name="multiple-row-context"></a><span data-ttu-id="9283c-374">多個資料列內容</span><span class="sxs-lookup"><span data-stu-id="9283c-374">Multiple Row Context</span></span>  
 <span data-ttu-id="9283c-375">DAX 包含會反覆對資料表進行計算的函數。</span><span class="sxs-lookup"><span data-stu-id="9283c-375">DAX includes functions that iterate calculations over a table.</span></span> <span data-ttu-id="9283c-376">這些函數可以有多個目前資料列，每一個資料列都有自己的資料列內容。</span><span class="sxs-lookup"><span data-stu-id="9283c-376">These functions can have multiple current rows, each with its own row context.</span></span>  <span data-ttu-id="9283c-377">實際上，這些函數可讓您建立公式，這些公式會以遞迴方式對內部和外部迴圈執行運算。</span><span class="sxs-lookup"><span data-stu-id="9283c-377">In essence, these functions let you create formulas that perform operations recursively over an inner and outer loop.</span></span>  
  
 <span data-ttu-id="9283c-378">例如，假設您的模型中包含一個 **Products** 資料表和一個 **Sales** 資料表。</span><span class="sxs-lookup"><span data-stu-id="9283c-378">For example, suppose your model contains a **Products** table and a **Sales** table.</span></span> <span data-ttu-id="9283c-379">使用者可能會想查看整個 Sales 資料表 (其中都是與多項產品相關的交易)，然後在其中找到任何一次交易中每項產品的最大訂購數量。</span><span class="sxs-lookup"><span data-stu-id="9283c-379">Users might want to go through the entire sales table, which is full of transactions involving multiple products, and find the largest quantity ordered for each product in any one transaction.</span></span>  
  
 <span data-ttu-id="9283c-380">使用 DAX 時，您可以建立單一公式來傳回正確的值，而且每當使用者將資料加入至資料表時，都會自動更新結果。</span><span class="sxs-lookup"><span data-stu-id="9283c-380">With DAX you can build a single formula that returns the correct value, and the results are automatically updated any time a user adds data to the tables.</span></span>  
  
```  
=MAXX(FILTER(Sales,[ProdKey]=EARLIER([ProdKey])),Sales[OrderQty])  
```  
  
 <span data-ttu-id="9283c-381">如需此公式的詳細逐步解說，請參閱[先前](/dax/earlier-function-dax)的函式。</span><span class="sxs-lookup"><span data-stu-id="9283c-381">For a detailed walkthrough of this formula, see the [EARLIER Function](/dax/earlier-function-dax).</span></span>  
  
 <span data-ttu-id="9283c-382">總而言之，EARLIER 函數會儲存目前運算前之運算中的資料列內容。</span><span class="sxs-lookup"><span data-stu-id="9283c-382">To summarize, the EARLIER function stores the row context from the operation that preceded the current operation.</span></span> <span data-ttu-id="9283c-383">函數隨時都會在記憶體中儲存兩組內容：一組內容代表公式內部迴圈的目前資料列，另一組內容代表公式外部迴圈的目前資料列。</span><span class="sxs-lookup"><span data-stu-id="9283c-383">At all times, the function stores in memory two sets of context: one set of context represents the current row for the inner loop of the formula, and another set of context represents the current row for the outer loop of the formula.</span></span> <span data-ttu-id="9283c-384">DAX 會自動在兩個迴圈之間選取饋入值，讓您能夠建立複雜的彙總。</span><span class="sxs-lookup"><span data-stu-id="9283c-384">DAX automatically feeds values between the two loops so that you can create complex aggregates.</span></span>  
  
####  <a name="query-context"></a><a name="bkmk_query_context"></a><span data-ttu-id="9283c-385">查詢內容</span><span class="sxs-lookup"><span data-stu-id="9283c-385">Query Context</span></span>  
 <span data-ttu-id="9283c-386">*「查詢內容」* (Query Context) 指的是以隱含方式針對公式擷取之資料的子集。</span><span class="sxs-lookup"><span data-stu-id="9283c-386">*Query context* refers to the subset of data that is implicitly retrieved for a formula.</span></span> <span data-ttu-id="9283c-387">當使用者將量值或其他值欄位放入樞紐分析表中或是以表格式模型為基礎的報表中時，引擎會檢查資料列和資料行標頭、交叉分析篩選器和報表篩選來判斷內容。</span><span class="sxs-lookup"><span data-stu-id="9283c-387">When a user places a measure or other value field into a PivotTable or into a report based on a tabular model, the engine examines the row and column headers, Slicers, and report filters to determine the context.</span></span> <span data-ttu-id="9283c-388">然後，將會針對資料來源執行必要查詢來取得正確的資料子集、執行公式所定義的計算，然後填入樞紐分析表或報表中的每個資料格。</span><span class="sxs-lookup"><span data-stu-id="9283c-388">Then, the necessary queries are run against the data source to get the correct subset of data, make the calculations defined by the formula, and then populate each cell in the PivotTable or report.</span></span> <span data-ttu-id="9283c-389">所擷取的資料集就是每個資料格的查詢內容。</span><span class="sxs-lookup"><span data-stu-id="9283c-389">The set of data that is retrieved is the query context for each cell.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="9283c-390">在 DirectQuery 模式的模型中，先評估內容，然後擷取正確資料子集和計算結果的設定作業會轉譯成 SQL 陳述式。</span><span class="sxs-lookup"><span data-stu-id="9283c-390">For a model in DirectQuery mode, the context is evaluated, and then the set operations to retrieve the correct subset of data and calculate the results are translated to SQL statements.</span></span> <span data-ttu-id="9283c-391">這些陳述式會直接針對關聯式資料存放區來執行。</span><span class="sxs-lookup"><span data-stu-id="9283c-391">Those statements are then directly run against the relational data store.</span></span> <span data-ttu-id="9283c-392">因此，雖然取得資料和計算結果的方法不同，但是內容本身不會改變。</span><span class="sxs-lookup"><span data-stu-id="9283c-392">Therefore, although the method of getting the data and calculating the results is different, the context itself does not change.</span></span>  
  
 <span data-ttu-id="9283c-393">因為內容會根據您放置公式的地方而不同，所以公式的結果也會改變。</span><span class="sxs-lookup"><span data-stu-id="9283c-393">Because context changes depending on where you place the formula, the results of the formula can also change.</span></span>  
  
 <span data-ttu-id="9283c-394">例如，假設您建立公式來加總 **Sales** 資料表中 **Profit** 資料行內的值： `=SUM('Sales'[Profit])`。</span><span class="sxs-lookup"><span data-stu-id="9283c-394">For example, suppose you create a formula that sums the values in the **Profit** column of the **Sales** table: `=SUM('Sales'[Profit])`.</span></span>  <span data-ttu-id="9283c-395">如果您在 **Sales** 資料表之中的導出資料行內使用這個公式，整個資料表的公式結果都是一樣的，因為公式的查詢內容一律都是 **Sales** 資料表的整個資料集。</span><span class="sxs-lookup"><span data-stu-id="9283c-395">If you use this formula in a calculated column within the **Sales** table, the results for the formula will be the same for the entire table, because the query context for the formula is always the entire data set of the **Sales** table.</span></span> <span data-ttu-id="9283c-396">結果會包含所有區域、所有產品、所有年度等等的利潤。</span><span class="sxs-lookup"><span data-stu-id="9283c-396">Results will have profit for all regions, all products, all years, and so on.</span></span>  
  
 <span data-ttu-id="9283c-397">但是，使用者通常不會想要一直看到相同的結果，而會想取得特定年度、特定國家/地區、特定產品，或上述各項的某個組合的利潤，然後取得總計。</span><span class="sxs-lookup"><span data-stu-id="9283c-397">However, users typically don't want to see the same result hundreds of times, but instead want to get the profit for a particular year, a particular country, a particular product, or some combination of these, and then get a grand total.</span></span>  
  
 <span data-ttu-id="9283c-398">您可以加入或移除資料行和資料列標頭，以及加入或移除交叉分析篩選器，來變更樞紐分析表中的內容。</span><span class="sxs-lookup"><span data-stu-id="9283c-398">In a PivotTable, context can be changed by adding or removing column and row headers and by adding or removing Slicers.</span></span> <span data-ttu-id="9283c-399">每當使用者將資料行或資料列標題加入樞紐分析表時，都會變更評估量值的查詢內容。</span><span class="sxs-lookup"><span data-stu-id="9283c-399">Whenever users add column or row headings to the PivotTable, they change the query context in which the measure is evaluated.</span></span> <span data-ttu-id="9283c-400">配量和篩選作業也會影響內容。</span><span class="sxs-lookup"><span data-stu-id="9283c-400">Slicing and filtering operations also affect context.</span></span> <span data-ttu-id="9283c-401">因此，用於量值中的同一個公式會以不同的 *「查詢內容」* (Query Context) 為每個資料格進行評估。</span><span class="sxs-lookup"><span data-stu-id="9283c-401">Therefore, the same formula, used in a measure, is evaluated in a different *query context* for each cell.</span></span>  
  
####  <a name="filter-context"></a><a name="bkmk_filter_context"></a><span data-ttu-id="9283c-402">篩選內容</span><span class="sxs-lookup"><span data-stu-id="9283c-402">Filter Context</span></span>  
 <span data-ttu-id="9283c-403">*「篩選內容」* (Filter Context) 是每一個資料行中或是從相關資料表擷取的值中所允許的一組值。</span><span class="sxs-lookup"><span data-stu-id="9283c-403">*Filter context* is the set of values allowed in each column, or in the values retrieved from a related table.</span></span> <span data-ttu-id="9283c-404">篩選可以在設計工具或展示層 (報表與樞紐分析表) 中套用到資料行。</span><span class="sxs-lookup"><span data-stu-id="9283c-404">Filters can be applied to the column in the designer, or in the presentation layer (reports and PivotTables).</span></span> <span data-ttu-id="9283c-405">也可以由公式內的篩選運算式明確定義篩選。</span><span class="sxs-lookup"><span data-stu-id="9283c-405">Filters can also be defined explicitly by filter expressions within the formula.</span></span>  
  
 <span data-ttu-id="9283c-406">當您使用公式的引數來指定資料行或資料表內允許之值組的篩選條件約束時，就會加入「篩選內容」(Filter Context)。</span><span class="sxs-lookup"><span data-stu-id="9283c-406">Filter context is added when you specify filter constraints on the set of values allowed in a column or table, by using arguments to a formula.</span></span> <span data-ttu-id="9283c-407">篩選內容會套用到其他內容 (如資料列內容或查詢內容) 之上。</span><span class="sxs-lookup"><span data-stu-id="9283c-407">Filter context applies on top of other contexts, such as row context or query context.</span></span>  
  
 <span data-ttu-id="9283c-408">在表格式模型中，有多個方式可以建立篩選內容。</span><span class="sxs-lookup"><span data-stu-id="9283c-408">In tabular models, there are many ways to create filter context.</span></span> <span data-ttu-id="9283c-409">在可以取用模型的用戶端內容 (例如 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] 報表) 中，使用者可以在資料列和資料行標題上加入交叉分析篩選器或報表篩選來即時建立篩選。</span><span class="sxs-lookup"><span data-stu-id="9283c-409">Within the context of clients that can consume the model, such as [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] reports, users can create filters on the fly by adding slicers or report filters on the row and column headings.</span></span> <span data-ttu-id="9283c-410">您也可以直接在公式內指定篩選運算式，以便指定相關的值、篩選當做輸入使用的資料表，或是針對計算中使用的值來動態取得內容。</span><span class="sxs-lookup"><span data-stu-id="9283c-410">You can also specify filter expressions directly within the formula, to specify related values, to filter tables that are used as inputs, or to dynamically get context for the values that are used in calculations.</span></span> <span data-ttu-id="9283c-411">您也可以完全清除或選擇性清除特定資料行上的篩選。</span><span class="sxs-lookup"><span data-stu-id="9283c-411">You can also completely clear or selectively clear the filters on particular columns.</span></span> <span data-ttu-id="9283c-412">當您建立公式來計算總計時，這樣的方式非常實用。</span><span class="sxs-lookup"><span data-stu-id="9283c-412">This is very useful when creating formulas that calculate grand totals.</span></span>  
  
 <span data-ttu-id="9283c-413">如需如何在公式中建立篩選的詳細資訊，請參閱[FILTER 函數](/dax/filter-function-dax)。</span><span class="sxs-lookup"><span data-stu-id="9283c-413">For more information about how to create filters within formulas, see the [FILTER Function](/dax/filter-function-dax).</span></span>  
  
 <span data-ttu-id="9283c-414">如需如何清除篩選以建立總計的範例，請參閱[ALL 函數](/dax/all-function-dax)。</span><span class="sxs-lookup"><span data-stu-id="9283c-414">For an example of how filters can be cleared to create grand totals, see the [ALL Function](/dax/all-function-dax).</span></span>  
  
 <span data-ttu-id="9283c-415">如需如何在公式中選擇性清除及套用篩選的範例，請參閱[ALLEXCEPT 函數](/dax/allexcept-function-dax)。</span><span class="sxs-lookup"><span data-stu-id="9283c-415">For examples of how to selectively clear and apply filters within formulas, see the [ALLEXCEPT Function](/dax/allexcept-function-dax).</span></span>  
  
####  <a name="determining-context-in-formulas"></a><a name="bkmk_determine_context"></a> <span data-ttu-id="9283c-416">決定公式內的內容</span><span class="sxs-lookup"><span data-stu-id="9283c-416">Determining Context in Formulas</span></span>  
 <span data-ttu-id="9283c-417">當您建立 DAX 公式時，會先測試公式的語法是否有效，然後再測試來確定公式內包含的資料行和資料表名稱可以在目前內容中找到。</span><span class="sxs-lookup"><span data-stu-id="9283c-417">When you create a DAX formula, the formula is first tested for valid syntax, and then tested to make sure the names of the columns and tables included in the formula can be found in the current context.</span></span> <span data-ttu-id="9283c-418">如果找不到公式所指定的任何資料行或資料表，就會傳回錯誤。</span><span class="sxs-lookup"><span data-stu-id="9283c-418">If any column or table specified by the formula cannot be found, an error is returned.</span></span>  
  
 <span data-ttu-id="9283c-419">如前幾節中所述，驗證期間的內容 (和重算運算) 是使用模型中可用的資料表、資料表之間的任何關聯性，以及已套用的任何篩選來決定。</span><span class="sxs-lookup"><span data-stu-id="9283c-419">Context during validation (and recalculation operations) is determined as described in the preceding sections, by using the available tables in the model, any relationships between the tables, and any filters that have been applied.</span></span>  
  
 <span data-ttu-id="9283c-420">例如，如果您只將某些資料匯入新的資料表，而且該資料並未與其他任何資料表有關 (而且您尚未套用任何篩選)，則「目前內容」\*\* 是資料表中一組完整的資料行。</span><span class="sxs-lookup"><span data-stu-id="9283c-420">For example, if you have just imported some data into a new table and it is not related to any other tables (and you have not applied any filters), the *current context* is the entire set of columns in the table.</span></span> <span data-ttu-id="9283c-421">如果此資料表與其他資料表之間有關聯性，則目前內容會包含相關資料表。</span><span class="sxs-lookup"><span data-stu-id="9283c-421">If the table is linked by relationships to other tables, the current context includes the related tables.</span></span> <span data-ttu-id="9283c-422">如果您將資料表中的資料行加入至擁有交叉分析篩選器以及或許某些報表篩選的報表中，則公式的內容為報表內每一個資料格中的資料子集。</span><span class="sxs-lookup"><span data-stu-id="9283c-422">If you add a column from the table to a report that has Slicers and maybe some report filters, the context for the formula is the subset of data in each cell of the report.</span></span>  
  
 <span data-ttu-id="9283c-423">內容是效用強大的概念，但也可能會使公式的疑難排解變得很困難。</span><span class="sxs-lookup"><span data-stu-id="9283c-423">Context is a powerful concept that can also make it difficult to troubleshoot formulas.</span></span> <span data-ttu-id="9283c-424">建議您從簡單的公式和關聯性開始，以了解內容如何運作。</span><span class="sxs-lookup"><span data-stu-id="9283c-424">We recommend that you begin with simple formulas and relationships to see how context works.</span></span> <span data-ttu-id="9283c-425">下一節提供一些範例，說明公式如何使用不同類型的內容以動態方式傳回結果。</span><span class="sxs-lookup"><span data-stu-id="9283c-425">The following section provides some examples of how formulas use different types of context to dynamically return results.</span></span>  
  
##### <a name="examples-of-context-in-formulas"></a><span data-ttu-id="9283c-426">公式中的內容範例</span><span class="sxs-lookup"><span data-stu-id="9283c-426">Examples of Context in Formulas</span></span>  
  
1.  <span data-ttu-id="9283c-427">[相關](/dax/related-function-dax)的函式函式會展開目前資料列的內容，以包含相關資料行中的值。</span><span class="sxs-lookup"><span data-stu-id="9283c-427">The [RELATED Function](/dax/related-function-dax) function expands the context of the current row to include values in a related column.</span></span> <span data-ttu-id="9283c-428">這可以讓您執行查閱。</span><span class="sxs-lookup"><span data-stu-id="9283c-428">This lets you perform lookups.</span></span> <span data-ttu-id="9283c-429">本主題中的範例說明篩選與資料列內容的互動。</span><span class="sxs-lookup"><span data-stu-id="9283c-429">The example in this topic illustrates the interaction of filtering and row context.</span></span>  
  
2.  <span data-ttu-id="9283c-430">[FILTER 函數](/dax/filter-function-dax)函數可讓您指定要包含在目前內容中的資料列。</span><span class="sxs-lookup"><span data-stu-id="9283c-430">The [FILTER Function](/dax/filter-function-dax) function lets you specify the rows to include in the current context.</span></span> <span data-ttu-id="9283c-431">本主題的範例也將說明如何在執行彙總的其他函數中嵌入篩選。</span><span class="sxs-lookup"><span data-stu-id="9283c-431">The examples in this topic also illustrate how to embed filters within other functions that perform aggregates.</span></span>  
  
3.  <span data-ttu-id="9283c-432">[ALL 函數](/dax/all-function-dax)函式會在公式中設定內容。</span><span class="sxs-lookup"><span data-stu-id="9283c-432">The [ALL Function](/dax/all-function-dax) function sets context within a formula.</span></span> <span data-ttu-id="9283c-433">您可以使用它來覆寫套用為查詢內容結果的篩選。</span><span class="sxs-lookup"><span data-stu-id="9283c-433">You can use it to override filters that are applied as result of query context.</span></span>  
  
4.  <span data-ttu-id="9283c-434">[ALLEXCEPT](/dax/allexcept-function-dax)函式可讓您移除您指定的所有篩選。</span><span class="sxs-lookup"><span data-stu-id="9283c-434">The [ALLEXCEPT Function](/dax/allexcept-function-dax) function lets you remove all filters except one that you specify.</span></span> <span data-ttu-id="9283c-435">兩個主題都包含範例，可讓您逐步建立公式及了解複雜的內容。</span><span class="sxs-lookup"><span data-stu-id="9283c-435">Both topics include examples that walk you through building formulas and understanding complex contexts.</span></span>  
  
5.  <span data-ttu-id="9283c-436">[先前](/dax/earlier-function-dax)的函式和[最早](/dax/earliest-function-dax)函式函式可讓您執行計算來迴圈處理資料表，同時參考內部迴圈的值。</span><span class="sxs-lookup"><span data-stu-id="9283c-436">The [EARLIER Function](/dax/earlier-function-dax) and [EARLIEST Function](/dax/earliest-function-dax) functions let you loop through tables by performing calculations, while referencing a value from an inner loop.</span></span> <span data-ttu-id="9283c-437">如果您很熟悉遞迴的概念以及內部和外部迴圈，將深刻領會 EARLIER 和 EARLIEST 函數所提供的強大效用。</span><span class="sxs-lookup"><span data-stu-id="9283c-437">If you are familiar with the concept of recursion and with inner and outer loops, you will appreciate the power that the EARLIER and EARLIEST functions provide.</span></span> <span data-ttu-id="9283c-438">如果您不太熟悉這些概念，應該小心地遵循範例中的步驟執行，以了解內部和外部內容如何運用於計算中。</span><span class="sxs-lookup"><span data-stu-id="9283c-438">If you are new to these concepts, you should follow the steps in the example carefully to see how the inner and outer contexts are used in calculations.</span></span>  
  
##  <a name="formulas-and-the-tabular-model"></a><a name="bkmk_RelModel"></a><span data-ttu-id="9283c-439">公式與表格式模型</span><span class="sxs-lookup"><span data-stu-id="9283c-439">Formulas and the Tabular Model</span></span>  
 <span data-ttu-id="9283c-440">[!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]中的模型設計師是一個區域，您可以在其中使用資料的多個資料表，並連接表格式模型中的資料表。</span><span class="sxs-lookup"><span data-stu-id="9283c-440">The model designer, in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], is an area where you can work with multiple tables of data and connect the tables in a tabular model.</span></span> <span data-ttu-id="9283c-441">在此模型內，將會透過資料行與一般值 (索引鍵) 的關聯性來聯結資料表。</span><span class="sxs-lookup"><span data-stu-id="9283c-441">Within this model, tables are joined by relationships on columns with common values (keys).</span></span> <span data-ttu-id="9283c-442">此表格式模型可讓您將值連結到其他資料表內的資料行，並建立更有趣的計算。</span><span class="sxs-lookup"><span data-stu-id="9283c-442">The tabular model lets you link values to columns in other tables and create more interesting calculations.</span></span> <span data-ttu-id="9283c-443">正如在關聯式資料庫中一樣，您可以連接許多層級的相關資料表，並使用結果內任何資料表中的資料行。</span><span class="sxs-lookup"><span data-stu-id="9283c-443">Just as in a relational database, you can connect many levels of related tables and use columns from any of the tables in the results.</span></span>  
  
 <span data-ttu-id="9283c-444">例如，您可以連結銷售資料表、產品資料表和產品類別資料表，而且使用者可以在樞紐分析表和報表內使用各種不同的資料行組合。</span><span class="sxs-lookup"><span data-stu-id="9283c-444">For example, you can link a sales table, a products table, and a product categories table, and users can use various combinations of the columns in PivotTables and reports.</span></span> <span data-ttu-id="9283c-445">相關欄位可以用來篩選連接的資料表，或是用來建立子集的計算</span><span class="sxs-lookup"><span data-stu-id="9283c-445">Related fields can be used to filter connected tables, or to create calculations over subsets.</span></span> <span data-ttu-id="9283c-446">(如果您不熟悉關聯式資料庫但想使用資料表和聯結，請參閱[關聯性 &#40;SSAS 表格式&#41;](relationships-ssas-tabular.md))。</span><span class="sxs-lookup"><span data-stu-id="9283c-446">(If you are not familiar with relational database and working with tables and joins, see [Relationships &#40;SSAS Tabular&#41;](relationships-ssas-tabular.md).)</span></span>  
  
 <span data-ttu-id="9283c-447">表格式模型支援資料表之間的多個關聯性。</span><span class="sxs-lookup"><span data-stu-id="9283c-447">Tabular models support multiple relationships among tables.</span></span> <span data-ttu-id="9283c-448">為了避免混淆或結果錯誤，一次只會將一個關聯性指定為作用中的關聯性，但是您可以視需要變更作用中的關聯性，以便周遊計算資料中的不同連接。</span><span class="sxs-lookup"><span data-stu-id="9283c-448">To avoid confusion or wrong results, only one relationship at a time is designated as the active relationship, but you can change the active relationship as necessary to traverse different connections in the data in calculations.</span></span> <span data-ttu-id="9283c-449">[USERELATIONSHIP 函數 &#40;DAX&#41;](/dax/userelationship-function-dax)可用來指定要用於特定計算中的一個或多個關聯性。</span><span class="sxs-lookup"><span data-stu-id="9283c-449">The [USERELATIONSHIP Function &#40;DAX&#41;](/dax/userelationship-function-dax) can be used to specify one or more relationships to be used in a specific calculation.</span></span>  
  
 <span data-ttu-id="9283c-450">在表格式模型中，您應該會看到這些公式設計規則：</span><span class="sxs-lookup"><span data-stu-id="9283c-450">In a tabular model, you should observe these formula design rules:</span></span>  
  
-   <span data-ttu-id="9283c-451">當透過關聯性連接資料表時，您必須確認當做索引鍵使用的兩個資料行擁有相符的值。</span><span class="sxs-lookup"><span data-stu-id="9283c-451">When tables are connected by a relationship, you must ensure that the two columns used as keys have values that match.</span></span> <span data-ttu-id="9283c-452">但是不會強制執行參考完整性，所以有可能索引鍵資料行中有不相符的值而仍建立關聯性。</span><span class="sxs-lookup"><span data-stu-id="9283c-452">Referential integrity is not enforced, however; therefore it is possible to have non-matching values in a key column and still create a relationship.</span></span> <span data-ttu-id="9283c-453">如果發生這個狀況，您應該小心空白值或不相符的值可能會影響公式的結果。</span><span class="sxs-lookup"><span data-stu-id="9283c-453">If this happens, you should be aware that blank values or non-matching values might affect the results of formulas.</span></span>  
  
-   <span data-ttu-id="9283c-454">當您在模型中使用關聯性來連結資料表時，便會放大評估公式所在的範圍或 *「內容」*(Context)。</span><span class="sxs-lookup"><span data-stu-id="9283c-454">When you link tables in your model by using relationships, you enlarge the scope, or *context*, in which your formulas are evaluated.</span></span> <span data-ttu-id="9283c-455">因為增加新的資料表、新的關聯性或是使用中關聯性的變更而導致的內容變更可能會導致您的結果以意外的方式改變。</span><span class="sxs-lookup"><span data-stu-id="9283c-455">Changes in context resulting from the addition of new tables, new relationships, or from changes in the active relationship can cause your results to change in ways that you might not anticipate.</span></span> <span data-ttu-id="9283c-456">如需詳細資訊，請參閱本主題先前的 [DAX 公式中的內容](#bkmk_context) 。</span><span class="sxs-lookup"><span data-stu-id="9283c-456">For more information, see [Context in DAX Formulas](#bkmk_context) earlier in this topic.</span></span>  
  
##  <a name="working-with-tables-and-columns"></a><a name="bkmk_tables"></a><span data-ttu-id="9283c-457">使用資料表和資料行</span><span class="sxs-lookup"><span data-stu-id="9283c-457">Working with Tables and Columns</span></span>  
 <span data-ttu-id="9283c-458">表格式模型中資料表的外觀就像 Excel 資料表，但其搭配資料與公式使用的方式有所不同：</span><span class="sxs-lookup"><span data-stu-id="9283c-458">Tables in tabular models look like Excel tables, but are different in the way they work with data and with formulas:</span></span>  
  
-   <span data-ttu-id="9283c-459">公式只能搭配資料表和資料行運作，而不能搭配個別的資料格、範圍參考或陣列。</span><span class="sxs-lookup"><span data-stu-id="9283c-459">Formulas work only with tables and columns, not with individual cells, range references, or arrays.</span></span>  
  
-   <span data-ttu-id="9283c-460">公式可以使用關聯性從相關的資料表取得值。</span><span class="sxs-lookup"><span data-stu-id="9283c-460">Formulas can use relationships to get values from related tables.</span></span> <span data-ttu-id="9283c-461">擷取的值永遠都會與目前的資料列值相關聯。</span><span class="sxs-lookup"><span data-stu-id="9283c-461">The values that are retrieved are always related to the current row value.</span></span>  
  
-   <span data-ttu-id="9283c-462">您不能像是在 Excel 工作表一樣，擁有不規則或「不完全」的資料，</span><span class="sxs-lookup"><span data-stu-id="9283c-462">You cannot have irregular or "ragged" data like you can in an Excel worksheet.</span></span> <span data-ttu-id="9283c-463">資料表中的每個資料列都必須包含相同數目的資料行。</span><span class="sxs-lookup"><span data-stu-id="9283c-463">Each row in a table must contain the same number of columns.</span></span> <span data-ttu-id="9283c-464">不過，在某些資料行中可以有空的值。</span><span class="sxs-lookup"><span data-stu-id="9283c-464">However, you can have empty values in some columns.</span></span> <span data-ttu-id="9283c-465">Excel 資料表和表格式模型資料表不能彼此交換。</span><span class="sxs-lookup"><span data-stu-id="9283c-465">Excel data tables and tabular model data tables are not interchangeable.</span></span>  
  
-   <span data-ttu-id="9283c-466">因為資料類型是針對每個資料行設定的，所以該資料行中的每個值都必須是相同類型。</span><span class="sxs-lookup"><span data-stu-id="9283c-466">Because a data type is set for each column, each value in that column must be of the same type.</span></span>  
  
### <a name="referring-to-tables-and-columns-in-formulas"></a><span data-ttu-id="9283c-467">在公式中參考資料表和資料行</span><span class="sxs-lookup"><span data-stu-id="9283c-467">Referring to Tables and Columns in Formulas</span></span>  
 <span data-ttu-id="9283c-468">您可以使用名稱來參照任何資料表和資料行。</span><span class="sxs-lookup"><span data-stu-id="9283c-468">You can refer to any table and column by using its name.</span></span> <span data-ttu-id="9283c-469">例如，下列公式說明如何使用 *「完整」* (Fully Qualified) 名稱，參照兩個資料表的資料行：</span><span class="sxs-lookup"><span data-stu-id="9283c-469">For example, the following formula illustrates how to refer to columns from two tables by using the *fully qualified* name:</span></span>  
  
```  
=SUM('New Sales'[Amount]) + SUM('Past Sales'[Amount])  
```  
  
 <span data-ttu-id="9283c-470">評估公式時，模型設計師會先檢查一般語法，然後對照目前內容中可能的資料行和資料表來檢查您提供的資料行和資料表名稱。</span><span class="sxs-lookup"><span data-stu-id="9283c-470">When a formula is evaluated, the model designer first checks for general syntax, and then checks the names of columns and tables that you provide against possible columns and tables in the current context.</span></span> <span data-ttu-id="9283c-471">如果名稱模稜兩可，或是找不到資料行或資料表，公式就會出現錯誤 (發生錯誤的資料格將顯示 #ERROR 字串而非資料值)。</span><span class="sxs-lookup"><span data-stu-id="9283c-471">If the name is ambiguous or if the column or table cannot be found, you will get an error on your formula (an #ERROR string instead of a data value in cells where the error occurs).</span></span> <span data-ttu-id="9283c-472">如需資料表、資料行及其他物件之命名需求的詳細資訊，請參閱[PowerPivot 的 DAX 語法規格](/dax/dax-syntax-reference)中的「命名需求」。</span><span class="sxs-lookup"><span data-stu-id="9283c-472">For more information about naming requirements for tables, columns, and other objects, see "Naming Requirements" in [DAX Syntax Specification for PowerPivot](/dax/dax-syntax-reference).</span></span>  
  
### <a name="table-relationships"></a><span data-ttu-id="9283c-473">資料表關聯性</span><span class="sxs-lookup"><span data-stu-id="9283c-473">Table Relationships</span></span>  
 <span data-ttu-id="9283c-474">藉由建立資料表之間的關聯性，您能夠查閱其他資料表中的資料，並使用相關聯的值來執行複雜的計算。</span><span class="sxs-lookup"><span data-stu-id="9283c-474">By creating relationships between tables, you gain the ability to look up data in another table and use related values to perform complex calculations.</span></span> <span data-ttu-id="9283c-475">例如，您可以使用導出資料行，查閱與目前轉售商相關的所有送貨記錄，然後加總各記錄的送貨成本。</span><span class="sxs-lookup"><span data-stu-id="9283c-475">For example, you can use a calculated column to look up all the shipping records related to the current reseller, and then sum the shipping costs for each.</span></span> <span data-ttu-id="9283c-476">但在許多情況下，關聯性可能沒有必要。</span><span class="sxs-lookup"><span data-stu-id="9283c-476">In many cases, however, a relationship might not be necessary.</span></span> <span data-ttu-id="9283c-477">您可以在公式中使用 LOOKUPVALUE 函數，針對符合 *search_column* 和 *search_value* 參數所指定之準則的資料列傳回 *result_columnName* 中的值。</span><span class="sxs-lookup"><span data-stu-id="9283c-477">You can use the LOOKUPVALUE function in a formula to return the value in *result_columnName* for the row that meets criteria specified in the *search_column* and *search_value* parameters.</span></span>  
  
 <span data-ttu-id="9283c-478">許多 DAX 函數都需要在資料表之間，或是在多個資料表中存在關聯性，才能找到您所參考的資料行，並且傳合理的結果。</span><span class="sxs-lookup"><span data-stu-id="9283c-478">Many DAX functions require that a relationship exist between the tables, or among multiple tables, in order to locate the columns that you have referenced and return results that make sense.</span></span> <span data-ttu-id="9283c-479">其他函數會嘗試識別關聯性。不過，如需達成最佳的結果，您都應該盡可能多加建立關聯性。</span><span class="sxs-lookup"><span data-stu-id="9283c-479">Other functions will attempt to identify the relationship; however, for best results you should always create a relationship where possible.</span></span> <span data-ttu-id="9283c-480">如需詳細資訊，請參閱本主題稍早的 [公式與表格式模型](#bkmk_RelModel) 。</span><span class="sxs-lookup"><span data-stu-id="9283c-480">For more information, see [Formulas and the Tabular Model](#bkmk_RelModel) earlier in this topic.</span></span>  
  
##  <a name="updating-the-results-of-formulas-process"></a><a name="bkmk_RefreshRecalc"></a><span data-ttu-id="9283c-481">更新公式的結果 (進程) </span><span class="sxs-lookup"><span data-stu-id="9283c-481">Updating the Results of Formulas (Process)</span></span>  
 <span data-ttu-id="9283c-482">*「資料處理」* (Data Process) 和 *「重新計算」* (Recalculation) 是兩個不同但相關的作業。</span><span class="sxs-lookup"><span data-stu-id="9283c-482">*Data process* and *recalculation* are two separate but related operations.</span></span> <span data-ttu-id="9283c-483">當您要設計的模型包含複雜公式、大量資料，或包含從外部資料來源取得的資料時，您應該徹底了解這兩個概念。</span><span class="sxs-lookup"><span data-stu-id="9283c-483">You should thoroughly understand these concepts when designing a model that contains complex formulas, large amounts of data, or data that is obtained from external data sources.</span></span>  
  
 <span data-ttu-id="9283c-484">*「處理資料」* (Processing Data) 是以外部資料來源的新資料來更新模型中資料的程序。</span><span class="sxs-lookup"><span data-stu-id="9283c-484">*Processing data* is the process of updating the data in a model with new data from an external data source.</span></span>  
  
 <span data-ttu-id="9283c-485">*「重新計算」* (Recalculation) 是更新公式結果，以反映公式本身的任何變更與基礎資料的變更之程序。</span><span class="sxs-lookup"><span data-stu-id="9283c-485">*Recalculation* is the process of updating the results of formulas to reflect any changes to the formulas themselves and to reflect changes in the underlying data.</span></span> <span data-ttu-id="9283c-486">重新計算可能會以下列方式影響效能：</span><span class="sxs-lookup"><span data-stu-id="9283c-486">Recalculation can affect performance in the following ways:</span></span>  
  
-   <span data-ttu-id="9283c-487">系統會計算導出資料行中的值並將其儲存在模型中。</span><span class="sxs-lookup"><span data-stu-id="9283c-487">The values in a calculated column are computed and stored in the model.</span></span> <span data-ttu-id="9283c-488">若要更新計算結果欄中的值，您必須使用三個處理命令的其中一個來處理模型-處理完整、處理資料或處理重新計算。</span><span class="sxs-lookup"><span data-stu-id="9283c-488">To update the values in the calculated column, you must process the model using one of three processing commands - Process Full, Process Data, or Process Recalc.</span></span> <span data-ttu-id="9283c-489">每當您變更公式時，公式的結果一定會針對整個資料行重新計算。</span><span class="sxs-lookup"><span data-stu-id="9283c-489">The result of the formula must always be recalculated for the entire column, whenever you change the formula.</span></span>  
  
-   <span data-ttu-id="9283c-490">每當使用者將量值加入樞紐分析表中或開啟報表時，就會動態評估量值所導出的值；當使用者修改內容時，量值傳回的值就會變更。</span><span class="sxs-lookup"><span data-stu-id="9283c-490">The values calculated by measures are dynamically evaluated whenever a user adds the measure to a pivot table or open a report; as the user modifies the context, values returned by the measure change.</span></span> <span data-ttu-id="9283c-491">量值的結果永遠會反映記憶體中最新快取。</span><span class="sxs-lookup"><span data-stu-id="9283c-491">The results of the measure always reflect the latest in the in-memory cache.</span></span>  
  
 <span data-ttu-id="9283c-492">除非重新計算的結果傳回不同的值，而讓角色成員可以或不可以查詢資料列，否則處理和重新計算都不會影響資料列篩選公式。</span><span class="sxs-lookup"><span data-stu-id="9283c-492">Processing and recalculation have no effect on row filter formulas unless the result of a recalculation returns a different value, thus making the row queryable or not queryable by role members.</span></span>  
  
 <span data-ttu-id="9283c-493">如需詳細資訊，請參閱 [處理資料 &#40;SSAS 表格式&#41;](../process-data-ssas-tabular.md)。</span><span class="sxs-lookup"><span data-stu-id="9283c-493">For more information, see [Process Data &#40;SSAS Tabular&#41;](../process-data-ssas-tabular.md).</span></span>  
  
##  <a name="troubleshooting-errors-in-formulas"></a><a name="bkmk_troubleshoot"></a><span data-ttu-id="9283c-494">針對公式中的錯誤進行疑難排解</span><span class="sxs-lookup"><span data-stu-id="9283c-494">Troubleshooting Errors in Formulas</span></span>  
 <span data-ttu-id="9283c-495">如果您在定義公式時出現錯誤，該公式可能包含 *「語法錯誤」*(Syntactic Error)、 *「語意錯誤」*(Semantic Error) 或 *「計算錯誤」*(Calculation Error)。</span><span class="sxs-lookup"><span data-stu-id="9283c-495">If you get an error when defining a formula, the formula might contain either a *syntactic error*, *semantic error*, or *calculation error*.</span></span>  
  
 <span data-ttu-id="9283c-496">語法錯誤最容易解決。</span><span class="sxs-lookup"><span data-stu-id="9283c-496">Syntactic errors are the easiest to resolve.</span></span> <span data-ttu-id="9283c-497">它們通常與遺漏括號或逗號有關。</span><span class="sxs-lookup"><span data-stu-id="9283c-497">They typically involve a missing parenthesis or comma.</span></span> <span data-ttu-id="9283c-498">如需個別函數語法的說明，請參閱 [DAX Function Reference](/dax/dax-function-reference)。</span><span class="sxs-lookup"><span data-stu-id="9283c-498">For help with the syntax of individual functions, see [DAX Function Reference](/dax/dax-function-reference).</span></span>  
  
 <span data-ttu-id="9283c-499">語法正確，但值或參考的資料行在公式的內容中沒有意義時，會發生其他類型的錯誤。</span><span class="sxs-lookup"><span data-stu-id="9283c-499">The other type of error occurs when the syntax is correct, but the value or the column referenced does not make sense in the context of the formula.</span></span> <span data-ttu-id="9283c-500">這種語意和計算錯誤可能是由下列任何問題所造成：</span><span class="sxs-lookup"><span data-stu-id="9283c-500">Such semantic and calculation errors might be caused by any of the following problems:</span></span>  
  
-   <span data-ttu-id="9283c-501">公式參考不存在的資料行、資料表或函數。</span><span class="sxs-lookup"><span data-stu-id="9283c-501">The formula refers to a non-existing column, table, or function.</span></span>  
  
-   <span data-ttu-id="9283c-502">公式似乎正確，但是資料引擎擷取到它發現類型不符並引發錯誤的資料。</span><span class="sxs-lookup"><span data-stu-id="9283c-502">The formula appears to be correct, but when the data engine fetches the data it finds a type mismatch, and raises an error.</span></span>  
  
-   <span data-ttu-id="9283c-503">公式傳遞給函數的參數個數或類型不正確。</span><span class="sxs-lookup"><span data-stu-id="9283c-503">The formula passes an incorrect number or type of parameters to a function.</span></span>  
  
-   <span data-ttu-id="9283c-504">此公式參考有錯誤的另一個資料行，因此它的值無效。</span><span class="sxs-lookup"><span data-stu-id="9283c-504">The formula refers to a different column that has an error, and therefore its values are invalid.</span></span>  
  
-   <span data-ttu-id="9283c-505">此公式會參考尚未處理的資料行，這表示它有中繼資料，但沒有用於計算的實際資料。</span><span class="sxs-lookup"><span data-stu-id="9283c-505">The formula refers to a column that has not been processed, meaning it has metadata but no actual data to use for calculations.</span></span>  
  
 <span data-ttu-id="9283c-506">在前四種情況下，DAX 會針對包含無效公式的整個資料行加上旗標。</span><span class="sxs-lookup"><span data-stu-id="9283c-506">In the first four cases, DAX flags the entire column that contains the invalid formula.</span></span> <span data-ttu-id="9283c-507">在最後一種情況下，DAX 會使資料行呈現灰色，表示該資料行處於尚未處理的狀態。</span><span class="sxs-lookup"><span data-stu-id="9283c-507">In the last case, DAX grays out the column to indicate that the column is in an unprocessed state.</span></span>  
  
##  <a name="additional-resources"></a><a name="bkmk_addional_resources"></a> <span data-ttu-id="9283c-508">其他資源</span><span class="sxs-lookup"><span data-stu-id="9283c-508">Additional Resources</span></span>  
 <span data-ttu-id="9283c-509">[表格式模型化 &#40;Adventure Works 教學課程&#41;](../tabular-modeling-adventure-works-tutorial.md) 對於如何建立在導出資料行、量值和資料列篩選中包含許多計算的表格式模型，提供逐步指示。</span><span class="sxs-lookup"><span data-stu-id="9283c-509">The [Tabular Modeling &#40;Adventure Works Tutorial&#41;](../tabular-modeling-adventure-works-tutorial.md) provides step-by-step instructions on how to create a tabular model that includes many calculations in calculated columns, measures, and row filters.</span></span> <span data-ttu-id="9283c-510">對於大部分的公式，則會提供該公式用途的描述。</span><span class="sxs-lookup"><span data-stu-id="9283c-510">For most formulas, a description about what the formula is meant to do is provided.</span></span>  
  
 <span data-ttu-id="9283c-511">[Analysis Services 和 Powerpivot 小組的 Blog](https://go.microsoft.com/fwlink/?LinkID=220949&clcid=0x409)會提供和 powerpivot 的相關資訊、提示、新聞和公告 [!INCLUDE[ssASCurrent](../../includes/ssascurrent-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="9283c-511">The [Analysis Services and PowerPivot Team Blog](https://go.microsoft.com/fwlink/?LinkID=220949&clcid=0x409) provides information, tips, news and announcements about [!INCLUDE[ssASCurrent](../../includes/ssascurrent-md.md)] and PowerPivot.</span></span>  
  
 <span data-ttu-id="9283c-512">[DAX 資源中心](https://go.microsoft.com/fwlink/?LinkID=220966&clcid=0x409) 會提供關於 DAX 的內外部資訊，包括由主要的 Business Intelligence 專業人員所提交的多個 DAX 解決方案。</span><span class="sxs-lookup"><span data-stu-id="9283c-512">The [DAX Resource Center](https://go.microsoft.com/fwlink/?LinkID=220966&clcid=0x409) provides both internal and external information on DAX, including numerous DAX solutions submitted by leading Business Intelligence professionals.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9283c-513">另請參閱</span><span class="sxs-lookup"><span data-stu-id="9283c-513">See Also</span></span>  
 <span data-ttu-id="9283c-514">[&#40;DAX&#41; 參考的資料分析運算式](/dax/data-analysis-expressions-dax-reference) </span><span class="sxs-lookup"><span data-stu-id="9283c-514">[Data Analysis Expressions &#40;DAX&#41; Reference](/dax/data-analysis-expressions-dax-reference) </span></span>  
 <span data-ttu-id="9283c-515">[&#40;SSAS 表格式&#41;的量值](measures-ssas-tabular.md) </span><span class="sxs-lookup"><span data-stu-id="9283c-515">[Measures &#40;SSAS Tabular&#41;](measures-ssas-tabular.md) </span></span>  
 <span data-ttu-id="9283c-516">[&#40;SSAS 表格式&#41;的計算結果欄](ssas-calculated-columns.md) </span><span class="sxs-lookup"><span data-stu-id="9283c-516">[Calculated Columns &#40;SSAS Tabular&#41;](ssas-calculated-columns.md) </span></span>  
 <span data-ttu-id="9283c-517">[&#40;SSAS 表格式&#41;的角色](roles-ssas-tabular.md) </span><span class="sxs-lookup"><span data-stu-id="9283c-517">[Roles &#40;SSAS Tabular&#41;](roles-ssas-tabular.md) </span></span>  
 <span data-ttu-id="9283c-518">[&#40;SSAS 表格式&#41;的 Kpi](kpis-ssas-tabular.md) </span><span class="sxs-lookup"><span data-stu-id="9283c-518">[KPIs &#40;SSAS Tabular&#41;](kpis-ssas-tabular.md) </span></span>  
 [<span data-ttu-id="9283c-519">支援的資料來源 &#40;SSAS 表格式&#41;</span><span class="sxs-lookup"><span data-stu-id="9283c-519">Data Sources Supported &#40;SSAS Tabular&#41;</span></span>](data-sources-supported-ssas-tabular.md)  
  
  
