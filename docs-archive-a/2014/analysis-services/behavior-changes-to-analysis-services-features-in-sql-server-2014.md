---
title: SQL Server 2014 中 Analysis Services 功能的行為變更 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 92ebd5cb-afb6-4b62-968f-39f5574a452b
author: minewiskan
ms.author: owend
ms.openlocfilehash: 4fa6e5f28202c80ed8b80e16a67b0e77cf4d10fd
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87593158"
---
# <a name="behavior-changes-to-analysis-services-features-in-sql-server-2014"></a><span data-ttu-id="81fd4-102">SQL Server 2014 中 Analysis Services 功能的行為變更</span><span class="sxs-lookup"><span data-stu-id="81fd4-102">Behavior Changes to Analysis Services Features in SQL Server 2014</span></span>
  <span data-ttu-id="81fd4-103">本主題描述 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 中多維度、表格式、資料採礦及 [!INCLUDE[ssGeminiShort](../includes/ssgeminishort-md.md)] 部署的行為變更。</span><span class="sxs-lookup"><span data-stu-id="81fd4-103">This topic describes behavior changes in [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] for multidimensional, tabular, data mining, and [!INCLUDE[ssGeminiShort](../includes/ssgeminishort-md.md)] deployments.</span></span> <span data-ttu-id="81fd4-104">行為變更會影響功能在目前版本中，與舊版 SQL Server 相較之下的運作或互動方式。</span><span class="sxs-lookup"><span data-stu-id="81fd4-104">Behavior changes affect how features work or interact in the current version as compared to earlier versions of SQL Server.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="81fd4-105">相反地，中斷變更則防止已與 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 整合的資料模型或應用程式執行。</span><span class="sxs-lookup"><span data-stu-id="81fd4-105">In contrast, a breaking change is one that prevents a data model or application integrated with [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] from running.</span></span> <span data-ttu-id="81fd4-106">如需詳細資訊，請參閱＜ [Breaking Changes to Analysis Services Features in SQL Server 2014](breaking-changes-to-analysis-services-features-in-sql-server-2014.md)＞。</span><span class="sxs-lookup"><span data-stu-id="81fd4-106">To learn more, see [Breaking Changes to Analysis Services Features in SQL Server 2014](breaking-changes-to-analysis-services-features-in-sql-server-2014.md).</span></span>  
  
 <span data-ttu-id="81fd4-107">本主題內容：</span><span class="sxs-lookup"><span data-stu-id="81fd4-107">In this Topic:</span></span>  
  
-   [<span data-ttu-id="81fd4-108">SQL Server 2014 中的行為變更</span><span class="sxs-lookup"><span data-stu-id="81fd4-108">Behavior Changes in SQL Server 2014</span></span>](#bkmk_sql2014)  
  
-   [<span data-ttu-id="81fd4-109">SQL Server 2012 SP1 中的行為變更</span><span class="sxs-lookup"><span data-stu-id="81fd4-109">Behavior Changes in SQL Server 2012 SP1</span></span>](#bkmk_sql2012sp1)  
  
-   [<span data-ttu-id="81fd4-110">SQL Server 2012 中的行為變更</span><span class="sxs-lookup"><span data-stu-id="81fd4-110">Behavior Changes in SQL Server 2012</span></span>](#bkmk_sql2012)  
  
##  <a name="behavior-changes-in-sssql14"></a><a name="bkmk_sql2014"></a><span data-ttu-id="81fd4-111">中的行為變更[!INCLUDE[ssSQL14](../includes/sssql14-md.md)]</span><span class="sxs-lookup"><span data-stu-id="81fd4-111">Behavior Changes in [!INCLUDE[ssSQL14](../includes/sssql14-md.md)]</span></span>  
 <span data-ttu-id="81fd4-112">此版本中的多維度、表格式、資料採礦或 [!INCLUDE[ssGeminiShort](../includes/ssgeminishort-md.md)] 功能皆未宣告任何新的行為變更。</span><span class="sxs-lookup"><span data-stu-id="81fd4-112">There are no new behavior changes announced for tabular, multidimensional, data mining, or [!INCLUDE[ssGeminiShort](../includes/ssgeminishort-md.md)] features in this release.</span></span>  <span data-ttu-id="81fd4-113">不過，因為  [!INCLUDE[ssASCurrent](../includes/ssascurrent-md.md)] 很類似 [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] 和 [!INCLUDE[ssSQL11SP1](../includes/sssql11sp1-md.md)] 版本，所以在此為您提供這兩個舊版的行為變更，以便您從 [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)]升級。</span><span class="sxs-lookup"><span data-stu-id="81fd4-113">However, because  [!INCLUDE[ssASCurrent](../includes/ssascurrent-md.md)] is so similar to the [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] and [!INCLUDE[ssSQL11SP1](../includes/sssql11sp1-md.md)] versions, behavior changes from both prior releases are provided here as a convenience in case you're upgrading from [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span></span>  
  
##  <a name="behavior-changes-in-sssql11sp1"></a><a name="bkmk_sql2012sp1"></a><span data-ttu-id="81fd4-114">中的行為變更[!INCLUDE[ssSQL11SP1](../includes/sssql11sp1-md.md)]</span><span class="sxs-lookup"><span data-stu-id="81fd4-114">Behavior Changes in [!INCLUDE[ssSQL11SP1](../includes/sssql11sp1-md.md)]</span></span>  
 <span data-ttu-id="81fd4-115">本章節記載針對 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 中 [!INCLUDE[ssSQL11SP1](../includes/sssql11sp1-md.md)]功能所報告的行為變更。</span><span class="sxs-lookup"><span data-stu-id="81fd4-115">This section documents the behavior changes reported for [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] features in [!INCLUDE[ssSQL11SP1](../includes/sssql11sp1-md.md)].</span></span> <span data-ttu-id="81fd4-116">這些變更也適用於 [!INCLUDE[ssSQL14](../includes/sssql14-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="81fd4-116">These changes also apply to [!INCLUDE[ssSQL14](../includes/sssql14-md.md)].</span></span>  
  
|<span data-ttu-id="81fd4-117">問題</span><span class="sxs-lookup"><span data-stu-id="81fd4-117">Issue</span></span>|<span data-ttu-id="81fd4-118">描述</span><span class="sxs-lookup"><span data-stu-id="81fd4-118">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="81fd4-119">在 SQL Server 2012 SP1 PowerPivot for SharePoint 2013 中使用 SQL Server 2008 R2 PowerPivot 活頁簿時，這些活頁簿不會以無訊息方式升級並重新整理模型。</span><span class="sxs-lookup"><span data-stu-id="81fd4-119">SQL Server 2008 R2 PowerPivot workbooks will not silently upgrade and refresh the models when they are used in SQL Server 2012 SP1 PowerPivot for SharePoint 2013.</span></span> <span data-ttu-id="81fd4-120">因此，排程的資料重新整理不會針對 SQL Server 2008 R2 PowerPivot 活頁簿運作。</span><span class="sxs-lookup"><span data-stu-id="81fd4-120">Therefore Scheduled data refreshes will not work for SQL Server 2008 R2 PowerPivot workbooks.</span></span>|<span data-ttu-id="81fd4-121">2008 R2 活頁簿將在 [!INCLUDE[ssGeminiShortvnext](../includes/ssgeminishortvnext-md.md)]中開啟，但是排程的重新整理不會運作。</span><span class="sxs-lookup"><span data-stu-id="81fd4-121">The 2008 R2 workbooks will open in [!INCLUDE[ssGeminiShortvnext](../includes/ssgeminishortvnext-md.md)], however scheduled refreshes will not work.</span></span> <span data-ttu-id="81fd4-122">如果您檢閱重新整理記錄，將會看到類似以下的錯誤訊息：</span><span class="sxs-lookup"><span data-stu-id="81fd4-122">If you review the refresh history you will see an error message similar to the following:</span></span><br /> <span data-ttu-id="81fd4-123">「活頁簿包含不支援的 PowerPivot 模型。</span><span class="sxs-lookup"><span data-stu-id="81fd4-123">"The workbook contains an unsupported PowerPivot model.</span></span> <span data-ttu-id="81fd4-124">活頁簿中的 PowerPivot 模型是採用 SQL Server 2008 R2 PowerPivot for Excel 2010 格式。</span><span class="sxs-lookup"><span data-stu-id="81fd4-124">The PowerPivot model in the workbook is in the SQL Server 2008 R2 PowerPivot for Excel 2010 format.</span></span> <span data-ttu-id="81fd4-125">支援的 PowerPivot 模型如下:</span><span class="sxs-lookup"><span data-stu-id="81fd4-125">Supported PowerPivot models are the following:</span></span> <br /><span data-ttu-id="81fd4-126">SQL Server 2012 PowerPivot for Excel 2010</span><span class="sxs-lookup"><span data-stu-id="81fd4-126">SQL Server 2012 PowerPivot for Excel 2010</span></span><br /><span data-ttu-id="81fd4-127">SQL Server 2012 PowerPivot for Excel 2013 "</span><span class="sxs-lookup"><span data-stu-id="81fd4-127">SQL Server 2012 PowerPivot for Excel 2013"</span></span><br /><br /> <span data-ttu-id="81fd4-128">**如何升級活頁簿** ：在您將活頁簿升級為 2012 活頁簿之前，排程的重新整理無法運作。</span><span class="sxs-lookup"><span data-stu-id="81fd4-128">**How to upgrade a workbook:** The scheduled refreshes will not work until you upgrade the workbook to a 2012 workbook.</span></span> <span data-ttu-id="81fd4-129">若要升級活頁簿及它所包含的模型，請完成下列其中一項作業：</span><span class="sxs-lookup"><span data-stu-id="81fd4-129">To upgrade the workbook and model it contains, complete one of the following:</span></span><br /><br /> <span data-ttu-id="81fd4-130">在已安裝 SQL Server 2012 PowerPivot for Excel 增益集的 Microsoft Excel 2010 中下載並開啟活頁簿。</span><span class="sxs-lookup"><span data-stu-id="81fd4-130">Download and open the workbook in Microsoft Excel 2010 with the SQL Server 2012 PowerPivot for Excel add-in installed.</span></span> <span data-ttu-id="81fd4-131">然後，儲存活頁簿並重新發行至 SharePoint 伺服器。</span><span class="sxs-lookup"><span data-stu-id="81fd4-131">Then save the workbook and republish it to the SharePoint server.</span></span><br /><br /> <span data-ttu-id="81fd4-132">在 Microsoft Excel 2013 中下載並開啟活頁簿。</span><span class="sxs-lookup"><span data-stu-id="81fd4-132">Download and open the workbook in Microsoft Excel 2013.</span></span> <span data-ttu-id="81fd4-133">然後，儲存活頁簿並重新發行至 SharePoint 伺服器。</span><span class="sxs-lookup"><span data-stu-id="81fd4-133">Then save the workbook and republish it to the SharePoint server.</span></span><br /><br /> <br /><br /> <span data-ttu-id="81fd4-134">如需活頁簿升級的詳細資訊，請參閱[&#40;SharePoint 2013&#41;升級活頁簿和排程的資料](instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md)重新整理。</span><span class="sxs-lookup"><span data-stu-id="81fd4-134">For more information on workbook upgrade, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>|  
|<span data-ttu-id="81fd4-135">DAX [ALL Function](/dax/all-function-dax)中的行為變更。</span><span class="sxs-lookup"><span data-stu-id="81fd4-135">Behavior change in DAX [ALL Function](/dax/all-function-dax).</span></span>|<span data-ttu-id="81fd4-136">在 [!INCLUDE[ssSQL11SP1](../includes/sssql11sp1-md.md)]之前，如果您將標示的 [日期] 資料行指定為日期資料表以供時間智慧使用，則該 [日期] 資料行會傳遞為 ALL 函數的引數，接著會傳遞為 CALCULATE 函數的篩選條件，並且資料表中所有資料行的所有篩選條件都會被忽略，不論日期資料行上是否使用任何交叉分析篩選器。</span><span class="sxs-lookup"><span data-stu-id="81fd4-136">Prior to [!INCLUDE[ssSQL11SP1](../includes/sssql11sp1-md.md)], if you specify a [Date] column in Mark as Date Table, for use in time-intelligence, and that [Date] column is passed as an argument to the ALL function, in-turn, passed as a filter to a CALCULATE function, all filters for all columns in the table are ignored, regardless of any slicer on the date column.</span></span><br /><br /> <span data-ttu-id="81fd4-137">例如</span><span class="sxs-lookup"><span data-stu-id="81fd4-137">For example,</span></span><br /><br /> `= CALCULATE (<expression>, ALL (DateTable[Date]))`<br /><br /> <span data-ttu-id="81fd4-138">在 [!INCLUDE[ssSQL11SP1](../includes/sssql11sp1-md.md)]之前，日期資料表的所有資料行都會忽略所有篩選條件，不論 [日期] 資料行是否當做 ALL 的引數傳遞。</span><span class="sxs-lookup"><span data-stu-id="81fd4-138">Prior to [!INCLUDE[ssSQL11SP1](../includes/sssql11sp1-md.md)], all filters are ignored for all columns of DateTable, regardless of the [Date] column passed as an argument to ALL.</span></span><br /><br /> <span data-ttu-id="81fd4-139">在 [!INCLUDE[ssSQL11SP1](../includes/sssql11sp1-md.md)] 和 Excel 2013 的 PowerPivot 中，此行為只會忽略當做 ALL 的引數傳遞之指定資料行的篩選條件。</span><span class="sxs-lookup"><span data-stu-id="81fd4-139">In [!INCLUDE[ssSQL11SP1](../includes/sssql11sp1-md.md)] and in PowerPivot in Excel 2013, the behavior will ignore filters only for the specified column passed as an argument to ALL.</span></span><br /><br /> <span data-ttu-id="81fd4-140">若要避開新的行為，事實上是忽略當做整個資料表之篩選條件的所有資料行，您可以從引數中排除 [日期] 資料行，例如，</span><span class="sxs-lookup"><span data-stu-id="81fd4-140">To work around the new behavior, in effect ignore all columns as a filter for the entire table, you can exclude [Date] column from the argument, for example,</span></span><br /><br /> `=CALCULATE (<expression>, ALL(DateTable))`<br /><br /> <span data-ttu-id="81fd4-141">這樣會產生與之前 [!INCLUDE[ssSQL11SP1](../includes/sssql11sp1-md.md)]相同的行為結果。</span><span class="sxs-lookup"><span data-stu-id="81fd4-141">This will yield the same result as the behavior prior to [!INCLUDE[ssSQL11SP1](../includes/sssql11sp1-md.md)].</span></span>|  
  
##  <a name="behavior-changes-in-sssql11"></a><a name="bkmk_sql2012"></a><span data-ttu-id="81fd4-142">中的行為變更[!INCLUDE[ssSQL11](../includes/sssql11-md.md)]</span><span class="sxs-lookup"><span data-stu-id="81fd4-142">Behavior Changes in [!INCLUDE[ssSQL11](../includes/sssql11-md.md)]</span></span>  
 <span data-ttu-id="81fd4-143">本章節記載針對 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 中 [!INCLUDE[ssSQL11](../includes/sssql11-md.md)]功能所報告的重大變更。</span><span class="sxs-lookup"><span data-stu-id="81fd4-143">This section documents the behavioral changes reported for [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] features in [!INCLUDE[ssSQL11](../includes/sssql11-md.md)].</span></span> <span data-ttu-id="81fd4-144">這些變更也適用於 [!INCLUDE[ssSQL14](../includes/sssql14-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="81fd4-144">These changes also apply to [!INCLUDE[ssSQL14](../includes/sssql14-md.md)].</span></span>  
  
### <a name="analysis-services-multidimensional-mode"></a><span data-ttu-id="81fd4-145">Analysis Services 多維度模式</span><span class="sxs-lookup"><span data-stu-id="81fd4-145">Analysis Services, Multidimensional Mode</span></span>  
  
#### <a name="nullprocessing-option-set-to-preserve-is-no-longer-supported-for-distinct-count-measures"></a><span data-ttu-id="81fd4-146">相異計數量值不再支援將 NullProcessing 選項設為 Preserve</span><span class="sxs-lookup"><span data-stu-id="81fd4-146">NullProcessing option set to Preserve is no longer supported for distinct count measures</span></span>  
 <span data-ttu-id="81fd4-147">在之前 [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] ，您可以將[NullProcessing 元素 &#40;ASSL&#41;](https://docs.microsoft.com/bi-reference/assl/properties/nullprocessing-element-assl)設定為，以 `Preserve` 進行相異計數量詞。</span><span class="sxs-lookup"><span data-stu-id="81fd4-147">Prior to [!INCLUDE[ssSQL11](../includes/sssql11-md.md)], it was possible to set [NullProcessing Element &#40;ASSL&#41;](https://docs.microsoft.com/bi-reference/assl/properties/nullprocessing-element-assl) to `Preserve` for distinct count measures.</span></span>  <span data-ttu-id="81fd4-148">不幸的是，這種做法產生的結果時常無效，有時甚至會損毀正在處理的作業。</span><span class="sxs-lookup"><span data-stu-id="81fd4-148">Unfortunately, this practice often produced invalid results and sometimes even crashed the processing job.</span></span> <span data-ttu-id="81fd4-149">因此 [!INCLUDE[ssSQL11](../includes/sssql11-md.md)]將不再提供這項設定。</span><span class="sxs-lookup"><span data-stu-id="81fd4-149">As a result, this configuration is no longer valid in [!INCLUDE[ssSQL11](../includes/sssql11-md.md)].</span></span> <span data-ttu-id="81fd4-150">嘗試使用此設定將導致發生以下驗證錯誤：「中繼資料管理員發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="81fd4-150">Attempting to use it will cause the following validation error to occur: "Errors in the metadata manager.</span></span> <span data-ttu-id="81fd4-151">Preserve 不是 \<measurename> 相異計數量詞的有效 NullProcessing 值。」</span><span class="sxs-lookup"><span data-stu-id="81fd4-151">Preserve is not a valid NullProcessing value for the \<measurename> distinct count measure."</span></span>  
  
#### <a name="cube-browser-in-management-studio-and-cube-designer-has-been-removed"></a><span data-ttu-id="81fd4-152">已經移除 Management Studio 和 Cube 設計師中的 Cube 瀏覽器</span><span class="sxs-lookup"><span data-stu-id="81fd4-152">Cube browser in Management Studio and Cube Designer has been removed</span></span>  
 <span data-ttu-id="81fd4-153">已經從產品中移除 Cube 瀏覽器控制項，此控制項可讓您將欄位拖放到 Management Studio 或 Cube 設計師中的樞紐分析表結構上。</span><span class="sxs-lookup"><span data-stu-id="81fd4-153">The cube browser control that let you drag and drop fields onto a PivotTable structure in Management Studio or in Cube Designer has been removed from the product.</span></span> <span data-ttu-id="81fd4-154">此控制項為 Office Web 控制項 (OWC) 元件。</span><span class="sxs-lookup"><span data-stu-id="81fd4-154">The control was an Office Web Control (OWC) component.</span></span> <span data-ttu-id="81fd4-155">OWC 已被 Office 取代，無法再使用。</span><span class="sxs-lookup"><span data-stu-id="81fd4-155">OWC was deprecated by Office and is no longer available.</span></span>  
  
### <a name="powerpivot-for-sharepoint"></a><span data-ttu-id="81fd4-156">PowerPivot for SharePoint</span><span class="sxs-lookup"><span data-stu-id="81fd4-156">PowerPivot for SharePoint</span></span>  
  
#### <a name="higher-permission-requirements-for-using-a-powerpivot-workbook-as-an-external-data-source"></a><span data-ttu-id="81fd4-157">使用做為外部資料來源的 PowerPivot 活頁簿需要更高的權限</span><span class="sxs-lookup"><span data-stu-id="81fd4-157">Higher permission requirements for using a PowerPivot workbook as an external data source</span></span>  
 <span data-ttu-id="81fd4-158">Excel 活頁簿可以轉譯相同活頁簿中內嵌的 PowerPivot 資料，或是外部活頁簿中的 PowerPivot 資料。</span><span class="sxs-lookup"><span data-stu-id="81fd4-158">An Excel workbook can render PowerPivot data that is embedded within the same workbook or in an external workbook.</span></span> <span data-ttu-id="81fd4-159">在舊版中，無論是內嵌的還是外部的 PowerPivot 資料，權限要求都相同。</span><span class="sxs-lookup"><span data-stu-id="81fd4-159">In the previous release, permission requirements were the same regardless of whether the PowerPivot data was embedded or external.</span></span> <span data-ttu-id="81fd4-160">如果您擁有 PowerPivot 活頁簿的 **[僅檢視]** 權限，就能夠同時針對內嵌和外部連接，完整存取活頁簿中的所有 PowerPivot 資料。</span><span class="sxs-lookup"><span data-stu-id="81fd4-160">If you had **View Only** permissions on a PowerPivot workbook, you could get full access to all of the PowerPivot data in the workbook for both embedded and external connections.</span></span>  
  
 <span data-ttu-id="81fd4-161">在此版本中，從外部檔案轉譯 PowerPivot 資料之 Excel 活頁簿的權限要求已變更。</span><span class="sxs-lookup"><span data-stu-id="81fd4-161">In this release, permission requirements have changed for Excel workbooks that render PowerPivot data from an external file.</span></span> <span data-ttu-id="81fd4-162">在此版本中，您必須擁有 **[讀取]** 權限 (更具體來說，就是 **[開啟項目]** 權限)，才能從用戶端應用程式連接到外部的 PowerPivot 活頁簿。</span><span class="sxs-lookup"><span data-stu-id="81fd4-162">In this release, you must have **Read** permissions (or more specifically, the **Open Items** permission) to connect to an external PowerPivot workbook from a client application.</span></span> <span data-ttu-id="81fd4-163">額外的權限會指定使用者具備下載權限才能檢視活頁簿中內嵌的來源資料。</span><span class="sxs-lookup"><span data-stu-id="81fd4-163">The additional permissions specify that a user has download rights to view the source data embedded in the workbook.</span></span> <span data-ttu-id="81fd4-164">其他權限會反映模型資料完全可用於所連結的用戶端應用程式或活頁簿，導致在權限要求與實際資料連接行為之間獲得更好的協調。</span><span class="sxs-lookup"><span data-stu-id="81fd4-164">The additional permissions reflect the fact that model data is wholly available to the client application or workbook that links to it, resulting in a better alignment between permission requirements and the actual data connection behavior.</span></span>  
  
 <span data-ttu-id="81fd4-165">若要繼續使用 PowerPivot 活頁簿做為外部資料來源，您必須為連接到外部 PowerPivot 資料的使用者建立 SharePoint 權限。</span><span class="sxs-lookup"><span data-stu-id="81fd4-165">To continue using a PowerPivot workbook as an external data source, you must increase SharePoint permissions for users who connect to external PowerPivot data.</span></span> <span data-ttu-id="81fd4-166">在您變更許可權之前，如果使用者嘗試在資料來源連接中存取 PowerPivot 活頁簿，將會收到下列錯誤：「PowerPivot Web 服務傳回錯誤 (拒絕存取。</span><span class="sxs-lookup"><span data-stu-id="81fd4-166">Until you change the permissions, users will get the following error if they try to access PowerPivot workbooks in a data source connection: "PowerPivot Web service returned an error (Access denied.</span></span> <span data-ttu-id="81fd4-167">您要求的檔不存在，或您沒有開啟檔案的許可權。 ) 」</span><span class="sxs-lookup"><span data-stu-id="81fd4-167">The document you requested does not exist or you do not have permission to open the file.)"</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="81fd4-168">以下步驟說明如何在文件庫層級中斷權限繼承，並且將使用者對此文件庫中特定文件的權限從 **[僅檢視]** 提升為 **[讀取]** 。</span><span class="sxs-lookup"><span data-stu-id="81fd4-168">The following steps instruct you to break permission inheritance at the library level and increase user permissions from **View Only** to **Read** for specific documents in this library.</span></span> <span data-ttu-id="81fd4-169">在繼續進行之前，務必仔細檢越現有權限和文件，並且確認這些步驟適合您的網站。</span><span class="sxs-lookup"><span data-stu-id="81fd4-169">Before you proceed, carefully review existing permissions and documents and verify that these steps are appropriate for your site.</span></span>  
>   
>  <span data-ttu-id="81fd4-170">或者，您可以在文件庫中建立資料夾，將所有受影響的文件移到該資料夾中，然後在資料夾上設定唯一的權限。</span><span class="sxs-lookup"><span data-stu-id="81fd4-170">Alternatively, you can create a folder in the library, move all affected documents to that folder, and set unique permissions on the folder.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="81fd4-171">如果您的活頁簿存放在 PowerPivot 圖庫中，中斷活頁簿的權限繼承將會使活頁簿的縮圖影像無法產生 (如果已設定活頁簿進行資料重新整理的話)。</span><span class="sxs-lookup"><span data-stu-id="81fd4-171">If your workbooks are stored in PowerPivot Gallery, breaking permission inheritance on a workbook will disrupt thumbnail image generation for that workbook if it is configured for data refresh.</span></span> <span data-ttu-id="81fd4-172">若要同時允許存取圖庫中的活頁簿和預覽影像，請考慮在文件庫層級將文件庫中所有文件的 **[讀取]** 權限授與特定使用者。</span><span class="sxs-lookup"><span data-stu-id="81fd4-172">To simultaneously allow access to both workbooks and preview images in the gallery, consider granting to specific users **Read** permissions at the library level, for all documents in the library.</span></span>  
  
 <span data-ttu-id="81fd4-173">您必須是網站擁有者，才能變更權限。</span><span class="sxs-lookup"><span data-stu-id="81fd4-173">You must be a site owner to change permissions.</span></span>  
  
 <span data-ttu-id="81fd4-174">**如何將個別活頁簿的權限提升到「讀取」權限**</span><span class="sxs-lookup"><span data-stu-id="81fd4-174">**How to increase permissions to Read permission level for individual workbooks**</span></span>  
  
1.  <span data-ttu-id="81fd4-175">按一下向下箭號，開啟個別文件的功能表。</span><span class="sxs-lookup"><span data-stu-id="81fd4-175">Click the down arrow to open the menu for an individual document.</span></span>  
  
2.  <span data-ttu-id="81fd4-176">按一下 **[管理權限]**。</span><span class="sxs-lookup"><span data-stu-id="81fd4-176">Click **Manage Permissions**.</span></span>  
  
3.  <span data-ttu-id="81fd4-177">根據預設，文件庫會繼承權限。</span><span class="sxs-lookup"><span data-stu-id="81fd4-177">By default, a library inherits permissions.</span></span> <span data-ttu-id="81fd4-178">若要變更此文件庫中個別活頁簿的權限，按一下 **[停止繼承權限]**。</span><span class="sxs-lookup"><span data-stu-id="81fd4-178">To change the permissions of individual workbooks in this library, click **Stop Inheriting Permissions**.</span></span>  
  
4.  <span data-ttu-id="81fd4-179">依使用者或群組名稱，選取需要 PowerPivot 活頁簿其他權限的核取方塊。</span><span class="sxs-lookup"><span data-stu-id="81fd4-179">Select the checkbox by user or group names that require additional permissions on PowerPivot workbooks.</span></span> <span data-ttu-id="81fd4-180">其他權限將允許這些使用者連結到內嵌的 PowerPivot 資料，並使用該資料做為其他文件中的外部資料來源。</span><span class="sxs-lookup"><span data-stu-id="81fd4-180">Additional permissions will allow these users to link to the embedded PowerPivot data and use that data as an external data source in other documents.</span></span>  
  
5.  <span data-ttu-id="81fd4-181">按一下 **[編輯使用者權限]**。</span><span class="sxs-lookup"><span data-stu-id="81fd4-181">Click **Edit User Permissions**.</span></span>  
  
6.  <span data-ttu-id="81fd4-182">選擇 **[讀取]** 權限，然後按一下 **[確定]**。</span><span class="sxs-lookup"><span data-stu-id="81fd4-182">Choose **Read** permissions, and then click **OK**.</span></span>  
  
#### <a name="powerpivot-gallery-new-rules-for-snapshot-generation-for-some-powerpivot-workbooks"></a><span data-ttu-id="81fd4-183">PowerPivot 圖庫：針對部分 PowerPivot 活頁簿產生快照的新規則</span><span class="sxs-lookup"><span data-stu-id="81fd4-183">PowerPivot Gallery: New rules for snapshot generation for some PowerPivot workbooks</span></span>  
 <span data-ttu-id="81fd4-184">此版本導入了在 PowerPivot 圖庫中產生快照影像的新需求，以避免可能洩漏資訊來源 (也就是從您沒有檢視權限的資料來源顯示資料的快照)。</span><span class="sxs-lookup"><span data-stu-id="81fd4-184">This release introduces new requirements for generating snapshot images in PowerPivot Gallery, eliminating a potential source of information disclosure (namely, showing a snapshot of data from a data source that you do not have permission to view).</span></span> <span data-ttu-id="81fd4-185">這些需求僅適用於每次檢視活頁簿時連接到外部資料來源的 PowerPivot 活頁簿。</span><span class="sxs-lookup"><span data-stu-id="81fd4-185">These requirements apply only to PowerPivot workbooks that connect to external data sources each time you view the workbook.</span></span> <span data-ttu-id="81fd4-186">如果您只有使用視覺化內嵌 PowerPivot 資料的活頁簿，就不會看見在 PowerPivot 圖庫中產生快照之方式的改變。</span><span class="sxs-lookup"><span data-stu-id="81fd4-186">If you only use workbooks that visualize embedded PowerPivot data, you will see no change in how snapshots are generated in PowerPivot Gallery.</span></span>  
  
 <span data-ttu-id="81fd4-187">針對每次開啟都會重新整理其資料的活頁簿，產生快照的新需求如下：</span><span class="sxs-lookup"><span data-stu-id="81fd4-187">For a workbook that refreshes its data each time it is opened, the new requirements for snapshot generation are as follows:</span></span>  
  
-   <span data-ttu-id="81fd4-188">其他活頁簿或報表用來做為外部資料來源的 PowerPivot 活頁簿，必須與取用資料的活頁簿位於相同的文件庫中。</span><span class="sxs-lookup"><span data-stu-id="81fd4-188">PowerPivot workbooks that are used as external data sources by other workbooks or reports must be in the same library as the workbooks that consume the data.</span></span> <span data-ttu-id="81fd4-189">例如，如果您有提供資料給 sales-report.xlsx 的 sales-data.xlsx，則這兩個活頁簿必須都在圖庫中，快照影像才會出現。</span><span class="sxs-lookup"><span data-stu-id="81fd4-189">For example, if you have sales-data.xlsx that provides data to sales-report.xlsx, both workbooks must be in the gallery in order for snapshot images to appear.</span></span>  
  
-   <span data-ttu-id="81fd4-190">搭配使用的活頁簿必須從共同的父系繼承權限 (也就是 PowerPivot 圖庫)。</span><span class="sxs-lookup"><span data-stu-id="81fd4-190">Workbooks that are used together must inherit permissions from a common parent (that is, the PowerPivot Gallery).</span></span> <span data-ttu-id="81fd4-191">在上述範例中，sales-data.xlsx 和 sales-report.xlsx 都必須從 PowerPivot 圖庫繼承。</span><span class="sxs-lookup"><span data-stu-id="81fd4-191">In our example, both sales-data.xlsx and sales-report.xlsx must inherit from PowerPivot Gallery.</span></span>  
  
 <span data-ttu-id="81fd4-192">如果活頁簿未能符合上述任何準則，則會出現下列鎖定圖示，而不會顯示您要的縮圖影像：</span><span class="sxs-lookup"><span data-stu-id="81fd4-192">If a workbook fails to meet any of the above criteria, the following locked icon will appear instead of the thumbnail image you expect:</span></span>  
  
 <span data-ttu-id="81fd4-193">![GMNI_PowerPivotGalleryIcon_Locked](media/gmni-powerpivotgalleryicon-locked.gif "GMNI_PowerPivotGalleryIcon_Locked")</span><span class="sxs-lookup"><span data-stu-id="81fd4-193">![GMNI_PowerPivotGalleryIcon_Locked](media/gmni-powerpivotgalleryicon-locked.gif "GMNI_PowerPivotGalleryIcon_Locked")</span></span>  
  
#### <a name="new-default-setting-for-load-balancing-requests-changed-from-round-robin-to-health-based"></a><span data-ttu-id="81fd4-194">負載平衡要求的新預設設定從「循環配置資源」變更為「依據健全狀態」</span><span class="sxs-lookup"><span data-stu-id="81fd4-194">New default setting for load balancing requests changed from Round-Robin to Health-Based</span></span>  
 <span data-ttu-id="81fd4-195">PowerPivot 服務應用程式的預設設定會決定如何將 PowerPivot 資料的要求分散至伺服陣列中的多部 PowerPivot for SharePoint 伺服器。</span><span class="sxs-lookup"><span data-stu-id="81fd4-195">A PowerPivot service application has default settings that determine how requests for PowerPivot data are distributed across multiple PowerPivot for SharePoint servers in a farm.</span></span> <span data-ttu-id="81fd4-196">在舊版中，預設設定為 **[循環配置資源]**，這項設定會在可用的伺服器之間循序分散要求。</span><span class="sxs-lookup"><span data-stu-id="81fd4-196">In the previous release, the default setting was **Round Robin**, where requests were distributed sequentially among the available servers.</span></span> <span data-ttu-id="81fd4-197">而在此版本中，預設現在為 **[依據健全狀態]**。</span><span class="sxs-lookup"><span data-stu-id="81fd4-197">In this release, the default is now **Health Based**.</span></span> <span data-ttu-id="81fd4-198">PowerPivot 服務應用程式會使用伺服器健全狀況統計資料 (例如可用的記憶體或 CPU)，決定哪個伺服器執行個體取得 xt 要求。</span><span class="sxs-lookup"><span data-stu-id="81fd4-198">The PowerPivot service application uses server health statistics, such as available memory or CPU, to determine which server instance gets the xt request.</span></span>  
  
 <span data-ttu-id="81fd4-199">如果您已從舊版升級伺服器，PowerPivot 服務應用程式仍會保留舊的預設設定 (**[循環配置資源]**)。</span><span class="sxs-lookup"><span data-stu-id="81fd4-199">If you upgraded your server from the previous release, the PowerPivot service application retains the previous default setting (**Round Robin**).</span></span> <span data-ttu-id="81fd4-200">若要使用 **[依據健全狀態]** 配置方法設定，則必須修改組態設定。</span><span class="sxs-lookup"><span data-stu-id="81fd4-200">To use the **Health Based** allocation method setting, you must modify the configuration settings.</span></span> <span data-ttu-id="81fd4-201">如需詳細資訊，請參閱 [Create and Configure a PowerPivot Service Application in Central Administration](power-pivot-sharepoint/create-and-configure-power-pivot-service-application-in-ca.md)。</span><span class="sxs-lookup"><span data-stu-id="81fd4-201">For more information, see [Create and Configure a PowerPivot Service Application in Central Administration](power-pivot-sharepoint/create-and-configure-power-pivot-service-application-in-ca.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="81fd4-202">另請參閱</span><span class="sxs-lookup"><span data-stu-id="81fd4-202">See Also</span></span>  
 <span data-ttu-id="81fd4-203">[回溯相容性](../../2014/getting-started/backward-compatibility.md) </span><span class="sxs-lookup"><span data-stu-id="81fd4-203">[Backward Compatibility](../../2014/getting-started/backward-compatibility.md) </span></span>  
 [<span data-ttu-id="81fd4-204">SQL Server 2014 中 Analysis Services 功能的重大變更</span><span class="sxs-lookup"><span data-stu-id="81fd4-204">Breaking Changes to Analysis Services Features in SQL Server 2014</span></span>](breaking-changes-to-analysis-services-features-in-sql-server-2014.md)  
  
  
