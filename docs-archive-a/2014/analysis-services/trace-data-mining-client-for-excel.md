---
title: 適用于 Excel) 的追蹤 (資料採礦用戶端 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- tracer
- connections
ms.assetid: 4aea3e17-cd0f-48dd-8f22-b54a6c716426
author: minewiskan
ms.author: owend
ms.openlocfilehash: 74e1a5be21aa6981ccefa76f7bb1892d8d517be5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87706758"
---
# <a name="trace-data-mining-client-for-excel"></a><span data-ttu-id="bf8ee-102">追蹤 (適用於 Excel 的資料採礦用戶端)</span><span class="sxs-lookup"><span data-stu-id="bf8ee-102">Trace (Data Mining Client for Excel)</span></span>
  <span data-ttu-id="bf8ee-103">![追蹤按鈕](media/misc-trace.gif "追蹤按鈕")</span><span class="sxs-lookup"><span data-stu-id="bf8ee-103">![Trace button](media/misc-trace.gif "Trace button")</span></span>

 <span data-ttu-id="bf8ee-104">[**追蹤**] 對話方塊可協助您監視要用於資料採礦的實例所傳送的語句 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-104">The **Tracer** dialog box helps you monitor the statements that are sent to the instance of [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] that you are using for data mining.</span></span> <span data-ttu-id="bf8ee-105">當您建立與實例的連接之後 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] ，用戶端與伺服器之間的所有互動都會記錄在 [**追蹤**] 窗格中，包括建立結構、加入採礦模型及進行預測的語句，以及從伺服器傳回的一些訊息。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-105">After you have created a connection to an instance of [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)], all interactions between the client and the server are logged in the **Tracer** pane, including statements that create structures, add mining models, and make predictions, as well as some messages returning from the server.</span></span>

 <span data-ttu-id="bf8ee-106">根據要求的動作，陳述式可能是資料採礦延伸模組 (DMX) 資料定義查詢或資料操作查詢、Analysis Services 指令碼語言 (ASSL) 封包，或 Analysis Services 預存程序的呼叫。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-106">Depending on the action that is requested, the statement might be a Data Mining Extensions (DMX) data definition query or data manipulation query, an Analysis Services Scripting Language (ASSL) packet, or a call to an Analysis Services stored procedure.</span></span> <span data-ttu-id="bf8ee-107">但是，實際的數值結果和資料值則不會顯示。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-107">Actual numerical results and data values are not shown, however.</span></span>

 <span data-ttu-id="bf8ee-108">**追蹤**只會監視目前的連接，而且不會儲存 [**追蹤**] 對話方塊的內容。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-108">**Trace** monitors only the current connection, and the contents of the **Tracer** dialog box are not stored.</span></span>

## <a name="options"></a><span data-ttu-id="bf8ee-109">選項</span><span class="sxs-lookup"><span data-stu-id="bf8ee-109">Options</span></span>
 <span data-ttu-id="bf8ee-110">[追蹤] 窗格會列出從 Excel 用戶端傳送到伺服器的所有語句。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-110">Tracer pane Lists all statements sent from the Excel client to the server.</span></span>

 <span data-ttu-id="bf8ee-111">根據要求的動作，陳述式可能是 DMX 資料操作或資料定義陳述式、Analysis Services 預存程序的呼叫，或 XML/A 封包。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-111">Depending on the action that is being requested, the statement might be a DMX data manipulation or data definition statement, a call to an Analysis Services stored procedure, or an XML/A packet.</span></span>

 <span data-ttu-id="bf8ee-112">**目前的連接**按一下以顯示目前連接的定義。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-112">**Current Connection** Click to display the definition of the current connection.</span></span> <span data-ttu-id="bf8ee-113">定義會包含連接的名稱、提供者、資料來源、目錄、交易上次使用連接的時間，以及目前的狀態 (開啟、非使用中)。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-113">The definition includes the name of the connection, the provider, data source, and catalog, the time the connection was last used for a transaction, and the current state (Open, Inactive).</span></span>

 <span data-ttu-id="bf8ee-114">**使用會話模型**選取此核取方塊，將資料採礦模型和結構儲存為伺服器上的暫存物件。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-114">**Use session models** Select this check box to store data mining models and structures as temporary objects on the server.</span></span> <span data-ttu-id="bf8ee-115">您所建立的模型和結構僅在進行目前的工作階段時可以使用。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-115">The models and structures that you create will be available only for the duration of the current session.</span></span>

 <span data-ttu-id="bf8ee-116">取消選取此選項就可以將模型或結構存放在 Analysis Services 伺服器上進行儲存。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-116">Deselect this option to save your models or structures by storing them on an Analysis Services server.</span></span>

 <span data-ttu-id="bf8ee-117">**注意**只有當您使用適用于 Excel 的資料表分析工具時，才可以使用暫存物件的功能。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-117">**Note** The ability to use temporary objects is available only when you are using the Table Analysis Tools for Excel.</span></span> <span data-ttu-id="bf8ee-118">Visio 資料採礦範本與適用於 Excel 的資料採礦用戶端都需要使用結構和模型，才能存放在伺服器上。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-118">The Visio Data Mining templates and the Data Mining Client for Excel require structures and models to be stored on the server.</span></span>

## <a name="tracing-temporary-structures-and-models"></a><span data-ttu-id="bf8ee-119">追蹤暫時性結構和模型</span><span class="sxs-lookup"><span data-stu-id="bf8ee-119">Tracing Temporary Structures and Models</span></span>
 <span data-ttu-id="bf8ee-120">如果您要使用預設會建立暫時性結構和模型的資料表分析工具，伺服器與用戶端之間的活動會受到監視，但是您所建立的模型或結構不會永久儲存到伺服器。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-120">If you are using the Table Analysis Tools, which by default create temporary structures and models, the activity between the server and the client is monitored, but the models or structures that you create are not saved permanently to the server.</span></span>

 <span data-ttu-id="bf8ee-121">如果您想要在使用其中一個資料表分析工具時保留您的工作，您可以取消選取 [**使用會話模型**] 選項，讓您的模型永久儲存在伺服器上。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-121">If you want to preserve your work when using one of the Table Analysis Tools, you can deselect the option, **Use session models**, to cause your models to be permanently saved on the server.</span></span> <span data-ttu-id="bf8ee-122">您也可以將 [**追蹤**] 窗格中的語句複製到檔案中，以便您可以在稍後重新建立工作。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-122">You can also copy the statements in the **Tracer** pane to a file so that you can re-create your work later.</span></span>

## <a name="understanding-sessions"></a><span data-ttu-id="bf8ee-123">了解工作階段</span><span class="sxs-lookup"><span data-stu-id="bf8ee-123">Understanding Sessions</span></span>
 <span data-ttu-id="bf8ee-124">當您連接到 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 的執行個體時，此資料採礦增益集會起始工作階段。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-124">When you connect to an instance of [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)], the data mining add-in initiates a session.</span></span> <span data-ttu-id="bf8ee-125">每一個工作階段都會收到一個工作階段識別碼，此識別碼會識別 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 執行個體上現有的工作階段。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-125">Each session receives a session identifier that identifies an existing session on the [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] instance.</span></span> <span data-ttu-id="bf8ee-126">但是，工作階段識別碼並不保證工作階段會維持有效狀態。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-126">However, a session identifier does not guarantee that a session remains valid.</span></span> <span data-ttu-id="bf8ee-127">如果工作階段逾時或是與工作階段有關的連接中斷，則此工作階段會過期。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-127">The session can expire if the session times out or the connection associated with the session is disconnected.</span></span> <span data-ttu-id="bf8ee-128">如果此工作階段過期而不再有效，則 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 會結束此工作階段，並回復進行中的任何交易。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-128">If the session expires and is no longer valid, [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] ends the session and rolls back any transactions that are in process.</span></span> <span data-ttu-id="bf8ee-129">如果訊息傳送時附有不再有效的工作階段識別碼，則該訊息會失敗且出現錯誤，表示找不到指定的工作階段。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-129">If a message is sent with a session identifier that is no longer valid, the message fails with an error indicating that the specified session cannot be found.</span></span>

 <span data-ttu-id="bf8ee-130">雖然某些資料採礦模型會明確地儲存在伺服器上，但工作階段採礦模型和結構並不會，而且工作階段資料採礦活動也不會保存任何記錄。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-130">Although some data mining models are explicitly stored on the server, session mining models and structures are not, and no record is persisted of session data mining activity.</span></span> <span data-ttu-id="bf8ee-131">由於暫存的採礦模型和結構會在您結束工作階段後立即刪除，所以在儲存您要保留的任何工作之前，請避免關閉 Excel 活頁簿。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-131">Because temporary mining models and structures are deleted as soon as you end the session, you should avoid closing your Excel workbook until after you have saved any work that you want to keep.</span></span>

## <a name="changing-connections"></a><span data-ttu-id="bf8ee-132">變更連接</span><span class="sxs-lookup"><span data-stu-id="bf8ee-132">Changing Connections</span></span>
 <span data-ttu-id="bf8ee-133">變更連接並不會刪除之前連接的追蹤，</span><span class="sxs-lookup"><span data-stu-id="bf8ee-133">Changing connections does not delete traces from previous connections.</span></span> <span data-ttu-id="bf8ee-134">只有關閉活頁簿會清除工作階段。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-134">Only closing the workbook erases the session.</span></span>

 <span data-ttu-id="bf8ee-135">如果您在 Excel 活頁簿中工作時變更連接，[**追蹤**] 窗格就不會記錄連接的變更。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-135">If you change connections while working in an Excel workbook, the change of connections is not recorded in the **Tracer** pane.</span></span> <span data-ttu-id="bf8ee-136">若要明確顯示目前連接的名稱和狀態，您必須按一下 [**目前的連接**]。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-136">To explicitly display the name and status of the current connection, you must click **Current Connection**.</span></span>

## <a name="understanding-statements-in-the-tracer"></a><span data-ttu-id="bf8ee-137">了解 Tracer 中的陳述式</span><span class="sxs-lookup"><span data-stu-id="bf8ee-137">Understanding Statements in the Tracer</span></span>
 <span data-ttu-id="bf8ee-138">DMX 是一種語言，您可用它來建立及處理 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 中的資料採礦模型。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-138">DMX is a language that you can use to create and work with data mining models in [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="bf8ee-139">您可以使用 DMX 建立新資料採礦模型的結構、定型這些模型，以及瀏覽、管理與預測模型。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-139">You can use DMX to create the structure of new data mining models, train these models, and to browse, manage, and predict against them.</span></span> <span data-ttu-id="bf8ee-140">DMX 是由資料定義語言 (DDL) 陳述式、資料操作語言 (DML) 陳述式及函數和運算子所組成。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-140">DMX is composed of data definition language (DDL) statements, data manipulation language (DML) statements, and functions and operators.</span></span>

 <span data-ttu-id="bf8ee-141">DMX 陳述式的完整討論以及其語法不在本主題的討論範圍內。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-141">A complete discussion of DMX statements and their syntax is beyond the scope of this topic.</span></span> <span data-ttu-id="bf8ee-142">不過，您可以使用 [**追蹤**] 窗格中的資訊來尋找 DMX 語句行為的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-142">However, you can use the information in the **Tracer** pane to find detailed information about the behavior of a DMX statement.</span></span> <span data-ttu-id="bf8ee-143">適用於 Excel 的資料採礦增益集也可以協助您建立複雜的 DMX 陳述式以及與 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 伺服器互動。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-143">The Data Mining Add-ins for Excel can also help you build complex DMX statements and interact with an [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] server.</span></span> <span data-ttu-id="bf8ee-144">如需詳細資訊，請參閱[SQL Server 資料採礦增益集&#41;的查詢 &#40;](query-sql-server-data-mining-add-ins.md)。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-144">For more information, see [Query &#40;SQL Server Data Mining Add-ins&#41;](query-sql-server-data-mining-add-ins.md).</span></span>

> [!NOTE]
>  <span data-ttu-id="bf8ee-145">許多 DMX 陳述式都經過參數化。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-145">Many DMX statements are parameterized.</span></span> <span data-ttu-id="bf8ee-146">如果是簡單的類型，參數的值會列在陳述式下方。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-146">For simple types, the values of the parameters are listed under the statement.</span></span> <span data-ttu-id="bf8ee-147">不過如果是複雜的類型，則只會列出參數的類型。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-147">However, for complex types, only the type of the parameter is listed.</span></span>

 <span data-ttu-id="bf8ee-148">SQL Server Analysis Services 也會使用 XML for Analysis (XMLA) 通訊協定來處理用戶端應用程式之間的所有通訊，這些應用程式包括適用於 Excel 的資料採礦用戶端和 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 的執行個體。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-148">SQL Server Analysis Services also uses the XML for Analysis (XMLA) protocol to handle all communications between client applications, including the Data Mining Client for Excel and an instance of [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)].</span></span>

 <span data-ttu-id="bf8ee-149">如需有關 DMX 語法，以及 XMLA 中命令和元素的詳細資訊，請參閱《[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 線上叢書》。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-149">For more information about DMX syntax, and about the commands and elements in XMLA, see [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Books Online.</span></span>

 <span data-ttu-id="bf8ee-150">傳送到伺服器的某些陳述式可能包括呼叫 Analysis Services 系統預存程序的查詢。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-150">Some of the statements sent to the server may include queries that call Analysis Services system stored procedures.</span></span> <span data-ttu-id="bf8ee-151">如需詳細資訊，請參閱《SQL Server 線上叢書》。</span><span class="sxs-lookup"><span data-stu-id="bf8ee-151">For more information, see SQL Server Books Online.</span></span>


