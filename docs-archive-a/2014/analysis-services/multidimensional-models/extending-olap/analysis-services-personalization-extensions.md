---
title: Analysis Services 個人化延伸模組 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- personalization extensions [Multidimensional Databases]
ms.assetid: 0f144059-24e0-40c0-bde4-d48c75e46598
author: minewiskan
ms.author: owend
ms.openlocfilehash: 0cd36cb2882659bff902d9830af0c5acefd98444
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87607111"
---
# <a name="analysis-services-personalization-extensions"></a><span data-ttu-id="1b27d-102">Analysis Services 個人化延伸模組</span><span class="sxs-lookup"><span data-stu-id="1b27d-102">Analysis Services Personalization Extensions</span></span>
  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="1b27d-103">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]個人化延伸模組是實現外掛程式架構之概念的基礎。</span><span class="sxs-lookup"><span data-stu-id="1b27d-103">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions are the foundation of the idea of implementing a plug-in architecture.</span></span> <span data-ttu-id="1b27d-104">在外掛程式架構中，您可以動態開發新的 Cube 物件和功能，並輕鬆地與其他開發人員共用。</span><span class="sxs-lookup"><span data-stu-id="1b27d-104">In a plug-in architecture, you can develop new cube objects and functionality dynamically and share them easily with other developers.</span></span> <span data-ttu-id="1b27d-105">因此， [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 個人化延伸模組所提供的功能，可讓您達到下列目的：</span><span class="sxs-lookup"><span data-stu-id="1b27d-105">As such, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions provide the functionality that makes it possible to achieve the following:</span></span>  
  
-   <span data-ttu-id="1b27d-106">**動態設計和部署**在您設計和部署個人化延伸模組之後 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] ，使用者就可以在下一個使用者會話開始時存取物件和功能。</span><span class="sxs-lookup"><span data-stu-id="1b27d-106">**Dynamic design and deployment** Immediately after you design and deploy [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions, users have access to the objects and functionality at the start of the next user session.</span></span>  
  
-   <span data-ttu-id="1b27d-107">**介面獨立性**不論您用來建立個人化延伸模組的介面為何 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] ，使用者都可以使用任何介面來存取物件和功能。</span><span class="sxs-lookup"><span data-stu-id="1b27d-107">**Interface independence** Regardless of the interface that you use to create the [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions, users can use any interface to access the objects and functionality.</span></span>  
  
-   <span data-ttu-id="1b27d-108">**會話內容** [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]個人化延伸模組在現有的基礎結構中不是永久的物件，而且不需要重新處理 cube。</span><span class="sxs-lookup"><span data-stu-id="1b27d-108">**Session context** [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions are not permanent objects in the existing infrastructure and do not require the cube to be reprocessed.</span></span> <span data-ttu-id="1b27d-109">它們會在使用者連接資料庫時針對使用者來公開及建立，而且在整個使用者工作階段期間都維持可用狀態。</span><span class="sxs-lookup"><span data-stu-id="1b27d-109">They become exposed and created for the user at the time that the user connects to the database, and remain available for the length of that user session.</span></span>  
  
-   <span data-ttu-id="1b27d-110">**快速散發**[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]與其他軟體發展人員共用個人化延伸模組，而不需要深入瞭解如何找到此延伸功能的詳細規格。</span><span class="sxs-lookup"><span data-stu-id="1b27d-110">**Rapid distribution** Share [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions with other software developers without having to go into detailed specifications about where or how to find this extended functionality.</span></span>  
  
 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] <span data-ttu-id="1b27d-111">個人化延伸模組有許多用途。</span><span class="sxs-lookup"><span data-stu-id="1b27d-111">personalization extensions have many uses.</span></span> <span data-ttu-id="1b27d-112">例如，假設貴公司的銷售使用不同的貨幣。</span><span class="sxs-lookup"><span data-stu-id="1b27d-112">For example, your company has sales that involve different currencies.</span></span> <span data-ttu-id="1b27d-113">您建立一個導出成員，該成員會使用存取此 Cube 之人員所用的當地貨幣來傳回合併的銷售量。</span><span class="sxs-lookup"><span data-stu-id="1b27d-113">You create a calculated member that returns the consolidated sales in the local currency of the person who is accessing the cube.</span></span> <span data-ttu-id="1b27d-114">您會將這個成員建立為個人化延伸模組，</span><span class="sxs-lookup"><span data-stu-id="1b27d-114">You create this member as a personalization extension.</span></span> <span data-ttu-id="1b27d-115">然後您可以將這個導出成員與一組使用者共用。</span><span class="sxs-lookup"><span data-stu-id="1b27d-115">You then share this calculated member to a group of users.</span></span> <span data-ttu-id="1b27d-116">一旦共用之後，這些使用者就可以在連接伺服器之後立刻存取此導出成員。</span><span class="sxs-lookup"><span data-stu-id="1b27d-116">Once shared, those users have immediate access to the calculated member as soon as they connect to the server.</span></span> <span data-ttu-id="1b27d-117">即使這些使用者所使用的介面與當初建立此導出成員所用的介面不同，他們還是可以存取。</span><span class="sxs-lookup"><span data-stu-id="1b27d-117">They have access even if they are not using the same interface as the one that was used to create the calculated member.</span></span>  
  
 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]<span data-ttu-id="1b27d-118">個人化延伸模組是對現有 managed 元件架構的簡單且簡潔的修改，而且會在整個 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] [Microsoft.analysisservices 的 AdomdServer](/previous-versions/sql/sql-server-2014/ms131779(v=sql.120))物件模型、多維度運算式 (MDX) 語法和架構資料列集中公開。</span><span class="sxs-lookup"><span data-stu-id="1b27d-118">personalization extensions are a simple and elegant modification to the existing managed assembly architecture and are exposed throughout the [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] [Microsoft.AnalysisServices.AdomdServer](/previous-versions/sql/sql-server-2014/ms131779(v=sql.120)) object model, Multidimensional Expressions (MDX) syntax, and schema rowsets.</span></span>  
  
## <a name="logical-architecture"></a><span data-ttu-id="1b27d-119">邏輯架構</span><span class="sxs-lookup"><span data-stu-id="1b27d-119">Logical Architecture</span></span>  
 <span data-ttu-id="1b27d-120">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 個人化延伸模組的架構是根據 Managed 組件架構，而且具有以下四個基本元素：</span><span class="sxs-lookup"><span data-stu-id="1b27d-120">The architecture for [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions is based on the managed assembly architecture and the following four basic elements:</span></span>  
  
 <span data-ttu-id="1b27d-121">[PlugInAttribute] 自訂屬性</span><span class="sxs-lookup"><span data-stu-id="1b27d-121">The [PlugInAttribute] custom attribute</span></span>  
 <span data-ttu-id="1b27d-122">啟動服務時， [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 會載入必要的元件，並判斷哪些類別具有[Microsoft.analysisservices. AdomdServer. PlugInAttribute](/previous-versions/sql/sql-server-2014/bb678014(v=sql.120))自訂屬性。</span><span class="sxs-lookup"><span data-stu-id="1b27d-122">When starting the service, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] loads the required assemblies and determines which classes have the [Microsoft.AnalysisServices.AdomdServer.PlugInAttribute](/previous-versions/sql/sql-server-2014/bb678014(v=sql.120)) custom attribute.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="1b27d-123">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 會使用可描述程式碼及影響執行階段行為的方式來定義自訂屬性。</span><span class="sxs-lookup"><span data-stu-id="1b27d-123">The [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] defines custom attributes as a way to describe your code and affect run-time behavior.</span></span> <span data-ttu-id="1b27d-124">如需詳細資訊，請參閱 MSDN 上《開發人員指南》中的「[屬性總覽](https://go.microsoft.com/fwlink/?LinkId=82929)」主題 [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="1b27d-124">For more information, see the topic, "[Attributes Overview](https://go.microsoft.com/fwlink/?LinkId=82929)," in the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] Developer's Guide on MSDN.</span></span>  
  
 <span data-ttu-id="1b27d-125">針對具有[microsoft.analysisservices. AdomdServer. PlugInAttribute](/previous-versions/sql/sql-server-2014/bb678014(v=sql.120))自訂屬性的所有類別，會叫用其預設的函式 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="1b27d-125">For all classes with the [Microsoft.AnalysisServices.AdomdServer.PlugInAttribute](/previous-versions/sql/sql-server-2014/bb678014(v=sql.120)) custom attribute, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] invokes their default constructors.</span></span> <span data-ttu-id="1b27d-126">在啟動時叫用所有建構函式會提供一個共用位置，可以從這個位置建立新的物件，而且此位置與任何使用者活動都無關。</span><span class="sxs-lookup"><span data-stu-id="1b27d-126">Invoking all the constructors at startup provides a common location from which to build new objects and that is independent of any user activity.</span></span>  
  
 <span data-ttu-id="1b27d-127">除了建立有關撰寫和管理個人化延伸模組的小型快取之外，類別的「分類函數」通常會訂閱[microsoft.analysisservices. SessionOpened](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120))和[microsoft.analysisservices。](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120)) AdomdServer 事件。</span><span class="sxs-lookup"><span data-stu-id="1b27d-127">In addition to building a small cache of information about authoring and managing personalization extensions, the class constructor typically subscribes to the [Microsoft.AnalysisServices.AdomdServer.Server.SessionOpened](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120)) and [Microsoft.AnalysisServices.AdomdServer.Server.SessionClosing](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120)) events.</span></span> <span data-ttu-id="1b27d-128">無法訂閱這些事件可能會導致 Common Language Runtime (CLR) 記憶體回收行程不當標記此類別來加以清除。</span><span class="sxs-lookup"><span data-stu-id="1b27d-128">Failing to subscribe to these events may cause the class to be inappropriately marked for cleanup by the common language runtime (CLR) garbage collector.</span></span>  
  
 <span data-ttu-id="1b27d-129">工作階段內容</span><span class="sxs-lookup"><span data-stu-id="1b27d-129">Session context</span></span>  
 <span data-ttu-id="1b27d-130">如果是根據個人化延伸模組的物件，[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 會在用戶端工作階段期間建立執行環境，並在此環境中動態建立大多數的物件。</span><span class="sxs-lookup"><span data-stu-id="1b27d-130">For those objects that are based on personalization extensions, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] creates an execution environment during the client session and dynamically builds most of those objects in this environment.</span></span> <span data-ttu-id="1b27d-131">就像其他任何 CLR 組件一樣，這個執行環境也可存取其他函數和預存程序。</span><span class="sxs-lookup"><span data-stu-id="1b27d-131">Like any other CLR assembly, this execution environment also has access to other functions and stored procedures.</span></span> <span data-ttu-id="1b27d-132">當使用者會話結束時，會 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 移除動態建立的物件並關閉執行環境。</span><span class="sxs-lookup"><span data-stu-id="1b27d-132">When the user session ends, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] removes the dynamically created objects and closes the execution environment.</span></span>  
  
 <span data-ttu-id="1b27d-133">事件</span><span class="sxs-lookup"><span data-stu-id="1b27d-133">Events</span></span>  
 <span data-ttu-id="1b27d-134">物件的建立是由工作階段事件 `On-Cube-OpenedCubeOpened` 和 `On-Cube-ClosingCubeClosing` 所觸發。</span><span class="sxs-lookup"><span data-stu-id="1b27d-134">Object creation is triggered by the session events `On-Cube-OpenedCubeOpened` and `On-Cube-ClosingCubeClosing`.</span></span>  
  
 <span data-ttu-id="1b27d-135">用戶端與伺服器之間的通訊是透過特定的事件而產生。</span><span class="sxs-lookup"><span data-stu-id="1b27d-135">Communication between the client and the server occurs through specific events.</span></span> <span data-ttu-id="1b27d-136">這些事件可讓用戶端了解導致用戶端物件建立的狀況。</span><span class="sxs-lookup"><span data-stu-id="1b27d-136">These events make the client aware of the situations that lead to the client's objects being built.</span></span> <span data-ttu-id="1b27d-137">用戶端的環境是使用兩組事件所動態建立的：工作階段事件和 Cube 事件。</span><span class="sxs-lookup"><span data-stu-id="1b27d-137">The client's environment is dynamically created using two sets of events: session events and cube events.</span></span>  
  
 <span data-ttu-id="1b27d-138">工作階段事件與伺服器物件有關聯。</span><span class="sxs-lookup"><span data-stu-id="1b27d-138">Session events are associated with the server object.</span></span> <span data-ttu-id="1b27d-139">當用戶端登入伺服器時，會 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 建立會話並觸發[AdomdServer SessionOpened](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120))事件。</span><span class="sxs-lookup"><span data-stu-id="1b27d-139">When a client logs on to a server, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] creates a session and triggers the [Microsoft.AnalysisServices.AdomdServer.Server.SessionOpened](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120)) event.</span></span> <span data-ttu-id="1b27d-140">當用戶端在伺服器上結束會話時，會 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 觸發[AdomdServer SessionClosing](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120))事件。</span><span class="sxs-lookup"><span data-stu-id="1b27d-140">When a client ends the session on the server, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] triggers the [Microsoft.AnalysisServices.AdomdServer.Server.SessionClosing](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120)) event.</span></span>  
  
 <span data-ttu-id="1b27d-141">Cube 事件與連接物件有關聯。</span><span class="sxs-lookup"><span data-stu-id="1b27d-141">Cube events are associated with the connection object.</span></span> <span data-ttu-id="1b27d-142">連接至 cube 時，會觸發[microsoft.analysisservices. AdomdServer. AdomdConnection. CubeOpened](/previous-versions/sql/sql-server-2014/bb630581(v=sql.120))事件。</span><span class="sxs-lookup"><span data-stu-id="1b27d-142">Connecting to a cube triggers the [Microsoft.AnalysisServices.AdomdServer.AdomdConnection.CubeOpened](/previous-versions/sql/sql-server-2014/bb630581(v=sql.120)) event.</span></span> <span data-ttu-id="1b27d-143">藉由關閉 cube 或變更為不同的 cube 來關閉 cube 的連接，會觸發[microsoft.analysisservices. AdomdServer. AdomdConnection. CubeClosing](/previous-versions/sql/sql-server-2014/bb630371(v=sql.120))事件。</span><span class="sxs-lookup"><span data-stu-id="1b27d-143">Closing the connection to a cube, by either closing the cube or by changing to a different cube, triggers a [Microsoft.AnalysisServices.AdomdServer.AdomdConnection.CubeClosing](/previous-versions/sql/sql-server-2014/bb630371(v=sql.120)) event.</span></span>  
  
 <span data-ttu-id="1b27d-144">可追蹤性和錯誤處理</span><span class="sxs-lookup"><span data-stu-id="1b27d-144">Traceability and error handling</span></span>  
 <span data-ttu-id="1b27d-145">所有活動都可以使用 [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)] 來追蹤。</span><span class="sxs-lookup"><span data-stu-id="1b27d-145">All activity is traceable by using [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)].</span></span> <span data-ttu-id="1b27d-146">未處理的錯誤會報告到 Windows 事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="1b27d-146">Unhandled errors are reported to the Windows event log.</span></span>  
  
 <span data-ttu-id="1b27d-147">所有物件的撰寫和管理都與這個結構無關，而且只有物件的開發人員才需負責。</span><span class="sxs-lookup"><span data-stu-id="1b27d-147">All object authoring and management is independent of this architecture and is the sole responsibility of the developers of the objects.</span></span>  
  
## <a name="infrastructure-foundations"></a><span data-ttu-id="1b27d-148">基礎結構基準</span><span class="sxs-lookup"><span data-stu-id="1b27d-148">Infrastructure Foundations</span></span>  
 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] <span data-ttu-id="1b27d-149">個人化延伸模組是根據現有的元件。</span><span class="sxs-lookup"><span data-stu-id="1b27d-149">personalization extensions are based on existing components.</span></span> <span data-ttu-id="1b27d-150">下列是提供個人化延伸模組功能的增強與改良摘要。</span><span class="sxs-lookup"><span data-stu-id="1b27d-150">The following is a summary of enhancements and improvements that provide the personalization extensions functionality.</span></span>  
  
### <a name="assemblies"></a><span data-ttu-id="1b27d-151">組件</span><span class="sxs-lookup"><span data-stu-id="1b27d-151">Assemblies</span></span>  
 <span data-ttu-id="1b27d-152">您可以將自訂屬性（ [microsoft.analysisservices. AdomdServer. PlugInAttribute](/previous-versions/sql/sql-server-2014/bb678014(v=sql.120))）新增至您的自訂群組件，以識別 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 個人化延伸模組類別。</span><span class="sxs-lookup"><span data-stu-id="1b27d-152">The custom attribute, [Microsoft.AnalysisServices.AdomdServer.PlugInAttribute](/previous-versions/sql/sql-server-2014/bb678014(v=sql.120)), can be added to your custom assemblies to identify [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions classes.</span></span>  
  
### <a name="changes-to-the-adomdserver-object-model"></a><span data-ttu-id="1b27d-153">變更到 AdomdServer 物件模型</span><span class="sxs-lookup"><span data-stu-id="1b27d-153">Changes to the AdomdServer Object Model</span></span>  
 <span data-ttu-id="1b27d-154">[Microsoft.analysisservices. AdomdServer](/previous-versions/sql/sql-server-2014/ms131779(v=sql.120))物件模型中的下列物件已增強或加入至模型。</span><span class="sxs-lookup"><span data-stu-id="1b27d-154">The following objects in the [Microsoft.AnalysisServices.AdomdServer](/previous-versions/sql/sql-server-2014/ms131779(v=sql.120)) object model have been enhanced or added to the model.</span></span>  
  
#### <a name="new-adomdconnection-class"></a><span data-ttu-id="1b27d-155">新的 AdomdConnection 類別</span><span class="sxs-lookup"><span data-stu-id="1b27d-155">New AdomdConnection Class</span></span>  
 <span data-ttu-id="1b27d-156">[Microsoft.analysisservices. AdomdServer. AdomdConnection](/previous-versions/sql/sql-server-2014/bb678193(v=sql.120))類別是新的，而且會透過屬性和事件公開數個個人化延伸模組。</span><span class="sxs-lookup"><span data-stu-id="1b27d-156">The [Microsoft.AnalysisServices.AdomdServer.AdomdConnection](/previous-versions/sql/sql-server-2014/bb678193(v=sql.120)) class is new and exposes several personalization extensions through both properties and events.</span></span>  
  
 <span data-ttu-id="1b27d-157">**屬性**</span><span class="sxs-lookup"><span data-stu-id="1b27d-157">**Properties**</span></span>  
  
-   <span data-ttu-id="1b27d-158">[Microsoft.analysisservices. AdomdServer. AdomdConnection. SessionID \*](/previous-versions/sql/sql-server-2014/bb678099(v=sql.120))，這是一個唯讀字串值，代表目前連接的會話識別碼。</span><span class="sxs-lookup"><span data-stu-id="1b27d-158">[Microsoft.AnalysisServices.AdomdServer.AdomdConnection.SessionID\*](/previous-versions/sql/sql-server-2014/bb678099(v=sql.120)), a read-only string value representing the session Id of the current connection.</span></span>  
  
-   <span data-ttu-id="1b27d-159">[Microsoft.analysisservices. AdomdServer. AdomdConnection. ClientCulture \*](/previous-versions/sql/sql-server-2014/bb677433(v=sql.120))，這是與目前會話相關聯之用戶端文化特性的唯讀參考。</span><span class="sxs-lookup"><span data-stu-id="1b27d-159">[Microsoft.AnalysisServices.AdomdServer.AdomdConnection.ClientCulture\*](/previous-versions/sql/sql-server-2014/bb677433(v=sql.120)), a read-only reference to the client culture associated with current session.</span></span>  
  
-   <span data-ttu-id="1b27d-160">[Microsoft.analysisservices. AdomdServer. User \*](/previous-versions/sql/sql-server-2014/bb630315(v=sql.120))，這是代表目前使用者之身分識別介面的唯讀參考。</span><span class="sxs-lookup"><span data-stu-id="1b27d-160">[Microsoft.AnalysisServices.AdomdServer.AdomdConnection.User\*](/previous-versions/sql/sql-server-2014/bb630315(v=sql.120)), a read-only reference to the identity interface representing the current user.</span></span>  
  
 <span data-ttu-id="1b27d-161">**事件**</span><span class="sxs-lookup"><span data-stu-id="1b27d-161">**Events**</span></span>  
  
-   <span data-ttu-id="1b27d-162">[Microsoft.analysisservices. AdomdServer. AdomdConnection. CubeOpened](/previous-versions/sql/sql-server-2014/bb630581(v=sql.120))</span><span class="sxs-lookup"><span data-stu-id="1b27d-162">[Microsoft.AnalysisServices.AdomdServer.AdomdConnection.CubeOpened](/previous-versions/sql/sql-server-2014/bb630581(v=sql.120))</span></span>  
  
-   <span data-ttu-id="1b27d-163">[Microsoft.analysisservices. AdomdServer. AdomdConnection. CubeClosing](/previous-versions/sql/sql-server-2014/bb630371(v=sql.120))</span><span class="sxs-lookup"><span data-stu-id="1b27d-163">[Microsoft.AnalysisServices.AdomdServer.AdomdConnection.CubeClosing](/previous-versions/sql/sql-server-2014/bb630371(v=sql.120))</span></span>  
  
#### <a name="new-properties-in-the-context-class"></a><span data-ttu-id="1b27d-164">Context 類別中的新屬性</span><span class="sxs-lookup"><span data-stu-id="1b27d-164">New Properties in the Context class</span></span>  
 <span data-ttu-id="1b27d-165">[Microsoft.analysisservices. AdomdServer. CoNtext](/previous-versions/sql/sql-server-2014/ms143353(v=sql.120))類別有兩個新屬性：</span><span class="sxs-lookup"><span data-stu-id="1b27d-165">The [Microsoft.AnalysisServices.AdomdServer.Context](/previous-versions/sql/sql-server-2014/ms143353(v=sql.120)) class has two new properties:</span></span>  
  
-   <span data-ttu-id="1b27d-166">[Microsoft.analysisservices. AdomdServer. Server \*](/previous-versions/sql/sql-server-2014/bb678098(v=sql.120))，這是新伺服器物件的唯讀參考。</span><span class="sxs-lookup"><span data-stu-id="1b27d-166">[Microsoft.AnalysisServices.AdomdServer.Context.Server\*](/previous-versions/sql/sql-server-2014/bb678098(v=sql.120)), a read-only reference to the new server object.</span></span>  
  
-   <span data-ttu-id="1b27d-167">[Microsoft.analysisservices. AdomdServer. CurrentConnection \*](/previous-versions/sql/sql-server-2014/bb630975(v=sql.120))，這是新的[microsoft.analysisservices](/previous-versions/sql/sql-server-2014/bb678193(v=sql.120)) AdomdServer 物件的唯讀參考。</span><span class="sxs-lookup"><span data-stu-id="1b27d-167">[Microsoft.AnalysisServices.AdomdServer.Context.CurrentConnection\*](/previous-versions/sql/sql-server-2014/bb630975(v=sql.120)), a read-only reference to the new [Microsoft.AnalysisServices.AdomdServer.AdomdConnection](/previous-versions/sql/sql-server-2014/bb678193(v=sql.120)) object.</span></span>  
  
#### <a name="new-server-class"></a><span data-ttu-id="1b27d-168">新的 Server 類別</span><span class="sxs-lookup"><span data-stu-id="1b27d-168">New Server class</span></span>  
 <span data-ttu-id="1b27d-169">[Microsoft.analysisservices. AdomdServer](/previous-versions/sql/sql-server-2014/bb677955(v=sql.120))類別是新的，而且會透過類別屬性和事件公開數個個人化延伸模組。</span><span class="sxs-lookup"><span data-stu-id="1b27d-169">The [Microsoft.AnalysisServices.AdomdServer.Server](/previous-versions/sql/sql-server-2014/bb677955(v=sql.120)) class is new and exposes several personalization extensions through both class properties and events.</span></span>  
  
 <span data-ttu-id="1b27d-170">**屬性**</span><span class="sxs-lookup"><span data-stu-id="1b27d-170">**Properties**</span></span>  
  
-   <span data-ttu-id="1b27d-171">[Microsoft.AnalysisServices.AdomdServer.Server.Name \*](/previous-versions/sql/sql-server-2014/bb677694(v=sql.120))，代表伺服器名稱的唯讀字串值。</span><span class="sxs-lookup"><span data-stu-id="1b27d-171">[Microsoft.AnalysisServices.AdomdServer.Server.Name\*](/previous-versions/sql/sql-server-2014/bb677694(v=sql.120)), a read-only string value representing the server name.</span></span>  
  
-   <span data-ttu-id="1b27d-172">[Microsoft.analysisservices. AdomdServer](/previous-versions/sql/sql-server-2014/bb677437(v=sql.120))，這是與伺服器相關聯之全域文化特性的唯讀參考。</span><span class="sxs-lookup"><span data-stu-id="1b27d-172">[Microsoft.AnalysisServices.AdomdServer.Server.Culture\*](/previous-versions/sql/sql-server-2014/bb677437(v=sql.120)), A read-only reference to the global culture associated with the server.</span></span>  
  
 <span data-ttu-id="1b27d-173">**事件**</span><span class="sxs-lookup"><span data-stu-id="1b27d-173">**Events**</span></span>  
  
-   <span data-ttu-id="1b27d-174">[Microsoft.analysisservices. AdomdServer. SessionOpened](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120))</span><span class="sxs-lookup"><span data-stu-id="1b27d-174">[Microsoft.AnalysisServices.AdomdServer.Server.SessionOpened](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120))</span></span>  
  
-   <span data-ttu-id="1b27d-175">[Microsoft.analysisservices. AdomdServer. SessionClosing](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120))</span><span class="sxs-lookup"><span data-stu-id="1b27d-175">[Microsoft.AnalysisServices.AdomdServer.Server.SessionClosing](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120))</span></span>  
  
#### <a name="adomdcommand-class"></a><span data-ttu-id="1b27d-176">AdomdCommand 類別</span><span class="sxs-lookup"><span data-stu-id="1b27d-176">AdomdCommand class</span></span>  
 <span data-ttu-id="1b27d-177">[Microsoft.analysisservices. AdomdServer. AdomdCommand](/previous-versions/sql/sql-server-2014/ms143286(v=sql.120))類別現在支援下列 MDX 命令：</span><span class="sxs-lookup"><span data-stu-id="1b27d-177">The [Microsoft.AnalysisServices.AdomdServer.AdomdCommand](/previous-versions/sql/sql-server-2014/ms143286(v=sql.120)) class now supports of the following MDX commands:</span></span>  
  
-   [<span data-ttu-id="1b27d-178">CREATE MEMBER 陳述式 &#40;MDX&#41;</span><span class="sxs-lookup"><span data-stu-id="1b27d-178">CREATE MEMBER Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-create-member)  
  
-   [<span data-ttu-id="1b27d-179">UPDATE MEMBER 語句 &#40;MDX&#41;</span><span class="sxs-lookup"><span data-stu-id="1b27d-179">UPDATE MEMBER Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-update-member)  
  
-   [<span data-ttu-id="1b27d-180">DROP MEMBER 語句 &#40;MDX&#41;</span><span class="sxs-lookup"><span data-stu-id="1b27d-180">DROP MEMBER Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-drop-member)  
  
-   [<span data-ttu-id="1b27d-181">CREATE SET 陳述式 &#40;MDX&#41;</span><span class="sxs-lookup"><span data-stu-id="1b27d-181">CREATE SET Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-create-set)  
  
-   [<span data-ttu-id="1b27d-182">&#40;MDX&#41;的 DROP SET 語句</span><span class="sxs-lookup"><span data-stu-id="1b27d-182">DROP SET Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-drop-set)  
  
-   [<span data-ttu-id="1b27d-183">CREATE KPI 語句 &#40;MDX&#41;</span><span class="sxs-lookup"><span data-stu-id="1b27d-183">CREATE KPI Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-create-kpi)  
  
-   [<span data-ttu-id="1b27d-184">DROP KPI 語句 &#40;MDX&#41;</span><span class="sxs-lookup"><span data-stu-id="1b27d-184">DROP KPI Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-drop-kpi)  
  
### <a name="mdx-extensions-and-enhancements"></a><span data-ttu-id="1b27d-185">MDX 延伸模組和增強功能</span><span class="sxs-lookup"><span data-stu-id="1b27d-185">MDX extensions and enhancements</span></span>  
 <span data-ttu-id="1b27d-186">CREATE MEMBER 命令可利用 `caption` 屬性、`display_folder` 屬性和 `associated_measure_group` 屬性來增強。</span><span class="sxs-lookup"><span data-stu-id="1b27d-186">The CREATE MEMBER command is enhanced with the `caption` property, the `display_folder` property, and the `associated_measure_group` property.</span></span>  
  
 <span data-ttu-id="1b27d-187">加入 UPDATE MEMBER 命令可在需要更新而造成解決計算中的優先順序遺失時，可避免重新建立成員。</span><span class="sxs-lookup"><span data-stu-id="1b27d-187">The UPDATE MEMBER command is added to avoid member re-creation when an update is needed with the consequent loss of precedence in solving calculations.</span></span> <span data-ttu-id="1b27d-188">更新無法變更導出成員的範圍、將導出成員移到另一個父系或定義不同的 `solveorder`。</span><span class="sxs-lookup"><span data-stu-id="1b27d-188">Updates cannot change the scope of the calculated member, move the calculated member to a different parent, or define a different `solveorder`.</span></span>  
  
 <span data-ttu-id="1b27d-189">CREATE SET 命令可利用 `caption` 屬性、`display_folder` 屬性和新的 `STATIC | DYNAMIC` 關鍵字來增強。</span><span class="sxs-lookup"><span data-stu-id="1b27d-189">The CREATE SET command is enhanced with the `caption` property, the `display_folder` property, and the new `STATIC | DYNAMIC` keyword.</span></span> <span data-ttu-id="1b27d-190">[*靜態*] 表示只有在建立時才會評估集合。</span><span class="sxs-lookup"><span data-stu-id="1b27d-190">*Static* means that set is evaluated only at creation time.</span></span> <span data-ttu-id="1b27d-191">*動態*表示每次在查詢中使用集合時，就會評估集合。</span><span class="sxs-lookup"><span data-stu-id="1b27d-191">*Dynamic* means that the set is evaluated every time that the set is used in a query.</span></span> <span data-ttu-id="1b27d-192">如果省略關鍵字，預設值會是 `STATIC`。</span><span class="sxs-lookup"><span data-stu-id="1b27d-192">The default value is `STATIC` if a keyword is omitted.</span></span>  
  
 <span data-ttu-id="1b27d-193">CREATE KPI 和 DROP KPI 命令會加入到 MDX 語法。</span><span class="sxs-lookup"><span data-stu-id="1b27d-193">CREATE KPI and DROP KPI commands are added to the MDX syntax.</span></span> <span data-ttu-id="1b27d-194">KPI 可以從任何 MDX 指令碼動態建立。</span><span class="sxs-lookup"><span data-stu-id="1b27d-194">KPIs can be created dynamically from any MDX script.</span></span>  
  
### <a name="schema-rowsets-extensions"></a><span data-ttu-id="1b27d-195">結構描述資料列集延伸模組</span><span class="sxs-lookup"><span data-stu-id="1b27d-195">Schema Rowsets extensions</span></span>  
 <span data-ttu-id="1b27d-196">在 [MDSCHEMA_MEMBERS*範圍*] 資料行上加入。</span><span class="sxs-lookup"><span data-stu-id="1b27d-196">On MDSCHEMA_MEMBERS *scope* column is added.</span></span> <span data-ttu-id="1b27d-197">範圍值如下：MDMEMBER_SCOPE_GLOBAL=1、MDMEMBER_SCOPE_SESSION=2。</span><span class="sxs-lookup"><span data-stu-id="1b27d-197">Scope values are as follows: MDMEMBER_SCOPE_GLOBAL=1, MDMEMBER_SCOPE_SESSION=2.</span></span>  
  
 <span data-ttu-id="1b27d-198">在 MDSCHEMA_SETS *set_evaluation_coNtext* ] 資料行上加入。</span><span class="sxs-lookup"><span data-stu-id="1b27d-198">On MDSCHEMA_SETS *set_evaluation_context* column is added.</span></span> <span data-ttu-id="1b27d-199">設定評估內容值，如下所示：MDSET_RESOLUTION_STATIC = 1、MDSET_RESOLUTION_DYNAMIC = 2。</span><span class="sxs-lookup"><span data-stu-id="1b27d-199">Set evaluation context values are as follows: MDSET_RESOLUTION_STATIC = 1, MDSET_RESOLUTION_DYNAMIC = 2.</span></span>  
  
 <span data-ttu-id="1b27d-200">加入 On MDSCHEMA_KPIS 範圍資料行。</span><span class="sxs-lookup"><span data-stu-id="1b27d-200">On MDSCHEMA_KPIS scope column is added.</span></span> <span data-ttu-id="1b27d-201">範圍值如下所示：MDKPI_SCOPE_GLOBAL=1、MDKPI_SCOPE_SESSION=2。</span><span class="sxs-lookup"><span data-stu-id="1b27d-201">Scope values are as follows: MDKPI_SCOPE_GLOBAL=1, MDKPI_SCOPE_SESSION=2.</span></span>  
  
  
