---
title: Analysis Services 開發的用戶端架構需求 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- local mining models [Analysis Services]
- Analysis Services, architecture
- providers [Analysis Services]
- data pumps [Analysis Services]
- client architecture [Analysis Services]
- local cubes [Analysis Services]
ms.assetid: 03a8eb6b-159f-4a0a-afbe-06a2424b6090
author: minewiskan
ms.author: owend
ms.openlocfilehash: d1dae97cc76eb09ce0ac4ef9d61d571a6d10c1bc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87598594"
---
# <a name="client-architecture-requirements-for-analysis-services-development"></a><span data-ttu-id="6cd93-102">Analysis Services 開發的用戶端架構需求</span><span class="sxs-lookup"><span data-stu-id="6cd93-102">Client Architecture Requirements for Analysis Services Development</span></span>
  [!INCLUDE[msCoName](../../../includes/msconame-md.md)]<span data-ttu-id="6cd93-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 支援瘦用戶端架構。</span><span class="sxs-lookup"><span data-stu-id="6cd93-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] supports a thin-client architecture.</span></span> <span data-ttu-id="6cd93-104">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]計算引擎完全以伺服器為基礎，因此會在伺服器上解析所有查詢。</span><span class="sxs-lookup"><span data-stu-id="6cd93-104">The [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] calculation engine is entirely server-based, so all queries are resolved on the server.</span></span> <span data-ttu-id="6cd93-105">所以，每一個查詢只需要用戶端和伺服器之間單次往返，使得查詢越來越複雜時可擴充效能。</span><span class="sxs-lookup"><span data-stu-id="6cd93-105">As a result, only a single round trip between the client and the server is required for each query, resulting in scalable performance as queries increase in complexity.</span></span>

 <span data-ttu-id="6cd93-106">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 的原生通訊協定是 XML for Analysis (XML/A)。</span><span class="sxs-lookup"><span data-stu-id="6cd93-106">The native protocol for [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] is XML for Analysis (XML/A).</span></span> [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] <span data-ttu-id="6cd93-107">為用戶端應用程式提供數個資料存取介面，但所有這些元件均使用 XML for Analysis 與 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 的執行個體進行通訊。</span><span class="sxs-lookup"><span data-stu-id="6cd93-107">provides several data access interfaces for client applications, but all of these components communicate with an instance of [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] using XML for Analysis.</span></span>

 <span data-ttu-id="6cd93-108">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 提供數個不同的提供者，來支援不同的程式設計語言。</span><span class="sxs-lookup"><span data-stu-id="6cd93-108">Several different providers are provided with [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] to support different programming languages.</span></span> <span data-ttu-id="6cd93-109">提供者與 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 伺服器的通訊方式，是透過 Internet Information Services (IIS)，經由 TCP/IP 或 HTTP 來傳送和接收 SOAP 封包中的 XML for Analysis。</span><span class="sxs-lookup"><span data-stu-id="6cd93-109">A provider communicates with an [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] server by sending and receiving XML for Analysis in SOAP packets over TCP/IP or over HTTP through Internet Information Services (IIS).</span></span> <span data-ttu-id="6cd93-110">HTTP 連接使用 IIS 具現化的 COM 物件，叫作資料幫浦，做為 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 資料的導管。</span><span class="sxs-lookup"><span data-stu-id="6cd93-110">An HTTP connection uses a COM object instantiated by IIS, called a data pump, which acts as a conduit for [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] data.</span></span> <span data-ttu-id="6cd93-111">資料幫浦絕不會檢查 HTTP 資料流所包含的基礎資料，任何基礎資料結構也不可以供資料程式庫本身的任何程式碼使用。</span><span class="sxs-lookup"><span data-stu-id="6cd93-111">The data pump does not examine the underlying data contained in the HTTP stream in any way, nor are any of the underlying data structures available to any of the code in the data library itself.</span></span>

 <span data-ttu-id="6cd93-112">![Analysis Services 的邏輯用戶端架構](../../../analysis-services/dev-guide/media/as-clientarch9.gif "Analysis Services 的邏輯用戶端架構")</span><span class="sxs-lookup"><span data-stu-id="6cd93-112">![Logical client architecture for Analysis Services](../../../analysis-services/dev-guide/media/as-clientarch9.gif "Logical client architecture for Analysis Services")</span></span>

 <span data-ttu-id="6cd93-113">Win32 用戶端應用程式可使用 OLE DB for OLAP 介面，或元件物件模型 (COM) 自動化語言的 Microsoft® ActiveX® Data Objects (ADO) 物件模型，例如 Microsoft Visual Basic®，來連接到 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="6cd93-113">Win32 client applications can connect to an [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] server using OLE DB for OLAP interfaces or the Microsoft® ActiveX® Data Objects (ADO) object model for Component Object Model (COM) automation languages, such as Microsoft Visual Basic®.</span></span> <span data-ttu-id="6cd93-114">以 .NET 語言撰寫的應用程式可使用 ADOMD.NET 連接到 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 伺服器。</span><span class="sxs-lookup"><span data-stu-id="6cd93-114">Applications coded with .NET languages can connect to an [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] server using ADOMD.NET.</span></span>

 <span data-ttu-id="6cd93-115">現有的應用程式可以在不修改的情況下，使用其中一個 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 提供者來與 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 進行通訊。</span><span class="sxs-lookup"><span data-stu-id="6cd93-115">Existing applications can communicate with [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] without modification simply by using one of the [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] providers.</span></span>

|<span data-ttu-id="6cd93-116">程式設計語言</span><span class="sxs-lookup"><span data-stu-id="6cd93-116">Programming Language</span></span>|<span data-ttu-id="6cd93-117">資料存取介面</span><span class="sxs-lookup"><span data-stu-id="6cd93-117">Data Access Interface</span></span>|
|--------------------------|---------------------------|
|<span data-ttu-id="6cd93-118">C++</span><span class="sxs-lookup"><span data-stu-id="6cd93-118">C++</span></span>|<span data-ttu-id="6cd93-119">OLE DB for OLAP</span><span class="sxs-lookup"><span data-stu-id="6cd93-119">OLE DB for OLAP</span></span>|
|<span data-ttu-id="6cd93-120">Visual Basic 6</span><span class="sxs-lookup"><span data-stu-id="6cd93-120">Visual Basic 6</span></span>|<span data-ttu-id="6cd93-121">ADO MD</span><span class="sxs-lookup"><span data-stu-id="6cd93-121">ADO MD</span></span>|
|<span data-ttu-id="6cd93-122">.NET 語言</span><span class="sxs-lookup"><span data-stu-id="6cd93-122">.NET languages</span></span>|<span data-ttu-id="6cd93-123">ADO MD.NET</span><span class="sxs-lookup"><span data-stu-id="6cd93-123">ADO MD.NET</span></span>|
|<span data-ttu-id="6cd93-124">任何支援 SOAP 的語言</span><span class="sxs-lookup"><span data-stu-id="6cd93-124">Any language that supports SOAP</span></span>|<span data-ttu-id="6cd93-125">XML for Analysis</span><span class="sxs-lookup"><span data-stu-id="6cd93-125">XML for Analysis</span></span>|

 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] <span data-ttu-id="6cd93-126">含有一個 Web 架構，具有可供小型和大型組織部署的完全可擴充中介層。</span><span class="sxs-lookup"><span data-stu-id="6cd93-126">has a Web architecture with a fully scalable middle tier for deployment by both small and large organizations.</span></span> [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] <span data-ttu-id="6cd93-127">為 Web 服務提供廣泛的中介層支援。</span><span class="sxs-lookup"><span data-stu-id="6cd93-127">provides broad middle tier support for Web services.</span></span> <span data-ttu-id="6cd93-128">OLE DB for OLAP 和 ADO MD 支援 ASP 應用程式，ADOMD.NET 支援 ASP.NET 應用程式。</span><span class="sxs-lookup"><span data-stu-id="6cd93-128">ASP applications are supported by OLE DB for OLAP and ADO MD, ASP.NET applications are supported by ADOMD.NET.</span></span> <span data-ttu-id="6cd93-129">下圖所說明的中間層可擴充至許多並行使用者。</span><span class="sxs-lookup"><span data-stu-id="6cd93-129">The middle tier, illustrated in the following figure, is scalable to many concurrent users.</span></span>

 <span data-ttu-id="6cd93-130">![中間層架構的邏輯圖表](../../../analysis-services/dev-guide/media/as-midtierarch9.gif "中間層架構的邏輯圖表")</span><span class="sxs-lookup"><span data-stu-id="6cd93-130">![Logical diagram for middle-tier architecture](../../../analysis-services/dev-guide/media/as-midtierarch9.gif "Logical diagram for middle-tier architecture")</span></span>

 <span data-ttu-id="6cd93-131">用戶端和中介層應用程式兩者都可以直接與 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 進行通訊，而毋需使用提供者。</span><span class="sxs-lookup"><span data-stu-id="6cd93-131">Both client and middle tier applications can communicate directly with [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] without using a provider.</span></span> <span data-ttu-id="6cd93-132">用戶端和中介層應用程式可經由 TCP/IP、HTTP 或 HTTPS，在 SOAP 封包中傳送 XML for Analysis。</span><span class="sxs-lookup"><span data-stu-id="6cd93-132">Client and middle tier applications may send XML for Analysis in SOAP packets over TCP/IP, HTTP, or HTTPS.</span></span> <span data-ttu-id="6cd93-133">可使用任何支援 SOAP 的語言，撰寫用戶端程式碼。</span><span class="sxs-lookup"><span data-stu-id="6cd93-133">The client may be coded using any language that supports SOAP.</span></span> <span data-ttu-id="6cd93-134">此案例中的通訊由 Internet Information Services (IIS) 使用 HTTP 來管理最簡單，不過，也需要撰寫程式碼來使用 TCP/IP 直接連接到伺服器。</span><span class="sxs-lookup"><span data-stu-id="6cd93-134">Communication in this case is most easily managed by Internet Information Services (IIS) using HTTP, although a direct connection to the server using TCP/IP may also be coded.</span></span> <span data-ttu-id="6cd93-135">這是 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 的最精簡型用戶端方案。</span><span class="sxs-lookup"><span data-stu-id="6cd93-135">This is the thinnest possible client solution for [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)].</span></span>

## <a name="analysis-services-in-tabular-or-sharepoint-mode"></a><span data-ttu-id="6cd93-136">表格式或 SharePoint 模式下的 Analysis Services</span><span class="sxs-lookup"><span data-stu-id="6cd93-136">Analysis Services in Tabular or SharePoint Mode</span></span>
 <span data-ttu-id="6cd93-137">在 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] 中，伺服器可以在表格式資料庫及發行至 SharePoint 網站之 [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] 活頁簿的 xVelocity 記憶體內部分析引擎 (VertiPaq) 模式下啟動。</span><span class="sxs-lookup"><span data-stu-id="6cd93-137">In [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)], the server can be started in xVelocity in-memory analytics engine (VertiPaq) mode for tabular databases and for [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] workbooks that have been published to a SharePoint site.</span></span>

 [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)] <span data-ttu-id="6cd93-138">和 [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)] 是建立及查詢分別使用 SharePoint 或表格式模式之記憶體中資料庫唯一支援的用戶端環境。</span><span class="sxs-lookup"><span data-stu-id="6cd93-138">and [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)] are the only client environments that are supported for creating and querying in-memory databases that use SharePoint or Tabular mode, respectively.</span></span> <span data-ttu-id="6cd93-139">使用 Excel 和工具所建立的內嵌 PowerPivot 資料庫 [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] 是包含在 excel 活頁簿中，而且會儲存為 excel .xlsx 檔案的一部分。</span><span class="sxs-lookup"><span data-stu-id="6cd93-139">The embedded PowerPivot database that you create by using the Excel and [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] tools is contained within the Excel workbook, and is saved as part of the Excel .xlsx file.</span></span>

 <span data-ttu-id="6cd93-140">不過，如果您將儲存在傳統 Cube 的資料匯入 [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] 活頁簿中，活頁簿就可以使用此資料。</span><span class="sxs-lookup"><span data-stu-id="6cd93-140">However, a [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] workbook can use data that is stored in a traditional cube if you import the cube data into the workbook.</span></span> <span data-ttu-id="6cd93-141">如果另一個 [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] 活頁簿已發行至 SharePoint 網站，您也可以從該活頁簿匯入資料。</span><span class="sxs-lookup"><span data-stu-id="6cd93-141">You can also import data from another [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] workbook if it has been published to a SharePoint site.</span></span>

> [!NOTE]
>  <span data-ttu-id="6cd93-142">當您使用 Cube 做為 [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] 活頁簿的資料來源時，從 Cube 取得的資料是定義為 MDX 查詢；不過資料是以扁平化快照集方式匯入。</span><span class="sxs-lookup"><span data-stu-id="6cd93-142">When you use a cube as a data source for a [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] workbook, the data that you get from the cube is defined as an MDX query; however, the data is imported as a flattened snapshot.</span></span> <span data-ttu-id="6cd93-143">您無法以互動方式使用資料或從 Cube 重新整理資料。</span><span class="sxs-lookup"><span data-stu-id="6cd93-143">You cannot interactively work with the data or refresh the data from the cube.</span></span>

### <a name="interfaces-for-powerpivot-client"></a><span data-ttu-id="6cd93-144">PowerPivot 用戶端的介面</span><span class="sxs-lookup"><span data-stu-id="6cd93-144">Interfaces for PowerPivot Client</span></span>
 [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)]<span data-ttu-id="6cd93-145">藉由使用 Analysis Services 的已建立介面和語言： AMO 和 ADOMD.NET，以及 MDX 和 XMLA，與 xVelocity 記憶體內部分析引擎 (VertiPaq) 儲存引擎在活頁簿內進行互動。</span><span class="sxs-lookup"><span data-stu-id="6cd93-145">interacts with the xVelocity in-memory analytics engine (VertiPaq) storage engine within the workbook by using the established interfaces and languages for Analysis Services: AMO and ADOMD.NET, and MDX and XMLA.</span></span> <span data-ttu-id="6cd93-146">在增益集內，透過類似 Excel 的公式語言，即資料分析運算式 (DAX)，來定義量值。</span><span class="sxs-lookup"><span data-stu-id="6cd93-146">Within the add-in, measures are defined by using a formula language similar to Excel, Data Analysis Expressions (DAX).</span></span> <span data-ttu-id="6cd93-147">DAX 運算式內嵌於傳送至同處理序伺服器的 XMLA 訊息。</span><span class="sxs-lookup"><span data-stu-id="6cd93-147">DAX expressions are embedded within the XMLA messages that are sent to the in-process server.</span></span>

### <a name="providers"></a><span data-ttu-id="6cd93-148">提供者</span><span class="sxs-lookup"><span data-stu-id="6cd93-148">Providers</span></span>
 <span data-ttu-id="6cd93-149">[!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)]與 Excel 之間的通訊使用 MSOLAP OLEDB 提供者 (版本 11.0) 。</span><span class="sxs-lookup"><span data-stu-id="6cd93-149">Communications between [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] and Excel use the MSOLAP OLEDB provider (version 11.0).</span></span> <span data-ttu-id="6cd93-150">在 MSOLAP 提供者內，有四個不同的模組 (或傳輸) 可用於用戶端和伺服器之間傳送訊息。</span><span class="sxs-lookup"><span data-stu-id="6cd93-150">Within the MSOLAP provider, there are four different modules, or transports, that can be used for sending messages between the client and server.</span></span>

 <span data-ttu-id="6cd93-151">**TCP/IP**用於一般的用戶端-伺服器連接。</span><span class="sxs-lookup"><span data-stu-id="6cd93-151">**TCP/IP** Used for normal client-server connections.</span></span>

 <span data-ttu-id="6cd93-152">**HTTP**用於透過 SSAS 資料幫浦服務的 HTTP 連接，或呼叫 SharePoint PowerPivot Web 服務 (WS) 元件。</span><span class="sxs-lookup"><span data-stu-id="6cd93-152">**HTTP** Used for HTTP connections via the SSAS data pump service, or by a call to the SharePoint PowerPivot Web Service (WS) component.</span></span>

 <span data-ttu-id="6cd93-153">**INPROC**用來連接到同進程引擎。</span><span class="sxs-lookup"><span data-stu-id="6cd93-153">**INPROC** Used for connections to the in-process engine.</span></span>

 <span data-ttu-id="6cd93-154">**頻道**保留以與 SharePoint 伺服器陣列中的 PowerPivot 系統服務通訊。</span><span class="sxs-lookup"><span data-stu-id="6cd93-154">**CHANNEL** Reserved for communications with the PowerPivot System Service in the SharePoint farm.</span></span>

## <a name="see-also"></a><span data-ttu-id="6cd93-155">另請參閱</span><span class="sxs-lookup"><span data-stu-id="6cd93-155">See Also</span></span>
 [<span data-ttu-id="6cd93-156">OLAP 引擎伺服器元件</span><span class="sxs-lookup"><span data-stu-id="6cd93-156">OLAP Engine Server Components</span></span>](olap-engine-server-components.md)


