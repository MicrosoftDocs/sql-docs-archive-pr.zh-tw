---
title: 建立 (SSAS 多維度) 的資料來源 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
f1_keywords:
- sql12.asvs.datasourcedesigner.f1
- sql12.asvs.sqlserverstudio.impersonationinfo.f1
- sql12.asvs.connectionmanager.f1
helpviewer_keywords:
- impersonation [Analysis Services]
- data sources [Analysis Services], creating
- security [Analysis Services], data source connections
ms.assetid: 9fab8298-10dc-45a9-9a91-0c8e6d947468
author: minewiskan
ms.author: owend
ms.openlocfilehash: 7c9ce58bbf19ab7c157fdc4f17afc6b8b7f250af
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87705637"
---
# <a name="create-a-data-source-ssas-multidimensional"></a><span data-ttu-id="77842-102">建立資料來源 (SSAS 多維度)</span><span class="sxs-lookup"><span data-stu-id="77842-102">Create a Data Source (SSAS Multidimensional)</span></span>
  <span data-ttu-id="77842-103">在 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 多維度模型中，資料來源物件代表資料來源的連接，您會從其中處理 (或匯入) 資料。</span><span class="sxs-lookup"><span data-stu-id="77842-103">In an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] multidimensional model, a data source object represents a connection to the data source from which you are processing (or importing) data.</span></span> <span data-ttu-id="77842-104">多維度模型至少必須包含一個資料來源物件，不過您可以加入更多資料來源物件，以便結合數個資料倉儲的資料。</span><span class="sxs-lookup"><span data-stu-id="77842-104">A multidimensional model must contain at least one data source object, but you can add more to combine data from several data warehouses.</span></span> <span data-ttu-id="77842-105">使用本主題中的說明為您的模型建立資料來源物件。</span><span class="sxs-lookup"><span data-stu-id="77842-105">Use the instructions in this topic to create a data source object for your model.</span></span> <span data-ttu-id="77842-106">如需設定這個物件之屬性的詳細資訊，請參閱[設定資料來源屬性 &#40;SSAS 多維度&#41;](set-data-source-properties-ssas-multidimensional.md)。</span><span class="sxs-lookup"><span data-stu-id="77842-106">For more information about setting properties on this object, see [Set Data Source Properties &#40;SSAS Multidimensional&#41;](set-data-source-properties-ssas-multidimensional.md).</span></span>  
  
 <span data-ttu-id="77842-107">這個主題包括下列各節：</span><span class="sxs-lookup"><span data-stu-id="77842-107">This topic includes the following sections:</span></span>  
  
 [<span data-ttu-id="77842-108">選擇 Data Provider</span><span class="sxs-lookup"><span data-stu-id="77842-108">Choose a Data Provider</span></span>](#bkmk_provider)  
  
 [<span data-ttu-id="77842-109">設定認證和模擬選項</span><span class="sxs-lookup"><span data-stu-id="77842-109">Set Credentials and Impersonation Options</span></span>](#bkmk_impersonation)  
  
 [<span data-ttu-id="77842-110">檢視或編輯連接屬性</span><span class="sxs-lookup"><span data-stu-id="77842-110">View or Edit Connection Properties</span></span>](#bkmk_ConnectionString)  
  
 [<span data-ttu-id="77842-111">使用資料來源精靈建立資料來源</span><span class="sxs-lookup"><span data-stu-id="77842-111">Create a Data Source Using the Data Source Wizard</span></span>](#bkmk_steps)  
  
 [<span data-ttu-id="77842-112">使用現有的連接建立資料來源</span><span class="sxs-lookup"><span data-stu-id="77842-112">Create a Data Source Using an Existing Connection</span></span>](#bkmk_connection)  
  
 [<span data-ttu-id="77842-113">將多個資料來源加入至模型</span><span class="sxs-lookup"><span data-stu-id="77842-113">Add Multiple Data Sources to a Model</span></span>](#bkmk_multipleDS)  
  
##  <a name="choose-a-data-provider"></a><a name="bkmk_provider"></a> <span data-ttu-id="77842-114">選擇資料提供者</span><span class="sxs-lookup"><span data-stu-id="77842-114">Choose a Data Provider</span></span>  
 <span data-ttu-id="77842-115">您可以使用 Managed [!INCLUDE[msCoName](../../includes/msconame-md.md)] .NET Framework 或原生 OLE DB 提供者進行連接。</span><span class="sxs-lookup"><span data-stu-id="77842-115">You can connect using a managed [!INCLUDE[msCoName](../../includes/msconame-md.md)] .NET Framework or native OLE DB provider.</span></span> <span data-ttu-id="77842-116">建議之 SQL Server 資料來源的資料提供者是 SQL Server Native Client，因為其通常提供較佳的效能。</span><span class="sxs-lookup"><span data-stu-id="77842-116">The recommended data provider for SQL Server data sources is SQL Server Native Client because it typically offers better performance.</span></span>  
  
 <span data-ttu-id="77842-117">若為 Oracle 及其他協力廠商資料來源，請檢查協力廠商是否提供原生 OLE DB 提供者，並先嘗試此原生 OLE DB 提供者。</span><span class="sxs-lookup"><span data-stu-id="77842-117">For Oracle and other third-party data sources, check whether the third-party provides a native OLE DB provider and try that first.</span></span> <span data-ttu-id="77842-118">如果發生錯誤，請嘗試 [連接管理員] 中列出的其他 .NET 提供者或原生 OLE DB 提供者。</span><span class="sxs-lookup"><span data-stu-id="77842-118">If you encounter errors, try one of the other .NET providers or native OLE DB providers listed in Connection Manager.</span></span> <span data-ttu-id="77842-119">確定您使用的任何資料提供者，已安裝在用來開發及執行 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 方案的所有電腦上。</span><span class="sxs-lookup"><span data-stu-id="77842-119">Be sure that any data provider you use is installed on all computers used to develop and run the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] solution.</span></span>  
  
##  <a name="set-credentials-and-impersonation-options"></a><a name="bkmk_impersonation"></a> <span data-ttu-id="77842-120">設定認證和模擬選項</span><span class="sxs-lookup"><span data-stu-id="77842-120">Set Credentials and Impersonation Options</span></span>  
 <span data-ttu-id="77842-121">資料來源連接有時可以使用 Windows 驗證或資料庫管理系統提供的驗證服務，例如連接至 SQL Azure 資料庫時使用 SQL Server 驗證。</span><span class="sxs-lookup"><span data-stu-id="77842-121">A data source connection can sometimes use Windows authentication or an authentication service provided by the database management system, such as SQL Server authentication when connecting to SQL Azure databases.</span></span> <span data-ttu-id="77842-122">您指定的帳戶必須擁有遠端資料庫伺服器的登入及外部資料庫的讀取權限。</span><span class="sxs-lookup"><span data-stu-id="77842-122">The account you specify must have a login on the remote database server and read permissions on the external database.</span></span>  
  
### <a name="windows-authentication"></a><span data-ttu-id="77842-123">Windows 驗證</span><span class="sxs-lookup"><span data-stu-id="77842-123">Windows Authentication</span></span>  
 <span data-ttu-id="77842-124">使用 Windows 驗證的連接會在資料來源設計師的 [模擬資訊]\*\*\*\* 索引標籤中指定。</span><span class="sxs-lookup"><span data-stu-id="77842-124">Connections that use Windows authentication are specified on the **Impersonation Information** tab of the Data Source Designer.</span></span> <span data-ttu-id="77842-125">使用這個索引標籤即可選擇模擬選項，以指定連接至外部資料來源時，執行 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 的帳戶。</span><span class="sxs-lookup"><span data-stu-id="77842-125">Use this tab to choose the impersonation option that specifies the account under which [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] runs when connecting to the external data source.</span></span> <span data-ttu-id="77842-126">並非所有選項都可以在所有案例中使用。</span><span class="sxs-lookup"><span data-stu-id="77842-126">Not all options can be used in all scenarios.</span></span> <span data-ttu-id="77842-127">如需這些選項及何時使用這些選項的詳細資訊，請參閱[設定模擬選項 &#40;SSAS - 多維度&#41;](set-impersonation-options-ssas-multidimensional.md)。</span><span class="sxs-lookup"><span data-stu-id="77842-127">For more information about these options and when to use them, see [Set Impersonation Options &#40;SSAS - Multidimensional&#41;](set-impersonation-options-ssas-multidimensional.md).</span></span>  
  
### <a name="database-authentication"></a><span data-ttu-id="77842-128">資料庫驗證</span><span class="sxs-lookup"><span data-stu-id="77842-128">Database Authentication</span></span>  
 <span data-ttu-id="77842-129">若不使用 Windows 驗證，您也可以指定連接使用資料庫管理系統所提供的驗證服務。</span><span class="sxs-lookup"><span data-stu-id="77842-129">As an alternative to Windows authentication, you can specify a connection that uses an authentication service provided by the database management system.</span></span> <span data-ttu-id="77842-130">在某些情況下，需要使用資料庫驗證。</span><span class="sxs-lookup"><span data-stu-id="77842-130">In some cases, using database authentication is required.</span></span> <span data-ttu-id="77842-131">呼叫使用資料庫驗證的案例包括使用 SQL Server 驗證連接到 Azure SQL Database，或存取在不同作業系統或不信任的網域中執行的關聯式資料來源。</span><span class="sxs-lookup"><span data-stu-id="77842-131">Scenarios that call for using database authentication include using SQL Server authentication to connect to an Azure SQL Database, or accessing a relational data source that runs on a different operating system or in a non-trusted domain.</span></span>  
  
 <span data-ttu-id="77842-132">對於使用資料庫驗證的資料來源，會在連接字串中指定資料庫登入的使用者名稱和密碼。</span><span class="sxs-lookup"><span data-stu-id="77842-132">For a data source that uses database authentication, the username and password of a database login is specified on the connection string.</span></span> <span data-ttu-id="77842-133">若在 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 模型中設定資料來源連接，當您於 [連接管理員] 中輸入使用者名稱和密碼時，即會將認證新增至連接字串。</span><span class="sxs-lookup"><span data-stu-id="77842-133">Credentials are added to the connection string when you enter a user name and password in Connection Manager when setting up the data source connection in your [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] model.</span></span> <span data-ttu-id="77842-134">記得指定具有資料讀取權限的使用者識別。</span><span class="sxs-lookup"><span data-stu-id="77842-134">Remember to specify a user identity that has read permissions to the data.</span></span>  
  
 <span data-ttu-id="77842-135">擷取資料時，建立連接的用戶端程式庫會構成在連接字串中包含認證的連接要求。</span><span class="sxs-lookup"><span data-stu-id="77842-135">When retrieving data, the client library making the connection formulates a connection request that includes the credentials in the connection string.</span></span> <span data-ttu-id="77842-136">[模擬資訊] 索引標籤中的 Windows 驗證認證選項不會用於連接，但可用於其他作業，例如存取本機電腦上的資源。</span><span class="sxs-lookup"><span data-stu-id="77842-136">Windows authentication credential options in the Impersonation Information tab are not used in the connection, but can be used for other operations, such as accessing resources on the local computer.</span></span> <span data-ttu-id="77842-137">如需詳細資訊，請參閱[設定模擬選項 &#40;SSAS - 多維度&#41;](set-impersonation-options-ssas-multidimensional.md)。</span><span class="sxs-lookup"><span data-stu-id="77842-137">For more information, see [Set Impersonation Options &#40;SSAS - Multidimensional&#41;](set-impersonation-options-ssas-multidimensional.md).</span></span>  
  
 <span data-ttu-id="77842-138">在模型中儲存資料來源物件之後，即會加密連接字串和密碼。</span><span class="sxs-lookup"><span data-stu-id="77842-138">After you save the data source object in your model, the connection string and password are encrypted.</span></span>  <span data-ttu-id="77842-139">基於安全性的理由，當您後續在工具、指令碼或程式碼中檢視時，會隱藏連接字串中的密碼。</span><span class="sxs-lookup"><span data-stu-id="77842-139">For security purposes, all visible traces of the password are removed from the connection string when you subsequently view it in tools, script, or code.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="77842-140">依預設， [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] 不會在連接字串中儲存密碼。</span><span class="sxs-lookup"><span data-stu-id="77842-140">By default, [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] does not save passwords with the connection string.</span></span> <span data-ttu-id="77842-141">如果未儲存此密碼， [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 會在需要時提示您輸入密碼。</span><span class="sxs-lookup"><span data-stu-id="77842-141">If the password is not saved, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] prompts you to enter the password when it is needed.</span></span> <span data-ttu-id="77842-142">如果您選擇儲存密碼，此密碼會以加密格式儲存在資料連接字串中。</span><span class="sxs-lookup"><span data-stu-id="77842-142">If you choose to save the password, the password is stored in encrypted format in the data connection string.</span></span> [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="77842-143">會使用包含資料來源之資料庫的資料庫加密金鑰來加密資料來源的密碼資訊。</span><span class="sxs-lookup"><span data-stu-id="77842-143">encrypts password information for data sources using the database encryption key of the database that contains the data source.</span></span> <span data-ttu-id="77842-144">將連接資訊加密之後，您必須使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 組態管理員來變更 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 服務帳戶或密碼，否則將無法復原加密的資訊。</span><span class="sxs-lookup"><span data-stu-id="77842-144">With encrypted connection information, you must use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Configuration Manager to change the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] service account or password or the encrypted information cannot be recovered.</span></span> <span data-ttu-id="77842-145">如需詳細資訊，請參閱 [SQL Server 組態管理員](../../relational-databases/sql-server-configuration-manager.md)。</span><span class="sxs-lookup"><span data-stu-id="77842-145">For more information, see [SQL Server Configuration Manager](../../relational-databases/sql-server-configuration-manager.md).</span></span>  
  
### <a name="defining-impersonation-information-for-data-mining-objects"></a><span data-ttu-id="77842-146">定義資料採礦物件的模擬資訊</span><span class="sxs-lookup"><span data-stu-id="77842-146">Defining Impersonation Information for Data Mining Objects</span></span>  
 <span data-ttu-id="77842-147">資料採礦查詢可以在 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 服務帳戶的內容中執行，但是也可以在使用者提交查詢的內容或指定之使用者的內容中執行；</span><span class="sxs-lookup"><span data-stu-id="77842-147">Data mining queries may be executed in the context of the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] service account, but may also be executed in the context of the user submitting the query or in the context of a specified user.</span></span> <span data-ttu-id="77842-148">查詢執行所在的內容可能會影響查詢結果。</span><span class="sxs-lookup"><span data-stu-id="77842-148">The context in which a query is executed may affect query results.</span></span> <span data-ttu-id="77842-149">如果是資料採礦 `OPENQUERY` 類型的作業，您可能會希望資料採礦查詢在目前使用者的內容或指定之使用者的內容中執行 (不論執行查詢的使用者是誰)，而不是在此服務帳戶的內容中執行，</span><span class="sxs-lookup"><span data-stu-id="77842-149">For data mining `OPENQUERY` type operations, you may want the data mining query to execute in the context of the current user or in the context of a specified user (regardless of the user executing the query) rather than in the context of the service account.</span></span> <span data-ttu-id="77842-150">如此可使用有限的安全性認證來執行查詢。</span><span class="sxs-lookup"><span data-stu-id="77842-150">This enables the query to be executed with limited security credentials.</span></span> <span data-ttu-id="77842-151">如果您希望 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 模擬目前的使用者或是模擬指定的使用者，請選取 [使用特定的使用者名稱和密碼]\*\*\*\* 或 [使用目前使用者的認證]\*\*\*\* 選項。</span><span class="sxs-lookup"><span data-stu-id="77842-151">If you want [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] to impersonate the current user or to impersonate a specified user, select either the **Use a specific user name and password** or **Use the credentials of the current user** option.</span></span>  
  
##  <a name="create-a-data-source-using-the-data-source-wizard"></a><a name="bkmk_steps"></a><span data-ttu-id="77842-152">使用資料來源建立資料來源 Wizard</span><span class="sxs-lookup"><span data-stu-id="77842-152">Create a Data Source Using the Data Source Wizard</span></span>  
  
1.  <span data-ttu-id="77842-153">在 [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)]中，開啟您想要在其中定義資料來源的 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 專案，或是連接到您想要在其中定義資料來源的 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 資料庫。</span><span class="sxs-lookup"><span data-stu-id="77842-153">In [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)], open the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] project or connect to the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database in which you want to define the data source.</span></span>  
  
2.  <span data-ttu-id="77842-154">在**方案總管**中，以滑鼠右鍵按一下 [資料來源]\*\*\*\* 資料夾，然後按一下 [新增資料來源]\*\*\*\* 啟動 [資料來源精靈]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="77842-154">In **Solution Explorer**, right-click the **Data Sources** folder, and then click **New Data Source** to start the **Data Source Wizard**.</span></span>  
  
3.  <span data-ttu-id="77842-155">在 [選取如何定義連接]\*\*\*\* 頁面上，選擇 [依據現有的或新的連接建立資料來源]\*\*\*\*，然後按一下 [新增]\*\*\*\* 開啟 [連線管理員]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="77842-155">On the **Select how to define the connection** page, choose **Create a data source based on an existing or new connection** and then click **New** to open **Connection Manager**.</span></span>  
  
     <span data-ttu-id="77842-156">新的連接是在連接管理員中建立。</span><span class="sxs-lookup"><span data-stu-id="77842-156">New connections are created in Connection Manager.</span></span> <span data-ttu-id="77842-157">在連接管理員中選取提供者，然後指定該提供者用來連接基礎資料的連接字串屬性。</span><span class="sxs-lookup"><span data-stu-id="77842-157">In Connection Manager, you select a provider and then specify the connection string properties used by that provider to connect to the underlying data.</span></span> <span data-ttu-id="77842-158">所需的確切資訊需視所選的提供者而定，但是這類資訊通常包括伺服器或服務執行個體、用來登入此伺服器或服務執行個體的資訊、資料庫或檔案名稱，以及其他提供者特有的設定。</span><span class="sxs-lookup"><span data-stu-id="77842-158">The exact information required depends upon the provider selected, but generally such information includes a server or service instance, information for logging on to the server or service instance, a database or file name, and other provider-specific settings.</span></span> <span data-ttu-id="77842-159">在此程式的其餘部分，我們會假設有一個 SQL Server 的資料庫連接。</span><span class="sxs-lookup"><span data-stu-id="77842-159">For the remainder of this procedure, we'll assume a SQL Server database connection.</span></span>  
  
4.  <span data-ttu-id="77842-160">選取連接所用的 [!INCLUDE[msCoName](../../includes/msconame-md.md)] .NET Framework 或原生 OLE DB 提供者。</span><span class="sxs-lookup"><span data-stu-id="77842-160">Select the [!INCLUDE[msCoName](../../includes/msconame-md.md)] .NET Framework or native OLE DB provider to use for the connection.</span></span>  
  
     <span data-ttu-id="77842-161">新連接的預設提供者為原生 OLE DB\\[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 提供者。</span><span class="sxs-lookup"><span data-stu-id="77842-161">The default provider for a new connection is the Native OLE DB\\[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client provider.</span></span> <span data-ttu-id="77842-162">此提供者是用來連接到使用 OLE DB 的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Database Engine 執行個體。</span><span class="sxs-lookup"><span data-stu-id="77842-162">This provider is used to connect to a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Database Engine instance using OLE DB.</span></span> <span data-ttu-id="77842-163">若要連接到 SQL Server 關聯式資料庫，使用原生 OLE DB\SQL Server Native Client 11.0 通常會比使用其他提供者更快。</span><span class="sxs-lookup"><span data-stu-id="77842-163">For connections to a SQL Server relational database, using Native OLE DB\SQL Server Native Client 11.0 is often faster than using alternative providers.</span></span>  
  
     <span data-ttu-id="77842-164">您可以選擇不同的提供者來存取其他資料來源。</span><span class="sxs-lookup"><span data-stu-id="77842-164">You can choose a different provider to access other data sources.</span></span> <span data-ttu-id="77842-165">如需所支援的提供者和關係資料庫清單 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] ，請參閱[&#40;SSAS 多維度&#41;支援的資料來源](supported-data-sources-ssas-multidimensional.md)。</span><span class="sxs-lookup"><span data-stu-id="77842-165">For a list of the providers and relational databases supported by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], see [Data Sources Supported &#40;SSAS Multidimensional&#41;](supported-data-sources-ssas-multidimensional.md).</span></span>  
  
5.  <span data-ttu-id="77842-166">輸入選定提供者所要求的資訊，以連接到基礎資料來源。</span><span class="sxs-lookup"><span data-stu-id="77842-166">Enter the information requested by the selected provider to connect to the underlying data source.</span></span> <span data-ttu-id="77842-167">如果已選取 **原生 OLE DB\SQL Server Native Client** 提供者，請輸入下列資訊：</span><span class="sxs-lookup"><span data-stu-id="77842-167">If the **Native OLE DB\SQL Server Native Client** provider is selected, enter the following information:</span></span>  
  
    1.  <span data-ttu-id="77842-168">[伺服器名稱]\*\*\*\* 是 Database Engine 執行個體的網路名稱。</span><span class="sxs-lookup"><span data-stu-id="77842-168">**Server Name** is the network name of the Database Engine instance.</span></span> <span data-ttu-id="77842-169">您可以將它指定為 IP 位址、電腦的 NETBIOS 名稱或完整網域名稱。</span><span class="sxs-lookup"><span data-stu-id="77842-169">It can be specified as the IP address, the NETBIOS name of the computer, or a fully qualified domain name.</span></span> <span data-ttu-id="77842-170">如果伺服器安裝為已命名的實例，您必須將實例名稱包含 (例如， \<computername> \\<instancename \>) 。</span><span class="sxs-lookup"><span data-stu-id="77842-170">If the server is installed as a named instance, you must include the instance name (for example, \<computername>\\<instancename\>).</span></span>  
  
    2.  <span data-ttu-id="77842-171">[登入伺服器]\*\*\*\* 會指定驗證連接的方式。</span><span class="sxs-lookup"><span data-stu-id="77842-171">**Log on to the Server** specifies how the connection will be authentication.</span></span> <span data-ttu-id="77842-172">[使用 Windows 驗證]\*\*\*\* 會使用 Windows 驗證。</span><span class="sxs-lookup"><span data-stu-id="77842-172">**Use Windows Authentication** uses Windows authentication.</span></span> <span data-ttu-id="77842-173">**使用 SQL Server 驗證**會指定 Azure SQL 資料庫的資料庫使用者登入，或支援混合模式驗證的 SQL Server 實例。</span><span class="sxs-lookup"><span data-stu-id="77842-173">**Use SQL Server Authentication** specifies a database user login for an Azure SQL databases or a SQL Server instance that supports mixed mode authentication.</span></span>  
  
        > [!IMPORTANT]  
        >  <span data-ttu-id="77842-174">[連線管理員] 會針對使用 SQL Server 驗證的連接加入 [儲存我的密碼]\*\*\*\* 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="77842-174">Connection Manager includes a **Save my password** checkbox for connections that use SQL Server authentication.</span></span> <span data-ttu-id="77842-175">雖然系統一定會顯示此核取方塊，但是不一定會使用它。</span><span class="sxs-lookup"><span data-stu-id="77842-175">Although the checkbox is always visible, it is not always used.</span></span>  
        >   
        >  <span data-ttu-id="77842-176">Analysis Services 不使用此核取方塊的狀況包括重新整理或處理作用中 Analysis Services 資料庫所使用的 SQL Server 關聯式資料。</span><span class="sxs-lookup"><span data-stu-id="77842-176">Conditions under which Analysis Services does not use this checkbox include refreshing or processing the SQL Server relational data used in active Analysis Services database.</span></span> <span data-ttu-id="77842-177">不論您清除或選取 [儲存我的密碼]\*\*\*\*，Analysis Services 一定會加密並儲存密碼。</span><span class="sxs-lookup"><span data-stu-id="77842-177">Regardless of whether you clear or select **Save my password**, Analysis Services will always encrypt and save the password.</span></span> <span data-ttu-id="77842-178">密碼將經過加密並且同時儲存在 .abf 和資料檔案中。</span><span class="sxs-lookup"><span data-stu-id="77842-178">The password is encrypted and stored in both .abf and data files.</span></span> <span data-ttu-id="77842-179">這種行為存在的原因是，Analysis Services 不支援在伺服器上儲存工作階段架構的密碼。</span><span class="sxs-lookup"><span data-stu-id="77842-179">This behavior exists because Analysis Services does not support session-based password storage on the server.</span></span>  
        >   
        >  <span data-ttu-id="77842-180">這種行為僅適用於 a) 保存在 Analysis Services 伺服器執行個體上的資料庫，以及 b) 使用 SQL Server 驗證來重新整理或處理關聯式資料的資料庫。</span><span class="sxs-lookup"><span data-stu-id="77842-180">This behavior only applies to databases that a) are persisted on an Analysis Services server instance, and b) use SQL Server authentication to refresh or process relational data.</span></span> <span data-ttu-id="77842-181">它不適用於您在 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] 中設定而且僅用於工作階段持續時間的資料來源連接。</span><span class="sxs-lookup"><span data-stu-id="77842-181">It is does not apply to data source connections that you set up in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] that are used only for the duration of a session.</span></span> <span data-ttu-id="77842-182">雖然您無法移除已經儲存的密碼，不過可以使用不同的認證或 Windows 驗證來覆寫目前與資料庫一起儲存的使用者資訊。</span><span class="sxs-lookup"><span data-stu-id="77842-182">While there is no way to remove a password that is already stored, you can use different credentials, or Windows authentication, to overwrite the user information that is currently stored with the database.</span></span>  
  
    3.  <span data-ttu-id="77842-183">[選取或輸入資料庫名稱]\*\*\*\* 或 [附加資料庫檔案]\*\*\*\* 是用來指定資料庫。</span><span class="sxs-lookup"><span data-stu-id="77842-183">**Select or enter a database name** or **Attach a database file** are used to specify the database.</span></span>  
  
    4.  <span data-ttu-id="77842-184">在此對話方塊的左側按一下 [全部]\*\*\*\*，即可檢視這個連接的其他設定，包括這個提供者的所有預設值。</span><span class="sxs-lookup"><span data-stu-id="77842-184">In the left side of the dialog box, click **All** to view additional settings for this connection, including all default settings for this provider.</span></span>  
  
    5.  <span data-ttu-id="77842-185">依適當情況變更環境的設定，然後按一下 [確定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="77842-185">Change settings as appropriate for your environment and then click **OK**.</span></span>  
  
         <span data-ttu-id="77842-186">新的連接即會出現在「資料來源精靈」之 [選取如何定義連接]\*\*\*\* 頁面的 [資料連接]\*\*\*\* 窗格中。</span><span class="sxs-lookup"><span data-stu-id="77842-186">The new connection appears in the **Data Connection** pane of the **Select how to define the connection** page of the Data Source Wizard.</span></span>  
  
6.  <span data-ttu-id="77842-187">按 [下一步] 。</span><span class="sxs-lookup"><span data-stu-id="77842-187">Click **Next**.</span></span>  
  
7.  <span data-ttu-id="77842-188">在 [模擬資訊]\*\*\*\* 中，指定 Analysis Services 連接外部資料來源時使用的 Windows 認證或使用者識別。</span><span class="sxs-lookup"><span data-stu-id="77842-188">In **Impersonation Information**, specify the Windows credentials or user identity that Analysis Services will use when connecting to the external data source.</span></span> <span data-ttu-id="77842-189">如果您針對連接使用資料庫驗證，則會忽略這些設定。</span><span class="sxs-lookup"><span data-stu-id="77842-189">If you are using database authentication, these settings are ignored for connection purposes.</span></span>  
  
     <span data-ttu-id="77842-190">根據您使用資料來源的方式而定，選擇模擬選項的指導方針會有所不同。</span><span class="sxs-lookup"><span data-stu-id="77842-190">Guidelines for choosing an impersonation option vary depending on how you are using the data source.</span></span> <span data-ttu-id="77842-191">如果是處理工作， [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 服務在連接到資料來源時，必須在其服務帳戶或指定之使用者帳戶的安全性內容中執行。</span><span class="sxs-lookup"><span data-stu-id="77842-191">For processing tasks, the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] service must run in the security context of its service account or a specified user account when connecting to a data source.</span></span>  
  
    -   <span data-ttu-id="77842-192">[使用特定的 Windows 使用者名稱和密碼]\*\*\*\* 會指定一組唯一的最低權限認證。</span><span class="sxs-lookup"><span data-stu-id="77842-192">**Use a specific Windows user name and password** to specify a unique set of least privilege credentials.</span></span>  
  
    -   <span data-ttu-id="77842-193">[使用服務帳戶]\*\*\*\* 會使用服務識別處理資料。</span><span class="sxs-lookup"><span data-stu-id="77842-193">**Use the service account** to process the data using the service identity.</span></span>  
  
     <span data-ttu-id="77842-194">您指定的帳戶必須擁有資料來源的讀取權限。</span><span class="sxs-lookup"><span data-stu-id="77842-194">The account you specify must have Read permissions on the data source.</span></span>  
  
8.  <span data-ttu-id="77842-195">按 [下一步] 。</span><span class="sxs-lookup"><span data-stu-id="77842-195">Click **Next**.</span></span>  <span data-ttu-id="77842-196">在 [正在完成精靈]\*\*\*\* 中，輸入資料來源名稱或使用預設名稱。</span><span class="sxs-lookup"><span data-stu-id="77842-196">In **Completing the Wizard**, enter a data source name or use the default name.</span></span> <span data-ttu-id="77842-197">預設名稱是連接中所指定資料庫的名稱。</span><span class="sxs-lookup"><span data-stu-id="77842-197">The default name is the name of the database specified in the connection.</span></span> <span data-ttu-id="77842-198">[預覽]\*\*\*\* 窗格會顯示這個新資料來源的連接字串。</span><span class="sxs-lookup"><span data-stu-id="77842-198">The **Preview** pane displays the connection string for this new data source.</span></span>  
  
9. <span data-ttu-id="77842-199">按一下 [完成] 。</span><span class="sxs-lookup"><span data-stu-id="77842-199">Click **Finish**.</span></span>  <span data-ttu-id="77842-200">方案總管中的 [資料來源]\*\*\*\* 資料夾會顯示新的資料來源。</span><span class="sxs-lookup"><span data-stu-id="77842-200">The new data source appears in the **Data Sources** folder in Solution Explorer.</span></span>  
  
##  <a name="create-a-data-source-using-an-existing-connection"></a><a name="bkmk_connection"></a><span data-ttu-id="77842-201">使用現有的連接建立資料來源</span><span class="sxs-lookup"><span data-stu-id="77842-201">Create a Data Source Using an Existing Connection</span></span>  
 <span data-ttu-id="77842-202">當您在 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 專案中工作時，您的資料來源可以根據方案中的現有資料來源，也可以根據 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 專案。</span><span class="sxs-lookup"><span data-stu-id="77842-202">When you work in an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] project, your data source can be based on an existing data source in your solution or can be based on an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] project.</span></span> <span data-ttu-id="77842-203">[資料來源精靈] 提供幾個選項用於建立資料來源物件，包括使用相同專案中的現有連接。</span><span class="sxs-lookup"><span data-stu-id="77842-203">The Data Source Wizard provides several options for creating the data source object, including using an existing connection in the same project.</span></span>  
  
-   <span data-ttu-id="77842-204">根據方案中的現有資料來源來建立資料來源時，可讓您定義與現有資料來源同步的資料來源。</span><span class="sxs-lookup"><span data-stu-id="77842-204">Creating a data source based on an existing data source in your solution lets you define a data source that is synchronized with the existing data source.</span></span> <span data-ttu-id="77842-205">當建立包含這個新資料來源的專案時，會使用基礎資料來源中的資料來源設定。</span><span class="sxs-lookup"><span data-stu-id="77842-205">When the project containing this new data source is built, the data source settings from the underlying data source are used.</span></span>  
  
-   <span data-ttu-id="77842-206">根據 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 專案建立資料來源時，可讓您參考目前專案中方案內的另一個 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 專案。</span><span class="sxs-lookup"><span data-stu-id="77842-206">Creating a data source based on an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] project lets you reference another [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] project in the solution in the current project.</span></span> <span data-ttu-id="77842-207">新的資料來源會搭配其 `Data Source` 屬性和 `Initial Catalog` 屬性 (從選定專案的 `TargetServer` 和 `TargetDatabase` 屬性取得) 使用 MSOLAP 提供者。</span><span class="sxs-lookup"><span data-stu-id="77842-207">The new data source uses the MSOLAP provider with its `Data Source` property and `Initial Catalog` property acquired from the `TargetServer` and `TargetDatabase` properties of the selected project.</span></span> <span data-ttu-id="77842-208">在使用多個 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 專案來管理遠端資料分割的方案中，此功能很有用，因為來源和目的地 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 資料庫都需要對應的資料來源來支援遠端資料分割的儲存和處理。</span><span class="sxs-lookup"><span data-stu-id="77842-208">This feature is useful in solutions where you are using multiple [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] projects to manage remote partitions, because the source and destination [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] databases require reciprocal data sources to support remote partition storage and processing.</span></span>  
  
 <span data-ttu-id="77842-209">當您參考資料來源物件時，只能在參考的物件或專案中編輯該物件，</span><span class="sxs-lookup"><span data-stu-id="77842-209">When you reference a data source object, you can edit that object only in the referenced object or project.</span></span> <span data-ttu-id="77842-210">您無法在包含此參考的資料來源物件中編輯連接字串。</span><span class="sxs-lookup"><span data-stu-id="77842-210">You cannot edit the connection information in the data source object that contains the reference.</span></span> <span data-ttu-id="77842-211">參考的物件或專案中的連接資訊變更會在建立新的資料來源時，出現在其中。</span><span class="sxs-lookup"><span data-stu-id="77842-211">Changes to the connection information in the referenced object or project appear in the new data source when it is built.</span></span> <span data-ttu-id="77842-212">當您建立專案或清除資料來源設計師中的參考時，會同步處理出現在專案之資料來源 (.ds) 檔案中的連接字串資訊。</span><span class="sxs-lookup"><span data-stu-id="77842-212">The connection string information that appears in the data source (.ds) file in the project is synchronized when you build the project or when you clear the reference in Data Source Designer.</span></span>  
  
##  <a name="view-or-edit-connection-properties"></a><a name="bkmk_ConnectionString"></a><span data-ttu-id="77842-213">查看或編輯連接屬性</span><span class="sxs-lookup"><span data-stu-id="77842-213">View or Edit Connection Properties</span></span>  
 <span data-ttu-id="77842-214">連接字串是根據您在 [資料來源設計師] 或 [新增資料來源精靈] 中選取的屬性所構成。</span><span class="sxs-lookup"><span data-stu-id="77842-214">The connection string is formulated based on the properties you select in the Data Source Designer or the New Data Source Wizard.</span></span> <span data-ttu-id="77842-215">您可以在 [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)]中檢視連接字串及其他屬性。</span><span class="sxs-lookup"><span data-stu-id="77842-215">You can view the connection string and other properties in [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)].</span></span>  
  
 <span data-ttu-id="77842-216">**若要編輯連接字串**</span><span class="sxs-lookup"><span data-stu-id="77842-216">**To edit the connection string**</span></span>  
  
1.  <span data-ttu-id="77842-217">在 [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)]的方案總管中，按兩下資料來源物件。</span><span class="sxs-lookup"><span data-stu-id="77842-217">In [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)], double-click the data source object in Solution Explorer.</span></span>  
  
2.  <span data-ttu-id="77842-218">按一下 [編輯]\*\*\*\*，然後按一下左瀏覽窗格中的 [全部]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="77842-218">Click **Edit**, and then click **All** on the left navigation pane.</span></span>  
  
3.  <span data-ttu-id="77842-219">屬性方格隨即出現，顯示您所使用資料提供者的可用屬性。</span><span class="sxs-lookup"><span data-stu-id="77842-219">The property grid appears, showing available properties of the data provider you are using.</span></span> <span data-ttu-id="77842-220">如需有關這些屬性的詳細資訊，請參閱提供者的產品文件集。</span><span class="sxs-lookup"><span data-stu-id="77842-220">For more information about these properties, see the product documentation of the provider.</span></span>  <span data-ttu-id="77842-221">若是 SQL Server Native Client，請參閱 [搭配 SQL Server Native Client 使用連接字串關鍵字](../../relational-databases/native-client/applications/using-connection-string-keywords-with-sql-server-native-client.md)。</span><span class="sxs-lookup"><span data-stu-id="77842-221">For SQL Server native client, see [Using Connection String Keywords with SQL Server Native Client](../../relational-databases/native-client/applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="77842-222">若您在方案中有多個資料來源物件，但只想在一處維護連接字串，則可將目前資料來源設定為參考其他資料來源物件。</span><span class="sxs-lookup"><span data-stu-id="77842-222">If you have multiple data source objects in the solution and you prefer to maintain the connection string in one place, you can configure the current data source to reference the other data source object.</span></span>  
  
 <span data-ttu-id="77842-223">「資料來源參考」\*\* 是與另一個 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 專案或相同方案中的資料來源之關聯。</span><span class="sxs-lookup"><span data-stu-id="77842-223">A *data source reference* is an association to another [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] project or data source in the same solution.</span></span> <span data-ttu-id="77842-224">參考會提供方法來同步處理方案中物件之間的資料來源。</span><span class="sxs-lookup"><span data-stu-id="77842-224">References provide a means to synchronize data sources between objects in a solution.</span></span> <span data-ttu-id="77842-225">連接字串資訊在您建立專案時都會同步處理。</span><span class="sxs-lookup"><span data-stu-id="77842-225">The connection string information is synchronized whenever you build the project.</span></span> <span data-ttu-id="77842-226">若要變更參考另一個物件之資料來源的連接字串，您必須變更參考之物件的連接字串。</span><span class="sxs-lookup"><span data-stu-id="77842-226">To change the connection string for a data source that references another object, you must change the connection string of the referenced object.</span></span>  
  
 <span data-ttu-id="77842-227">您可清除核取方塊來移除參考。</span><span class="sxs-lookup"><span data-stu-id="77842-227">You can remove the reference by clearing the check box.</span></span> <span data-ttu-id="77842-228">這樣即可結束物件間的同步處理，並讓您可以變更資料來源中的連接字串。</span><span class="sxs-lookup"><span data-stu-id="77842-228">This ends the synchronization between the objects and lets you change the connection string in the data source.</span></span>  
  
##  <a name="add-multiple-data-sources-to-a-model"></a><a name="bkmk_multipleDS"></a> <span data-ttu-id="77842-229">在模型中加入多個資料來源</span><span class="sxs-lookup"><span data-stu-id="77842-229">Add Multiple Data Sources to a Model</span></span>  
 <span data-ttu-id="77842-230">您可以建立多個資料來源物件，以支援與其他資料來源的連接。</span><span class="sxs-lookup"><span data-stu-id="77842-230">You can create more than one data source object to support connections to additional data sources.</span></span> <span data-ttu-id="77842-231">每個資料來源都必須擁有可用來建立關聯性的資料行。</span><span class="sxs-lookup"><span data-stu-id="77842-231">Each data source must have columns that can be used to create relationships.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="77842-232">如果已定義多個資料來源，而且在單一查詢中查詢多個來源的資料 (例如，針對雪花維度)，您必須使用 `OpenRowset` 定義支援遠端查詢的資料來源。</span><span class="sxs-lookup"><span data-stu-id="77842-232">If multiple data sources are defined and data is queried from multiple sources in a single query, such as for a snow-flaked dimension, you must define a data source that supports remote queries using `OpenRowset`.</span></span> <span data-ttu-id="77842-233">一般來說，這會是 Microsoft SQL Server 資料來源。</span><span class="sxs-lookup"><span data-stu-id="77842-233">Typically, this will be a Microsoft SQL Server data source.</span></span>  
  
 <span data-ttu-id="77842-234">使用多個資料來源的需求如下：</span><span class="sxs-lookup"><span data-stu-id="77842-234">Requirements for using multiple data sources include the following:</span></span>  
  
-   <span data-ttu-id="77842-235">指定一個資料來源做為主要資料來源。</span><span class="sxs-lookup"><span data-stu-id="77842-235">Designate one data source as the primary data source.</span></span> <span data-ttu-id="77842-236">主要資料來源會用來建立資料來源檢視。</span><span class="sxs-lookup"><span data-stu-id="77842-236">The primary data source is the one used to create a data source view.</span></span>  
  
-   <span data-ttu-id="77842-237">主要資料來源必須支援 `OpenRowset` 函數。</span><span class="sxs-lookup"><span data-stu-id="77842-237">A primary data source must support the `OpenRowset` function.</span></span>  <span data-ttu-id="77842-238">如需 SQL Server 中這個函數的詳細資訊，請參閱 <xref:Microsoft.SqlServer.TransactSql.ScriptDom.TSqlTokenType.OpenRowSet>。</span><span class="sxs-lookup"><span data-stu-id="77842-238">For more information about this function in SQL Server, see <xref:Microsoft.SqlServer.TransactSql.ScriptDom.TSqlTokenType.OpenRowSet>.</span></span>  
  
 <span data-ttu-id="77842-239">使用下列方法結合來自多個資料來源的資料：</span><span class="sxs-lookup"><span data-stu-id="77842-239">Use the following approach to combine data from multiple data sources:</span></span>  
  
1.  <span data-ttu-id="77842-240">在模型中建立資料來源。</span><span class="sxs-lookup"><span data-stu-id="77842-240">Create the data sources in your model.</span></span>  
  
2.  <span data-ttu-id="77842-241">使用 SQL Server 關聯式資料庫做為資料來源，建立資料來源檢視。</span><span class="sxs-lookup"><span data-stu-id="77842-241">Create a data source view, using a SQL Server relational database as the data source.</span></span> <span data-ttu-id="77842-242">這是您的主要資料來源。</span><span class="sxs-lookup"><span data-stu-id="77842-242">This is your primary data source.</span></span>  
  
3.  <span data-ttu-id="77842-243">在資料來源檢視設計師中，使用您剛才建立的資料來源檢視，以滑鼠右鍵按一下工作區中的任意位置，然後選取 [加入/移除資料表]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="77842-243">In Data Source View Designer, using the data source view you just created, right-click anywhere in the work area and select **Add/Remove Tables**.</span></span>  
  
4.  <span data-ttu-id="77842-244">選擇第二個資料來源，然後選取您要加入的資料表。</span><span class="sxs-lookup"><span data-stu-id="77842-244">Choose the second data source and then select the tables you want to add.</span></span>  
  
5.  <span data-ttu-id="77842-245">尋找並選取您加入的資料表。</span><span class="sxs-lookup"><span data-stu-id="77842-245">Find and select the table you added.</span></span> <span data-ttu-id="77842-246">以滑鼠右鍵按一下資料表，然後選取 [新增關聯性]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="77842-246">Right-click the table and select **New Relationship**.</span></span> <span data-ttu-id="77842-247">選擇包含相符資料的來源和目的地資料行。</span><span class="sxs-lookup"><span data-stu-id="77842-247">Choose the source and destination columns that contain matching data.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="77842-248">另請參閱</span><span class="sxs-lookup"><span data-stu-id="77842-248">See Also</span></span>  
 <span data-ttu-id="77842-249">[&#40;SSAS 多維度&#41;支援的資料來源](supported-data-sources-ssas-multidimensional.md) </span><span class="sxs-lookup"><span data-stu-id="77842-249">[Data Sources Supported &#40;SSAS Multidimensional&#41;](supported-data-sources-ssas-multidimensional.md) </span></span>  
 [<span data-ttu-id="77842-250">多維度模型中的資料來源檢視</span><span class="sxs-lookup"><span data-stu-id="77842-250">Data Source Views in Multidimensional Models</span></span>](data-source-views-in-multidimensional-models.md)  
  
  
