---
title: 定義預設成員 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- default members
- attributes [Analysis Services], default members
- members [Analysis Services], default
- DefaultMember property
ms.assetid: db487856-ee21-49c3-aa08-d9136e193374
author: minewiskan
ms.author: owend
ms.openlocfilehash: 2fc60d5883e3a73e1b6e662f6f399f6f77594d23
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87708806"
---
# <a name="define-a-default-member"></a><span data-ttu-id="19f3e-102">定義預設成員</span><span class="sxs-lookup"><span data-stu-id="19f3e-102">Define a Default Member</span></span>
  <span data-ttu-id="19f3e-103">當查詢中並未包含屬性階層時，會使用屬性階層的預設成員來評估運算式。</span><span class="sxs-lookup"><span data-stu-id="19f3e-103">The default member of an attribute hierarchy is used to evaluate expressions when an attribute hierarchy is not included in a query.</span></span> <span data-ttu-id="19f3e-104">只要查詢包含屬性階層，或是使用者階層包含做為屬性階層來源的屬性，就會忽略預設成員。</span><span class="sxs-lookup"><span data-stu-id="19f3e-104">The default member is ignored whenever a query includes an attribute hierarchy or user hierarchy that contains the attribute that sources the attribute hierarchy.</span></span> <span data-ttu-id="19f3e-105">這是因為使用查詢中指定的成員。</span><span class="sxs-lookup"><span data-stu-id="19f3e-105">This is because the member specified in the query is used.</span></span>  
  
 <span data-ttu-id="19f3e-106">屬性階層的預設成員是透過指定屬性成員做為屬性階層的 `DefaultMember` 屬性值而設定的。</span><span class="sxs-lookup"><span data-stu-id="19f3e-106">The default member for an attribute hierarchy is set by specifying an attribute member as the `DefaultMember` property value for the attribute hierarchy.</span></span> <span data-ttu-id="19f3e-107">您可以在維度設計師中的 [維度結構] 索引標籤上設定此屬性，也可以在 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]中 Cube 設計師的 [計算] 索引標籤上的 Cube 計算指令碼中設定此屬性。</span><span class="sxs-lookup"><span data-stu-id="19f3e-107">You can set this property on the Dimension Structure tab in Dimension Designer, or in the cube's calculation script on the Calculation tab in Cube Designer in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="19f3e-108">您也可以在定義維度安全性時，在 [維度資料] 索引標籤上指定安全性角色的 `DefaultMember` 屬性 (覆寫在維度上設定的預設成員)。</span><span class="sxs-lookup"><span data-stu-id="19f3e-108">You can also specify the `DefaultMember` property for a security role (overriding the default member set on the dimension) on the Dimension Data tab when defining dimension security.</span></span> <span data-ttu-id="19f3e-109">若要避免名稱解析問題，請於下列情況，在 Cube 的 MDX 指令碼中定義預設成員：如果 Cube 多次參考資料庫維度、如果 Cube 中的維度名稱與資料庫中的維度名稱不同，或是如果您要在不同的 Cube 中有不同的預設成員。</span><span class="sxs-lookup"><span data-stu-id="19f3e-109">To avoid name resolution problems, define the default member in the cube's MDX script in the following situations: if the cube refers to a database dimension more than once, if the dimension in the cube has a different name than the dimension in the database, or if you want to have different default members in different cubes.</span></span>  
  
 <span data-ttu-id="19f3e-110">當查詢中並未包含屬性時，會使用屬性的預設成員來評估運算式。</span><span class="sxs-lookup"><span data-stu-id="19f3e-110">The default member on an attribute is used to evaluate expressions when an attribute is not included in a query.</span></span> <span data-ttu-id="19f3e-111">屬性的預設成員由該屬性的 `DefaultMember` 屬性指定。</span><span class="sxs-lookup"><span data-stu-id="19f3e-111">The default member for an attribute is specified by the `DefaultMember` property on the attribute.</span></span> <span data-ttu-id="19f3e-112">只要查詢內包含來自維度的階層，對應到該階層內各層級之屬性的所有預設成員都會忽略。</span><span class="sxs-lookup"><span data-stu-id="19f3e-112">Whenever a hierarchy from a dimension is included in a query, all the default members from attributes corresponding to levels in the hierarchy are ignored.</span></span> <span data-ttu-id="19f3e-113">如果查詢內並未包含維度的階層，預設成員會用於維度中的所有屬性。</span><span class="sxs-lookup"><span data-stu-id="19f3e-113">If no hierarchy of a dimension is included in a query, default members are used for all the attributes in the dimension.</span></span>  
  
## <a name="resolving-the-default-member-when-no-default-member-is-specified"></a><span data-ttu-id="19f3e-114">未指定預設成員時，解析預設成員</span><span class="sxs-lookup"><span data-stu-id="19f3e-114">Resolving the Default Member When No Default Member is Specified</span></span>  
 <span data-ttu-id="19f3e-115">如果屬性階層沒有指定預設成員，而且該屬性階層是可彙總的 (屬性 (Attribute) 上的 `IsAggregatable` 屬性 (Property) 設定為 `True`)，則 (全部) 成員都是預設成員。</span><span class="sxs-lookup"><span data-stu-id="19f3e-115">If no default member is specified for an attribute hierarchy, and the attribute hierarchy is aggregatable (the `IsAggregatable` property on the attribute is set to `True`), the (All) member is the default member.</span></span> <span data-ttu-id="19f3e-116">如果未指定任何預設成員，且屬性階層是不可彙總的 (屬性 (attribute) 上的 `IsAggregatable` 屬性 (property) 設定為 `False`)，則會從屬性階層的最上層中選取預設成員。</span><span class="sxs-lookup"><span data-stu-id="19f3e-116">If no default member is specified and the attribute hierarchy is not aggregatable (the `IsAggregatable` property on the attribute is set to `False`), a default member is selected from the attribute hierarchy's top level.</span></span>  
  
## <a name="specifying-the-default-member"></a><span data-ttu-id="19f3e-117">指定預設成員</span><span class="sxs-lookup"><span data-stu-id="19f3e-117">Specifying the Default Member</span></span>  
 <span data-ttu-id="19f3e-118">中維度中的每個屬性 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 都有預設成員，您可以使用屬性（attribute）來指定它 `DefaultMember` 。</span><span class="sxs-lookup"><span data-stu-id="19f3e-118">Every attribute in a dimension in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] has a default member, which you can specify by using the `DefaultMember` property for an attribute.</span></span> <span data-ttu-id="19f3e-119">如果查詢中不包含屬性，則此設定可用來評估運算式。</span><span class="sxs-lookup"><span data-stu-id="19f3e-119">This setting is used to evaluate expressions if an attribute is not included in a query.</span></span> <span data-ttu-id="19f3e-120">如果查詢在維度中指定階層，則會忽略階層中之屬性的預設成員。</span><span class="sxs-lookup"><span data-stu-id="19f3e-120">If a query specifies a hierarchy in a dimension, the default members for the attributes in the hierarchy are ignored.</span></span> <span data-ttu-id="19f3e-121">如果查詢未在維度中指定階層，則 `DefaultMember` 維度屬性的設定會生效。</span><span class="sxs-lookup"><span data-stu-id="19f3e-121">If a query does not specify a hierarchy in a dimension, the `DefaultMember` settings for dimension attributes take effect.</span></span>  
  
 <span data-ttu-id="19f3e-122">如果 `DefaultMember` 屬性的設定為空白，且其 `IsAggregatable` 屬性設定為 `True` ，則預設成員為 All 成員。</span><span class="sxs-lookup"><span data-stu-id="19f3e-122">If the `DefaultMember` setting for an attribute is blank and its `IsAggregatable` property is set to `True`, the default member is the All member.</span></span> <span data-ttu-id="19f3e-123">如果 `IsAggregatable` 屬性設定為 `False` ，則預設成員是第一個可見層級的第一個成員。</span><span class="sxs-lookup"><span data-stu-id="19f3e-123">If the `IsAggregatable` property is set to `False`, the default member is the first member of the first visible level.</span></span>  
  
 <span data-ttu-id="19f3e-124">`DefaultMember`屬性的設定會套用至屬性所參與的每一個階層。</span><span class="sxs-lookup"><span data-stu-id="19f3e-124">The `DefaultMember` setting for an attribute applies to every hierarchy in which the attribute participates.</span></span> <span data-ttu-id="19f3e-125">您不能對維度中的不同階層使用不同設定。</span><span class="sxs-lookup"><span data-stu-id="19f3e-125">You cannot use different settings for different hierarchies in a dimension.</span></span> <span data-ttu-id="19f3e-126">比方說，如果 [1998] 成員是 [Year] 屬性的預設成員，此設定將套用至維度中的每一個階層。</span><span class="sxs-lookup"><span data-stu-id="19f3e-126">For example, if the [1998] member is the default member for a [Year] attribute, this setting applies to every hierarchy in the dimension.</span></span> <span data-ttu-id="19f3e-127">`DefaultMember`在此情況下的設定不能是一個階層中的 [1998] 和不同階層中的 [1997]。</span><span class="sxs-lookup"><span data-stu-id="19f3e-127">The `DefaultMember` setting in this case cannot be [1998] in one hierarchy and [1997] in a different hierarchy.</span></span>  
  
 <span data-ttu-id="19f3e-128">如果您為沒有自然彙總之階層的特定層級定義預設成員，則必須定義階層中位於該層級上方之所有層級中的預設成員。</span><span class="sxs-lookup"><span data-stu-id="19f3e-128">If you define a default member for a particular level in a hierarchy that does not aggregate naturally, you must define default members in all levels above that level in the hierarchy.</span></span> <span data-ttu-id="19f3e-129">例如，在階層的所有國家/地區中，除非您定義國家/地區的預設成員，否則您無法定義氣候的預設成員。</span><span class="sxs-lookup"><span data-stu-id="19f3e-129">For example, in the hierarchy All-Countries-Climate, you cannot define a default member for Climate unless you define a default member for Countries.</span></span> <span data-ttu-id="19f3e-130">如果沒有這麼做，會產生查詢階段錯誤。</span><span class="sxs-lookup"><span data-stu-id="19f3e-130">Failing to do so creates query-time errors.</span></span>  
  
 <span data-ttu-id="19f3e-131">若階層中的層級自然彙總，您可以定義階層中任何屬性的預設成員，而不必管階層中的其他屬性。</span><span class="sxs-lookup"><span data-stu-id="19f3e-131">When levels in a hierarchy aggregate naturally, you can define a default member for any attribute in the hierarchy without regard to other attributes in the hierarchy.</span></span> <span data-ttu-id="19f3e-132">例如，在階層的國家/地區，您可以定義 City 的預設成員，例如 [City]。[蒙特利爾] 未定義州或國家/地區的預設成員。</span><span class="sxs-lookup"><span data-stu-id="19f3e-132">For example, in the hierarchy Country-Province-City, you can define a default member for City such as [City].[Montreal] without defining the default member for State or for Country.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="19f3e-133">另請參閱</span><span class="sxs-lookup"><span data-stu-id="19f3e-133">See Also</span></span>  
 [<span data-ttu-id="19f3e-134">設定屬性階層的 &#40;全部&#41; 層級</span><span class="sxs-lookup"><span data-stu-id="19f3e-134">Configure the &#40;All&#41; Level for Attribute Hierarchies</span></span>](database-dimensions-configure-the-all-level-for-attribute-hierarchies.md)  
  
  
