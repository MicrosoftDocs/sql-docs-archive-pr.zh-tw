---
title: 將維度資料的自訂存取權授與 (Analysis Services) |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
f1_keywords:
- sql12.asvs.roledesignerdialog.dimensiondata.f1
helpviewer_keywords:
- dimensions [Analysis Services], security
- AllowedSet property
- IsAllowed property
- DeniedSet property
- user access rights [Analysis Services], dimensions
- custom dimension data access [Analysis Services]
- permissions [Analysis Services], dimensions
- DefaultMember property
- VisualTotals property
- ApplyDenied property
ms.assetid: b028720d-3785-4381-9572-157d13ec4291
author: minewiskan
ms.author: owend
ms.openlocfilehash: 4d3f91fef6410e05bfd9014f3f2db67530e83e5e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87686510"
---
# <a name="grant-custom-access-to-dimension-data-analysis-services"></a><span data-ttu-id="4e1e6-102">授與維度資料的自訂存取權 (Analysis Services)</span><span class="sxs-lookup"><span data-stu-id="4e1e6-102">Grant custom access to dimension data (Analysis Services)</span></span>
  <span data-ttu-id="4e1e6-103">啟用 Cube 的讀取權限後，您可以設定額外的權限以明確允許或拒絕維度成員 (包括 Measures 維度中的量值，其中含有 Cube 中使用的所有量值) 的存取。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-103">After enabling read access to a cube, you can set additional permissions that explicitly allow or deny access to dimension members (including measures contained in the Measures Dimension containing all of the measures used in a cube).</span></span> <span data-ttu-id="4e1e6-104">例如，假設指定了多個轉售商類別，您可能想要設定權限以排除特定商業類型的資料。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-104">For example, given multiple categories of resellers, you might want to set permissions to exclude data for a specific business type.</span></span> <span data-ttu-id="4e1e6-105">下圖為拒絕存取 Reseller 維度中之 Warehouse 商業類型之前與之後的效果。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-105">The following illustration is a before-and-after effect of denying access to the Warehouse business type in the Reseller dimension.</span></span>  
  
 <span data-ttu-id="4e1e6-106">![具有及不具有維度成員的樞紐分析表](../media/ssas-permsdimdenied.png "具有及不具有維度成員的樞紐分析表")</span><span class="sxs-lookup"><span data-stu-id="4e1e6-106">![PivotTables with and without a dimension member](../media/ssas-permsdimdenied.png "PivotTables with and without a dimension member")</span></span>  
  
 <span data-ttu-id="4e1e6-107">根據預設，如果您可以從 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] Cube 讀取資料，則會自動取得與 Cube 相關聯之所有量值和維度成員的讀取權限。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-107">By default, if you can read data from an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] cube, you automatically have read permissions on all measures and dimension members associated with that cube.</span></span> <span data-ttu-id="4e1e6-108">儘管這個行為對於許多案例可能已經足夠，但有時安全性需求會針對相同維度上的不同使用者來變動存取層級，藉以要求更多區段的授權策略。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-108">While this behavior might be sufficient for many scenarios, sometimes security requirements call for a more segmented authorization strategy, with varying levels of access for different users, on the same dimension.</span></span>  
  
 <span data-ttu-id="4e1e6-109">您可以藉由選擇要允許 (AllowedSet) 或拒絕 (DeniedSet) 哪些成員存取，來限制存取權。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-109">You can restrict access by choosing which members to allow (AllowedSet) or deny (DeniedSet) access.</span></span> <span data-ttu-id="4e1e6-110">您可以選取或取消選取要在角色中包含或排除的維度成員，來完成這個動作。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-110">You do this by either selecting or deselecting dimension members to include or exclude from the role.</span></span>  
  
 <span data-ttu-id="4e1e6-111">基本維度安全性是最簡單的；您只需選取要在角色中包含或排除的維度屬性和屬性階層。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-111">Basic dimension security is the easiest; you simply select which dimension attributes and attribute hierarchies to include or exclude in the role.</span></span> <span data-ttu-id="4e1e6-112">進階安全性較複雜，而且需要 MDX 指令碼的專業知識。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-112">Advanced security is more complex and requires expertise in MDX scripting.</span></span> <span data-ttu-id="4e1e6-113">以下是這兩種方法的敘述。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-113">Both approaches are described below.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="4e1e6-114">Prerequisites</span><span class="sxs-lookup"><span data-stu-id="4e1e6-114">Prerequisites</span></span>  
 <span data-ttu-id="4e1e6-115">並非所有量值或維度成員均可用在自訂存取案例中。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-115">Not all measures or dimension members can be used in custom access scenarios.</span></span> <span data-ttu-id="4e1e6-116">如果某個角色禁止存取預設的量值或成員，或是該角色禁止存取的量值為量值運算式的一部分，則連線將會失敗。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-116">A connection will fail if a role restricts access to a default measure or member, or restricts access to measures that are part of measure expressions.</span></span>  
  
 <span data-ttu-id="4e1e6-117">**檢查維度安全性的限制：預設量值、預設成員及量值運算式中使用的量值**</span><span class="sxs-lookup"><span data-stu-id="4e1e6-117">**Check for obstructions to dimension security: default measures, default members, and measures used in measure expressions**</span></span>  
  
1.  <span data-ttu-id="4e1e6-118">在 SQL Server Management Studio 中，以滑鼠右鍵按一下 cube，然後選取 [**腳本 cube] 做**為 [  |  **更改為**追加  |  **查詢編輯器視窗]**。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-118">In SQL Server Management Studio, right-click a cube and select **Script Cube as** | **ALTER To** | **New Query Editor Window**.</span></span>  
  
2.  <span data-ttu-id="4e1e6-119">搜尋 `DefaultMeasure`。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-119">Search for `DefaultMeasure`.</span></span> <span data-ttu-id="4e1e6-120">您應該會在 Cube 中發現一個，在每個檢視方塊中各發現一個。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-120">You should find one for the cube, and one for each perspective.</span></span> <span data-ttu-id="4e1e6-121">當您定義維度安全性時，請避免限制對預設量值的存取。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-121">When defining dimension security, avoid restricting access to default measures.</span></span>  
  
3.  <span data-ttu-id="4e1e6-122">接著搜尋 `MeasureExpression`。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-122">Next, search for `MeasureExpression`.</span></span> <span data-ttu-id="4e1e6-123">量值運算式是依據某項計算的量值，而計算通常還包含其他量值。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-123">A measure expression is a measure, based on a calculation, where the calculation often includes other measures.</span></span> <span data-ttu-id="4e1e6-124">確認您要限制的量值並未使用於運算式中。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-124">Verify that the measure you want to restrict is not used in an expression.</span></span> <span data-ttu-id="4e1e6-125">或者，當您限制存取的同時，務必也在整個 Cube 中一併排除對該量值的所有參考。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-125">Alternatively, go ahead and restrict access, just make sure to also exclude all references to that measure throughout the cube.</span></span>  
  
4.  <span data-ttu-id="4e1e6-126">最後，搜尋 `DefaultMember`。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-126">Finally, search for `DefaultMember`.</span></span> <span data-ttu-id="4e1e6-127">記下做為屬性預設成員的所有屬性。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-127">Make a note of any attributes that serve as a default member of an attribute.</span></span> <span data-ttu-id="4e1e6-128">設定維度安全性時，請避免對那些屬性設定限制。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-128">Avoid putting restrictions on those attributes when setting up dimension security.</span></span>  
  
## <a name="basic-dimension-security"></a><span data-ttu-id="4e1e6-129">基本維度安全性</span><span class="sxs-lookup"><span data-stu-id="4e1e6-129">Basic dimension security</span></span>  
  
1.  <span data-ttu-id="4e1e6-130">在中 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] ，連接到的實例 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 、在物件總管中展開適當資料庫的 [**角色**]，然後按一下資料庫角色 (或建立新的資料庫角色) 。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-130">In [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], connect to the instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], expand **Roles** for the appropriate database in Object Explorer, and then click a database role (or create a new database role).</span></span>  
  
     <span data-ttu-id="4e1e6-131">角色應該已具備 Cube 的讀取權限。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-131">The role should already have read access to the cube.</span></span> <span data-ttu-id="4e1e6-132">如需詳細資訊，請參閱 [授與 Cube 或模型權限 &#40;Analysis Services&#41;](grant-cube-or-model-permissions-analysis-services.md) 。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-132">See [Grant cube or model permissions &#40;Analysis Services&#41;](grant-cube-or-model-permissions-analysis-services.md) if you need help with this step.</span></span>  
  
2.  <span data-ttu-id="4e1e6-133">在 [**維度資料**]  |  [**基本**] 上，選取您要設定許可權的維度。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-133">On **Dimension Data** | **Basic**, select the dimension for which you are setting permissions.</span></span>  
  
3.  <span data-ttu-id="4e1e6-134">選擇屬性階層。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-134">Choose the attribute hierarchy.</span></span> <span data-ttu-id="4e1e6-135">並非所有屬性都是可用的。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-135">Not all attributes will be available.</span></span> <span data-ttu-id="4e1e6-136">只有擁有 [AttributeHierarchyEnabled]\*\*\*\* 的屬性會出現在 [屬性階層]\*\*\*\* 清單中。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-136">Only those attributes having **AttributeHierarchyEnabled** appear in the **Attribute Hierarchy** list.</span></span>  
  
4.  <span data-ttu-id="4e1e6-137">選擇要允許或拒絕存取的成員。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-137">Choose which members to allow or deny access.</span></span> <span data-ttu-id="4e1e6-138">預設會透過 [選取全部成員]\*\*\*\* 選項來允許存取。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-138">Allowing access, through the **Select all members** option, is the default.</span></span> <span data-ttu-id="4e1e6-139">建議您保留這個預設值，然後清除不應透過這個角色讓 [成員資格]\*\*\*\* 窗格中的 Windows 使用者和群組帳戶看見的個別成員。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-139">We suggest you keep this default and then clear individual members that should not be visible to the Windows user and group accounts in the **Memberships** pane via this role.</span></span> <span data-ttu-id="4e1e6-140">這麼做的好處在於以這個角色連線的使用者，都能夠使用後續處理作業中新增的成員。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-140">The advantage is that new members added in future processing operations are automatically available to people connecting through this role.</span></span>  
  
     <span data-ttu-id="4e1e6-141">或者，您可以 [取消選取全部成員]\*\*\*\* 來全面撤銷存取，然後挑選要允許的成員。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-141">Alternatively, you can **Deselect all members** to revoke access overall, and then pick which members to allow.</span></span> <span data-ttu-id="4e1e6-142">在後續的處理作業中，一直到您手動編輯維度資料安全性來允許存取新成員為止，將無法看到任何新成員。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-142">In future processing operations, new members are not visible until you manually edit dimension data security to allow access to them.</span></span>  
  
5.  <span data-ttu-id="4e1e6-143">（選擇性）按一下 [ **Advanced** ]，為 `Visual Totals` 此屬性階層啟用。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-143">Optionally, click **Advanced** to enable `Visual Totals` for this attribute hierarchy.</span></span> <span data-ttu-id="4e1e6-144">這個選項會根據可透過這個角色使用的成員，重新計算彙總。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-144">This option recalculates aggregations based on the members available through the role.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="4e1e6-145">在套用變更維度成員的權限時，並不會自動重新計算彙總的總計。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-145">When applying permissions that trim dimension members, aggregated totals are not recalculated automatically.</span></span> <span data-ttu-id="4e1e6-146">假設在套用 `All` 許可權之前，屬性階層的成員傳回200計數。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-146">Suppose the `All` member of an attribute hierarchy returns a count of 200 before permissions are applied.</span></span> <span data-ttu-id="4e1e6-147">套用拒絕存取部分成員的許可權之後， `All` 仍然會傳回200，即使使用者看到的成員值較少也一樣。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-147">After applying permissions that deny access to some members, `All` still returns 200, even though the member values visible to the user are much less.</span></span> <span data-ttu-id="4e1e6-148">若要避免混淆 cube 的取用者，您可以將成員設定為 `All` 僅限角色成員成員的匯總，而不是屬性階層之所有成員的匯總。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-148">To avoid confusing the consumers of your cube, you can configure the `All` member be the aggregate of just those members to which role members, rather than the aggregate of all of the members of the attribute hierarchy.</span></span> <span data-ttu-id="4e1e6-149">若要叫用這個行為，您可以 `Visual Totals` 在設定維度安全性時，于 [ **Advanced** ] 索引標籤上啟用。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-149">To invoke this behavior, you can enable `Visual Totals` on the **Advanced** tab when configuring dimension security.</span></span> <span data-ttu-id="4e1e6-150">啟用之後，彙總會在查詢期間計算，而不是從預先計算的彙總中擷取。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-150">Once enabled, the aggregate is calculated at query time rather than retrieved from pre-calculated aggregations.</span></span> <span data-ttu-id="4e1e6-151">這可以在查詢效能上產生顯著效果，因此只有在需要時才使用它。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-151">This can have a noticeable effect on query performance, so use it only when necessary.</span></span>  
  
## <a name="hiding-measures"></a><span data-ttu-id="4e1e6-152">隱藏量值</span><span class="sxs-lookup"><span data-stu-id="4e1e6-152">Hiding measures</span></span>  
 <span data-ttu-id="4e1e6-153">在 [授與資料格資料的自訂存取權 &#40;Analysis Services&#41;](grant-custom-access-to-cell-data-analysis-services.md)中，已說明如要完全隱藏量值的所有可見層面 (而非只是它的資料格資料)，需具備維度成員的權限。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-153">In [Grant custom access to cell data &#40;Analysis Services&#41;](grant-custom-access-to-cell-data-analysis-services.md), it was explained that fully hiding all visual aspects of a measure, and not just its cell data, requires permissions on dimension members.</span></span> <span data-ttu-id="4e1e6-154">本節說明如何拒絕存取量值的物件中繼資料。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-154">This section explains how to deny access to the object metadata of a measure.</span></span>  
  
1.  <span data-ttu-id="4e1e6-155">在 [**維度資料**]  |  [**基本**] 上，向下流覽維度清單直到您到達 [cube 維度]，然後選取 [**量值維度**]。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-155">On **Dimension Data** | **Basic**, scroll down the Dimension list until you reach cube dimensions, and then select **Measures Dimension**.</span></span>  
  
2.  <span data-ttu-id="4e1e6-156">從量值清單中，清除透過這個角色連接的使用者不應看見之量值的核取方塊。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-156">From the list of measures, clear the check box for measures that should not appear to users connecting via this role.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4e1e6-157">查看 [必要條件] 以了解如何識別可能破壞角色安全性的量值。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-157">Check the Prerequisites to learn how to identify measures that can break role security.</span></span>  
  
## <a name="advanced-dimension-security"></a><span data-ttu-id="4e1e6-158">進階維度安全性</span><span class="sxs-lookup"><span data-stu-id="4e1e6-158">Advanced dimension security</span></span>  
 <span data-ttu-id="4e1e6-159">如果您精通 MDX，另一個方法是撰寫 MDX 運算式來設定條件以允許或拒絕成員的存取。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-159">If you have MDX expertise, another approach is to write MDX expressions that set the criteria for which members are allowed or denied access.</span></span> <span data-ttu-id="4e1e6-160">按一下 [**建立角色**  |  **維度資料**]  |  [**高級**] 以提供腳本。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-160">Click **Create Role** | **Dimension Data** | **Advanced** to provide the script.</span></span>  
  
 <span data-ttu-id="4e1e6-161">您可以使用 MDX 產生器來撰寫 MDX 陳述式。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-161">You can the MDX Builder to write the MDX statement.</span></span> <span data-ttu-id="4e1e6-162">如需詳細資訊，請參閱 [MDX 產生器 &#40;Analysis Services - 多維度資料&#41;](../mdx-builder-analysis-services-multidimensional-data.md)。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-162">See [MDX Builder &#40;Analysis Services - Multidimensional Data&#41;](../mdx-builder-analysis-services-multidimensional-data.md) for details.</span></span> <span data-ttu-id="4e1e6-163">[進階]\*\*\*\* 索引標籤具有下列選項：</span><span class="sxs-lookup"><span data-stu-id="4e1e6-163">The **Advanced** tab has the following options:</span></span>  
  
 <span data-ttu-id="4e1e6-164">**屬性**</span><span class="sxs-lookup"><span data-stu-id="4e1e6-164">**Attribute**</span></span>  
 <span data-ttu-id="4e1e6-165">選取您要管理其成員安全性的屬性。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-165">Select the attribute for which you want to manage member security.</span></span>  
  
 <span data-ttu-id="4e1e6-166">**允許的成員集**</span><span class="sxs-lookup"><span data-stu-id="4e1e6-166">**Allowed member set**</span></span>  
 <span data-ttu-id="4e1e6-167">AllowedSet 可以解析為沒有成員 (預設值)、全部成員或部分成員。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-167">The AllowedSet can resolve to no members (default), all members, or some members.</span></span> <span data-ttu-id="4e1e6-168">如果您允許屬性的存取，但未定義允許集合的成員，就會授與所有成員的存取權。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-168">If you allow access to an attribute and do not define any members of the allowed set, access to all members is granted.</span></span> <span data-ttu-id="4e1e6-169">如果您允許對屬性的存取，而且有定義一組特定的屬性成員，則只有明確允許的成員會是可見的。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-169">If you allow access to an attribute and define a specific set of attribute members, only the explicitly allowed members are visible.</span></span>  
  
 <span data-ttu-id="4e1e6-170">建立 AllowedSet，會在屬性參與多層級階層時產生漣漪效果。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-170">Creating an AllowedSet has a ripple effect when the attribute participates in a multi-level hierarchy.</span></span> <span data-ttu-id="4e1e6-171">例如，假設有一個角色允許存取 Washington 州 (假設已將公司的 Washington 州業務部門權限授與角色)。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-171">For example, suppose a role allows access to Washington state (assume a scenario where the role is granting permissions to a company's Washington state sales division).</span></span> <span data-ttu-id="4e1e6-172">對於透過這個角色連接的人員，包含上階 (United States) 或下階 (Seattle 和 Redmond) 的查詢將只會看見包含 Washington 州之鏈結中的成員。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-172">For people connecting through this role, queries that include ancestors (United States) or descendants (Seattle and Redmond) will only see members in a chain including Washington state.</span></span> <span data-ttu-id="4e1e6-173">因為並未明確允許其他州，所以效果會和拒絕它們一樣。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-173">Because other states are not explicitly allowed, the effect will be the same as if they were denied.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4e1e6-174">如果您定義了空的 set ({} 屬性成員) ，資料庫角色就看不到該屬性的任何成員。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-174">If you define an empty set ({}) of attribute members, no members of the attribute will be visible to the database role.</span></span> <span data-ttu-id="4e1e6-175">沒有允許的集合不會被解釋為空的集合。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-175">The absence of an allowed set is not interpreted as an empty set.</span></span>  
  
 <span data-ttu-id="4e1e6-176">**拒絕的成員集**</span><span class="sxs-lookup"><span data-stu-id="4e1e6-176">**Denied member set**</span></span>  
 <span data-ttu-id="4e1e6-177">DeniedSet 屬性可以解析為沒有成員、全部成員 (預設值) 或部分屬性成員。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-177">The DeniedSet property can resolve to no members, all members (default), or some attribute members.</span></span> <span data-ttu-id="4e1e6-178">當拒絕的集合僅包含特定的屬性成員集合時，資料庫角色只會被拒絕存取這些特定成員以及下階 (如果屬性位於多層級階層中)。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-178">When the denied set contains only a specific set of attribute members, the database role is denied access only to those specific members, as well as descendants if the attribute is in a multi-level hierarchy.</span></span> <span data-ttu-id="4e1e6-179">請考量 Washington 州業務部門範例。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-179">Consider the Washington state sales division example.</span></span> <span data-ttu-id="4e1e6-180">如果將 Washington 放在 DeniedSet 中，透過這個角色連接的人員將看見除了 Washington 及其下階屬性以外的所有其他州。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-180">If Washington is placed in the DeniedSet, people connecting through this role will see all other states except Washington and its descendent attributes.</span></span>  
  
 <span data-ttu-id="4e1e6-181">一如前文所述，拒絕的集合是固定的集合。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-181">Recall from the previous section that the denied set is a fixed collection.</span></span> <span data-ttu-id="4e1e6-182">如果後續處理引進了也應該拒絕存取的新成員，您就需要編輯這個角色，來將這些成員新增到清單中。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-182">If processing subsequently introduces new members that should also be denied access, you will need to edit this role to add those members to the list.</span></span>  
  
 <span data-ttu-id="4e1e6-183">**預設成員**</span><span class="sxs-lookup"><span data-stu-id="4e1e6-183">**Default member**</span></span>  
 <span data-ttu-id="4e1e6-184">若屬性 (Attribute) 未明確包含在查詢中，則會由 DefaultMember 屬性 (Property) 決定要傳回至用戶端的資料集。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-184">The DefaultMember property determines the data set returned to a client when an attribute is not explicitly included in a query.</span></span> <span data-ttu-id="4e1e6-185">未明確包含屬性時， [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 會對該屬性使用下列其中一個預設成員：</span><span class="sxs-lookup"><span data-stu-id="4e1e6-185">When the attribute is not explicitly included, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] uses one of the following default members for the attribute:</span></span>  
  
-   <span data-ttu-id="4e1e6-186">如果資料庫角色有定義屬性的預設成員， [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 就會使用此預設成員。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-186">If the database role defines a default member for the attribute, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] uses this default member.</span></span>  
  
-   <span data-ttu-id="4e1e6-187">如果資料庫角色沒有定義屬性的預設成員， [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 就會使用該屬性本身定義的預設成員。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-187">If the database role does not define a default member for the attribute, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] uses the default member that is defined for the attribute itself.</span></span> <span data-ttu-id="4e1e6-188">除非您另外指定，否則屬性的預設成員就是 `All` 成員 (除非該屬性定義為非彙總)。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-188">The default member for an attribute, unless you specify otherwise, is the `All` member (unless the attribute is defined as non-aggregatable).</span></span>  
  
 <span data-ttu-id="4e1e6-189">例如，假設資料庫角色指定 `Male` 做為 `Gender` 屬性的預設成員。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-189">For example, suppose a database role specifies `Male` as the default member for the `Gender` attribute.</span></span> <span data-ttu-id="4e1e6-190">除非查詢明確包含 `Gender` 屬性並為此屬性指定不同成員，否則 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 就會傳回只包含男性客戶的資料集。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-190">Unless a query both explicitly includes the `Gender` attribute and specifies a different member for this attribute, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] would return a data set that included only male customers.</span></span> <span data-ttu-id="4e1e6-191">如需設定預設成員的詳細資訊，請參閱 [定義預設成員](attribute-properties-define-a-default-member.md)。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-191">For more information about setting the default member, see [Define a Default Member](attribute-properties-define-a-default-member.md).</span></span>  
  
 <span data-ttu-id="4e1e6-192">**啟用視覺化總計**</span><span class="sxs-lookup"><span data-stu-id="4e1e6-192">**Enable Visual Total**</span></span>  
 <span data-ttu-id="4e1e6-193">VisualTotals 屬性會指出所顯示彙總資料格的值，是根據所有資料格值來計算，還是只根據資料庫角色所看見資料格的值來計算。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-193">The VisualTotals property indicates whether the aggregated cell values that are displayed are calculated according to all cell values or only according to the cell values that are visible to the database role.</span></span>  
  
 <span data-ttu-id="4e1e6-194">根據預設，VisualTotals 屬性會停用 (設定為 [ `False`) ]。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-194">By default, the VisualTotals property is disabled (set to `False`).</span></span> <span data-ttu-id="4e1e6-195">此預設值會使效能最佳化，因為 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 可快速計算所有資料格的值之總計，而不必浪費時間選取要計算之資料格的值。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-195">This default setting maximizes performance because [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] can quickly calculate the total of all cell values, instead of having to spend time selecting which cells values to calculate.</span></span>  
  
 <span data-ttu-id="4e1e6-196">不過，停用 VisualTotals 屬性會產生安全性問題，因為使用者有可能使用彙總資料格的值來推論該使用者的資料庫角色沒有存取權之屬性成員的值。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-196">However, having the VisualTotals property disabled could create a security issue if a user can use the aggregated cell values to deduce values for attribute members to which the user's database role does not have access.</span></span> <span data-ttu-id="4e1e6-197">例如， [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 會使用三個屬性成員的值來計算彙總資料格的值。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-197">For example, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] uses the values for three attribute members to calculate an aggregated cell value.</span></span> <span data-ttu-id="4e1e6-198">資料庫角色有檢視這三個屬性成員當中兩個的存取權。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-198">The database role has access to view two of these three attribute members.</span></span> <span data-ttu-id="4e1e6-199">利用彙總資料格的值，此資料庫角色的成員即可推論出第三個屬性成員的值。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-199">Using the aggregated cell value, a member of this database role would be able to deduce the value for the third attribute member.</span></span>  
  
 <span data-ttu-id="4e1e6-200">將 VisualTotals 屬性設定為 `True` 可以排除此風險。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-200">Setting VisualTotals property to `True` can eliminate this risk.</span></span> <span data-ttu-id="4e1e6-201">當您啟用 VisualTotals 屬性時，資料庫角色只能檢視該角色具有權限之維度成員的彙總。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-201">When you enable the VisualTotals property, a database role can only view aggregated totals for dimension members to which the role has permission.</span></span>  
  
 <span data-ttu-id="4e1e6-202">**檢查**</span><span class="sxs-lookup"><span data-stu-id="4e1e6-202">**Check**</span></span>  
 <span data-ttu-id="4e1e6-203">按一下即可測試此頁面定義的 MDX 語法。</span><span class="sxs-lookup"><span data-stu-id="4e1e6-203">Click to test the MDX syntax defined on this page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4e1e6-204">另請參閱</span><span class="sxs-lookup"><span data-stu-id="4e1e6-204">See Also</span></span>  
 <span data-ttu-id="4e1e6-205">[授與 cube 或模型許可權 &#40;Analysis Services&#41;](grant-cube-or-model-permissions-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="4e1e6-205">[Grant cube or model permissions &#40;Analysis Services&#41;](grant-cube-or-model-permissions-analysis-services.md) </span></span>  
 <span data-ttu-id="4e1e6-206">[將資料格資料的自訂存取權授與 &#40;Analysis Services&#41;](grant-custom-access-to-cell-data-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="4e1e6-206">[Grant custom access to cell data &#40;Analysis Services&#41;](grant-custom-access-to-cell-data-analysis-services.md) </span></span>  
 <span data-ttu-id="4e1e6-207">[授與資料採礦結構和模型的許可權 &#40;Analysis Services&#41;](grant-permissions-on-data-mining-structures-and-models-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="4e1e6-207">[Grant permissions on data mining structures and models &#40;Analysis Services&#41;](grant-permissions-on-data-mining-structures-and-models-analysis-services.md) </span></span>  
 [<span data-ttu-id="4e1e6-208">授與資料來源物件的權限 &#40;Analysis Services&#41;</span><span class="sxs-lookup"><span data-stu-id="4e1e6-208">Grant permissions on a data source object &#40;Analysis Services&#41;</span></span>](grant-permissions-on-a-data-source-object-analysis-services.md)  
  
  
