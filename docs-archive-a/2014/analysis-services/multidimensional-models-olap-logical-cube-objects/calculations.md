---
title: 計算 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- calculations [Analysis Services]
- OLAP objects [Analysis Services], calculations
- MDX [Analysis Services], calculations
- calculations [Analysis Services], about calculations
- cubes [Analysis Services], calculations
ms.assetid: 6be84916-fd05-4efc-ab98-6adbbad80154
author: minewiskan
ms.author: owend
ms.openlocfilehash: 4457a5fa434be3865edf770f7ca69a676c051893
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87706894"
---
# <a name="calculations"></a><span data-ttu-id="32e8b-102">計算</span><span class="sxs-lookup"><span data-stu-id="32e8b-102">Calculations</span></span>
  <span data-ttu-id="32e8b-103">計算是一種多維度運算式， (MDX) 運算式或腳本，用來在中定義 cube 中的匯出成員、命名集或限定範圍的指派 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="32e8b-103">A calculation is a Multidimensional Expressions (MDX) expression or script that is used to define a calculated member, a named set, or a scoped assignment in a cube in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="32e8b-104">計算可讓您加入的物件不是由 Cube 之資料所定義，而是由參考 Cube 之其他部分、其他 Cube 甚至 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 資料庫外部之資訊的運算式所定義。</span><span class="sxs-lookup"><span data-stu-id="32e8b-104">Calculations let you add objects that are defined not by the data of the cube, but by expressions that can reference other parts of the cube, other cubes, or even information outside the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="32e8b-105">計算可讓您擴充 Cube 的功能，以在商業智慧應用程式中加入彈性和強大功能。</span><span class="sxs-lookup"><span data-stu-id="32e8b-105">Calculations let you extend the capabilities of a cube, adding flexibility and power to business intelligence applications.</span></span> <span data-ttu-id="32e8b-106">如需腳本計算的詳細資訊，請參閱[Microsoft SQL Server 2005 中的 MDX 腳本簡介](https://go.microsoft.com/fwlink/?LinkId=81892)。</span><span class="sxs-lookup"><span data-stu-id="32e8b-106">For more information about scripting calculations, see [Introduction to MDX Scripting in Microsoft SQL Server 2005](https://go.microsoft.com/fwlink/?LinkId=81892).</span></span> <span data-ttu-id="32e8b-107">如需 MDX 查詢和計算相關效能問題的詳細資訊，請參閱[SQL Server 2005 Analysis Services 效能指南](https://docsbay.net/Microsoft-SQL-Server-2005-Analysis-Services-Performance-Guide)。</span><span class="sxs-lookup"><span data-stu-id="32e8b-107">For more information about performance issues related to MDX queries and calculations, see the [SQL Server 2005 Analysis Services Performance Guide](https://docsbay.net/Microsoft-SQL-Server-2005-Analysis-Services-Performance-Guide).</span></span>  
  
## <a name="calculated-members"></a><span data-ttu-id="32e8b-108">導出成員</span><span class="sxs-lookup"><span data-stu-id="32e8b-108">Calculated Members</span></span>  
 <span data-ttu-id="32e8b-109">導出成員是使用您在定義導出成員時指定的多維度運算式 (MDX) 運算式，以在執行階段計算出其值的成員。</span><span class="sxs-lookup"><span data-stu-id="32e8b-109">A calculated member is a member whose value is calculated at run time using a Multidimensional Expressions (MDX) expression that you specify when you define the calculated member.</span></span> <span data-ttu-id="32e8b-110">與其他任何成員一樣，商業智慧應用程式也可以使用導出成員。</span><span class="sxs-lookup"><span data-stu-id="32e8b-110">A calculated member is available to business intelligence applications just like any other member.</span></span> <span data-ttu-id="32e8b-111">因為在 Cube 中只會儲存定義，所以導出成員並不會增加 Cube 的大小；需要回答查詢時才會在記憶體中計算出值。</span><span class="sxs-lookup"><span data-stu-id="32e8b-111">Calculated members do not increase the size of the cube because only the definitions are stored in the cube; values are calculated in memory as required to answer a query.</span></span>  
  
 <span data-ttu-id="32e8b-112">可以針對任何維度定義導出成員，包括量值維度。</span><span class="sxs-lookup"><span data-stu-id="32e8b-112">Calculated members can be defined for any dimension, including the measures dimension.</span></span> <span data-ttu-id="32e8b-113">在量值維度上建立的導出成員，稱為導出量值。</span><span class="sxs-lookup"><span data-stu-id="32e8b-113">Calculated members created on the Measures dimension are called calculated measures.</span></span>  
  
 <span data-ttu-id="32e8b-114">雖然導出成員通常是根據 Cube 中的現有資料，但是您也可以將資料與算術運算子、數字和函數組合來建立複雜的運算式。</span><span class="sxs-lookup"><span data-stu-id="32e8b-114">Although calculated members are typically based on data that already exists in the cube, you can create complex expressions by combining data with arithmetic operators, numbers, and functions.</span></span> <span data-ttu-id="32e8b-115">您也可使用 MDX 函數 (如 LookupCube) 來存取 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 資料庫中其他 Cube 內的資料；</span><span class="sxs-lookup"><span data-stu-id="32e8b-115">You can also use MDX functions, such as LookupCube, to access data in other cubes in the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="32e8b-116">包含標準化的 Visual Studio 函數程式庫，而且您可使用預存程序從目前 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 資料庫以外的來源中擷取資料。</span><span class="sxs-lookup"><span data-stu-id="32e8b-116">includes standardized Visual Studio function libraries, and you can use stored procedures to retrieve data from sources other than the current [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="32e8b-117">如需預存程式的詳細資訊，請參閱[定義預存程式](../multidimensional-models-extending-olap-stored-procedures/defining-stored-procedures.md)。</span><span class="sxs-lookup"><span data-stu-id="32e8b-117">For more information about stored procedures, see [Defining Stored Procedures](../multidimensional-models-extending-olap-stored-procedures/defining-stored-procedures.md).</span></span>  
  
 <span data-ttu-id="32e8b-118">例如，假設一運輸公司的管理者想要根據每一容量單位的利潤，來決定運送哪一種貨物類型的利潤較高。</span><span class="sxs-lookup"><span data-stu-id="32e8b-118">For example, suppose executives in a shipping company want to determine which types of cargo are more profitable to carry, based on profit per unit of volume.</span></span> <span data-ttu-id="32e8b-119">他們使用包含貨物、船隊與時間維度，以及 Price_to_Ship、Cost_to_Ship、及 Volume_in_Cubic_Meters 量值的運貨 Cube；但是，該 Cube 沒有包含獲利率的量值。</span><span class="sxs-lookup"><span data-stu-id="32e8b-119">They use a Shipments cube that contains the dimensions Cargo, Fleet, and Time and the measures Price_to_Ship, Cost_to_Ship, and Volume_in_Cubic_Meters; however, the cube does not contain a measure for profitability.</span></span> <span data-ttu-id="32e8b-120">您可以在下列運算式中合併現有的量值，以在 Cube 中建立一個導出成員作為量值 (名為 Profit_per_Cubic_Meter)：</span><span class="sxs-lookup"><span data-stu-id="32e8b-120">You can create a calculated member as a measure named Profit_per_Cubic_Meter in the cube by combining the existing measures in the following expression:</span></span>  
  
```  
([Measures].[Price_to_Ship] - [Measures].[Cost_to_Ship]) /  
[Measures].[Volume_in_Cubic_Meters]  
```  
  
 <span data-ttu-id="32e8b-121">建立導出成員後，Profit_per_Cubic_Meter 會在下次瀏覽運貨 Cube 時，與其他量值一起出現。</span><span class="sxs-lookup"><span data-stu-id="32e8b-121">After you create the calculated member, the Profit_per_Cubic_Meter appears together with the other measures the next time that the Shipments cube is browsed.</span></span>  
  
 <span data-ttu-id="32e8b-122">若要建立匯出成員，請在 Cube 設計師中使用 [**計算**] 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="32e8b-122">To create calculated members, use the **Calculation**s tab in Cube Designer.</span></span> <span data-ttu-id="32e8b-123">如需詳細資訊，請參閱[建立匯出成員](../multidimensional-models/create-calculated-members.md)</span><span class="sxs-lookup"><span data-stu-id="32e8b-123">For more information, see [Create Calculated Members](../multidimensional-models/create-calculated-members.md)</span></span>  
  
## <a name="named-sets"></a><span data-ttu-id="32e8b-124">命名集</span><span class="sxs-lookup"><span data-stu-id="32e8b-124">Named Sets</span></span>  
 <span data-ttu-id="32e8b-125">命名集是會傳回集合的 CREATE SET MDX 陳述式運算式；</span><span class="sxs-lookup"><span data-stu-id="32e8b-125">A named set is a CREATE SET MDX statement expression that returns a set.</span></span> <span data-ttu-id="32e8b-126">MDX 運算式會儲存為中 cube 定義的一部分 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="32e8b-126">The MDX expression is saved as part of the definition of a cube in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="32e8b-127">建立命名集，以供在多維度運算式 (MDX) 查詢中重複使用。</span><span class="sxs-lookup"><span data-stu-id="32e8b-127">A named set is created for reuse in Multidimensional Expressions (MDX) queries.</span></span> <span data-ttu-id="32e8b-128">命名集可讓商務使用者簡化查詢，以及針對複雜且常用的集合運算式來使用集合名稱 (而非集合運算式)。</span><span class="sxs-lookup"><span data-stu-id="32e8b-128">A named set enables business users to simplify queries, and use a set name instead of a set expression for complex, frequently used set expressions.</span></span> <span data-ttu-id="32e8b-129">**相關主題：** [建立命名集](../multidimensional-models/create-named-sets.md)</span><span class="sxs-lookup"><span data-stu-id="32e8b-129">**Related topic:** [Create Named Sets](../multidimensional-models/create-named-sets.md)</span></span>  
  
## <a name="script-commands"></a><span data-ttu-id="32e8b-130">指令碼命令</span><span class="sxs-lookup"><span data-stu-id="32e8b-130">Script Commands</span></span>  
 <span data-ttu-id="32e8b-131">指令碼命令是 MDX 指令碼，包含在 Cube 的定義中。</span><span class="sxs-lookup"><span data-stu-id="32e8b-131">A script command is an MDX script, included as part of the definition of the cube.</span></span> <span data-ttu-id="32e8b-132">指令碼命令幾乎可讓您在 Cube 上執行 MDX 所支援的任何動作 (例如，設定計算的範圍使其只適用於 Cube 的一部分)。</span><span class="sxs-lookup"><span data-stu-id="32e8b-132">Script commands let you perform almost any action that is supported by MDX on a cube, such as scoping a calculation to apply to only part of the cube.</span></span> <span data-ttu-id="32e8b-133">在中 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] ，MDX 腳本可套用至整個 cube 或 cube 的特定區段，在整個腳本執行的特定時間點。</span><span class="sxs-lookup"><span data-stu-id="32e8b-133">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], MDX scripts can apply either to the whole cube or to specific sections of the cube, at specific points throughout the execution of the script.</span></span> <span data-ttu-id="32e8b-134">預設指令碼命令 (CALCULATE 陳述式) 會使用根據預設範圍的彙總資料來填入 Cube 中的資料格。</span><span class="sxs-lookup"><span data-stu-id="32e8b-134">The default script command, which is the CALCULATE statement, populates cells in the cube with aggregated data based on the default scope.</span></span>  
  
 <span data-ttu-id="32e8b-135">預設範圍就是整個 Cube，但您可以定義更小的範圍，即所謂的 Subcube，然後將 MDX 指令碼只套用至該特定 Cube 空間。</span><span class="sxs-lookup"><span data-stu-id="32e8b-135">The default scope is the whole cube, but you can define a more limited scope, known as a subcube, and then apply an MDX script to only that particular cube space.</span></span> <span data-ttu-id="32e8b-136">SCOPE 陳述式會在計算指令碼中定義所有後續 MDX 運算式和陳述式的範圍，直到範圍終止或重新定義為止。</span><span class="sxs-lookup"><span data-stu-id="32e8b-136">The SCOPE statement defines the scope of all subsequent MDX expressions and statements in the calculation script until the scope is terminated or redefined.</span></span> <span data-ttu-id="32e8b-137">然後使用 THIS 陳述式，將 MDX 運算式至目前範圍。</span><span class="sxs-lookup"><span data-stu-id="32e8b-137">The THIS statement is then used to apply an MDX expression to the current scope.</span></span> <span data-ttu-id="32e8b-138">您可以使用 BACK_COLOR 陳述式，指定目前範圍內資料格的背景資料格顏色，以協助您進行偵錯。</span><span class="sxs-lookup"><span data-stu-id="32e8b-138">You can use the BACK_COLOR statement to specify a background cell color for the cells in the current scope, to help you during debugging.</span></span>  
  
 <span data-ttu-id="32e8b-139">例如，您可以使用指令碼命令，依據之前時間週期的銷售的加權值，將銷售配額配置給跨越時間和銷售地區的員工。</span><span class="sxs-lookup"><span data-stu-id="32e8b-139">For example, you can use a script command to allocate sales quotas to employees across time and sales territory based on the weighted values of sales for a prior time period.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="32e8b-140">另請參閱</span><span class="sxs-lookup"><span data-stu-id="32e8b-140">See Also</span></span>  
 [<span data-ttu-id="32e8b-141">多維度模型中的計算</span><span class="sxs-lookup"><span data-stu-id="32e8b-141">Calculations in Multidimensional Models</span></span>](../multidimensional-models/calculations-in-multidimensional-models.md)  
  
  
