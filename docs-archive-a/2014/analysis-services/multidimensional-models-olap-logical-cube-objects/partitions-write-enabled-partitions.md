---
title: 可寫入的磁碟分割 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- storage [Analysis Services], partitions
- write-enabled partitions [Analysis Services]
- partitions [Analysis Services], write-enabled
- partitions [Analysis Services], storage
- writeback [Analysis Services], partitions
- storing data [Analysis Services], partitions
ms.assetid: 46e7683f-03ce-4af2-bd99-a5203733d723
author: minewiskan
ms.author: owend
ms.openlocfilehash: bd4bd012847c3aee231767e94bead86a507ecc53
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87702040"
---
# <a name="write-enabled-partitions"></a><span data-ttu-id="91184-102">可寫入的資料分割</span><span class="sxs-lookup"><span data-stu-id="91184-102">Write-Enabled Partitions</span></span>
  <span data-ttu-id="91184-103">Cube 中的資料通常是唯讀的；</span><span class="sxs-lookup"><span data-stu-id="91184-103">The data in a cube is generally read-only.</span></span> <span data-ttu-id="91184-104">但是在某些狀況下，您可能會希望資料分割是可寫入的。</span><span class="sxs-lookup"><span data-stu-id="91184-104">However, for certain scenarios, you may want to write-enable a partition.</span></span> <span data-ttu-id="91184-105">可寫入的資料分割可讓商務使用者藉由變更資料格值及分析變更對 Cube 資料的影響，以瀏覽一些狀況。</span><span class="sxs-lookup"><span data-stu-id="91184-105">Write-enabled partitions are used to enable business users to explore scenarios by changing cell values and analyzing the effects of the changes on cube data.</span></span> <span data-ttu-id="91184-106">當您啟用資料分割的寫入功能時，用戶端應用程式可在資料分割中記錄資料的變更。</span><span class="sxs-lookup"><span data-stu-id="91184-106">When you write-enable a partition, client applications can record changes to the data in the partition.</span></span> <span data-ttu-id="91184-107">這些變更稱為回寫資料，是儲存在個別資料表中，不會覆寫量值群組中任何現有的資料。</span><span class="sxs-lookup"><span data-stu-id="91184-107">These changes, known as writeback data, are stored in a separate table and do not overwrite any existing data in a measure group.</span></span> <span data-ttu-id="91184-108">不過，它們會併入到查詢結果中，就好像它們是 Cube 資料的一部分。</span><span class="sxs-lookup"><span data-stu-id="91184-108">However, they are incorporated into query results as if they are part of the cube data.</span></span>  
  
 <span data-ttu-id="91184-109">您可以啟用整個 Cube 或是只有 Cube 中某些資料分割的寫入功能；</span><span class="sxs-lookup"><span data-stu-id="91184-109">You can write-enable an entire cube or only certain partitions in the cube.</span></span> <span data-ttu-id="91184-110">可寫入維度是不同但互補的功能。</span><span class="sxs-lookup"><span data-stu-id="91184-110">Write-enabled dimensions are different but complementary.</span></span> <span data-ttu-id="91184-111">可寫入的資料分割讓使用者得以更新資料分割資料格，而可寫入維度則讓使用者得以更新維度成員，</span><span class="sxs-lookup"><span data-stu-id="91184-111">A write-enabled partition lets users update partition cells, whereas a write-enabled dimension lets users update dimension members.</span></span> <span data-ttu-id="91184-112">您也可以搭配使用這兩項功能。</span><span class="sxs-lookup"><span data-stu-id="91184-112">You can also use these two features in combination.</span></span> <span data-ttu-id="91184-113">例如，可寫入的 Cube 或可寫入的資料分割不需要包含任何可寫入的維度。</span><span class="sxs-lookup"><span data-stu-id="91184-113">For example, a write-enabled cube or a write-enabled partition does not have to include any write-enabled dimensions.</span></span> <span data-ttu-id="91184-114">**相關主題：** 可[寫入維度](../multidimensional-models-olap-logical-dimension-objects/write-enabled-dimensions.md)。</span><span class="sxs-lookup"><span data-stu-id="91184-114">**Related topic:**[Write-Enabled Dimensions](../multidimensional-models-olap-logical-dimension-objects/write-enabled-dimensions.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="91184-115">如果您想要啟用 Cube 的寫入功能，而這個 Cube 將 Microsoft Access 資料庫當成資料來源，請勿在 Cube、其資料分割或其維度的資料來源定義中使用 Microsoft OLE DB Provider for ODBC Drivers。</span><span class="sxs-lookup"><span data-stu-id="91184-115">If you want to write-enable a cube that has a Microsoft Access database as a data source, do not use Microsoft OLE DB Provider for ODBC Drivers in the data source definitions for the cube, its partitions, or its dimensions.</span></span> <span data-ttu-id="91184-116">而是使用 Microsoft Jet 4.0 OLE DB Provider，或任何含有 Jet 4.0 OLE 的 Jet Service Pack 版本。</span><span class="sxs-lookup"><span data-stu-id="91184-116">Instead, you can use Microsoft Jet 4.0 OLE DB Provider, or any version of the Jet Service Pack that includes Jet 4.0 OLE.</span></span> <span data-ttu-id="91184-117">如需詳細資訊，請參閱 Microsoft 知識庫文章[如何取得 Microsoft Jet 4.0 資料庫引擎的最新 Service Pack](https://support.microsoft.com/?kbid=239114)。</span><span class="sxs-lookup"><span data-stu-id="91184-117">For more information, see the Microsoft Knowledge Base article [How to obtain the latest service pack for the Microsoft Jet 4.0 Database Engine](https://support.microsoft.com/?kbid=239114).</span></span>  
  
 <span data-ttu-id="91184-118">只有在 Cube 的所有量值都使用 `Sum` 彙總函式時，才可寫入 Cube。</span><span class="sxs-lookup"><span data-stu-id="91184-118">A cube can be write-enabled only if all its measures use the `Sum` aggregate function.</span></span> <span data-ttu-id="91184-119">連結量值群組和本機 Cube 不可寫入。</span><span class="sxs-lookup"><span data-stu-id="91184-119">Linked measure groups and local cubes cannot be write-enabled.</span></span>  
  
## <a name="writeback-storage"></a><span data-ttu-id="91184-120">回寫儲存</span><span class="sxs-lookup"><span data-stu-id="91184-120">Writeback Storage</span></span>  
 <span data-ttu-id="91184-121">商務使用者所做的所有變更都會儲存在回寫資料表中，與目前顯示的值不同。</span><span class="sxs-lookup"><span data-stu-id="91184-121">Any change made by the business user is stored in the writeback table as a difference from the currently displayed value.</span></span> <span data-ttu-id="91184-122">例如，如果使用者將資料格值從 90 變更為 100，則 `+10` 這個值會和變更的時間以及進行此項變更之商務使用者的資訊，一起儲存在回寫資料表中。</span><span class="sxs-lookup"><span data-stu-id="91184-122">For example, if an end user changes a cell value from 90 to 100, the value `+10` is stored in the writeback table, together with the time of the change and information about the business user who made it.</span></span> <span data-ttu-id="91184-123">累積變更的淨影響會顯示在用戶端應用程式。</span><span class="sxs-lookup"><span data-stu-id="91184-123">The net effect of accumulated changes is displayed to client applications.</span></span> <span data-ttu-id="91184-124">將會保留 Cube 中的原始值，並且在回寫資料表中記錄變更的稽核記錄。</span><span class="sxs-lookup"><span data-stu-id="91184-124">The original value in the cube is preserved, and an audit trail of changes is recorded in the writeback table.</span></span>  
  
 <span data-ttu-id="91184-125">分葉和非分葉資料格的變更，其處理方式不同。</span><span class="sxs-lookup"><span data-stu-id="91184-125">Changes to leaf and nonleaf cells are handled differently.</span></span> <span data-ttu-id="91184-126">分葉資料格代表量值群組所參考之每個維度中的量值和分葉成員的交集。</span><span class="sxs-lookup"><span data-stu-id="91184-126">A leaf cell represents an intersection of a measure and a leaf member from every dimension referenced by the measure group.</span></span> <span data-ttu-id="91184-127">分葉資料格的值直接取自事實資料表，且無法向下鑽研來進一步分割。</span><span class="sxs-lookup"><span data-stu-id="91184-127">The value of a leaf cell is taken directly from the fact table, and cannot be divided further by drilling down.</span></span> <span data-ttu-id="91184-128">如果可寫入 Cube 或任何資料分割，則可以對分葉資料格進行變更。</span><span class="sxs-lookup"><span data-stu-id="91184-128">If a cube or any partition is write-enabled, changes can be made to a leaf cell.</span></span> <span data-ttu-id="91184-129">只有在用戶端應用程式提供方法，在構成非分葉資料格的分葉資料格之間散發變更時，才可以變更非分葉資料格。</span><span class="sxs-lookup"><span data-stu-id="91184-129">Changes can be made to a nonleaf cell only if the client application provides a way of distributing the changes among the leaf cells that make up the nonleaf cell.</span></span> <span data-ttu-id="91184-130">此處理序叫作配置，是透過多維度運算式 (MDX) 中的 UPDATE CUBE 陳述式加以管理。</span><span class="sxs-lookup"><span data-stu-id="91184-130">This process, called allocation, is managed through the UPDATE CUBE statement in Multidimensional Expressions (MDX).</span></span> <span data-ttu-id="91184-131">商業智慧開發人員可使用 UPDATE CUBE 陳述式來包含配置功能。</span><span class="sxs-lookup"><span data-stu-id="91184-131">Business intelligence developers can use the UPDATE CUBE statement to include allocation functionality.</span></span> <span data-ttu-id="91184-132">如需詳細資訊，請參閱[&#40;MDX&#41;的 UPDATE CUBE 語句](/sql/mdx/mdx-data-manipulation-update-cube)。</span><span class="sxs-lookup"><span data-stu-id="91184-132">For more information, see [UPDATE CUBE Statement &#40;MDX&#41;](/sql/mdx/mdx-data-manipulation-update-cube).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="91184-133">當更新的資料格未重疊時，`Update Isolation Level` 連接字串屬性可用來增強 UPDATE CUBE 的效能。</span><span class="sxs-lookup"><span data-stu-id="91184-133">When updated cells do not overlap, the `Update Isolation Level` connection string property can be used to enhance performance for UPDATE CUBE.</span></span> <span data-ttu-id="91184-134">如需詳細資訊，請參閱<xref:Microsoft.AnalysisServices.AdomdClient.AdomdConnection.ConnectionString%2A>。</span><span class="sxs-lookup"><span data-stu-id="91184-134">For more information, see <xref:Microsoft.AnalysisServices.AdomdClient.AdomdConnection.ConnectionString%2A>.</span></span>  
  
 <span data-ttu-id="91184-135">不論用戶端應用程式是否散發非分葉資料格的變更，每當評估查詢時，回寫資料表中的變更都會同時套用至分葉和非分葉資料格，好讓商務使用者可以檢視這些變更對整個 Cube 的影響。</span><span class="sxs-lookup"><span data-stu-id="91184-135">Regardless of whether a client application distributes changes that were made to nonleaf cells, whenever queries are evaluated, changes in the writeback table are applied to both leaf and nonleaf cells so that business users can view the effects of the changes throughout the cube.</span></span>  
  
 <span data-ttu-id="91184-136">商務使用者所做的變更會保留在您可以使用的個別回寫資料表中 (如下所示)：</span><span class="sxs-lookup"><span data-stu-id="91184-136">Changes that were made by the business user are kept in a separate writeback table that you can work with as follows:</span></span>  
  
-   <span data-ttu-id="91184-137">轉換至資料分割，以便將變更永久併入到 Cube 中。</span><span class="sxs-lookup"><span data-stu-id="91184-137">Convert to a partition to permanently incorporate changes into the cube.</span></span> <span data-ttu-id="91184-138">這個動作會讓量值群組變成唯讀。</span><span class="sxs-lookup"><span data-stu-id="91184-138">This action makes the measure group read-only.</span></span> <span data-ttu-id="91184-139">您可以指定篩選運算式來選取您要轉換的變更。</span><span class="sxs-lookup"><span data-stu-id="91184-139">You can specify a filter expression to select the changes you want to convert.</span></span>  
  
-   <span data-ttu-id="91184-140">捨棄它，使資料分割回到其原始狀態。</span><span class="sxs-lookup"><span data-stu-id="91184-140">Discard to return the partition to its original state.</span></span> <span data-ttu-id="91184-141">此動作使資料分割成為唯讀的。</span><span class="sxs-lookup"><span data-stu-id="91184-141">This action makes the partition read-only.</span></span>  
  
## <a name="security"></a><span data-ttu-id="91184-142">安全性</span><span class="sxs-lookup"><span data-stu-id="91184-142">Security</span></span>  
 <span data-ttu-id="91184-143">只有在商務使用者屬於對 Cube 資料格具有讀取/寫入權限的角色時，才可以在 Cube 的回寫資料表中記錄變更。</span><span class="sxs-lookup"><span data-stu-id="91184-143">A business user is permitted to record changes in a cube's writeback table only if the business user belongs to a role that has read/write permission to the cube's cells.</span></span> <span data-ttu-id="91184-144">對於每一個角色，您可以控制哪些 Cube 資料格可以更新，哪些不可以更新。</span><span class="sxs-lookup"><span data-stu-id="91184-144">For each role, you can control which cube cells can and cannot be updated.</span></span> <span data-ttu-id="91184-145">如需詳細資訊，請參閱[Grant cube 或 model 許可權 &#40;Analysis Services&#41;](../multidimensional-models/grant-cube-or-model-permissions-analysis-services.md)。</span><span class="sxs-lookup"><span data-stu-id="91184-145">For more information, see [Grant cube or model permissions &#40;Analysis Services&#41;](../multidimensional-models/grant-cube-or-model-permissions-analysis-services.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="91184-146">另請參閱</span><span class="sxs-lookup"><span data-stu-id="91184-146">See Also</span></span>  
 <span data-ttu-id="91184-147">[可寫入維度](../multidimensional-models-olap-logical-dimension-objects/write-enabled-dimensions.md) </span><span class="sxs-lookup"><span data-stu-id="91184-147">[Write-Enabled Dimensions](../multidimensional-models-olap-logical-dimension-objects/write-enabled-dimensions.md) </span></span>  
 <span data-ttu-id="91184-148">[匯總和匯總設計](../multidimensional-models-olap-logical-cube-objects/aggregations-and-aggregation-designs.md) </span><span class="sxs-lookup"><span data-stu-id="91184-148">[Aggregations and Aggregation Designs](../multidimensional-models-olap-logical-cube-objects/aggregations-and-aggregation-designs.md) </span></span>  
 <span data-ttu-id="91184-149">[分割區 &#40;Analysis Services 多維度資料&#41;](../multidimensional-models-olap-logical-cube-objects/partitions-analysis-services-multidimensional-data.md) </span><span class="sxs-lookup"><span data-stu-id="91184-149">[Partitions &#40;Analysis Services - Multidimensional Data&#41;](../multidimensional-models-olap-logical-cube-objects/partitions-analysis-services-multidimensional-data.md) </span></span>  
 [<span data-ttu-id="91184-150">可寫入維度</span><span class="sxs-lookup"><span data-stu-id="91184-150">Write-Enabled Dimensions</span></span>](../multidimensional-models-olap-logical-dimension-objects/write-enabled-dimensions.md)  
  
  
