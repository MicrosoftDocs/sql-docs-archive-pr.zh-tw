---
title: 匯總和匯總設計 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- aggregations [Analysis Services], about aggregations
- storage [Analysis Services], aggregations
- Storage Design Wizard
- data summary [Analysis Services]
- data storage [Analysis Services]
- storing data [Analysis Services], aggregations
- aggregations [Analysis Services]
ms.assetid: 35bd8589-39fa-4e0b-b28f-5a07d70da0a2
author: minewiskan
ms.author: owend
ms.openlocfilehash: c56e80482ef71e8041f8518ae9901691a1809990
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87700417"
---
# <a name="aggregations-and-aggregation-designs"></a><span data-ttu-id="b45c9-102">彙總和彙總設計</span><span class="sxs-lookup"><span data-stu-id="b45c9-102">Aggregations and Aggregation Designs</span></span>
  <span data-ttu-id="b45c9-103"> 物件會定義可在多個資料分割之間共用的一組彙總定義。</span><span class="sxs-lookup"><span data-stu-id="b45c9-103">An <xref:Microsoft.AnalysisServices.AggregationDesign> object defines a set of aggregation definitions that can be shared across multiple partitions.</span></span>  
  
 <span data-ttu-id="b45c9-104"> 物件表示在維度的某個資料粒度上之量值群組資料的摘要。</span><span class="sxs-lookup"><span data-stu-id="b45c9-104">An <xref:Microsoft.AnalysisServices.Aggregation> object represents the summarization of measure group data at certain granularity of the dimensions.</span></span>  
  
 <span data-ttu-id="b45c9-105">簡單的 <xref:Microsoft.AnalysisServices.Aggregation> 物件是由基本資訊和維度所組成。</span><span class="sxs-lookup"><span data-stu-id="b45c9-105">A simple <xref:Microsoft.AnalysisServices.Aggregation> object is composed of: basic information and dimensions.</span></span> <span data-ttu-id="b45c9-106">基本資訊包括彙總的名稱、識別碼、註解和描述。</span><span class="sxs-lookup"><span data-stu-id="b45c9-106">Basic information includes the name of the aggregation, the ID, annotations, and a description.</span></span> <span data-ttu-id="b45c9-107">維度是包含此維度之資料粒度屬性清單的 <xref:Microsoft.AnalysisServices.AggregationDimension> 物件集合。</span><span class="sxs-lookup"><span data-stu-id="b45c9-107">The dimensions are a collection of <xref:Microsoft.AnalysisServices.AggregationDimension> objects that contain the list of granularity attributes for the dimension.</span></span>  
  
 <span data-ttu-id="b45c9-108">彙總是預先計算之分葉資料格的資料摘要，</span><span class="sxs-lookup"><span data-stu-id="b45c9-108">Aggregations are precalculated summaries of data from leaf cells.</span></span> <span data-ttu-id="b45c9-109">彙總會藉由在詢問問題之前準備答案來縮短查詢回應時間。</span><span class="sxs-lookup"><span data-stu-id="b45c9-109">Aggregations improve query response time by preparing the answers before the questions are asked.</span></span> <span data-ttu-id="b45c9-110">例如，當資料倉儲事實資料表包含數十萬個資料列時，如果在查詢階段必須掃描和加總事實資料表的所有資料列才能計算出答案，則要求特定產品線每週總銷售量的查詢會需要花很多時間才會有答案。</span><span class="sxs-lookup"><span data-stu-id="b45c9-110">For example, when a data warehouse fact table contains hundreds of thousands of rows, a query requesting the weekly sales totals for a particular product line can take a long time to answer if all the rows in the fact table have to be scanned and summed at query time to compute the answer.</span></span> <span data-ttu-id="b45c9-111">但若已經預先計算好回答這個查詢的摘要資料，則幾乎可以立即回應。</span><span class="sxs-lookup"><span data-stu-id="b45c9-111">However, the response can be almost immediate if the summarization data to answer this query has been precalculated.</span></span> <span data-ttu-id="b45c9-112">在處理期間預先計算摘要資料，是 OLAP 技術之快速回應時間的基礎。</span><span class="sxs-lookup"><span data-stu-id="b45c9-112">This precalculation of summary data occurs during processing and is the foundation for the rapid response times of OLAP technology.</span></span>  
  
 <span data-ttu-id="b45c9-113">Cube 是 OLAP 技術將摘要資料組織成多維度結構的方式。</span><span class="sxs-lookup"><span data-stu-id="b45c9-113">Cubes are the way that OLAP technology organizes summary data into multidimensional structures.</span></span> <span data-ttu-id="b45c9-114">維度及其屬性階層會反映可要求得到 Cube 的查詢。</span><span class="sxs-lookup"><span data-stu-id="b45c9-114">Dimensions and their hierarchies of attributes reflect the queries that can be asked of the cube.</span></span> <span data-ttu-id="b45c9-115">彙總儲存在資料格的多維度結構中，由維度指定其座標。</span><span class="sxs-lookup"><span data-stu-id="b45c9-115">Aggregations are stored in the multidimensional structure in cells at coordinates specified by the dimensions.</span></span> <span data-ttu-id="b45c9-116">例如，「1998 年西北地區 X 產品的銷售如何？」這個問題</span><span class="sxs-lookup"><span data-stu-id="b45c9-116">For example, the question "What were the sales of product X in 1998 for the Northwest region?"</span></span> <span data-ttu-id="b45c9-117">包含三個維度 (Product、Time 和 Geography) 和一個量值 (Sales)。</span><span class="sxs-lookup"><span data-stu-id="b45c9-117">involves three dimensions (Product, Time, and Geography) and one measure (Sales).</span></span> <span data-ttu-id="b45c9-118">在 Cube 內之指定座標 (product X, 1998, Northwest) 上的資料格值就是答案，其為單一數值。</span><span class="sxs-lookup"><span data-stu-id="b45c9-118">The value of the cell in the cube at the specified coordinates (product X, 1998, Northwest) is the answer, a single numeric value.</span></span>  
  
 <span data-ttu-id="b45c9-119">其他問題可能會傳回多個值。</span><span class="sxs-lookup"><span data-stu-id="b45c9-119">Other questions may return multiple values.</span></span> <span data-ttu-id="b45c9-120">例如，「1998 年分區分季的硬體產品銷售量為何？</span><span class="sxs-lookup"><span data-stu-id="b45c9-120">For example, "How much were the sales of hardware products by quarter by region for 1998?"</span></span> <span data-ttu-id="b45c9-121">」，這樣的查詢會從滿足所指定條件的座標位置傳回儲存格組。</span><span class="sxs-lookup"><span data-stu-id="b45c9-121">Such queries return sets of cells from the coordinates that satisfy the specified conditions.</span></span> <span data-ttu-id="b45c9-122">查詢所傳回的資料格數目會根據產品維度之硬體層級的項目數目、1998 年四季，以及地理位置維度中的地區數目而定。</span><span class="sxs-lookup"><span data-stu-id="b45c9-122">The number of cells returned by the query depends on the number of items in the Hardware level of the Product dimension, the four quarters in 1998, and the number of regions in the Geography dimension.</span></span> <span data-ttu-id="b45c9-123">如果所有摘要資料都已經預先計算為彙總，則查詢的回應時間僅會根據擷取指定資料格所需要的時間而定。</span><span class="sxs-lookup"><span data-stu-id="b45c9-123">If all summary data has been precalculated into aggregations, the response time of the query will depend only on the time that is required to extract the specified cells.</span></span> <span data-ttu-id="b45c9-124">不需要計算或從事實資料表中讀取資料。</span><span class="sxs-lookup"><span data-stu-id="b45c9-124">No calculation or reading of data from the fact table is required.</span></span>  
  
 <span data-ttu-id="b45c9-125">雖然預先計算 Cube 內所有可能的彙總可能會提供所有查詢的最快可能回應時間，但是 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 可以輕鬆地從其他預先計算的彙總中計算出某些彙總值。</span><span class="sxs-lookup"><span data-stu-id="b45c9-125">Although precalculation of all possible aggregations in a cube might provide the fastest possible response time for all queries, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] can easily calculate some aggregrated values from other precalculated aggregations.</span></span> <span data-ttu-id="b45c9-126">此外，計算所有可能的彙總需要大量處理時間和儲存體。</span><span class="sxs-lookup"><span data-stu-id="b45c9-126">Additionally, calculating all possible aggregations requires significant processing time and storage.</span></span> <span data-ttu-id="b45c9-127">因此，在儲存需求與預先計算的可能彙總百分比之間會需要有所取捨。</span><span class="sxs-lookup"><span data-stu-id="b45c9-127">Therefore, there is a tradeoff between storage requirements and the percentage of possible aggregations that are precalculated.</span></span> <span data-ttu-id="b45c9-128">如果未預先計算任何彙總 (0%)，則 Cube 所需的處理時間和儲存空間數量會減至最少，但是因為必須從分葉資料格中擷取回答每一個查詢所需的資料，然後在查詢時加以彙總來回答每一個查詢，所以查詢回應時間可能會變慢。</span><span class="sxs-lookup"><span data-stu-id="b45c9-128">If no aggregations are precalculated (0%), the amount of required processing time and storage space for a cube is minimized, but query response time may be slow because the data required to answer each query must be retrieved from the leaf cells and then aggregated at query time to answer each query.</span></span> <span data-ttu-id="b45c9-129">例如，傳回單一數字來回答前面所問的問題 (「1998 年西北地區 X 產品的銷售如何？」) 可能需要讀取數千個資料列，並擷取資料行的值 (此資料行是用來提供每個資料列的銷售量值)，然後計算總和。</span><span class="sxs-lookup"><span data-stu-id="b45c9-129">For example, returning a single number that answers the question asked earlier ("What were the sales of product X in 1998 for the Northwest region") might require reading thousands of rows of data, extracting the value of the column used to provide the Sales measure from each row, and then calculating the sum.</span></span> <span data-ttu-id="b45c9-130">此外，抓取該資料所需的時間長度，會非常取決於針對資料所選擇的儲存模式-MOLAP、HOLAP 或 ROLAP。</span><span class="sxs-lookup"><span data-stu-id="b45c9-130">Moreover, the length of time required to retrieve that data will very depending on the storage mode chosen for the data-MOLAP, HOLAP, or ROLAP.</span></span>  
  
## <a name="designing-aggregations"></a><span data-ttu-id="b45c9-131">設計彙總</span><span class="sxs-lookup"><span data-stu-id="b45c9-131">Designing Aggregations</span></span>  
 [!INCLUDE[msCoName](../../includes/msconame-md.md)] <span data-ttu-id="b45c9-132">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 併入複雜的演算法來選取預先計算的彙總，以從預先計算的值中快速計算出其他彙總。</span><span class="sxs-lookup"><span data-stu-id="b45c9-132">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] incorporates a sophisticated algorithm to select aggregations for precalculation so that other aggregations can be quickly computed from the precalculated values.</span></span> <span data-ttu-id="b45c9-133">例如，如果針對時間階層的月份層級預先計算出彙總，則季查詢的計算只需要加總三個數字，就可以視需要快速計算出來。</span><span class="sxs-lookup"><span data-stu-id="b45c9-133">For example, if the aggregations are precalculated for the Month level of a Time hierarchy, the calculation for a Quarter level requires only the summarization of three numbers, which can be quickly computed on demand.</span></span> <span data-ttu-id="b45c9-134">這個技巧可節省處理時間，並減少儲存需求，且對查詢回應時間的影響最小。</span><span class="sxs-lookup"><span data-stu-id="b45c9-134">This technique saves processing time and reduces storage requirements, with minimal effect on query response time.</span></span>  
  
 <span data-ttu-id="b45c9-135">彙總設計精靈會提供選項讓您指定演算法的儲存體和百分比條件約束，以在查詢回應時間與儲存需求之間達成令人滿意的取捨。</span><span class="sxs-lookup"><span data-stu-id="b45c9-135">The Aggregation Design Wizard provides options for you to specify storage and percentage constraints on the algorithm to achieve a satisfactory tradeoff between query response time and storage requirements.</span></span> <span data-ttu-id="b45c9-136">不過，彙總設計精靈的演算法假設所有可能的查詢都同樣適合。</span><span class="sxs-lookup"><span data-stu-id="b45c9-136">However, the Aggregation Design Wizard's algorithm assumes that all possible queries are equally likely.</span></span> <span data-ttu-id="b45c9-137">基於使用方式的最佳化精靈可讓您分析用戶端應用程式所提交的查詢，以調整量值群組的彙總設計。</span><span class="sxs-lookup"><span data-stu-id="b45c9-137">The Usage-Based Optimization Wizard lets you adjust the aggregation design for a measure group by analyzing the queries that have been submitted by client applications.</span></span> <span data-ttu-id="b45c9-138">使用這個精靈來微調 Cube 的彙總，即可增加常見查詢的回應能力，以及減少不常見之查詢的回應能力，而不會對 Cube 的儲存需求有太大影響。</span><span class="sxs-lookup"><span data-stu-id="b45c9-138">By using the wizard to tune a cube's aggregation you can increase responsiveness to frequent queries and decrease responsiveness to infrequent queries without significantly affecting the storage needed for the cube.</span></span>  
  
 <span data-ttu-id="b45c9-139">雖然彙總是使用精靈所設計，但是除非已處理好所設計之彙總的資料分割，否則不會實際計算彙總。</span><span class="sxs-lookup"><span data-stu-id="b45c9-139">Aggregations are designed by using the wizards but are not actually calculated until the partition for which the aggregations are designed is processed.</span></span> <span data-ttu-id="b45c9-140">建立彙總之後，如果 Cube 的結構變更，或是在 Cube 的來源資料表中加入或變更資料，則通常會需要檢閱 Cube 的彙總並再次處理該 Cube。</span><span class="sxs-lookup"><span data-stu-id="b45c9-140">After the aggregation has been created, if the structure of a cube ever changes, or if data is added to or changed in a cube's source tables, it is usually necessary to review the cube's aggregations and process the cube again.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b45c9-141">另請參閱</span><span class="sxs-lookup"><span data-stu-id="b45c9-141">See Also</span></span>  
 [<span data-ttu-id="b45c9-142">資料分割儲存模式及處理</span><span class="sxs-lookup"><span data-stu-id="b45c9-142">Partition Storage Modes and Processing</span></span>](partitions-partition-storage-modes-and-processing.md)  
  
  
