---
title: " (XMLA) 設計匯總 |Microsoft Docs"
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- statistical information [XML for Analysis]
- batches [XML for Analysis]
- aggregations [Analysis Services], XML for Analysis
- XMLA, aggregations
- queries [XMLA]
- XML for Analysis, aggregations
- iterative aggregation process [XMLA]
ms.assetid: 4dd27afa-10c7-408d-bc24-ca74217ddbcb
author: minewiskan
ms.author: owend
ms.openlocfilehash: 632cc071605cff6e42adec4acd32c9bd9949fc77
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87599234"
---
# <a name="designing-aggregations-xmla"></a><span data-ttu-id="9f769-102">設計彙總 (XMLA)</span><span class="sxs-lookup"><span data-stu-id="9f769-102">Designing Aggregations (XMLA)</span></span>
  <span data-ttu-id="9f769-103">彙總設計會與特定量值群組的資料分割關聯，以確保資料分割在儲存彙總時會使用相同的結構。</span><span class="sxs-lookup"><span data-stu-id="9f769-103">Aggregation designs are associated with the partitions of a particular measure group to make sure that the partitions use the same structure when storing aggregations.</span></span> <span data-ttu-id="9f769-104">針對資料分割使用相同的儲存結構，可讓您輕鬆地定義稍後使用[MergePartitions](https://docs.microsoft.com/bi-reference/xmla/xml-elements-commands/mergepartitions-element-xmla)命令合併的資料分割。</span><span class="sxs-lookup"><span data-stu-id="9f769-104">Using the same storage structure for partitions lets you to easily define partitions that can be later merged using the [MergePartitions](https://docs.microsoft.com/bi-reference/xmla/xml-elements-commands/mergepartitions-element-xmla) command.</span></span> <span data-ttu-id="9f769-105">如需匯總設計的詳細資訊，請參閱匯總[和匯總設計](../multidimensional-models-olap-logical-cube-objects/aggregations-and-aggregation-designs.md)。</span><span class="sxs-lookup"><span data-stu-id="9f769-105">For more information about aggregation designs, see [Aggregations and Aggregation Designs](../multidimensional-models-olap-logical-cube-objects/aggregations-and-aggregation-designs.md).</span></span>  
  
 <span data-ttu-id="9f769-106">若要定義匯總設計的匯總，您可以在 XML for Analysis (XMLA) 中使用[DesignAggregations](https://docs.microsoft.com/bi-reference/xmla/xml-elements-commands/designaggregations-element-xmla)命令。</span><span class="sxs-lookup"><span data-stu-id="9f769-106">To define aggregations for an aggregation design, you can use the [DesignAggregations](https://docs.microsoft.com/bi-reference/xmla/xml-elements-commands/designaggregations-element-xmla) command in XML for Analysis (XMLA).</span></span> <span data-ttu-id="9f769-107">`DesignAggregations` 命令具有一些屬性，可識別要使用哪個彙總設計做為參考，以及如何根據該參考控制設計程序。</span><span class="sxs-lookup"><span data-stu-id="9f769-107">The `DesignAggregations` command has properties that identify which aggregation design to use as a reference and how to control the design process based upon that reference.</span></span> <span data-ttu-id="9f769-108">使用 `DesignAggregations` 命令及其屬性，您可以反覆或用批次方式設計彙總，然後檢視產生的設計統計資料以評估設計程序。</span><span class="sxs-lookup"><span data-stu-id="9f769-108">Using the `DesignAggregations` command and its properties, you can design aggregations iteratively or in batch, and then view the resulting design statistics to evaluate the design process.</span></span>  
  
## <a name="specifying-an-aggregation-design"></a><span data-ttu-id="9f769-109">指定彙總設計</span><span class="sxs-lookup"><span data-stu-id="9f769-109">Specifying an Aggregation Design</span></span>  
 <span data-ttu-id="9f769-110">命令的[object](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/object-element-xmla)屬性 `DesignAggregations` 必須包含現有匯總設計的物件參考。</span><span class="sxs-lookup"><span data-stu-id="9f769-110">The [Object](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/object-element-xmla) property of the `DesignAggregations` command must contain an object reference to an existing aggregation design.</span></span> <span data-ttu-id="9f769-111">物件參考包含資料庫識別碼、Cube 識別碼、量值群組識別碼以及彙總設計識別碼。</span><span class="sxs-lookup"><span data-stu-id="9f769-111">The object reference contains a database identifier, cube identifier, measure group identifier, and aggregation design identifier.</span></span> <span data-ttu-id="9f769-112">如果彙總設計尚未存在，就會發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="9f769-112">If the aggregation design does not already exist, an error occurs.</span></span>  
  
## <a name="controlling-the-design-process"></a><span data-ttu-id="9f769-113">控制設計程序</span><span class="sxs-lookup"><span data-stu-id="9f769-113">Controlling the Design Process</span></span>  
 <span data-ttu-id="9f769-114">您可以使用 `DesignAggregations` 命令的下列屬性來控制為彙總設計定義彙總的演算法。</span><span class="sxs-lookup"><span data-stu-id="9f769-114">You can use the following properties of the `DesignAggregations` command to control the algorithm used to define aggregations for the aggregation design:</span></span>  
  
-   <span data-ttu-id="9f769-115">[[步驟](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/steps-element-xmla)] 屬性會決定命令在將 `DesignAggregations` 控制權傳回給用戶端應用程式之前，應採取多少次反覆運算。</span><span class="sxs-lookup"><span data-stu-id="9f769-115">The [Steps](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/steps-element-xmla) property determines how many iterations the `DesignAggregations` command should take before it returns control to the client application.</span></span>  
  
-   <span data-ttu-id="9f769-116">[Time](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/time-element-xmla)屬性會決定命令將控制權傳回 `DesignAggregations` 給用戶端應用程式之前，應採取的毫秒數。</span><span class="sxs-lookup"><span data-stu-id="9f769-116">The [Time](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/time-element-xmla) property determines how many milliseconds the `DesignAggregations` command should take before it returns control to the client application.</span></span>  
  
-   <span data-ttu-id="9f769-117">[[優化](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/optimization-element-xmla)] 屬性 `DesignAggregations` 會決定命令應該嘗試達到的效能改進估計百分比。</span><span class="sxs-lookup"><span data-stu-id="9f769-117">The [Optimization](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/optimization-element-xmla) property determines the estimated percentage of performance improvement the `DesignAggregations` command should try to achieve.</span></span> <span data-ttu-id="9f769-118">如果您反覆設計彙總，只需要在第一個命令上傳送此屬性。</span><span class="sxs-lookup"><span data-stu-id="9f769-118">If you are iteratively designing aggregations, you only have to send this property on the first command.</span></span>  
  
-   <span data-ttu-id="9f769-119">[Storage](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/storage-element-xmla)屬性會決定命令所使用的磁片儲存體預估量（以位元組為單位） `DesignAggregations` 。</span><span class="sxs-lookup"><span data-stu-id="9f769-119">The [Storage](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/storage-element-xmla) property determines the estimated amount of disk storage, in bytes, used by the `DesignAggregations` command.</span></span> <span data-ttu-id="9f769-120">如果您反覆設計彙總，只需要在第一個命令上傳送此屬性。</span><span class="sxs-lookup"><span data-stu-id="9f769-120">If you are iteratively designing aggregations, you only have to send this property on the first command.</span></span>  
  
-   <span data-ttu-id="9f769-121">[具體化](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/materialize-element-xmla)屬性會決定命令是否 `DesignAggregations` 應該建立在設計過程中定義的匯總。</span><span class="sxs-lookup"><span data-stu-id="9f769-121">The [Materialize](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/materialize-element-xmla) property determines whether the `DesignAggregations` command should create the aggregations defined during the design process.</span></span> <span data-ttu-id="9f769-122">如果您反覆地設計彙總，此屬性應該設定為 False，直到您準備儲存設計的彙總為止。</span><span class="sxs-lookup"><span data-stu-id="9f769-122">If you are iteratively designing aggregations, this property should be set to false until you are ready to save the designed aggregations.</span></span> <span data-ttu-id="9f769-123">當設定為 True 時，目前的設計程序會結束，而定義的彙總會加入指定的彙總設計。</span><span class="sxs-lookup"><span data-stu-id="9f769-123">When set to true, the current design process ends and the defined aggregations are added to the specified aggregation design.</span></span>  
  
## <a name="specifying-queries"></a><span data-ttu-id="9f769-124">指定查詢</span><span class="sxs-lookup"><span data-stu-id="9f769-124">Specifying Queries</span></span>  
 <span data-ttu-id="9f769-125">DesignAggregations 命令會 `Query` 在 [[查詢](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/queries-element-xmla)] 屬性中包含一或多個元素，以支援基於使用方式的優化命令。</span><span class="sxs-lookup"><span data-stu-id="9f769-125">The DesignAggregations command supports usage-based optimization command by including one or more `Query` elements in the [Queries](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/queries-element-xmla) property.</span></span> <span data-ttu-id="9f769-126">`Queries`屬性可以包含一個或多個[查詢](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/query-element-xmla)元素。</span><span class="sxs-lookup"><span data-stu-id="9f769-126">The `Queries` property can contain one or more [Query](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/query-element-xmla) elements.</span></span> <span data-ttu-id="9f769-127">如果 `Queries` 屬性不包含任何 `Query` 元素，在 `Object` 元素中指定的彙總設計，會使用包含一組一般彙總的預設結構。</span><span class="sxs-lookup"><span data-stu-id="9f769-127">If the `Queries` property does not contain any `Query` elements, the aggregation design specified in the `Object` element uses a default structure that contains a general set of aggregations.</span></span> <span data-ttu-id="9f769-128">這組一般彙總的設計，是為了符合在 `Optimization` 命令的 `Storage` 與 `DesignAggregations` 屬性中所指定的準則。</span><span class="sxs-lookup"><span data-stu-id="9f769-128">This general set of aggregations is designed to meet the criteria specified in the `Optimization` and `Storage` properties of the `DesignAggregations` command.</span></span>  
  
 <span data-ttu-id="9f769-129">每個 `Query` 元素都代表一個目標查詢，而且設計處理序會使用此查詢來定義以最常用查詢為目標的彙總。</span><span class="sxs-lookup"><span data-stu-id="9f769-129">Each `Query` element represents a goal query that the design process uses to define aggregations that target the most frequently used queries.</span></span> <span data-ttu-id="9f769-130">您可以指定自己的目標查詢，也可以使用查詢記錄檔中實例所儲存的資訊， [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 來抓取最常使用之查詢的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="9f769-130">You can either specify your own goal queries, or you can use the information stored by an instance of [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in the query log to retrieve information about the most frequently used queries.</span></span> <span data-ttu-id="9f769-131">「基於使用方式的最佳化精靈」會在傳送 `DesignAggregations` 命令時，依據時間、使用方式或是指定的使用者，使用查詢記錄擷取目標查詢。</span><span class="sxs-lookup"><span data-stu-id="9f769-131">The Usage-Based Optimization Wizard uses the query log to retrieve goal queries based on time, usage, or a specified user when it sends a `DesignAggregations` command.</span></span> <span data-ttu-id="9f769-132">如需詳細資訊，請參閱[基於使用方式的優化 Wizard F1](../usage-based-optimization-wizard-f1-help.md)說明。</span><span class="sxs-lookup"><span data-stu-id="9f769-132">For more information, see [Usage-Based Optimization Wizard F1 Help](../usage-based-optimization-wizard-f1-help.md).</span></span>  
  
 <span data-ttu-id="9f769-133">如果您要反覆地設計彙總，只需要將目標查詢傳入第一個 `DesignAggregations` 命令即可，因為 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 執行個體會儲存這些目標查詢，然後在後續的 `DesignAggregations` 命令執行期間使用這些查詢。</span><span class="sxs-lookup"><span data-stu-id="9f769-133">If you are iteratively designing aggregations, you only have to pass goal queries in the first `DesignAggregations` command because the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance stores these goal queries and uses these queries during subsequent `DesignAggregations` commands.</span></span> <span data-ttu-id="9f769-134">當您將目標查詢傳入反覆處理序的第一個 `DesignAggregations` 命令之後，任何在 `DesignAggregations` 屬性中包含目標查詢的後續 `Queries` 命令就會產生錯誤。</span><span class="sxs-lookup"><span data-stu-id="9f769-134">After you pass goal queries in the first `DesignAggregations` command of an iterative process, any subsequent `DesignAggregations` command that contains goal queries in the `Queries` property generates an error.</span></span>  
  
 <span data-ttu-id="9f769-135">`Query` 元素包含具有下列引數的逗號分隔值：</span><span class="sxs-lookup"><span data-stu-id="9f769-135">The `Query` element contains a comma-delimited value that contains the following arguments:</span></span>  
  
 <span data-ttu-id="9f769-136">*Frequency*,*Dataset*[,*Dataset*...]</span><span class="sxs-lookup"><span data-stu-id="9f769-136">*Frequency*,*Dataset*[,*Dataset*...]</span></span>  
  
 <span data-ttu-id="9f769-137">*頻率*</span><span class="sxs-lookup"><span data-stu-id="9f769-137">*Frequency*</span></span>  
 <span data-ttu-id="9f769-138">對應至查詢先前執行次數的加權因數。</span><span class="sxs-lookup"><span data-stu-id="9f769-138">A weighting factor that corresponds to the number of times that the query has previously been executed.</span></span> <span data-ttu-id="9f769-139">如果專案 `Query` 代表新的查詢， *Frequency*值代表設計進程用來評估查詢的加權因數。</span><span class="sxs-lookup"><span data-stu-id="9f769-139">If the `Query` element represents a new query, the *Frequency* value represents the weighting factor used by the design process to evaluate the query.</span></span> <span data-ttu-id="9f769-140">當頻率值變大時，在設計處理序期間放置於查詢的加權就會增加。</span><span class="sxs-lookup"><span data-stu-id="9f769-140">As the frequency value becomes larger, the weight that is put on the query during the design process increases.</span></span>  
  
 <span data-ttu-id="9f769-141">*資料集*</span><span class="sxs-lookup"><span data-stu-id="9f769-141">*Dataset*</span></span>  
 <span data-ttu-id="9f769-142">指定維度的哪些屬性要包含在查詢中的數值字串。</span><span class="sxs-lookup"><span data-stu-id="9f769-142">A numeric string that specifies which attributes from a dimension are to be included in the query.</span></span> <span data-ttu-id="9f769-143">這個字串必須與維度中的屬性數目具有相同的字元數目。</span><span class="sxs-lookup"><span data-stu-id="9f769-143">This string must have the same number of characters as the number of attributes in the dimension.</span></span> <span data-ttu-id="9f769-144">零 (0) 表示指定之序數位置中的屬性沒有包含在指定維度的查詢中，而一 (1) 則表示指定之序數位置中的屬性已包含在指定維度的查詢中。</span><span class="sxs-lookup"><span data-stu-id="9f769-144">Zero (0) indicates that the attribute in the specified ordinal position is not included in the query for the specified dimension, while one (1) indicates that the attribute in the specified ordinal position is included in the query for the specified dimension.</span></span>  
  
 <span data-ttu-id="9f769-145">例如，字串 "011" 是指涉及含有三個屬性之維度的查詢，其中第二和第三個屬性包含在查詢中。</span><span class="sxs-lookup"><span data-stu-id="9f769-145">For example, the string "011" would refer to a query involving a dimension with three attributes, from which the second and third attributes are included in the query.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9f769-146">某些屬性會從資料集的考量中排除。</span><span class="sxs-lookup"><span data-stu-id="9f769-146">Some attributes are excluded from consideration in the dataset.</span></span> <span data-ttu-id="9f769-147">如需排除屬性的詳細資訊，請參閱[&#40;XMLA&#41;的查詢元素](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/query-element-xmla)。</span><span class="sxs-lookup"><span data-stu-id="9f769-147">For more information about excluded attributes, see [Query Element &#40;XMLA&#41;](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/query-element-xmla).</span></span>  
  
 <span data-ttu-id="9f769-148">量值群組中包含匯總設計的每個維度，都是以元素中的*資料集*值來表示 `Query` 。</span><span class="sxs-lookup"><span data-stu-id="9f769-148">Each dimension in the measure group that contains the aggregation design is represented by a *Dataset* value in the `Query` element.</span></span> <span data-ttu-id="9f769-149">*Dataset* 值的順序必須與量值群組中包含維度的順序相符。</span><span class="sxs-lookup"><span data-stu-id="9f769-149">The order of *Dataset* values must match the order of dimensions included in the measure group.</span></span>  
  
## <a name="designing-aggregations-using-iterative-or-batch-processes"></a><span data-ttu-id="9f769-150">使用反覆或批次程序來設計彙總</span><span class="sxs-lookup"><span data-stu-id="9f769-150">Designing Aggregations Using Iterative or Batch Processes</span></span>  
 <span data-ttu-id="9f769-151">您可以在反覆程序或是批次程序中使用 `DesignAggregations` 命令，端視設計程序所需的互動性而定。</span><span class="sxs-lookup"><span data-stu-id="9f769-151">You can use the `DesignAggregations` command as part of an iterative process or a batch process, depending on the interactivity required by the design process.</span></span>  
  
### <a name="designing-aggregations-using-an-iterative-process"></a><span data-ttu-id="9f769-152">使用反覆程序來設計彙總</span><span class="sxs-lookup"><span data-stu-id="9f769-152">Designing Aggregations Using an Iterative Process</span></span>  
 <span data-ttu-id="9f769-153">若要反覆設計彙總，您可以傳送多個 `DesignAggregations` 命令，以提供設計程序的良好控制。</span><span class="sxs-lookup"><span data-stu-id="9f769-153">To iteratively design aggregations, you send multiple `DesignAggregations` commands to provide fine control over the design process.</span></span> <span data-ttu-id="9f769-154">「彙總設計精靈」使用這個相同的方法來提供設計程序的良好控制。</span><span class="sxs-lookup"><span data-stu-id="9f769-154">The Aggregation Design Wizard uses this same approach to provide fine control over the design process.</span></span> <span data-ttu-id="9f769-155">如需詳細資訊，請參閱[匯總設計嚮導 F1](../aggregation-design-wizard-f1-help.md)說明。</span><span class="sxs-lookup"><span data-stu-id="9f769-155">For more information, see [Aggregation Design Wizard F1 Help](../aggregation-design-wizard-f1-help.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9f769-156">需要明確的工作階段，以反覆設計彙總。</span><span class="sxs-lookup"><span data-stu-id="9f769-156">An explicit session is required to iteratively design aggregations.</span></span> <span data-ttu-id="9f769-157">如需明確會話的詳細資訊，請參閱[&#40;XMLA&#41;管理連接和會話](managing-connections-and-sessions-xmla.md)。</span><span class="sxs-lookup"><span data-stu-id="9f769-157">For more information about explicit sessions, see [Managing Connections and Sessions &#40;XMLA&#41;](managing-connections-and-sessions-xmla.md).</span></span>  
  
 <span data-ttu-id="9f769-158">若要開始反覆程序，請先傳送包含下列資訊的 `DesignAggregations` 命令：</span><span class="sxs-lookup"><span data-stu-id="9f769-158">To start the iterative process, you first send a `DesignAggregations` command that contains the following information:</span></span>  
  
-   <span data-ttu-id="9f769-159">以整個設計程序為目標的 `Storage` 與 `Optimization` 屬性值。</span><span class="sxs-lookup"><span data-stu-id="9f769-159">The `Storage` and `Optimization` property values on which the whole design process is targeted.</span></span>  
  
-   <span data-ttu-id="9f769-160">限制設計程序之第一個步驟的 `Steps` 與 `Time` 屬性值。</span><span class="sxs-lookup"><span data-stu-id="9f769-160">The `Steps` and `Time` property values on which the first step of the design process is limited.</span></span>  
  
-   <span data-ttu-id="9f769-161">如果您想要基於使用方式的最佳化，還要提供 `Queries` 屬性，其中包含整個設計程序的目標查詢。</span><span class="sxs-lookup"><span data-stu-id="9f769-161">If you want usage-based optimization, the `Queries` property that contains the goal queries on which the whole design process is targeted.</span></span>  
  
-   <span data-ttu-id="9f769-162">設定為 False 的 `Materialize` 屬性。</span><span class="sxs-lookup"><span data-stu-id="9f769-162">The `Materialize` property set to false.</span></span> <span data-ttu-id="9f769-163">將此屬性設定為 False，表示設計程序不會在命令完成時將定義的彙總儲存至彙總設計。</span><span class="sxs-lookup"><span data-stu-id="9f769-163">Setting this property to false indicates that the design process does not save the defined aggregations to the aggregation design when the command is completed.</span></span>  
  
 <span data-ttu-id="9f769-164">當第一個 `DesignAggregations` 命令完成時，命令會傳回包含設計統計資料的資料列集。</span><span class="sxs-lookup"><span data-stu-id="9f769-164">When the first `DesignAggregations` command finishes, the command returns a rowset that contains design statistics.</span></span> <span data-ttu-id="9f769-165">您可以評估這些設計統計資料，以判斷設計程序是否應該繼續或者設計程序是否已完成。</span><span class="sxs-lookup"><span data-stu-id="9f769-165">You can evaluate these design statistics to determine whether the design process should continue or whether the design process is finished.</span></span> <span data-ttu-id="9f769-166">如果程序應該繼續，則請傳送另一個 `DesignAggregations` 命令，以包含限制設計程序此步驟的 `Steps` 與 `Time` 值。</span><span class="sxs-lookup"><span data-stu-id="9f769-166">If the process should continue, you then send another `DesignAggregations` command that contains the `Steps` and `Time` values with which this step of the design process is limited.</span></span> <span data-ttu-id="9f769-167">您可以評估產生的統計資料，然後判斷設計程序是否應該繼續。</span><span class="sxs-lookup"><span data-stu-id="9f769-167">You evaluate the resulting statistics and then determine whether the design process should continue.</span></span> <span data-ttu-id="9f769-168">傳送 `DesignAggregations` 命令與評估結果的反覆程序會繼續，直到您達成目標並且有一組適當定義的彙總為止。</span><span class="sxs-lookup"><span data-stu-id="9f769-168">This iterative process of sending `DesignAggregations` commands and evaluating the results continues until you reach your goals and have a appropriate set of aggregations defined.</span></span>  
  
 <span data-ttu-id="9f769-169">在您達到所需的彙總之後，傳送最後一次的 `DesignAggregations` 命令。</span><span class="sxs-lookup"><span data-stu-id="9f769-169">After you have reached the set of aggregations that you want, you send one final `DesignAggregations` command.</span></span> <span data-ttu-id="9f769-170">這個最後的 `DesignAggregations` 命令應該將 `Steps` 屬性設定為 1，並將其 `Materialize` 屬性設定為 True。</span><span class="sxs-lookup"><span data-stu-id="9f769-170">This final `DesignAggregations` command should have its `Steps` property set to 1 and its `Materialize` property set to true.</span></span> <span data-ttu-id="9f769-171">透過使用這些設定，這個最後的 `DesignAggregations` 命令會完成設計程序，並將定義的彙總儲存到彙總設計。</span><span class="sxs-lookup"><span data-stu-id="9f769-171">By using these settings, this final `DesignAggregations` command completes the design process and saves the defined aggregation to the aggregation design.</span></span>  
  
### <a name="designing-aggregations-using-a-batch-process"></a><span data-ttu-id="9f769-172">使用批次程序來設計彙總</span><span class="sxs-lookup"><span data-stu-id="9f769-172">Designing Aggregations Using a Batch Process</span></span>  
 <span data-ttu-id="9f769-173">您也可以透過傳送單一 `DesignAggregations` 命令，以包含以整個設計程序為目標並使其受限的 `Steps`、`Time`、`Storage` 和 `Optimization` 屬性值，從而在批次程序中設計彙總。</span><span class="sxs-lookup"><span data-stu-id="9f769-173">You can also design aggregations in a batch process by sending a single `DesignAggregations` command that contains the `Steps`, `Time`, `Storage`, and `Optimization` property values on which the whole design process is targeted and limited.</span></span> <span data-ttu-id="9f769-174">如果您想要基於使用方式的最佳化，以設計程序為目標的目標查詢也應該包含在 `Queries` 屬性中。</span><span class="sxs-lookup"><span data-stu-id="9f769-174">If you want usage-based optimization, the goal queries on which the design process is targeted should also be included in the `Queries` property.</span></span> <span data-ttu-id="9f769-175">另外請確定 `Materialize` 屬性是設定為 True，這樣設計程序就會在命令完成時，將定義的彙總儲存到彙總設計。</span><span class="sxs-lookup"><span data-stu-id="9f769-175">Also make sure that the `Materialize` property is set to true, so that the design process saves the defined aggregations to the aggregation design when the command finishes.</span></span>  
  
 <span data-ttu-id="9f769-176">您可以在隱含或明確的工作階段中使用批次程序來設計彙總。</span><span class="sxs-lookup"><span data-stu-id="9f769-176">You can design aggregations using a batch process in either an implicit or explicit session.</span></span> <span data-ttu-id="9f769-177">如需隱含和明確會話的詳細資訊，請參閱[&#40;XMLA&#41;管理連接和會話](managing-connections-and-sessions-xmla.md)。</span><span class="sxs-lookup"><span data-stu-id="9f769-177">For more information about implicit and explicit sessions, see [Managing Connections and Sessions &#40;XMLA&#41;](managing-connections-and-sessions-xmla.md).</span></span>  
  
## <a name="returning-design-statistics"></a><span data-ttu-id="9f769-178">傳回設計統計資料</span><span class="sxs-lookup"><span data-stu-id="9f769-178">Returning Design Statistics</span></span>  
 <span data-ttu-id="9f769-179">當 `DesignAggregations` 命令將控制權還給用戶端應用程式時，命令會傳回包含單一資料列的資料列集，該資料列代表命令的設計統計資料。</span><span class="sxs-lookup"><span data-stu-id="9f769-179">When the `DesignAggregations` command returns control to the client application, the command returns a rowset that contains a single row representing the design statistics for the command.</span></span> <span data-ttu-id="9f769-180">資料列集包含下表中列出的資料行。</span><span class="sxs-lookup"><span data-stu-id="9f769-180">The rowset contains the columns listed in the following table.</span></span>  
  
|<span data-ttu-id="9f769-181">資料行</span><span class="sxs-lookup"><span data-stu-id="9f769-181">Column</span></span>|<span data-ttu-id="9f769-182">資料類型</span><span class="sxs-lookup"><span data-stu-id="9f769-182">Data type</span></span>|<span data-ttu-id="9f769-183">描述</span><span class="sxs-lookup"><span data-stu-id="9f769-183">Description</span></span>|  
|------------|---------------|-----------------|  
|<span data-ttu-id="9f769-184">步驟</span><span class="sxs-lookup"><span data-stu-id="9f769-184">Steps</span></span>|<span data-ttu-id="9f769-185">整數</span><span class="sxs-lookup"><span data-stu-id="9f769-185">Integer</span></span>|<span data-ttu-id="9f769-186">在將控制權還給用戶端應用程式之前，命令所使用的步驟數目。</span><span class="sxs-lookup"><span data-stu-id="9f769-186">The number of steps taken by the command before returning control to the client application.</span></span>|  
|<span data-ttu-id="9f769-187">Time</span><span class="sxs-lookup"><span data-stu-id="9f769-187">Time</span></span>|<span data-ttu-id="9f769-188">長整數</span><span class="sxs-lookup"><span data-stu-id="9f769-188">Long integer</span></span>|<span data-ttu-id="9f769-189">在將控制權還給用戶端應用程式之前，命令所花費的毫秒數目。</span><span class="sxs-lookup"><span data-stu-id="9f769-189">The number of milliseconds taken by the command before returning control to the client application.</span></span>|  
|<span data-ttu-id="9f769-190">Optimization</span><span class="sxs-lookup"><span data-stu-id="9f769-190">Optimization</span></span>|<span data-ttu-id="9f769-191">Double</span><span class="sxs-lookup"><span data-stu-id="9f769-191">Double</span></span>|<span data-ttu-id="9f769-192">在將控制權還給用戶端應用程式之前，命令所達成的效能改善估計百分比。</span><span class="sxs-lookup"><span data-stu-id="9f769-192">The estimated percentage of performance improvement achieved by the command before returning control to the client application.</span></span>|  
|<span data-ttu-id="9f769-193">儲存體</span><span class="sxs-lookup"><span data-stu-id="9f769-193">Storage</span></span>|<span data-ttu-id="9f769-194">長整數</span><span class="sxs-lookup"><span data-stu-id="9f769-194">Long integer</span></span>|<span data-ttu-id="9f769-195">在將控制權還給用戶端應用程式之前，命令所使用的位元組估計數目。</span><span class="sxs-lookup"><span data-stu-id="9f769-195">The estimated number of bytes taken by the command before returning control to the client application.</span></span>|  
|<span data-ttu-id="9f769-196">彙總</span><span class="sxs-lookup"><span data-stu-id="9f769-196">Aggregations</span></span>|<span data-ttu-id="9f769-197">長整數</span><span class="sxs-lookup"><span data-stu-id="9f769-197">Long integer</span></span>|<span data-ttu-id="9f769-198">在將控制權還給用戶端應用程式之前，命令所定義的彙總數目。</span><span class="sxs-lookup"><span data-stu-id="9f769-198">The number of aggregations defined by the command before returning control to the client application.</span></span>|  
|<span data-ttu-id="9f769-199">LastStep</span><span class="sxs-lookup"><span data-stu-id="9f769-199">LastStep</span></span>|<span data-ttu-id="9f769-200">Boolean</span><span class="sxs-lookup"><span data-stu-id="9f769-200">Boolean</span></span>|<span data-ttu-id="9f769-201">指出在資料列集中的資料是否代表設計程序中的最後一個步驟。</span><span class="sxs-lookup"><span data-stu-id="9f769-201">Indicates whether the data in the rowset represents the last step in the design process.</span></span> <span data-ttu-id="9f769-202">如果命令的 `Materialize` 屬性設定為 True，就會將這個資料行值設定為 True。</span><span class="sxs-lookup"><span data-stu-id="9f769-202">If the `Materialize` property of the command was set to true,  the value of this column is set to true.</span></span>|  
  
 <span data-ttu-id="9f769-203">您可以將每一個 `DesignAggregations` 命令之後傳回的資料列集內所含的設計統計資料用在反覆設計或批次設計。</span><span class="sxs-lookup"><span data-stu-id="9f769-203">You can use the design statistics that are contained in the rowset returned after each `DesignAggregations` command in both iterative and batch design.</span></span> <span data-ttu-id="9f769-204">在反覆設計中，您可以使用設計統計資料以判斷和顯示進度。</span><span class="sxs-lookup"><span data-stu-id="9f769-204">In iterative design, you can use the design statistics to determine and display progress.</span></span> <span data-ttu-id="9f769-205">當您以批次方式設計彙總時，可以使用設計統計資料來判斷命令所建立的彙總數目。</span><span class="sxs-lookup"><span data-stu-id="9f769-205">When you are designing aggregations in batch, you can use the design statistics to determine the number of aggregations created by the command.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9f769-206">另請參閱</span><span class="sxs-lookup"><span data-stu-id="9f769-206">See Also</span></span>  
 [<span data-ttu-id="9f769-207">在 Analysis Services 中使用 XMLA 進行開發</span><span class="sxs-lookup"><span data-stu-id="9f769-207">Developing with XMLA in Analysis Services</span></span>](developing-with-xmla-in-analysis-services.md)  
  
  
