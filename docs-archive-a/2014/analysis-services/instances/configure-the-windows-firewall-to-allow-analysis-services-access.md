---
title: 設定 Windows 防火牆以允許 Analysis Services 存取 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- ports [Analysis Services]
- Windows Firewall [Analysis Services]
- firewall systems [Analysis Services]
ms.assetid: 7673acc5-75f0-4703-9ce2-87425ea39d49
author: minewiskan
ms.author: owend
ms.openlocfilehash: f7d63b392148bf10a6b121dd4d201b7a7c61e0c4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87698854"
---
# <a name="configure-the-windows-firewall-to-allow-analysis-services-access"></a><span data-ttu-id="03ee8-102">設定 Windows 防火牆以允許 Analysis Services 存取</span><span class="sxs-lookup"><span data-stu-id="03ee8-102">Configure the Windows Firewall to Allow Analysis Services Access</span></span>
  <span data-ttu-id="03ee8-103">讓 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 或 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 在網路上可供使用的第一個必要步驟為判斷您是否需要在防火牆中解除封鎖通訊埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-103">An essential first step in making [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] or [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] available on the network is to determine whether you need to unblock ports in a firewall.</span></span> <span data-ttu-id="03ee8-104">大部分安裝都要求您至少建立一個傳入防火牆規則來允許連接至 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="03ee8-104">Most installations will require that you create at least one in-bound firewall rule that allows connections to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="03ee8-105">防火牆組態需求視 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]安裝方式而異：</span><span class="sxs-lookup"><span data-stu-id="03ee8-105">Firewall configuration requirements vary depending on how you installed [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]:</span></span>  
  
-   <span data-ttu-id="03ee8-106">當您安裝預設執行個體或建立 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 容錯移轉叢集時，開啟 TCP 通訊埠 2383。</span><span class="sxs-lookup"><span data-stu-id="03ee8-106">Open TCP port 2383 when installing a default instance or creating an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] failover cluster.</span></span>  
  
-   <span data-ttu-id="03ee8-107">安裝具名執行個體時，開啟 TCP 通訊埠 2382。</span><span class="sxs-lookup"><span data-stu-id="03ee8-107">Open TCP port 2382 when installing a named instance.</span></span> <span data-ttu-id="03ee8-108">具名執行個體使用動態通訊埠指派。</span><span class="sxs-lookup"><span data-stu-id="03ee8-108">Named instances use dynamic port assignments.</span></span> <span data-ttu-id="03ee8-109">作為 Analysis Services 的探索服務，SQL Server Browser 服務會接聽 TCP 通訊埠 2382，並將連接要求重新導向至 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]目前使用的連接埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-109">As the discovery service for Analysis Services, SQL Server Browser service listens on TCP port 2382 and redirects the connection request to the port currently used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="03ee8-110">以 SharePoint 模式安裝 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 時，開啟 TCP 通訊埠 2382 以支援 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013。</span><span class="sxs-lookup"><span data-stu-id="03ee8-110">Open TCP port 2382 when installing [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in SharePoint mode to support [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013.</span></span> <span data-ttu-id="03ee8-111">在 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013， [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 執行個體是在 SharePoint 外部。</span><span class="sxs-lookup"><span data-stu-id="03ee8-111">In [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013, the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance is external to SharePoint.</span></span> <span data-ttu-id="03ee8-112">對於具名 'PowerPivot' 執行個體的傳入要求是透過網路連接源自 SharePoint Web 應用程式，因此需要開啟通訊埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-112">Inbound requests to the named 'PowerPivot' instance originate from SharePoint web applications over a network connection, requiring an open port.</span></span> <span data-ttu-id="03ee8-113">如同其他 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 具名執行個體，為在 TCP 2382 的 SQL Server Browser 服務建立輸入規則，以允許存取 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="03ee8-113">As with other [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] named instances, create an inbound rule for SQL Server Browser service on TCP 2382 to allow access to [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span>  
  
-   <span data-ttu-id="03ee8-114">如果是 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2010，請勿在 Windows 防火牆中開啟連接埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-114">For [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2010, do not open ports in Windows Firewall.</span></span> <span data-ttu-id="03ee8-115">做為 SharePoint 增益集，此服務會使用為 SharePoint 設定的通訊埠，而且只對載入和查詢 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 資料模型的 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 執行個體建立本機連接。</span><span class="sxs-lookup"><span data-stu-id="03ee8-115">As an add-in to SharePoint, the service uses ports configured for SharePoint and makes only local connections to the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance that loads and queries [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data models.</span></span>  
  
-   <span data-ttu-id="03ee8-116">若為 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 在 Azure 虛擬機器上執行的實例，請使用設定伺服器存取的其他指示。</span><span class="sxs-lookup"><span data-stu-id="03ee8-116">For [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instances running on Azure Virtual Machines, use alternate instructions for configuring server access.</span></span> <span data-ttu-id="03ee8-117">請參閱[Azure 虛擬機器中 SQL Server 的商業智慧](https://msdn.microsoft.com/library/windowsazure/jj992719.aspx)。</span><span class="sxs-lookup"><span data-stu-id="03ee8-117">See [SQL Server Business Intelligence in Azure Virtual Machines](https://msdn.microsoft.com/library/windowsazure/jj992719.aspx).</span></span>  
  
 <span data-ttu-id="03ee8-118">雖然的預設實例 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 會接聽 TCP 通訊埠2383，但您可以將伺服器設定為在不同的固定通訊埠上接聽，並以下列格式連接到伺服器： \<servername> ： \<portnumber> 。</span><span class="sxs-lookup"><span data-stu-id="03ee8-118">Although the default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listens on TCP port 2383, you can configure the server to listen on a different fixed port, connecting to the server in this format: \<servername>:\<portnumber>.</span></span>  
  
 <span data-ttu-id="03ee8-119">只有一個 TCP 通訊埠可供 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 執行個體使用。</span><span class="sxs-lookup"><span data-stu-id="03ee8-119">Only one TCP port can be used by an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.</span></span> <span data-ttu-id="03ee8-120">在擁有多網路卡或多個 IP 位址的電腦上， [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 會接聽一個指派給電腦之所有 IP 位址或別名位址的 TCP 通訊埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-120">On computers having multiple network cards or multiple IP addresses, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listens on one TCP port for all IP addresses assigned or aliased to the computer.</span></span> <span data-ttu-id="03ee8-121">如果您有特定多通訊埠需求，請考慮設定 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 使用 HTTP 存取。</span><span class="sxs-lookup"><span data-stu-id="03ee8-121">If you have specific multi-port requirements, consider configuring [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] for HTTP access.</span></span> <span data-ttu-id="03ee8-122">如此一來，您就可以將多個 HTTP 端點設定在所選擇的通訊埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-122">You can then set up multiple HTTP endpoints on whatever ports you choose.</span></span> <span data-ttu-id="03ee8-123">請參閱[設定 Internet Information Services &#40;IIS&#41; 8.0 上 Analysis Services 的 HTTP 存取](configure-http-access-to-analysis-services-on-iis-8-0.md)。</span><span class="sxs-lookup"><span data-stu-id="03ee8-123">See [Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span></span>  
  
 <span data-ttu-id="03ee8-124">本主題包含下列幾節：</span><span class="sxs-lookup"><span data-stu-id="03ee8-124">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="03ee8-125">檢查 Analysis Services 所使用的通訊埠和防火牆設定</span><span class="sxs-lookup"><span data-stu-id="03ee8-125">Check port and firewall settings for Analysis Services</span></span>](#bkmk_checkport)  
  
-   [<span data-ttu-id="03ee8-126">Analysis Services 的預設實例設定 Windows 防火牆</span><span class="sxs-lookup"><span data-stu-id="03ee8-126">Configure Windows Firewall for a default instance of Analysis Services</span></span>](#bkmk_default)  
  
-   [<span data-ttu-id="03ee8-127">為 Analysis Services 的具名執行個體設定 Windows 防火牆存取</span><span class="sxs-lookup"><span data-stu-id="03ee8-127">Configure Windows Firewall access for a named instance of Analysis Services</span></span>](#bkmk_named)  
  
-   [<span data-ttu-id="03ee8-128">Analysis Services 叢集的通訊埠組態</span><span class="sxs-lookup"><span data-stu-id="03ee8-128">Port configuration for an Analysis Services cluster</span></span>](#bkmk_cluster)  
  
-   [<span data-ttu-id="03ee8-129">PowerPivot for SharePoint 的通訊埠組態</span><span class="sxs-lookup"><span data-stu-id="03ee8-129">Port configuration for PowerPivot for SharePoint</span></span>](#bkmk_powerpivot)  
  
-   [<span data-ttu-id="03ee8-130">針對 Analysis Services 的預設或具名執行個體使用固定通訊埠</span><span class="sxs-lookup"><span data-stu-id="03ee8-130">Use a fixed port for a default or named instance of Analysis Services</span></span>](#bkmk_fixed)  
  
 <span data-ttu-id="03ee8-131">如需預設 Windows 防火牆設定的詳細資訊以及影響 Database Engine、Analysis Services、Reporting Services 和 Integration Services 之 TCP 通訊埠的描述，請參閱 [設定 Windows 防火牆以允許 SQL Server 存取](../../sql-server/install/configure-the-windows-firewall-to-allow-sql-server-access.md)。</span><span class="sxs-lookup"><span data-stu-id="03ee8-131">For more information about the default Windows firewall settings, and a description of the TCP ports that affect the Database Engine, Analysis Services, Reporting Services, and Integration Services, see [Configure the Windows Firewall to Allow SQL Server Access](../../sql-server/install/configure-the-windows-firewall-to-allow-sql-server-access.md).</span></span>  
  
##  <a name="check-port-and-firewall-settings-for-analysis-services"></a><a name="bkmk_checkport"></a><span data-ttu-id="03ee8-132">檢查 Analysis Services 的通訊埠和防火牆設定</span><span class="sxs-lookup"><span data-stu-id="03ee8-132">Check port and firewall settings for Analysis Services</span></span>  
 <span data-ttu-id="03ee8-133">在 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]支援的 Microsoft Windows 作業系統中，Windows 防火牆預設為開啟，並且封鎖了遠端連線。</span><span class="sxs-lookup"><span data-stu-id="03ee8-133">On the Microsoft Windows operating systems that are supported by [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], Windows Firewall is on by default and is blocking remote connections.</span></span> <span data-ttu-id="03ee8-134">您必須手動在防火牆中開啟通訊埠，允許傳入要求至 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="03ee8-134">You must manually open a port in the firewall to allow inbound requests to Analysis Services.</span></span> <span data-ttu-id="03ee8-135">SQL Server 安裝程式不會為您執行此步驟。</span><span class="sxs-lookup"><span data-stu-id="03ee8-135">SQL Server Setup does not perform this step for you.</span></span>  
  
 <span data-ttu-id="03ee8-136">您可以在 msmdsrv.ini 檔和 SQL Server Management Studio 之 Analysis Services 執行個體的 [一般屬性] 頁面中指定通訊埠設定。</span><span class="sxs-lookup"><span data-stu-id="03ee8-136">Port settings are specified in the msmdsrv.ini file and in the General properties page of an Analysis Services instance in SQL Server Management Studio.</span></span> <span data-ttu-id="03ee8-137">如果 `Port` 設定為正整數，表示服務將接聽固定通訊埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-137">If `Port` is set to a positive integer, the service is listening on a fixed port.</span></span> <span data-ttu-id="03ee8-138">如果 `Port` 設定為 0，表示服務將接聽通訊埠 2383 (Analysis Services 執行個體為預設執行個體) 或動態指派的通訊埠 (Analysis Services 執行個體為具名執行個體)。</span><span class="sxs-lookup"><span data-stu-id="03ee8-138">If `Port` is set to 0, the service is listening on port 2383 if it is the default instance or on a dynamically assigned port if it is a named instance.</span></span>  
  
 <span data-ttu-id="03ee8-139">只有具名執行個體會使用動態通訊埠指派。</span><span class="sxs-lookup"><span data-stu-id="03ee8-139">Dynamic port assignments are only used by named instances.</span></span> <span data-ttu-id="03ee8-140"> 服務會在啟動時決定要使用的通訊埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-140">The `MSOLAP$InstanceName` service determines which port to use when it starts up.</span></span> <span data-ttu-id="03ee8-141">您可以執行下列步驟，決定要由具名執行個體使用的實際通訊埠編號：</span><span class="sxs-lookup"><span data-stu-id="03ee8-141">You can determine the actual port number in use by a named instance by doing the following:</span></span>  
  
-   <span data-ttu-id="03ee8-142">啟動 [工作管理員]，然後按一下 [**服務**] 以取得的 PID `MSOLAP$InstanceName` 。</span><span class="sxs-lookup"><span data-stu-id="03ee8-142">Start Task Manager and then click **Services** to get the PID of the `MSOLAP$InstanceName`.</span></span>  
  
-   <span data-ttu-id="03ee8-143">從命令列執行 `netstat -ao -p TCP`，查看該 PID 使用的 TCP 通訊埠資訊。</span><span class="sxs-lookup"><span data-stu-id="03ee8-143">Run `netstat -ao -p TCP` from the command line to view the TCP port information for that PID.</span></span>  
  
-   <span data-ttu-id="03ee8-144">使用 SQL Server Management Studio 驗證埠，並以下列格式連接到 Analysis Services 伺服器： \<IPAddress> ： \<portnumber> 。</span><span class="sxs-lookup"><span data-stu-id="03ee8-144">Verify the port by using SQL Server Management Studio and connect to an Analysis Services server in this format: \<IPAddress>:\<portnumber>.</span></span>  
  
 <span data-ttu-id="03ee8-145">雖然應用程式將接聽特定通訊埠，但是只要防火牆封鎖存取權限，連接作業就不會成功。</span><span class="sxs-lookup"><span data-stu-id="03ee8-145">Although an application might be listening on a specific port, connections will not succeed if a firewall is blocking access.</span></span> <span data-ttu-id="03ee8-146">您必須解除封鎖 msmdsrv.exe 或此程式在防火牆中接聽之固定通訊埠的存取權限，才能連接到具名 Analysis Services 執行個體。</span><span class="sxs-lookup"><span data-stu-id="03ee8-146">In order for connections to reach a named Analysis Services instance, you must unblock access to either msmdsrv.exe or the fixed port on which it is listening in the firewall.</span></span> <span data-ttu-id="03ee8-147">本主題的其他章節將指示您如何解除封鎖存取權限。</span><span class="sxs-lookup"><span data-stu-id="03ee8-147">The remaining sections in this topic provide instructions for doing so.</span></span>  
  
 <span data-ttu-id="03ee8-148">若要確認是否已針對 Analysis Services 定義防火牆設定，請使用 [控制台] 中的 [具有進階安全性的 Windows 防火牆]。</span><span class="sxs-lookup"><span data-stu-id="03ee8-148">To check whether firewall settings are already defined for Analysis Services, use Windows Firewall with Advanced Security in Control Panel.</span></span> <span data-ttu-id="03ee8-149">[監視] 節點下的 [防火牆] 頁面會顯示針對本機伺服器定義的完整規則清單。</span><span class="sxs-lookup"><span data-stu-id="03ee8-149">The Firewall page in the Monitoring folder shows a complete list of the rules defined for the local server.</span></span>  
  
 <span data-ttu-id="03ee8-150">請注意，對於 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]，必須手動定義所有防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="03ee8-150">Note that for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], all firewall rules must be manually defined.</span></span> <span data-ttu-id="03ee8-151">雖然 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 和 SQL Server Browser 會保留連接埠 2382 和 2383，但是 SQL Server 安裝程式與所有組態工具都不會定義可允許存取連接埠或程式可執行檔的防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="03ee8-151">Although [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] and SQL Server Browser reserve ports 2382 and 2383, neither the SQL Server setup program nor any of the configuration tools define firewall rules that allow access to either the ports or the program executable files.</span></span>  
  
##  <a name="configure-windows-firewall-for-a-default-instance-of-analysis-services"></a><a name="bkmk_default"></a> <span data-ttu-id="03ee8-152">為 Analysis Services 的預設執行個體設定 Windows 防火牆</span><span class="sxs-lookup"><span data-stu-id="03ee8-152">Configure Windows Firewall for a default instance of Analysis Services</span></span>  
 <span data-ttu-id="03ee8-153">預設的 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 執行個體會接聽 TCP 通訊埠 2383。</span><span class="sxs-lookup"><span data-stu-id="03ee8-153">The default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listens on TCP port 2383.</span></span> <span data-ttu-id="03ee8-154">如果您安裝了預設執行個體，並要使用此連接埠，只需要在 Windows 防火牆中，解除封鎖對 TCP 通訊埠 2383 的傳入存取，即可從遠端存取 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]的預設執行個體。</span><span class="sxs-lookup"><span data-stu-id="03ee8-154">If you installed the default instance and want to use this port, you only need to unblock inbound access to TCP port 2383 in Windows Firewall to enable remote access to the default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="03ee8-155">如果您安裝了預設執行個體，但要將服務設定為接聽固定連接埠，請參閱本主題中的 [針對 Analysis Services 的預設或具名執行個體使用固定連接埠](#bkmk_fixed) 。</span><span class="sxs-lookup"><span data-stu-id="03ee8-155">If you installed the default instance but want to configure the service to listen on a fixed port, see [Use a fixed port for a default or named instance of Analysis Services](#bkmk_fixed) in this topic.</span></span>  
  
 <span data-ttu-id="03ee8-156">若要確認服務是否做為預設執行個體 (MSSQLServerOLAPService) 在運作，請檢查 [SQL Server 組態管理員] 中的服務名稱。</span><span class="sxs-lookup"><span data-stu-id="03ee8-156">To verify whether the service is running as the default instance (MSSQLServerOLAPService), check the service name in SQL Server Configuration Manager.</span></span> <span data-ttu-id="03ee8-157">Analysis Services 的預設執行個體一律會顯示為 **SQL Server Analysis Services (MSSQLSERVER)**。</span><span class="sxs-lookup"><span data-stu-id="03ee8-157">A default instance of Analysis Services is always listed as **SQL Server Analysis Services (MSSQLSERVER)**.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="03ee8-158">不同的 Windows 作業系統可提供替代工具來設定 Windows 防火牆。</span><span class="sxs-lookup"><span data-stu-id="03ee8-158">Different Windows operating systems provide alternative tools for configuring Windows Firewall.</span></span> <span data-ttu-id="03ee8-159">這些工具大部分都能讓您選擇要開啟指定通訊埠還是程式可執行檔。</span><span class="sxs-lookup"><span data-stu-id="03ee8-159">Most of these tools let you choose between opening a specific port or program executable.</span></span> <span data-ttu-id="03ee8-160">除非有指定程式可執行檔的需求，否則建議您指定通訊埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-160">Unless you have a reason for specifying the program executable, we recommend that you specify the port.</span></span>  
  
 <span data-ttu-id="03ee8-161">指定輸入規則時所使用的命名慣例，必須方便您日後能夠輕易地找到規則 (例如 **SQL Server Analysis Services (TCP-in) 2383**)。</span><span class="sxs-lookup"><span data-stu-id="03ee8-161">When specifying an inbound rule, be sure to adopt a naming convention that allows you to easily find the rules later (for example, **SQL Server Analysis Services (TCP-in) 2383**).</span></span>  
  
#### <a name="windows-firewall-with-advanced-security"></a><span data-ttu-id="03ee8-162">具有進階安全性的 Windows 防火牆</span><span class="sxs-lookup"><span data-stu-id="03ee8-162">Windows Firewall with Advanced Security</span></span>  
  
1.  <span data-ttu-id="03ee8-163">在 Windows 7 或 Windows Vista 的 [控制台] 中按一下 [系統及安全性]\*\*\*\*，然後選取 [Windows 防火牆]\*\*\*\*，再按一下 [進階設定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="03ee8-163">On Windows 7 or Windows Vista, in Control Panel, click **System and Security**, select **Windows Firewall**, and then click **Advanced settings**.</span></span> <span data-ttu-id="03ee8-164">在 Windows Server 2008 或 2008 R2，開啟 [系統管理工具]，然後按一下 [具有進階安全性的 Windows 防火牆]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="03ee8-164">On Windows Server 2008 or 2008 R2, open Administrator Tools and click **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="03ee8-165">在 Windows Server 2012 上，開啟 [應用程式] 頁面並輸入 **Windows Firewall**。</span><span class="sxs-lookup"><span data-stu-id="03ee8-165">On Windows Server 2012, open the Applications page and type **Windows Firewall**.</span></span>  
  
2.  <span data-ttu-id="03ee8-166">以滑鼠右鍵按一下 [輸入規則]\*\*\*\*，然後選取 [新增規則]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="03ee8-166">Right-click **Inbound Rules** and select **New Rule**.</span></span>  
  
3.  <span data-ttu-id="03ee8-167">在 [規則類型] 中，按一下 `Port` ，然後按 **[下一步]**。</span><span class="sxs-lookup"><span data-stu-id="03ee8-167">In Rule Type, click `Port` and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="03ee8-168">在 [通訊協定和埠] 中，選取 [ **TCP** ]，然後輸入 `2383` **特定的本機埠**。</span><span class="sxs-lookup"><span data-stu-id="03ee8-168">In Protocol and Ports, select **TCP** and then type `2383` in **Specific local ports**.</span></span>  
  
5.  <span data-ttu-id="03ee8-169">在 [執行動作] 中按一下 [允許連線]\*\*\*\*，然後按一下 [下一步]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="03ee8-169">In Action, click **Allow the connection** and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="03ee8-170">在 [設定檔] 中，清除不適用的所有網路位置，然後按一下 [下一步]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="03ee8-170">In Profile, clear any network locations that do not apply and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="03ee8-171">在 [名稱] 中，輸入此規則的描述性名稱 (例如， `SQL Server Analysis Services (tcp-in) 2383`) ，然後按一下 **[完成]**。</span><span class="sxs-lookup"><span data-stu-id="03ee8-171">In Name, type a descriptive name for this rule (for example, `SQL Server Analysis Services (tcp-in) 2383`), and then click **Finish**.</span></span>  
  
8.  <span data-ttu-id="03ee8-172">如果要確認有無啟用遠端連接，請在不同的電腦上開啟 SQL Server Management Studio 或 Excel，然後在 [伺服器名稱]\*\*\*\* 中指定伺服器的網路名稱，以連接至 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="03ee8-172">To verify that remote connections are enabled, open SQL Server Management Studio or Excel on a different computer and connect to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] by specifying the network name of the server in **Server name**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="03ee8-173">您必須先授與其他使用者此伺服器的權限，才可存取此伺服器。</span><span class="sxs-lookup"><span data-stu-id="03ee8-173">Other users will not have access to this server until you grant permissions.</span></span> <span data-ttu-id="03ee8-174">如需詳細資訊，請參閱[物件和作業的存取權授權 &#40;Analysis Services&#41;](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md)。</span><span class="sxs-lookup"><span data-stu-id="03ee8-174">For more information, see [Authorizing access to objects and operations &#40;Analysis Services&#41;](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md).</span></span>  
  
#### <a name="netsh-advfirewall-syntax"></a><span data-ttu-id="03ee8-175">Netsh AdvFirewall 語法</span><span class="sxs-lookup"><span data-stu-id="03ee8-175">Netsh AdvFirewall Syntax</span></span>  
  
-   <span data-ttu-id="03ee8-176">下列命令會建立輸入規則，允許內送要求使用 TCP 通訊埠 2383。</span><span class="sxs-lookup"><span data-stu-id="03ee8-176">The following command creates an inbound rule that allows incoming requests on TCP port 2383.</span></span>  
  
    ```  
    netsh advfirewall firewall add rule name="SQL Server Analysis Services inbound on TCP 2383" dir=in action=allow protocol=TCP localport=2383 profile=domain  
    ```  
  
##  <a name="configure-windows-firewall-access-for-a-named-instance-of-analysis-services"></a><a name="bkmk_named"></a><span data-ttu-id="03ee8-177">為 Analysis Services 的已命名實例設定 Windows 防火牆存取</span><span class="sxs-lookup"><span data-stu-id="03ee8-177">Configure Windows Firewall access for a named instance of Analysis Services</span></span>  
 <span data-ttu-id="03ee8-178">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 的具名執行個體可以在固定通訊埠上接聽，也可在動態指派的通訊埠上接聽 (若為後者，SQL Server Browser 服務會在連接時提供最新服務連接資訊)。</span><span class="sxs-lookup"><span data-stu-id="03ee8-178">Named instances of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] can either listen on a fixed port or on a dynamically assigned port, where SQL Server Browser service provides the connection information that is current for the service at the time of the connection.</span></span>  
  
 <span data-ttu-id="03ee8-179">SQL Server Browser 服務會接聽 TCP 通訊埠 2382。</span><span class="sxs-lookup"><span data-stu-id="03ee8-179">SQL Server Browser service listens on TCP port 2382.</span></span> <span data-ttu-id="03ee8-180">不使用 UDP。</span><span class="sxs-lookup"><span data-stu-id="03ee8-180">UDP is not used.</span></span> <span data-ttu-id="03ee8-181">TCP 是 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]唯一使用的傳輸通訊協定。</span><span class="sxs-lookup"><span data-stu-id="03ee8-181">TCP is the only transmission protocol used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="03ee8-182">選擇下列其中一種方法，以啟用 Analysis Services 之具名執行個體的遠端存取：</span><span class="sxs-lookup"><span data-stu-id="03ee8-182">Choose one of the following approaches to enable remote access to a named instance of Analysis Services:</span></span>  
  
-   <span data-ttu-id="03ee8-183">使用動態通訊埠指派與 SQL Server Browser 服務。</span><span class="sxs-lookup"><span data-stu-id="03ee8-183">Use dynamic port assignments and SQL Server Browser service.</span></span> <span data-ttu-id="03ee8-184">在 Windows 防火牆中解除封鎖 SQL Server Browser 服務所使用的通訊埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-184">Unblock the port used by SQL Server Browser service in Windows Firewall.</span></span> <span data-ttu-id="03ee8-185">以此格式連接到伺服器： \<servername> \\<instancename \> 。</span><span class="sxs-lookup"><span data-stu-id="03ee8-185">Connect to the server in this format: \<servername>\\<instancename\>.</span></span>  
  
-   <span data-ttu-id="03ee8-186">使用固定通訊埠與 SQL Server Browser 服務。</span><span class="sxs-lookup"><span data-stu-id="03ee8-186">Use a fixed port and SQL Server Browser service together.</span></span> <span data-ttu-id="03ee8-187">這種方法可讓您使用下列格式來連接： \<servername> \\<instancename \> ，與動態通訊埠指派方法相同，不同之處在于伺服器會接聽固定通訊埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-187">This approach lets you connect using this format: \<servername>\\<instancename\>, identical to the dynamic port assignment approach, except that in this case the server listens on a fixed port.</span></span> <span data-ttu-id="03ee8-188">在此情況下，SQL Server Browser 服務會提供名稱解析給接聽固定通訊埠的 Analysis Services 執行個體。</span><span class="sxs-lookup"><span data-stu-id="03ee8-188">In this scenario, SQL Server Browser Service provides name resolution to the Analysis Services instance listening on the fixed port.</span></span> <span data-ttu-id="03ee8-189">如果要使用此方法，必須將伺服器設定為接聽固定通訊埠，並解除對該通訊埠存取的封鎖，以及解除對 SQL Server Browser 服務所用之通訊埠存取的封鎖。</span><span class="sxs-lookup"><span data-stu-id="03ee8-189">To use this approach, configure the server to listen on a fixed port, unblock access to that port, and unblock access to the port used by SQL Server Browser service.</span></span>  
  
 <span data-ttu-id="03ee8-190">SQL Server Browser 服務只可搭配具名執行個體使用，而不可與預設執行個體並用。</span><span class="sxs-lookup"><span data-stu-id="03ee8-190">SQL Server Browser service is only used with named instances, never with the default instance.</span></span> <span data-ttu-id="03ee8-191">當您將 SQL Server 功能安裝成具名執行個體安裝時，即會自動安裝並啟用此服務。</span><span class="sxs-lookup"><span data-stu-id="03ee8-191">The service is automatically installed and enabled whenever you install any SQL Server feature as a named instance.</span></span> <span data-ttu-id="03ee8-192">如果您選擇的方法需要使用 SQL Server Browser 服務，請確認您的伺服器已啟用並啟動該服務。</span><span class="sxs-lookup"><span data-stu-id="03ee8-192">If you choose an approach that requires SQL Server Browser service, be sure it remains enabled and started on your server.</span></span>  
  
 <span data-ttu-id="03ee8-193">如果您無法使用 SQL Server Browser 服務，您必須在連接字串中指派固定通訊埠，略過網域名稱解析。</span><span class="sxs-lookup"><span data-stu-id="03ee8-193">If you cannot use SQL Server Browser service, you must assign a fixed port in the connection string, bypassing domain name resolution.</span></span> <span data-ttu-id="03ee8-194">在沒有 SQL Server Browser 服務的情況下，所有用戶端連接皆必須在連接字串中加入通訊埠編號 (例如 AW-SRV01:54321)。</span><span class="sxs-lookup"><span data-stu-id="03ee8-194">Without SQL Server Browser service, all client connections must include the port number on the connection string (for example, AW-SRV01:54321).</span></span>  
  
 <span data-ttu-id="03ee8-195">**選項 1：使用動態通訊埠指派，並解除對 SQL Server Browser 服務存取的封鎖**</span><span class="sxs-lookup"><span data-stu-id="03ee8-195">**Option 1: Use dynamic port assignments and unblock access to SQL Server Browser service**</span></span>  
  
 <span data-ttu-id="03ee8-196"> 會在此服務啟動之時，建立 Analysis Services 之具名執行個體的動態通訊埠指派。</span><span class="sxs-lookup"><span data-stu-id="03ee8-196">Dynamic port assignments for named instances of Analysis Services are established by the `MSOLAP$InstanceName` when the service starts.</span></span> <span data-ttu-id="03ee8-197">服務預設會宣告所找到的第一個可用通訊埠編號，而且每次重新啟動服務時，都會使用不同的通訊埠編號。</span><span class="sxs-lookup"><span data-stu-id="03ee8-197">By default, the service claims the first available port number that it finds, using a different port number each time the service is restarted.</span></span>  
  
 <span data-ttu-id="03ee8-198">執行個體名稱解析是由 SQL Server Browser 服務處理。</span><span class="sxs-lookup"><span data-stu-id="03ee8-198">Instance name resolution is handled by the SQL Server browser service.</span></span> <span data-ttu-id="03ee8-199">如果要並用動態通訊埠指派與具名執行個體，必須解除對 SQL Server Browser 服務之 TCP 通訊埠 2382 的封鎖。</span><span class="sxs-lookup"><span data-stu-id="03ee8-199">Unblocking TCP port 2382 for SQL Server Browser service is always required if you are using dynamic port assignments with a named instance.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="03ee8-200">SQL Server Browser 服務會分別在 UDP 通訊埠 1434 和 TCP 通訊埠 2382 接聽 Database Engine 和 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="03ee8-200">SQL Server Browser service listens on both UDP port 1434 and TCP port 2382 for the Database Engine and Analysis Services, respectively.</span></span> <span data-ttu-id="03ee8-201">即使您已經解除封鎖 UDP 通訊埠 1434 供 SQL Server Browser 服務使用，仍然必須解除封鎖 TCP 通訊埠 2382 供 Analysis Services 使用。</span><span class="sxs-lookup"><span data-stu-id="03ee8-201">Even if you already unblocked UDP port 1434 for the SQL Server Browser service, you must still unblock TCP port 2382 for Analysis Services.</span></span>  
  
#### <a name="windows-firewall-with-advanced-security"></a><span data-ttu-id="03ee8-202">具有進階安全性的 Windows 防火牆</span><span class="sxs-lookup"><span data-stu-id="03ee8-202">Windows Firewall with Advanced Security</span></span>  
  
1.  <span data-ttu-id="03ee8-203">在 Windows 7 或 Windows Vista 的 [控制台] 中按一下 [系統及安全性]\*\*\*\*，然後選取 [Windows 防火牆]\*\*\*\*，再按一下 [進階設定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="03ee8-203">On Windows 7 or Windows Vista, in Control Panel, click **System and Security**, select **Windows Firewall**, and then click **Advanced settings**.</span></span> <span data-ttu-id="03ee8-204">在 Windows Server 2008 或 2008 R2，開啟 [系統管理工具]，然後按一下 [具有進階安全性的 Windows 防火牆]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="03ee8-204">On Windows Server 2008 or 2008 R2, open Administrator Tools and click **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="03ee8-205">在 Windows Server 2012 上，開啟 [應用程式] 頁面並輸入 **Windows Firewall**。</span><span class="sxs-lookup"><span data-stu-id="03ee8-205">On Windows Server 2012, open the Applications page and type **Windows Firewall**.</span></span>  
  
2.  <span data-ttu-id="03ee8-206">如果要解除對 SQL Server Browser 服務存取的封鎖，請以滑鼠右鍵按一下 [輸入規則]\*\*\*\*，然後選取 [新增規則]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="03ee8-206">To unblock access to SQL Server Browser service, right-click **Inbound Rules** and select **New Rule**.</span></span>  
  
3.  <span data-ttu-id="03ee8-207">在 [規則類型] 中，按一下 `Port` ，然後按 **[下一步]**。</span><span class="sxs-lookup"><span data-stu-id="03ee8-207">In Rule Type, click `Port` and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="03ee8-208">在 [通訊協定和埠] 中，選取 [ **TCP** ]，然後輸入 `2382` **特定的本機埠**。</span><span class="sxs-lookup"><span data-stu-id="03ee8-208">In Protocol and Ports, select **TCP** and then type `2382` in **Specific local ports**.</span></span>  
  
5.  <span data-ttu-id="03ee8-209">在 [執行動作] 中按一下 [允許連線]\*\*\*\*，然後按一下 [下一步]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="03ee8-209">In Action, click **Allow the connection** and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="03ee8-210">在 [設定檔] 中，清除不適用的所有網路位置，然後按一下 [下一步]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="03ee8-210">In Profile, clear any network locations that do not apply and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="03ee8-211">在 [名稱] 中，輸入此規則的描述性名稱 (例如， `SQL Server Browser Service (tcp-in) 2382`) ，然後按一下 **[完成]**。</span><span class="sxs-lookup"><span data-stu-id="03ee8-211">In Name, type a descriptive name for this rule (for example, `SQL Server Browser Service (tcp-in) 2382`), and then click **Finish**.</span></span>  
  
8.  <span data-ttu-id="03ee8-212">若要確認是否已啟用遠端連線，請在不同的電腦上開啟 SQL Server Management Studio 或 Excel，然後使用下列格式指定伺服器的網路名稱和實例名稱，以連接到 Analysis Services： \<servername> \\<instancename \> 。</span><span class="sxs-lookup"><span data-stu-id="03ee8-212">To verify that remote connections are enabled, open SQL Server Management Studio or Excel on a different computer and connect to the Analysis Services by specifying the network name of the server and the instance name in this format: \<servername>\\<instancename\>.</span></span> <span data-ttu-id="03ee8-213">例如，在名稱為 **AW-SRV01** 且具有 **Finance** 具名執行個體的伺服器上，伺服器名稱為 **AW-SRV01\Finance**。</span><span class="sxs-lookup"><span data-stu-id="03ee8-213">For example, on a server named **AW-SRV01** with a named instance of **Finance**, the server name is **AW-SRV01\Finance**.</span></span>  
  
 <span data-ttu-id="03ee8-214">**選項 2：針對具名執行個體使用固定通訊埠**</span><span class="sxs-lookup"><span data-stu-id="03ee8-214">**Option 2: Use a fixed port for a named instance**</span></span>  
  
 <span data-ttu-id="03ee8-215">或者，您也可以指派固定通訊埠，然後解除封鎖該通訊埠的存取權限。</span><span class="sxs-lookup"><span data-stu-id="03ee8-215">Alternatively, you can assign a fixed port, and then unblock access to that port.</span></span> <span data-ttu-id="03ee8-216">此方法相較於允許存取程式可執行檔，可以提供更好的稽核功能。</span><span class="sxs-lookup"><span data-stu-id="03ee8-216">This approach offers better auditing capability than if you allowed access to the program executable.</span></span> <span data-ttu-id="03ee8-217">因此在存取任何 Analysis Services 執行個體時，建議您使用固定通訊埠的方法。</span><span class="sxs-lookup"><span data-stu-id="03ee8-217">For this reason, using a fixed port is the recommended approach for accessing any Analysis Services instance.</span></span>  
  
 <span data-ttu-id="03ee8-218">若要指派固定連接埠，請遵循本主題 [針對 Analysis Services 的預設或具名執行個體使用固定連接埠](#bkmk_fixed) 中的指示操作，再回到本節解除封鎖連接埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-218">To assign a fixed port, follow the instructions in [Use a fixed port for a default or named instance of Analysis Services](#bkmk_fixed) in this topic, then return to this section to unblock the port.</span></span>  
  
#### <a name="windows-firewall-with-advanced-security"></a><span data-ttu-id="03ee8-219">具有進階安全性的 Windows 防火牆</span><span class="sxs-lookup"><span data-stu-id="03ee8-219">Windows Firewall with Advanced Security</span></span>  
  
1.  <span data-ttu-id="03ee8-220">在 Windows 7 或 Windows Vista 的 [控制台] 中按一下 [系統及安全性]\*\*\*\*，然後選取 [Windows 防火牆]\*\*\*\*，再按一下 [進階設定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="03ee8-220">On Windows 7 or Windows Vista, in Control Panel, click **System and Security**, select **Windows Firewall**, and then click **Advanced settings**.</span></span> <span data-ttu-id="03ee8-221">在 Windows Server 2008 或 2008 R2，開啟 [系統管理工具]，然後按一下 [具有進階安全性的 Windows 防火牆]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="03ee8-221">On Windows Server 2008 or 2008 R2, open Administrator Tools and click **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="03ee8-222">在 Windows Server 2012 上，開啟 [應用程式] 頁面並輸入 **Windows Firewall**。</span><span class="sxs-lookup"><span data-stu-id="03ee8-222">On Windows Server 2012, open the Applications page and type **Windows Firewall**.</span></span>  
  
2.  <span data-ttu-id="03ee8-223">若要解除封鎖對 Analysis Services 的存取，請以滑鼠右鍵按一下 [輸入規則]\*\*\*\*，然後選取 [新增規則]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="03ee8-223">To unblock access to Analysis Services, right-click **Inbound Rules** and select **New Rule**.</span></span>  
  
3.  <span data-ttu-id="03ee8-224">在 [規則類型] 中，按一下 `Port` ，然後按 **[下一步]**。</span><span class="sxs-lookup"><span data-stu-id="03ee8-224">In Rule Type, click `Port` and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="03ee8-225">在 [通訊協定及連接埠] 中選取 [TCP]\*\*\*\*，然後在 [特定本機連接埠]\*\*\*\* 中輸入固定連接埠號碼。</span><span class="sxs-lookup"><span data-stu-id="03ee8-225">In Protocol and Ports, select **TCP** and then type the fixed port in **Specific local ports**.</span></span>  
  
5.  <span data-ttu-id="03ee8-226">在 [執行動作] 中按一下 [允許連線]\*\*\*\*，然後按一下 [下一步]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="03ee8-226">In Action, click **Allow the connection** and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="03ee8-227">在 [設定檔] 中，清除不適用的所有網路位置，然後按一下 [下一步]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="03ee8-227">In Profile, clear any network locations that do not apply and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="03ee8-228">在 [名稱] 中，輸入此規則的描述性名稱 (例如， `SQL Server Analysis Services on port 54321`) ，然後按一下 **[完成]**。</span><span class="sxs-lookup"><span data-stu-id="03ee8-228">In Name, type a descriptive name for this rule (for example, `SQL Server Analysis Services on port 54321`), and then click **Finish**.</span></span>  
  
8.  <span data-ttu-id="03ee8-229">若要確認是否已啟用遠端連線，請在不同的電腦上開啟 SQL Server Management Studio 或 Excel，然後使用下列格式來指定伺服器的網路名稱和埠號碼，以連接到 Analysis Services： \<servername> ： \<portnumber> 。</span><span class="sxs-lookup"><span data-stu-id="03ee8-229">To verify that remote connections are enabled, open SQL Server Management Studio or Excel on a different computer and connect to the Analysis Services by specifying the network name of the server and the port number in this format: \<servername>:\<portnumber>.</span></span>  
  
#### <a name="netsh-advfirewall-syntax"></a><span data-ttu-id="03ee8-230">Netsh AdvFirewall 語法</span><span class="sxs-lookup"><span data-stu-id="03ee8-230">Netsh AdvFirewall Syntax</span></span>  
  
-   <span data-ttu-id="03ee8-231">下列命令所建立的輸入規則，可解除對 SQL Server Browser 服務所使用之 TCP 2382 的封鎖，以及解除您為 Analysis Services 執行個體所指定之固定通訊埠的封鎖。</span><span class="sxs-lookup"><span data-stu-id="03ee8-231">The following commands create inbound rules that unblock TCP 2382 for SQL Server Browser service and unblock the fixed port that you specified for the Analysis Services instance.</span></span> <span data-ttu-id="03ee8-232">您可以執行任一個命令允許對 Analysis Services 具名執行個體的存取。</span><span class="sxs-lookup"><span data-stu-id="03ee8-232">You can run either one to allow access to a named Analysis Services instance.</span></span>  
  
     <span data-ttu-id="03ee8-233">在此範例命令中，通訊埠 54321 是固定通訊埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-233">In this sample command, port 54321 is the fixed port.</span></span> <span data-ttu-id="03ee8-234">請務必以您系統所使用的實際通訊埠加以取代。</span><span class="sxs-lookup"><span data-stu-id="03ee8-234">Be sure to replace it with the actual port in use on your system.</span></span>  
  
    ```  
    netsh advfirewall firewall add rule name="SQL Server Analysis Services (tcp-in) on 54321" dir=in action=allow protocol=TCP localport=54321 profile=domain  
    ```  
  
    ```  
    netsh advfirewall firewall add rule name="SQL Server Browser Services inbound on TCP 2382" dir=in action=allow protocol=TCP localport=2382 profile=domain  
    ```  
  
##  <a name="use-a-fixed-port-for-a-default-or-named-instance-of-analysis-services"></a><a name="bkmk_fixed"></a><span data-ttu-id="03ee8-235">針對預設或名為的實例使用固定通訊埠 Analysis Services</span><span class="sxs-lookup"><span data-stu-id="03ee8-235">Use a fixed port for a default or named instance of Analysis Services</span></span>  
 <span data-ttu-id="03ee8-236">本節說明如何將 Analysis Services 設定為接聽固定通訊埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-236">This section explains how to configure Analysis Services to listen on a fixed port.</span></span> <span data-ttu-id="03ee8-237">如果將 Analysis Services 安裝成具名執行個體，一般會使用固定通訊埠；但如果是因為商務或安全性需要而必須使用非預設的通訊埠指派，也可使用此方法。</span><span class="sxs-lookup"><span data-stu-id="03ee8-237">Using a fixed port is common if you installed Analysis Services as a named instance, but you can also use this approach if business or security requirements specify that you use non-default port assignments.</span></span>  
  
 <span data-ttu-id="03ee8-238">請注意，使用固定通訊埠時，由於必須將通訊埠編號附加至伺服器名稱，因此將變更預設執行個體的連接語法。</span><span class="sxs-lookup"><span data-stu-id="03ee8-238">Note that using a fixed port will alter the connection syntax for the default instance by requiring you to append the port number to the server name.</span></span> <span data-ttu-id="03ee8-239">例如連接到 SQL Server Management Studio 中接聽通訊埠 54321 的本機預設 Analysis Services 執行個體時，必須在 Management Studio 的 [連接到伺服器] 對話方塊中輸入 localhost:54321 做為伺服器名稱。</span><span class="sxs-lookup"><span data-stu-id="03ee8-239">For example, connecting to a local, default Analysis Services instance listening on port 54321 in SQL Server Management Studio would require that you type localhost:54321 as the server name in the Connect to Server dialog box in Management Studio.</span></span>  
  
 <span data-ttu-id="03ee8-240">如果您使用的是已命名的實例，您可以指派固定通訊埠，而不會變更指定伺服器名稱的方式 (具體來說，您可以使用 \<servername\instancename> 連接到接聽固定通訊埠) 的已命名實例。</span><span class="sxs-lookup"><span data-stu-id="03ee8-240">If you are using a named instance, you can assign a fixed port with no changes to how you specify the server name (specifically, you can use \<servername\instancename> to connect to a named instance listening on a fixed port).</span></span> <span data-ttu-id="03ee8-241">SQL Server Browser 服務必須在執行中，才可解除對其所接聽之通訊埠的封鎖。</span><span class="sxs-lookup"><span data-stu-id="03ee8-241">This works only if SQL Server Browser service is running and you unblocked the port on which it is listening.</span></span> <span data-ttu-id="03ee8-242">SQL Server Browser 服務會根據來提供重新導向至固定通訊埠 \<servername\instancename> 。</span><span class="sxs-lookup"><span data-stu-id="03ee8-242">SQL Server Browser service will provide redirection to the fixed port based on \<servername\instancename>.</span></span> <span data-ttu-id="03ee8-243">只要您開啟通訊埠供 SQL Server Browser 服務和接聽固定通訊埠的 Analysis Services 具名執行個體使用，SQL Server Browser 服務就會將連線解析為具名執行個體。</span><span class="sxs-lookup"><span data-stu-id="03ee8-243">As long as you open ports for both SQL Server Browser service and the named instance of Analysis Services listening on the fixed port, SQL Server Browser service will resolve the connection to a named instance.</span></span>  
  
1.  <span data-ttu-id="03ee8-244">決定可供使用的 TCP/IP 通訊埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-244">Determine an available TCP/IP port to use.</span></span>  
  
     <span data-ttu-id="03ee8-245">若要檢視您應該避免使用的保留與已註冊連接埠清單，請參閱 [Port Numbers (IANA)](https://go.microsoft.com/fwlink/?LinkID=198469)(連接埠號碼 (IANA))。</span><span class="sxs-lookup"><span data-stu-id="03ee8-245">To view a list of reserved and registered ports that you should avoid using, see [Port Numbers (IANA)](https://go.microsoft.com/fwlink/?LinkID=198469).</span></span> <span data-ttu-id="03ee8-246">若要檢視系統已經使用的通訊埠清單，請開啟命令提示字元視窗，然後輸入 `netstat -a -p TCP` 顯示系統中已經開啟的 TCP 通訊埠清單。</span><span class="sxs-lookup"><span data-stu-id="03ee8-246">To view a list of ports that are already in use on your system, open a command prompt window and type `netstat -a -p TCP` to display a list of the TCP ports that are open on the system.</span></span>  
  
2.  <span data-ttu-id="03ee8-247">一旦決定要使用的通訊埠之後，請在 msmdsrv.ini 檔或是在 SQL Server Management Studio 之 Analysis Services 執行個體的 [一般屬性] 頁面中編輯 `Port` 組態設定以指定通訊埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-247">After you determine which port to use, specify the port by either editing the `Port` configuration setting in the msmdsrv.ini file or in the General properties page of an Analysis Services instance in SQL Server Management Studio.</span></span>  
  
3.  <span data-ttu-id="03ee8-248">重新啟動服務。</span><span class="sxs-lookup"><span data-stu-id="03ee8-248">Restart the service.</span></span>  
  
4.  <span data-ttu-id="03ee8-249">設定 Windows 防火牆，解除封鎖您指定的 TCP 通訊埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-249">Configure Windows Firewall to unblock the TCP port you specified.</span></span> <span data-ttu-id="03ee8-250">如果您要讓具名執行個體使用固定通訊埠，請解除封鎖您指定的 TCP 通訊埠讓該執行個體使用，以及解除封鎖 TCP 通訊埠 2382 供 SQL Server Browser 服務使用。</span><span class="sxs-lookup"><span data-stu-id="03ee8-250">Or, if you are using a fixed port for a named instance, unblock both the TCP port you specified for that instance and TCP port 2382 for SQL Server Browser service.</span></span>  
  
5.  <span data-ttu-id="03ee8-251">以本機方式連接 (在 Management Studio 中)，然後從其他電腦上的用戶端應用程式以遠端方式連接，確認上述通訊埠是否已開啟。</span><span class="sxs-lookup"><span data-stu-id="03ee8-251">Verify by connecting locally (in Management Studio) and then remotely from a client application on another computer.</span></span> <span data-ttu-id="03ee8-252">若要使用 Management Studio，請以下列格式指定伺服器名稱，以連接到 Analysis Services 的預設實例： \<servername> ： \<portnumber> 。</span><span class="sxs-lookup"><span data-stu-id="03ee8-252">To use Management Studio, connect to an Analysis Services default instance by specifying a server name in this format: \<servername>:\<portnumber>.</span></span> <span data-ttu-id="03ee8-253">若為已命名的實例，請將伺服器名稱指定為 \<servername> \\<instancename \> 。</span><span class="sxs-lookup"><span data-stu-id="03ee8-253">For a named instance, specify the server name as \<servername>\\<instancename\>.</span></span>  
  
##  <a name="port-configuration-for-an-analysis-services-cluster"></a><a name="bkmk_cluster"></a><span data-ttu-id="03ee8-254">Analysis Services 叢集的埠設定</span><span class="sxs-lookup"><span data-stu-id="03ee8-254">Port configuration for an Analysis Services cluster</span></span>  
 <span data-ttu-id="03ee8-255">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 容錯移轉叢集一定會接聽 TCP 通訊埠 2383，不論您將它安裝為預設執行個體還是具名執行個體。</span><span class="sxs-lookup"><span data-stu-id="03ee8-255">An [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] failover cluster always listens on TCP port 2383, regardless of whether you installed it as a default instance or named instance.</span></span> <span data-ttu-id="03ee8-256">在 Windows 容錯移轉叢集上安裝時， [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 不會使用動態連接埠指派。</span><span class="sxs-lookup"><span data-stu-id="03ee8-256">Dynamic port assignments are not used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] when it is installed on a Windows failover cluster.</span></span> <span data-ttu-id="03ee8-257">請務必在叢集中執行 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 的每個節點上開啟 TCP 2383。</span><span class="sxs-lookup"><span data-stu-id="03ee8-257">Be sure to open TCP 2383 on every node running [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in the cluster.</span></span> <span data-ttu-id="03ee8-258">如需叢集化 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]的詳細資訊，請參閱 [How to Cluster SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548)(如何將 SQL Server Analysis Services 叢集化)。</span><span class="sxs-lookup"><span data-stu-id="03ee8-258">For more information about clustering [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], see [How to Cluster SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548).</span></span>  
  
##  <a name="port-configuration-for-powerpivot-for-sharepoint"></a><a name="bkmk_powerpivot"></a><span data-ttu-id="03ee8-259">PowerPivot for SharePoint 的埠設定</span><span class="sxs-lookup"><span data-stu-id="03ee8-259">Port configuration for PowerPivot for SharePoint</span></span>  
 <span data-ttu-id="03ee8-260">根據使用的 SharePoint 版本， [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 的伺服器架構有本質上的不同。</span><span class="sxs-lookup"><span data-stu-id="03ee8-260">Server architecture for [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] is fundamentally different depending on which version of SharePoint you are using.</span></span>  
  
 <span data-ttu-id="03ee8-261">**SharePoint 2013**</span><span class="sxs-lookup"><span data-stu-id="03ee8-261">**SharePoint 2013**</span></span>  
  
 <span data-ttu-id="03ee8-262">在 SharePoint 2013 中，Excel Services 會將 Power Pivot 資料模型的要求重新導向，隨後在 SharePoint 環境之外的 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 執行個體上載入。</span><span class="sxs-lookup"><span data-stu-id="03ee8-262">In SharePoint 2013, Excel Services redirects requests for Power Pivot data models, which are subsequently loaded on an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance outside of the SharePoint environment.</span></span> <span data-ttu-id="03ee8-263">連接遵循一般模式，也就是由本機電腦上的 Analysis Services 用戶端程式庫傳送連接要求給相同網路中的遠端 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 執行個體。</span><span class="sxs-lookup"><span data-stu-id="03ee8-263">Connections follow the typical pattern, where an Analysis Services client library on a local computer sends a connection request to a remote [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance in the same network.</span></span>  
  
 <span data-ttu-id="03ee8-264">由於 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 一定會安裝 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 當做具名執行個體，您應該採用 SQL Server Browser 服務與動態通訊埠指派。</span><span class="sxs-lookup"><span data-stu-id="03ee8-264">Because [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] always installs [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] as a named instance, you should assume SQL Server Browser service and dynamic port assignments.</span></span> <span data-ttu-id="03ee8-265">如前所述，SQL Server Browser 服務會接聽 TCP 通訊埠 2382 傳送到 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 具名執行個體的連接要求，並將要求重新導向至目前的通訊埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-265">As noted earlier, SQL Server Browser service listens on TCP port 2382 for connection requests sent to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] named instances, redirecting the request to the current port.</span></span>  
  
 <span data-ttu-id="03ee8-266">請注意，SharePoint 2013 中的 Excel Services 不支援固定通訊埠連接語法，因此請確定可以存取 SQL Server Browser 服務。</span><span class="sxs-lookup"><span data-stu-id="03ee8-266">Note that Excel Services in SharePoint 2013 does not support the fixed port connection syntax, so make sure SQL Server Browser service is accessible.</span></span>  
  
 <span data-ttu-id="03ee8-267">**SharePoint 2010**</span><span class="sxs-lookup"><span data-stu-id="03ee8-267">**SharePoint 2010**</span></span>  
  
 <span data-ttu-id="03ee8-268">如果您是使用 SharePoint 2010，就不必開啟 Windows 防火牆中的通訊埠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-268">If you are using SharePoint 2010, you do not need to open ports in Windows Firewall.</span></span> <span data-ttu-id="03ee8-269">SharePoint 會開啟它所需要的通訊埠，而且增益集 (例如 PowerPivot for SharePoint) 會在 SharePoint 環境中運作。</span><span class="sxs-lookup"><span data-stu-id="03ee8-269">SharePoint opens the ports that it requires, and add-ins such as PowerPivot for SharePoint operate within the SharePoint environment.</span></span> <span data-ttu-id="03ee8-270">在 PowerPivot for SharePoint 2010 安裝中，PowerPivot 系統服務會獨佔使用在相同電腦上一併安裝的本機 SQL Server Analysis Services (PowerPivot) 服務執行個體。</span><span class="sxs-lookup"><span data-stu-id="03ee8-270">In a PowerPivot for SharePoint 2010 installation, the PowerPivot System Service has exclusive use of the local SQL Server Analysis Services (PowerPivot) service instance that is installed with it on the same computer.</span></span> <span data-ttu-id="03ee8-271">PowerPivot 系統服務會使用本機連線 (而非網路連線) 存取本機 Analysis Services 引擎服務，而該服務會載入、查詢及處理 SharePoint 伺服器上的 PowerPivot 資料。</span><span class="sxs-lookup"><span data-stu-id="03ee8-271">It uses local connections, not network connections, to access the local Analysis Services engine service that loads, queries, and processes PowerPivot data on the SharePoint server.</span></span> <span data-ttu-id="03ee8-272">若要從用戶端應用程式要求 PowerPivot 資料，要求會透過 SharePoint 安裝程式所開啟的埠來路由傳送 (具體來說，會定義輸入規則以允許存取 SharePoint-80、SharePoint 管理中心 v4、SharePoint Web 服務和 SPUserCodeV4) 。</span><span class="sxs-lookup"><span data-stu-id="03ee8-272">To request PowerPivot data from client applications, requests are routed through ports that are opened by SharePoint Setup (specifically, inbound rules are defined to allow access to SharePoint - 80, SharePoint Central Administration v4, SharePoint Web Services, and SPUserCodeV4).</span></span> <span data-ttu-id="03ee8-273">由於 PowerPivot Web 服務是在 SharePoint 伺服陣列中運作，因此要遠端存取 SharePoint 伺服陣列中的 PowerPivot 資料，使用 SharePoint 防火牆規則已經足夠。</span><span class="sxs-lookup"><span data-stu-id="03ee8-273">Because PowerPivot web services run within a SharePoint farm, the SharePoint firewall rules are sufficient for remote access to PowerPivot data in a SharePoint farm.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="03ee8-274">另請參閱</span><span class="sxs-lookup"><span data-stu-id="03ee8-274">See Also</span></span>  
 <span data-ttu-id="03ee8-275">[SQL Server Browser Service &#40;資料庫引擎和 SSAS&#41;](../../database-engine/configure-windows/sql-server-browser-service-database-engine-and-ssas.md) </span><span class="sxs-lookup"><span data-stu-id="03ee8-275">[SQL Server Browser Service &#40;Database Engine and SSAS&#41;](../../database-engine/configure-windows/sql-server-browser-service-database-engine-and-ssas.md) </span></span>  
 <span data-ttu-id="03ee8-276">[啟動、停止、暫停、繼續、重新啟動 Database Engine、SQL Server Agent 或 SQL Server Browser 服務](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md) </span><span class="sxs-lookup"><span data-stu-id="03ee8-276">[Start, Stop, Pause, Resume, Restart the Database Engine, SQL Server Agent, or SQL Server Browser Service](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md) </span></span>  
 [<span data-ttu-id="03ee8-277">設定用於 Database Engine 存取的 Windows 防火牆</span><span class="sxs-lookup"><span data-stu-id="03ee8-277">Configure a Windows Firewall for Database Engine Access</span></span>](../../database-engine/configure-windows/configure-a-windows-firewall-for-database-engine-access.md)  
  
  
