---
title: 在 Internet Information Services (IIS) 8.0 上設定 Analysis Services 的 HTTP 存取權 |Microsoft Docs
ms.custom: ''
ms.date: 06/19/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: cf2e2c84-0a69-4cdd-90a1-fb4021936513
author: minewiskan
ms.author: owend
ms.openlocfilehash: 00fc6fcdf059bb26602e20d4c7fc8fb46edcfb9c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87698881"
---
# <a name="configure-http-access-to-analysis-services-on-internet-information-services-iis-80"></a><span data-ttu-id="1951b-102">設定 Internet Information Services (IIS) 8.0 上 Analysis Services 的 HTTP 存取</span><span class="sxs-lookup"><span data-stu-id="1951b-102">Configure HTTP Access to Analysis Services on Internet Information Services (IIS) 8.0</span></span>
  <span data-ttu-id="1951b-103">本文說明如何設定 HTTP 端點來存取 Analysis Services 執行個體。</span><span class="sxs-lookup"><span data-stu-id="1951b-103">This article explains how to set up an HTTP endpoint for accessing an Analysis Services instance.</span></span> <span data-ttu-id="1951b-104">您可以設定 MSMDPUMP.dll (這是在 Internet Information Services (IIS) 中執行的一個 ISAPI 擴充程式，可以在用戶端應用程式與 Analysis Services 伺服器之間來回提取資料) 來啟用 HTTP 存取。</span><span class="sxs-lookup"><span data-stu-id="1951b-104">You can enable HTTP access by configuring MSMDPUMP.dll, an ISAPI extension that runs in Internet Information Services (IIS) and pumps data to and from client applications and an Analysis Services server.</span></span> <span data-ttu-id="1951b-105">此方法會在您的 BI 方案需要下列功能時，提供連接至 Analysis Services 的替代方式。</span><span class="sxs-lookup"><span data-stu-id="1951b-105">This approach provides an alternative means for connecting to Analysis Services when your BI solution calls for the following capabilities:</span></span>  
  
-   <span data-ttu-id="1951b-106">用戶端存取是透過網際網路或外部網路連接進行，但會限制可啟用的通訊埠。</span><span class="sxs-lookup"><span data-stu-id="1951b-106">Client access is over Internet or extranet connections, with restrictions on which ports can be enabled.</span></span>  
  
-   <span data-ttu-id="1951b-107">用戶端連接是來自相同網路的不信任網域。</span><span class="sxs-lookup"><span data-stu-id="1951b-107">Client connections are from non-trusted domains in the same network.</span></span>  
  
-   <span data-ttu-id="1951b-108">用戶端應用程式會在允許 HTTP 但不允許 TCP/IP 連接的網路環境中執行。</span><span class="sxs-lookup"><span data-stu-id="1951b-108">Client application runs in a network environment that allows HTTP but not TCP/IP connections.</span></span>  
  
-   <span data-ttu-id="1951b-109">用戶端應用程式無法使用 Analysis Services 用戶端程式庫 (例如，在 UNIX 伺服器上執行的 Java 應用程式)。</span><span class="sxs-lookup"><span data-stu-id="1951b-109">Client applications cannot use the Analysis Services client libraries (for example, a Java application running on a UNIX server).</span></span> <span data-ttu-id="1951b-110">如果您無法使用 Analysis Services 用戶端程式庫進行資料存取，可以透過與 Analysis Services 執行個體的 HTTP 直接連接，使用 SOAP 和 XML/A。</span><span class="sxs-lookup"><span data-stu-id="1951b-110">If you cannot use the Analysis Services client libraries for data access, you can use SOAP and XML/A over a direct HTTP connection to an Analysis Services instance.</span></span>  
  
-   <span data-ttu-id="1951b-111">需要 Windows 整合式安全性以外的驗證方法。</span><span class="sxs-lookup"><span data-stu-id="1951b-111">Authentication methods other than Windows integrated security are required.</span></span> <span data-ttu-id="1951b-112">具體而言，您可以在設定 Analysis Services 進行 HTTP 存取時使用匿名連接和基本驗證。</span><span class="sxs-lookup"><span data-stu-id="1951b-112">Specifically, you can use Anonymous connections and Basic authentication when configuring Analysis Services for HTTP access.</span></span> <span data-ttu-id="1951b-113">不支援摘要式、表單和 ASP.NET 驗證。</span><span class="sxs-lookup"><span data-stu-id="1951b-113">Digest, Forms, and ASP.NET authentication are not supported.</span></span> <span data-ttu-id="1951b-114">之所以要啟用 HTTP 存取，主要原因之一是基本驗證有此要求。</span><span class="sxs-lookup"><span data-stu-id="1951b-114">A requirement of Basic authentication is one of the primary reasons for enabling HTTP access.</span></span> <span data-ttu-id="1951b-115">若要深入了解，請參閱 [Microsoft BI 驗證及身分識別委派](https://go.microsoft.com/fwlink/?LinkId=286576)(英文)。</span><span class="sxs-lookup"><span data-stu-id="1951b-115">To learn more, see [Microsoft BI Authentication and Identity Delegation](https://go.microsoft.com/fwlink/?LinkId=286576).</span></span>  
  
 <span data-ttu-id="1951b-116">不論是執行表格式模式還是多維度模式，只要是受支援版本的 Analysis Services，您就可以設定 HTTP 存取。</span><span class="sxs-lookup"><span data-stu-id="1951b-116">You can configure HTTP access for any supported version or edition of Analysis Services, running either tabular mode or multidimensional mode.</span></span> <span data-ttu-id="1951b-117">但本機 Cube 例外。</span><span class="sxs-lookup"><span data-stu-id="1951b-117">Local cubes are an exception.</span></span> <span data-ttu-id="1951b-118">您無法透過 HTTP 端點連接到本機 Cube。</span><span class="sxs-lookup"><span data-stu-id="1951b-118">You cannot connect to a local cube via an HTTP endpoint.</span></span>  
  
 <span data-ttu-id="1951b-119">設定 HTTP 存取是安裝後續工作。</span><span class="sxs-lookup"><span data-stu-id="1951b-119">Setting up HTTP access is a post-installation task.</span></span> <span data-ttu-id="1951b-120">必須先安裝 Analysis Services，才能設定其 HTTP 存取。</span><span class="sxs-lookup"><span data-stu-id="1951b-120">Analysis Services must be installed before you can configure it for HTTP access.</span></span> <span data-ttu-id="1951b-121">身為 Analysis Services 系統管理員，您必須授與權限給 Windows 帳戶才能進行 HTTP 存取。</span><span class="sxs-lookup"><span data-stu-id="1951b-121">As the Analysis Services administrator, you will need to grant permissions to Windows accounts before HTTP access is possible.</span></span> <span data-ttu-id="1951b-122">此外，您最好先驗證安裝以確保它可完整運作，然後才進一步設定伺服器。</span><span class="sxs-lookup"><span data-stu-id="1951b-122">Additionally, it is a best practice to validate your installation first, ensuring that it is fully operational before configuring the server any further.</span></span> <span data-ttu-id="1951b-123">設定 HTTP 存取之後，您可以透過 TCP/IP 使用 HTTP 端點和一般的伺服器網路名稱。</span><span class="sxs-lookup"><span data-stu-id="1951b-123">After HTTP access is configured, you can use both the HTTP endpoint and the regular network name of the server over TCP/IP.</span></span> <span data-ttu-id="1951b-124">設定 HTTP 存取並不會讓其他方法就此無法存取資料。</span><span class="sxs-lookup"><span data-stu-id="1951b-124">Setting up HTTP access does not invalidate other approaches for data access.</span></span>  
  
 <span data-ttu-id="1951b-125">當您繼續進行 MSMDPUMP 設定時，請記住您有兩種連接可以納入考慮：client-to-IIS、IIS-to-SSAS。</span><span class="sxs-lookup"><span data-stu-id="1951b-125">As you move forward with MSMDPUMP configuration, remember there are two connections to consider: client-to-IIS, IIS-to-SSAS.</span></span> <span data-ttu-id="1951b-126">本文中的指示與「IIS 到 SSAS」有關。</span><span class="sxs-lookup"><span data-stu-id="1951b-126">The instructions in this article are about IIS-to-SSAS.</span></span> <span data-ttu-id="1951b-127">用戶端應用程式可能需要先進行其他設定才能連接到 IIS。</span><span class="sxs-lookup"><span data-stu-id="1951b-127">Your client application might require additional configuration before it can connect to IIS.</span></span> <span data-ttu-id="1951b-128">決定是否使用 SSL 或如何設定繫結等內容並不在本文的討論範圍。</span><span class="sxs-lookup"><span data-stu-id="1951b-128">Decisions such as whether to use SSL, or how to configure bindings, are out of scope for this article.</span></span> <span data-ttu-id="1951b-129">請參閱 [網頁伺服器 (IIS)](https://technet.microsoft.com/library/hh831725.aspx) ，以取得 IIS 的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="1951b-129">See [Web Server (IIS)](https://technet.microsoft.com/library/hh831725.aspx) for more information about IIS.</span></span>  
  
 <span data-ttu-id="1951b-130">這個主題包括下列各節：</span><span class="sxs-lookup"><span data-stu-id="1951b-130">This topic includes the following sections:</span></span>  
  
-   [<span data-ttu-id="1951b-131">概觀</span><span class="sxs-lookup"><span data-stu-id="1951b-131">Overview</span></span>](#bkmk_overview)  
  
-   [<span data-ttu-id="1951b-132">先決條件</span><span class="sxs-lookup"><span data-stu-id="1951b-132">Prerequisites</span></span>](#bkmk_prereq)  
  
-   [<span data-ttu-id="1951b-133">將 MSMDPUMP.dll 複製到 Web 伺服器上的資料夾中</span><span class="sxs-lookup"><span data-stu-id="1951b-133">Copy the MSMDPUMP.dll to a folder on the Web server</span></span>](#bkmk_copy)  
  
-   [<span data-ttu-id="1951b-134">在 IIS 中建立應用程式集區與虛擬目錄</span><span class="sxs-lookup"><span data-stu-id="1951b-134">Create an application pool and virtual directory in IIS</span></span>](#bkmk_appPool)  
  
-   [<span data-ttu-id="1951b-135">設定 IIS 驗證並加入延伸模組</span><span class="sxs-lookup"><span data-stu-id="1951b-135">Configure IIS authentication and add the extension</span></span>](#bkmk_auth)  
  
-   [<span data-ttu-id="1951b-136">編輯 MSMDPUMP.INI 檔案來設定目標伺服器</span><span class="sxs-lookup"><span data-stu-id="1951b-136">Edit the MSMDPUMP.INI file to set the target server</span></span>](#bkmk_edit)  
  
-   [<span data-ttu-id="1951b-137">測試您的組態</span><span class="sxs-lookup"><span data-stu-id="1951b-137">Test your configuration</span></span>](#bkmk_test)  
  
##  <a name="overview"></a><a name="bkmk_overview"></a> <span data-ttu-id="1951b-138">概觀</span><span class="sxs-lookup"><span data-stu-id="1951b-138">Overview</span></span>  
 <span data-ttu-id="1951b-139">MSMDPUMP 是一個 ISAPI 擴充程式，會載入到 IIS 並可重新導向至本機或遠端 Analysis Services 執行個體。</span><span class="sxs-lookup"><span data-stu-id="1951b-139">MSMDPUMP is an ISAPI extension that loads into IIS and provides redirection to a local or remote Analysis Services instance.</span></span> <span data-ttu-id="1951b-140">藉由設定此 ISAPI 擴充程式，即可建立 Analysis Services 執行個體的 HTTP 端點。</span><span class="sxs-lookup"><span data-stu-id="1951b-140">By configuring this ISAPI extension, you create an HTTP endpoint to an Analysis Services instance.</span></span>  
  
 <span data-ttu-id="1951b-141">您必須為每個 HTTP 端點建立及設定一個虛擬目錄。</span><span class="sxs-lookup"><span data-stu-id="1951b-141">You must create and configure one virtual directory for each HTTP endpoint.</span></span> <span data-ttu-id="1951b-142">每個端點都需要一組自己的 MSMDPUMP 檔案，用於您要連接的每個 Analysis Services 執行個體。</span><span class="sxs-lookup"><span data-stu-id="1951b-142">Each endpoint will need its own set of MSMDPUMP files, for each Analysis Services instance you want to connect to.</span></span> <span data-ttu-id="1951b-143">這組檔案中的組態檔會指定用於每個 HTTP 端點的 Analysis Services 執行個體名稱。</span><span class="sxs-lookup"><span data-stu-id="1951b-143">A configuration file in this file set specifies the name of the Analysis Services instance used for each HTTP endpoint.</span></span>  
  
 <span data-ttu-id="1951b-144">在 IIS 上，MSMDPUMP 會使用 Analysis Services OLE DB 提供者，透過 TCP/IP 連接至 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="1951b-144">On IIS, MSMDPUMP connects to Analysis Services using the Analysis Services OLE DB provider over TCP/IP.</span></span> <span data-ttu-id="1951b-145">雖然用戶端要求可以來自網域信任之外，但 Analysis Services 和 IIS 必須位於相同的網域或受信任的網域，原生連接才會成功。</span><span class="sxs-lookup"><span data-stu-id="1951b-145">Although client requests can originate outside of domain trust, both Analysis Services and IIS must be in the same domain or in trusted domains in order for the native connection to succeed.</span></span>  
  
 <span data-ttu-id="1951b-146">當 MSMDPUMP 連接至 Analysis Services 時，它會利用 Windows 使用者識別這麼做。</span><span class="sxs-lookup"><span data-stu-id="1951b-146">When MSMDPUMP connects to Analysis Services, it does so under a Windows user identity.</span></span> <span data-ttu-id="1951b-147">此帳戶將是匿名帳戶 (如果您是設定匿名連接的虛擬目錄) 或 Windows 使用者帳戶。</span><span class="sxs-lookup"><span data-stu-id="1951b-147">This account will either be the Anonymous account if you configured the virtual directory for anonymous connections, or a Windows user account.</span></span> <span data-ttu-id="1951b-148">這個帳戶在 Analysis Services 伺服器和資料庫上必須擁有適當的資料存取權限。</span><span class="sxs-lookup"><span data-stu-id="1951b-148">The account must have the appropriate data access rights on the Analysis Services server and database.</span></span>  
  
 <span data-ttu-id="1951b-149">![顯示元件間連接的圖表](../media/ssas.gif "顯示元件間連接的圖表")</span><span class="sxs-lookup"><span data-stu-id="1951b-149">![Diagram showing connections between components](../media/ssas.gif "Diagram showing connections between components")</span></span>  
  
 <span data-ttu-id="1951b-150">下表列出您針對不同狀況啟用 HTTP 存取時的其他考量。</span><span class="sxs-lookup"><span data-stu-id="1951b-150">The following table lists additional considerations when you enable HTTP access for different scenarios.</span></span>  
  
|<span data-ttu-id="1951b-151">案例</span><span class="sxs-lookup"><span data-stu-id="1951b-151">Scenario</span></span>|<span data-ttu-id="1951b-152">組態</span><span class="sxs-lookup"><span data-stu-id="1951b-152">Configuration</span></span>|  
|--------------|-------------------|  
|<span data-ttu-id="1951b-153">相同電腦上的 IIS 和 Analysis Services</span><span class="sxs-lookup"><span data-stu-id="1951b-153">IIS and Analysis Services on the same computer</span></span>|<span data-ttu-id="1951b-154">這是最簡單的組態，因為它可讓您搭配 NTLM 使用預設組態 (其伺服器名稱為 localhost)、本機 Analysis Services OLE DB 提供者，以及 Windows 整合式安全性。</span><span class="sxs-lookup"><span data-stu-id="1951b-154">This is the simplest configuration because it allows you to use the default configuration (where the server name is localhost), the local Analysis Services OLE DB provider, and Windows integrated security with NTLM.</span></span> <span data-ttu-id="1951b-155">假設用戶端也位於相同網域，驗證對使用者而言是透明的，您不需要採取其他任何動作。</span><span class="sxs-lookup"><span data-stu-id="1951b-155">Assuming that the client is also in the same domain, authentication is transparent to the user, with no additional work on your part.</span></span>|  
|<span data-ttu-id="1951b-156">不同電腦上的 IIS 和 Analysis Services</span><span class="sxs-lookup"><span data-stu-id="1951b-156">IIS and Analysis Services on different computers</span></span>|<span data-ttu-id="1951b-157">針對此拓撲，您必須在 Web 伺服器上安裝 Analysis Services OLE DB 提供者。</span><span class="sxs-lookup"><span data-stu-id="1951b-157">For this topology, you must install the Analysis Services OLE DB provider on the web server.</span></span> <span data-ttu-id="1951b-158">您也必須編輯 msmdpump.ini 檔案，以便在遠端電腦上指定 Analysis Services 執行個體的位置。</span><span class="sxs-lookup"><span data-stu-id="1951b-158">You must also edit the msmdpump.ini file to specify the location of Analysis Services instance on the remote computer.</span></span><br /><br /> <span data-ttu-id="1951b-159">此拓撲加入了雙躍點驗證步驟，其中認證必須從用戶端流向 Web 伺服器，然後再流向後端 Analysis Services 伺服器。</span><span class="sxs-lookup"><span data-stu-id="1951b-159">This topology adds a double-hop authentication step, where credentials must flow from the client to the web server, and on to the backend Analysis Services server.</span></span> <span data-ttu-id="1951b-160">如果您要使用 Windows 認證和 NTLM，將會出現錯誤，因為 NTLM 不允許將用戶端認證委派給另一部伺服器。</span><span class="sxs-lookup"><span data-stu-id="1951b-160">If you are using Windows credentials and NTLM, you will get an error because NTLM does not allow delegation of client credentials to a second server.</span></span> <span data-ttu-id="1951b-161">最常見的方案是搭配安全通訊端層 (SSL) 使用基本驗證，但在存取 MSMDPUMP 虛擬目錄時，這將需要使用者提供使用者名稱和密碼。</span><span class="sxs-lookup"><span data-stu-id="1951b-161">The most common solution is to use Basic authentication with Secure Sockets Layer (SSL), but this will require users to provide a user name and password when accessing the MSMDPUMP virtual directory.</span></span> <span data-ttu-id="1951b-162">更直接的方法可能是啟用 Kerberos 並設定 Analysis Services 限制委派，讓使用者可以用透明的方式存取 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="1951b-162">A more straightforward approach might be to enable Kerberos and configure Analysis Services constrained delegation so that users can access Analysis Services in a transparent manner.</span></span> <span data-ttu-id="1951b-163">請參閱 [設定 Analysis Services 進行 Kerberos 限制委派](configure-analysis-services-for-kerberos-constrained-delegation.md) 以取得詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="1951b-163">See [Configure Analysis Services for Kerberos constrained delegation](configure-analysis-services-for-kerberos-constrained-delegation.md) for details.</span></span><br /><br /> <span data-ttu-id="1951b-164">請考慮要在 Windows 防火牆中解除封鎖哪些通訊埠。</span><span class="sxs-lookup"><span data-stu-id="1951b-164">Consider which ports to unblock in Windows Firewall.</span></span> <span data-ttu-id="1951b-165">您將需要解除封鎖兩部伺服器上的通訊埠，以便存取 IIS 上的 Web 應用程式，以及遠端伺服器上的 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="1951b-165">You will need to unblock ports on both servers to allow access to the web application on IIS, and to Analysis Services on a remote server.</span></span>|  
|<span data-ttu-id="1951b-166">用戶端連接是來自不信任網域或外部網路連接</span><span class="sxs-lookup"><span data-stu-id="1951b-166">Client connections are from a non-trusted domain or an extranet connection</span></span>|<span data-ttu-id="1951b-167">來自不信任網域的用戶端連接會進一步導入驗證的限制。</span><span class="sxs-lookup"><span data-stu-id="1951b-167">Client connections from a non-trusted domain introduce further restrictions on authentication.</span></span> <span data-ttu-id="1951b-168">根據預設，Analysis Services 使用 Windows 整合式驗證，這種驗證需要使用者與伺服器位於相同網域上。</span><span class="sxs-lookup"><span data-stu-id="1951b-168">By default, Analysis Services uses Windows integrated authentication, which requires users to be on the same domain as the server.</span></span> <span data-ttu-id="1951b-169">如果您有從網域外部連接至 IIS 的外部網路使用者，當伺服器設定為使用預設值時，那些使用者會發生連接錯誤。</span><span class="sxs-lookup"><span data-stu-id="1951b-169">If you have Extranet users who connect to IIS from outside the domain, those users will get a connection error if the server is configured to use the default settings.</span></span><br /><br /> <span data-ttu-id="1951b-170">因應措施包括，讓外部網路使用者使用網域認證，透過 VPN 連接。</span><span class="sxs-lookup"><span data-stu-id="1951b-170">Workarounds include having Extranet users connect through a VPN using domain credentials.</span></span> <span data-ttu-id="1951b-171">不過，更好的方法可能是在 IIS 網站上啟用基本驗證和 SSL。</span><span class="sxs-lookup"><span data-stu-id="1951b-171">However, a better approach might be to enable Basic authentication and SSL on your IIS web site.</span></span>|  
  
##  <a name="prerequisites"></a><a name="bkmk_prereq"></a> <span data-ttu-id="1951b-172">必要條件</span><span class="sxs-lookup"><span data-stu-id="1951b-172">Prerequisites</span></span>  
 <span data-ttu-id="1951b-173">本文中的指示假設已設定 IIS 且已安裝 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="1951b-173">The instructions in this article assume IIS is already configured and that Analysis Services is already installed.</span></span> <span data-ttu-id="1951b-174">Windows Server 2012 隨附 IIS 8.x 以做為伺服器角色，您可以在系統上加以啟用。</span><span class="sxs-lookup"><span data-stu-id="1951b-174">Windows Server 2012 ships with IIS 8.x as a server role that you can enable on the system.</span></span>  
  
 <span data-ttu-id="1951b-175">**在 IIS 8.0 中的額外設定**</span><span class="sxs-lookup"><span data-stu-id="1951b-175">**Extra configuration in IIS 8.0**</span></span>  
  
 <span data-ttu-id="1951b-176">IIS 8.0 的預設組態遺漏要透過 HTTP 存取 Analysis services 所需的元件。</span><span class="sxs-lookup"><span data-stu-id="1951b-176">The default configuration of IIS 8.0 is missing components that are necessary for HTTP access to Analysis Services.</span></span> <span data-ttu-id="1951b-177">這些元件 (位於 [網頁伺服器 (IIS)]\*\*\*\* 角色的 [安全性]\*\*\*\* 和 [應用程式開發]\*\*\*\* 功能區域) 包括：</span><span class="sxs-lookup"><span data-stu-id="1951b-177">These components, found in the **Security** and **Application Development** feature areas of the **Web Server (IIS)** role, include the following:</span></span>  
  
-   <span data-ttu-id="1951b-178">**安全性**  | **Windows 驗證**或**基本驗證**，以及您的資料存取案例所需的任何其他安全性功能。</span><span class="sxs-lookup"><span data-stu-id="1951b-178">**Security** | **Windows Authentication**, or **Basic Authentication**, and any other security features required for your data access scenario.</span></span>  
  
-   <span data-ttu-id="1951b-179">**應用程式開發**  | **CGI**</span><span class="sxs-lookup"><span data-stu-id="1951b-179">**Application Development** | **CGI**</span></span>  
  
-   <span data-ttu-id="1951b-180">**應用程式開發**  | **ISAPI 擴充**功能</span><span class="sxs-lookup"><span data-stu-id="1951b-180">**Application Development** | **ISAPI Extensions**</span></span>  
  
 <span data-ttu-id="1951b-181">若要確認或加入這些元件，請使用**伺服器管理員**  |  **管理**  |  **新增角色及功能**]。</span><span class="sxs-lookup"><span data-stu-id="1951b-181">To verify or add these components, use **Server Manager** | **Manage** | **Add Roles and Features**.</span></span> <span data-ttu-id="1951b-182">逐步執行精靈直到到達 [伺服器角色]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="1951b-182">Step through the wizard until you get to **Server Roles**.</span></span> <span data-ttu-id="1951b-183">向下捲動以尋找 [網頁伺服器 (IIS)]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="1951b-183">Scroll down to find **Web Server (IIS)**.</span></span>  
  
1.  <span data-ttu-id="1951b-184">開啟 [**網頁伺服器**  |  **安全性**]，然後選擇驗證方法。</span><span class="sxs-lookup"><span data-stu-id="1951b-184">Open **Web Server** | **Security** and choose the authentication methods.</span></span>  
  
2.  <span data-ttu-id="1951b-185">開啟 [**網頁伺服器**  |  **應用程式開發**]，然後選擇 [ **CGI**和**ISAPI 延伸**模組]。</span><span class="sxs-lookup"><span data-stu-id="1951b-185">Open **Web Server** | **Application Development** and choose **CGI** and **ISAPI Extensions**.</span></span>  
  
     <span data-ttu-id="1951b-186">![網頁伺服器角色的 [新增功能] 頁面](../media/ssas-httpaccess-isapicgi.png "網頁伺服器角色的 [新增功能] 頁面")</span><span class="sxs-lookup"><span data-stu-id="1951b-186">![Add features page for Web server role](../media/ssas-httpaccess-isapicgi.png "Add features page for Web server role")</span></span>  
  
 <span data-ttu-id="1951b-187">**當 IIS 是在遠端伺服器上**</span><span class="sxs-lookup"><span data-stu-id="1951b-187">**When IIS is on a remote server**</span></span>  
  
 <span data-ttu-id="1951b-188">要在 IIS 和 Analysis Services 之間進行遠端連接，您必須在執行 IIS 的 Windows 伺服器上安裝 Analysis Services OLE DB 提供者 (MSOLAP)。</span><span class="sxs-lookup"><span data-stu-id="1951b-188">A remote connection between IIS and Analysis Services requires that you install the Analysis Services OLE DB provider (MSOLAP) on the Windows server running IIS.</span></span>  
  
1.  <span data-ttu-id="1951b-189">移至 [SQL Server 2014 功能套件](https://www.microsoft.com/download/details.aspx?id=42295)的下載頁面</span><span class="sxs-lookup"><span data-stu-id="1951b-189">Go to the download page for [SQL Server 2014 Feature Pack](https://www.microsoft.com/download/details.aspx?id=42295)</span></span>  
  
2.  <span data-ttu-id="1951b-190">按一下紅色的 [下載] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="1951b-190">Click the red Download button.</span></span>  
  
3.  <span data-ttu-id="1951b-191">向下捲動以找到 CHT\x64\SQL_AS_OLEDB.msi。</span><span class="sxs-lookup"><span data-stu-id="1951b-191">Scroll down to find ENU\x64\SQL_AS_OLEDB.msi</span></span>  
  
4.  <span data-ttu-id="1951b-192">遵循精靈的指示完成安裝。</span><span class="sxs-lookup"><span data-stu-id="1951b-192">Follow the instructions in the wizard to complete the installation.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="1951b-193">請記得解除封鎖 Windows 防火牆中的連接埠，以允許用戶端與 Analysis Services 遠端伺服器的連接。</span><span class="sxs-lookup"><span data-stu-id="1951b-193">Remember to unblock the ports in Windows Firewall to allow client connections to a remote Analysis Services server.</span></span> <span data-ttu-id="1951b-194">如需詳細資訊，請參閱 [Configure the Windows Firewall to Allow Analysis Services Access](configure-the-windows-firewall-to-allow-analysis-services-access.md)。</span><span class="sxs-lookup"><span data-stu-id="1951b-194">For more information, see [Configure the Windows Firewall to Allow Analysis Services Access](configure-the-windows-firewall-to-allow-analysis-services-access.md).</span></span>  
  
##  <a name="step-1-copy-the-msmdpump-files-to-a-folder-on-the-web-server"></a><a name="bkmk_copy"></a><span data-ttu-id="1951b-195">步驟1：將 MSMDPUMP 檔案複製到 Web 服務器上的資料夾</span><span class="sxs-lookup"><span data-stu-id="1951b-195">Step 1: Copy the MSMDPUMP files to a folder on the Web server</span></span>  
 <span data-ttu-id="1951b-196">您建立的每個 HTTP 端點都必須有一組自己的 MSMDPUMP 檔案。</span><span class="sxs-lookup"><span data-stu-id="1951b-196">Each HTTP endpoint that you create must have its own set of MSMDPUMP files.</span></span> <span data-ttu-id="1951b-197">在此步驟中，您要將 MSMDPUMP 可執行檔、組態檔以及資源資料夾從 Analysis Services 程式資料夾，複製到您將在執行 IIS 所在電腦的檔案系統上建立的新虛擬目錄資料夾。</span><span class="sxs-lookup"><span data-stu-id="1951b-197">In this step, you copy the MSMDPUMP executable, configuration file, and resource folder from the Analysis Services program folders to a new virtual directory folder that you will create on the file system of the computer running IIS.</span></span>  
  
 <span data-ttu-id="1951b-198">磁碟機必須格式化為 NTFS 檔案系統。</span><span class="sxs-lookup"><span data-stu-id="1951b-198">The drive must be formatted for the NTFS file system.</span></span> <span data-ttu-id="1951b-199">您所建立之資料夾的路徑不得包含任何空格。</span><span class="sxs-lookup"><span data-stu-id="1951b-199">The path to the folder that you create must not contain any spaces.</span></span>  
  
1.  <span data-ttu-id="1951b-200">複製下列檔案，其位於 \<drive> ： \Program Files\Microsoft SQL Server \\<實例 \> \OLAP\bin\isapi： MSMDPUMP.DLL、MSMDPUMP.INI 和 Resources 資料夾。</span><span class="sxs-lookup"><span data-stu-id="1951b-200">Copy the following files, found at \<drive>:\Program Files\Microsoft SQL Server\\<instance\>\OLAP\bin\isapi: MSMDPUMP.DLL, MSMDPUMP.INI, and a Resources folder.</span></span>  
  
     <span data-ttu-id="1951b-201">![[檔案總管] 顯示要複製的檔案](../media/ssas-httpaccess-msmdpumpfilecopy.PNG "[檔案總管] 顯示要複製的檔案")</span><span class="sxs-lookup"><span data-stu-id="1951b-201">![File Explorer showing files to copy](../media/ssas-httpaccess-msmdpumpfilecopy.PNG "File Explorer showing files to copy")</span></span>  
  
2.  <span data-ttu-id="1951b-202">在 web 伺服器上，建立新的資料夾： \<drive> ： \Inetpub\wwwroot \\ **OLAP**</span><span class="sxs-lookup"><span data-stu-id="1951b-202">On the web server, create a new folder: \<drive>:\inetpub\wwwroot\\**OLAP**</span></span>  
  
3.  <span data-ttu-id="1951b-203">將您先前複製的檔案貼入此新資料夾中。</span><span class="sxs-lookup"><span data-stu-id="1951b-203">Paste the files that you previously copied into this new folder.</span></span>  
  
4.  <span data-ttu-id="1951b-204">請確認您 Web 伺服器上的 \inetpub\wwwroot\OLAP 資料夾中包含下列內容：MSMDPUMP.DLL、MSMDPUMP.INI，以及 Resources 資料夾。</span><span class="sxs-lookup"><span data-stu-id="1951b-204">Verify that the \inetpub\wwwroot\OLAP folder on your web server contains the following: MSMDPUMP.DLL, MSMDPUMP.INI, and a Resources folder.</span></span> <span data-ttu-id="1951b-205">您的資料夾結構看起來應該像這樣：</span><span class="sxs-lookup"><span data-stu-id="1951b-205">Your folder structure should look like this:</span></span>  
  
    -   <span data-ttu-id="1951b-206">\<drive>:\inetpub\wwwroot\OLAP\MSMDPUMP.dll</span><span class="sxs-lookup"><span data-stu-id="1951b-206">\<drive>:\inetpub\wwwroot\OLAP\MSMDPUMP.dll</span></span>  
  
    -   <span data-ttu-id="1951b-207">\<drive>:\inetpub\wwwroot\OLAP\MSMDPUMP.ini</span><span class="sxs-lookup"><span data-stu-id="1951b-207">\<drive>:\inetpub\wwwroot\OLAP\MSMDPUMP.ini</span></span>  
  
    -   <span data-ttu-id="1951b-208">\<drive>:\inetpub\wwwroot\OLAP\Resources</span><span class="sxs-lookup"><span data-stu-id="1951b-208">\<drive>:\inetpub\wwwroot\OLAP\Resources</span></span>  
  
##  <a name="step-2-create-an-application-pool-and-virtual-directory-in-iis"></a><a name="bkmk_appPool"></a><span data-ttu-id="1951b-209">步驟2：在 IIS 中建立應用程式集區和虛擬目錄</span><span class="sxs-lookup"><span data-stu-id="1951b-209">Step 2: Create an application pool and virtual directory in IIS</span></span>  
 <span data-ttu-id="1951b-210">接下來，為幫浦建立應用程式集區和端點。</span><span class="sxs-lookup"><span data-stu-id="1951b-210">Next, create an application pool and an endpoint to the pump.</span></span>  
  
#### <a name="create-an-application-pool"></a><span data-ttu-id="1951b-211">建立應用程式集區</span><span class="sxs-lookup"><span data-stu-id="1951b-211">Create an application pool</span></span>  
  
1.  <span data-ttu-id="1951b-212">啟動 IIS 管理員。</span><span class="sxs-lookup"><span data-stu-id="1951b-212">Start IIS Manager.</span></span>  
  
2.  <span data-ttu-id="1951b-213">開啟伺服器資料夾，以滑鼠右鍵按一下 [應用程式集區]\*\*\*\*，然後按一下 [新增應用程式集區]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="1951b-213">Open the server folder, right-click **Application Pools** and then click **Add Application Pool**.</span></span> <span data-ttu-id="1951b-214">使用 .NET Framework，在 Managed 管線模式設為 [傳統]\*\*\*\* 的情況下，建立名稱為 **OLAP** 的應用程式集區。</span><span class="sxs-lookup"><span data-stu-id="1951b-214">Create an application pool named **OLAP**, using the .NET Framework, with Managed pipeline mode set to **Classic**.</span></span>  
  
     <span data-ttu-id="1951b-215">![新增應用程式集區對話方塊的螢幕擷取畫面](../media/ssas-httpaccess.PNG "新增應用程式集區對話方塊的螢幕擷取畫面")</span><span class="sxs-lookup"><span data-stu-id="1951b-215">![Screenshot of Add Application Pool dialog](../media/ssas-httpaccess.PNG "Screenshot of Add Application Pool dialog")</span></span>  
  
3.  <span data-ttu-id="1951b-216">根據預設，IIS 會以 **ApplicationPoolIdentity** 做為安全性識別來建立應用程式集區，這對 Analysis Services 的 HTTP 存取來說是有效的選擇。</span><span class="sxs-lookup"><span data-stu-id="1951b-216">By default, IIS creates application pools using **ApplicationPoolIdentity** as the security identity, which is a valid choice for HTTP access to Analysis Services.</span></span> <span data-ttu-id="1951b-217">如果您有特定的理由要變更識別，請以滑鼠右鍵按一下 [OLAP]\*\*\*\*，然後選取 [進階設定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="1951b-217">If you have specific reasons for changing the identity, right-click **OLAP**, and then select **Advanced Settings**.</span></span> <span data-ttu-id="1951b-218">選取 [ApplicationPoolIdentity]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="1951b-218">Select **ApplicationPoolIdentity**.</span></span> <span data-ttu-id="1951b-219">按一下此屬性的 [變更]\*\*\*\* 按鈕，以您要使用的自訂帳戶取代內建帳戶。</span><span class="sxs-lookup"><span data-stu-id="1951b-219">Click the **Change** button for this property to replace the built-in account with the custom account you want to use.</span></span>  
  
     <span data-ttu-id="1951b-220">![進階設定屬性頁的螢幕擷取畫面](../media/ssas-httpaccess-advsettings.PNG "進階設定屬性頁的螢幕擷取畫面")</span><span class="sxs-lookup"><span data-stu-id="1951b-220">![Screenshot of Advanced Settings property page](../media/ssas-httpaccess-advsettings.PNG "Screenshot of Advanced Settings property page")</span></span>  
  
4.  <span data-ttu-id="1951b-221">根據預設，IIS 會在 64 位元作業系統上，將 [啟用 32 位元應用程式]\*\*\*\* 屬性設定為 **false**。</span><span class="sxs-lookup"><span data-stu-id="1951b-221">By default, on a 64-bit operating system, IIS sets the **Enable 32-bit Applications** property to **false**.</span></span> <span data-ttu-id="1951b-222">如果您從 64 位元的 Analysis Services 安裝複製 msmdpump.dll，對 64 位元 IIS 伺服器上的 MSMDPUMP 延伸程式而言，這是正確的設定。</span><span class="sxs-lookup"><span data-stu-id="1951b-222">If you copied msmdpump.dll from a 64-bit installation of Analysis Services, this is the correct setting for the MSMDPUMP extension on a 64-bit IIS server.</span></span> <span data-ttu-id="1951b-223">如果您從 32 位元安裝複製 MSMDPUMP 二進位檔，請將它設定為 **true**。</span><span class="sxs-lookup"><span data-stu-id="1951b-223">If you copied the MSMDPUMP binaries from a 32-bit installation, set it to **true**.</span></span> <span data-ttu-id="1951b-224">立即在 [進階設定]\*\*\*\* 中檢查此屬性以確認設定是否正確。</span><span class="sxs-lookup"><span data-stu-id="1951b-224">Check this property now in **Advanced Settings** to ensure it is set correctly.</span></span>  
  
#### <a name="create-an-application"></a><span data-ttu-id="1951b-225">建立應用程式</span><span class="sxs-lookup"><span data-stu-id="1951b-225">Create an application</span></span>  
  
1.  <span data-ttu-id="1951b-226">在 [IIS 管理員] 中，依序開啟 [網站]\*\*\*\* 和 [預設的網站]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="1951b-226">In IIS Manager, open **Sites**, open **Default Web Site**.</span></span> <span data-ttu-id="1951b-227">您應該會看到名為 **Olap**的資料夾。</span><span class="sxs-lookup"><span data-stu-id="1951b-227">You should see a folder named **Olap**.</span></span> <span data-ttu-id="1951b-228">這是 \inetpub\wwwroot 之下所建立的 OLAP 資料夾的參考。</span><span class="sxs-lookup"><span data-stu-id="1951b-228">This is a reference to the OLAP folder you created under \inetpub\wwwroot.</span></span>  
  
     <span data-ttu-id="1951b-229">![預設網站下的 OLAP 資料夾](../media/ssas-httpaccess-convertfolderbefore.png "預設網站下的 OLAP 資料夾")</span><span class="sxs-lookup"><span data-stu-id="1951b-229">![OLAP folder under default web site](../media/ssas-httpaccess-convertfolderbefore.png "OLAP folder under default web site")</span></span>  
  
2.  <span data-ttu-id="1951b-230">以滑鼠右鍵按一下該資料夾，然後選擇 [轉換成應用程式]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="1951b-230">Right-click the folder and choose **Convert to Application**.</span></span>  
  
3.  <span data-ttu-id="1951b-231">在 [新增應用程式] 中，輸入 **OLAP** 做為別名。</span><span class="sxs-lookup"><span data-stu-id="1951b-231">In Add Application, enter **OLAP** for the alias.</span></span> <span data-ttu-id="1951b-232">按一下 [選取]\*\*\*\* 以選擇 OLAP 應用程式集區。</span><span class="sxs-lookup"><span data-stu-id="1951b-232">Click **Select** to choose the OLAP application pool.</span></span> <span data-ttu-id="1951b-233">實體路徑應該設定為 C:\inetpub\wwwroot\OLAP</span><span class="sxs-lookup"><span data-stu-id="1951b-233">Physical Path should be set to C:\inetpub\wwwroot\OLAP</span></span>  
  
     <span data-ttu-id="1951b-234">![新增應用程式對話方塊](../media/ssas-httpaccess-convertedapp.png "新增應用程式對話方塊")</span><span class="sxs-lookup"><span data-stu-id="1951b-234">![Add Application dialog box](../media/ssas-httpaccess-convertedapp.png "Add Application dialog box")</span></span>  
  
4.  <span data-ttu-id="1951b-235">按一下 [確定]  。</span><span class="sxs-lookup"><span data-stu-id="1951b-235">Click **OK**.</span></span> <span data-ttu-id="1951b-236">重新整理網站，並注意「OLAP」資料夾現在是在「預設的網站」底下的應用程式。</span><span class="sxs-lookup"><span data-stu-id="1951b-236">Refresh the web site and notice that the OLAP folder is now an application under the default web site.</span></span> <span data-ttu-id="1951b-237">現在即已建立 MSMDPUMP 檔案的虛擬路徑。</span><span class="sxs-lookup"><span data-stu-id="1951b-237">The virtual path to the MSMDPUMP file is now established.</span></span>  
  
     <span data-ttu-id="1951b-238">![應用程式轉換後的 OLAP 資料夾](../media/ssas-httpaccess-convertfolderafter.png "應用程式轉換後的 OLAP 資料夾")</span><span class="sxs-lookup"><span data-stu-id="1951b-238">![OLAP folder after app conversion](../media/ssas-httpaccess-convertfolderafter.png "OLAP folder after app conversion")</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="1951b-239">舊版的這些指示包含建立虛擬目錄的步驟。</span><span class="sxs-lookup"><span data-stu-id="1951b-239">Previous versions of these instructions included steps for creating a virtual directory.</span></span> <span data-ttu-id="1951b-240">現已不再需要該步驟。</span><span class="sxs-lookup"><span data-stu-id="1951b-240">That step is no longer necessary.</span></span>  
  
##  <a name="step-3-configure-iis-authentication-and-add-the-extension"></a><a name="bkmk_auth"></a> <span data-ttu-id="1951b-241">步驟 3：設定 IIS 驗證並加入延伸模組</span><span class="sxs-lookup"><span data-stu-id="1951b-241">Step 3: Configure IIS authentication and add the extension</span></span>  
 <span data-ttu-id="1951b-242">在此步驟中，您會進一步設定您剛建立的 SSAS 虛擬目錄。</span><span class="sxs-lookup"><span data-stu-id="1951b-242">In this step, you further configure the SSAS virtual directory you just created.</span></span> <span data-ttu-id="1951b-243">您將會指定驗證方法，然後加入指令碼對應。</span><span class="sxs-lookup"><span data-stu-id="1951b-243">You will specify an authentication method and then add a script map.</span></span> <span data-ttu-id="1951b-244">經由 HTTP 的 Analysis Services 所支援的驗證方法包括：</span><span class="sxs-lookup"><span data-stu-id="1951b-244">Supported authentication methods for Analysis Services over HTTP include:</span></span>  
  
-   <span data-ttu-id="1951b-245">Windows 驗證 (Kerberos 或 NTLM)</span><span class="sxs-lookup"><span data-stu-id="1951b-245">Windows authentication (Kerberos or NTLM)</span></span>  
  
-   <span data-ttu-id="1951b-246">基本驗證</span><span class="sxs-lookup"><span data-stu-id="1951b-246">Basic authentication</span></span>  
  
-   <span data-ttu-id="1951b-247">匿名驗證</span><span class="sxs-lookup"><span data-stu-id="1951b-247">Anonymous authentication</span></span>  
  
 <span data-ttu-id="1951b-248">**Windows 驗證** 是被視為最安全，並且會針對使用 Active Directory 的網路運用現有基礎結構。</span><span class="sxs-lookup"><span data-stu-id="1951b-248">**Windows authentication** is considered the most secure, and leverages existing infrastructure for networks that use Active Directory.</span></span> <span data-ttu-id="1951b-249">若要有效使用 Windows 驗證，所有瀏覽器、用戶端應用程式及伺服器應用程式都必須支援該驗證。</span><span class="sxs-lookup"><span data-stu-id="1951b-249">To use Windows authentication effectively, all browsers, client applications, and server applications must support it.</span></span> <span data-ttu-id="1951b-250">這是最安全的建議模式，但是它要求 IIS 能夠存取可驗證要求連接之使用者識別的 Windows 網域控制站。</span><span class="sxs-lookup"><span data-stu-id="1951b-250">This is the most secure and recommended mode, but it requires that IIS be able to access a Windows domain controller that can authenticate the identity of the user requesting a connection.</span></span>  
  
 <span data-ttu-id="1951b-251">對於將 Analysis Services 和 IIS 放置於不同電腦的拓撲，您將需要解決雙躍點問題，這是在需要將使用者識別委派至遠端電腦上的另一項服務時所引發的問題，通常是因啟用 Analysis Services 進行 Kerberos 限制委派所造成。</span><span class="sxs-lookup"><span data-stu-id="1951b-251">For topologies that put Analysis Services and IIS on different computers, you will need to address double-hop issues that arise when a user identity needs to be delegated to a second service on a remote machine, typically by enabling Analysis Services for Kerberos constrained delegation.</span></span> <span data-ttu-id="1951b-252">如需詳細資訊，請參閱 [Configure Analysis Services for Kerberos constrained delegation](configure-analysis-services-for-kerberos-constrained-delegation.md)。</span><span class="sxs-lookup"><span data-stu-id="1951b-252">For more information, see [Configure Analysis Services for Kerberos constrained delegation](configure-analysis-services-for-kerberos-constrained-delegation.md).</span></span>  
  
 <span data-ttu-id="1951b-253">**基本驗證** 是在您有 Windows 識別，但使用者連接來自非信任網域，因而禁止使用委派或模擬的連接時使用。</span><span class="sxs-lookup"><span data-stu-id="1951b-253">**Basic authentication** is used when you have Windows identities, but user connections are from non-trusted domains, prohibiting the use of delegated or impersonated connections.</span></span> <span data-ttu-id="1951b-254">基本驗證可讓您在連接字串上指定使用者識別和密碼。</span><span class="sxs-lookup"><span data-stu-id="1951b-254">Basic authentication lets you specify a user identity and password on a connection string.</span></span> <span data-ttu-id="1951b-255">連接至 Analysis Services 時不會使用目前使用者的安全性內容，而是使用連接字串上的認證。</span><span class="sxs-lookup"><span data-stu-id="1951b-255">Instead of using the security context of the current user, credentials on the connection string are used to connect to Analysis Services.</span></span> <span data-ttu-id="1951b-256">由於 Analysis Services 僅支援 Windows 驗證，因此任何傳遞至 Analysis Services 的認證都必須是裝載 Analysis Services 所在網域之成員的 Windows 使用者或群組。</span><span class="sxs-lookup"><span data-stu-id="1951b-256">Because Analysis Services supports only Windows authentication, any credentials passed to it must be a Windows user or group that is a member of the domain in which Analysis Services is hosted.</span></span>  
  
 <span data-ttu-id="1951b-257">**匿名驗證** 經常在初始測試期間使用，因為它容易設定，可協助您快速驗證 Analysis Services 的 HTTP 連線。</span><span class="sxs-lookup"><span data-stu-id="1951b-257">**Anonymous authentication** is often used during initial testing because its ease of configuration helps you to quickly validate HTTP connectivity to Analysis Services.</span></span> <span data-ttu-id="1951b-258">只要執行幾個步驟，您就可以指派唯一的使用者帳戶做為識別、授與該帳戶 Analysis Services 中的權限、使用帳戶確認用戶端應用程式中的資料存取，然後在測試完成時停用匿名驗證。</span><span class="sxs-lookup"><span data-stu-id="1951b-258">In just a few steps, you can assign a unique user account as the identity, grant that account permissions in Analysis Services, use the account to verify data access in a client application, and then disable Anonymous authentication when testing is complete.</span></span>  
  
 <span data-ttu-id="1951b-259">如果使用者沒有 Windows 使用者帳戶，您也可以在生產環境中使用匿名驗證，不過請遵循最佳做法鎖定主機系統上的權限，如同此文件中所述： [啟用匿名驗證 (IIS 7)](https://technet.microsoft.com/library/cc731244\(v=ws.10\).aspx)。</span><span class="sxs-lookup"><span data-stu-id="1951b-259">You can also use Anonymous authentication in a production environment if your users do not have Windows user accounts, but follow best practices by locking down permissions on the host system, as called out in this article: [Enable Anonymous Authentication (IIS 7)](https://technet.microsoft.com/library/cc731244\(v=ws.10\).aspx).</span></span> <span data-ttu-id="1951b-260">務必在虛擬目錄上設定驗證，而不是在父網站上，以便進一步降低帳戶存取層級。</span><span class="sxs-lookup"><span data-stu-id="1951b-260">Be sure that authentication is set on the virtual directory, and not on the parent web site, to further reduce the level of account access.</span></span>  
  
 <span data-ttu-id="1951b-261">啟用匿名時，可透過匿名使用者身分進行任何對 HTTP 端點的使用者連接。</span><span class="sxs-lookup"><span data-stu-id="1951b-261">When Anonymous is enabled, any user connection to the HTTP endpoint is allowed to connect as the anonymous user.</span></span> <span data-ttu-id="1951b-262">您將無法審核個別使用者連接，也無法使用使用者識別從模型選取資料。</span><span class="sxs-lookup"><span data-stu-id="1951b-262">You won't be able to audit individual user connections, nor use the user identity to select data from a model.</span></span> <span data-ttu-id="1951b-263">如您所見，使用匿名的影響範圍包含從模型設計到資料重新整理和存取的一切。</span><span class="sxs-lookup"><span data-stu-id="1951b-263">As you can see, using Anonymous impacts everything from model design, to data refresh and access.</span></span> <span data-ttu-id="1951b-264">不過，如果使用者沒有 Windows 使用者登入，則使用匿名帳戶可能是您唯一的選項。</span><span class="sxs-lookup"><span data-stu-id="1951b-264">However, if users do not have a Windows user login to start with, using the Anonymous account might be your only option.</span></span>  
  
#### <a name="set-the-authentication-type-and-add-a-script-map"></a><span data-ttu-id="1951b-265">設定驗證類型及加入指令碼對應</span><span class="sxs-lookup"><span data-stu-id="1951b-265">Set the authentication type and add a script map</span></span>  
  
1.  <span data-ttu-id="1951b-266">在 [IIS 管理員] 中，依序開啟 [網站]\*\*\*\* 和 [預設的網站]\*\*\*\*，然後選取 [OLAP]\*\*\*\* 虛擬目錄。</span><span class="sxs-lookup"><span data-stu-id="1951b-266">In IIS Manager, open **Sites**, open **Default Web Site**, and then select the **OLAP** virtual directory.</span></span>  
  
2.  <span data-ttu-id="1951b-267">在主頁面的 IIS 區段中，按兩下 [驗證]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="1951b-267">Double-click **Authentication** in the IIS section of the main page.</span></span>  
  
     <span data-ttu-id="1951b-268">![IIS 管理員主頁面的螢幕擷取畫面](../media/ssas-httpaccess-iis.png "IIS 管理員主頁面的螢幕擷取畫面")</span><span class="sxs-lookup"><span data-stu-id="1951b-268">![Screenshot of IIS Manager main page](../media/ssas-httpaccess-iis.png "Screenshot of IIS Manager main page")</span></span>  
  
3.  <span data-ttu-id="1951b-269">如果要使用 Windows 整合式安全性，請啟用 [Windows 驗證]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="1951b-269">Enable **Windows Authentication** if you are using Windows integrated security.</span></span>  
  
     <span data-ttu-id="1951b-270">![Vdir 驗證設定的螢幕擷取畫面](../media/ssas-httpaccess-iisauth.png "Vdir 驗證設定的螢幕擷取畫面")</span><span class="sxs-lookup"><span data-stu-id="1951b-270">![Screenshot of Vdir Authentication settings](../media/ssas-httpaccess-iisauth.png "Screenshot of Vdir Authentication settings")</span></span>  
  
4.  <span data-ttu-id="1951b-271">或者，如果您的用戶端和伺服器應用程式位於不同的網域，請啟用 [基本驗證]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="1951b-271">Alternatively, enable **Basic Authentication** if your client and server applications are in different domains.</span></span> <span data-ttu-id="1951b-272">此模式會要求使用者輸入使用者名稱和密碼。</span><span class="sxs-lookup"><span data-stu-id="1951b-272">This mode requires the user to enter a user name and password.</span></span> <span data-ttu-id="1951b-273">使用者名稱和密碼是透過 HTTP 連接，傳送到 IIS。</span><span class="sxs-lookup"><span data-stu-id="1951b-273">The user name and password are transmitted over the HTTP connection to IIS.</span></span> <span data-ttu-id="1951b-274">連接至 MSMDPUMP 時，IIS 將嘗試模擬使用所提供認證的使用者，但是認證不會委派至 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="1951b-274">IIS will try to impersonate the user using the provided credentials when connecting to MSMDPUMP, but the credentials will not be delegated to Analysis Services.</span></span> <span data-ttu-id="1951b-275">您必須在連接時傳遞有效的使用者名稱和密碼，如本文件的步驟 6 所述。</span><span class="sxs-lookup"><span data-stu-id="1951b-275">Instead, you will need to pass a valid user name and password on a connection, as described in Step 6 in this document.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="1951b-276">請注意，建立傳送密碼之目標系統的任何人都必須有數種方式來保護通訊通道的安全。</span><span class="sxs-lookup"><span data-stu-id="1951b-276">Please note that it is imperative for anyone building a system where the password is transmitted to have ways of securing the communication channel.</span></span> <span data-ttu-id="1951b-277">IIS 提供一組可協助您保護通道安全的工具。</span><span class="sxs-lookup"><span data-stu-id="1951b-277">IIS provides a set of tools that help you secure the channel.</span></span> <span data-ttu-id="1951b-278">如需詳細資訊，請參閱[如何在 IIS 7 上設定 SSL](https://go.microsoft.com/fwlink/?LinkId=207562)。</span><span class="sxs-lookup"><span data-stu-id="1951b-278">For more information, see [How to Set Up SSL on IIS 7](https://go.microsoft.com/fwlink/?LinkId=207562).</span></span>  
  
5.  <span data-ttu-id="1951b-279">如果您使用 Windows 或基本驗證，請停用 [匿名驗證]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="1951b-279">Disable **Anonymous Authentication** if you are using Windows or Basic authentication.</span></span> <span data-ttu-id="1951b-280">啟用匿名驗證時，IIS 將一律優先使用它，即使已啟用其他驗證方法也一樣。</span><span class="sxs-lookup"><span data-stu-id="1951b-280">When Anonymous authentication is enabled, IIS will always use it first, even if other authentication methods are enabled.</span></span>  
  
     <span data-ttu-id="1951b-281">在匿名驗證下，幫浦 (msmdpump.dll) 會以您為匿名使用者建立的使用者帳戶執行。</span><span class="sxs-lookup"><span data-stu-id="1951b-281">Under Anonymous authentication, the pump (msmdpump.dll) runs as the user account you established for anonymous user.</span></span> <span data-ttu-id="1951b-282">連接至 IIS 的使用者以及連接至 Analysis Services 的使用者之間並沒有差別。</span><span class="sxs-lookup"><span data-stu-id="1951b-282">There is no distinction between the user connecting to IIS and the user connecting to Analysis Services.</span></span> <span data-ttu-id="1951b-283">根據預設，IIS 會使用 IUSR 帳戶，不過，您可以將它變更為具有網路權限的網域使用者帳戶。</span><span class="sxs-lookup"><span data-stu-id="1951b-283">By default, IIS uses the IUSR account, but you can change it to a domain user account that has network permissions.</span></span> <span data-ttu-id="1951b-284">如果 IIS 和 Analysis Services 位於不同的電腦上，您將需要這項功能。</span><span class="sxs-lookup"><span data-stu-id="1951b-284">You'll need this capability if IIS and Analysis Services are on different computers.</span></span>  
  
     <span data-ttu-id="1951b-285">如需有關如何設定匿名驗證之認證的指示，請參閱 [匿名驗證](http://www.iis.net/configreference/system.webserver/security/authentication/anonymousauthentication)。</span><span class="sxs-lookup"><span data-stu-id="1951b-285">For instructions on how to configure credentials for Anonymous authentication, see [Anonymous Authentication](http://www.iis.net/configreference/system.webserver/security/authentication/anonymousauthentication).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="1951b-286">匿名驗證最可能在受到高度控制的環境中使用，這類環境是依據檔案系統中的存取控制清單給予或拒絕使用者的存取權。</span><span class="sxs-lookup"><span data-stu-id="1951b-286">Anonymous authentication is most likely found in an extremely controlled environment, where users are given or denied access by way of access control lists in the file system.</span></span> <span data-ttu-id="1951b-287">如需最佳做法，請參閱 [啟用匿名驗證 (IIS 7)](https://technet.microsoft.com/library/cc731244\(v=ws.10\).aspx)。</span><span class="sxs-lookup"><span data-stu-id="1951b-287">For best practices, see [Enable Anonymous Authentication (IIS 7)](https://technet.microsoft.com/library/cc731244\(v=ws.10\).aspx).</span></span>  
  
6.  <span data-ttu-id="1951b-288">按一下 [OLAP]\*\*\*\* 虛擬目錄來開啟主頁面。</span><span class="sxs-lookup"><span data-stu-id="1951b-288">Click the **OLAP** virtual directory to open the main page.</span></span> <span data-ttu-id="1951b-289">按兩下 [處理常式對應]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="1951b-289">Double-click **Handler Mappings**.</span></span>  
  
     <span data-ttu-id="1951b-290">![功能頁面中的處理常式對應圖示](../media/ssas-httpaccess-handlermapping.png "功能頁面中的處理常式對應圖示")</span><span class="sxs-lookup"><span data-stu-id="1951b-290">![Handler mapping icon in feature page](../media/ssas-httpaccess-handlermapping.png "Handler mapping icon in feature page")</span></span>  
  
7.  <span data-ttu-id="1951b-291">以滑鼠右鍵按一下頁面的任何位置，然後選取 [新增指令碼對應]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="1951b-291">Right-click anywhere on the page and then select **Add Script Map**.</span></span> <span data-ttu-id="1951b-292">在 [加入腳本對應] 對話方塊中，指定 [ \*\* \* .dll\*\* ] 做為 [要求路徑]、指定 c:\inetpub\wwwroot\OLAP\msmdpump.dll 做為可執行檔，並輸入**OLAP**做為名稱。</span><span class="sxs-lookup"><span data-stu-id="1951b-292">In the Add Script Map dialog box, specify **\*.dll** as the request path, specify c:\inetpub\wwwroot\OLAP\msmdpump.dll as the executable, and type **OLAP** as the name.</span></span> <span data-ttu-id="1951b-293">讓所有預設限制與這個指令碼對應保持關聯。</span><span class="sxs-lookup"><span data-stu-id="1951b-293">Keep all of the default restrictions associated with this script map.</span></span>  
  
     <span data-ttu-id="1951b-294">![新增指令碼對應對話方塊的螢幕擷取畫面](../media/ssas-httpaccess-addscript.png "新增指令碼對應對話方塊的螢幕擷取畫面")</span><span class="sxs-lookup"><span data-stu-id="1951b-294">![Screenshot of Add Script Map dialog box](../media/ssas-httpaccess-addscript.png "Screenshot of Add Script Map dialog box")</span></span>  
  
8.  <span data-ttu-id="1951b-295">當畫面上出現允許 ISAPI 擴充程式的提示時，請按一下 [是]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="1951b-295">When prompted to allow the ISAPI extension, click **Yes**.</span></span>  
  
     <span data-ttu-id="1951b-296">![確認新增 ISAPI 擴充程式的螢幕擷取畫面](../media/ssas-httpaccess-isapiprompt.png "確認新增 ISAPI 擴充程式的螢幕擷取畫面")</span><span class="sxs-lookup"><span data-stu-id="1951b-296">![Screenshot of confirmation to add ISAPI extension](../media/ssas-httpaccess-isapiprompt.png "Screenshot of confirmation to add ISAPI extension")</span></span>  
  
##  <a name="step-4-edit-the-msmdpumpini-file-to-set-the-target-server"></a><a name="bkmk_edit"></a> <span data-ttu-id="1951b-297">步驟 4：編輯 MSMDPUMP.INI 檔案來設定目標伺服器</span><span class="sxs-lookup"><span data-stu-id="1951b-297">Step 4: Edit the MSMDPUMP.INI file to set the target server</span></span>  
 <span data-ttu-id="1951b-298">MSMDPUMP.INI 檔案會指定 MSMDPUMP.DLL 連接的 Analysis Services 執行個體。</span><span class="sxs-lookup"><span data-stu-id="1951b-298">The MSMDPUMP.INI file specifies the Analysis Services instance that MSMDPUMP.DLL connects to.</span></span> <span data-ttu-id="1951b-299">這個執行個體可以位於本機或遠端，以及安裝為預設或具名執行個體。</span><span class="sxs-lookup"><span data-stu-id="1951b-299">This instance can be local or remote, installed as the default or as a named instance.</span></span>  
  
 <span data-ttu-id="1951b-300">開啟 C:\inetpub\wwwroot\OLAP 資料夾中的 msmdpump.ini 檔，然後查看此檔案的內容。</span><span class="sxs-lookup"><span data-stu-id="1951b-300">Open the msmdpump.ini file located in folder C:\inetpub\wwwroot\OLAP and take a look at the contents of this file.</span></span> <span data-ttu-id="1951b-301">這看起來像下面這樣：</span><span class="sxs-lookup"><span data-stu-id="1951b-301">It should look like the following:</span></span>  
  
```  
<ConfigurationSettings>  
<ServerName>localhost</ServerName>  
<SessionTimeout>3600</SessionTimeout>  
<ConnectionPoolSize>100</ConnectionPoolSize>  
</ConfigurationSettings>  
  
```  
  
 <span data-ttu-id="1951b-302">如果您要為其設定 HTTP 存取的 Analysis Services 執行個體位於本機電腦，而且當做預設執行個體安裝，則不需要變更此設定。</span><span class="sxs-lookup"><span data-stu-id="1951b-302">If the Analysis Services instance for which you are configuring HTTP access is located on the local computer and installed as a default instance, there is no reason to change this setting.</span></span> <span data-ttu-id="1951b-303">否則，您必須指定伺服器名稱 (例如 \<ServerName> ADWRKS-SRV01 \</ServerName>) 。</span><span class="sxs-lookup"><span data-stu-id="1951b-303">Otherwise, you must specify the server name (for example, \<ServerName>ADWRKS-SRV01\</ServerName>).</span></span> <span data-ttu-id="1951b-304">若為安裝為已命名實例的伺服器，請務必將實例名稱附加 (例如 \<ServerName> ADWRKS-SRV01\Tabular \</ServerName>) 。</span><span class="sxs-lookup"><span data-stu-id="1951b-304">For a server that is installed as a named instance, be sure to append the instance name (for example, \<ServerName>ADWRKS-SRV01\Tabular\</ServerName>).</span></span>  
  
 <span data-ttu-id="1951b-305">根據預設，Analysis Services 會接聽 TCP/IP 通訊埠 2383。</span><span class="sxs-lookup"><span data-stu-id="1951b-305">By default, Analysis Services listens on TCP/IP port 2383.</span></span> <span data-ttu-id="1951b-306">如果您將 Analysis Services 安裝為預設實例，則不需要指定中的任何埠， \<ServerName> 因為 Analysis Services 知道如何自動接聽通訊埠2383。</span><span class="sxs-lookup"><span data-stu-id="1951b-306">If you installed Analysis Services as the default instance, you do not need to specify any port in \<ServerName> because Analysis Services knows how to listen on port 2383 automatically.</span></span> <span data-ttu-id="1951b-307">不過，您需要在 Windows 防火牆中，允許該通訊埠的傳入連接。</span><span class="sxs-lookup"><span data-stu-id="1951b-307">However, you do need to allow inbound connections to that port in Windows Firewall.</span></span> <span data-ttu-id="1951b-308">如需詳細資訊，請參閱 [Configure the Windows Firewall to Allow Analysis Services Access](configure-the-windows-firewall-to-allow-analysis-services-access.md)。</span><span class="sxs-lookup"><span data-stu-id="1951b-308">For more information, see [Configure the Windows Firewall to Allow Analysis Services Access](configure-the-windows-firewall-to-allow-analysis-services-access.md).</span></span>  
  
 <span data-ttu-id="1951b-309">如果您將 Analysis Services 的已命名或預設實例設定為接聽固定通訊埠，就必須將埠號碼新增至伺服器名稱 (例如， \<ServerName> SRV01： 55555 \</ServerName>) ，而且您必須在 Windows 防火牆中允許該埠的輸入連線。</span><span class="sxs-lookup"><span data-stu-id="1951b-309">If you configured a named or default instance of Analysis Services to listen on a fixed port, you must add the port number to the server name (for example, \<ServerName>AW-SRV01:55555\</ServerName>) and you must allow inbound connections in Windows Firewall to that port.</span></span>  
  
## <a name="step-5-grant-data-access-permissions"></a><span data-ttu-id="1951b-310">步驟 5：授與資料存取權限</span><span class="sxs-lookup"><span data-stu-id="1951b-310">Step 5: Grant data access permissions</span></span>  
 <span data-ttu-id="1951b-311">如前面所述，您需要授與 Analysis Services 執行個體的權限。</span><span class="sxs-lookup"><span data-stu-id="1951b-311">As previously noted, you will need to grant permissions on the Analysis Services instance.</span></span> <span data-ttu-id="1951b-312">每個資料庫物件都有提供特定層級權限的角色 (讀取或讀取/寫入)，因此，每個角色都會有由 Windows 使用者識別所組成的成員。</span><span class="sxs-lookup"><span data-stu-id="1951b-312">Each database object will have roles that provide a given level of permissions (read or read/write), and each role will have members consisting of Windows user identities.</span></span>  
  
 <span data-ttu-id="1951b-313">若要設定權限，您可以使用 SQL Server Management Studio。</span><span class="sxs-lookup"><span data-stu-id="1951b-313">To set permissions, you can use SQL Server Management Studio.</span></span> <span data-ttu-id="1951b-314">在 [**資料庫**  |  **角色**] 資料夾底下，您可以建立角色、指定資料庫許可權、指派成員資格給 Windows 使用者或群組帳戶，然後授與特定物件的讀取或寫入權限。</span><span class="sxs-lookup"><span data-stu-id="1951b-314">Under the **Database** | **Roles** folder, you can create roles, specify database permissions, assign membership to Windows user or group accounts, and then grant read or write permissions on specific objects.</span></span> <span data-ttu-id="1951b-315">一般而言，Cube 的 [讀取]\*\*\*\* 權限對於使用 (但不會更新) 模型資料的用戶端連接而言就已足夠。</span><span class="sxs-lookup"><span data-stu-id="1951b-315">Typically, **Read** permissions on a cube are sufficient for client connections that use, but do not update, model data.</span></span>  
  
 <span data-ttu-id="1951b-316">角色指派會根據您設定的驗證而有所不同。</span><span class="sxs-lookup"><span data-stu-id="1951b-316">Role assignment varies depending on how you configured authentication.</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="1951b-317">匿名</span><span class="sxs-lookup"><span data-stu-id="1951b-317">Anonymous</span></span>|<span data-ttu-id="1951b-318">將 IIS 的 [編輯匿名驗證認證]\*\*\*\* 中指定的帳戶加入至 [成員資格] 清單。</span><span class="sxs-lookup"><span data-stu-id="1951b-318">Add to the Membership list the account specified in **Edit Anonymous Authentication Credentials** in IIS.</span></span> <span data-ttu-id="1951b-319">如需詳細資訊，請參閱 [匿名驗證](http://www.iis.net/configreference/system.webserver/security/authentication/anonymousauthentication)，</span><span class="sxs-lookup"><span data-stu-id="1951b-319">For more information, see [Anonymous Authentication](http://www.iis.net/configreference/system.webserver/security/authentication/anonymousauthentication),</span></span>|  
|<span data-ttu-id="1951b-320">Windows 驗證</span><span class="sxs-lookup"><span data-stu-id="1951b-320">Windows authentication</span></span>|<span data-ttu-id="1951b-321">將透過模擬或委派要求 Analysis Services 資料的 Windows 使用者或群組帳戶加入至 [成員資格] 清單。</span><span class="sxs-lookup"><span data-stu-id="1951b-321">Add to the Membership list the Windows user or group accounts requesting Analysis Services data via impersonation or delegation.</span></span><br /><br /> <span data-ttu-id="1951b-322">假使您使用 Kerberos 限制委派，則只有要求存取的 Windows 使用者和群組帳戶需要權限。</span><span class="sxs-lookup"><span data-stu-id="1951b-322">Assuming Kerberos constrained delegation is used, the only accounts that need permissions are the Windows user and group accounts requesting access.</span></span> <span data-ttu-id="1951b-323">應用程式集區識別不需要權限。</span><span class="sxs-lookup"><span data-stu-id="1951b-323">No permissions are necessary for the application pool identity.</span></span>|  
|<span data-ttu-id="1951b-324">基本驗證</span><span class="sxs-lookup"><span data-stu-id="1951b-324">Basic authentication</span></span>|<span data-ttu-id="1951b-325">將要在連接字串中傳遞的 Windows 使用者或群組帳戶加入至 [成員資格] 清單。</span><span class="sxs-lookup"><span data-stu-id="1951b-325">Add to the Membership list the Windows user or group accounts that will be passed on the connection string.</span></span><br /><br /> <span data-ttu-id="1951b-326">此外，如果您要透過連接字串上的 `EffectiveUserName` 傳遞認證，則應用程式集區識別必須具有 Analysis Services 執行個體的系統管理員權限。</span><span class="sxs-lookup"><span data-stu-id="1951b-326">In addition, if you are passing credentials via `EffectiveUserName` on the connection string, then the application pool identity must have administrator rights on the Analysis Services instance.</span></span> <span data-ttu-id="1951b-327">在 SSMS 中，以滑鼠右鍵按一下實例 &#124;**屬性**] &#124; [**安全性**] &#124; [**新增**]。</span><span class="sxs-lookup"><span data-stu-id="1951b-327">In SSMS, right-click the instance &#124; **Properties** &#124; **Security** &#124; **Add**.</span></span> <span data-ttu-id="1951b-328">輸入應用程式集區識別。</span><span class="sxs-lookup"><span data-stu-id="1951b-328">Enter the application pool identity.</span></span> <span data-ttu-id="1951b-329">如果您使用內建的預設身分識別，則會將帳戶指定為**IIS AppPool\DefaultAppPool**。</span><span class="sxs-lookup"><span data-stu-id="1951b-329">If you used the built-in default identity, the account is specified as **IIS AppPool\DefaultAppPool**.</span></span><br /><br /> ![](../media/ssas-httpaccess-iisapppoolidentity.png)|  
  
 <span data-ttu-id="1951b-330">如需關於設定權限的詳細資訊，請參閱 [物件和作業的存取權授權 &#40;Analysis Services&#41;](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md)(英文)。</span><span class="sxs-lookup"><span data-stu-id="1951b-330">For more information about setting permissions, see [Authorizing access to objects and operations &#40;Analysis Services&#41;](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md).</span></span>  
  
##  <a name="step-6-test-your-configuration"></a><a name="bkmk_test"></a> <span data-ttu-id="1951b-331">步驟 6：測試您的設定</span><span class="sxs-lookup"><span data-stu-id="1951b-331">Step 6: Test your configuration</span></span>  
 <span data-ttu-id="1951b-332">MSMDPUMP 的連接字串語法為 MSMDPUMP.dll 檔案的 URL。</span><span class="sxs-lookup"><span data-stu-id="1951b-332">The connection string syntax for MSMDPUMP is the URL to the MSMDPUMP.dll file.</span></span>  
  
 <span data-ttu-id="1951b-333">如果 web 應用程式是在固定通訊埠上接聽，請將埠號碼附加至伺服器名稱或 IP 位址，例如 `http://my-web-srv01:8080/OLAP/msmdpump.dll` 或 `http://123.456.789.012:8080/OLAP/msmdpump.dll` 。</span><span class="sxs-lookup"><span data-stu-id="1951b-333">If the web application is listening on a fixed port, append the port number to the server name or IP address, for example, `http://my-web-srv01:8080/OLAP/msmdpump.dll` or `http://123.456.789.012:8080/OLAP/msmdpump.dll`.</span></span>  
  
 <span data-ttu-id="1951b-334">若要快速測試連接，您可以使用 Microsoft Excel 或 SQL Server Management Studio 開啟連接。</span><span class="sxs-lookup"><span data-stu-id="1951b-334">To quickly test the connection, you can open a connection using Microsoft Excel or SQL Server Management Studio</span></span>  
  
 <span data-ttu-id="1951b-335">**使用 SQL Server Management Studio 測試連接**</span><span class="sxs-lookup"><span data-stu-id="1951b-335">**Test connections using SQL Server Management Studio**</span></span>  
  
1.  <span data-ttu-id="1951b-336">在 Management Studio 的 [連接到伺服器] 對話方塊中，選取 [Analysis Services]\*\*\*\* 做為伺服器類型。</span><span class="sxs-lookup"><span data-stu-id="1951b-336">In Management Studio, in the Connect to Server dialog box, select **Analysis Services** as the server type.</span></span> <span data-ttu-id="1951b-337">在 [伺服器名稱] 中，輸入 msmdpump 延伸模組的 HTTP 位址： `http://my-web-srv01/OLAP/msmdpump.dll`。</span><span class="sxs-lookup"><span data-stu-id="1951b-337">In Server name, enter the HTTP address of the msmdpump extension: `http://my-web-srv01/OLAP/msmdpump.dll`.</span></span>  
  
     <span data-ttu-id="1951b-338">[物件總管] 會顯示 HTTP 連接：</span><span class="sxs-lookup"><span data-stu-id="1951b-338">Object Explorer displays the HTTP connection:</span></span>  
  
     <span data-ttu-id="1951b-339">![顯示 http 連接到 SSAS 的物件總管](../media/ssas-httpaccess-ssms.PNG "顯示 http 連接到 SSAS 的物件總管")</span><span class="sxs-lookup"><span data-stu-id="1951b-339">![Object Explorer showing http connection to SSAS](../media/ssas-httpaccess-ssms.PNG "Object Explorer showing http connection to SSAS")</span></span>  
  
2.  <span data-ttu-id="1951b-340">驗證必須是 Windows 驗證，而且使用 Management Studio 的使用者必須是 Analysis Services 系統管理員。</span><span class="sxs-lookup"><span data-stu-id="1951b-340">Authentication must be Windows authentication, and the person using Management Studio must be an Analysis Services administrator.</span></span> <span data-ttu-id="1951b-341">系統管理員可以授與更多權限來啟用其他使用者的存取。</span><span class="sxs-lookup"><span data-stu-id="1951b-341">An administrator can grant further permissions to enable access by other users.</span></span>  
  
 <span data-ttu-id="1951b-342">**使用 Excel 測試連接**</span><span class="sxs-lookup"><span data-stu-id="1951b-342">**Test connections using Excel**</span></span>  
  
1.  <span data-ttu-id="1951b-343">在 Excel 的 [資料] 索引標籤上的 [取得外部資料] 中，按一下 [從其他來源]\*\*\*\*，然後選擇 [從 Analysis Services]\*\*\*\* 以啟動 [資料連線精靈]。</span><span class="sxs-lookup"><span data-stu-id="1951b-343">On the Data tab in Excel, in Get External Data, click **From Other Sources**, and then choose **From Analysis Services** to start the Data Connection wizard.</span></span>  
  
2.  <span data-ttu-id="1951b-344">在 [伺服器名稱] 中，輸入 msmdpump 延伸模組的 HTTP 位址： `http://my-web-srv01/OLAP/msmdpump.dll`。</span><span class="sxs-lookup"><span data-stu-id="1951b-344">In Server name, enter the HTTP address of the msmdpump extension: `http://my-web-srv01/OLAP/msmdpump.dll`.</span></span>  
  
3.  <span data-ttu-id="1951b-345">針對 [登入認證]，如果您使用 Windows 整合式安全性或 NTLM 或是匿名使用者，則選擇 [使用 Windows 驗證]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="1951b-345">For Log on credentials, choose **Use Windows Authentication** if you are using Windows integrated security or NTLM, or Anonymous user.</span></span>  
  
     <span data-ttu-id="1951b-346">針對基本驗證，請選擇 [使用下列的使用者名稱和密碼]\*\*\*\*，然後指定用來登入的認證。</span><span class="sxs-lookup"><span data-stu-id="1951b-346">For Basic authentication, choose **Use the following User Name and Password**, and then specify the credentials used to sign on.</span></span> <span data-ttu-id="1951b-347">您提供的認證將在連接字串中傳遞至 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="1951b-347">The credentials you provide will be passed on the connection string to Analysis Services.</span></span>  
  
 <span data-ttu-id="1951b-348">**使用 AMO 測試連接**</span><span class="sxs-lookup"><span data-stu-id="1951b-348">**Test connections using AMO**</span></span>  
  
 <span data-ttu-id="1951b-349">您可以使用 AMO 透過程式設計的方式測試 HTTP 存取，替代端點的 URL 做為伺服器名稱。</span><span class="sxs-lookup"><span data-stu-id="1951b-349">You can test HTTP access programmatically using AMO, substituting the URL of the endpoint for the server name.</span></span> <span data-ttu-id="1951b-350">如需詳細資訊，請參閱 [論壇文章 (如何透過 HTTPS 跨網域/樹系和防火牆界限同步處理 SSAS 2008 R2 資料庫)](https://social.msdn.microsoft.com/Forums/en/sqlanalysisservices/thread/c4249d55-914d-4c81-9980-44d0b8df9c3e)。</span><span class="sxs-lookup"><span data-stu-id="1951b-350">For details, see [Forum Post (How to sync SSAS 2008 R2 databases via HTTPS across domain/forest and firewall boundaries)](https://social.msdn.microsoft.com/Forums/en/sqlanalysisservices/thread/c4249d55-914d-4c81-9980-44d0b8df9c3e).</span></span>  
  
 <span data-ttu-id="1951b-351">範例連接字串，說明使用基本驗證的 HTTP(S) 存取語法：</span><span class="sxs-lookup"><span data-stu-id="1951b-351">An example connection string illustrating the syntax for HTTP(S) access using Basic authentication:</span></span>  
  
 `Data Source=https://<servername>/olap/msmdpump.dll; Initial Catalog=AdventureWorksDW2012; Integrated Security=Basic; User ID=XXXX; Password=XXXXX;`  
  
 <span data-ttu-id="1951b-352">如需關於以程式設計方式設定連接的詳細資訊，請參閱 [在 ADOMD.NET 中建立安全連接](https://docs.microsoft.com/analysis-services/adomd/multidimensional-models-adomd-net-client/connections-in-adomd-net-establishing-secure-connections)。</span><span class="sxs-lookup"><span data-stu-id="1951b-352">For more information about setting up the connection programmatically, see [Establishing Secure Connections in ADOMD.NET](https://docs.microsoft.com/analysis-services/adomd/multidimensional-models-adomd-net-client/connections-in-adomd-net-establishing-secure-connections).</span></span>  
  
 <span data-ttu-id="1951b-353">最後一個步驟是確實使用更嚴格的測試進行後續追蹤，方法是，使用在連接來源之網路環境中執行的用戶端電腦。</span><span class="sxs-lookup"><span data-stu-id="1951b-353">As a final step, be sure to follow-up with more rigorous testing by using a client computer that runs in the network environment from which the connections will originate.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1951b-354">另請參閱</span><span class="sxs-lookup"><span data-stu-id="1951b-354">See Also</span></span>  
 <span data-ttu-id="1951b-355">[論壇文章 (使用 msmdpump 和基本驗證的 HTTP 存取) ](https://social.msdn.microsoft.com/Forums/en/sqlanalysisservices/thread/79d2f225-df35-46da-aa22-d06e98f7d658) </span><span class="sxs-lookup"><span data-stu-id="1951b-355">[Forum post (http access using msmdpump and basic authentication)](https://social.msdn.microsoft.com/Forums/en/sqlanalysisservices/thread/79d2f225-df35-46da-aa22-d06e98f7d658) </span></span>  
 <span data-ttu-id="1951b-356">[設定 Windows 防火牆以允許 Analysis Services 存取](configure-the-windows-firewall-to-allow-analysis-services-access.md) </span><span class="sxs-lookup"><span data-stu-id="1951b-356">[Configure the Windows Firewall to Allow Analysis Services Access](configure-the-windows-firewall-to-allow-analysis-services-access.md) </span></span>  
 <span data-ttu-id="1951b-357">[&#40;Analysis Services&#41;授權物件和作業的存取權](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="1951b-357">[Authorizing access to objects and operations &#40;Analysis Services&#41;](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md) </span></span>  
 <span data-ttu-id="1951b-358">[IIS 驗證方法](https://go.microsoft.com/fwlink/?LinkdID=208461) </span><span class="sxs-lookup"><span data-stu-id="1951b-358">[IIS Authentication Methods](https://go.microsoft.com/fwlink/?LinkdID=208461) </span></span>  
 [<span data-ttu-id="1951b-359">如何在 IIS 7 上設定 SSL</span><span class="sxs-lookup"><span data-stu-id="1951b-359">How to Set Up SSL on IIS 7</span></span>](https://go.microsoft.com/fwlink/?LinkId=207562)  
  
