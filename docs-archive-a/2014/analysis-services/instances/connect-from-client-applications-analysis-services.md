---
title: 從用戶端應用程式連接 (Analysis Services) |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: b1e0f1d4-0b87-4ad3-8172-f746fe2f16a2
author: minewiskan
ms.author: owend
ms.openlocfilehash: cb93d3a44345d750070a3dda60f82693fd61500b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87698851"
---
# <a name="connect-from-client-applications-analysis-services"></a><span data-ttu-id="f2c17-102">從用戶端應用程式連接 (Analysis Services)</span><span class="sxs-lookup"><span data-stu-id="f2c17-102">Connect from client applications (Analysis Services)</span></span>
  <span data-ttu-id="f2c17-103">如果您不熟悉 Analysis Services，請透過本主題中的資訊，使用常用的工具和應用程式連接至 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 現有的執行個體。</span><span class="sxs-lookup"><span data-stu-id="f2c17-103">If you are new to Analysis Services, use the information in this topic to connect to an existing instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] using common tools and applications.</span></span> <span data-ttu-id="f2c17-104">本主題也說明如何以不同的使用者識別進行連接，方便測試之用。</span><span class="sxs-lookup"><span data-stu-id="f2c17-104">This topic also explains how to connect under different user identities for testing purposes.</span></span>  
  
-   [<span data-ttu-id="f2c17-105">使用 SQL Server Management Studio (SSMS 來連接) </span><span class="sxs-lookup"><span data-stu-id="f2c17-105">Connect using SQL Server Management Studio (SSMS)</span></span>](#bkmk_SSMS)  
  
-   [<span data-ttu-id="f2c17-106">使用 Excel 連接</span><span class="sxs-lookup"><span data-stu-id="f2c17-106">Connect using Excel</span></span>](#bkmk_excel)  
  
-   [<span data-ttu-id="f2c17-107">使用 SQL Server Data Tools 連接</span><span class="sxs-lookup"><span data-stu-id="f2c17-107">Connect using SQL Server Data Tools</span></span>](#bkmk_SSDT)  
  
-   [<span data-ttu-id="f2c17-108">測試連接</span><span class="sxs-lookup"><span data-stu-id="f2c17-108">Test connections</span></span>](#bkmk_tshoot)  
  
 <span data-ttu-id="f2c17-109">連接字串參考文件為另外提供。</span><span class="sxs-lookup"><span data-stu-id="f2c17-109">Connection string reference documentation is provided separately.</span></span> <span data-ttu-id="f2c17-110">如需詳細資訊，請參閱[連接字串屬性 &#40;Analysis Services&#41;](connection-string-properties-analysis-services.md)。</span><span class="sxs-lookup"><span data-stu-id="f2c17-110">For more information, see [Connection String Properties &#40;Analysis Services&#41;](connection-string-properties-analysis-services.md).</span></span>  
  
 <span data-ttu-id="f2c17-111">成功的連接取決於有效的通訊埠組態和適當的使用者權限。</span><span class="sxs-lookup"><span data-stu-id="f2c17-111">Successful connections depend on a valid port configuration and appropriate user permissions.</span></span> <span data-ttu-id="f2c17-112">請按一下下列連結，深入了解每一個需求。</span><span class="sxs-lookup"><span data-stu-id="f2c17-112">Click the following links to learn more about each requirement.</span></span>  
  
-   [<span data-ttu-id="f2c17-113">設定 Windows 防火牆以允許 Analysis Services 存取</span><span class="sxs-lookup"><span data-stu-id="f2c17-113">Configure the Windows Firewall to Allow Analysis Services Access</span></span>](configure-the-windows-firewall-to-allow-analysis-services-access.md)  
  
-   [<span data-ttu-id="f2c17-114">物件和作業的存取權授權 &#40;Analysis Services&#41;</span><span class="sxs-lookup"><span data-stu-id="f2c17-114">Authorizing access to objects and operations &#40;Analysis Services&#41;</span></span>](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md)  
  
##  <a name="connect-using-sql-server-management-studio-ssms"></a><a name="bkmk_SSMS"></a> <span data-ttu-id="f2c17-115">使用 SQL Server Management Studio (SSMS) 連接</span><span class="sxs-lookup"><span data-stu-id="f2c17-115">Connect using SQL Server Management Studio (SSMS)</span></span>  
 <span data-ttu-id="f2c17-116">您可以使用 SSMS 連接至 Analysis Services，以互動方式管理伺服器執行個體和資料庫。</span><span class="sxs-lookup"><span data-stu-id="f2c17-116">Connect to Analysis Services in SSMS to manage server instances and databases interactively.</span></span> <span data-ttu-id="f2c17-117">您也可以執行 XMLA 或 MDX 查詢，以執行管理工作或擷取資料。</span><span class="sxs-lookup"><span data-stu-id="f2c17-117">You can also run XMLA or MDX queries to perform administrative tasks or retrieve data.</span></span> <span data-ttu-id="f2c17-118">相較於在傳送查詢時只會載入資料庫的其他工具和應用程式，SSMS 會在您連接到伺服器時載入所有資料庫，前提是您有權檢視資料庫。</span><span class="sxs-lookup"><span data-stu-id="f2c17-118">In contrast with other tools and applications that only load databases when a query is sent, SSMS loads all databases when you connect to the server, assuming you have permission to view the database.</span></span> <span data-ttu-id="f2c17-119">這表示，如果您在伺服器上擁有許多表格式資料庫，當您使用 SSMS 連接時，所有資料庫都會載入系統記憶體中。</span><span class="sxs-lookup"><span data-stu-id="f2c17-119">This means that if you have numerous tabular databases on the server, all are loaded into system memory when you connect using SSMS.</span></span>  
  
 <span data-ttu-id="f2c17-120">您可以使用特定使用者識別來執行 SSMS，然後以該使用者的身分連接至 Analysis Services 來測試權限。</span><span class="sxs-lookup"><span data-stu-id="f2c17-120">You can test permissions by running SSMS under a specific user identity and then connect to Analysis Services as that user.</span></span>  
  
 <span data-ttu-id="f2c17-121">按住 Shift 鍵並以滑鼠右鍵按一下 [SQL Server Management Studio]\*\*\*\* 捷徑，即可存取 [以不同的使用者身分執行]\*\*\*\* 選項。</span><span class="sxs-lookup"><span data-stu-id="f2c17-121">Hold-down the Shift key and right-click the **SQL Server Management Studio** shortcut to access the **Run as different user** option.</span></span>  
  
1.  <span data-ttu-id="f2c17-122">啟動 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="f2c17-122">Start [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="f2c17-123">在 [連接到伺服器]\*\*\*\* 對話方塊中，選取 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 伺服器類型。</span><span class="sxs-lookup"><span data-stu-id="f2c17-123">In the **Connect to Server** dialog box, select the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server type.</span></span>  
  
2.  <span data-ttu-id="f2c17-124">在 [登入] 索引標籤中，輸入伺服器執行所在的電腦名稱來輸入伺服器名稱。</span><span class="sxs-lookup"><span data-stu-id="f2c17-124">In the Login tab, enter the server name by typing the name of the computer on which the server is running.</span></span> <span data-ttu-id="f2c17-125">您可以使用其網路名稱或完整網域名稱來指定伺服器。</span><span class="sxs-lookup"><span data-stu-id="f2c17-125">You can specify the server using its network name or a fully-qualified domain name.</span></span>  
  
     <span data-ttu-id="f2c17-126">如果是具名執行個體，必須使用下列格式指定伺服器名稱：伺服器名稱\執行個體名稱。</span><span class="sxs-lookup"><span data-stu-id="f2c17-126">For a named instance, the server name must be specified in this format: servername\instance name.</span></span> <span data-ttu-id="f2c17-127">這個命名慣例的可能範例如下：ADV-SRV062\Finance 代表網路名稱為 ADV-SRV062 的伺服器，其中 Analysis Services 已安裝為標題為 Finance 的具名執行個體。</span><span class="sxs-lookup"><span data-stu-id="f2c17-127">An example of this naming convention might be ADV-SRV062\Finance for a server that has a network name of ADV-SRV062, where Analysis Services was installed as a named instance entitled Finance.</span></span>  
  
     <span data-ttu-id="f2c17-128">如果是部署在容錯移轉叢集中的伺服器，請使用 SSAS 叢集的網路名稱連接。</span><span class="sxs-lookup"><span data-stu-id="f2c17-128">For servers deployed in a failover cluster, connect using the network name of the SSAS cluster.</span></span> <span data-ttu-id="f2c17-129">SQL Server 安裝期間會將這個名稱指定為 [SQL Server 網路名稱]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="f2c17-129">This name is specified during SQL Server setup, as **SQL Server Network Name**.</span></span> <span data-ttu-id="f2c17-130">請注意，如果您在 Windows Server 容錯移轉叢集 (WSFC) 上安裝 SSAS 當做具名執行個體，絕對不要在連接上加入此執行個體名稱。</span><span class="sxs-lookup"><span data-stu-id="f2c17-130">Note that if you installed SSAS as a named instance onto a Windows Server Failover Cluster (WSFC), you never add the instance name on the connection.</span></span> <span data-ttu-id="f2c17-131">這對 SSAS 而言是唯一的作法；相反地，叢集關聯式資料庫引擎的具名執行個體有包含此執行個體名稱。</span><span class="sxs-lookup"><span data-stu-id="f2c17-131">This practice is unique to SSAS; in contrast, a named instance of a clustered relational database engine does include the instance name.</span></span> <span data-ttu-id="f2c17-132">例如，如果您使用 SQL Server 網路名稱 SQL-CLU 安裝 SSAS 和資料庫引擎當做具名執行個體 (Contoso-Accounting)，您會使用 "SQL-CLU" 連接到 SSAS 並且以 "SQL-CLU\Contoso-Accounting" 身分連接到資料庫引擎。</span><span class="sxs-lookup"><span data-stu-id="f2c17-132">For example, if you installed both SSAS and the database engine as named instance (Contoso-Accounting) with a SQL Server Network Name of SQL-CLU, you would connect to SSAS using "SQL-CLU" and to the database engine as "SQL-CLU\Contoso-Accounting".</span></span> <span data-ttu-id="f2c17-133">如需詳細資訊和範例，請參閱 [How to Cluster SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548) (如何將 SQL Server Analysis Services 叢集化)。</span><span class="sxs-lookup"><span data-stu-id="f2c17-133">See [How to Cluster SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548) for more information and examples.</span></span>  
  
     <span data-ttu-id="f2c17-134">如果是部署在網路負載平衡叢集中的伺服器，則使用 NLB 的虛擬伺服器名稱連接。</span><span class="sxs-lookup"><span data-stu-id="f2c17-134">For servers deployed in a network load balanced cluster, connect using the virtual server name of the NLB.</span></span>  
  
3.  <span data-ttu-id="f2c17-135">驗證一定會是 Windows 驗證，而且使用者識別一定會是透過 Management Studio 連接的 Windows 使用者。</span><span class="sxs-lookup"><span data-stu-id="f2c17-135">Authentication is always Windows authentication, and the user identity is always the Windows user who is connecting via Management Studio.</span></span>  
  
     <span data-ttu-id="f2c17-136">為了要讓連接成功，您必須擁有存取伺服器或伺服器上之資料庫的權限。</span><span class="sxs-lookup"><span data-stu-id="f2c17-136">In order for the connection to succeed, you must have permission to access the server or a database on the server.</span></span> <span data-ttu-id="f2c17-137">您要在 Management Studio 中執行的大部分工作都需要管理權限，</span><span class="sxs-lookup"><span data-stu-id="f2c17-137">Most tasks that you want to perform in Management Studio require administrative permissions.</span></span> <span data-ttu-id="f2c17-138">因此請確定您所連接的帳戶為伺服器管理員角色的成員。</span><span class="sxs-lookup"><span data-stu-id="f2c17-138">Ensure that the account you are connecting with is a member of the Server Administrator role.</span></span> <span data-ttu-id="f2c17-139">如需詳細資訊，請參閱[&#40;Analysis Services&#41;授與伺服器管理員許可權](grant-server-admin-rights-to-an-analysis-services-instance.md)。</span><span class="sxs-lookup"><span data-stu-id="f2c17-139">For more information, see [Grant Server Administrator Permissions &#40;Analysis Services&#41;](grant-server-admin-rights-to-an-analysis-services-instance.md).</span></span>  
  
4.  <span data-ttu-id="f2c17-140">按一下 [連接屬性]\*\*\*\* 指定特定的資料庫、設定逾時值或加密選項。</span><span class="sxs-lookup"><span data-stu-id="f2c17-140">Click **Connection Properties** to specify a particular database, set timeout values, or encryption options.</span></span> <span data-ttu-id="f2c17-141">選擇性連接資訊包括只用於目前連接的連接屬性。</span><span class="sxs-lookup"><span data-stu-id="f2c17-141">Optional connection information includes connection properties used for the current connection only.</span></span>  
  
5.  <span data-ttu-id="f2c17-142">按一下 [其他連接參數]\*\*\*\* 索引標籤，設定 [連接到伺服器] 對話方塊中無法設定的連接屬性。</span><span class="sxs-lookup"><span data-stu-id="f2c17-142">Click **Additional Connection Parameters** tab to set connection properties not available in the Connect to Server dialog box.</span></span> <span data-ttu-id="f2c17-143">例如，您可以在文字方塊中輸入 `Roles=Reader` 。</span><span class="sxs-lookup"><span data-stu-id="f2c17-143">For example, you might type `Roles=Reader` in the text box.</span></span>  
  
     <span data-ttu-id="f2c17-144">透過擁有較低權限的角色來連接時，如果這個角色已經生效，您就能測試資料庫行為。</span><span class="sxs-lookup"><span data-stu-id="f2c17-144">Connecting through a role with less permission lets you test database behaviors when that role is in effect.</span></span>  
  
    ```  
    Provider=MSOLAP; Data Source=SERVERNAME; Initial Catalog=AdventureWorks2012; Roles=READER  
    ```  
  
##  <a name="connect-using-excel"></a><a name="bkmk_excel"></a><span data-ttu-id="f2c17-145">使用 Excel 連接</span><span class="sxs-lookup"><span data-stu-id="f2c17-145">Connect using Excel</span></span>  
 <span data-ttu-id="f2c17-146">Microsoft Excel 通常用來分析商務資料。</span><span class="sxs-lookup"><span data-stu-id="f2c17-146">Microsoft Excel is often used for analyzing business data.</span></span> <span data-ttu-id="f2c17-147">在 Excel 安裝過程中，Office 會安裝 Analysis Services OLE DB 提供者 (MSOLAP DLL)、ADOMD.NET 和其他資料提供者，好讓您可以更輕易地使用網路伺服器上的資料。</span><span class="sxs-lookup"><span data-stu-id="f2c17-147">As part of an Excel installation, Office installs the Analysis Services OLE DB provider (MSOLAP DLL), ADOMD.NET, and other data providers so that you can more readily use the data on your network servers.</span></span> <span data-ttu-id="f2c17-148">如果您搭配舊版的 Excel 使用較新版的 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] ，您很可能必須在連接到 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]的每一個工作站上安裝較新的資料提供者。</span><span class="sxs-lookup"><span data-stu-id="f2c17-148">If you are using a newer version of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] with an older version of Excel, you most likely need to install newer data providers on each workstation that connects to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="f2c17-149">如需詳細資訊，請參閱 [用於 Analysis Services 連接的資料提供者](data-providers-used-for-analysis-services-connections.md) 。</span><span class="sxs-lookup"><span data-stu-id="f2c17-149">See [Data providers used for Analysis Services connections](data-providers-used-for-analysis-services-connections.md) for more information.</span></span>  
  
 <span data-ttu-id="f2c17-150">當您設定與 Analysis Services Cube 或表格式模型資料庫的連接時，Excel 會將連接資訊儲存到 .odc 檔案中，以供將來使用。</span><span class="sxs-lookup"><span data-stu-id="f2c17-150">When you set up a connection to an Analysis Services cube or tabular model database, Excel saves the connection information in .odc file for future use.</span></span> <span data-ttu-id="f2c17-151">連接是在目前 Windows 使用者的安全性內容中建立。</span><span class="sxs-lookup"><span data-stu-id="f2c17-151">The connection is made in security context of the current Windows user.</span></span> <span data-ttu-id="f2c17-152">使用者帳戶必須擁有資料庫的讀取權限，才能連接成功。</span><span class="sxs-lookup"><span data-stu-id="f2c17-152">The user account must have read permissions on the database in order for the connection to succeed.</span></span>  
  
 <span data-ttu-id="f2c17-153">當您使用 Excel 活頁簿中的 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 資料時，查詢要求的持續期間將會保留連接。</span><span class="sxs-lookup"><span data-stu-id="f2c17-153">When using [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data in an Excel workbook, connections are held for the duration of a query request.</span></span> <span data-ttu-id="f2c17-154">這就是為什麼當您從 Excel 監視查詢工作負載時，您可能會看到每個工作階段都有許多連接，這些連接保留很短的時間。</span><span class="sxs-lookup"><span data-stu-id="f2c17-154">This is why you are likely to see lots of connections for each session, held for very short periods of time, when monitoring a query workload from Excel.</span></span>  
  
 <span data-ttu-id="f2c17-155">您可以使用特定使用者識別啟動 Excel 來測試權限。</span><span class="sxs-lookup"><span data-stu-id="f2c17-155">You can test permissions by starting Excel under a specific user identity.</span></span>  
  
 <span data-ttu-id="f2c17-156">按住 Shift 鍵並以滑鼠右鍵按一下 [Excel]\*\*\*\* 捷徑，即可存取 [以不同的使用者身分執行]\*\*\*\* 選項。</span><span class="sxs-lookup"><span data-stu-id="f2c17-156">Hold-down the Shift key and right-click the **Excel** shortcut to access the **Run as different user** option.</span></span>  
  
1.  <span data-ttu-id="f2c17-157">在 Excel 的 [資料] 索引標籤中按一下 [從其他來源]\*\*\*\*，然後按一下 [從 Analysis Services]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="f2c17-157">On the Data tab in Excel, click **From Other Sources**, and then click **From Analysis Services**.</span></span> <span data-ttu-id="f2c17-158">輸入伺服器名稱，然後選取要查詢的 Cube 或檢視方塊。</span><span class="sxs-lookup"><span data-stu-id="f2c17-158">Enter the server name, and then select a cube or perspective to query.</span></span>  
  
     <span data-ttu-id="f2c17-159">如果是部署在負載平衡叢集中的伺服器，請使用指派給叢集的虛擬伺服器名稱。</span><span class="sxs-lookup"><span data-stu-id="f2c17-159">For servers deployed in a load-balanced cluster, use the virtual server name assigned to the cluster.</span></span>  
  
2.  <span data-ttu-id="f2c17-160">當您在 Excel 中設定連接時，您可以在資料連線精靈的最後一頁上指定 Excel Services 的驗證設定。</span><span class="sxs-lookup"><span data-stu-id="f2c17-160">When setting up a connection in Excel, on the last page of the Data Connection Wizard, you can specify authentication settings for Excel Services.</span></span> <span data-ttu-id="f2c17-161">這些設定是用來設定活頁簿上的屬性，前提是您將活頁簿上傳到擁有 Excel Services 的 SharePoint 伺服器。</span><span class="sxs-lookup"><span data-stu-id="f2c17-161">These settings are used to set properties on the workbook should you upload it to a SharePoint server that has Excel Services.</span></span> <span data-ttu-id="f2c17-162">這些設定會用於資料重新整理作業。</span><span class="sxs-lookup"><span data-stu-id="f2c17-162">The settings are used in data refresh operations.</span></span> <span data-ttu-id="f2c17-163">選項包括 [Windows 驗證]\*\*\*\*、[Secure Store Service]\*\*\*\* (SSS) 和 [無]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="f2c17-163">Options include **Windows Authentication**, **Secure Store Service** (SSS), and **None**.</span></span>  
  
     <span data-ttu-id="f2c17-164">請避免使用 [無]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="f2c17-164">Avoid using **None**.</span></span> <span data-ttu-id="f2c17-165">Analysis Services 無法讓您指定連接字串上的使用者名稱和密碼，除非您連接到已經有設定 HTTP 存取的伺服器。</span><span class="sxs-lookup"><span data-stu-id="f2c17-165">Analysis Services does not let you specify a user name and password on the connection string unless you are connecting to a server that has been configured for HTTP access.</span></span> <span data-ttu-id="f2c17-166">同樣地，除非您已經知道 SSS 目標應用程式識別碼會對應到擁有 Analysis Services 資料庫之使用者存取權的一組 Windows 使用者認證，否則請勿使用 SSS。</span><span class="sxs-lookup"><span data-stu-id="f2c17-166">Similarly, do not use SSS unless you already know that the SSS target application ID is mapped to a set of Windows user credentials that have user access to the Analysis Services databases.</span></span> <span data-ttu-id="f2c17-167">在大部分情況下，使用 Windows 驗證的預設選項是來自 Excel 之 Analysis Services 連接的最佳選擇。</span><span class="sxs-lookup"><span data-stu-id="f2c17-167">For most scenarios, using the default option of Windows authentication is the best choice for an Analysis Services connection from Excel.</span></span>  
  
 <span data-ttu-id="f2c17-168">如需詳細資訊，請參閱＜ [連接到 SQL Server Analysis Services 或是從中匯入資料](https://go.microsoft.com/fwlink/?linkID=215150)＞。</span><span class="sxs-lookup"><span data-stu-id="f2c17-168">For more information, see [Connect to or import data from SQL Server Analysis Services](https://go.microsoft.com/fwlink/?linkID=215150).</span></span>  
  
##  <a name="connect-using-sql-server-data-tools"></a><a name="bkmk_SSDT"></a><span data-ttu-id="f2c17-169">使用 SQL Server Data Tools 連接</span><span class="sxs-lookup"><span data-stu-id="f2c17-169">Connect using SQL Server Data Tools</span></span>  
 <span data-ttu-id="f2c17-170">SQL Server Data Tools 用於建置 BI 方案，其中包括 Analysis Services 模型、Reporting Services 報表和 SSIS 封裝。</span><span class="sxs-lookup"><span data-stu-id="f2c17-170">SQL Server Data Tools is used for building BI solutions, including Analysis Services models, Reporting Services reports, and SSIS packages.</span></span> <span data-ttu-id="f2c17-171">在建置報表或封裝時，您可能必須指定 Analysis Services 的連接。</span><span class="sxs-lookup"><span data-stu-id="f2c17-171">When building reports or packages, you might need to specify a connection to Analysis Services.</span></span>  
  
 <span data-ttu-id="f2c17-172">下列連結說明如何從報表伺服器專案或 Integration Services 專案連接至 Analysis Services：</span><span class="sxs-lookup"><span data-stu-id="f2c17-172">The following links explain how to connect to Analysis Services from a Report Server project or an Integration Services project:</span></span>  
  
-   [<span data-ttu-id="f2c17-173">MDX 的 Analysis Services 連接類型 &#40;SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="f2c17-173">Analysis Services Connection Type for MDX &#40;SSRS&#41;</span></span>](../../reporting-services/report-data/analysis-services-connection-type-for-mdx-ssrs.md)  
  
-   [<span data-ttu-id="f2c17-174">Analysis Services 連線管理員</span><span class="sxs-lookup"><span data-stu-id="f2c17-174">Analysis Services Connection Manager</span></span>](../../integration-services/connection-manager/analysis-services-connection-manager.md)  
  
> [!NOTE]  
>  <span data-ttu-id="f2c17-175">使用 SQL Server Data Tools 處理現有的 Analysis Services 專案時，以線上模式專案，請記住您可以使用本機或版本控制專案以離線方式連接，或者使用線上模式連接，在資料庫執行期間更新 Analysis Services 物件。</span><span class="sxs-lookup"><span data-stu-id="f2c17-175">When using SQL Server Data Tools to work on an existing Analysis Services project, remember that you can connect offline using a local or version controlled project, or connect in online mode to update Analysis Services objects while the database is running.</span></span> <span data-ttu-id="f2c17-176">如需詳細資訊，請參閱 [在連線模式下連接至 Analysis Services 資料庫](../multidimensional-models/connect-in-online-mode-to-an-analysis-services-database.md)。</span><span class="sxs-lookup"><span data-stu-id="f2c17-176">For more information, see [Connect in Online Mode to an Analysis Services Database](../multidimensional-models/connect-in-online-mode-to-an-analysis-services-database.md).</span></span> <span data-ttu-id="f2c17-177">更常見的情況是，來自 [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] 的連接會處於專案模式，而且只有當您明確部署專案時，其中的變更才會部署到資料庫。</span><span class="sxs-lookup"><span data-stu-id="f2c17-177">More commonly, connections from [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] are in project mode, where changes are deployed to the database only when you explicitly deploy the project.</span></span>  
  
##  <a name="test-connections"></a><a name="bkmk_tshoot"></a><span data-ttu-id="f2c17-178">測試連接</span><span class="sxs-lookup"><span data-stu-id="f2c17-178">Test connections</span></span>  
 <span data-ttu-id="f2c17-179">您可以使用 SQL Server Profiler 監視 Analysis Services 的連接。</span><span class="sxs-lookup"><span data-stu-id="f2c17-179">You can use SQL Server Profiler to monitor connections to Analysis Services.</span></span> <span data-ttu-id="f2c17-180">「稽核登入」和「稽核登出」事件都會提供連接的辨識項。</span><span class="sxs-lookup"><span data-stu-id="f2c17-180">The Audit Login and Audit Logout events provide evidence of a connection.</span></span> <span data-ttu-id="f2c17-181">識別欄位表示建立連接時遵循的安全性內容。</span><span class="sxs-lookup"><span data-stu-id="f2c17-181">The identity column indicates the security context under which the connection is made.</span></span>  
  
1.  <span data-ttu-id="f2c17-182">在 Analysis Services 執行個體上啟動 **SQL Server Profiler** ，然後啟動新的追蹤。</span><span class="sxs-lookup"><span data-stu-id="f2c17-182">Start **SQL Server Profiler** on the Analysis Services instance and then start a new trace.</span></span>  
  
2.  <span data-ttu-id="f2c17-183">在 [事件選取範圍] 的 [安全性稽核] 區段，確認已核取 [`Audit Login`] 和 [`Audit Logout`]。</span><span class="sxs-lookup"><span data-stu-id="f2c17-183">In Events Selection, verify that `Audit Login` and `Audit Logout` are checked in the Security Audit section.</span></span>  
  
3.  <span data-ttu-id="f2c17-184">從遠端用戶端電腦透過應用程式服務 (例如 SharePoint 或 Reporting Services) 連接到 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="f2c17-184">Connect to Analysis Services via an application service (such as SharePoint or Reporting Services) from a remote client computer.</span></span> <span data-ttu-id="f2c17-185">「稽核登入」事件將會顯示連接到 Analysis Services 的使用者之身分識別。</span><span class="sxs-lookup"><span data-stu-id="f2c17-185">The Audit Login event will show the identity of the user connecting to Analysis Services.</span></span>  
  
 <span data-ttu-id="f2c17-186">發生連接錯誤時，追蹤其原因通常是不完整或無效的伺服器組態所導致。</span><span class="sxs-lookup"><span data-stu-id="f2c17-186">Connection errors are often traced to an incomplete or invalid server configuration.</span></span> <span data-ttu-id="f2c17-187">因此，請務必先檢查伺服器組態：</span><span class="sxs-lookup"><span data-stu-id="f2c17-187">Always check server configuration first:</span></span>  
  
-   <span data-ttu-id="f2c17-188">從遠端電腦 Ping 伺服器，確保它允許遠端連接。</span><span class="sxs-lookup"><span data-stu-id="f2c17-188">Ping the server from a remote computer to ensure it allows remote connections.</span></span>  
  
-   <span data-ttu-id="f2c17-189">**伺服器上的防火牆規則允許來自相同網域中用戶端的傳入連接**</span><span class="sxs-lookup"><span data-stu-id="f2c17-189">**Firewall rules on the server allow inbound connections from clients in the same domain**</span></span>  
  
     <span data-ttu-id="f2c17-190">除了 PowerPivot for SharePoint 以外，與遠端伺服器的所有連接都會要求您已經設定防火牆允許存取 Analysis Services 所接聽的通訊埠。</span><span class="sxs-lookup"><span data-stu-id="f2c17-190">With the exception of PowerPivot for SharePoint, all connections to a remote server require that you have configured the firewall to allow access to the port that Analysis Services is listening on.</span></span> <span data-ttu-id="f2c17-191">如果您得到連接錯誤，請確認此通訊埠確實可存取，而且已經授與使用者權限給適當的資料庫。</span><span class="sxs-lookup"><span data-stu-id="f2c17-191">If you are getting connection errors, verify that the port is accessible and that user permissions are granted to the appropriate databases.</span></span>  
  
     <span data-ttu-id="f2c17-192">若要測試，請使用 Excel 或 SSMS 並指定 Analysis Services 執行個體使用的 IP 位址和通訊埠，然後連接到遠端電腦。</span><span class="sxs-lookup"><span data-stu-id="f2c17-192">To test, use Excel or SSMS to on a remote computer, specifying the IP address and port used by the Analysis Services instance.</span></span> <span data-ttu-id="f2c17-193">如果可以連接，表示防火牆規則允許執行個體的傳入連接，而且執行個體也允許遠端連接。</span><span class="sxs-lookup"><span data-stu-id="f2c17-193">If you can connection, the firewall rules are valid for the instance and the instance allows remote connections.</span></span>  
  
     <span data-ttu-id="f2c17-194">此外，使用 TCP/IP 做為連接通訊協定時，請記住用戶端必須位於相同網域或信任網域中才能連接 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="f2c17-194">Also, when using TCP/IP for the connection protocol, remember that Analysis Services requires client connections originate from the same domain or a trusted domain.</span></span> <span data-ttu-id="f2c17-195">如果連接是跨安全性界限進行，您就必須設定 HTTP 存取。</span><span class="sxs-lookup"><span data-stu-id="f2c17-195">If connections flow across security boundaries, you will most likely need to configure HTTP access.</span></span> <span data-ttu-id="f2c17-196">如需詳細資訊，請參閱 [設定 Internet Information Services &#40;IIS&#41; 8.0 上 Analysis Services 的 HTTP 存取](configure-http-access-to-analysis-services-on-iis-8-0.md)(Microsoft BI 驗證及識別委派)。</span><span class="sxs-lookup"><span data-stu-id="f2c17-196">For more information, see [Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span></span>  
  
-   <span data-ttu-id="f2c17-197">您是否能使用一些工具連接，但是其他工具就不行？</span><span class="sxs-lookup"><span data-stu-id="f2c17-197">Can you connect using some tools but not others?</span></span> <span data-ttu-id="f2c17-198">這個問題可能是用戶端程式庫版本錯誤。</span><span class="sxs-lookup"><span data-stu-id="f2c17-198">The problem might be the wrong version of a client library.</span></span> <span data-ttu-id="f2c17-199">您可以從 SQL Server 功能套件下載頁面取得用戶端程式庫。</span><span class="sxs-lookup"><span data-stu-id="f2c17-199">You can get client libraries from the SQL Server Feature Pack download page.</span></span>  
  
 <span data-ttu-id="f2c17-200">下列文件也能協助您解決連接失敗的問題：</span><span class="sxs-lookup"><span data-stu-id="f2c17-200">Resources that can help you resolve connection failures include the following:</span></span>  
  
 <span data-ttu-id="f2c17-201">[Resolving Common Connectivity Issues in SQL Server 2005 Analysis Services Connectivity Scenarios](https://technet.microsoft.com/library/cc917670.aspx)(在 SQL Server 2005 Analysis Services 連接狀況中解決常見的連接問題)。</span><span class="sxs-lookup"><span data-stu-id="f2c17-201">[Resolving Common Connectivity Issues in SQL Server 2005 Analysis Services Connectivity Scenarios](https://technet.microsoft.com/library/cc917670.aspx).</span></span> <span data-ttu-id="f2c17-202">這份文件已經有一些歲月，但是其中的資訊和方法仍然適用。</span><span class="sxs-lookup"><span data-stu-id="f2c17-202">This document is a few years old, but the information and methodologies still apply.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f2c17-203">另請參閱</span><span class="sxs-lookup"><span data-stu-id="f2c17-203">See Also</span></span>  
 <span data-ttu-id="f2c17-204">[連接到 Analysis Services](connect-to-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="f2c17-204">[Connect to Analysis Services](connect-to-analysis-services.md) </span></span>  
 <span data-ttu-id="f2c17-205">[Analysis Services 支援的驗證方法](authentication-methodologies-supported-by-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="f2c17-205">[Authentication methodologies supported by Analysis Services](authentication-methodologies-supported-by-analysis-services.md) </span></span>  
 <span data-ttu-id="f2c17-206">[&#40;SSAS 表格式&#41;的模擬](../tabular-models/impersonation-ssas-tabular.md) </span><span class="sxs-lookup"><span data-stu-id="f2c17-206">[Impersonation &#40;SSAS Tabular&#41;](../tabular-models/impersonation-ssas-tabular.md) </span></span>  
 [<span data-ttu-id="f2c17-207">建立資料來源 &#40;SSAS 多維度&#41;</span><span class="sxs-lookup"><span data-stu-id="f2c17-207">Create a Data Source &#40;SSAS Multidimensional&#41;</span></span>](../multidimensional-models/create-a-data-source-ssas-multidimensional.md)  
  
  
