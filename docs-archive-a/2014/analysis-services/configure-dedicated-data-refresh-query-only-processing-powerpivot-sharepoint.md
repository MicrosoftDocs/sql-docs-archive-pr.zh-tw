---
title: 設定專用的資料重新整理或僅查詢處理 (PowerPivot for SharePoint) |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 5e027605-1086-4941-bb01-f315df8f829b
author: minewiskan
ms.author: owend
ms.openlocfilehash: 6aa98f16a8a607f5f65f15bc921d0cc42ae1cd1c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87593051"
---
# <a name="configure-dedicated-data-refresh-or-query-only-processing-powerpivot-for-sharepoint"></a>設定專用的資料重新整理或僅查詢處理 (PowerPivot for SharePoint)
  在 SharePoint 整合模式中，Analysis Services 伺服器執行個體可以設定為支援特定的處理要求類型，例如資料重新整理或僅查詢處理。 在預設情況下，這兩種類型的載入要求都會啟用。 您可以關閉其中任何一種，以建立專用的查詢引擎或資料重新整理伺服器。  
  
 **[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010  
  
> [!NOTE]  
>  在本版中，無論是資料重新整理作業或隨需查詢，都沒有任何組態設定可用於限制記憶體或 CPU 使用量。 [!INCLUDE[ssGeminiSrv](../includes/ssgeminisrv-md.md)] 執行個體將使用所有可用的資源來執行所管理的查詢及資料重新整理作業。  
  
 本主題包含下列幾節：  
  
 [設定處理模式](#config)  
  
 [變更可以並行執行的資料重新整理作業數量](#change)  
  
##  <a name="configure-a-processing-mode"></a><a name="config"></a>設定處理模式  
  
1.  在 [管理中心] 的 [系統設定] 中，按一下 [**管理伺服器上的服務**]。  
  
2.  在 [伺服器] 頁面的頂端，按一下向下箭頭，然後按一下 [變更伺服器]****。  
  
3.  選取具有您所要設定 Analysis Services 伺服器執行個體的 SharePoint 伺服器。  
  
4.  按一下 **[SQL Server Analysis Services]**。  
  
5.  在 [服務執行個體使用狀況] 中執行下列動作：  
  
    1.  清除 [**啟用載入唯讀資料庫**] 核取方塊，以關閉當使用者開啟包含 PowerPivot 資料的活頁簿時所進行的視需要查詢處理。  
  
    2.  清除 [**啟用載入資料庫以進行**重新整理] 核取方塊，以關閉已排程的資料重新整理。  
  
    > [!NOTE]  
    >  關閉資料重新整理並不會從 SharePoint 網站移除資料重新整理選項。 擁有 PowerPivot 活頁簿的使用者還是可以建立資料重新整理的排程，但該伺服器上並不會執行資料重新整理。  
  
6.  您可以選擇針對資料重新整理作業，變更並行重新整理工作數。 如果伺服器只設定來執行資料重新整理，或者，如果伺服器上有額外的處理器，則建議您提高並行工作數。 如果您要釋出系統資源供更多視需要查詢使用，則可以減少並行工作數。  
  
7.  儲存您的變更。 處理事件發生之前，伺服器不會驗證您的項目。 如果輸入無效的並行作業數，處理下一個要求時，將會偵測並記錄錯誤。  
  
##  <a name="change-the-number-of-data-refresh-jobs-that-can-run-in-parallel"></a><a name="change"></a>變更可平行執行的資料重新整理作業數目  
 資料重新整理作業是加入至處理佇列的排程工作，此佇列是由 PowerPivot 服務應用程式進行維護及監視。 作業包含 PowerPivot 活頁簿中一個或多個資料來源的排程資訊。 每個已定義的排程都會分別建立工作。 如果活頁簿擁有者為所有資料來源定義一個排程，則只為整個資料重新整理作業建立一個工作。 如果活頁簿擁有者為外部資料來源建立個別的排程，則會建立並執行多個工作，以完成該活頁簿的完整資料重新整理。  
  
 如果系統有足夠容量支援額外負載，您可以增加可同時執行的資料重新整理作業數。  
  
|設定|有效值|描述|  
|-------------|------------------|-----------------|  
|預設值|根據 RAM 進行計算。|預設值的根據是可用記憶體數量除以 4 GB。 預設值是由公式進行計算，以便依系統的容量調整設定。<br /><br /> 注意： 4 gb 的除數是根據實際 PowerPivot 資料源之大型取樣的 RAM 使用量所選取。 而不是以 PowerPivot 實體或邏輯架構為根據。|  
|最大值|根據 CPU 數進行計算。|您可以指定的最大並行工作數是以電腦上的處理器數目為根據。 例如，在 4 插槽的四核心電腦上，您可以同時執行的作業數目上限是 16。|  
  
#### <a name="increasing-the-default-value-to-a-higher-value"></a>將預設值增加到更高的值  
 下圖顯示不同的 RAM 與 CPU 組合，產生的預設值與上限值是根據系統的特性所計算。 請記得，可並行執行之資料重新整理作業數目的預設值計算是根據系統記憶體，而計算的上限值則是根據 CPU。 最後一個資料行指出，您是否可以增加並行資料重新整理作業數目的上限。  
  
|實際的 RAM (以 GB 為單位)|計算的預設值|實際的 CPU 數|計算的最大值|增加並行作業嗎？|  
|---------------------------------|------------------------------|------------------------|------------------------------|-------------------------------|  
|4|1|1|1|否。 預設值與最大值相同。|  
|4|1|4|4|是。 您可以將並行作業數提高為 2、3 或 4。|  
|8|2|4|4|是。 您可以將並行作業數提高為 3 或 4。|  
|16|4|4|4|否。 預設值與最大值相同。|  
|32|使用可計算預設值的公式得到預設值等於 8。 由於預設值高於允許的最大值，因此將不會使用計算所得的預設值。|4|4|否。 雖然大量 RAM 指出預設值為 8 個並行作業，但 4 個處理器的電腦將只支援最多 4 個並行作業。|  
|32|8|8|8|否。|  
|32|8|16|16|是。|  
|64|16|16|16|否。|  
  
 由於無法事先知道是否可以同時成功執行多個作業，您應該只在一段時間內分析記憶體耗用量，並判斷通常伺服器記憶體都未充分利用之後，再增加並行作業數。  
  
 每個資料重新整理工作都會有不同的負載特性，取決於進行重新整理的資料來源數量和大小。 含資料列數量較少之單一資料來源的活頁簿，其處理負載就遠比含無數資料來源與龐大資料列集的活頁簿輕得多。  
  
## <a name="see-also"></a>另請參閱  
 [SharePoint 2010 中的 PowerPivot 資料重新整理](powerpivot-data-refresh-with-sharepoint-2010.md)  
  
  
