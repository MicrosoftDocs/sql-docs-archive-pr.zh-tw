---
title: 設定專用的資料重新整理或僅查詢處理 (PowerPivot for SharePoint) |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 5e027605-1086-4941-bb01-f315df8f829b
author: minewiskan
ms.author: owend
ms.openlocfilehash: 6aa98f16a8a607f5f65f15bc921d0cc42ae1cd1c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87593051"
---
# <a name="configure-dedicated-data-refresh-or-query-only-processing-powerpivot-for-sharepoint"></a><span data-ttu-id="aeb84-102">設定專用的資料重新整理或僅查詢處理 (PowerPivot for SharePoint)</span><span class="sxs-lookup"><span data-stu-id="aeb84-102">Configure Dedicated Data Refresh or Query-Only Processing (PowerPivot for SharePoint)</span></span>
  <span data-ttu-id="aeb84-103">在 SharePoint 整合模式中，Analysis Services 伺服器執行個體可以設定為支援特定的處理要求類型，例如資料重新整理或僅查詢處理。</span><span class="sxs-lookup"><span data-stu-id="aeb84-103">In SharePoint integrated mode, an Analysis Services server instance can be configured to support a specific type of processing request, such as data refresh or query-only processing.</span></span> <span data-ttu-id="aeb84-104">在預設情況下，這兩種類型的載入要求都會啟用。</span><span class="sxs-lookup"><span data-stu-id="aeb84-104">By default, both types of load requests are enabled.</span></span> <span data-ttu-id="aeb84-105">您可以關閉其中任何一種，以建立專用的查詢引擎或資料重新整理伺服器。</span><span class="sxs-lookup"><span data-stu-id="aeb84-105">You can turn off either type to create a dedicated query engine or data refresh server.</span></span>  
  
 <span data-ttu-id="aeb84-106">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="aeb84-106">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="aeb84-107">在本版中，無論是資料重新整理作業或隨需查詢，都沒有任何組態設定可用於限制記憶體或 CPU 使用量。</span><span class="sxs-lookup"><span data-stu-id="aeb84-107">In this release, there are no configuration settings for limiting memory or CPU usage for either data refresh jobs or on-demand queries.</span></span> <span data-ttu-id="aeb84-108">[!INCLUDE[ssGeminiSrv](../includes/ssgeminisrv-md.md)] 執行個體將使用所有可用的資源來執行所管理的查詢及資料重新整理作業。</span><span class="sxs-lookup"><span data-stu-id="aeb84-108">An [!INCLUDE[ssGeminiSrv](../includes/ssgeminisrv-md.md)] instance will use all of the resources that are available to run the queries and data refresh jobs it is managing.</span></span>  
  
 <span data-ttu-id="aeb84-109">本主題包含下列幾節：</span><span class="sxs-lookup"><span data-stu-id="aeb84-109">This topic contains the following sections:</span></span>  
  
 [<span data-ttu-id="aeb84-110">設定處理模式</span><span class="sxs-lookup"><span data-stu-id="aeb84-110">Configure a processing mode</span></span>](#config)  
  
 [<span data-ttu-id="aeb84-111">變更可以並行執行的資料重新整理作業數量</span><span class="sxs-lookup"><span data-stu-id="aeb84-111">Change the number of data refresh jobs that can run in parallel</span></span>](#change)  
  
##  <a name="configure-a-processing-mode"></a><a name="config"></a><span data-ttu-id="aeb84-112">設定處理模式</span><span class="sxs-lookup"><span data-stu-id="aeb84-112">Configure a Processing Mode</span></span>  
  
1.  <span data-ttu-id="aeb84-113">在 [管理中心] 的 [系統設定] 中，按一下 [**管理伺服器上的服務**]。</span><span class="sxs-lookup"><span data-stu-id="aeb84-113">In Central Administration, in System Settings, click **Manage services on server**.</span></span>  
  
2.  <span data-ttu-id="aeb84-114">在 [伺服器] 頁面的頂端，按一下向下箭頭，然後按一下 [變更伺服器]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="aeb84-114">At the top of the page, in Server, click the down arrow, and then click **Change Server**.</span></span>  
  
3.  <span data-ttu-id="aeb84-115">選取具有您所要設定 Analysis Services 伺服器執行個體的 SharePoint 伺服器。</span><span class="sxs-lookup"><span data-stu-id="aeb84-115">Select the SharePoint server that has the Analysis Services server instance that you want to configure.</span></span>  
  
4.  <span data-ttu-id="aeb84-116">按一下 **[SQL Server Analysis Services]**。</span><span class="sxs-lookup"><span data-stu-id="aeb84-116">Click **SQL Server Analysis Services**.</span></span>  
  
5.  <span data-ttu-id="aeb84-117">在 [服務執行個體使用狀況] 中執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="aeb84-117">In Service Instance Usage, do one of the following:</span></span>  
  
    1.  <span data-ttu-id="aeb84-118">清除 [**啟用載入唯讀資料庫**] 核取方塊，以關閉當使用者開啟包含 PowerPivot 資料的活頁簿時所進行的視需要查詢處理。</span><span class="sxs-lookup"><span data-stu-id="aeb84-118">Clear the checkbox for **Enable loading of read-only databases** to turn off on-demand query processing that occurs whenever a user opens a workbook that contains PowerPivot data.</span></span>  
  
    2.  <span data-ttu-id="aeb84-119">清除 [**啟用載入資料庫以進行**重新整理] 核取方塊，以關閉已排程的資料重新整理。</span><span class="sxs-lookup"><span data-stu-id="aeb84-119">Clear the checkbox for **Enable loading of databases for refresh** to turn off scheduled data refresh.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="aeb84-120">關閉資料重新整理並不會從 SharePoint 網站移除資料重新整理選項。</span><span class="sxs-lookup"><span data-stu-id="aeb84-120">Turning off data refresh does not remove data refresh options from SharePoint sites.</span></span> <span data-ttu-id="aeb84-121">擁有 PowerPivot 活頁簿的使用者還是可以建立資料重新整理的排程，但該伺服器上並不會執行資料重新整理。</span><span class="sxs-lookup"><span data-stu-id="aeb84-121">Users who own PowerPivot workbooks can still create schedules for data refresh, but data refresh will not occur on that server.</span></span>  
  
6.  <span data-ttu-id="aeb84-122">您可以選擇針對資料重新整理作業，變更並行重新整理工作數。</span><span class="sxs-lookup"><span data-stu-id="aeb84-122">Optionally, for data refresh operations, you can change the number of concurrent refresh jobs.</span></span> <span data-ttu-id="aeb84-123">如果伺服器只設定來執行資料重新整理，或者，如果伺服器上有額外的處理器，則建議您提高並行工作數。</span><span class="sxs-lookup"><span data-stu-id="aeb84-123">Increasing the number of concurrent jobs is recommended if the server is configured for data refresh only, or if there are additional processors on the server.</span></span> <span data-ttu-id="aeb84-124">如果您要釋出系統資源供更多視需要查詢使用，則可以減少並行工作數。</span><span class="sxs-lookup"><span data-stu-id="aeb84-124">You might decrease the number of concurrent jobs if you want to free up system resources for more on-demand queries.</span></span>  
  
7.  <span data-ttu-id="aeb84-125">儲存您的變更。</span><span class="sxs-lookup"><span data-stu-id="aeb84-125">Save your changes.</span></span> <span data-ttu-id="aeb84-126">處理事件發生之前，伺服器不會驗證您的項目。</span><span class="sxs-lookup"><span data-stu-id="aeb84-126">The server will not validate your entries until a processing event occurs.</span></span> <span data-ttu-id="aeb84-127">如果輸入無效的並行作業數，處理下一個要求時，將會偵測並記錄錯誤。</span><span class="sxs-lookup"><span data-stu-id="aeb84-127">If you enter an invalid number for concurrent jobs, the error will be detected and logged when the next request is processed.</span></span>  
  
##  <a name="change-the-number-of-data-refresh-jobs-that-can-run-in-parallel"></a><a name="change"></a><span data-ttu-id="aeb84-128">變更可平行執行的資料重新整理作業數目</span><span class="sxs-lookup"><span data-stu-id="aeb84-128">Change the number of data refresh jobs that can run in parallel</span></span>  
 <span data-ttu-id="aeb84-129">資料重新整理作業是加入至處理佇列的排程工作，此佇列是由 PowerPivot 服務應用程式進行維護及監視。</span><span class="sxs-lookup"><span data-stu-id="aeb84-129">A data refresh job is a scheduled task that is added to a processing queue that is maintained and monitored by a PowerPivot service application.</span></span> <span data-ttu-id="aeb84-130">作業包含 PowerPivot 活頁簿中一個或多個資料來源的排程資訊。</span><span class="sxs-lookup"><span data-stu-id="aeb84-130">A job consists of schedule information for one or more data sources in a PowerPivot workbook.</span></span> <span data-ttu-id="aeb84-131">每個已定義的排程都會分別建立工作。</span><span class="sxs-lookup"><span data-stu-id="aeb84-131">A separate job is created for each schedule that is defined.</span></span> <span data-ttu-id="aeb84-132">如果活頁簿擁有者為所有資料來源定義一個排程，則只為整個資料重新整理作業建立一個工作。</span><span class="sxs-lookup"><span data-stu-id="aeb84-132">If a workbook owner defines one schedule for all data sources, only one job will be created for the entire data refresh operation.</span></span> <span data-ttu-id="aeb84-133">如果活頁簿擁有者為外部資料來源建立個別的排程，則會建立並執行多個工作，以完成該活頁簿的完整資料重新整理。</span><span class="sxs-lookup"><span data-stu-id="aeb84-133">If a workbook owner creates individual schedules for external data sources, multiple jobs will be created and run to complete a full data refresh for that workbook.</span></span>  
  
 <span data-ttu-id="aeb84-134">如果系統有足夠容量支援額外負載，您可以增加可同時執行的資料重新整理作業數。</span><span class="sxs-lookup"><span data-stu-id="aeb84-134">You can increase the number of data refresh jobs that can run at the same time if your system has the capacity to support the extra load.</span></span>  
  
|<span data-ttu-id="aeb84-135">設定</span><span class="sxs-lookup"><span data-stu-id="aeb84-135">Setting</span></span>|<span data-ttu-id="aeb84-136">有效值</span><span class="sxs-lookup"><span data-stu-id="aeb84-136">Valid values</span></span>|<span data-ttu-id="aeb84-137">描述</span><span class="sxs-lookup"><span data-stu-id="aeb84-137">Description</span></span>|  
|-------------|------------------|-----------------|  
|<span data-ttu-id="aeb84-138">預設值</span><span class="sxs-lookup"><span data-stu-id="aeb84-138">Default value</span></span>|<span data-ttu-id="aeb84-139">根據 RAM 進行計算。</span><span class="sxs-lookup"><span data-stu-id="aeb84-139">Calculated based on RAM.</span></span>|<span data-ttu-id="aeb84-140">預設值的根據是可用記憶體數量除以 4 GB。</span><span class="sxs-lookup"><span data-stu-id="aeb84-140">The default value is based on the amount of available memory divided by 4 gigabytes.</span></span> <span data-ttu-id="aeb84-141">預設值是由公式進行計算，以便依系統的容量調整設定。</span><span class="sxs-lookup"><span data-stu-id="aeb84-141">The default is calculated by a formula so that the settings can be adjusted depending on the capabilities of the system.</span></span><br /><br /> <span data-ttu-id="aeb84-142">注意： 4 gb 的除數是根據實際 PowerPivot 資料源之大型取樣的 RAM 使用量所選取。</span><span class="sxs-lookup"><span data-stu-id="aeb84-142">Note: The 4 gigabyte divisor was selected based on RAM usage for a large sampling of actual PowerPivot data sources.</span></span> <span data-ttu-id="aeb84-143">而不是以 PowerPivot 實體或邏輯架構為根據。</span><span class="sxs-lookup"><span data-stu-id="aeb84-143">It is not based on PowerPivot physical or logical architecture.</span></span>|  
|<span data-ttu-id="aeb84-144">最大值</span><span class="sxs-lookup"><span data-stu-id="aeb84-144">Maximum value</span></span>|<span data-ttu-id="aeb84-145">根據 CPU 數進行計算。</span><span class="sxs-lookup"><span data-stu-id="aeb84-145">Calculated based on number of CPUs.</span></span>|<span data-ttu-id="aeb84-146">您可以指定的最大並行工作數是以電腦上的處理器數目為根據。</span><span class="sxs-lookup"><span data-stu-id="aeb84-146">The maximum number of concurrent jobs that you can specify is based on the number of processors on the computer.</span></span> <span data-ttu-id="aeb84-147">例如，在 4 插槽的四核心電腦上，您可以同時執行的作業數目上限是 16。</span><span class="sxs-lookup"><span data-stu-id="aeb84-147">For example, on a 4-socket quad-core computer, the maximum number of jobs that you can run concurrently is 16.</span></span>|  
  
#### <a name="increasing-the-default-value-to-a-higher-value"></a><span data-ttu-id="aeb84-148">將預設值增加到更高的值</span><span class="sxs-lookup"><span data-stu-id="aeb84-148">Increasing the default value to a higher value</span></span>  
 <span data-ttu-id="aeb84-149">下圖顯示不同的 RAM 與 CPU 組合，產生的預設值與上限值是根據系統的特性所計算。</span><span class="sxs-lookup"><span data-stu-id="aeb84-149">The following chart shows different combinations of RAM and CPU, and the resulting default and maximum values that are calculated based on system characteristics.</span></span> <span data-ttu-id="aeb84-150">請記得，可並行執行之資料重新整理作業數目的預設值計算是根據系統記憶體，而計算的上限值則是根據 CPU。</span><span class="sxs-lookup"><span data-stu-id="aeb84-150">Recall that the calculated default value for the number of data refresh jobs that can run concurrently is based on system memory, while the calculated maximum value is based on CPUs.</span></span> <span data-ttu-id="aeb84-151">最後一個資料行指出，您是否可以增加並行資料重新整理作業數目的上限。</span><span class="sxs-lookup"><span data-stu-id="aeb84-151">The last column indicates whether you can increase the maximum number of concurrent data refresh jobs.</span></span>  
  
|<span data-ttu-id="aeb84-152">實際的 RAM (以 GB 為單位)</span><span class="sxs-lookup"><span data-stu-id="aeb84-152">Actual RAM (in gigabytes)</span></span>|<span data-ttu-id="aeb84-153">計算的預設值</span><span class="sxs-lookup"><span data-stu-id="aeb84-153">Calculated Default value</span></span>|<span data-ttu-id="aeb84-154">實際的 CPU 數</span><span class="sxs-lookup"><span data-stu-id="aeb84-154">Actual Number CPUs</span></span>|<span data-ttu-id="aeb84-155">計算的最大值</span><span class="sxs-lookup"><span data-stu-id="aeb84-155">Calculated Maximum value</span></span>|<span data-ttu-id="aeb84-156">增加並行作業嗎？</span><span class="sxs-lookup"><span data-stu-id="aeb84-156">Increase concurrent jobs?</span></span>|  
|---------------------------------|------------------------------|------------------------|------------------------------|-------------------------------|  
|<span data-ttu-id="aeb84-157">4</span><span class="sxs-lookup"><span data-stu-id="aeb84-157">4</span></span>|<span data-ttu-id="aeb84-158">1</span><span class="sxs-lookup"><span data-stu-id="aeb84-158">1</span></span>|<span data-ttu-id="aeb84-159">1</span><span class="sxs-lookup"><span data-stu-id="aeb84-159">1</span></span>|<span data-ttu-id="aeb84-160">1</span><span class="sxs-lookup"><span data-stu-id="aeb84-160">1</span></span>|<span data-ttu-id="aeb84-161">否。</span><span class="sxs-lookup"><span data-stu-id="aeb84-161">No.</span></span> <span data-ttu-id="aeb84-162">預設值與最大值相同。</span><span class="sxs-lookup"><span data-stu-id="aeb84-162">Default and maximum are the same.</span></span>|  
|<span data-ttu-id="aeb84-163">4</span><span class="sxs-lookup"><span data-stu-id="aeb84-163">4</span></span>|<span data-ttu-id="aeb84-164">1</span><span class="sxs-lookup"><span data-stu-id="aeb84-164">1</span></span>|<span data-ttu-id="aeb84-165">4</span><span class="sxs-lookup"><span data-stu-id="aeb84-165">4</span></span>|<span data-ttu-id="aeb84-166">4</span><span class="sxs-lookup"><span data-stu-id="aeb84-166">4</span></span>|<span data-ttu-id="aeb84-167">是。</span><span class="sxs-lookup"><span data-stu-id="aeb84-167">Yes.</span></span> <span data-ttu-id="aeb84-168">您可以將並行作業數提高為 2、3 或 4。</span><span class="sxs-lookup"><span data-stu-id="aeb84-168">You can increase the number of concurrent jobs to 2, 3, or 4.</span></span>|  
|<span data-ttu-id="aeb84-169">8</span><span class="sxs-lookup"><span data-stu-id="aeb84-169">8</span></span>|<span data-ttu-id="aeb84-170">2</span><span class="sxs-lookup"><span data-stu-id="aeb84-170">2</span></span>|<span data-ttu-id="aeb84-171">4</span><span class="sxs-lookup"><span data-stu-id="aeb84-171">4</span></span>|<span data-ttu-id="aeb84-172">4</span><span class="sxs-lookup"><span data-stu-id="aeb84-172">4</span></span>|<span data-ttu-id="aeb84-173">是。</span><span class="sxs-lookup"><span data-stu-id="aeb84-173">Yes.</span></span> <span data-ttu-id="aeb84-174">您可以將並行作業數提高為 3 或 4。</span><span class="sxs-lookup"><span data-stu-id="aeb84-174">You can increase the number of concurrent jobs to 3 or 4.</span></span>|  
|<span data-ttu-id="aeb84-175">16</span><span class="sxs-lookup"><span data-stu-id="aeb84-175">16</span></span>|<span data-ttu-id="aeb84-176">4</span><span class="sxs-lookup"><span data-stu-id="aeb84-176">4</span></span>|<span data-ttu-id="aeb84-177">4</span><span class="sxs-lookup"><span data-stu-id="aeb84-177">4</span></span>|<span data-ttu-id="aeb84-178">4</span><span class="sxs-lookup"><span data-stu-id="aeb84-178">4</span></span>|<span data-ttu-id="aeb84-179">否。</span><span class="sxs-lookup"><span data-stu-id="aeb84-179">No.</span></span> <span data-ttu-id="aeb84-180">預設值與最大值相同。</span><span class="sxs-lookup"><span data-stu-id="aeb84-180">Default and maximum are the same.</span></span>|  
|<span data-ttu-id="aeb84-181">32</span><span class="sxs-lookup"><span data-stu-id="aeb84-181">32</span></span>|<span data-ttu-id="aeb84-182">使用可計算預設值的公式得到預設值等於 8。</span><span class="sxs-lookup"><span data-stu-id="aeb84-182">Using the formula that calculates the default value, the default would be 8.</span></span> <span data-ttu-id="aeb84-183">由於預設值高於允許的最大值，因此將不會使用計算所得的預設值。</span><span class="sxs-lookup"><span data-stu-id="aeb84-183">Because the default is higher than the maximum allowed, the calculated default is not used in this case.</span></span>|<span data-ttu-id="aeb84-184">4</span><span class="sxs-lookup"><span data-stu-id="aeb84-184">4</span></span>|<span data-ttu-id="aeb84-185">4</span><span class="sxs-lookup"><span data-stu-id="aeb84-185">4</span></span>|<span data-ttu-id="aeb84-186">否。</span><span class="sxs-lookup"><span data-stu-id="aeb84-186">No.</span></span> <span data-ttu-id="aeb84-187">雖然大量 RAM 指出預設值為 8 個並行作業，但 4 個處理器的電腦將只支援最多 4 個並行作業。</span><span class="sxs-lookup"><span data-stu-id="aeb84-187">Although the large RAM would indicate a default of 8 concurrent jobs, a computer that has 4 processors will only support a maximum of 4 concurrent jobs.</span></span>|  
|<span data-ttu-id="aeb84-188">32</span><span class="sxs-lookup"><span data-stu-id="aeb84-188">32</span></span>|<span data-ttu-id="aeb84-189">8</span><span class="sxs-lookup"><span data-stu-id="aeb84-189">8</span></span>|<span data-ttu-id="aeb84-190">8</span><span class="sxs-lookup"><span data-stu-id="aeb84-190">8</span></span>|<span data-ttu-id="aeb84-191">8</span><span class="sxs-lookup"><span data-stu-id="aeb84-191">8</span></span>|<span data-ttu-id="aeb84-192">否。</span><span class="sxs-lookup"><span data-stu-id="aeb84-192">No.</span></span>|  
|<span data-ttu-id="aeb84-193">32</span><span class="sxs-lookup"><span data-stu-id="aeb84-193">32</span></span>|<span data-ttu-id="aeb84-194">8</span><span class="sxs-lookup"><span data-stu-id="aeb84-194">8</span></span>|<span data-ttu-id="aeb84-195">16</span><span class="sxs-lookup"><span data-stu-id="aeb84-195">16</span></span>|<span data-ttu-id="aeb84-196">16</span><span class="sxs-lookup"><span data-stu-id="aeb84-196">16</span></span>|<span data-ttu-id="aeb84-197">是。</span><span class="sxs-lookup"><span data-stu-id="aeb84-197">Yes.</span></span>|  
|<span data-ttu-id="aeb84-198">64</span><span class="sxs-lookup"><span data-stu-id="aeb84-198">64</span></span>|<span data-ttu-id="aeb84-199">16</span><span class="sxs-lookup"><span data-stu-id="aeb84-199">16</span></span>|<span data-ttu-id="aeb84-200">16</span><span class="sxs-lookup"><span data-stu-id="aeb84-200">16</span></span>|<span data-ttu-id="aeb84-201">16</span><span class="sxs-lookup"><span data-stu-id="aeb84-201">16</span></span>|<span data-ttu-id="aeb84-202">否。</span><span class="sxs-lookup"><span data-stu-id="aeb84-202">No.</span></span>|  
  
 <span data-ttu-id="aeb84-203">由於無法事先知道是否可以同時成功執行多個作業，您應該只在一段時間內分析記憶體耗用量，並判斷通常伺服器記憶體都未充分利用之後，再增加並行作業數。</span><span class="sxs-lookup"><span data-stu-id="aeb84-203">Because there is no way to know in advance whether multiple jobs can run successfully at the same time, you should only increase the number of concurrent jobs after you have analyzed memory consumption over time and determined that server memory is generally underutilized.</span></span>  
  
 <span data-ttu-id="aeb84-204">每個資料重新整理工作都會有不同的負載特性，取決於進行重新整理的資料來源數量和大小。</span><span class="sxs-lookup"><span data-stu-id="aeb84-204">Each data refresh job will have different load characteristics depending on the number and size of the data sources that are being refreshed.</span></span> <span data-ttu-id="aeb84-205">含資料列數量較少之單一資料來源的活頁簿，其處理負載就遠比含無數資料來源與龐大資料列集的活頁簿輕得多。</span><span class="sxs-lookup"><span data-stu-id="aeb84-205">Workbooks that have a single data source with a smaller number of rows have a far lighter processing load than a workbook that has numerous data sources and very large row sets.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="aeb84-206">另請參閱</span><span class="sxs-lookup"><span data-stu-id="aeb84-206">See Also</span></span>  
 [<span data-ttu-id="aeb84-207">SharePoint 2010 中的 PowerPivot 資料重新整理</span><span class="sxs-lookup"><span data-stu-id="aeb84-207">PowerPivot Data Refresh with SharePoint 2010</span></span>](powerpivot-data-refresh-with-sharepoint-2010.md)  
  
  
