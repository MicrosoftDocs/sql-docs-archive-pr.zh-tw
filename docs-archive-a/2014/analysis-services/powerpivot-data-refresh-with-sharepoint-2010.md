---
title: PowerPivot 資料重新整理與 SharePoint 2010 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- unattended data refresh [Analysis Services with SharePoint]
- scheduled data refresh [Analysis Services with SharePoint]
- data refresh [Analysis Services with SharePoint]
ms.assetid: 01b54e6f-66e5-485c-acaa-3f9aa53119c9
author: minewiskan
ms.author: owend
ms.openlocfilehash: 01874bf521055d1441b695a238d09440021d2718
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87704385"
---
# <a name="powerpivot-data-refresh-with-sharepoint-2010"></a><span data-ttu-id="7fea0-102">SharePoint 2010 中的 PowerPivot 資料重新整理</span><span class="sxs-lookup"><span data-stu-id="7fea0-102">PowerPivot Data Refresh with SharePoint 2010</span></span>
  [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] <span data-ttu-id="7fea0-103">資料重新整理是一項查詢外部資料來源的排程伺服器端作業，可更新儲存在內容庫中 Excel 2010 活頁簿的內嵌 [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] 資料。</span><span class="sxs-lookup"><span data-stu-id="7fea0-103">t data refresh is a scheduled server-side operation that queries external data sources to update embedded [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] data in an Excel 2010 workbook that is stored in a content library.</span></span>

 <span data-ttu-id="7fea0-104">資料重新整理是 [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] for SharePoint 的內建功能，但您需要在 SharePoint 2010 伺服器陣列中執行特定服務和計時器工作才能使用它。</span><span class="sxs-lookup"><span data-stu-id="7fea0-104">Data refresh is a built-in feature of [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] for SharePoint, but using it requires that you run specific services and timer jobs in your SharePoint 2010 farm.</span></span> <span data-ttu-id="7fea0-105">此外，通常也需要額外的管理步驟 (例如安裝資料提供者及檢查資料庫權限)，資料重新整理才會成功。</span><span class="sxs-lookup"><span data-stu-id="7fea0-105">Additional administrative steps, such as installing data providers and checking database permissions, are often required for data refresh to succeed.</span></span>

 <span data-ttu-id="7fea0-106">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="7fea0-106">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>

> [!NOTE]
>  [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] <span data-ttu-id="7fea0-107">和 SharePoint Server 2013 Excel Services 會使用不同的架構來進行 [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] 資料模型的資料重新整理。</span><span class="sxs-lookup"><span data-stu-id="7fea0-107">and SharePoint Server 2013 Excel Services use a different architecture for data refresh of [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] data models.</span></span> <span data-ttu-id="7fea0-108">新的架構會運用 Excel Services 做為主要元件來載入 PowerPivot 資料模型。</span><span class="sxs-lookup"><span data-stu-id="7fea0-108">The new architecture utilizes Excel Services as the primary component to load PowerPivot data models.</span></span> <span data-ttu-id="7fea0-109">先前的資料重新整理架構會使用並仰賴在 SharePoint 模式下執行 PowerPivot 系統服務和 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 的伺服器來載入資料模型。</span><span class="sxs-lookup"><span data-stu-id="7fea0-109">The previous data refresh architecture used relied on a server running PowerPivot System Service and [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] in SharePoint mode to load data models.</span></span> <span data-ttu-id="7fea0-110">如需詳細資訊，請參閱[PowerPivot Data Refresh With SharePoint 2013](power-pivot-sharepoint/power-pivot-data-refresh-with-sharepoint-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="7fea0-110">For more information, see [PowerPivot Data Refresh with SharePoint 2013](power-pivot-sharepoint/power-pivot-data-refresh-with-sharepoint-2013.md).</span></span>

 <span data-ttu-id="7fea0-111">**本主題內容：**</span><span class="sxs-lookup"><span data-stu-id="7fea0-111">**In this topic:**</span></span>

 [<span data-ttu-id="7fea0-112">步驟1：啟用 Secure Store Service 並產生主要金鑰</span><span class="sxs-lookup"><span data-stu-id="7fea0-112">Step 1: Enable Secure Store Service and Generate a Master Key</span></span>](#bkmk_services)

 [<span data-ttu-id="7fea0-113">步驟 2：關閉您不想要支援的認證選項</span><span class="sxs-lookup"><span data-stu-id="7fea0-113">Step 2: Turn off credential options that you do not want to support</span></span>](#bkmk_creds)

 [<span data-ttu-id="7fea0-114">步驟 3：建立目標應用程式來儲存資料重新整理時所使用的認證</span><span class="sxs-lookup"><span data-stu-id="7fea0-114">Step 3: Create target applications to store credentials used in data refresh</span></span>](#bkmk_stored)

 [<span data-ttu-id="7fea0-115">步驟 4：針對可擴充的資料重新整理設定伺服器</span><span class="sxs-lookup"><span data-stu-id="7fea0-115">Step 4: Configure the server for scalable data refresh</span></span>](#bkmk_scale)

 [<span data-ttu-id="7fea0-116">步驟 5：安裝用於匯入 PowerPivot 資料的資料提供者</span><span class="sxs-lookup"><span data-stu-id="7fea0-116">Step 5: Install Data Providers Used to Import PowerPivot Data</span></span>](#bkmk_installdp)

 [<span data-ttu-id="7fea0-117">步驟 6：授與建立排程及存取外部資料來源的權限</span><span class="sxs-lookup"><span data-stu-id="7fea0-117">Step 6: Grant permissions to create schedules and access external data sources</span></span>](#bkmk_accounts)

 [<span data-ttu-id="7fea0-118">步驟 7：針對資料重新整理啟用活頁簿升級</span><span class="sxs-lookup"><span data-stu-id="7fea0-118">Step 7: Enable workbook upgrade for data refresh</span></span>](#bkmk_upgradewrkbk)

 [<span data-ttu-id="7fea0-119">步驟 8：驗認資料重新整理組態</span><span class="sxs-lookup"><span data-stu-id="7fea0-119">Step 8: Verify data refresh configuration</span></span>](#bkmk_verify)

 [<span data-ttu-id="7fea0-120">針對資料重新整理修改組態設定</span><span class="sxs-lookup"><span data-stu-id="7fea0-120">Modify Configuration Settings for Data Refresh</span></span>](#bkmk_config)

 [<span data-ttu-id="7fea0-121">重新排程 PowerPivot 資料重新整理計時器工作</span><span class="sxs-lookup"><span data-stu-id="7fea0-121">Reschedule the PowerPivot Data Refresh timer job</span></span>](#configTimerJob)

 [<span data-ttu-id="7fea0-122">停用資料重新整理計時器工作</span><span class="sxs-lookup"><span data-stu-id="7fea0-122">Disable the Data Refresh Timer Job</span></span>](#bkmk_disableDR)

 <span data-ttu-id="7fea0-123">在確定伺服器環境和權限已設定之後，資料重新整理已備妥可供使用。</span><span class="sxs-lookup"><span data-stu-id="7fea0-123">After you ensure that the server environment and permissions are configured, data refresh is ready to use.</span></span> <span data-ttu-id="7fea0-124">若要使用資料重新整理，SharePoint 使用者必須建立 PowerPivot 活頁簿的排程，指定進行資料重新整理的頻率。</span><span class="sxs-lookup"><span data-stu-id="7fea0-124">To use data refresh, a SharePoint user creates a schedule on a PowerPivot workbook that specifies how often data refresh occurs.</span></span> <span data-ttu-id="7fea0-125">排程建立通常是由發行檔案至 SharePoint 的活頁簿擁有者或作者所完成。</span><span class="sxs-lookup"><span data-stu-id="7fea0-125">Creating the schedule is typically done by the workbook owner or author who published the file to SharePoint.</span></span> <span data-ttu-id="7fea0-126">這位人員會建立並管理他所擁有之活頁簿的資料重新整理排程。</span><span class="sxs-lookup"><span data-stu-id="7fea0-126">This person creates and manages the data refresh schedules for the workbooks that he or she owns.</span></span> <span data-ttu-id="7fea0-127">如需詳細資訊，請參閱[排程資料重新整理 &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="7fea0-127">For more information, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>

##  <a name="step-1-enable-secure-store-service-and-generate-a-master-key"></a><a name="bkmk_services"></a><span data-ttu-id="7fea0-128">步驟1：啟用 Secure Store Service 並產生主要金鑰</span><span class="sxs-lookup"><span data-stu-id="7fea0-128">Step 1: Enable Secure Store Service and Generate a Master Key</span></span>
 <span data-ttu-id="7fea0-129">PowerPivot 資料重新整理功能仰賴 Secure Store Service 提供認證以供執行資料重新整理作業，以及連接至使用預存認證的外部資料來源之用。</span><span class="sxs-lookup"><span data-stu-id="7fea0-129">PowerPivot data refresh depends on Secure Store Service to provide credentials used to run data refresh jobs and to connect to external data sources that use stored credentials.</span></span>

 <span data-ttu-id="7fea0-130">您若是使用 [新伺服器] 選項安裝 PowerPivot for SharePoint，即會為您設定 Secure Store Service。</span><span class="sxs-lookup"><span data-stu-id="7fea0-130">If you installed PowerPivot for SharePoint using the New Server option, the Secure Store Service is configured for you.</span></span> <span data-ttu-id="7fea0-131">除此之外的其他安裝狀況皆須建立及設定服務應用程式，並產生 Secure Store Service 的主要加密金鑰。</span><span class="sxs-lookup"><span data-stu-id="7fea0-131">For all other installation scenarios, you must create and configure a service application and generate a master encryption key for Secure Store Service.</span></span>

> [!NOTE]
>  <span data-ttu-id="7fea0-132">您必須是伺服器陣列管理員才能設定 Secure Store Service，或是將 Secure Store Service 管理委派給其他使用者。</span><span class="sxs-lookup"><span data-stu-id="7fea0-132">You must be a farm administrator to configure Secure Store Service or delegate Secure Store Service administration to another user.</span></span> <span data-ttu-id="7fea0-133">您必須是服務應用程式管理員，才能在啟用後設定或修改設定值。</span><span class="sxs-lookup"><span data-stu-id="7fea0-133">You must be a service application administrator to configure or modify settings after it is enabled.</span></span>

1.  <span data-ttu-id="7fea0-134">在 [管理中心] 的 [應用程式管理] 中，按一下 **[管理服務應用程式]** 。</span><span class="sxs-lookup"><span data-stu-id="7fea0-134">In Central Administration, in Application Management, click **Manage service applications**.</span></span>

2.  <span data-ttu-id="7fea0-135">在 [服務應用程式] 功能區的 [建立] 中，按一下 [**新增**]。</span><span class="sxs-lookup"><span data-stu-id="7fea0-135">In the Service Applications ribbon, in Create, click **New**.</span></span>

3.  <span data-ttu-id="7fea0-136">選取 [ **Secure Store Service**]。</span><span class="sxs-lookup"><span data-stu-id="7fea0-136">Select **Secure Store Service**.</span></span>

4.  <span data-ttu-id="7fea0-137">在 [**建立 Secure Store 應用程式**] 頁面中，輸入應用程式的名稱。</span><span class="sxs-lookup"><span data-stu-id="7fea0-137">In the **Create Secure Store Application** page, enter a name for the application.</span></span>

5.  <span data-ttu-id="7fea0-138">在 [**資料庫**] 中，指定將裝載此服務應用程式之資料庫的 SQL Server 實例。</span><span class="sxs-lookup"><span data-stu-id="7fea0-138">In **Database**, specify the SQL Server instance that will host the database for this service application.</span></span> <span data-ttu-id="7fea0-139">預設值是主控伺服陣列組態資料庫的 SQL Server Database Engine 執行個體。</span><span class="sxs-lookup"><span data-stu-id="7fea0-139">The default value is the SQL Server Database Engine instance that hosts the farm configuration databases.</span></span>

6.  <span data-ttu-id="7fea0-140">在 [**資料庫名稱**] 中，輸入服務應用程式資料庫的名稱。</span><span class="sxs-lookup"><span data-stu-id="7fea0-140">In **Database Name**, enter the name of the service application database.</span></span> <span data-ttu-id="7fea0-141">預設值為 Secure_Store_Service_DB_ \<guid> 。</span><span class="sxs-lookup"><span data-stu-id="7fea0-141">The default value is Secure_Store_Service_DB_\<guid>.</span></span> <span data-ttu-id="7fea0-142">預設名稱會對應至服務應用程式的預設名稱。</span><span class="sxs-lookup"><span data-stu-id="7fea0-142">The default name corresponds to the default name of the service application.</span></span> <span data-ttu-id="7fea0-143">如果您輸入唯一的服務應用程式名稱，請依照類似的命名慣例來命名資料庫名稱，以利同時管理它們。</span><span class="sxs-lookup"><span data-stu-id="7fea0-143">If you entered a unique service application name, follow a similar naming convention for your database name so that you can manage them together.</span></span>

7.  <span data-ttu-id="7fea0-144">在 **[資料庫驗證]** 中，預設值是 Windows 驗證。</span><span class="sxs-lookup"><span data-stu-id="7fea0-144">In **Database Authentication**, the default is Windows Authentication.</span></span> <span data-ttu-id="7fea0-145">如果您選擇 [SQL 驗證]，請參考 SharePoint 管理員指南，以取得如何在伺服陣列中使用這個驗證類型的指引。</span><span class="sxs-lookup"><span data-stu-id="7fea0-145">If you choose SQL Authentication, refer to the SharePoint administrator guide for guidance on how to use the authentication type in your farm.</span></span>

8.  <span data-ttu-id="7fea0-146">在應用程式集區中，選取 [**建立新應用程式集**區]。</span><span class="sxs-lookup"><span data-stu-id="7fea0-146">In Application Pool, select **Create new application pool.**</span></span> <span data-ttu-id="7fea0-147">指定描述性名稱，將可協助其他伺服器系統管理員識別如何使用應用程式集區。</span><span class="sxs-lookup"><span data-stu-id="7fea0-147">Specify a descriptive name that will help other server administrators identify how the application pool is used.</span></span>

9. <span data-ttu-id="7fea0-148">選取應用程式集區的安全性帳戶。</span><span class="sxs-lookup"><span data-stu-id="7fea0-148">Select a security account for the application pool.</span></span> <span data-ttu-id="7fea0-149">指定受管理的帳戶，以使用網域使用者帳戶。</span><span class="sxs-lookup"><span data-stu-id="7fea0-149">Specify a managed account to use a domain user account.</span></span>

10. <span data-ttu-id="7fea0-150">接受其餘的預設值，然後按一下 **[確定]。**</span><span class="sxs-lookup"><span data-stu-id="7fea0-150">Accept the remaining default values, and then click **OK.**</span></span> <span data-ttu-id="7fea0-151">服務應用程式將會和伺服陣列的服務應用程式清單中其他受管理的服務一起並排顯示。</span><span class="sxs-lookup"><span data-stu-id="7fea0-151">The service application will appear alongside other managed services in the farm's service application list.</span></span>

11. <span data-ttu-id="7fea0-152">從清單按一下 Secure Store Service 應用程式。</span><span class="sxs-lookup"><span data-stu-id="7fea0-152">Click the Secure Store Service application from the list.</span></span>

12. <span data-ttu-id="7fea0-153">在 [服務應用程式] 功能區中，按一下 [**管理**]。</span><span class="sxs-lookup"><span data-stu-id="7fea0-153">In the Service Applications ribbon, click **Manage**.</span></span>

13. <span data-ttu-id="7fea0-154">在 [金鑰管理] 中，按一下 [**產生新金鑰**]。</span><span class="sxs-lookup"><span data-stu-id="7fea0-154">In Key Management, click **Generate New Key**.</span></span>

14. <span data-ttu-id="7fea0-155">輸入複雜密碼，然後進行確認。</span><span class="sxs-lookup"><span data-stu-id="7fea0-155">Enter and then confirm a pass phrase.</span></span> <span data-ttu-id="7fea0-156">此複雜密碼將用來加入其他安全存放共用服務應用程式。</span><span class="sxs-lookup"><span data-stu-id="7fea0-156">The pass phrase will be used to add additional secure store shared service applications.</span></span>

15. <span data-ttu-id="7fea0-157">按一下 [確定]  。</span><span class="sxs-lookup"><span data-stu-id="7fea0-157">Click **OK**.</span></span>

 <span data-ttu-id="7fea0-158">可供疑難排解之用的 Store Service 作業稽核記錄必須在作業開始之前啟用。</span><span class="sxs-lookup"><span data-stu-id="7fea0-158">Audit logging of Store Service operations, which is useful for troubleshooting purposes, must be enabled before it is available.</span></span> <span data-ttu-id="7fea0-159">如需如何啟用記錄的詳細資訊，請參閱[ (SharePoint 2010) 設定 Secure Store Service ](https://go.microsoft.com/fwlink/p/?LinkID=223294)。</span><span class="sxs-lookup"><span data-stu-id="7fea0-159">For more information about how to enable logging, see [Configure Secure Store Service (SharePoint 2010)](https://go.microsoft.com/fwlink/p/?LinkID=223294).</span></span>

##  <a name="step-2-turn-off-credential-options-that-you-do-not-want-to-support"></a><a name="bkmk_creds"></a><span data-ttu-id="7fea0-160">步驟2：關閉您不想要支援的認證選項</span><span class="sxs-lookup"><span data-stu-id="7fea0-160">Step 2: Turn off credential options that you do not want to support</span></span>
 <span data-ttu-id="7fea0-161">PowerPivot 資料重新整理在資料重新整理排程方面提供三種認證。</span><span class="sxs-lookup"><span data-stu-id="7fea0-161">PowerPivot data refresh provides three credential options in a data refresh schedule.</span></span> <span data-ttu-id="7fea0-162">當活頁簿擁有者排程資料重新整理時，必須從中選擇一個選項，以決定執行資料重新整理作業時所要使用的帳戶。</span><span class="sxs-lookup"><span data-stu-id="7fea0-162">When a workbook owner schedules data refresh, he or she chooses one of these options, thereby determining the account under which the data refresh job runs.</span></span> <span data-ttu-id="7fea0-163">您身為管理員，可以決定排程擁有者所能使用的認證選項。</span><span class="sxs-lookup"><span data-stu-id="7fea0-163">As an administrator, you can determine which credential options are available to schedule owners.</span></span>

 <span data-ttu-id="7fea0-164">您至少必須提供一個選項，資料重新整理功能才能運作。</span><span class="sxs-lookup"><span data-stu-id="7fea0-164">You must have at least one option that is available in order for data refresh to work.</span></span>

 <span data-ttu-id="7fea0-165">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="7fea0-165">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span></span>

 <span data-ttu-id="7fea0-166">選項1：**使用系統管理員所設定的資料**重新整理帳戶，一律會出現在排程定義頁面上，但只有在您設定自動資料重新整理帳戶時才有效。</span><span class="sxs-lookup"><span data-stu-id="7fea0-166">Option 1, **Use the data refresh account configured by the administrator**, always appears on the schedule definition page, but only works if you configure the unattended data refresh account.</span></span> <span data-ttu-id="7fea0-167">如需如何建立帳戶的詳細資訊，請參閱[設定 PowerPivot 無人看管的資料重新整理帳戶 &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="7fea0-167">For more information on how to create the account, see [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>

 <span data-ttu-id="7fea0-168">選項2：**使用下列 windows 認證進行連接**：一律會顯示在頁面上，但只有當您啟用 [服務應用程式設定] 頁面中的 [**允許使用者輸入自訂的 windows 認證**] 選項時才有效。</span><span class="sxs-lookup"><span data-stu-id="7fea0-168">Option 2, **Connect using the following windows credentials**, always appears on the page, but only works when you enable the **Allow users to enter custom Windows credentials** option in the service application configuration page.</span></span> <span data-ttu-id="7fea0-169">預設會啟用此選項，但如果啟用此選項對您而言壞處多於好處，也可予以停用 (請參閱下文)。</span><span class="sxs-lookup"><span data-stu-id="7fea0-169">This option is enabled by default, but you can disable it if the disadvantages of using it outweigh the advantages (see below).</span></span>

 <span data-ttu-id="7fea0-170">選項3：**使用儲存在 Secure Store Service 中的認證進行連接**，一律會顯示在頁面上，但只有在排程擁有者提供有效的目標應用程式時才適用。</span><span class="sxs-lookup"><span data-stu-id="7fea0-170">Option 3, **Connect using the credentials saved in Secure Store Service**, always appears on the page, but only works when a schedule owner provides a valid target application.</span></span> <span data-ttu-id="7fea0-171">管理員必須事先建立這些目標應用程式，然後將應用程式名稱提供給建立資料重新整理排程的使用者。</span><span class="sxs-lookup"><span data-stu-id="7fea0-171">An administrator must create these target applications in advance and then provide the application name to those who create the data refresh schedules.</span></span> <span data-ttu-id="7fea0-172">如需如何建立資料重新整理作業之目標應用程式的詳細資訊，請參閱[設定 PowerPivot 資料重新整理的預存認證 &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="7fea0-172">For more information on how to create a target application for data refresh operations, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>

 <span data-ttu-id="7fea0-173">**設定認證選項2：「使用下列 Windows 使用者認證連接」**</span><span class="sxs-lookup"><span data-stu-id="7fea0-173">**Configuring credential option 2, "Connect using the following Windows user credentials"**</span></span>

 <span data-ttu-id="7fea0-174">PowerPivot 服務應用程式所包含的認證選項可允許排程擁有者輸入任意的 Windows 使用者名稱及密碼，以執行資料重新整理作業。</span><span class="sxs-lookup"><span data-stu-id="7fea0-174">PowerPivot service application includes a credential option that allows schedule owners to enter an arbitrary Windows user name and password for running a data refresh job.</span></span> <span data-ttu-id="7fea0-175">此選項是排程定義頁面的第二個認證選項：</span><span class="sxs-lookup"><span data-stu-id="7fea0-175">This is the second credential option in the schedule definition page:</span></span>

 <span data-ttu-id="7fea0-176">![SSAS_PPS_ScheduleDataRefreshCreds](media/ssas-pps-scheduledatarefreshcreds.gif "SSAS_PPS_ScheduleDataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="7fea0-176">![SSAS_PPS_ScheduleDataRefreshCreds](media/ssas-pps-scheduledatarefreshcreds.gif "SSAS_PPS_ScheduleDataRefreshCreds")</span></span>

 <span data-ttu-id="7fea0-177">預設會啟用這個認證選項。</span><span class="sxs-lookup"><span data-stu-id="7fea0-177">This credential option is enabled by default.</span></span> <span data-ttu-id="7fea0-178">啟用此認證選項之後，PowerPivot 系統服務會在 Secure Store Service 中產生目標應用程式，以儲存排程擁有者所輸入的使用者名稱及密碼。</span><span class="sxs-lookup"><span data-stu-id="7fea0-178">When this credential option is enabled, PowerPivot System Service will generate a target application in Secure Store Service to store the user name and password entered by the schedule owner.</span></span> <span data-ttu-id="7fea0-179">產生的目標應用程式會使用此命名慣例來建立： PowerPivotDataRefresh_ \<guid> 。</span><span class="sxs-lookup"><span data-stu-id="7fea0-179">A generated target application is created using this naming convention: PowerPivotDataRefresh_\<guid>.</span></span> <span data-ttu-id="7fea0-180">每一組 Windows 認證各會建立一個目標應用程式。</span><span class="sxs-lookup"><span data-stu-id="7fea0-180">One target application is created for each set of Windows credentials.</span></span> <span data-ttu-id="7fea0-181">假使 PowerPivot 系統服務已有目標應用程式可以用於儲存排程定義者所輸入的使用者名稱及密碼，PowerPivot 系統服務將會使用該目標應用程式，而不會建立新的目標應用程式。</span><span class="sxs-lookup"><span data-stu-id="7fea0-181">If a target application already exists that is owned by the PowerPivot System Service and stores the username and password entered by the person defining the schedule, PowerPivot System Service will use that target application rather than create a new one.</span></span>

 <span data-ttu-id="7fea0-182">此認證選項的主要優點在於簡單易用。</span><span class="sxs-lookup"><span data-stu-id="7fea0-182">The primary advantage of using this credential option is ease of use and simplicity.</span></span> <span data-ttu-id="7fea0-183">因為它會為您建立目標應用程式，所以不太需要額外的工夫。</span><span class="sxs-lookup"><span data-stu-id="7fea0-183">Advance work is minimal because target applications are created for you.</span></span> <span data-ttu-id="7fea0-184">除此之外，使用排程擁有者 (極有可能是活頁簿的建立者) 的認證執行資料重新整理也可簡化下游的權限需求。</span><span class="sxs-lookup"><span data-stu-id="7fea0-184">Also, running data refresh under the credentials of the schedule owner (who is most likely the person who created the workbook) simplifies permission requirements downstream.</span></span> <span data-ttu-id="7fea0-185">此使用者極有可能已經具備目標資料庫的權限。</span><span class="sxs-lookup"><span data-stu-id="7fea0-185">Most likely, this user already has permissions on the target database.</span></span> <span data-ttu-id="7fea0-186">當資料重新整理以此人的 Windows 使用者身分識別執行時，任何指定「目前使用者」的資料連線都會自動運作。</span><span class="sxs-lookup"><span data-stu-id="7fea0-186">When data refresh runs under this person's Windows user identity, any data connections that specify 'current user' will work automatically.</span></span>

 <span data-ttu-id="7fea0-187">其缺點是管理能力有限。</span><span class="sxs-lookup"><span data-stu-id="7fea0-187">The disadvantage is limited management capability.</span></span> <span data-ttu-id="7fea0-188">雖然會自動建立目標應用程式，但卻不會隨著帳戶資訊變更而自動刪除或更新。</span><span class="sxs-lookup"><span data-stu-id="7fea0-188">Although target applications are created automatically, they are not deleted automatically or updated as account information changes.</span></span> <span data-ttu-id="7fea0-189">密碼到期原則可能會造成目標應用程式過期。</span><span class="sxs-lookup"><span data-stu-id="7fea0-189">Password expiration policies might cause these target applications to become out of date.</span></span> <span data-ttu-id="7fea0-190">使用過期認證的資料重新整理作業將無法啟動。</span><span class="sxs-lookup"><span data-stu-id="7fea0-190">Data refresh jobs that use expired credentials will start to fail.</span></span> <span data-ttu-id="7fea0-191">當發生此狀況時，排程擁有者必須在資料重新整理排程中提供目前的使用者名稱及密碼值，以更新其認證。</span><span class="sxs-lookup"><span data-stu-id="7fea0-191">When this occurs, schedule owners will need to update their credentials by providing current user name and password values in a data refresh schedule.</span></span> <span data-ttu-id="7fea0-192">如此之後，即會建立新的目標應用程式。</span><span class="sxs-lookup"><span data-stu-id="7fea0-192">A new target application will be created at that point.</span></span> <span data-ttu-id="7fea0-193">使用者會在其資料重新整理排程中加入及修訂認證資訊，因此，在經過一段時間之後，您的系統上可能會出現大量自動產生的目標應用程式。</span><span class="sxs-lookup"><span data-stu-id="7fea0-193">Over time, as users add and revise credential information in their data refresh schedules, you might find that you have a large number of auto-generated target applications on your system.</span></span>

 <span data-ttu-id="7fea0-194">目前尚無法區分使用中及非使用中的目標應用程式，也無法循著特定的目標應用程式追溯回使用該目標應用程式的資料重新整理排程。</span><span class="sxs-lookup"><span data-stu-id="7fea0-194">Currently, there is no way to determine which of these target applications are active or inactive, nor is there a way to trace a specific target application back to the data refresh schedules that use it.</span></span> <span data-ttu-id="7fea0-195">一般而言，您應保留這些目標應用程式，因為刪除這些應用程式可能會破壞現有的資料重新整理排程。</span><span class="sxs-lookup"><span data-stu-id="7fea0-195">In general, you should leave the target applications alone, as deleting them might break existing data refresh schedules.</span></span> <span data-ttu-id="7fea0-196">刪除仍在使用中的目標應用程式會導致資料重新整理失敗，並顯示「找不到目標應用程式」訊息，出現在活頁簿的資料重新整理記錄頁面中。</span><span class="sxs-lookup"><span data-stu-id="7fea0-196">Deleting a target application that is still in use will cause data refresh to fail with the message, "Target application not found", appearing in the data refresh history page of the workbook.</span></span>

 <span data-ttu-id="7fea0-197">您若是選擇停用此認證選項，可以放心刪除針對 PowerPivot 資料重新整理所產生的所有目標應用程式。</span><span class="sxs-lookup"><span data-stu-id="7fea0-197">Should you choose to disable this credential option, you can safely delete all of the target applications that were generated for PowerPivot data refresh.</span></span>

 <span data-ttu-id="7fea0-198">**不允許在資料重新整理排程中使用任意的 Windows 認證**</span><span class="sxs-lookup"><span data-stu-id="7fea0-198">**Disabling the use of arbitrary Windows credentials in data refresh schedules**</span></span>

1.  <span data-ttu-id="7fea0-199">在 [管理中心] 的 [應用程式管理] 中，按一下 [**管理服務應用程式**]。</span><span class="sxs-lookup"><span data-stu-id="7fea0-199">In Central Administration, in Application Management, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="7fea0-200">按一下 PowerPivot 服務應用程式名稱。</span><span class="sxs-lookup"><span data-stu-id="7fea0-200">Click the PowerPivot service application name.</span></span> <span data-ttu-id="7fea0-201">隨即出現 PowerPivot 管理儀表板。</span><span class="sxs-lookup"><span data-stu-id="7fea0-201">The PowerPivot Management Dashboard appears.</span></span>

3.  <span data-ttu-id="7fea0-202">在 [動作] 中，按一下 [**設定服務應用程式設定**] 以開啟 [PowerPivot 服務應用程式設定] 頁面</span><span class="sxs-lookup"><span data-stu-id="7fea0-202">In Actions, click **Configure service application settings** to open the PowerPivot Service Application Settings page</span></span>

4.  <span data-ttu-id="7fea0-203">在 [資料重新整理] 區段中，清除 [**允許使用者輸入自訂的 Windows 認證**] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="7fea0-203">In the Data Refresh section, clear the **Allow users to enter custom Windows credentials** checkbox.</span></span>

     <span data-ttu-id="7fea0-204">![SSAS_PowerPivotDatarefreshOptions_AllowUser](media/ssas-powerpivotdatarefreshoptions-allowuser.gif "SSAS_PowerPivotDatarefreshOptions_AllowUser")</span><span class="sxs-lookup"><span data-stu-id="7fea0-204">![SSAS_PowerPivotDatarefreshOptions_AllowUser](media/ssas-powerpivotdatarefreshoptions-allowuser.gif "SSAS_PowerPivotDatarefreshOptions_AllowUser")</span></span>

##  <a name="step-3-create-target-applications-to-store-credentials-used-in-data-refresh"></a><a name="bkmk_stored"></a><span data-ttu-id="7fea0-205">步驟3：建立目標應用程式來儲存資料重新整理時所使用的認證</span><span class="sxs-lookup"><span data-stu-id="7fea0-205">Step 3: Create target applications to store credentials used in data refresh</span></span>
 <span data-ttu-id="7fea0-206">當您設定 Secure Store Service 之後，SharePoint 管理員即可建立目標應用程式，將預存認證提供給資料重新整理作業使用，包括 PowerPivot 自動資料重新整理帳戶，或是其他用於執行此作業或連接至外部資料來源的帳戶。</span><span class="sxs-lookup"><span data-stu-id="7fea0-206">Once Secure Store Service is configured, SharePoint administrators can create target applications to make stored credentials available for data refresh purposes, including the PowerPivot unattended data refresh account or any other account that is used to either run the job or connect to external data sources.</span></span>

 <span data-ttu-id="7fea0-207">一如前文所述，您必須建立目標應用程式，才可使用某些認證選項。</span><span class="sxs-lookup"><span data-stu-id="7fea0-207">Recall from the previous section that you need to create target applications in order for certain credential options to be usable.</span></span> <span data-ttu-id="7fea0-208">特別是您必須為 PowerPivot 自動資料重新整理帳戶建立目標應用程式，以及其他您要在資料重新整理作業中使用的預存認證。</span><span class="sxs-lookup"><span data-stu-id="7fea0-208">Specifically, you must create target applications for the PowerPivot unattended data refresh account, plus any additional stored credentials that you expect would be used in data refresh operations.</span></span>

 <span data-ttu-id="7fea0-209">如需如何建立包含預存認證之目標應用程式的詳細資訊，請參閱[設定 Powerpivot 無人看管的資料重新整理帳戶 &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md)並[設定 powerpivot 資料重新整理的預存認證 &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="7fea0-209">For more information about how to create target applications that contain stored credentials, see [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) and [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>

##  <a name="step-4-configure-the-server-for-scalable-data-refresh"></a><a name="bkmk_scale"></a><span data-ttu-id="7fea0-210">步驟4：設定伺服器以進行可調整的資料重新整理</span><span class="sxs-lookup"><span data-stu-id="7fea0-210">Step 4: Configure the server for scalable data refresh</span></span>
 <span data-ttu-id="7fea0-211">每個 PowerPivot for SharePoint 安裝預設都會支援視需要的查詢及排程資料重新整理功能。</span><span class="sxs-lookup"><span data-stu-id="7fea0-211">By default, each PowerPivot for SharePoint installation supports both on-demand queries and scheduled data refresh.</span></span>

 <span data-ttu-id="7fea0-212">您可為每個安裝指定 Analysis Services 伺服器執行個體要同時支援查詢與排程資料重新整理功能，或只要執行某種特定類型的作業。</span><span class="sxs-lookup"><span data-stu-id="7fea0-212">For each installation, you can specify whether the Analysis Services server instance supports both query and scheduled data refresh, or is dedicated to a specific type of operation.</span></span> <span data-ttu-id="7fea0-213">您的伺服器陣列中如有多個 PowerPivot for SharePoint 安裝，而且作業出現延遲或失敗的狀況，也可考慮使用專用的伺服器執行資料重新整理作業。</span><span class="sxs-lookup"><span data-stu-id="7fea0-213">If you have multiple installations of PowerPivot for SharePoint in your farm, you might consider dedicating a server for just data refresh operations if you find that jobs are delayed or failing.</span></span>

 <span data-ttu-id="7fea0-214">除此之外，在基礎硬體支援的情況下，也可增加並行執行的資料重新整理作業數目。</span><span class="sxs-lookup"><span data-stu-id="7fea0-214">Additionally, if the underlying hardware supports it, you can increase the number of data refresh jobs that run in parallel.</span></span> <span data-ttu-id="7fea0-215">可並行執行的作業數目預設會依據系統記憶體進行計算，但您如有加裝額外的 CPU 可以負荷此工作量，也可提高該數目。</span><span class="sxs-lookup"><span data-stu-id="7fea0-215">By default, the number of jobs that can run in parallel is calculated based on system memory, but you can increase that number if you have additional CPU capacity to support the workload.</span></span>

 <span data-ttu-id="7fea0-216">如需詳細資訊，請參閱[設定專用資料重新整理或僅查詢處理 &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="7fea0-216">For more information, see [Configure Dedicated Data Refresh or Query-Only Processing &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span></span>

##  <a name="step-5-install-data-providers-used-to-import-powerpivot-data"></a><a name="bkmk_installdp"></a><span data-ttu-id="7fea0-217">步驟5：安裝用來匯入 PowerPivot 資料的資料提供者</span><span class="sxs-lookup"><span data-stu-id="7fea0-217">Step 5: Install Data Providers Used to Import PowerPivot Data</span></span>
 <span data-ttu-id="7fea0-218">資料重新整理作業基本上就是重複擷取原始資料的匯入作業。</span><span class="sxs-lookup"><span data-stu-id="7fea0-218">A data refresh operation is essentially a repeat of an import operation that retrieved the original data.</span></span> <span data-ttu-id="7fea0-219">這表示，用於在 PowerPivot 用戶端應用程式中匯入資料的相同資料提供者也必須安裝在 PowerPivot 伺服器上。</span><span class="sxs-lookup"><span data-stu-id="7fea0-219">This means that the same data providers used to import the data in the PowerPivot client application must also be installed on the PowerPivot server.</span></span>

 <span data-ttu-id="7fea0-220">您必須是本機系統管理員，才能在 Windows 伺服器上安裝資料提供者。</span><span class="sxs-lookup"><span data-stu-id="7fea0-220">You must be a local administrator to install data providers on a Windows server.</span></span> <span data-ttu-id="7fea0-221">您若是安裝其他驅動程式，請務必在安裝有 PowerPivot for SharePoint 之 SharePoint 伺服器陣列的每部電腦上安裝這些驅動程式。</span><span class="sxs-lookup"><span data-stu-id="7fea0-221">If you install additional drivers, be sure to install them on each computer in the SharePoint farm that has an installation of PowerPivot for SharePoint.</span></span> <span data-ttu-id="7fea0-222">如果伺服器陣列中有多部 PowerPivot 伺服器，您就必須在每部伺服器上安裝提供者。</span><span class="sxs-lookup"><span data-stu-id="7fea0-222">If you have multiple PowerPivot servers in the farm, you must install the providers on each one.</span></span>

 <span data-ttu-id="7fea0-223">請記住，SharePoint 伺服器是 64 位元應用程式。</span><span class="sxs-lookup"><span data-stu-id="7fea0-223">Remember that SharePoint servers are 64-bit applications.</span></span> <span data-ttu-id="7fea0-224">請務必安裝您所使用的 64 位元版資料提供者來支援資料重新整理作業。</span><span class="sxs-lookup"><span data-stu-id="7fea0-224">Be sure to install the 64-bit version of the data providers you are using to support data refresh operations.</span></span>

##  <a name="step-6-grant-permissions-to-create-schedules-and-access-external-data-sources"></a><a name="bkmk_accounts"></a><span data-ttu-id="7fea0-225">步驟6：授與建立排程及存取外部資料源的許可權</span><span class="sxs-lookup"><span data-stu-id="7fea0-225">Step 6: Grant permissions to create schedules and access external data sources</span></span>
 <span data-ttu-id="7fea0-226">活頁簿擁有者或作者必須具備 **[參與]** 權限，才能排程活頁簿的資料重新整理。</span><span class="sxs-lookup"><span data-stu-id="7fea0-226">Workbook owners or authors must have **Contribute** permission to schedule data refresh on a workbook.</span></span> <span data-ttu-id="7fea0-227">基於此許可權等級，他或她可以開啟和編輯活頁簿的 [資料重新整理] 設定頁面，以指定用來重新整理資料的認證和排程資訊。</span><span class="sxs-lookup"><span data-stu-id="7fea0-227">Given this permission level, he or she can open and edit the workbook's data refresh configuration page to specify the credentials and schedule information used to refresh the data.</span></span>

 <span data-ttu-id="7fea0-228">除了 SharePoint 權限之外，也必須檢閱外部資料來源的資料庫權限，確保重新整理資料期間所使用的帳戶，也具備足夠的權限可以存取資料。</span><span class="sxs-lookup"><span data-stu-id="7fea0-228">In addition to SharePoint permissions, database permissions on external data sources must also be reviewed to ensure that accounts used during data refresh have sufficient access rights to the data.</span></span> <span data-ttu-id="7fea0-229">決定權限需求時應謹慎評估，因為您所要授與的權限會隨活頁簿中的連接字串，以及執行資料重新整理作業時所用的使用者識別而不同。</span><span class="sxs-lookup"><span data-stu-id="7fea0-229">Determining permission requirements will require careful evaluation on your part because the permissions that you need to grant will vary depending on the connection string in the workbook and the user identity under which the data refresh job is running.</span></span>

 <span data-ttu-id="7fea0-230">**PowerPivot 活頁簿中現有的連接字串與 PowerPivot 資料重新整理作業之間的關係**</span><span class="sxs-lookup"><span data-stu-id="7fea0-230">**Why existing connection strings in a PowerPivot workbook matter to PowerPivot data refresh operations**</span></span>

 <span data-ttu-id="7fea0-231">當資料重新整理執行時，伺服器會傳送連接要求給使用一開始匯入資料時所建立之連接字串的外部資料來源。</span><span class="sxs-lookup"><span data-stu-id="7fea0-231">When data refresh runs, the server sends a connection request to the external data source using the connection string that was created when the data was originally imported.</span></span> <span data-ttu-id="7fea0-232">資料重新整理期間將會重複使用該連接字串中所指定的伺服器位置、資料庫名稱及驗證參數，以存取相同的資料來源。</span><span class="sxs-lookup"><span data-stu-id="7fea0-232">The server location, database name, and authentication parameters specified in that connection string are now reused during data refresh to access the same data sources.</span></span> <span data-ttu-id="7fea0-233">您無法針對不同的資料重新整理用途，修改連接字串及其整體建構，</span><span class="sxs-lookup"><span data-stu-id="7fea0-233">The connection string and its overall construction cannot be modified for data refresh purposes.</span></span> <span data-ttu-id="7fea0-234">只可以現況重複用於資料重新整理。</span><span class="sxs-lookup"><span data-stu-id="7fea0-234">It is simply reused as-is during data refresh.</span></span> <span data-ttu-id="7fea0-235">在某些情況下，您若是使用 Windows 以外的驗證方式連接資料來源，可以覆寫連接字串中的使用者名稱及密碼。</span><span class="sxs-lookup"><span data-stu-id="7fea0-235">In some cases, if you are using non-Windows authentication to connect to a data source, you can override the user name and password in the connection string.</span></span> <span data-ttu-id="7fea0-236">本主題將會就此提供進一步的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="7fea0-236">More detail about this is provided further on in this topic.</span></span>

 <span data-ttu-id="7fea0-237">對於大多數的活頁簿而言，連接時的預設驗證選項是使用信任的連接或 Windows 整合式安全性，因此連接字串中會包含 `SSPI=IntegratedSecurity` 或 `SSPI=TrustedConnection`。</span><span class="sxs-lookup"><span data-stu-id="7fea0-237">For most workbooks, the default authentication option on the connection is to use trusted connections or Windows integrated security, resulting in connection strings that include `SSPI=IntegratedSecurity` or `SSPI=TrustedConnection`.</span></span> <span data-ttu-id="7fea0-238">在資料重新整理期間使用此連接字串時，用來執行資料重新整理工作的帳戶會變成「目前使用者」。</span><span class="sxs-lookup"><span data-stu-id="7fea0-238">When this connection string is used during data refresh, the account used to run the data refresh job becomes the 'current user'.</span></span> <span data-ttu-id="7fea0-239">因此，該帳戶必須有權讀取所有透過信任連接進行存取的外部資料來源。</span><span class="sxs-lookup"><span data-stu-id="7fea0-239">As such, this account needs read permissions on any external data source that is accessed via a trusted connection.</span></span>

 <span data-ttu-id="7fea0-240">**啟用了 PowerPivot 自動資料重新整理帳戶嗎？**</span><span class="sxs-lookup"><span data-stu-id="7fea0-240">**Did you enable the PowerPivot unattended data refresh account?**</span></span>

 <span data-ttu-id="7fea0-241">如有啟用，即應授與帳戶對於資料重新整理期間所要存取之資料來源的讀取權限。</span><span class="sxs-lookup"><span data-stu-id="7fea0-241">If yes, then you should grant that account read permissions on data sources that are accessed during data refresh.</span></span> <span data-ttu-id="7fea0-242">此帳戶需要讀取權限的原因是因為在使用預設驗證選項的活頁簿中，自動帳戶在資料重新整理期間將會是「目前使用者」。</span><span class="sxs-lookup"><span data-stu-id="7fea0-242">The reason why this account needs read permissions is because in a workbook that uses the default authentication options, the unattended account will be the 'current user' during data refresh.</span></span> <span data-ttu-id="7fea0-243">除非排程擁有者覆寫了連接字串中的認證，否則此帳戶必須有權讀取貴組織中目前正在使用之任何數量的資料來源。</span><span class="sxs-lookup"><span data-stu-id="7fea0-243">Unless the schedule owner overrides the credentials in the connection string, this account will need read permissions on any number of data sources that are actively used in your organization.</span></span>

 <span data-ttu-id="7fea0-244">**您要使用認證選項 2：允許排程擁有者輸入 Windows 使用者名稱及密碼嗎？**</span><span class="sxs-lookup"><span data-stu-id="7fea0-244">**Are you using credential option 2: allowing the schedule owner to enter a Windows user name and password?**</span></span>

 <span data-ttu-id="7fea0-245">通常建立 PowerPivot 活頁簿的使用者因為一開始就執行了資料匯入作業，所以應已具備足夠的權限。</span><span class="sxs-lookup"><span data-stu-id="7fea0-245">Typically, users who create PowerPivot workbooks already have sufficient permissions because he or she already imported the data in the first place.</span></span> <span data-ttu-id="7fea0-246">這些使用者之後若是將資料重新整理設定成使用其 Windows 使用者識別執行，則在資料重新整理期間，將會使用其具備資料庫各項權限的 Windows 使用者帳戶擷取資料。</span><span class="sxs-lookup"><span data-stu-id="7fea0-246">If these users subsequently configure data refresh to run under their own Windows user identity, their Windows user account, which already has rights on the database, will be used to retrieve data during data refresh.</span></span> <span data-ttu-id="7fea0-247">現有的權限應已足夠。</span><span class="sxs-lookup"><span data-stu-id="7fea0-247">Existing permissions should be sufficient.</span></span>

 <span data-ttu-id="7fea0-248">**您要使用認證選項 3：使用 Secure Store Service 目標應用程式提供執行資料重新整理作業所要使用的使用者識別嗎？**</span><span class="sxs-lookup"><span data-stu-id="7fea0-248">**Are you using credential option 3: using a Secure Store Service target application to provide a user identity for running data refresh jobs?**</span></span>

 <span data-ttu-id="7fea0-249">與前文所述 PowerPivot 自動資料重新整理帳戶一樣，任何用於執行資料重新整理作業的帳戶都必須具備讀取權限。</span><span class="sxs-lookup"><span data-stu-id="7fea0-249">Any account used to run a data refresh job needs read permissions, for the same reasons as those described for the PowerPivot unattended data refresh account.</span></span>

 <span data-ttu-id="7fea0-250">**如何檢查連接字串，以判斷您是否可以覆寫資料重新整理期間所使用的認證**</span><span class="sxs-lookup"><span data-stu-id="7fea0-250">**How to check connection strings to determine whether you can override credentials used during data refresh**</span></span>

 <span data-ttu-id="7fea0-251">如前文所述，倘若連接使用 Windows 以外的驗證方式 (如 SQL Server 驗證)，您可在資料重新整理作業層級替換另一個使用者名稱及密碼。</span><span class="sxs-lookup"><span data-stu-id="7fea0-251">As previously noted, you can substitute a different user name and password at the data refresh job level if the connection is using non-Windows authentication (for example, SQL Server authentication).</span></span> <span data-ttu-id="7fea0-252">非 Windows 認證會透過利用使用者識別碼及密碼參數的連接字串進行傳遞。</span><span class="sxs-lookup"><span data-stu-id="7fea0-252">Non-Windows credentials are passed on the connection string using the User ID and Password parameters.</span></span> <span data-ttu-id="7fea0-253">活頁簿中的連接字串如有包含這些參數，可以選擇是否要指定其他的使用者名稱及密碼，以重新整理該資料來源中的資料。</span><span class="sxs-lookup"><span data-stu-id="7fea0-253">If your workbook contains a connection string with these parameters, you can optionally specify a different user name and password for refreshing data from that data source.</span></span>

 <span data-ttu-id="7fea0-254">下列步驟說明如何判斷您的連接字串是否可以讓您覆寫使用者名稱及密碼。</span><span class="sxs-lookup"><span data-stu-id="7fea0-254">The following steps explain how to determine whether you have a connection string that accepts user name and password overrides.</span></span>

1.  <span data-ttu-id="7fea0-255">使用 Excel 開啟該活頁簿。</span><span class="sxs-lookup"><span data-stu-id="7fea0-255">Open the workbook in Excel.</span></span>

2.  <span data-ttu-id="7fea0-256">開啟 PowerPivot 視窗 (在 Excel 的 PowerPivot 功能區上按一下 [PowerPivot 視窗])。</span><span class="sxs-lookup"><span data-stu-id="7fea0-256">Open the PowerPivot window (in Excel, on the PowerPivot ribbon, click PowerPivot Window).</span></span>

3.  <span data-ttu-id="7fea0-257">按一下 [**設計**]。</span><span class="sxs-lookup"><span data-stu-id="7fea0-257">Click **Design**.</span></span>

4.  <span data-ttu-id="7fea0-258">按一下 [**現有連接**]。</span><span class="sxs-lookup"><span data-stu-id="7fea0-258">Click **Existing Connections**.</span></span>

     <span data-ttu-id="7fea0-259">活頁簿中使用的所有連接都會列在 [ **PowerPivot 資料連接**] 之下。</span><span class="sxs-lookup"><span data-stu-id="7fea0-259">All of the connections used in the workbook are listed under **PowerPivot Data Connections**.</span></span>

5.  <span data-ttu-id="7fea0-260">選取連接，然後按一下 [**編輯**]，再按一下 [ **Advanced**]。</span><span class="sxs-lookup"><span data-stu-id="7fea0-260">Select the connection and click **Edit**, and then click **Advanced**.</span></span> <span data-ttu-id="7fea0-261">該連接字串會顯示在頁面底部。</span><span class="sxs-lookup"><span data-stu-id="7fea0-261">The connection string is at the bottom of the page.</span></span>

 <span data-ttu-id="7fea0-262">如果您在連接字串中看到 [**整合式安全性 = SSPI** ]，則無法覆寫連接字串中的認證。</span><span class="sxs-lookup"><span data-stu-id="7fea0-262">If you see **Integrated Security=SSPI** in the connection string, you cannot override the credentials in the connection string.</span></span> <span data-ttu-id="7fea0-263">連接一律會使用目前使用者，</span><span class="sxs-lookup"><span data-stu-id="7fea0-263">The connection will always use the current user.</span></span> <span data-ttu-id="7fea0-264">並忽略您所提供的任何認證。</span><span class="sxs-lookup"><span data-stu-id="7fea0-264">Any credentials that you provide are ignored.</span></span>

 <span data-ttu-id="7fea0-265">如果您看到 [**保存安全性資訊 = False，Password = \* \* \* \* \* \* \* \* \* \* \* ，UserID \<userlogin> =**]，則表示您有可接受認證覆寫的連接字串。</span><span class="sxs-lookup"><span data-stu-id="7fea0-265">If you see **Persist Security Info=False, Password=\*\*\*\*\*\*\*\*\*\*\*, UserID=\<userlogin>**,then you have a connection string that will accept credential overrides.</span></span> <span data-ttu-id="7fea0-266">連接字串中所出現的認證 (如使用者識別碼及密碼) 並非 Windows 認證，而是資料庫登入或其他對目標資料來源有效的登入帳戶。</span><span class="sxs-lookup"><span data-stu-id="7fea0-266">Credentials that appear in a connection string (such as UserID and Password) are not Windows credentials, but rather database logins or other sign-in accounts that are valid for the target data source.</span></span>

 <span data-ttu-id="7fea0-267">**如何覆寫連接字串中的認證**</span><span class="sxs-lookup"><span data-stu-id="7fea0-267">**How to override credentials in the connection string**</span></span>

 <span data-ttu-id="7fea0-268">您可以藉由在資料重新整理排程中指定資料來源認證的方式覆寫認證。</span><span class="sxs-lookup"><span data-stu-id="7fea0-268">Overriding credentials is done by specifying data source credentials in the data refresh schedule.</span></span> <span data-ttu-id="7fea0-269">您身為管理員，可以在 Secure Store Service 中提供對應至存取外部資料時所用之認證的目標應用程式。</span><span class="sxs-lookup"><span data-stu-id="7fea0-269">As an administrator, you can provide a target application in Secure Store Service that maps the credentials used to access external data.</span></span> <span data-ttu-id="7fea0-270">如此一來，排程擁有者即可在其定義的資料重新整理排程中，輸入目標應用程式識別碼。</span><span class="sxs-lookup"><span data-stu-id="7fea0-270">The schedule owner can then enter the target application ID in the data refresh schedule that he or she defines.</span></span> <span data-ttu-id="7fea0-271">如需建立此目標應用程式的詳細資訊，請參閱[設定 PowerPivot 資料重新整理的預存認證 &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="7fea0-271">For more information about creating this target application, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>

 <span data-ttu-id="7fea0-272">除此之外，排程擁有者也可輸入資料重新整理期間，用於連接資料來源的認證集。</span><span class="sxs-lookup"><span data-stu-id="7fea0-272">Alternatively, the schedule owner can type in the set of credentials that are used to connect to data sources during data refresh.</span></span> <span data-ttu-id="7fea0-273">下圖說明排程定義頁面中的這個資料來源選項。</span><span class="sxs-lookup"><span data-stu-id="7fea0-273">The following illustration shows this data source option in the schedule definition page.</span></span>

 <span data-ttu-id="7fea0-274">![SSAS_PowerPivotKJ_DataRefreshDSOptions](media/ssas-powerpivotkj-datarefreshdsoptions.gif "SSAS_PowerPivotKJ_DataRefreshDSOptions")</span><span class="sxs-lookup"><span data-stu-id="7fea0-274">![SSAS_PowerPivotKJ_DataRefreshDSOptions](media/ssas-powerpivotkj-datarefreshdsoptions.gif "SSAS_PowerPivotKJ_DataRefreshDSOptions")</span></span>

 <span data-ttu-id="7fea0-275">**確認資料存取需求**</span><span class="sxs-lookup"><span data-stu-id="7fea0-275">**Identifying data access requirements**</span></span>

 <span data-ttu-id="7fea0-276">如前文所述，用於執行資料重新整理及連接外部資料來源的帳戶，通常會是同一個。</span><span class="sxs-lookup"><span data-stu-id="7fea0-276">As noted in previous sections, the account used to run data refresh and connect to external data sources is often one and the same.</span></span> <span data-ttu-id="7fea0-277">因此，用於存取外部資料來源的帳戶，將會由資料重新整理排程頁面中這部分的選項設定決定。</span><span class="sxs-lookup"><span data-stu-id="7fea0-277">As such, the account used to access external data sources is determined by the options set in this part of the data refresh schedule page.</span></span> <span data-ttu-id="7fea0-278">此帳戶可能是 PowerPivot 自動資料重新整理帳戶、個人使用者的 Windows 帳戶，或是儲存在預先定義之目標應用程式中的帳戶。</span><span class="sxs-lookup"><span data-stu-id="7fea0-278">This might be the PowerPivot unattended data refresh account, the Windows account of an individual user, or the account that is stored in a predefined target application.</span></span>

 <span data-ttu-id="7fea0-279">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="7fea0-279">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span></span>

 <span data-ttu-id="7fea0-280">若用來執行資料重新整理的帳戶不同於匯入資料的帳戶 (例如認證選項 1 的 PowerPivot 自動資料重新整理帳戶，或是認證選項 3 的其他預存認證集)，即必須針對該帳戶建立新的資料庫登入，並授與其對外部資料來源的讀取權限。</span><span class="sxs-lookup"><span data-stu-id="7fea0-280">In cases where the account used to run data refresh is different from the account used to import data (for example, the PowerPivot unattended data refresh account via credential option one, or some other set of stored credentials via credential option three), you will need to create a new database login for that account and grant it read permissions on the external data sources.</span></span>

 <span data-ttu-id="7fea0-281">當您確認需要存取資料的帳戶之後，即可開始檢查 PowerPivot 活頁簿中最常使用之資料來源的權限。</span><span class="sxs-lookup"><span data-stu-id="7fea0-281">Once you understand which accounts require data access, you can begin to check permissions on the data sources that are most often used in PowerPivot workbooks.</span></span> <span data-ttu-id="7fea0-282">您可以先從目前正在使用的任何資料倉儲或報告資料庫著手，並向目前正在使用 PowerPivot 的使用者收集意見，了解其所使用的資料來源。</span><span class="sxs-lookup"><span data-stu-id="7fea0-282">Start with any data warehouses or reporting databases that are actively used, but also solicit input from your most active PowerPivot users to find out which data sources they are using.</span></span> <span data-ttu-id="7fea0-283">當您列出資料來源之後，即可逐項檢查其權限設定是否正確。</span><span class="sxs-lookup"><span data-stu-id="7fea0-283">Once you have a list of data sources, you can begin checking each one to ensure that permissions are set correctly.</span></span>

##  <a name="step-7-enable-workbook-upgrade-for-data-refresh"></a><a name="bkmk_upgradewrkbk"></a><span data-ttu-id="7fea0-284">步驟7：啟用資料重新整理的活頁簿升級</span><span class="sxs-lookup"><span data-stu-id="7fea0-284">Step 7: Enable workbook upgrade for data refresh</span></span>
 <span data-ttu-id="7fea0-285">根據預設，使用 [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] 版本的 PowerPivot for Excel 所建立的活頁簿不得在 [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] 版本的 PowerPivot for SharePoint 上設定排程資料重新整理。</span><span class="sxs-lookup"><span data-stu-id="7fea0-285">By default, workbooks that were created using the [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] version of PowerPivot for Excel cannot be configured for scheduled data refresh on a [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] version of PowerPivot for SharePoint.</span></span> <span data-ttu-id="7fea0-286">如果您在 SharePoint 環境中裝載較新和較舊版本的 PowerPivot 活頁簿，您必須先升級任何 [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] 活頁簿，然後才可在伺服器上排程自動資料重新整理。</span><span class="sxs-lookup"><span data-stu-id="7fea0-286">If you host newer and older versions of PowerPivot workbooks in your SharePoint environment, you must upgrade any [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] workbooks first before they can be scheduled for automatic data refresh on the server.</span></span>

##  <a name="step-8-verify-data-refresh-configuration"></a><a name="bkmk_verify"></a><span data-ttu-id="7fea0-287">步驟8：確認資料重新整理設定</span><span class="sxs-lookup"><span data-stu-id="7fea0-287">Step 8: Verify data refresh configuration</span></span>
 <span data-ttu-id="7fea0-288">若要確認資料重新整理，您必須擁有發行到 SharePoint 網站的 PowerPivot 活頁簿。</span><span class="sxs-lookup"><span data-stu-id="7fea0-288">To verify data refresh, you must have a PowerPivot workbook that is published to a SharePoint site.</span></span> <span data-ttu-id="7fea0-289">您必須具備活頁簿的「參與」權限，以及存取資料重新整理排程中所含之任何資料來源所需的各項權限。</span><span class="sxs-lookup"><span data-stu-id="7fea0-289">You must have Contribute permissions on the workbook and permissions to access any data sources that are included in the data refresh schedule.</span></span>

 <span data-ttu-id="7fea0-290">當您建立排程時，請選取 [**也**儘快重新整理] 核取方塊，以立即執行資料重新整理。</span><span class="sxs-lookup"><span data-stu-id="7fea0-290">When you create the schedule, select the **Also refresh as soon as possible** checkbox to run data refresh immediately.</span></span> <span data-ttu-id="7fea0-291">接著您可以查看該活頁簿的資料重新整理記錄頁面，確認其執行是否成功。</span><span class="sxs-lookup"><span data-stu-id="7fea0-291">You can then check the data refresh history page of that workbook to verify that it ran successfully.</span></span> <span data-ttu-id="7fea0-292">請注意，PowerPivot 資料重新整理計時器工作會每隔一分鐘執行一次，</span><span class="sxs-lookup"><span data-stu-id="7fea0-292">Recall that the PowerPivot Data Refresh timer job runs every minute.</span></span> <span data-ttu-id="7fea0-293">因此，您至少必須等候一分鐘，才能確認資料重新整理是否成功。</span><span class="sxs-lookup"><span data-stu-id="7fea0-293">It will take at least that long to get confirmation that data refresh succeeded.</span></span>

 <span data-ttu-id="7fea0-294">請務必試用您打算支援的所有認證選項。</span><span class="sxs-lookup"><span data-stu-id="7fea0-294">Be sure to try all of the credential options you plan to support.</span></span> <span data-ttu-id="7fea0-295">例如，您若是設定 PowerPivot 自動資料重新整理帳戶，請使用該選項驗證資料重新整理是否成功。</span><span class="sxs-lookup"><span data-stu-id="7fea0-295">For example, if you configured the PowerPivot unattended data refresh account, verify that data refresh succeeds using that option.</span></span> <span data-ttu-id="7fea0-296">如需有關排程和查看狀態資訊的詳細資訊，請參閱排程資料重新整理[&#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md)和[觀看資料重新整理記錄 &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="7fea0-296">For more information about scheduling and viewing status information, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) and [View Data Refresh History &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span></span>

 <span data-ttu-id="7fea0-297">如果資料重新整理失敗，請參閱 TechNet wiki 上的[疑難排解 PowerPivot 資料](https://go.microsoft.com/fwlink/?LinkID=223279)重新整理頁面，以取得可能的解決方案。</span><span class="sxs-lookup"><span data-stu-id="7fea0-297">If data refresh fails, refer to the [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/?LinkID=223279) page on the TechNet wiki for possible solutions.</span></span>

##  <a name="modify-configuration-settings-for-data-refresh"></a><a name="bkmk_config"></a><span data-ttu-id="7fea0-298">修改資料重新整理的設定</span><span class="sxs-lookup"><span data-stu-id="7fea0-298">Modify Configuration Settings for Data Refresh</span></span>
 <span data-ttu-id="7fea0-299">每個 PowerPivot 服務應用程式各有其影響資料重新整理作業的組態設定。</span><span class="sxs-lookup"><span data-stu-id="7fea0-299">Each PowerPivot service application has configuration settings that affect data refresh operations.</span></span> <span data-ttu-id="7fea0-300">本節說明如何修改這些設定。</span><span class="sxs-lookup"><span data-stu-id="7fea0-300">This section explains how to modify those settings.</span></span>

###  <a name="set-business-hours-to-determine-off-hours-processing"></a><a name="procIntervals"></a><span data-ttu-id="7fea0-301">設定「上班時間」以判斷下班時間處理</span><span class="sxs-lookup"><span data-stu-id="7fea0-301">Set 'Business Hours' to determine off-hours processing</span></span>
 <span data-ttu-id="7fea0-302">排程資料重新整理作業的 SharePoint 使用者可以指定「下班後」的最早開始時間。</span><span class="sxs-lookup"><span data-stu-id="7fea0-302">SharePoint users who schedule data refresh operations can specify an earliest start time of "After business hours".</span></span> <span data-ttu-id="7fea0-303">如果使用者想要擷取工作日期間累積的商務交易資料，這項功能會很有用。</span><span class="sxs-lookup"><span data-stu-id="7fea0-303">This may be useful if they want to retrieve business transaction data that accumulated during the business day.</span></span> <span data-ttu-id="7fea0-304">身為伺服陣列管理員，您可以依最適合組織所定義工作日的時間範圍指定。</span><span class="sxs-lookup"><span data-stu-id="7fea0-304">As a farm administrator, you can specify the range of hours that best defines a business day for your organization.</span></span> <span data-ttu-id="7fea0-305">如果您定義工作日是從 04:00 到 20:00，則根據「下班後」進行的資料更新處理開始時間就會是 20：01。</span><span class="sxs-lookup"><span data-stu-id="7fea0-305">If you define the business day to be from 04:00 to 20:00, then data refresh processing that is based on an "After business hours" start time will begin at 20:01.</span></span>

 <span data-ttu-id="7fea0-306">在下班期間執行的資料重新整理要求會依收到要求的順序加入佇列。</span><span class="sxs-lookup"><span data-stu-id="7fea0-306">Data refresh requests that run during off-hours are added to the queue in the order in which the request is received.</span></span> <span data-ttu-id="7fea0-307">個別的要求會在伺服器資源可使用的情況下進行處理。</span><span class="sxs-lookup"><span data-stu-id="7fea0-307">Individual requests will be processed as server resources become available.</span></span>

1.  <span data-ttu-id="7fea0-308">在 [管理中心] 的 [應用程式管理] 中，按一下 [**管理服務應用程式**]。</span><span class="sxs-lookup"><span data-stu-id="7fea0-308">In Central Administration, in Application Management, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="7fea0-309">按一下 PowerPivot 服務應用程式名稱。</span><span class="sxs-lookup"><span data-stu-id="7fea0-309">Click the PowerPivot service application name.</span></span> <span data-ttu-id="7fea0-310">隨即出現 PowerPivot 管理儀表板。</span><span class="sxs-lookup"><span data-stu-id="7fea0-310">The PowerPivot Management Dashboard appears.</span></span>

3.  <span data-ttu-id="7fea0-311">在 [動作] 中，按一下 [**設定服務應用程式設定**] 以開啟 [PowerPivot 服務應用程式設定] 頁面</span><span class="sxs-lookup"><span data-stu-id="7fea0-311">In Actions, click **Configure service application settings** to open the PowerPivot Service Application Settings page</span></span>

4.  <span data-ttu-id="7fea0-312">在 [資料重新整理] 區段的 [上班時間] 中，輸入定義下班後處理期間的開始及結束時間。</span><span class="sxs-lookup"><span data-stu-id="7fea0-312">In the Data Refresh section, in Business Hours, enter a start time and end time that defines the after business hours processing period.</span></span>

     <span data-ttu-id="7fea0-313">如果不要定義下班處理期間，可以為 [開始時間] 和 [結束時間] 輸入相同的值 (例如，兩個時間都設定為 12: 00)。</span><span class="sxs-lookup"><span data-stu-id="7fea0-313">If you do not want an off-hours processing period defined, you can enter the same value for both Start Time and End Time (for example, 12:00 for both times).</span></span> <span data-ttu-id="7fea0-314">不過請注意，SharePoint 網站上的排程定義頁面仍然會提供「下班後」做為選項。</span><span class="sxs-lookup"><span data-stu-id="7fea0-314">However, be aware that the schedule definition pages on the SharePoint sites will still have "After business hours" as an option.</span></span> <span data-ttu-id="7fea0-315">如果使用者在未定義下班處理範圍的伺服器陣列上選取了該選項，最後會因為處理工作無法啟動而接到資料重新整理錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="7fea0-315">Users who select that option on a farm that has no off-hour processing range defined for it will eventually get data refresh errors as processing jobs fail to start.</span></span>

5.  <span data-ttu-id="7fea0-316">按一下 [確定]  。</span><span class="sxs-lookup"><span data-stu-id="7fea0-316">Click **OK**.</span></span>

###  <a name="limit-how-long-data-refresh-history-is-retained"></a><a name="usagehist"></a><span data-ttu-id="7fea0-317">限制資料重新整理記錄的保留時間長度</span><span class="sxs-lookup"><span data-stu-id="7fea0-317">Limit how long data refresh history is retained</span></span>
 <span data-ttu-id="7fea0-318">資料重新整理記錄是資料重新整理作業隨著時間經過所產生的成功與失敗訊息詳細記錄。</span><span class="sxs-lookup"><span data-stu-id="7fea0-318">Data refresh history is a detailed record of the success and failure messages that are generated for data refresh operations over time.</span></span> <span data-ttu-id="7fea0-319">記錄資訊是透過伺服器陣列中的使用量資料收集系統進行收集與管理。</span><span class="sxs-lookup"><span data-stu-id="7fea0-319">History information is gathered and managed through the usage data collection system in the farm.</span></span> <span data-ttu-id="7fea0-320">因此，您在使用量資料記錄上設定的限制也會套用至資料重新整理記錄。</span><span class="sxs-lookup"><span data-stu-id="7fea0-320">As such, limits that you set on usage data history also apply to data refresh history.</span></span> <span data-ttu-id="7fea0-321">由於使用活動報告會彙集整個 PowerPivot 系統的資料，所以只使用單一記錄設定來控制資料重新整理記錄與收集及儲存之所有其他使用量資料的資料保留。</span><span class="sxs-lookup"><span data-stu-id="7fea0-321">Because the usage activity reports pull together data from across the PowerPivot system, a single history setting is used to control data retention for both data refresh history and all other usage data that is collected and stored.</span></span>

1.  <span data-ttu-id="7fea0-322">在 [管理中心] 的 [應用程式管理] 中，按一下 [**管理服務應用程式**]。</span><span class="sxs-lookup"><span data-stu-id="7fea0-322">In Central Administration, in Application Management, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="7fea0-323">按一下 PowerPivot 服務應用程式名稱。</span><span class="sxs-lookup"><span data-stu-id="7fea0-323">Click the PowerPivot service application name.</span></span> <span data-ttu-id="7fea0-324">隨即出現 PowerPivot 管理儀表板。</span><span class="sxs-lookup"><span data-stu-id="7fea0-324">The PowerPivot Management Dashboard appears.</span></span>

3.  <span data-ttu-id="7fea0-325">在 [動作] 中，按一下 [**設定服務應用程式設定**] 以開啟 [PowerPivot 服務應用程式設定] 頁面</span><span class="sxs-lookup"><span data-stu-id="7fea0-325">In Actions, click **Configure service application settings** to open the PowerPivot Service Application Settings page</span></span>

4.  <span data-ttu-id="7fea0-326">在 [使用量資料收集] 區段的 [使用量資料記錄] 中，輸入要為每個活頁簿記錄資料重新整理活動的天數。</span><span class="sxs-lookup"><span data-stu-id="7fea0-326">In the Usage Data Collection section, in Usage Data History, type the number of days for which you want to keep a record of data refresh activity for each workbook.</span></span>

     <span data-ttu-id="7fea0-327">預設值為 365 天。</span><span class="sxs-lookup"><span data-stu-id="7fea0-327">The default is 365 days.</span></span> <span data-ttu-id="7fea0-328">最小值是 1 天，最大值是 5000 天。</span><span class="sxs-lookup"><span data-stu-id="7fea0-328">The minimum value is 1 day and the maximum is 5000 days.</span></span> <span data-ttu-id="7fea0-329">0 指定無限制的保留期間，也就是永遠不會刪除資料。</span><span class="sxs-lookup"><span data-stu-id="7fea0-329">0 specifies an unlimited retention period; data is never deleted.</span></span> <span data-ttu-id="7fea0-330">請注意，您無法透過任何設定關閉記錄。</span><span class="sxs-lookup"><span data-stu-id="7fea0-330">Note that there is no setting for turning off history.</span></span>

5.  <span data-ttu-id="7fea0-331">按一下 [確定]  。</span><span class="sxs-lookup"><span data-stu-id="7fea0-331">Click **OK**.</span></span>

 <span data-ttu-id="7fea0-332">SharePoint 使用者在具有資料重新整理記錄的活頁簿上選擇 [管理資料重新整理] 選項時，就可以使用記錄資訊。</span><span class="sxs-lookup"><span data-stu-id="7fea0-332">History information is made available to SharePoint users when they choose the Manage Data Refresh option on a workbook that has a data refresh history.</span></span> <span data-ttu-id="7fea0-333">這項資訊也用在伺服器陣列管理員用來管理 PowerPivot 服務作業的 PowerPivot 管理儀表板。</span><span class="sxs-lookup"><span data-stu-id="7fea0-333">This information is also used in the PowerPivot Management Dashboard used by farm administrators to manage PowerPivot service operations.</span></span> <span data-ttu-id="7fea0-334">如需詳細資訊，請參閱[View Data Refresh History &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="7fea0-334">For more information, see [View Data Refresh History &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span></span>

 <span data-ttu-id="7fea0-335">記錄資料的長期實體儲存體位於 PowerPivot 服務應用程式的 PowerPivot 服務應用程式資料庫中。</span><span class="sxs-lookup"><span data-stu-id="7fea0-335">Long-term physical storage of history data is in the PowerPivot service application database for the PowerPivot service application.</span></span> <span data-ttu-id="7fea0-336">如需如何收集和儲存使用量資料的詳細資訊，請參閱[PowerPivot 使用量資料收集](power-pivot-sharepoint/power-pivot-usage-data-collection.md)。</span><span class="sxs-lookup"><span data-stu-id="7fea0-336">For more information about how usage data is collected and stored, see [PowerPivot Usage Data Collection](power-pivot-sharepoint/power-pivot-usage-data-collection.md).</span></span>

##  <a name="reschedule-the-powerpivot-data-refresh-timer-job"></a><a name="configTimerJob"></a><span data-ttu-id="7fea0-337">重新排程 PowerPivot 資料重新整理計時器工作</span><span class="sxs-lookup"><span data-stu-id="7fea0-337">Reschedule the PowerPivot Data Refresh timer job</span></span>
 <span data-ttu-id="7fea0-338">已排程的資料重新整理是由 PowerPivot 資料重新整理計時器工作所觸發，此工作每隔一分鐘，就會掃描 PowerPivot 服務應用程式資料庫中的排程資訊。</span><span class="sxs-lookup"><span data-stu-id="7fea0-338">Scheduled data refresh is triggered by a PowerPivot Data Refresh timer job that scans schedule information in the PowerPivot service application database at one minute intervals.</span></span> <span data-ttu-id="7fea0-339">當資料重新整理要依排程開始進行時，計時器工作會將要求加入可用 PowerPivot 伺服器的處理佇列中。</span><span class="sxs-lookup"><span data-stu-id="7fea0-339">When data refresh is scheduled to begin, the timer job adds the request to a processing queue on an available PowerPivot server.</span></span>

 <span data-ttu-id="7fea0-340">您可以增加掃描間隔的時間，當做效能微調技巧使用。</span><span class="sxs-lookup"><span data-stu-id="7fea0-340">You can increase the length of time between scans as a performance tuning technique.</span></span> <span data-ttu-id="7fea0-341">您也可以停用計時器工作，在對問題進行疑難排解時，暫時停止資料重新整理作業。</span><span class="sxs-lookup"><span data-stu-id="7fea0-341">You can also disable the timer job to temporarily stop data refresh operations while you troubleshoot problems.</span></span>

 <span data-ttu-id="7fea0-342">預設值是一分鐘，這是您可以指定的最低值。</span><span class="sxs-lookup"><span data-stu-id="7fea0-342">The default setting is one minute, which is the lowest value you can specify.</span></span> <span data-ttu-id="7fea0-343">因為此值可為一天內任意時間執行的排程提供最可預期的結果，所以建議使用此值。</span><span class="sxs-lookup"><span data-stu-id="7fea0-343">This value is recommended because it provides the most predictable outcome for schedules that run at arbitrary times throughout the day.</span></span> <span data-ttu-id="7fea0-344">例如，如果使用者排定在下午 4:15 執行資料重新整理，而且計時器工作每分鐘都會掃描排程資訊，則系統就會在 4:15 偵測到已排程的資料重新整理要求，4:15 之後數分鐘內就會執行處理。</span><span class="sxs-lookup"><span data-stu-id="7fea0-344">For example, if a user schedules data refresh for 4:15 PM, and the timer job scans for schedules every minute, the scheduled data refresh request will be detected at 4:15 and processing will occur within a few minutes of 4:15.</span></span>

 <span data-ttu-id="7fea0-345">如果您提高掃描間隔，以極低的頻率執行 (例如，每天午夜執行一次)，原先排定在該間隔期間執行的所有資料重新整理作業就會全部一次加入處理佇列中，這可能會讓伺服器負載過重並佔用其他應用程式的系統資源。</span><span class="sxs-lookup"><span data-stu-id="7fea0-345">If you raise the scan interval so that it runs very infrequently (for example, once a day at midnight), all of the data refresh operations that were scheduled to run during that interval are added to the processing queue all at once, potentially overwhelming the server and starving other applications of system resources.</span></span> <span data-ttu-id="7fea0-346">視已排程的重新整理數目而定，資料重新整理作業的處理佇列可能會不斷累積到無法完成所有工作。</span><span class="sxs-lookup"><span data-stu-id="7fea0-346">Depending on the number of scheduled refreshes, the processing queue for data refresh operations might build up to such an extent that not all jobs will be able to complete.</span></span> <span data-ttu-id="7fea0-347">如果作業持續到下一個處理間隔，佇列結尾的資料重新整理要求可能會被卸除。</span><span class="sxs-lookup"><span data-stu-id="7fea0-347">Data refresh requests at the end of the queue might be dropped if they run into the next processing interval.</span></span>

 <span data-ttu-id="7fea0-348">如果硬體支援的話，您可以藉由指定額外處理器平行執行其他資料重新整理作業，以減輕這個問題。</span><span class="sxs-lookup"><span data-stu-id="7fea0-348">If your hardware supports it, you can mitigate this problem by specifying additional processors to run more data refresh jobs in parallel.</span></span> <span data-ttu-id="7fea0-349">如需詳細資訊，請參閱[設定專用資料重新整理或僅查詢處理 &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="7fea0-349">For more information, see [Configure Dedicated Data Refresh or Query-Only Processing &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span></span> <span data-ttu-id="7fea0-350">如需如何探索資料重新整理要求、將其新增至佇列，以及進行處理的詳細資訊，請參閱[PowerPivot 資料](power-pivot-sharepoint/power-pivot-data-refresh.md)重新整理。</span><span class="sxs-lookup"><span data-stu-id="7fea0-350">For more information about how data refresh requests are discovered, added to a queue, and processed, see [PowerPivot Data Refresh](power-pivot-sharepoint/power-pivot-data-refresh.md).</span></span>

1.  <span data-ttu-id="7fea0-351">在管理中心，按一下 **[監視]**。</span><span class="sxs-lookup"><span data-stu-id="7fea0-351">In Central Administration, click **Monitoring**.</span></span>

2.  <span data-ttu-id="7fea0-352">按一下 [**審查工作定義**]。</span><span class="sxs-lookup"><span data-stu-id="7fea0-352">Click **Review Job Definitions**.</span></span>

3.  <span data-ttu-id="7fea0-353">選取 [ **PowerPivot 資料重新整理計時器工作**]。</span><span class="sxs-lookup"><span data-stu-id="7fea0-353">Select the **PowerPivot Data Refresh Timer Job**.</span></span>

4.  <span data-ttu-id="7fea0-354">修改排程頻率，以變更計時器工作掃描資料重新整理排程資訊的頻率。</span><span class="sxs-lookup"><span data-stu-id="7fea0-354">Modify the schedule frequency to change how often the timer job scans for data refresh schedule information.</span></span>

##  <a name="disable-the-data-refresh-timer-job"></a><a name="bkmk_disableDR"></a><span data-ttu-id="7fea0-355">停用資料重新整理計時器工作</span><span class="sxs-lookup"><span data-stu-id="7fea0-355">Disable the Data Refresh Timer Job</span></span>
 <span data-ttu-id="7fea0-356">PowerPivot 資料重新整理計時器工作是伺服器陣列層級的工作，它會針對伺服器陣列中的所有 PowerPivot 伺服器執行個體一起啟用或停用。</span><span class="sxs-lookup"><span data-stu-id="7fea0-356">The PowerPivot data refresh timer job is a farm-level timer job that is either enabled or disabled for all PowerPivot server instances in the farm.</span></span> <span data-ttu-id="7fea0-357">這項工作不會繫結至特定 Web 應用程式或 PowerPivot 服務應用程式。</span><span class="sxs-lookup"><span data-stu-id="7fea0-357">It is not tied to a specific Web application or PowerPivot service application.</span></span> <span data-ttu-id="7fea0-358">您無法在某些伺服器上停用，以強制在伺服器陣列中的其他伺服器上執行資料重新整理處理。</span><span class="sxs-lookup"><span data-stu-id="7fea0-358">You cannot disable it on some servers to force data refresh processing to other servers in the farm.</span></span>

 <span data-ttu-id="7fea0-359">如果停用 PowerPivot 資料重新整理計時器工作，已排入佇列的要求將進行處理，但您必須重新啟用工作，才能再加入新的要求。</span><span class="sxs-lookup"><span data-stu-id="7fea0-359">If you disable the PowerPivot data refresh timer job, requests that were already in the queue will be processed, but no new requests will be added until you re-enable the job.</span></span> <span data-ttu-id="7fea0-360">已排定在過去執行的要求不會進行處理。</span><span class="sxs-lookup"><span data-stu-id="7fea0-360">Requests that were scheduled to occur in the past are not processed.</span></span>

 <span data-ttu-id="7fea0-361">停用計時器工作對應用程式頁面中功能的可用性不會有任何影響。</span><span class="sxs-lookup"><span data-stu-id="7fea0-361">Disabling the timer job has no effect on feature availability in application pages.</span></span> <span data-ttu-id="7fea0-362">在 Web 應用程式中，沒有任何方法可以移除或隱藏資料重新整理功能。</span><span class="sxs-lookup"><span data-stu-id="7fea0-362">There is no way to remove or hide the data refresh feature in web applications.</span></span> <span data-ttu-id="7fea0-363">即使永久停用計時器工作，擁有「參與」或以上權限的使用者仍然可以建立新的資料重新整理作業排程。</span><span class="sxs-lookup"><span data-stu-id="7fea0-363">Users who have Contribute permissions or above will still be able to create new schedules for data refresh operations, even if the timer job is permanently disabled.</span></span>

## <a name="see-also"></a><span data-ttu-id="7fea0-364">另請參閱</span><span class="sxs-lookup"><span data-stu-id="7fea0-364">See Also</span></span>
 <span data-ttu-id="7fea0-365">[排程資料重新整理 &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) [設定專用的資料重新整理或僅限查詢的處理 &#40;PowerPivot for SharePoint](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md)&#41;[設定 Powerpivot 無人看管的資料重新整理帳戶 &#40;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) PowerPivot for SharePoint&#41;[設定 Powerpivot 資料重新整理的預存認證 &#40;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) PowerPivot for SharePoint&#41;</span><span class="sxs-lookup"><span data-stu-id="7fea0-365">[Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) [Configure Dedicated Data Refresh or Query-Only Processing &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md) [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)</span></span>


