---
title: 資料採礦服務和資料來源 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: b26fd6e3-7d87-4f66-ab47-5303b51b87da
author: minewiskan
ms.author: owend
ms.openlocfilehash: f4b86ff2603e58210a66e7b40401ff8da7c938b1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87598675"
---
# <a name="data-mining-services-and-data-sources"></a><span data-ttu-id="3813e-102">資料採礦服務與資料來源</span><span class="sxs-lookup"><span data-stu-id="3813e-102">Data Mining Services and Data Sources</span></span>
  <span data-ttu-id="3813e-103">資料採礦會要求建立與 SQL Server Analysis Services 執行個體的連接。</span><span class="sxs-lookup"><span data-stu-id="3813e-103">Data mining requires a connection to an instance of SQL Server Analysis Services.</span></span> <span data-ttu-id="3813e-104">資料採礦不需要 Cube 中的資料，而且建議您使用關聯式來源；但是資料採礦會使用 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 引擎所提供的元件。</span><span class="sxs-lookup"><span data-stu-id="3813e-104">Data from a cube is not required for data mining and the use of relational sources is recommended; however, data mining uses components provided by the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] engine.</span></span>  
  
 <span data-ttu-id="3813e-105">此主題將提供一些在您連接至 SQL Server [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 執行個體來建立、處理、部署或查詢資料採礦模型時所需要了解的資訊。</span><span class="sxs-lookup"><span data-stu-id="3813e-105">This topic provides information that you need to know when connecting to an instance of SQL Server [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] to create, process, deploy, or query data mining models.</span></span>  
  
## <a name="data-mining-services"></a><span data-ttu-id="3813e-106">資料採礦服務</span><span class="sxs-lookup"><span data-stu-id="3813e-106">Data Mining Services</span></span>  
 <span data-ttu-id="3813e-107">的伺服器元件 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 是 msmdsrv.exe 應用程式，通常會以 Windows 服務的形式執行。</span><span class="sxs-lookup"><span data-stu-id="3813e-107">The server component of [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] is the msmdsrv.exe application, which ordinarily runs as a Windows service.</span></span> <span data-ttu-id="3813e-108">這個應用程式是由安全性元件、XML for Analysis (XMLA) 接聽程式元件、查詢處理器元件及執行下列功能的許多其他內部元件所組成：</span><span class="sxs-lookup"><span data-stu-id="3813e-108">This application consists of security components, an XML for Analysis (XMLA) listener component, a query processor component and numerous other internal components that perform the following functions:</span></span>  
  
-   <span data-ttu-id="3813e-109">剖析從用戶端收到的陳述式</span><span class="sxs-lookup"><span data-stu-id="3813e-109">Parsing statements received from clients</span></span>  
  
-   <span data-ttu-id="3813e-110">管理中繼資料</span><span class="sxs-lookup"><span data-stu-id="3813e-110">Managing metadata</span></span>  
  
-   <span data-ttu-id="3813e-111">處理交易</span><span class="sxs-lookup"><span data-stu-id="3813e-111">Handling transactions</span></span>  
  
-   <span data-ttu-id="3813e-112">處理計算</span><span class="sxs-lookup"><span data-stu-id="3813e-112">Processing calculations</span></span>  
  
-   <span data-ttu-id="3813e-113">儲存維度和資料格資料</span><span class="sxs-lookup"><span data-stu-id="3813e-113">Storing dimension and cell data</span></span>  
  
-   <span data-ttu-id="3813e-114">建立彙總</span><span class="sxs-lookup"><span data-stu-id="3813e-114">Creating aggregations</span></span>  
  
-   <span data-ttu-id="3813e-115">排程查詢</span><span class="sxs-lookup"><span data-stu-id="3813e-115">Scheduling queries</span></span>  
  
-   <span data-ttu-id="3813e-116">快取物件</span><span class="sxs-lookup"><span data-stu-id="3813e-116">Caching objects</span></span>  
  
-   <span data-ttu-id="3813e-117">管理伺服器資源</span><span class="sxs-lookup"><span data-stu-id="3813e-117">Managing server resources</span></span>  
  
### <a name="xmla-listener"></a><span data-ttu-id="3813e-118">XMLA 接聽程式</span><span class="sxs-lookup"><span data-stu-id="3813e-118">XMLA Listener</span></span>  
 <span data-ttu-id="3813e-119">XMLA 接聽程式元件會處理 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 及其用戶端之間的所有 XMLA 通訊。</span><span class="sxs-lookup"><span data-stu-id="3813e-119">The XMLA listener component handles all XMLA communications between [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] and its clients.</span></span> <span data-ttu-id="3813e-120">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] `Port` msmdsrv.ini 檔案中的設定可以用來指定實例接聽的通訊埠 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="3813e-120">The [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] `Port` configuration setting in the msmdsrv.ini file can be used to specify a port on which an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance listens.</span></span> <span data-ttu-id="3813e-121">這個檔案中 0 的值表示 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 會接聽預設通訊埠。</span><span class="sxs-lookup"><span data-stu-id="3813e-121">A value of 0 in this file indicates that [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listen on the default port.</span></span> <span data-ttu-id="3813e-122">除非另有指定，否則 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 會使用下列預設 TCP 通訊埠：</span><span class="sxs-lookup"><span data-stu-id="3813e-122">Unless otherwise specified, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] uses the following default TCP ports:</span></span>  
  
|<span data-ttu-id="3813e-123">連接埠</span><span class="sxs-lookup"><span data-stu-id="3813e-123">Port</span></span>|<span data-ttu-id="3813e-124">描述</span><span class="sxs-lookup"><span data-stu-id="3813e-124">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="3813e-125">2383</span><span class="sxs-lookup"><span data-stu-id="3813e-125">2383</span></span>|<span data-ttu-id="3813e-126">的預設實例 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="3813e-126">Default instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>|  
|<span data-ttu-id="3813e-127">2382</span><span class="sxs-lookup"><span data-stu-id="3813e-127">2382</span></span>|<span data-ttu-id="3813e-128">其他實例的重新導向程式 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="3813e-128">Redirector for other instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>|  
|<span data-ttu-id="3813e-129">在伺服器啟動時動態指派</span><span class="sxs-lookup"><span data-stu-id="3813e-129">Dynamically assigned at server startup</span></span>|<span data-ttu-id="3813e-130">的命名實例 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="3813e-130">Named instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>|  
  
 <span data-ttu-id="3813e-131">如需控制此服務使用之通訊埠的詳細資訊，請參閱 [設定 Windows 防火牆以允許 Analysis Services 存取](../instances/configure-the-windows-firewall-to-allow-analysis-services-access.md)。</span><span class="sxs-lookup"><span data-stu-id="3813e-131">For more information about controlling the ports used by this service, see [Configure the Windows Firewall to Allow Analysis Services Access](../instances/configure-the-windows-firewall-to-allow-analysis-services-access.md).</span></span>  
  
## <a name="connecting-to-data-sources"></a><span data-ttu-id="3813e-132">連接到資料來源</span><span class="sxs-lookup"><span data-stu-id="3813e-132">Connecting to Data Sources</span></span>  
 <span data-ttu-id="3813e-133">每當您建立或更新資料採礦結構或模型時，就會使用資料來源所定義的資料。</span><span class="sxs-lookup"><span data-stu-id="3813e-133">Whenever you create or update a data mining structure or model, you use data that is defined by a data source.</span></span> <span data-ttu-id="3813e-134">此資料來源不包含資料，資料可能包含 Excel 活頁簿、文字檔和 SQL Server 資料庫；資料來源只會定義連接資訊。</span><span class="sxs-lookup"><span data-stu-id="3813e-134">The data source does not contain the data, which might include Excel workbooks, text files, and SQL Server databases; it only defines the connection information.</span></span>  <span data-ttu-id="3813e-135">資料來源檢視 (DSV) 會當做該來源上方的抽象層，修改或對應從來源取得的資料。</span><span class="sxs-lookup"><span data-stu-id="3813e-135">A data source view (DSV) serves as an abstraction layer on top of that source, modifying or mapping the data that is obtained from the source.</span></span>  
  
 <span data-ttu-id="3813e-136">它超出本主題的範圍 (本主題會描述每一個來源的連接需求)。</span><span class="sxs-lookup"><span data-stu-id="3813e-136">It is beyond the scope of this topic to describe the connection requirements for each of these sources.</span></span> <span data-ttu-id="3813e-137">如需詳細資訊，請參閱提供者的文件集。</span><span class="sxs-lookup"><span data-stu-id="3813e-137">For more information, see the documentation for the provider.</span></span> <span data-ttu-id="3813e-138">但是一般而言，當您與提供者互動時，應該留意以下的 Analysis Services 需求：</span><span class="sxs-lookup"><span data-stu-id="3813e-138">However, in general, you should be aware of the following requirements of Analysis Services, when interacting with providers:</span></span>  
  
-   <span data-ttu-id="3813e-139">因為資料採礦是伺服器所提供的服務，所以必須將資料來源的存取權提供給 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 執行個體。</span><span class="sxs-lookup"><span data-stu-id="3813e-139">Because data mining is a service provided by a server, the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance must be given access to the data source.</span></span>  <span data-ttu-id="3813e-140">存取有兩個層面：位置和識別。</span><span class="sxs-lookup"><span data-stu-id="3813e-140">There are two aspects to access: location and identity.</span></span>  
  
     <span data-ttu-id="3813e-141">**位置** ：表示如果您只使用電腦上所儲存的資料，然後將模型部署至伺服器來建立模型，此模型將無法處理，因為找不到資料來源。</span><span class="sxs-lookup"><span data-stu-id="3813e-141">**Location** means that, if you build a model using data that is stored only on your computer and then deploy the model to a server, the model would fail to process because the data source cannot be found.</span></span> <span data-ttu-id="3813e-142">若要解決此問題，您可能必須將資料移轉到執行 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 的相同 SQL Server 執行個體，或是將檔案移到共用位置。</span><span class="sxs-lookup"><span data-stu-id="3813e-142">To resolve this problem, you might need to transfer data into the same SQL Server instance where [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] is running, or move files to a shared location.</span></span>  
  
     <span data-ttu-id="3813e-143">**識別** ：表示 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 上的服務必須能夠使用適當的認證開啟資料檔或資料來源。</span><span class="sxs-lookup"><span data-stu-id="3813e-143">**Identity** means that the services on [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] must be able to open the data file or data source with the appropriate credentials.</span></span> <span data-ttu-id="3813e-144">例如，當您建立模型時，您可能擁有檢視資料的無限權限，但是在伺服器上處理及更新模型的使用者可能擁有資料的有限存取權或無任何存取權，這樣可能會導致處理失敗或影響模型的內容。</span><span class="sxs-lookup"><span data-stu-id="3813e-144">For example, when you built the model, you might have had unlimited permissions to view the data, but the user who is processing and updating the models on the server might have limited or no access to the data, which can cause failure to process or affect the contents of a model.</span></span> <span data-ttu-id="3813e-145">用來連接遠端資料來源的帳戶至少必須擁有資料的讀取權限。</span><span class="sxs-lookup"><span data-stu-id="3813e-145">At minimum, the account used for connecting to the remote data source must have read permissions to the data.</span></span>  
  
-   <span data-ttu-id="3813e-146">當您移動模型時，也會有相同的需求：您必須設定適當的權限來存取舊的資料來源的位置、複製資料來源，或設定新的資料來源。</span><span class="sxs-lookup"><span data-stu-id="3813e-146">When you move a model, the same requirements apply: you must set up appropriate access to the location of the old data source, copy the data sources, or configure a new data source.</span></span> <span data-ttu-id="3813e-147">此外，您也必須移轉登入和角色，或是設定權限來允許在新的位置中處理和更新資料採礦物件。</span><span class="sxs-lookup"><span data-stu-id="3813e-147">Also, you must transfer logins and roles, or set up permissions to allow data mining objects to be processed and updated in the new location.</span></span>  
  
## <a name="configuring-permissions-and-server-properties"></a><span data-ttu-id="3813e-148">設定權限和伺服器屬性</span><span class="sxs-lookup"><span data-stu-id="3813e-148">Configuring Permissions and Server Properties</span></span>  
 <span data-ttu-id="3813e-149">資料採礦需要 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 資料庫的額外權限。</span><span class="sxs-lookup"><span data-stu-id="3813e-149">Data mining requires additional permissions on an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="3813e-150">您可以使用 [Analysis Server 屬性對話方塊 &#40;Analysis Services&#41;](../analysis-server-properties-dialog-box-analysis-services.md) 來設定大部分的資料採礦屬性。</span><span class="sxs-lookup"><span data-stu-id="3813e-150">Most data mining properties can be set by using the [Analysis Server Properties Dialog Box &#40;Analysis Services&#41;](../analysis-server-properties-dialog-box-analysis-services.md).</span></span>  
  
 <span data-ttu-id="3813e-151">如需您可以設定之屬性的詳細資訊，請參閱[在 Analysis Services 中設定伺服器屬性](../server-properties/server-properties-in-analysis-services.md)。</span><span class="sxs-lookup"><span data-stu-id="3813e-151">For more information about the properties that you can configure, see [Configure Server Properties in Analysis Services](../server-properties/server-properties-in-analysis-services.md).</span></span>  
  
 <span data-ttu-id="3813e-152">下列伺服器屬性與資料採礦特別相關：</span><span class="sxs-lookup"><span data-stu-id="3813e-152">The following server properties are of particular relevance to data mining:</span></span>  
  
-   <span data-ttu-id="3813e-153">`AllowAdHocOpenRowsetQueries`控制對 OLE DB 提供者的特定存取，直接載入伺服器記憶體空間中。</span><span class="sxs-lookup"><span data-stu-id="3813e-153">`AllowAdHocOpenRowsetQueries` Controls ad hoc access to OLE DB providers, which are loaded directly into server memory space.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="3813e-154">若要改善安全性，我們建議您將這個屬性設定為 `false`。</span><span class="sxs-lookup"><span data-stu-id="3813e-154">To improve security, we recommend that you set this property to `false`.</span></span> <span data-ttu-id="3813e-155">預設值是 `false`。</span><span class="sxs-lookup"><span data-stu-id="3813e-155">The default value is `false`.</span></span> <span data-ttu-id="3813e-156">不過，即使這個屬性設定為 `false`，使用者仍然可以繼續建立單一查詢，而且可以針對允許的資料來源使用 OPENQUERY。</span><span class="sxs-lookup"><span data-stu-id="3813e-156">However, even if this property is set to `false`, users can continue to create singleton queries, and can use OPENQUERY on permitted data sources.</span></span>  
  
-   <span data-ttu-id="3813e-157">**AllowedProvidersInOpenRowset** ：指定提供者 (如果已啟用特定存取的話)。</span><span class="sxs-lookup"><span data-stu-id="3813e-157">**AllowedProvidersInOpenRowset** Specifies the provider, if ad hoc access is enabled.</span></span> <span data-ttu-id="3813e-158">您可以透過輸入逗號分隔的 ProgID 清單，指定多個提供者。</span><span class="sxs-lookup"><span data-stu-id="3813e-158">You can specify multiple providers, by entering a comma-separated list of ProgIDs.</span></span>  
  
-   <span data-ttu-id="3813e-159">**MaxConcurrentPredictionQueries** ：控制預測所造成的伺服器負載。</span><span class="sxs-lookup"><span data-stu-id="3813e-159">**MaxConcurrentPredictionQueries** Controls the load on the server caused by predictions.</span></span> <span data-ttu-id="3813e-160">預設值 0 允許無限制的查詢 (適用於 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Enterprise)，而最大值是五個並行查詢 (適用於 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Standard)。</span><span class="sxs-lookup"><span data-stu-id="3813e-160">The default value of 0 allows unlimited queries for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Enterprise, and a maximum of five concurrent queries for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Standard.</span></span> <span data-ttu-id="3813e-161">超過此限制的查詢會進行序列化而且可能會逾時。</span><span class="sxs-lookup"><span data-stu-id="3813e-161">Queries above the limit are serialized and may time out.</span></span>  
  
 <span data-ttu-id="3813e-162">此伺服器會提供可控制哪些資料採礦演算法可用的其他屬性，包括演算法的任何相關限制，以及所有資料採礦服務的預設值。</span><span class="sxs-lookup"><span data-stu-id="3813e-162">The server provides additional properties that control which data mining algorithms are available, including any restrictions on the algorithms, and the defaults for all data mining services.</span></span> <span data-ttu-id="3813e-163">不過，目前沒有任何設定可讓您特別控制資料採礦預存程序的存取權。</span><span class="sxs-lookup"><span data-stu-id="3813e-163">However, there are no settings that allow you to control access to data mining stored procedures specifically.</span></span> <span data-ttu-id="3813e-164">如需詳細資訊，請參閱 [資料採礦屬性](../server-properties/data-mining-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="3813e-164">For more information, see [Data Mining Properties](../server-properties/data-mining-properties.md).</span></span>  
  
 <span data-ttu-id="3813e-165">您也可以設定屬性，以便微調伺服器以及控制用戶端使用量的安全性。</span><span class="sxs-lookup"><span data-stu-id="3813e-165">You can also set properties that let you tune the server and control security for client usage.</span></span> <span data-ttu-id="3813e-166">如需詳細資訊，請參閱 [功能屬性](../server-properties/feature-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="3813e-166">For more information, see [Feature Properties](../server-properties/feature-properties.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3813e-167">如需版本支援外掛程式演算法的詳細資訊 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ，請參閱[SQL Server 2012 (版本支援的功能](https://go.microsoft.com/fwlink/?linkid=232473) https://go.microsoft.com/fwlink/?linkid=232473) 。</span><span class="sxs-lookup"><span data-stu-id="3813e-167">For more information about Support for plug-in algorithms by the editions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], see [Features Supported by the Editions of SQL Server 2012](https://go.microsoft.com/fwlink/?linkid=232473) (https://go.microsoft.com/fwlink/?linkid=232473).</span></span>  
  
## <a name="programmatic-access-to-data-mining-objects"></a><span data-ttu-id="3813e-168">以程式設計方式存取資料採礦物件</span><span class="sxs-lookup"><span data-stu-id="3813e-168">Programmatic Access to Data Mining Objects</span></span>  
 <span data-ttu-id="3813e-169">您可以使用下列物件模型來建立 Analysis Services 資料庫的連接以及使用資料採礦物件：</span><span class="sxs-lookup"><span data-stu-id="3813e-169">You can use the following object models to create a connection to an Analysis Services database and work with data mining objects:</span></span>  
  
 <span data-ttu-id="3813e-170">**ADO** ：使用 OLE DB 來連接至 Analysis Services 伺服器。</span><span class="sxs-lookup"><span data-stu-id="3813e-170">**ADO** Uses OLE DB to connect to an Analysis Services server.</span></span> <span data-ttu-id="3813e-171">當您使用 ADO 時，用戶端就會限制為結構描述資料列集查詢和 DMX 陳述式。</span><span class="sxs-lookup"><span data-stu-id="3813e-171">When you use ADO, the client is limited to schema rowset queries and DMX statements.</span></span>  
  
 <span data-ttu-id="3813e-172">**ADO.NET** ：與 SQL Server 提供者互動的效果比其他提供者較佳。</span><span class="sxs-lookup"><span data-stu-id="3813e-172">**ADO.NET** Interacts with SQL Server providers better than other providers.</span></span> <span data-ttu-id="3813e-173">使用資料配接器來儲存動態資料列集。</span><span class="sxs-lookup"><span data-stu-id="3813e-173">Uses data adaptors to store dynamic rowsets.</span></span> <span data-ttu-id="3813e-174">使用資料集物件，而這是儲存成可當做 XML 進行更新或儲存之資料表的伺服器資料快取。</span><span class="sxs-lookup"><span data-stu-id="3813e-174">Uses the dataset object, which is a cache of the server data stored as data tables that can be updated or saved as XML.</span></span>  
  
 <span data-ttu-id="3813e-175">**ADOMD.NET** ：針對使用資料採礦和 OLAP 最佳化的 Managed 資料提供者。</span><span class="sxs-lookup"><span data-stu-id="3813e-175">**ADOMD.NET** A managed data provider that is optimized for working with data mining and OLAP.</span></span> <span data-ttu-id="3813e-176">相較於 ADO.NET 而言，ADOMD.NET 的速度較快而且記憶體效率較高。</span><span class="sxs-lookup"><span data-stu-id="3813e-176">ADOMD.NET is faster and more memory-efficient than ADO.NET.</span></span> <span data-ttu-id="3813e-177">ADOMD.NET 也可以讓您擷取有關伺服器物件的中繼資料。</span><span class="sxs-lookup"><span data-stu-id="3813e-177">ADOMD.NET also lets you retrieve metadata about server objects.</span></span> <span data-ttu-id="3813e-178">建議用戶端應用程式採用 (.NET 無法使用時除外)。</span><span class="sxs-lookup"><span data-stu-id="3813e-178">Recommended for client applications except when .NET is not available.</span></span>  
  
 <span data-ttu-id="3813e-179">**Server ADOMD** ：直接在伺服器上存取 Analysis Services 物件的物件模型。</span><span class="sxs-lookup"><span data-stu-id="3813e-179">**Server ADOMD** Object model for accessing Analysis Services objects directly on the server.</span></span> <span data-ttu-id="3813e-180">由 Analysis Services 預存程序使用，但不適合用戶端使用。</span><span class="sxs-lookup"><span data-stu-id="3813e-180">Used by Analysis Services stored procedures; not for client use.</span></span>  
  
 <span data-ttu-id="3813e-181">**AMO** ：取代決策支援物件 (DSO) 的 Analysis Services 管理介面。</span><span class="sxs-lookup"><span data-stu-id="3813e-181">**AMO** Management interface for Analysis Services that replaces Decision Support Objects (DSO).</span></span> <span data-ttu-id="3813e-182">反覆運算物件等作業在使用 AMO 時會比使用其他介面需要更高的權限。</span><span class="sxs-lookup"><span data-stu-id="3813e-182">Operations such as iterating objects require higher permissions when using AMO than when using other interfaces.</span></span> <span data-ttu-id="3813e-183">這是因為 AMO 會直接存取中繼資料，而 ADOMD.NET 和其他介面只會存取資料庫結構描述。</span><span class="sxs-lookup"><span data-stu-id="3813e-183">That is because AMO accesses metadata directly, whereas ADOMD.NET and other interfaces access only the database schemas.</span></span>  
  
### <a name="browse-and-query-access-to-servers"></a><span data-ttu-id="3813e-184">伺服器的瀏覽和查詢存取</span><span class="sxs-lookup"><span data-stu-id="3813e-184">Browse and Query Access to Servers</span></span>  
 <span data-ttu-id="3813e-185">您可以使用 OLAP/資料採礦模式中的 Analysis Services 執行個體來執行所有種類的預測，但是有下列限制：</span><span class="sxs-lookup"><span data-stu-id="3813e-185">You can perform all kinds of predictions by using a instance of Analysis Services in OLAP/Data Mining mode, with the following restrictions:</span></span>  
  
-   <span data-ttu-id="3813e-186">如果您使用伺服器 ADOMD，就可以使用 DMX 來存取伺服器，而不需要建立連接。</span><span class="sxs-lookup"><span data-stu-id="3813e-186">If you use server ADOMD, you can use DMX to access the server without making a connection.</span></span> <span data-ttu-id="3813e-187">然後，您可以將結果直接複製到資料表中。</span><span class="sxs-lookup"><span data-stu-id="3813e-187">You can then copy the results directly into a data table.</span></span> <span data-ttu-id="3813e-188">不過，您無法使用 Server ADOMD 搭配遠端執行個體。您只能查詢本機伺服器。</span><span class="sxs-lookup"><span data-stu-id="3813e-188">However, you cannot use Server ADOMD with remote instances; you can query only the local server.</span></span>  
  
-   <span data-ttu-id="3813e-189">ADO.NET 不支援適用於資料採礦的具名參數。</span><span class="sxs-lookup"><span data-stu-id="3813e-189">ADO.NET does not support named parameters for data mining.</span></span> <span data-ttu-id="3813e-190">您必須使用 ADOMD.NET。</span><span class="sxs-lookup"><span data-stu-id="3813e-190">You must use ADOMD.NET.</span></span>  
  
-   <span data-ttu-id="3813e-191">ADOMD.NET 可讓您傳遞整個資料表，以便當做參數使用。因此，您可以使用用戶端的資料，或是伺服器無法使用的資料。</span><span class="sxs-lookup"><span data-stu-id="3813e-191">ADOMD.NET lets you pass an entire table to use as the parameter; therefore, you can use data on the client, or data that is unavailable to the server.</span></span> <span data-ttu-id="3813e-192">您也可以將已成形的資料表當做預測輸入使用。</span><span class="sxs-lookup"><span data-stu-id="3813e-192">You can also use shaped tables as prediction input.</span></span>  
  
### <a name="using-data-mining-stored-procedures"></a><span data-ttu-id="3813e-193">使用資料採礦預存程序</span><span class="sxs-lookup"><span data-stu-id="3813e-193">Using Data Mining Stored Procedures</span></span>  
 <span data-ttu-id="3813e-194">預存程序的常見用法是封裝查詢，以便重複使用。</span><span class="sxs-lookup"><span data-stu-id="3813e-194">A common use of stored procedures is to encapsulate queries for reuse.</span></span> <span data-ttu-id="3813e-195">用戶端可以使用 CALL 來執行預存程序，包括 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 系統預存程序。</span><span class="sxs-lookup"><span data-stu-id="3813e-195">The client can use CALL to run stored procedures, including [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] system stored procedures.</span></span>  
  
 <span data-ttu-id="3813e-196">如果此程序傳回資料集，用戶端將會收到資料集或資料表，其中具有包含資料列的巢狀資料表。</span><span class="sxs-lookup"><span data-stu-id="3813e-196">If the procedure returns a dataset, the client will receive a dataset or datatable with a nested table containing the rows.</span></span> <span data-ttu-id="3813e-197">例如，如果您針對模型內容建立查詢，此查詢會傳回整個模型。</span><span class="sxs-lookup"><span data-stu-id="3813e-197">For example, if you create a query against the model content, the query returns the entire model.</span></span> <span data-ttu-id="3813e-198">若要避免傳回太多資料列，您可以使用 ADOMD+ 物件模型來撰寫預存程序。</span><span class="sxs-lookup"><span data-stu-id="3813e-198">To avoid bringing back too many rows, you can write stored procedures by using the ADOMD+ object model.</span></span>  
  
 <span data-ttu-id="3813e-199">若要撰寫伺服器預存程序，您必須參考 Microsoft.AnalysisServices.AdomdServer 命名空間。</span><span class="sxs-lookup"><span data-stu-id="3813e-199">To write a server stored procedure, you must reference the Microsoft.AnalysisServices.AdomdServer namespace.</span></span> <span data-ttu-id="3813e-200">如需如何建立和使用預存程序的詳細資訊，請參閱 [使用者定義函數和預存程序](https://docs.microsoft.com/analysis-services/adomd/multidimensional-models-adomd-net-server/user-defined-functions-and-stored-procedures)。</span><span class="sxs-lookup"><span data-stu-id="3813e-200">For more information about how to create and use stored procedures, see [User Defined Functions and Stored Procedures](https://docs.microsoft.com/analysis-services/adomd/multidimensional-models-adomd-net-server/user-defined-functions-and-stored-procedures).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3813e-201">預存程序無法用來變更資料伺服器物件的安全性。</span><span class="sxs-lookup"><span data-stu-id="3813e-201">Stored procedures cannot be used to change security on data server objects.</span></span> <span data-ttu-id="3813e-202">當您執行某個預存程序時，使用者的目前內容就會用來決定所有伺服器物件的存取權。</span><span class="sxs-lookup"><span data-stu-id="3813e-202">When you execute a stored procedure, the user's current context is used to determine access to all server objects.</span></span> <span data-ttu-id="3813e-203">因此，使用者必須針對他們所存取的任何資料庫物件擁有適當的權限。</span><span class="sxs-lookup"><span data-stu-id="3813e-203">Therefore, users must have appropriate permissions on any database objects that they access.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3813e-204">另請參閱</span><span class="sxs-lookup"><span data-stu-id="3813e-204">See Also</span></span>  
 <span data-ttu-id="3813e-205">[實體架構 &#40;Analysis Services-多維度資料&#41;](../multidimensional-models/olap-physical/understanding-microsoft-olap-physical-architecture.md) </span><span class="sxs-lookup"><span data-stu-id="3813e-205">[Physical Architecture &#40;Analysis Services - Multidimensional Data&#41;](../multidimensional-models/olap-physical/understanding-microsoft-olap-physical-architecture.md) </span></span>  
 <span data-ttu-id="3813e-206">[實體架構 &#40;Analysis Services-資料採礦&#41;](physical-architecture-analysis-services-data-mining.md) </span><span class="sxs-lookup"><span data-stu-id="3813e-206">[Physical Architecture &#40;Analysis Services - Data Mining&#41;](physical-architecture-analysis-services-data-mining.md) </span></span>  
 [<span data-ttu-id="3813e-207">資料採礦方案與物件的管理</span><span class="sxs-lookup"><span data-stu-id="3813e-207">Management of Data Mining Solutions and Objects</span></span>](management-of-data-mining-solutions-and-objects.md)  
  
  
