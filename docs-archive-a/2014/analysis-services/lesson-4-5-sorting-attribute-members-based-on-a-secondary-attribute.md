---
title: 根據次要屬性排序屬性成員 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 67dacf68-9ab7-4524-8698-844d0f6e6c6d
author: minewiskan
ms.author: owend
ms.openlocfilehash: b90888c331a1ae1f8dd886e88d5c84afebd99cf5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87709982"
---
# <a name="sorting-attribute-members-based-on-a-secondary-attribute"></a><span data-ttu-id="6bd08-102">依次要屬性來排序屬性成員</span><span class="sxs-lookup"><span data-stu-id="6bd08-102">Sorting Attribute Members Based on a Secondary Attribute</span></span>
  <span data-ttu-id="6bd08-103">在第 3 課，您學會如何根據名稱或索引鍵值排序屬性成員。</span><span class="sxs-lookup"><span data-stu-id="6bd08-103">In Lesson 3, you learned how to sort attribute members based on either their name or key value.</span></span> <span data-ttu-id="6bd08-104">您也學會如何使用複合成員索引鍵來影響屬性成員和排序次序。</span><span class="sxs-lookup"><span data-stu-id="6bd08-104">You also learned how to use a composite member key to affect attribute members and sort order.</span></span> <span data-ttu-id="6bd08-105">如需詳細資訊，請參閱 [修改 Date 維度](lesson-3-4-modifying-the-date-dimension.md)。</span><span class="sxs-lookup"><span data-stu-id="6bd08-105">For more information, see [Modifying the Date Dimension](lesson-3-4-modifying-the-date-dimension.md).</span></span> <span data-ttu-id="6bd08-106">不過，如果屬性的名稱或索引鍵都無法提供想要的排序次序，您可以使用次要屬性來達成所需的排序次序。</span><span class="sxs-lookup"><span data-stu-id="6bd08-106">However, if neither the name nor the key of the attribute provide the sort order that you want, you can use a secondary attribute to achieve the desired sort order.</span></span> <span data-ttu-id="6bd08-107">藉由定義屬性之間的關聯性，您可以使用次要屬性排序第一個屬性的成員。</span><span class="sxs-lookup"><span data-stu-id="6bd08-107">By defining a relationship between the attributes, you can use the second attribute to sort the members of the first attribute.</span></span>  
  
 <span data-ttu-id="6bd08-108">屬性關聯性定義屬性之間的關聯性或相依性。</span><span class="sxs-lookup"><span data-stu-id="6bd08-108">Attribute relationships define the relationships or dependencies between attributes.</span></span> <span data-ttu-id="6bd08-109">在以單一關聯式資料表為基礎的維度中，所有屬性通常都是透過索引鍵屬性而彼此相關。</span><span class="sxs-lookup"><span data-stu-id="6bd08-109">In a dimension that is based on a single relational table, all attributes are typically related to each other through the key attribute.</span></span> <span data-ttu-id="6bd08-110">這是因為維度的所有屬性會提供有關成員的資訊，這些成員會由維度的索引鍵屬性連結到各個相關量值群組之事實資料表中的事實。</span><span class="sxs-lookup"><span data-stu-id="6bd08-110">This is because all the attributes for a dimension provide information about the members linked by the key attribute of the dimension to the facts in the fact table for each related measure group.</span></span> <span data-ttu-id="6bd08-111">在以多份資料表為基礎的維度中，屬性通常是依據資料表之間的聯結索引鍵來連結。</span><span class="sxs-lookup"><span data-stu-id="6bd08-111">In a dimension that is based on multiple tables, attributes are typically linked based on the join key between the tables.</span></span> <span data-ttu-id="6bd08-112">如果基礎資料支援屬性關聯性，相關屬性可用來指定排序次序。</span><span class="sxs-lookup"><span data-stu-id="6bd08-112">If the underlying data supports it, related attributes can be used to specify a sort order.</span></span> <span data-ttu-id="6bd08-113">例如，您可以建立提供相關屬性排序邏輯的新屬性。</span><span class="sxs-lookup"><span data-stu-id="6bd08-113">For example, you might create a new attribute that provides the sort logic for a related attribute.</span></span>  
  
 <span data-ttu-id="6bd08-114">維度設計師可讓您定義屬性之間的其他關聯性，或變更預設關聯性來增加效能。</span><span class="sxs-lookup"><span data-stu-id="6bd08-114">Dimension Designer lets you define additional relationships between attributes or change the default relationships to increase performance.</span></span> <span data-ttu-id="6bd08-115">當您建立屬性關聯性時，主要條件約束是要確定所參考的屬性對於它相關的屬性中的任何成員只有一個值。</span><span class="sxs-lookup"><span data-stu-id="6bd08-115">The main constraint when you create an attribute relationship is to make sure that the attribute referred to has no more than one value for any member in the attribute to which it is related.</span></span> <span data-ttu-id="6bd08-116">當您在兩個屬性之間定義關聯性時，可以依據成員之間的關聯性是否因為時間而改變來定義固定或彈性關聯性。</span><span class="sxs-lookup"><span data-stu-id="6bd08-116">When you define a relationship between two attributes, you can define the relationship as rigid or flexible, based on whether the relationships between members will change over time.</span></span> <span data-ttu-id="6bd08-117">例如，員工可能會移至不同的銷售地區，但縣 (市) 卻不會移至不同省份。</span><span class="sxs-lookup"><span data-stu-id="6bd08-117">For example, an employee might move to a different sales region, but a city will not move to a different state.</span></span> <span data-ttu-id="6bd08-118">如果定義固定關聯性，則每次累加處理維度時不會重新計算屬性彙總。</span><span class="sxs-lookup"><span data-stu-id="6bd08-118">If a relationship is defined as rigid, attribute aggregations are not recalculated every time the dimension is incrementally processed.</span></span> <span data-ttu-id="6bd08-119">不過，如果成員之間的關聯性改變，維度必須完全處理。</span><span class="sxs-lookup"><span data-stu-id="6bd08-119">However, if the relationship between members does change, the dimension must be fully processed.</span></span> <span data-ttu-id="6bd08-120">如需詳細資訊，請參閱 [屬性關聯性](multidimensional-models-olap-logical-dimension-objects/attribute-relationships.md)、 [定義屬性關聯性](multidimensional-models/attribute-relationships-define.md)、 [設定屬性關聯性屬性](multidimensional-models/attribute-relationships-configure-attribute-properties.md)和 [在使用者定義階層的屬性之間指定屬性關聯性](4-6-specifying-attribute-relationships-in-user-defined-hierarchy.md)。</span><span class="sxs-lookup"><span data-stu-id="6bd08-120">For more information, see [Attribute Relationships](multidimensional-models-olap-logical-dimension-objects/attribute-relationships.md), [Define Attribute Relationships](multidimensional-models/attribute-relationships-define.md), [Configure Attribute Relationship Properties](multidimensional-models/attribute-relationships-configure-attribute-properties.md), and [Specifying Attribute Relationships Between Attributes in a User-Defined Hierarchy](4-6-specifying-attribute-relationships-in-user-defined-hierarchy.md).</span></span>  
  
 <span data-ttu-id="6bd08-121">在這個主題的工作中，您會根據基礎維度資料表的現有資料行來定義 [日期]\*\*\*\* 維度中的新屬性。</span><span class="sxs-lookup"><span data-stu-id="6bd08-121">In the tasks in this topic, you will define a new attribute in the **Date** dimension based on an existing column in the underlying dimension table.</span></span> <span data-ttu-id="6bd08-122">您會使用這個新屬性，按照時間順序而非字母順序來排序日曆月成員。</span><span class="sxs-lookup"><span data-stu-id="6bd08-122">You will use this new attribute to sort calendar month members chronologically instead of alphabetically.</span></span> <span data-ttu-id="6bd08-123">您也會根據用來排序 [通勤距離]\*\*\*\* 屬性成員的具名計算來定義 [客戶]\*\*\*\* 維度中的新屬性。</span><span class="sxs-lookup"><span data-stu-id="6bd08-123">You will also define a new attribute in the **Customer** dimension based on the named calculation that you will use to sort the **Commute Distance** attribute members.</span></span> <span data-ttu-id="6bd08-124">在下一個主題的工作中，您會學到如何使用屬性關聯性來增加查詢效能。</span><span class="sxs-lookup"><span data-stu-id="6bd08-124">In the tasks in the next topic, you will learn to use attribute relationships to increase query performance.</span></span>  
  
## <a name="defining-an-attribute-relationship-and-sort-order-in-the-date-dimension"></a><span data-ttu-id="6bd08-125">在日期維度中定義屬性關聯性和排序次序</span><span class="sxs-lookup"><span data-stu-id="6bd08-125">Defining an Attribute Relationship and Sort Order in the Date Dimension</span></span>  
  
1.  <span data-ttu-id="6bd08-126">開啟 [日期]\*\*\*\* 維度的 [維度設計師]，然後在 [屬性] 視窗中檢閱 [月份]\*\*\*\* 屬性 (attribute) 的 [OrderBy]\*\*\*\* 屬性 (property)。</span><span class="sxs-lookup"><span data-stu-id="6bd08-126">Open Dimension Designer for the **Date** dimension, and then review the **OrderBy** property for the **Month Name** attribute in the Properties window.</span></span>  
  
     <span data-ttu-id="6bd08-127">請注意，[月份]\*\*\*\* 屬性成員是按照索引鍵值來排序。</span><span class="sxs-lookup"><span data-stu-id="6bd08-127">Notice that the **Month Name** attribute members are ordered by their key values.</span></span>  
  
2.  <span data-ttu-id="6bd08-128">切換到 [瀏覽器]\*\*\*\* 索引標籤，確認已在 [階層]\*\*\*\* 清單中選取 [日曆日期]\*\*\*\*，然後展開使用者定義階層中的層級來檢閱日曆月的排序次序。</span><span class="sxs-lookup"><span data-stu-id="6bd08-128">Switch to the **Browser** tab, verify that **Calendar Date** is selected in the **Hierarchy** list, and then expand the levels in the user-defined hierarchy to review the sort order for the calendar months.</span></span>  
  
     <span data-ttu-id="6bd08-129">請注意，屬性階層的成員是依據成員索引鍵的 ASCII 值排序，也就是月和年。</span><span class="sxs-lookup"><span data-stu-id="6bd08-129">Notice that the members of the attribute hierarchy are sorted based on the ASCII values of their member keys, which are month and year.</span></span> <span data-ttu-id="6bd08-130">在這種情形下，按照屬性名稱或索引鍵排序並不會按時間順序排序日曆月。</span><span class="sxs-lookup"><span data-stu-id="6bd08-130">In this case, sorting by the attribute name or key does not sort calendar months chronologically.</span></span> <span data-ttu-id="6bd08-131">若要解決這個問題，您要依據一個新屬性來排序屬性階層的成員，亦即 [MonthNumberOfYear]\*\*\*\* 屬性。</span><span class="sxs-lookup"><span data-stu-id="6bd08-131">To solve this, you will sort the members of the attribute hierarchy based on a new attribute, the **MonthNumberOfYear** attribute.</span></span> <span data-ttu-id="6bd08-132">您將根據已存在於 [日期]\*\*\*\* 維度資料表中的資料行來建立這個屬性。</span><span class="sxs-lookup"><span data-stu-id="6bd08-132">You will create this attribute based on a column that conveniently exists in the **Date** dimension table.</span></span>  
  
3.  <span data-ttu-id="6bd08-133">切換到 [日期] 維度的 [維度結構]\*\*\*\* 索引標籤，然後以滑鼠右鍵按一下 [資料來源檢視]\*\*\*\* 窗格中的 [MonthNumberOfYear]\*\*\*\*，然後按一下 [從資料行新增屬性]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-133">Switch to the **Dimension Structure** tab for the Date dimension, right-click **MonthNumberOfYear** in the **Data Source View** pane, and then click **New Attribute from Column**.</span></span>  
  
4.  <span data-ttu-id="6bd08-134">在 [屬性]\*\*\*\* 窗格中，選取 [Month Number Of Year (年中的月份)]\*\*\*\*，然後在 [屬性] 視窗中將 [AttributeHierarchyEnabled]\*\*\*\* 屬性設為 [False]\*\*\*\*、將 [AttributeHierarchyOptimizedState]\*\*\*\* 屬性設為 [NotOptimized]\*\*\*\*，並將 [AttributeHierarchyOrdered]\*\*\*\* 屬性設為 [False]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-134">In the **Attributes** pane, select **Month Number Of Year**, and then set the **AttributeHierarchyEnabled** property to **False** in the Properties window, set the **AttributeHierarchyOptimizedState** property to **NotOptimized**, and set the **AttributeHierarchyOrdered** property to **False**.</span></span>  
  
     <span data-ttu-id="6bd08-135">這些設定會把屬性隱藏起來，讓使用者看不到它們，並改善處理時間。</span><span class="sxs-lookup"><span data-stu-id="6bd08-135">These settings will hide the attribute from users and will improve processing time.</span></span> <span data-ttu-id="6bd08-136">這個屬性不會用於瀏覽，</span><span class="sxs-lookup"><span data-stu-id="6bd08-136">This attribute will not be used for browsing.</span></span> <span data-ttu-id="6bd08-137">它只會用於排列另一個屬性成員的順序。</span><span class="sxs-lookup"><span data-stu-id="6bd08-137">It will only be used for ordering the members of another attribute.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6bd08-138">如果依字母順序排序 [屬性] 視窗中的屬性，將可簡化這項工作，因為這三個屬性在排序後將會彼此相鄰。</span><span class="sxs-lookup"><span data-stu-id="6bd08-138">Sorting properties in the Properties window alphabetically will simplify this task as these three properties will be sorted adjacent to each other.</span></span>  
  
5.  <span data-ttu-id="6bd08-139">按一下 **[屬性關聯性]** 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="6bd08-139">Click the **Attribute Relationships** tab.</span></span>  
  
     <span data-ttu-id="6bd08-140">請注意，[日期]\*\*\*\* 維度中的所有屬性都與 [日期]\*\*\*\* 屬性直接相關，而該屬性是成員索引鍵，它會使維度成員與相關量值群組中的事實產生關聯。</span><span class="sxs-lookup"><span data-stu-id="6bd08-140">Notice that all the attributes in the **Date** dimension are related directly to the **Date** attribute, which is the member key that relates the dimension members to the facts in the related measure groups.</span></span> <span data-ttu-id="6bd08-141">不過，[月份]\*\*\*\* 屬性和 [Month Number Of Year (年中的月份)]\*\*\*\* 屬性之間沒有定義關聯性。</span><span class="sxs-lookup"><span data-stu-id="6bd08-141">There is no relationship defined between the **Month Name** attribute and the **Month Number Of Year** attribute.</span></span>  
  
6.  <span data-ttu-id="6bd08-142">在圖表中，以滑鼠右鍵按一下 [月份]\*\*\*\* 屬性，然後選取 [新增屬性關聯性]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-142">In the diagram, right-click the **Month Name** attribute and then select **New Attribute Relationship**.</span></span>  
  
7.  <span data-ttu-id="6bd08-143">在 [建立屬性關聯性]\*\*\*\* 對話方塊中，[來源屬性]\*\*\*\* 是 [月份]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-143">In the **Create Attribute Relationship** dialog box, the **Source Attribute** is **Month Name**.</span></span> <span data-ttu-id="6bd08-144">將 [相關屬性]\*\*\*\* 設定為 [Month Number Of Year (年中的月份)]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-144">Set the **Related Attribute** to **Month Number Of Year**.</span></span>  
  
8.  <span data-ttu-id="6bd08-145">在 [關聯性類型]\*\*\*\* 清單中，將關聯性類型設定為 [固定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-145">In the **Relationship type** list, set the relationship type to **Rigid**.</span></span>  
  
     <span data-ttu-id="6bd08-146">[月份]\*\*\*\* 屬性和 [Month Number Of Year (年中的月份)]\*\*\*\* 屬性的成員之間的關聯性不會隨時間而改變。</span><span class="sxs-lookup"><span data-stu-id="6bd08-146">The relationships between the members of the **Month Name** attribute and the **Month Number Of Year** attribute will not change over time.</span></span> <span data-ttu-id="6bd08-147">因此，在累加式處理期間，Analysis Services 不會卸除此關聯性的彙總。</span><span class="sxs-lookup"><span data-stu-id="6bd08-147">As a result, Analysis Services will not drop aggregations for this relationship during incremental processing.</span></span> <span data-ttu-id="6bd08-148">如果真的發生變更，在累加式處理期間將會產生處理錯誤，到時候您就必須執行維度的完整處理。</span><span class="sxs-lookup"><span data-stu-id="6bd08-148">If a change does occur, a processing error will occur during incremental processing and you will need to perform a full process of the dimension.</span></span> <span data-ttu-id="6bd08-149">現在您可以設定 [月份]\*\*\*\* 之成員的排序順序。</span><span class="sxs-lookup"><span data-stu-id="6bd08-149">You are now ready to set the sort order for the members of **Month Name**.</span></span>  
  
9. [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
10. <span data-ttu-id="6bd08-150">按一下 [維度結構]\*\*\*\* 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="6bd08-150">Click the **Dimension Structure** tab.</span></span>  
  
11. <span data-ttu-id="6bd08-151">在 [屬性]\*\*\*\* 窗格中選取 [月份]\*\*\*\*，然後將 [屬性] 視窗中的 [OrderBy]\*\*\*\* 屬性值變更為 [AttributeKey]\*\*\*\*，將 [OrderByAttribute]\*\*\*\* 屬性值變更為 [Month Number Of Year (年中的月份)]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-151">Select **Month Name** in the **Attributes** pane, and then change the value of the **OrderBy** property in the Properties window to **AttributeKey** and change the value of the **OrderByAttribute** property to **Month Number Of Year**.</span></span>  
  
12. <span data-ttu-id="6bd08-152">在 [建立]\*\*\*\* 功能表上，按一下 [部署 Analysis Services 教學課程]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-152">On the **Build** menu, click **Deploy Analysis Services Tutorial**.</span></span>  
  
13. <span data-ttu-id="6bd08-153">順利完成部署之後，請切換到 [日期] 維度的 [瀏覽器]\*\*\*\* 索引標籤，並按一下 [重新連接]\*\*\*\*，然後瀏覽 [日曆日期]\*\*\*\* 和 [會計日期]\*\*\*\* 使用者階層，以確認月份現在是按照時間順序排序。</span><span class="sxs-lookup"><span data-stu-id="6bd08-153">When deployment has successfully completed, switch to the **Browser** tab for the Date dimension, click **Reconnect**, and then browse the **Calendar Date** and **Fiscal Date** user hierarchies to verify that months now sort in chronological order.</span></span>  
  
     <span data-ttu-id="6bd08-154">請注意，月份現在是按照時間順序排序，如下圖所示。</span><span class="sxs-lookup"><span data-stu-id="6bd08-154">Notice that the months are now sorted in chronological order, as shown in the following image.</span></span>  
  
     <span data-ttu-id="6bd08-155">![依時間順序的已修改使用者階層](../../2014/tutorials/media/l4-memberproperties-3.gif "依時間順序的已修改使用者階層")</span><span class="sxs-lookup"><span data-stu-id="6bd08-155">![Modified user hierarchy in chronological order](../../2014/tutorials/media/l4-memberproperties-3.gif "Modified user hierarchy in chronological order")</span></span>  
  
## <a name="defining-attribute-relationships-and-sort-order-in-the-customer-dimension"></a><span data-ttu-id="6bd08-156">在客戶維度中定義屬性關聯性和排序順序</span><span class="sxs-lookup"><span data-stu-id="6bd08-156">Defining Attribute Relationships and Sort Order in the Customer Dimension</span></span>  
  
1.  <span data-ttu-id="6bd08-157">切換至 [客戶] 維度之 [維度設計師] 的 [瀏覽器]\*\*\*\* 索引標籤，然後瀏覽 [通勤距離]\*\*\*\* 屬性階層的成員。</span><span class="sxs-lookup"><span data-stu-id="6bd08-157">Switch to the **Browser** tab in Dimension Designer for the Customer dimension, and then browse the members of the **Commute Distance** attribute hierarchy.</span></span>  
  
     <span data-ttu-id="6bd08-158">請注意，這個屬性階層的成員是依據成員索引鍵的 ASCII 值排序。</span><span class="sxs-lookup"><span data-stu-id="6bd08-158">Notice that the members of this attribute hierarchy are sorted based on the ASCII values of the member key.</span></span> <span data-ttu-id="6bd08-159">在這種情形下，按照屬性名稱或索引鍵排序並不會將通勤距離從小排到大。</span><span class="sxs-lookup"><span data-stu-id="6bd08-159">In this case, sorting by the attribute name or key does not sort the commute distances from least to most.</span></span> <span data-ttu-id="6bd08-160">在這項工作中，您會根據 **CommuteDistanceSort** 具名計算來排序屬性階層的成員，而適當的排序編號將歸因於資料行的每一個相異值。</span><span class="sxs-lookup"><span data-stu-id="6bd08-160">In this task, you sort the members of the attribute hierarchy based on the **CommuteDistanceSort** named calculation that ascribes the appropriate sort number to each distinct value in the column.</span></span> <span data-ttu-id="6bd08-161">為了節省時間，這個具名計算已經新增至 **DW 資料來源檢視的** Customer [!INCLUDE[ssSampleDBCoShort](../includes/sssampledbcoshort-md.md)] 資料表。</span><span class="sxs-lookup"><span data-stu-id="6bd08-161">To save time, this named calculation has already been added to the **Customer** table in the [!INCLUDE[ssSampleDBCoShort](../includes/sssampledbcoshort-md.md)] DW data source view.</span></span> <span data-ttu-id="6bd08-162">您可以切換至這個資料來源檢視，以便檢視此具名計算中使用的 SQL 指令碼。</span><span class="sxs-lookup"><span data-stu-id="6bd08-162">You can switch to this data source view to view the SQL script that is used in this named calculation.</span></span> <span data-ttu-id="6bd08-163">如需詳細資訊，請參閱[在資料來源檢視中定義具名計算 &#40;Analysis Services&#41;](multidimensional-models/define-named-calculations-in-a-data-source-view-analysis-services.md)。</span><span class="sxs-lookup"><span data-stu-id="6bd08-163">For more information, see [Define Named Calculations in a Data Source View &#40;Analysis Services&#41;](multidimensional-models/define-named-calculations-in-a-data-source-view-analysis-services.md).</span></span>  
  
     <span data-ttu-id="6bd08-164">下圖顯示 [通勤距離]\*\*\*\* 屬性階層的成員，它們是按照成員索引鍵的 ASCII 值來排序。</span><span class="sxs-lookup"><span data-stu-id="6bd08-164">The following image shows the members of the **Commute Distance** attribute hierarchy, sorted by the ASCII values of the member key.</span></span>  
  
     <span data-ttu-id="6bd08-165">![通勤距離屬性階層](../../2014/tutorials/media/l4-memberproperties-4.gif "通勤距離屬性階層")</span><span class="sxs-lookup"><span data-stu-id="6bd08-165">![Commute Distance attribute hierarchy](../../2014/tutorials/media/l4-memberproperties-4.gif "Commute Distance attribute hierarchy")</span></span>  
  
2.  <span data-ttu-id="6bd08-166">切換到 [客戶] 維度之 [維度設計師] 的 [維度結構]\*\*\*\* 索引標籤，並以滑鼠右鍵按一下 [資料來源檢視]\*\*\*\* 窗格中的 [客戶]\*\*\*\* 資料表的 [通勤距離排序]\*\*\*\*，然後按一下 [從資料行新增屬性]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-166">Switch to the **Dimension Structure** tab in Dimension Designer for the Customer dimension, right-click **CommuteDistanceSort** in the **Customer** table in the **Data Source View** pane, and then click **New Attribute from Column**.</span></span>  
  
3.  <span data-ttu-id="6bd08-167">在 [屬性]\*\*\*\* 窗格中，選取 [通勤距離排序]\*\*\*\*，然後在 [屬性] 視窗中將這個屬性的 [AttributeHierarchyEnabled]\*\*\*\* 屬性設為 [False]\*\*\*\*、將 [AttributeHierarchyOptimizedState]\*\*\*\* 屬性設為 [NotOptimized]\*\*\*\*，並將 [AttributeHierarchyOrdered]\*\*\*\* 屬性設為 [False]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-167">In the **Attributes** pane, select **Commute Distance Sort**, and then set the **AttributeHierarchyEnabled** property for this attribute to **False** in the Properties window, set the **AttributeHierarchyOptimizedState** property to **NotOptimized**, and set the **AttributeHierarchyOrdered** property to **False**.</span></span>  
  
     <span data-ttu-id="6bd08-168">這些設定會把屬性隱藏起來，讓使用者看不到它們，並改善處理時間。</span><span class="sxs-lookup"><span data-stu-id="6bd08-168">These settings will hide the attribute from users and will improve processing time.</span></span> <span data-ttu-id="6bd08-169">這個屬性不會用於瀏覽，</span><span class="sxs-lookup"><span data-stu-id="6bd08-169">This attribute will not be used for browsing.</span></span> <span data-ttu-id="6bd08-170">它只會用於排列另一個屬性成員的順序。</span><span class="sxs-lookup"><span data-stu-id="6bd08-170">It will only be used for ordering the members of another attribute.</span></span>  
  
4.  <span data-ttu-id="6bd08-171">選取 [地理位置]\*\*\*\*，然後在 [屬性] 窗格中將它的 [AttributeHierarchyVisible]\*\*\*\* 屬性設為 [False]\*\*\*\*、將它的 [AttributeHierarchyOptimizedState]\*\*\*\* 屬性設為 [NotOptimized]\*\*\*\*，並且將它的 [AttributeHierarchyOrdered]\*\*\*\* 屬性設為 [False]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-171">Select **Geography**, and then set its **AttributeHierarchyVisible** property to **False** in the Properties window, set its **AttributeHierarchyOptimizedState** property to **NotOptimized**, and set its **AttributeHierarchyOrdered** property to **False**.</span></span>  
  
     <span data-ttu-id="6bd08-172">這些設定會把屬性隱藏起來，讓使用者看不到它們，並改善處理時間。</span><span class="sxs-lookup"><span data-stu-id="6bd08-172">These settings will hide the attribute from users and will improve processing time.</span></span> <span data-ttu-id="6bd08-173">這個屬性不會用於瀏覽，</span><span class="sxs-lookup"><span data-stu-id="6bd08-173">This attribute will not be used for browsing.</span></span> <span data-ttu-id="6bd08-174">它只會用於排列另一個屬性成員的順序。</span><span class="sxs-lookup"><span data-stu-id="6bd08-174">It will be only be used for ordering the members of another attribute.</span></span> <span data-ttu-id="6bd08-175">因為 [地理位置]\*\*\*\* 具有成員屬性，所以其 [AttributeHierarchyEnabled]\*\*\*\* 屬性必須設定為 [True]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-175">Because **Geography** has member properties, its **AttributeHierarchyEnabled** property must be set to **True**.</span></span> <span data-ttu-id="6bd08-176">因此，若要隱藏該屬性 (attribute)，您可以將 [AttributeHierarchyVisible]\*\*\*\* 屬性 (property) 設定為 [False]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-176">Therefore, to hide the attribute, you set the **AttributeHierarchyVisible** property to **False**.</span></span>  
  
5.  <span data-ttu-id="6bd08-177">按一下 **[屬性關聯性]** 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="6bd08-177">Click the **Attribute Relationships** tab.</span></span>  
  
6.  <span data-ttu-id="6bd08-178">在屬性清單中，以滑鼠右鍵按一下 [通勤距離]\*\*\*\* 屬性，然後選取 [新增屬性關聯性]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-178">In the attributes list, right-click the **Commute Distance** attribute and then select **New Attribute Relationship**.</span></span>  
  
7.  <span data-ttu-id="6bd08-179">在 [建立屬性關聯性]\*\*\*\* 對話方塊中，[來源屬性]\*\*\*\* 是 [通勤距離]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-179">In the **Create Attribute Relationship** dialog box, the **Source Attribute** is **Commute Distance**.</span></span> <span data-ttu-id="6bd08-180">將 [相關屬性]\*\*\*\* 設定為 [通勤距離排序]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-180">Set the **Related Attribute** to **Commute Distance Sort**.</span></span>  
  
8.  <span data-ttu-id="6bd08-181">在 [關聯性類型]\*\*\*\* 清單中，將關聯性類型設定為 [固定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-181">In the **Relationship type** list, set the relationship type to **Rigid**.</span></span>  
  
     <span data-ttu-id="6bd08-182">[通勤距離]\*\*\*\* 屬性和 [通勤距離排序]\*\*\*\* 屬性的成員之間的關聯性不會隨時間而改變。</span><span class="sxs-lookup"><span data-stu-id="6bd08-182">The relationship between the members of the **Commute Distance** attribute and the **Commute Distance Sort** attribute will not change over time.</span></span>  
  
9. [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
     <span data-ttu-id="6bd08-183">現在您可以設定 [通勤距離]\*\*\*\* 屬性的排序順序。</span><span class="sxs-lookup"><span data-stu-id="6bd08-183">You are now ready to set the sort order for the **Commute Distance** attribute.</span></span>  
  
10. <span data-ttu-id="6bd08-184">按一下 [維度結構]\*\*\*\* 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="6bd08-184">Click the **Dimension Structure** tab.</span></span>  
  
11. <span data-ttu-id="6bd08-185">在 [屬性]\*\*\*\* 窗格中選取 [通勤距離]\*\*\*\*，並將 [屬性] 視窗中的 [OrderBy]\*\*\*\* 屬性值變更為 [AttributeKey]\*\*\*\*，然後將 [OrderByAttribute]\*\*\*\* 屬性值變更為 [通勤距離排序]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-185">In the **Attributes** pane, select **Commute Distance**, and then change the value of the **OrderBy** property in the Properties window to **AttributeKey**, and change the value of the **OrderByAttribute** property to **Commute Distance Sort**.</span></span>  
  
12. <span data-ttu-id="6bd08-186">在 [建立]\*\*\*\* 功能表上，按一下 [部署 Analysis Services 教學課程]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="6bd08-186">On the **Build** menu, click **Deploy Analysis Services Tutorial**.</span></span>  
  
13. <span data-ttu-id="6bd08-187">順利完成部署之後，切換到 [客戶] 維度之 [維度設計師] 的 [瀏覽器]\*\*\*\* 索引標籤，並按一下 [重新連接]\*\*\*\*，然後瀏覽 [通勤距離]\*\*\*\* 屬性階層。</span><span class="sxs-lookup"><span data-stu-id="6bd08-187">When deployment has successfully completed, switch to the **Browser** tab of Dimension Designer for the Customer dimension, click **Reconnect**, and then browse the **Commute Distance** attribute hierarchy.</span></span>  
  
     <span data-ttu-id="6bd08-188">請注意，屬性階層成員現在是依據遞增的距離按邏輯順序排序，如下圖所示。</span><span class="sxs-lookup"><span data-stu-id="6bd08-188">Notice that the attribute hierarchy members are now sorted in a logical order based on increasing distance, as shown in the following image.</span></span>  
  
     <span data-ttu-id="6bd08-189">![重新排序的通勤距離屬性階層](../../2014/tutorials/media/l4-memberproperties-5.gif "重新排序的通勤距離屬性階層")</span><span class="sxs-lookup"><span data-stu-id="6bd08-189">![Re-sorted Commute Distance attribute hierarchy](../../2014/tutorials/media/l4-memberproperties-5.gif "Re-sorted Commute Distance attribute hierarchy")</span></span>  
  
## <a name="next-task-in-lesson"></a><span data-ttu-id="6bd08-190">本課程的下一項工作</span><span class="sxs-lookup"><span data-stu-id="6bd08-190">Next Task in Lesson</span></span>  
 [<span data-ttu-id="6bd08-191">在使用者定義階層的屬性之間指定屬性關聯性</span><span class="sxs-lookup"><span data-stu-id="6bd08-191">Specifying Attribute Relationships Between Attributes in a User-Defined Hierarchy</span></span>](4-6-specifying-attribute-relationships-in-user-defined-hierarchy.md)  
  
  
