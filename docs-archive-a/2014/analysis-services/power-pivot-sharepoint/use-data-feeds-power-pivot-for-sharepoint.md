---
title: 使用資料摘要 (PowerPivot for SharePoint) |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 50140fdf-6fd1-41a1-9c14-8ecfb97ba2e1
author: minewiskan
ms.author: owend
ms.openlocfilehash: 19e3c5b448005314696f8167156a2326dc5009e1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87700312"
---
# <a name="use-data-feeds-powerpivot-for-sharepoint"></a><span data-ttu-id="dabcd-102">使用資料摘要 (PowerPivot for SharePoint)</span><span class="sxs-lookup"><span data-stu-id="dabcd-102">Use Data Feeds (PowerPivot for SharePoint)</span></span>
  <span data-ttu-id="dabcd-103">資料摘要是從線上資料來源產生，並串流至目的地文件或應用程式的一個或多個資料流。</span><span class="sxs-lookup"><span data-stu-id="dabcd-103">Data feeds are one or more data streams that are generated from an online data source and streamed to a destination document or application.</span></span> <span data-ttu-id="dabcd-104">如果您使用的是 PowerPivot for Excel，資料摘要可以協助您從任意資料來源取得現有的公司或商務資料，送到 Excel 2010 活頁簿的 PowerPivot 視窗中。</span><span class="sxs-lookup"><span data-stu-id="dabcd-104">If you are using PowerPivot for Excel, data feeds can help you get existing corporate or business data from arbitrary data sources into the PowerPivot window in your Excel 2010 workbook.</span></span> <span data-ttu-id="dabcd-105">將資料摘要匯入活頁簿之後，您可以在 SharePoint 伺服器上排程的任何資料重新整理作業中參考該摘要。</span><span class="sxs-lookup"><span data-stu-id="dabcd-105">After you import a data feed to a workbook, you can reference it later in any data refresh operations that you schedule on a SharePoint server.</span></span>  
  
 <span data-ttu-id="dabcd-106">您使用資料摘要的方式，取決於您是使用支援 Atom 資料摘要之應用程式中的內建匯出功能，還是建立並使用自訂資料服務。</span><span class="sxs-lookup"><span data-stu-id="dabcd-106">How you use a data feed depends on whether you are using built-in export features in applications that support Atom data feeds, or creating and using custom data services.</span></span> <span data-ttu-id="dabcd-107">能夠發行並讀取 Atom XML 資料的應用程式提供完美的資料傳輸，隱藏資料摘要與資料服務的機制，讓使用者看不到。</span><span class="sxs-lookup"><span data-stu-id="dabcd-107">Applications that are able to publish and read Atom XML data provide seamless data transfer that hides the mechanics of data feeds and data services from users.</span></span> <span data-ttu-id="dabcd-108">對使用者來說，只是將資料從一個應用程式移到另一個。</span><span class="sxs-lookup"><span data-stu-id="dabcd-108">To a user, he or she is simply moving data from one application to another.</span></span>  
  
 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]<span data-ttu-id="dabcd-109">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]和 Microsoft SharePoint 2010 提供可用於 PowerPivot 活頁簿的資料摘要。</span><span class="sxs-lookup"><span data-stu-id="dabcd-109">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] and Microsoft SharePoint 2010 provide data feeds that can be used in PowerPivot workbooks.</span></span> <span data-ttu-id="dabcd-110">您可以使用本主題中的資訊來了解如何從您已經擁有的報表與清單中存取資料摘要。</span><span class="sxs-lookup"><span data-stu-id="dabcd-110">You can use the information in this topic to learn how to access data feeds from reports and lists that you already have.</span></span>  
  
 <span data-ttu-id="dabcd-111">本主題包含下列幾節：</span><span class="sxs-lookup"><span data-stu-id="dabcd-111">This topic contains the following sections:</span></span>  
  
 [<span data-ttu-id="dabcd-112">先決條件</span><span class="sxs-lookup"><span data-stu-id="dabcd-112">Prerequisites</span></span>](#prereq)  
  
 [<span data-ttu-id="dabcd-113">從 SharePoint 清單建立資料摘要</span><span class="sxs-lookup"><span data-stu-id="dabcd-113">Create a Data Feed from a SharePoint List</span></span>](#sharepointlist)  
  
 [<span data-ttu-id="dabcd-114">從 Reporting Services 報表建立資料摘要</span><span class="sxs-lookup"><span data-stu-id="dabcd-114">Create a Data Feed from a Reporting Services Report</span></span>](#rsreport)  
  
 [<span data-ttu-id="dabcd-115">從資料服務檔建立資料摘要</span><span class="sxs-lookup"><span data-stu-id="dabcd-115">Create a Data Feed from a Data Service Document</span></span>](#dsdoc)  
  
##  <a name="prerequisites"></a><a name="prereq"></a> <span data-ttu-id="dabcd-116">必要條件</span><span class="sxs-lookup"><span data-stu-id="dabcd-116">Prerequisites</span></span>  
 <span data-ttu-id="dabcd-117">您必須具有 PowerPivot for Excel，才能將資料摘要匯入 Excel 2010。</span><span class="sxs-lookup"><span data-stu-id="dabcd-117">You must have the PowerPivot for Excel to import a data feed into Excel 2010.</span></span>  
  
 <span data-ttu-id="dabcd-118">您必須具有以 Atom 1.0 格式提供資料的 Web 服務或資料服務。</span><span class="sxs-lookup"><span data-stu-id="dabcd-118">You must have a Web service or a data service that provides data in the Atom 1.0 format.</span></span> <span data-ttu-id="dabcd-119">[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 和 SharePoint 2010 都可以用這種格式提供資料。</span><span class="sxs-lookup"><span data-stu-id="dabcd-119">Both [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] and SharePoint 2010 can provide data in this format.</span></span>  
  
 <span data-ttu-id="dabcd-120">在您可以將 SharePoint 清單匯出為資料摘要之前，您必須在 SharePoint 伺服器上安裝 ADO.NET Data Services。</span><span class="sxs-lookup"><span data-stu-id="dabcd-120">Before you can export a SharePoint list as a data feed, you must install ADO.NET Data Services on the SharePoint server.</span></span> <span data-ttu-id="dabcd-121">如需詳細資訊，請參閱 [安裝 ADO.NET Data Services 以支援 SharePoint 清單的資料摘要匯出](../../sql-server/install/install-ado-net-data-services-to-support-data-feed-exports-of-sharepoint-lists.md)。</span><span class="sxs-lookup"><span data-stu-id="dabcd-121">For more information, see [Install ADO.NET Data Services to support data feed exports of SharePoint lists](../../sql-server/install/install-ado-net-data-services-to-support-data-feed-exports-of-sharepoint-lists.md).</span></span>  
  
##  <a name="create-a-data-feed-from-a-sharepoint-list"></a><a name="sharepointlist"></a><span data-ttu-id="dabcd-122">從 SharePoint 清單建立資料摘要</span><span class="sxs-lookup"><span data-stu-id="dabcd-122">Create a Data Feed from a SharePoint List</span></span>  
 <span data-ttu-id="dabcd-123">在 SharePoint 2010 伺服陣列中，SharePoint 清單在清單功能區上有一個 [匯出為資料摘要] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="dabcd-123">In a SharePoint 2010 farm, a SharePoint list has an Export as Data Feed button on the List ribbon.</span></span> <span data-ttu-id="dabcd-124">您可以按一下此按鈕，將清單匯出為摘要。</span><span class="sxs-lookup"><span data-stu-id="dabcd-124">You can click this button to export the list as a feed.</span></span> <span data-ttu-id="dabcd-125">為了取得最佳結果，您在工作站上應該有 Excel 2010 和 PowerPivot 用戶端應用程式。</span><span class="sxs-lookup"><span data-stu-id="dabcd-125">For best results, you should have Excel 2010 with the PowerPivot client application on your workstation.</span></span> <span data-ttu-id="dabcd-126">PowerPivot 用戶端應用程式將會啟動，以回應資料摘要匯出，建立包含清單的新 PowerPivot 資料表。</span><span class="sxs-lookup"><span data-stu-id="dabcd-126">The PowerPivot client application will launch in response to the data feed export, creating a new PowerPivot table that contains the list.</span></span>  
  
1.  <span data-ttu-id="dabcd-127">開啟 SharePoint 網站上的清單。</span><span class="sxs-lookup"><span data-stu-id="dabcd-127">Open the list on your SharePoint site.</span></span>  
  
2.  <span data-ttu-id="dabcd-128">在 [清單工具] 中，按一下 [清單]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="dabcd-128">In List Tools, click **List**.</span></span>  
  
3.  <span data-ttu-id="dabcd-129">在 [連線及匯出] 中，按一下 [匯出為資料摘要]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="dabcd-129">In Connect and Export, click **Export as Data Feed**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="dabcd-130">[**匯出為數據**摘要] 按鈕會透過 PowerPivot 加入至 SharePoint。</span><span class="sxs-lookup"><span data-stu-id="dabcd-130">The **Export as Data Feed** button is added to SharePoint by way of PowerPivot.</span></span> <span data-ttu-id="dabcd-131">如果您沒有安裝 PowerPivot for SharePoint 或您沒有啟動 PowerPivot 功能，將無法使用此按鈕。</span><span class="sxs-lookup"><span data-stu-id="dabcd-131">If you do not have PowerPivot for SharePoint installed or you did not activate the PowerPivot feature, this button will not be available.</span></span>  
  
4.  <span data-ttu-id="dabcd-132">如果 PowerPivot for Excel 安裝在本機，請按一下 [**開啟**]，或按一下 [**儲存**]，將 .atomsvc 檔儲存到硬碟中，以便稍後進行匯入作業。</span><span class="sxs-lookup"><span data-stu-id="dabcd-132">Click **Open** if PowerPivot for Excel is installed locally, or click **Save** to save the .atomsvc document to your hard drive for import operations at a later time.</span></span>  
  
5.  <span data-ttu-id="dabcd-133">如果您選擇 [開啟]\*\*\*\*，使用 [資料表匯入精靈] 將資料摘要匯入工作表中。</span><span class="sxs-lookup"><span data-stu-id="dabcd-133">If you chose **Open**, use the Table Import Wizard to import the data feed to a worksheet.</span></span> <span data-ttu-id="dabcd-134">資料摘要將會當做新的資料表加入至 PowerPivot 視窗中。</span><span class="sxs-lookup"><span data-stu-id="dabcd-134">The data feed will be added as a new table in the PowerPivot window.</span></span>  
  
 <span data-ttu-id="dabcd-135">如果 ADO.NET Data Services 3.5.1 未安裝在 SharePoint 伺服器上，則會發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="dabcd-135">An error will occur if ADO.NET Data Services 3.5.1 is not installed on the SharePoint server.</span></span> <span data-ttu-id="dabcd-136">如需錯誤及如何解決錯誤的詳細資訊，請參閱 [安裝 ADO.NET Data Services 以支援 SharePoint 清單的資料摘要匯出](../../sql-server/install/install-ado-net-data-services-to-support-data-feed-exports-of-sharepoint-lists.md)。</span><span class="sxs-lookup"><span data-stu-id="dabcd-136">For more information about the error and how to resolve it, see [Install ADO.NET Data Services to support data feed exports of SharePoint lists](../../sql-server/install/install-ado-net-data-services-to-support-data-feed-exports-of-sharepoint-lists.md).</span></span>  
  
##  <a name="create-a-data-feed-from-a-reporting-services-report"></a><a name="rsreport"></a> <span data-ttu-id="dabcd-137">從 Reporting Services 報表建立資料摘要</span><span class="sxs-lookup"><span data-stu-id="dabcd-137">Create a Data Feed from a Reporting Services Report</span></span>  
 <span data-ttu-id="dabcd-138">如果您擁有 SQL Server 2008 R2 Reporting Services 的部署，您可以使用新的 Atom 轉譯延伸模組，從現有的報表中產生資料摘要。</span><span class="sxs-lookup"><span data-stu-id="dabcd-138">If you have a deployment of SQL Server 2008 R2 Reporting Services, you can use the new Atom rendering extension to generate a data feed from an existing report.</span></span> <span data-ttu-id="dabcd-139">為了取得最佳結果，您在工作站上應該有 Excel 2010 和 PowerPivot for Excel。</span><span class="sxs-lookup"><span data-stu-id="dabcd-139">For best results, you should have Excel 2010 with the PowerPivot for Excel on your workstation.</span></span> <span data-ttu-id="dabcd-140">PowerPivot 用戶端應用程式將會啟動，以回應資料摘要匯出，然後在進行串流時，自動加入資料表和資料行並使兩者相關。</span><span class="sxs-lookup"><span data-stu-id="dabcd-140">The PowerPivot client application will launch in response to the data feed export, automatically adding and relating the tables and columns as they are streamed in.</span></span>  
  
 <span data-ttu-id="dabcd-141">如需如何從報表匯出資料摘要的指示，請參閱[報表產生器說明檔](https://go.microsoft.com/fwlink/?LinkId=154494)中的[從報表產生資料摘要 &#40;報表產生器及 SSRS&#41;](../../reporting-services/report-builder/generate-data-feeds-from-a-report-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="dabcd-141">For instructions on how to export a data feed from a report, see [Generate Data Feeds from a Report &#40;Report Builder and SSRS&#41;](../../reporting-services/report-builder/generate-data-feeds-from-a-report-report-builder-and-ssrs.md) in the [Report Builder help file](https://go.microsoft.com/fwlink/?LinkId=154494).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="dabcd-142">若要設定週期性的資料重新整理排程，將報表資料重新匯入至已發行至 SharePoint 文件庫的 PowerPivot 活頁簿中，報表伺服器必須設定為整合 SharePoint。</span><span class="sxs-lookup"><span data-stu-id="dabcd-142">To set up a recurring data refresh schedule that re-imports report data into a PowerPivot workbook that is published to a SharePoint library, the report server must be configured for SharePoint integration.</span></span> <span data-ttu-id="dabcd-143">如需有關同時使用 PowerPivot for SharePoint 和 Reporting Services 的詳細資訊，請參閱設定[和管理報表伺服器 &#40;Reporting Services SharePoint 模式&#41;](../../reporting-services/configure-administer-report-server-reporting-services-sharepoint-mode.md)。</span><span class="sxs-lookup"><span data-stu-id="dabcd-143">For more information about using PowerPivot for SharePoint and Reporting Services together, see [Configuration and Administration of a Report Server &#40;Reporting Services SharePoint Mode&#41;](../../reporting-services/configure-administer-report-server-reporting-services-sharepoint-mode.md).</span></span>  
  
##  <a name="create-a-data-feed-from-a-data-service-document"></a><a name="dsdoc"></a> <span data-ttu-id="dabcd-144">從資料服務文件建立資料摘要</span><span class="sxs-lookup"><span data-stu-id="dabcd-144">Create a Data Feed from a Data Service Document</span></span>  
 <span data-ttu-id="dabcd-145">如果您有可以產生 Atom 摘要的自訂資料服務，您可以設定資料服務文件，以便將資料提供給使用者和應用程式使用。</span><span class="sxs-lookup"><span data-stu-id="dabcd-145">If you have a custom data service that generates Atom feeds, you can set up a data service document as a way to make the data available to users and applications.</span></span> <span data-ttu-id="dabcd-146">「資料服務文件」\*\*(.atomsvc) 檔案會指定一個或多個以 Atom 電傳格式發行資料之線上來源的連接。</span><span class="sxs-lookup"><span data-stu-id="dabcd-146">A *data service document* (.atomsvc) file specifies one or more connections to online sources that publish data in the Atom wire format.</span></span> <span data-ttu-id="dabcd-147">資料服務文件可以在「資料摘要庫」\*\* 中建立，這是一個特殊用途的文件庫，可以提供一般存取點來瀏覽已經發行到 SharePoint 伺服器的資料服務文件。</span><span class="sxs-lookup"><span data-stu-id="dabcd-147">Data service documents can be created in a *data feed library*, which is a special-purpose library that provides a common access point for browsing data service documents that have been published to a SharePoint server.</span></span> <span data-ttu-id="dabcd-148">在資料摘要庫中擁有資料服務文件存取權限的資訊工作者可以參照文件的 SharePoint URL，將資料摘要匯入其活頁簿及應用程式。</span><span class="sxs-lookup"><span data-stu-id="dabcd-148">Information workers who have permission to access data service documents in the data feed library can reference the document's SharePoint URL to import the data feeds to their workbooks and applications.</span></span>  
  
1.  <span data-ttu-id="dabcd-149">開啟網站管理員所建立的資料摘要庫。</span><span class="sxs-lookup"><span data-stu-id="dabcd-149">Open a data feed library that was created by your site administrator.</span></span> <span data-ttu-id="dabcd-150">如需詳細資訊，請參閱[建立或自訂資料摘要庫 &#40;PowerPivot for SharePoint&#41;](create-or-customize-a-data-feed-library-power-pivot-for-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="dabcd-150">For more information, see [Create or Customize a Data Feed Library &#40;PowerPivot for SharePoint&#41;](create-or-customize-a-data-feed-library-power-pivot-for-sharepoint.md).</span></span>  
  
2.  <span data-ttu-id="dabcd-151">在 [文件庫工具] 中，按一下 [文件]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="dabcd-151">In Library Tools, click **Documents**.</span></span>  
  
3.  <span data-ttu-id="dabcd-152">按一下 [新增文件]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="dabcd-152">Click **New Document**.</span></span>  
  
4.  <span data-ttu-id="dabcd-153">請提供檔案名稱和描述。</span><span class="sxs-lookup"><span data-stu-id="dabcd-153">Provide a file name and description.</span></span>  
  
5.  <span data-ttu-id="dabcd-154">指定一個或多個提供摘要的 URL：</span><span class="sxs-lookup"><span data-stu-id="dabcd-154">Specify one or more URLs that provide the feed:</span></span>  
  
    1.  <span data-ttu-id="dabcd-155">[基底 URL]\*\*\*\* 是選擇性的。</span><span class="sxs-lookup"><span data-stu-id="dabcd-155">**Base URL** is optional.</span></span> <span data-ttu-id="dabcd-156">如果資料服務文件提供多個摘要，則您應該指定它。</span><span class="sxs-lookup"><span data-stu-id="dabcd-156">You should specify it if a data service document provides multiple feeds.</span></span> <span data-ttu-id="dabcd-157">基底 URL 應該指定所有摘要通用的 URL 部分 (例如，伺服器名稱和網站)。</span><span class="sxs-lookup"><span data-stu-id="dabcd-157">Base URL should specify the portion of the URL that is common to all the feeds (for example, the server name and site).</span></span> <span data-ttu-id="dabcd-158">如果您要建立 Reporting Services 報表的資料服務文件，基底 URL 將是報表伺服器 URL 與報表。</span><span class="sxs-lookup"><span data-stu-id="dabcd-158">If you are creating a data service document to a Reporting Services report, the base URL would be the report server URL and report.</span></span>  
  
    2.  <span data-ttu-id="dabcd-159">[Web 服務 URL]\*\*\*\* 是必要的。</span><span class="sxs-lookup"><span data-stu-id="dabcd-159">**Web Service URL** is required.</span></span> <span data-ttu-id="dabcd-160">如果沒有基底 URL，這個值在位址中必須包含 http:// 或 https://。</span><span class="sxs-lookup"><span data-stu-id="dabcd-160">Without the Base URL, this value must include http:// or https:// in the address.</span></span> <span data-ttu-id="dabcd-161">如果您有指定基底 URL，Web 服務 URL 就是基底 URL 後面的部分。</span><span class="sxs-lookup"><span data-stu-id="dabcd-161">If you specified a Base URL, the Web service URL is the portion that follows the Base URL.</span></span> <span data-ttu-id="dabcd-162">例如，如果完整的 URL 是 http://adventure-works/inventory/today.aspx ，則基底 url 會是 http://adventure-works/inventory ，而 WEB 服務 URL 會是/today.aspx。</span><span class="sxs-lookup"><span data-stu-id="dabcd-162">For example, if the full URL is http://adventure-works/inventory/today.aspx, the Base URL would be http://adventure-works/inventory, and the Web service URL would be /today.aspx.</span></span>  
  
         <span data-ttu-id="dabcd-163">Web 服務 URL 可以包含篩選或選取資料子集的參數。</span><span class="sxs-lookup"><span data-stu-id="dabcd-163">The Web service URL can include parameters that filter or select a subset of data.</span></span> <span data-ttu-id="dabcd-164">提供摘要的應用程式或服務必須支援您在 URL 中指定的參數。</span><span class="sxs-lookup"><span data-stu-id="dabcd-164">The application or service that provides the feed must support the parameters that you specify in the URL.</span></span>  
  
6.  <span data-ttu-id="dabcd-165">輸入 [資料表名稱]\*\*\*\*，每個摘要各使用一個資料表。</span><span class="sxs-lookup"><span data-stu-id="dabcd-165">Enter a **Table Name**, one table for each feed.</span></span> <span data-ttu-id="dabcd-166">這是必要的值。</span><span class="sxs-lookup"><span data-stu-id="dabcd-166">This value is required.</span></span> <span data-ttu-id="dabcd-167">資料表名稱是由取用資料摘要的用戶端應用程式所使用。</span><span class="sxs-lookup"><span data-stu-id="dabcd-167">The table name is used by a client application that consumes the data feed.</span></span> <span data-ttu-id="dabcd-168">在 PowerPivot for Excel 中，資料表名稱用來命名 PowerPivot 視窗中，將包含已匯入之資料的資料表。</span><span class="sxs-lookup"><span data-stu-id="dabcd-168">In PowerPivot for Excel, the table name is used to name tables in the PowerPivot window that will contain the imported data.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="dabcd-169">另請參閱</span><span class="sxs-lookup"><span data-stu-id="dabcd-169">See Also</span></span>  
 <span data-ttu-id="dabcd-170">[在管理中心為網站集合啟用 PowerPivot 功能整合](activate-power-pivot-integration-for-site-collections-in-ca.md) </span><span class="sxs-lookup"><span data-stu-id="dabcd-170">[Activate PowerPivot Feature Integration for Site Collections in Central Administration](activate-power-pivot-integration-for-site-collections-in-ca.md) </span></span>  
 [<span data-ttu-id="dabcd-171">使用 &#40;PowerPivot for SharePoint 的資料摘要庫共用資料摘要&#41;</span><span class="sxs-lookup"><span data-stu-id="dabcd-171">Share Data Feeds Using a Data Feed Library &#40;PowerPivot for SharePoint&#41;</span></span>](share-data-feeds-using-a-data-feed-library-power-pivot-for-sharepoint.md)  
  
  
