---
title: PowerPivot 資料重新整理與 SharePoint 2013 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 34f03407-2ec4-4554-b16b-bc9a6c161815
author: minewiskan
ms.author: owend
ms.openlocfilehash: c1d65a60c75d695e07edab763c6f879e502bf356
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87596333"
---
# <a name="powerpivot-data-refresh-with-sharepoint-2013"></a><span data-ttu-id="accce-102">SharePoint 2013 中的 PowerPivot 資料重新整理</span><span class="sxs-lookup"><span data-stu-id="accce-102">PowerPivot Data Refresh with SharePoint 2013</span></span>
  <span data-ttu-id="accce-103">SharePoint 2013 中的資料模型重新整理的設計會 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 利用 Excel Services 做為主要元件，在以 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] SharePoint 模式執行的實例上載入和重新整理資料模型 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="accce-103">The design for refresh of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data models in SharePoint 2013 utilizes Excel Services as the primary component to load and refresh data models on an instance of [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] running in SharePoint mode.</span></span> <span data-ttu-id="accce-104">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 伺服器會在 SharePoint 伺服器陣列外部執行。</span><span class="sxs-lookup"><span data-stu-id="accce-104">The [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server runs external to the SharePoint farm.</span></span>  
  
 <span data-ttu-id="accce-105">先前的資料重新整理架構完全仰賴 PowerPivot 系統服務，在 SharePoint 模式的 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 執行個體上載入並重新整理資料模型。</span><span class="sxs-lookup"><span data-stu-id="accce-105">The previous data refresh architecture relied exclusively on the PowerPivot System Service to load and refresh data models on a SharePoint mode [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.</span></span> <span data-ttu-id="accce-106">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 執行個體原本是在 PowerPivot 應用程式伺服器本機上執行。</span><span class="sxs-lookup"><span data-stu-id="accce-106">The [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance ran locally on the PowerPivot application server.</span></span> <span data-ttu-id="accce-107">新的架構也導入了一種新方法，將排程資訊當做活頁簿項目的中繼資料保存在文件庫中。</span><span class="sxs-lookup"><span data-stu-id="accce-107">The new architecture also introduces a new method to maintain schedule information as meta data of the workbook item in the document library.</span></span> <span data-ttu-id="accce-108">SharePoint 2013 Excel Services 中的架構同時支援 **互動式資料重新整理** 和 **排定的資料重新整理**。</span><span class="sxs-lookup"><span data-stu-id="accce-108">The architecture in SharePoint 2013 Excel Services supports both **interactive data refresh** and **scheduled data refresh**.</span></span>  
  
 <span data-ttu-id="accce-109">**[!INCLUDE[applies](../../includes/applies-md.md)]** SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="accce-109">**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2013</span></span>  
  
 <span data-ttu-id="accce-110">**本主題內容：**</span><span class="sxs-lookup"><span data-stu-id="accce-110">**In this topic:**</span></span>  
  
-   [<span data-ttu-id="accce-111">互動式資料重新整理</span><span class="sxs-lookup"><span data-stu-id="accce-111">Interactive Data Refresh</span></span>](#bkmk_interactive_refresh)  
  
-   [<span data-ttu-id="accce-112">Windows 驗證與活頁簿資料連線和互動式資料重新整理</span><span class="sxs-lookup"><span data-stu-id="accce-112">Windows Authentication with Workbook Data Connections and Interactive Data Refresh</span></span>](#bkmk_windows_auth_interactive_data_refresh)  
  
-   [<span data-ttu-id="accce-113">排定的資料重新整理</span><span class="sxs-lookup"><span data-stu-id="accce-113">Scheduled Data Refresh</span></span>](#bkmk_scheduled_refresh)  
  
-   [<span data-ttu-id="accce-114">SharePoint 2013 中排程的資料重新整理架構</span><span class="sxs-lookup"><span data-stu-id="accce-114">Scheduled Data Refresh Architecture in SharePoint 2013</span></span>](#bkmk_refresh_architecture)  
  
-   [<span data-ttu-id="accce-115">其他驗證考量</span><span class="sxs-lookup"><span data-stu-id="accce-115">Additional Authentication Considerations</span></span>](#datarefresh_additional_authentication)  
  
-   [<span data-ttu-id="accce-116">其他資訊</span><span class="sxs-lookup"><span data-stu-id="accce-116">More Information</span></span>](#bkmk_moreinformation)  
  
## <a name="background"></a><span data-ttu-id="accce-117">背景</span><span class="sxs-lookup"><span data-stu-id="accce-117">Background</span></span>  
 <span data-ttu-id="accce-118">SharePoint Server 2013 Excel Services 會管理 Excel 2013 活頁簿的資料重新整理，並在 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 以 SharePoint 模式執行的伺服器上觸發資料模型處理 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="accce-118">SharePoint Server 2013 Excel Services manages data refresh for Excel 2013 workbooks and triggers the data model processing on a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server that is running in SharePoint mode.</span></span> <span data-ttu-id="accce-119">若為 Excel 2010 活頁簿，Excel Services 也會管理活頁簿與資料模型的載入和儲存。</span><span class="sxs-lookup"><span data-stu-id="accce-119">For Excel 2010 workbooks, Excel Services also manages the loading and saving of workbooks and data models.</span></span> <span data-ttu-id="accce-120">不過，Excel Services 會仰賴 PowerPivot 系統服務，將處理命令傳送給資料模型。</span><span class="sxs-lookup"><span data-stu-id="accce-120">However, Excel Services relies on the PowerPivot System Service to send the processing commands to the data model.</span></span> <span data-ttu-id="accce-121">下表將摘要說明根據活頁簿的版本傳送資料重新整理命令的元件。</span><span class="sxs-lookup"><span data-stu-id="accce-121">The following table summarizes the components that send processing commands for data refresh depending on the version of the workbook.</span></span> <span data-ttu-id="accce-122">假設的環境是 SharePoint 2013 伺服器陣列，並且設定為使用以 SharePoint 模式執行的 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server。</span><span class="sxs-lookup"><span data-stu-id="accce-122">The assumed environment is a SharePoint 2013 farm configured to use a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server running in SharePoint mode.</span></span>  
  
||||  
|-|-|-|  
||<span data-ttu-id="accce-123">Excel 2013 活頁簿</span><span class="sxs-lookup"><span data-stu-id="accce-123">Excel 2013 Workbooks</span></span>|<span data-ttu-id="accce-124">Excel 2010 活頁簿</span><span class="sxs-lookup"><span data-stu-id="accce-124">Excel 2010 Workbooks</span></span>|  
|<span data-ttu-id="accce-125">觸發資料重新整理</span><span class="sxs-lookup"><span data-stu-id="accce-125">Trigger Data Refresh</span></span>|<span data-ttu-id="accce-126">**互動式** ：驗證的使用者</span><span class="sxs-lookup"><span data-stu-id="accce-126">**Interactive:** Authenticated User</span></span><br /><br /> <span data-ttu-id="accce-127">**已排程** ：PowerPivot 系統服務</span><span class="sxs-lookup"><span data-stu-id="accce-127">**Scheduled:** PowerPivot System Service</span></span>|<span data-ttu-id="accce-128">：PowerPivot 系統服務</span><span class="sxs-lookup"><span data-stu-id="accce-128">PowerPivot System Service</span></span>|  
|<span data-ttu-id="accce-129">從內容資料庫載入活頁簿</span><span class="sxs-lookup"><span data-stu-id="accce-129">Load Workbook from Content Databases</span></span>|<span data-ttu-id="accce-130">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="accce-130">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="accce-131">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="accce-131">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="accce-132">在 Analysis Services 執行個體上載入資料模型</span><span class="sxs-lookup"><span data-stu-id="accce-132">Load Data model on Analysis Services instance</span></span>|<span data-ttu-id="accce-133">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="accce-133">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="accce-134">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="accce-134">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="accce-135">將處理命令傳送至 Analysis Services 執行個體</span><span class="sxs-lookup"><span data-stu-id="accce-135">Send Processing Commands to Analysis Services instance</span></span>|<span data-ttu-id="accce-136">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="accce-136">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="accce-137">：PowerPivot 系統服務</span><span class="sxs-lookup"><span data-stu-id="accce-137">PowerPivot System Service</span></span>|  
|<span data-ttu-id="accce-138">更新活頁簿資料</span><span class="sxs-lookup"><span data-stu-id="accce-138">Update Workbook Data</span></span>|<span data-ttu-id="accce-139">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="accce-139">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="accce-140">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="accce-140">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="accce-141">將活頁簿和資料模型儲存至內容資料庫</span><span class="sxs-lookup"><span data-stu-id="accce-141">Save Workbook and Data model to Content Database</span></span>|<span data-ttu-id="accce-142">**互動式** ：無</span><span class="sxs-lookup"><span data-stu-id="accce-142">**Interactive:** N/A</span></span><br /><br /> <span data-ttu-id="accce-143">**已排程** ：SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="accce-143">**Scheduled:** SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="accce-144">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="accce-144">SharePoint 2013 Excel Services</span></span>|  
  
 <span data-ttu-id="accce-145">下表將摘要說明 SharePoint 2013 伺服器陣列 (設定為使用以 SharePoint 模式執行的 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server) 中支援的重新整理功能：</span><span class="sxs-lookup"><span data-stu-id="accce-145">The following table summarizes the supported refresh features in a SharePoint 2013 farm configured to use a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server running in SharePoint mode:</span></span>  
  
|<span data-ttu-id="accce-146">活頁簿建立於</span><span class="sxs-lookup"><span data-stu-id="accce-146">Workbook created in</span></span>|<span data-ttu-id="accce-147">排定的資料重新整理</span><span class="sxs-lookup"><span data-stu-id="accce-147">Scheduled data refresh</span></span>|<span data-ttu-id="accce-148">互動式重新整理</span><span class="sxs-lookup"><span data-stu-id="accce-148">Interactive refresh</span></span>|  
|-------------------------|----------------------------|-------------------------|  
|<span data-ttu-id="accce-149">2008 R2 PowerPivot for Excel</span><span class="sxs-lookup"><span data-stu-id="accce-149">2008 R2 PowerPivot for Excel</span></span>|<span data-ttu-id="accce-150">不支援。</span><span class="sxs-lookup"><span data-stu-id="accce-150">Not supported.</span></span> <span data-ttu-id="accce-151">將活頁簿升級\*\* (\*) \*\*</span><span class="sxs-lookup"><span data-stu-id="accce-151">Upgrade the workbook **(\*)**</span></span>|<span data-ttu-id="accce-152">不支援。</span><span class="sxs-lookup"><span data-stu-id="accce-152">Not supported.</span></span> <span data-ttu-id="accce-153">將活頁簿升級\*\* (\*) \*\*</span><span class="sxs-lookup"><span data-stu-id="accce-153">Upgrade the workbook **(\*)**</span></span>|  
|<span data-ttu-id="accce-154">2012 PowerPivot for Excel</span><span class="sxs-lookup"><span data-stu-id="accce-154">2012 PowerPivot for Excel</span></span>|<span data-ttu-id="accce-155">支援</span><span class="sxs-lookup"><span data-stu-id="accce-155">Supported</span></span>|<span data-ttu-id="accce-156">不支援。</span><span class="sxs-lookup"><span data-stu-id="accce-156">Not supported.</span></span> <span data-ttu-id="accce-157">將活頁簿升級\*\* (\*) \*\*</span><span class="sxs-lookup"><span data-stu-id="accce-157">Upgrade the workbook **(\*)**</span></span>|  
|<span data-ttu-id="accce-158">Excel 2013</span><span class="sxs-lookup"><span data-stu-id="accce-158">Excel 2013</span></span>|<span data-ttu-id="accce-159">支援</span><span class="sxs-lookup"><span data-stu-id="accce-159">Supported</span></span>|<span data-ttu-id="accce-160">支援</span><span class="sxs-lookup"><span data-stu-id="accce-160">Supported</span></span>|  
  
 <span data-ttu-id="accce-161">\*\* (\*) \*\*如需活頁簿升級的詳細資訊，請參閱[升級活頁簿和排程的資料重新整理 &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="accce-161">**(\*)** For more information on workbook upgrades, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
##  <a name="interactive-data-refresh"></a><a name="bkmk_interactive_refresh"></a> <span data-ttu-id="accce-162">Interactive Data Refresh</span><span class="sxs-lookup"><span data-stu-id="accce-162">Interactive Data Refresh</span></span>  
 <span data-ttu-id="accce-163">SharePoint Server 2013 Excel Services 中的互動式或手動資料重新整理，可以利用原始資料來源中的資料，以重新整理資料模型。</span><span class="sxs-lookup"><span data-stu-id="accce-163">Interactive, or manual data refresh in SharePoint Server 2013 Excel Services can refresh data models with data from the original data source.</span></span> <span data-ttu-id="accce-164">在您透過註冊以 SharePoint 模式執行的 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 伺服器，設定 Excel Services 應用程式之後，就可以使用互動式資料重新整理。</span><span class="sxs-lookup"><span data-stu-id="accce-164">Interactive data refresh is available after you configure an Excel Services application by registering an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server, running in SharePoint mode.</span></span> <span data-ttu-id="accce-165">如需詳細資訊，請參閱 [Manage Excel Services data model settings (SharePoint Server 2013)](https://technet.microsoft.com/library/jj219780.aspx)(管理 Excel Services 資料模型設定 (SharePoint Server 2013))。</span><span class="sxs-lookup"><span data-stu-id="accce-165">For more information, see [Manage Excel Services data model settings (SharePoint Server 2013)](https://technet.microsoft.com/library/jj219780.aspx).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="accce-166">互動式資料重新整理僅適用於在 Excel 2013 中建立的活頁簿。</span><span class="sxs-lookup"><span data-stu-id="accce-166">Interactive data refresh is only available for workbooks that created in Excel 2013.</span></span> <span data-ttu-id="accce-167">如果您嘗試重新整理 Excel 2010 活頁簿，Excel Services 會顯示類似下列的錯誤訊息：「PowerPivot 作業失敗：此活頁簿是以舊版 Excel 與 PowerPivot 建立而成，在檔案升級之前無法重新整理」。</span><span class="sxs-lookup"><span data-stu-id="accce-167">If you try to refresh an Excel 2010 workbook, Excel Services displays an error message similar to "PowerPivot Operation Failed: The Workbook was created in an older version of Excel and PowerPivot cannot be refreshed until the file is upgraded".</span></span> <span data-ttu-id="accce-168">如需升級活頁簿的詳細資訊，請參閱[升級活頁簿和排程的資料重新整理 &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="accce-168">For more information on upgrading workbooks, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
 <span data-ttu-id="accce-169">**互動式重新整理關鍵重點：**</span><span class="sxs-lookup"><span data-stu-id="accce-169">**Interactive refresh key point of interest:**</span></span>  
  
-   <span data-ttu-id="accce-170">互動式資料重新整理只會重新整理目前使用者工作階段中的資料。</span><span class="sxs-lookup"><span data-stu-id="accce-170">Interactive data refresh only refreshes the data in the current user session.</span></span> <span data-ttu-id="accce-171">資料不會自動儲存回 SharePoint 內容資料庫中的活頁簿項目。</span><span class="sxs-lookup"><span data-stu-id="accce-171">The data is not automatically saved back to the workbook item in the SharePoint content database.</span></span>  
  
-   <span data-ttu-id="accce-172">**認證** ：互動式資料重新整理可以使用目前登入之使用者的識別作為認證或預存認證來連接到資料來源。</span><span class="sxs-lookup"><span data-stu-id="accce-172">**Credentials:** Interactive data refresh can use the identity of the currently logged-on user as credentials or stored credentials to connect to the data source.</span></span> <span data-ttu-id="accce-173">使用的認證會取決於針對外部資料來源之活頁簿連接所定義的 Excel Services 驗證設定。</span><span class="sxs-lookup"><span data-stu-id="accce-173">The  credentials used depend on the Excel Services Authentication Settings defined for the workbook connection to the external data source.</span></span>  
  
-   <span data-ttu-id="accce-174">**支援的活頁簿**  ：在 Excel 2013 中建立的活頁簿。</span><span class="sxs-lookup"><span data-stu-id="accce-174">**Supported Workbooks:**  Workbooks created in Excel 2013.</span></span>  
  
 <span data-ttu-id="accce-175">**若要重新整理資料：**</span><span class="sxs-lookup"><span data-stu-id="accce-175">**To refresh data:**</span></span>  
  
-   <span data-ttu-id="accce-176">請參閱這些步驟後面的圖例。</span><span class="sxs-lookup"><span data-stu-id="accce-176">See the illustration that follows the steps.</span></span>  
  
1.  <span data-ttu-id="accce-177">在 SharePoint 文件庫中，使用瀏覽器來開啟 PowerPivot 活頁簿。</span><span class="sxs-lookup"><span data-stu-id="accce-177">In a SharePoint document library, open a PowerPivot workbook in the browser.</span></span>  
  
2.  <span data-ttu-id="accce-178">在瀏覽器視窗中，按一下 **[資料]** 功能表，然後按一下 **[重新整理選取的連線]** 或 **[重新整理所有連線]**。</span><span class="sxs-lookup"><span data-stu-id="accce-178">In the browser window, click the **Data** menu and then click **Refresh Selected Connection** or **Refresh All Connections**.</span></span>  
  
3.  <span data-ttu-id="accce-179">Excel Services 就會載入 PowerPivot 資料庫、加以處理，然後進行查詢以重新整理 Excel 活頁簿快取。</span><span class="sxs-lookup"><span data-stu-id="accce-179">Excel Services loads the PowerPivot database, processes it and then queries it to refresh the Excel workbook cache.</span></span>  
  
4.  <span data-ttu-id="accce-180">**注意** ：更新的活頁簿不會自動儲存回文件庫。</span><span class="sxs-lookup"><span data-stu-id="accce-180">**Note:** The updated workbook is not automatically saved back to the document library.</span></span>  
  
 <span data-ttu-id="accce-181">![互動式資料重新整理](../media/as-interactive-datarefresh-sharepoint2013.gif "互動式資料重新整理")</span><span class="sxs-lookup"><span data-stu-id="accce-181">![interactive data refresh](../media/as-interactive-datarefresh-sharepoint2013.gif "interactive data refresh")</span></span>  
  
###  <a name="windows-authentication-with-workbook-data-connections-and-interactive-data-refresh"></a><a name="bkmk_windows_auth_interactive_data_refresh"></a> <span data-ttu-id="accce-182">Windows 驗證與活頁簿資料連接以及互動式資料重新整理</span><span class="sxs-lookup"><span data-stu-id="accce-182">Windows Authentication with Workbook Data Connections and Interactive Data Refresh</span></span>  
 <span data-ttu-id="accce-183">Excel Services 會將處理命令傳送至 Analysis Services 伺服器，以便指示伺服器模擬使用者帳戶。</span><span class="sxs-lookup"><span data-stu-id="accce-183">Excel Services sends the Analysis Services server a process command that instructs the server to impersonate a user account.</span></span> <span data-ttu-id="accce-184">為了取得足以執行使用者模擬-委派處理的系統權限，Analysis Services 服務帳戶需要本機伺服器的 [當成作業系統的一部分]\*\*\*\* 權限。</span><span class="sxs-lookup"><span data-stu-id="accce-184">To obtain system rights sufficient to perform the user impersonation-delegation process, the Analysis Services service account, requires **Act as part of the operating system** privilege on the local server.</span></span> <span data-ttu-id="accce-185">Analysis Services 伺服器也必須能夠將使用者的認證委派給資料來源。</span><span class="sxs-lookup"><span data-stu-id="accce-185">The Analysis Services server also needs to be able to delegate the user's credentials to data sources.</span></span> <span data-ttu-id="accce-186">查詢結果會傳送到 Excel Services。</span><span class="sxs-lookup"><span data-stu-id="accce-186">The query result is sent to Excel Services.</span></span>  
  
 <span data-ttu-id="accce-187">一般使用者經驗：當客戶在包含 PowerPivot 模型的 Excel 2013 活頁簿中選取 [重新整理所有連線] 時，他們會看到類似下面的錯誤訊息：</span><span class="sxs-lookup"><span data-stu-id="accce-187">Typical user experience: When a customer selects "Refresh All Connections" in an Excel 2013 workbook that contains a PowerPivot model, they see an error message similar to the following:</span></span>  
  
-   <span data-ttu-id="accce-188">**外部資料重新整理失敗** ：在活頁簿中處理資料模型時發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="accce-188">**External Data Refresh Failed:** An error occurred while working on the Data Model in the workbook.</span></span> <span data-ttu-id="accce-189">請再試一次。</span><span class="sxs-lookup"><span data-stu-id="accce-189">Please try again.</span></span> <span data-ttu-id="accce-190">無法重新整理此活頁簿中的一個或多個資料連線。</span><span class="sxs-lookup"><span data-stu-id="accce-190">We are unable to refresh one or more data connections in this workbook.</span></span>  
  
 <span data-ttu-id="accce-191">根據您所使用的資料提供者，您會在 ULS 記錄中看見類似以下的訊息。</span><span class="sxs-lookup"><span data-stu-id="accce-191">Depending on the data provider you are using, you see messages similar to the following in the ULS log.</span></span>  
  
 <span data-ttu-id="accce-192">**使用 SQL Native Client：**</span><span class="sxs-lookup"><span data-stu-id="accce-192">**With the SQL Native Client:**</span></span>  
  
-   <span data-ttu-id="accce-193">無法建立外部連線或執行查詢。</span><span class="sxs-lookup"><span data-stu-id="accce-193">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="accce-194">提供者訊息：參考至識別碼 '20102481-39c8-4d21-bf63-68f583ad22bb' 的非正規物件 'DataSource' 已指定，但尚未使用。</span><span class="sxs-lookup"><span data-stu-id="accce-194">Provider message: Out of line object 'DataSource', referring to ID(s) '20102481-39c8-4d21-bf63-68f583ad22bb', has been specified but has not been used.</span></span>  <span data-ttu-id="accce-195">OLE DB 或 ODBC 錯誤：建立 SQL Server 的連接時，發生網路相關或執行個體特定錯誤。</span><span class="sxs-lookup"><span data-stu-id="accce-195">OLE DB or ODBC error: A network-related or instance-specific error has occurred while establishing a connection to SQL Server.</span></span> <span data-ttu-id="accce-196">找不到伺服器或是無法存取。</span><span class="sxs-lookup"><span data-stu-id="accce-196">Server is not found or not accessible.</span></span> <span data-ttu-id="accce-197">檢查執行個體名稱是否正確以及 SQL Server 執行個體是否設定為允許遠端連接。</span><span class="sxs-lookup"><span data-stu-id="accce-197">Check if instance name is correct and if SQL Server is configured to allow remote connections.</span></span> <span data-ttu-id="accce-198">如需詳細資訊，請參閱《SQL Server 線上叢書》。; 08001; SSL 提供者：要求的安全性封裝不存在 ; 08001; 用戶端無法建立連線 ; 08001; 用戶端不支援加密。; 08001。</span><span class="sxs-lookup"><span data-stu-id="accce-198">For more information see SQL Server Books Online.; 08001; SSL Provider: The requested security package does not exist ; 08001; Client unable to establish connection; 08001; Encryption not supported on the client.; 08001.</span></span>  <span data-ttu-id="accce-199">, 連線名稱：ThisWorkbookDataModel，活頁簿：book1.xlsx。</span><span class="sxs-lookup"><span data-stu-id="accce-199">, ConnectionName: ThisWorkbookDataModel, Workbook: book1.xlsx.</span></span>  
  
 <span data-ttu-id="accce-200">**使用 Microsoft OLE DB Provider for SQL Server：**</span><span class="sxs-lookup"><span data-stu-id="accce-200">**With the Microsoft OLE DB Provider for SQL Server:**</span></span>  
  
-   <span data-ttu-id="accce-201">無法建立外部連線或執行查詢。</span><span class="sxs-lookup"><span data-stu-id="accce-201">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="accce-202">提供者訊息: 參考至識別碼 '6e711bfa-b62f-4879-a177-c5dd61d9c242' 的非正規物件 'DataSource' 已指定，但尚未使用。</span><span class="sxs-lookup"><span data-stu-id="accce-202">Provider message: Out of line object 'DataSource', referring to ID(s) '6e711bfa-b62f-4879-a177-c5dd61d9c242', has been specified but has not been used.</span></span> <span data-ttu-id="accce-203">OLE DB 或 ODBC 錯誤。</span><span class="sxs-lookup"><span data-stu-id="accce-203">OLE DB or ODBC error.</span></span> <span data-ttu-id="accce-204">, 連線名稱: ThisWorkbookDataModel, 活頁簿: OLEDB Provider.xlsx。</span><span class="sxs-lookup"><span data-stu-id="accce-204">, ConnectionName: ThisWorkbookDataModel, Workbook: OLEDB Provider.xlsx.</span></span>  
  
 <span data-ttu-id="accce-205">**使用 .NET Framework Data Provider for SQL Server：**</span><span class="sxs-lookup"><span data-stu-id="accce-205">**With the .NET Framework Data Provider for SQL Server:**</span></span>  
  
-   <span data-ttu-id="accce-206">無法建立外部連線或執行查詢。</span><span class="sxs-lookup"><span data-stu-id="accce-206">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="accce-207">提供者訊息：參考至識別碼 'f5fb916c-3eac-4d07-a542-531524c0d44a' 的非正規物件 'DataSource' 已指定，但尚未使用。</span><span class="sxs-lookup"><span data-stu-id="accce-207">Provider message: Out of line object 'DataSource', referring to ID(s) 'f5fb916c-3eac-4d07-a542-531524c0d44a', has been specified but has not been used.</span></span>  <span data-ttu-id="accce-208">高層級關聯式引擎有錯誤。</span><span class="sxs-lookup"><span data-stu-id="accce-208">Errors in the high-level relational engine.</span></span> <span data-ttu-id="accce-209">使用 Managed IDbConnection 介面時，發生下列例外狀況: 無法載入檔案或組件 'System.Transactions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' 或是它的其中一個相依性。</span><span class="sxs-lookup"><span data-stu-id="accce-209">The following exception occurred while the managed IDbConnection interface was being used: Could not load file or assembly 'System.Transactions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies.</span></span> <span data-ttu-id="accce-210">未提供所要求的模擬層，或所提供的模擬層不正確。</span><span class="sxs-lookup"><span data-stu-id="accce-210">Either a required impersonation level was not provided, or the provided impersonation level is invalid.</span></span> <span data-ttu-id="accce-211">(來自 HRESULT 的例外狀況：0x80070542)。</span><span class="sxs-lookup"><span data-stu-id="accce-211">(Exception from HRESULT: 0x80070542).</span></span>  <span data-ttu-id="accce-212">, 連線名稱：ThisWorkbookDataModel，活頁簿：NETProvider.xlsx。</span><span class="sxs-lookup"><span data-stu-id="accce-212">, ConnectionName: ThisWorkbookDataModel, Workbook: NETProvider.xlsx.</span></span>  
  
 <span data-ttu-id="accce-213">**組態設定步驟的摘要** ：若要在本機伺服器上設定 **[當成作業系統的一部分]** 權限：</span><span class="sxs-lookup"><span data-stu-id="accce-213">**Summary of Configuration Steps** To configure **Act as part of the operating system** privilege on the local server:</span></span>  
  
1.  <span data-ttu-id="accce-214">在以 SharePoint 模式執行的 Analysis Services 伺服器上，將 Analysis Services 服務帳戶新增至「作為**作業系統的一部分**」許可權：</span><span class="sxs-lookup"><span data-stu-id="accce-214">On the Analysis Services Server running in SharePoint mode, Add the Analysis Services service account to the "**Act as part of the operating system**" privilege:</span></span>  
  
    1.  <span data-ttu-id="accce-215">執行 " `secpol.msc` "</span><span class="sxs-lookup"><span data-stu-id="accce-215">Run "`secpol.msc`"</span></span>  
  
    2.  <span data-ttu-id="accce-216">依序按一下 **[本機安全性原則]**、 **[本機原則]** 和 **[使用者權限指派]**。</span><span class="sxs-lookup"><span data-stu-id="accce-216">Click **Local Security Policy**, then click **Local policies**, and then click **User rights assignment**.</span></span>  
  
    3.  <span data-ttu-id="accce-217">加入服務帳戶。</span><span class="sxs-lookup"><span data-stu-id="accce-217">Add the service account.</span></span>  
  
2.  <span data-ttu-id="accce-218">重新啟動 Excel Services 並且讓 Analysis Services 伺服器重新開機。</span><span class="sxs-lookup"><span data-stu-id="accce-218">Restart Excel Services and reboot the Analysis Services server.</span></span>  
  
3.  <span data-ttu-id="accce-219">不需要從 Excel Services 服務帳戶或對 Windows Token 服務的宣告 (C2WTS) 委派至 Analysis Services 執行個體。</span><span class="sxs-lookup"><span data-stu-id="accce-219">Delegation from the Excel Services service account or from Claims to Windows token service (C2WTS) to the Analysis services instance is not required.</span></span> <span data-ttu-id="accce-220">因此，從 Excel Services 或 C2WTS 到 PowerPivot AS 服務之 KCD 的任何組態都是不必要的。</span><span class="sxs-lookup"><span data-stu-id="accce-220">Therefore no configuration for KCD from Excel Services or C2WTS to PowerPivot AS service is necessary.</span></span> <span data-ttu-id="accce-221">若後端資料來源與 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 執行個體位於相同的伺服器上，即不需要 Kerberos 限制委派。</span><span class="sxs-lookup"><span data-stu-id="accce-221">If the backend data source is on the same server as the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance, Kerberos Constrained Delegation is not required.</span></span> <span data-ttu-id="accce-222">但 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 服務帳戶需要「當成作業系統的一部分」權限。</span><span class="sxs-lookup"><span data-stu-id="accce-222">However, the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] service account requires the right to Act As Part Of The Operating System.</span></span>  
  
 <span data-ttu-id="accce-223">![as_interactive_data_refresh2012SP1_windowsauth](../media/as-interactive-data-refresh2012sp1-windowsauth.gif "as_interactive_data_refresh2012SP1_windowsauth")</span><span class="sxs-lookup"><span data-stu-id="accce-223">![as_interactive_data_refresh2012SP1_windowsauth](../media/as-interactive-data-refresh2012sp1-windowsauth.gif "as_interactive_data_refresh2012SP1_windowsauth")</span></span>  
  
 <span data-ttu-id="accce-224">如需詳細資訊，請參閱作為[作業系統的一部分](https://technet.microsoft.com/library/cc784323\(WS.10\).aspx)。</span><span class="sxs-lookup"><span data-stu-id="accce-224">For more information, see [Act as part of the operating system](https://technet.microsoft.com/library/cc784323\(WS.10\).aspx).</span></span>  
  
##  <a name="scheduled-data-refresh"></a><a name="bkmk_scheduled_refresh"></a><span data-ttu-id="accce-225">排定的資料重新整理</span><span class="sxs-lookup"><span data-stu-id="accce-225">Scheduled Data Refresh</span></span>  
 <span data-ttu-id="accce-226">**排程的資料重新整理關鍵重點：**</span><span class="sxs-lookup"><span data-stu-id="accce-226">**Scheduled data refresh key points of interest:**</span></span>  
  
-   <span data-ttu-id="accce-227">需要部署 PowerPivot for SharePoint 增益集。</span><span class="sxs-lookup"><span data-stu-id="accce-227">Requires the deployment of the PowerPivot for SharePoint add-in.</span></span> <span data-ttu-id="accce-228">如需詳細資訊，請參閱[安裝或卸載 PowerPivot for SharePoint 增益集 &#40;SharePoint 2013&#41;](../instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="accce-228">For more information, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](../instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013.md).</span></span>  
  
-   <span data-ttu-id="accce-229">使用者會設定活頁簿的重新整理排程。</span><span class="sxs-lookup"><span data-stu-id="accce-229">A user configures a refresh schedule for a workbook.</span></span> <span data-ttu-id="accce-230">在排程的時間，PowerPivot 系統服務會傳送要求給 Excel Services，以便：</span><span class="sxs-lookup"><span data-stu-id="accce-230">At the scheduled time, the PowerPivot System Service sends a request to Excel Services to:</span></span>  
  
    -   <span data-ttu-id="accce-231">載入並處理 PowerPivot 資料庫。</span><span class="sxs-lookup"><span data-stu-id="accce-231">Load and process the PowerPivot database.</span></span>  
  
    -   <span data-ttu-id="accce-232">重新整理活頁簿。</span><span class="sxs-lookup"><span data-stu-id="accce-232">Refresh the workbook.</span></span>  
  
    -   <span data-ttu-id="accce-233">將活頁簿儲存回內容資料庫。</span><span class="sxs-lookup"><span data-stu-id="accce-233">Save the workbook back to the content database.</span></span>  
  
-   <span data-ttu-id="accce-234">**認證** ：使用預存認證。</span><span class="sxs-lookup"><span data-stu-id="accce-234">**Credentials:** Uses stored credentials.</span></span> <span data-ttu-id="accce-235">不使用目前使用者的識別。</span><span class="sxs-lookup"><span data-stu-id="accce-235">Does not use the identity of the current user.</span></span>  
  
-   <span data-ttu-id="accce-236">**支援的活頁簿：** 使用 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] 適用于 excel 2010 的 PowerPivot 增益集或 excel 2013 所建立的活頁簿。</span><span class="sxs-lookup"><span data-stu-id="accce-236">**Supported Workbooks:** Workbooks created using the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot add-in for Excel 2010 or using Excel 2013.</span></span> <span data-ttu-id="accce-237">不支援在 Excel 2010 中使用 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] PowerPivot 增益集所建立的活頁簿。</span><span class="sxs-lookup"><span data-stu-id="accce-237">Workbooks created in Excel 2010 with the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] PowerPivot add-in are not supported.</span></span> <span data-ttu-id="accce-238">請將活頁簿至少升級為 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot 格式。</span><span class="sxs-lookup"><span data-stu-id="accce-238">Upgrade the workbook to at least the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot format.</span></span> <span data-ttu-id="accce-239">如需活頁簿升級的詳細資訊，請參閱[升級活頁簿和排程的資料重新整理 &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="accce-239">For more information on workbook upgrades, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
 <span data-ttu-id="accce-240">若要顯示 **[管理資料重新整理]** 頁面：</span><span class="sxs-lookup"><span data-stu-id="accce-240">To display the **Manage Data Refresh** page:</span></span>  
  
-   <span data-ttu-id="accce-241">請參閱這些步驟後面的圖例。</span><span class="sxs-lookup"><span data-stu-id="accce-241">See the illustration that follows the steps.</span></span>  
  
1.  <span data-ttu-id="accce-242">在 SharePoint 文件庫中，針對 PowerPivot 活頁簿按一下 [**開啟] 功能表** (**...** ]) 。</span><span class="sxs-lookup"><span data-stu-id="accce-242">In a SharePoint document library, click the **Open menu** (**...**) for a PowerPivot workbook.</span></span>  
  
2.  <span data-ttu-id="accce-243">按一下第二個 **[開啟]** 功能表，然後按一下 **[管理 PowerPivot 資料重新整理]**。</span><span class="sxs-lookup"><span data-stu-id="accce-243">Click the second **Open menu** and then click **Manage PowerPivot Data Refresh**.</span></span>  
  
3.  <span data-ttu-id="accce-244">在 **[管理資料重新整理]** 頁面上，按一下 **[啟用]** ，然後設定重新整理排程。</span><span class="sxs-lookup"><span data-stu-id="accce-244">On the **Manage Data Refresh** page, click **Enable** and then configure the refresh schedule.</span></span>  
  
4.  <span data-ttu-id="accce-245">在指定的時間，PowerPivot 系統服務會傳送要求給 Excel Services，以便：</span><span class="sxs-lookup"><span data-stu-id="accce-245">At the specified time, the PowerPivot System Service sends a request to Excel Services to:</span></span>  
  
    -   <span data-ttu-id="accce-246">載入並處理 PowerPivot 資料模型。</span><span class="sxs-lookup"><span data-stu-id="accce-246">Load and process the PowerPivot data model.</span></span>  
  
    -   <span data-ttu-id="accce-247">重新整理活頁簿。</span><span class="sxs-lookup"><span data-stu-id="accce-247">Refresh the workbook.</span></span>  
  
    -   <span data-ttu-id="accce-248">將活頁簿儲存回內容資料庫。</span><span class="sxs-lookup"><span data-stu-id="accce-248">Save the workbook back to the content database.</span></span>  
  
 <span data-ttu-id="accce-249">![管理資料重新整理操作功能表](../media/as-manage-datarefresh-sharepoint2013.gif "管理資料重新整理操作功能表")</span><span class="sxs-lookup"><span data-stu-id="accce-249">![manage data refresh context menu](../media/as-manage-datarefresh-sharepoint2013.gif "manage data refresh context menu")</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="accce-250">如需從 SharePoint online 重新整理活頁簿的詳細資訊，請參閱[從 Sharepoint online 重新整理含有內嵌 PowerPivot 模型的 Excel 活頁簿 (白皮書) ](https://technet.microsoft.com/library/jj992650.aspx) (https://technet.microsoft.com/library/jj992650.aspx) 。</span><span class="sxs-lookup"><span data-stu-id="accce-250">For information on refreshing workbooks from SharePoint online, see [Refreshing Excel workbooks with embedded PowerPivot models from SharePoint Online (white paper)](https://technet.microsoft.com/library/jj992650.aspx) (https://technet.microsoft.com/library/jj992650.aspx).</span></span>  
  
##  <a name="scheduled-data-refresh-architecture-in-sharepoint-2013"></a><a name="bkmk_refresh_architecture"></a><span data-ttu-id="accce-251">SharePoint 2013 中排程的資料重新整理架構</span><span class="sxs-lookup"><span data-stu-id="accce-251">Scheduled Data Refresh Architecture in SharePoint 2013</span></span>  
 <span data-ttu-id="accce-252">下圖摘要說明 SharePoint 2013 和 SQL Server 2012 SP1 中的資料重新整理架構。</span><span class="sxs-lookup"><span data-stu-id="accce-252">The following illustration summarizes the data refresh architecture in SharePoint 2013 and SQL Server 2012 SP1.</span></span>  
  
 <span data-ttu-id="accce-253">![SQL Server 2012 SP1 資料重新整理的架構](../media/as-scheduled-data-refresh2012sp1-architecture.gif "SQL Server 2012 SP1 資料重新整理的架構")</span><span class="sxs-lookup"><span data-stu-id="accce-253">![architecture of SQL Server 2012 SP1 data refresh](../media/as-scheduled-data-refresh2012sp1-architecture.gif "architecture of SQL Server 2012 SP1 data refresh")</span></span>  
  
||<span data-ttu-id="accce-254">描述</span><span class="sxs-lookup"><span data-stu-id="accce-254">Description</span></span>||  
|-|-----------------|-|  
|<span data-ttu-id="accce-255">\*\* (1) \*\*</span><span class="sxs-lookup"><span data-stu-id="accce-255">**(1)**</span></span>|<span data-ttu-id="accce-256">Analysis Services 引擎</span><span class="sxs-lookup"><span data-stu-id="accce-256">Analysis Services Engine</span></span>|<span data-ttu-id="accce-257">以 SharePoint 模式執行的 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 伺服器上觸發資料模型處理。</span><span class="sxs-lookup"><span data-stu-id="accce-257">An [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server that is running in SharePoint mode.</span></span> <span data-ttu-id="accce-258">此伺服器會在 SharePoint 伺服器陣列外部執行。</span><span class="sxs-lookup"><span data-stu-id="accce-258">The server runs outside of the SharePoint farm.</span></span>|  
|<span data-ttu-id="accce-259">\*\* (2) \*\*</span><span class="sxs-lookup"><span data-stu-id="accce-259">**(2)**</span></span>|<span data-ttu-id="accce-260">使用者介面</span><span class="sxs-lookup"><span data-stu-id="accce-260">User Interface</span></span>|<span data-ttu-id="accce-261">使用者介面是由兩個頁面組成。</span><span class="sxs-lookup"><span data-stu-id="accce-261">The user interface is comprised of two pages.</span></span> <span data-ttu-id="accce-262">第一個頁面用於定義排程，而第二個頁面則用於檢視重新整理記錄。</span><span class="sxs-lookup"><span data-stu-id="accce-262">One to define the schedule and the second to view the refresh history.</span></span> <span data-ttu-id="accce-263">這些頁面不會直接存取 PowerPivot 服務應用程式資料庫，但是會使用 PowerPivot 系統服務來存取資料庫。</span><span class="sxs-lookup"><span data-stu-id="accce-263">The pages do not directly access the PowerPivot Service application databases but use the PowerPivot system service to access the databases.</span></span>|  
|<span data-ttu-id="accce-264">\*\* (3) \*\*</span><span class="sxs-lookup"><span data-stu-id="accce-264">**(3)**</span></span>|<span data-ttu-id="accce-265">：PowerPivot 系統服務</span><span class="sxs-lookup"><span data-stu-id="accce-265">PowerPivot System Service</span></span>|<span data-ttu-id="accce-266">此服務是在您部署 PowerPivot for SharePoint 增益集時安裝的。</span><span class="sxs-lookup"><span data-stu-id="accce-266">The service is installed when you deploy the PowerPivot for SharePoint add-in.</span></span> <span data-ttu-id="accce-267">此服務的用途如下：</span><span class="sxs-lookup"><span data-stu-id="accce-267">The service is used for the following:</span></span><br /><br /> <span data-ttu-id="accce-268">此服務會裝載重新整理排程引擎，而這個引擎會呼叫 Excel Services API，針對 Excel 2013 活頁簿進行資料重新整理。</span><span class="sxs-lookup"><span data-stu-id="accce-268">This service hosts the refresh scheduling engine, which calls Excel Services APIs for data refresh of Excel 2013 workbooks.</span></span> <span data-ttu-id="accce-269">若為 Excel 2010 活頁簿，此服務就會直接執行資料模型處理，但是仍然仰賴 Excel Services 載入資料模型和更新活頁簿。</span><span class="sxs-lookup"><span data-stu-id="accce-269">For Excel 2010 workbooks, the service directly performs the data model processing but continues to reply on Excel Services for loading the data model and updating the workbook.</span></span><br /><br /> <span data-ttu-id="accce-270">此服務會提供方法給使用者介面頁面等元件，以便與系統服務進行通訊。</span><span class="sxs-lookup"><span data-stu-id="accce-270">This service provides methods for components such as the user interface pages, to communicate with the system service.</span></span><br /><br /> <span data-ttu-id="accce-271">管理將活頁簿當做資料來源存取的外部要求 (透過 PowerPivot Web 服務收到)。</span><span class="sxs-lookup"><span data-stu-id="accce-271">Manages requests for external access to workbooks as a data source, received through the PowerPivot Web Service.</span></span><br /><br /> <span data-ttu-id="accce-272">計時器工作和組態頁面的排程資料重新整理要求管理。</span><span class="sxs-lookup"><span data-stu-id="accce-272">Scheduled data refresh request management for timer jobs and configuration pages.</span></span> <span data-ttu-id="accce-273">此服務會管理讀取服務應用程式資料庫內部和外部資料的要求，以及使用 Excel Services 觸發資料重新整理的要求。</span><span class="sxs-lookup"><span data-stu-id="accce-273">The service manages requests to read data in and out of the service application database and trigger data refresh with Excel Services.</span></span><br /><br /> <span data-ttu-id="accce-274">使用量處理以及相關的計時器工作。</span><span class="sxs-lookup"><span data-stu-id="accce-274">Usage processing and related timer job.</span></span>|  
|<span data-ttu-id="accce-275">\*\* (4) \*\*</span><span class="sxs-lookup"><span data-stu-id="accce-275">**(4)**</span></span>|<span data-ttu-id="accce-276">Excel Calculation Services</span><span class="sxs-lookup"><span data-stu-id="accce-276">Excel Calculation Services</span></span>|<span data-ttu-id="accce-277">負責載入資料模型。</span><span class="sxs-lookup"><span data-stu-id="accce-277">Responsible for loading the data models.</span></span>|  
|<span data-ttu-id="accce-278">\*\* (5) \*\*</span><span class="sxs-lookup"><span data-stu-id="accce-278">**(5)**</span></span>|<span data-ttu-id="accce-279">Secure Store Service</span><span class="sxs-lookup"><span data-stu-id="accce-279">Secure Store Service</span></span>|<span data-ttu-id="accce-280">如果活頁簿中的驗證設定是設定為**使用已驗證的使用者帳戶**或**無**，則會使用 Secure STORE 目標應用程式識別碼中儲存的認證來進行資料重新整理。</span><span class="sxs-lookup"><span data-stu-id="accce-280">If the authentication settings in the workbook are configured to **Use the authenticated user's account** or **None**, the credentials stored in the Secure Store target application ID are used for data refresh.</span></span> <span data-ttu-id="accce-281">如需詳細資訊，請參閱本主題中的＜ [其他驗證考量](#datarefresh_additional_authentication) ＞一節。</span><span class="sxs-lookup"><span data-stu-id="accce-281">For more information, see the [Additional Authentication Considerations](#datarefresh_additional_authentication) section in this topic.</span></span>|  
|<span data-ttu-id="accce-282">\*\* (6) \*\*</span><span class="sxs-lookup"><span data-stu-id="accce-282">**(6)**</span></span>|<span data-ttu-id="accce-283">PowerPivot 資料重新整理計時器工作</span><span class="sxs-lookup"><span data-stu-id="accce-283">PowerPivot data refresh timer Job</span></span>|<span data-ttu-id="accce-284">指示 PowerPivot 系統服務與 Excel Services 連接，以便重新整理資料模型。</span><span class="sxs-lookup"><span data-stu-id="accce-284">Instructs the PowerPivot system service to connect with Excel Services for refreshing data models.</span></span>|  
  
 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="accce-285">需要適當的資料提供者和用戶端程式庫，才能讓 SharePoint 模式的 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 伺服器存取資料來源。</span><span class="sxs-lookup"><span data-stu-id="accce-285">requires appropriate data providers and client libraries so that the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server in SharePoint mode can access data sources.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="accce-286">因為 PowerPivot 系統服務不再載入或儲存 PowerPivot 模型，所以大部分在應用程式伺服器上快取模型的設定都不會套用至 SharePoint 2013 伺服器陣列。</span><span class="sxs-lookup"><span data-stu-id="accce-286">Because the PowerPivot system service no longer loads or saves PowerPivot models, most of the settings for caching models on an application server do not apply to a SharePoint 2013 farm.</span></span>  
  
## <a name="data-refresh-log-data"></a><span data-ttu-id="accce-287">資料重新整理記錄資料</span><span class="sxs-lookup"><span data-stu-id="accce-287">Data refresh log data</span></span>  
 <span data-ttu-id="accce-288">**使用量資料** ：您可以在 PowerPivot 管理儀表板中檢視資料重新整理使用量資料。</span><span class="sxs-lookup"><span data-stu-id="accce-288">**Usage Data:** You can view data refresh usage data in the PowerPivot Management Dashboard.</span></span> <span data-ttu-id="accce-289">若要查看使用量資料：</span><span class="sxs-lookup"><span data-stu-id="accce-289">To see the usage data:</span></span>  
  
1.  <span data-ttu-id="accce-290">在 SharePoint 管理中心的 **[一般應用程式設定]** 群組中，按一下 **[PowerPivot 管理儀表板]** 。</span><span class="sxs-lookup"><span data-stu-id="accce-290">In SharePoint Central Administration, click **PowerPivot Management Dashboard** in the **General application settings** group.</span></span>  
  
2.  <span data-ttu-id="accce-291">在儀表板底部，查看 [資料重新整理 **-最近的活動**] 和 [資料重新整理 **-最近的失敗**]。</span><span class="sxs-lookup"><span data-stu-id="accce-291">At the bottom of the dashboard, see the **Data Refresh - Recent Activity** and **Data Refresh - Recent Failures**.</span></span>  
  
3.  <span data-ttu-id="accce-292">如需有關使用量資料以及如何啟用的詳細資訊，請參閱＜ [PowerPivot Management Dashboard and Usage Data](power-pivot-management-dashboard-and-usage-data.md)＞。</span><span class="sxs-lookup"><span data-stu-id="accce-292">For more information on usage data and how to enable it, see [PowerPivot Management Dashboard and Usage Data](power-pivot-management-dashboard-and-usage-data.md).</span></span>  
  
 <span data-ttu-id="accce-293">**診斷記錄資料** ：您可以檢視與資料重新整理有關的 SharePoint 診斷記錄資料。</span><span class="sxs-lookup"><span data-stu-id="accce-293">**Diagnostic log data:** You can view SharePoint diagnostic log data related to data refresh.</span></span> <span data-ttu-id="accce-294">首先，請在 SharePoint 管理中心的 **[監視]** 頁面中，確認 **[PowerPivot 服務]** 的診斷記錄組態。</span><span class="sxs-lookup"><span data-stu-id="accce-294">First, verify the configuration of diagnostic logging for the **PowerPivot Service** in SharePoint Central Administration **Monitoring** page.</span></span> <span data-ttu-id="accce-295">您可能需要增加記錄的層級，才能記錄「最低緊急事件」。</span><span class="sxs-lookup"><span data-stu-id="accce-295">You may need to increase the level of logging for the "least critical event" to log.</span></span> <span data-ttu-id="accce-296">例如，請暫時將此值設定為 **[詳細資訊]** ，然後重新執行資料重新整理作業。</span><span class="sxs-lookup"><span data-stu-id="accce-296">For example, temporarily set the value to **Verbose** and then rerun data refresh operations.</span></span>  
  
 <span data-ttu-id="accce-297">記錄項目就會包含：</span><span class="sxs-lookup"><span data-stu-id="accce-297">The log entries contain:</span></span>  
  
-   <span data-ttu-id="accce-298">**[PowerPivot 服務]** 的 **[區域]**。</span><span class="sxs-lookup"><span data-stu-id="accce-298">The **Area** of **PowerPivot Service**.</span></span>  
  
-   <span data-ttu-id="accce-299">**[資料重新整理]** 的類別。</span><span class="sxs-lookup"><span data-stu-id="accce-299">The category of **Data Refresh**.</span></span>  
  
 <span data-ttu-id="accce-300">檢閱 **[設定診斷記錄]**。</span><span class="sxs-lookup"><span data-stu-id="accce-300">Review the **configure diagnostic logging**.</span></span> <span data-ttu-id="accce-301">如需詳細資訊，請參閱[設定及查看 SharePoint 記錄檔和診斷記錄 &#40;PowerPivot for SharePoint&#41;](configure-and-view-sharepoint-and-diagnostic-logging.md)。</span><span class="sxs-lookup"><span data-stu-id="accce-301">For more information, see [Configure and View SharePoint Log Files  and Diagnostic Logging &#40;PowerPivot for SharePoint&#41;](configure-and-view-sharepoint-and-diagnostic-logging.md).</span></span>  
  
##  <a name="additional-authentication-considerations"></a><a name="datarefresh_additional_authentication"></a><span data-ttu-id="accce-302">其他驗證考慮</span><span class="sxs-lookup"><span data-stu-id="accce-302">Additional Authentication Considerations</span></span>  
 <span data-ttu-id="accce-303">在 Excel 2013 中， **[Excel Services 驗證設定]** 對話方塊的設定會決定 Excel Services 和 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 用於資料重新整理的 Windows 識別。</span><span class="sxs-lookup"><span data-stu-id="accce-303">The settings in the **Excel Services Authentication Settings** dialog in Excel 2013, determine the Windows identity that Excel Services and [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] use for data refresh.</span></span>  
  
-   <span data-ttu-id="accce-304">**使用已驗證的使用者帳戶**： Excel Services 會以目前登入使用者的身分識別來執行資料重新整理。</span><span class="sxs-lookup"><span data-stu-id="accce-304">**Use the authenticated user's account**: Excel Services performs data refresh under the identity of the currently logged-in user.</span></span>  
  
-   <span data-ttu-id="accce-305">**使用儲存的帳戶**：採用 SharePoint Secure Store Service 應用程式識別碼，讓 Excel Services 用來擷取進行資料重新整理驗證的使用者名稱和密碼。</span><span class="sxs-lookup"><span data-stu-id="accce-305">**Use a stored account**: Assumes a SharePoint Secure Store Service application ID, which Excel Services uses to retrieve the user name and password to authenticate data refresh authentication.</span></span>  
  
-   <span data-ttu-id="accce-306">**無**：使用 Excel Services 的 **[自動服務帳戶]** 。</span><span class="sxs-lookup"><span data-stu-id="accce-306">**None**: The Excel Services **Unattended Service Account** is used.</span></span> <span data-ttu-id="accce-307">此服務帳戶與 Secure Store Proxy 相關聯。</span><span class="sxs-lookup"><span data-stu-id="accce-307">The service account is associated with a Secure Store Proxy.</span></span> <span data-ttu-id="accce-308">您可以在 **[Excel Services 應用程式設定]** 頁面的 **[外部資料]** 區段中進行設定。</span><span class="sxs-lookup"><span data-stu-id="accce-308">Configure the settings on the **Excel Services Application Settings** page, in the **External Data** section.</span></span>  
  
 <span data-ttu-id="accce-309">若要開啟驗證設定對話方塊：</span><span class="sxs-lookup"><span data-stu-id="accce-309">To open the authentication settings dialog:</span></span>  
  
1.  <span data-ttu-id="accce-310">在 Excel 2013 中，按一下 **[資料]** 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="accce-310">Click the **Data** tab in Excel 2013.</span></span>  
  
2.  <span data-ttu-id="accce-311">在功能區中，按一下 **[連線]** 。</span><span class="sxs-lookup"><span data-stu-id="accce-311">Click **Connections** in the ribbon.</span></span>  
  
3.  <span data-ttu-id="accce-312">在 **[活頁簿連線]** 對話方塊中，選取連線，然後按一下 **[內容]**。</span><span class="sxs-lookup"><span data-stu-id="accce-312">In the **Workbook connections dialog**, select the connection and click **Properties**.</span></span>  
  
4.  <span data-ttu-id="accce-313">在 [**連接屬性**] 對話方塊中，按一下 [**定義**]，然後按一下 [**驗證設定 ...** ] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="accce-313">In the **Connection properties** dialog, click **Definition**, and then click the **Authentication Settings...** button.</span></span>  
  
 <span data-ttu-id="accce-314">![[Excel Services 驗證設定]](../media/as-authentication-settings-4-ecs-in-excel2013.gif "[Excel Services 驗證設定]")</span><span class="sxs-lookup"><span data-stu-id="accce-314">![excel services authentication settings](../media/as-authentication-settings-4-ecs-in-excel2013.gif "excel services authentication settings")</span></span>  
  
 <span data-ttu-id="accce-315">如需有關資料重新整理驗證以及認證使用方式的詳細資訊，請參閱部落格文章： [在 SharePoint 2013 中重新整理 PowerPivot 資料](https://blogs.msdn.com/b/analysisservices/archive/2012/12/21/refreshing-powerpivot-data-in-sharepoint-2013.aspx)。</span><span class="sxs-lookup"><span data-stu-id="accce-315">For more information on data refresh authentication and usage of credentials, see the blog post [Refreshing PowerPivot Data in SharePoint 2013](https://blogs.msdn.com/b/analysisservices/archive/2012/12/21/refreshing-powerpivot-data-in-sharepoint-2013.aspx).</span></span>  
  
##  <a name="more-information"></a><a name="bkmk_moreinformation"></a> <span data-ttu-id="accce-316">其他資訊</span><span class="sxs-lookup"><span data-stu-id="accce-316">More Information</span></span>  
 <span data-ttu-id="accce-317">[PowerPivot 資料重新整理疑難排解](https://social.technet.microsoft.com/wiki/contents/articles/3870.troubleshooting-powerpivot-data-refresh.aspx)。</span><span class="sxs-lookup"><span data-stu-id="accce-317">[Troubleshooting PowerPivot Data Refresh](https://social.technet.microsoft.com/wiki/contents/articles/3870.troubleshooting-powerpivot-data-refresh.aspx).</span></span>  
  
 <span data-ttu-id="accce-318">[SharePoint 2013 中的 Excel Services](https://www.enjoysharepoint.com/configure-excel-service-application-in-sharepoint-2013/)。</span><span class="sxs-lookup"><span data-stu-id="accce-318">[Excel Services in SharePoint 2013](https://www.enjoysharepoint.com/configure-excel-service-application-in-sharepoint-2013/).</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="accce-319">另請參閱</span><span class="sxs-lookup"><span data-stu-id="accce-319">See Also</span></span>  
 <span data-ttu-id="accce-320">[&#40;SharePoint 2013&#41;升級活頁簿和排程的資料重新整理](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md) </span><span class="sxs-lookup"><span data-stu-id="accce-320">[Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md) </span></span>  
 [<span data-ttu-id="accce-321">PowerPivot for SharePoint 2013 安裝</span><span class="sxs-lookup"><span data-stu-id="accce-321">PowerPivot for SharePoint 2013 Installation</span></span>](../instances/install-windows/install-analysis-services-in-power-pivot-mode.md)  
  
  
