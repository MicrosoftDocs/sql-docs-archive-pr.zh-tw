---
title: 在 Analysis Services 中編寫管理工作的腳本 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- automatic Analysis Services administration
- administering Analysis Services
ms.assetid: 106415df-81ff-4ec3-b2e1-ca66324f4cab
author: minewiskan
ms.author: owend
ms.openlocfilehash: 660f0d52d4057a9bdb9e2a0af0ed268d64a7747a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87592912"
---
# <a name="script-administrative-tasks-in-analysis-services"></a><span data-ttu-id="b348f-102">在 Analysis Services 中編寫管理工作的指令碼</span><span class="sxs-lookup"><span data-stu-id="b348f-102">Script Administrative Tasks in Analysis Services</span></span>
  <span data-ttu-id="b348f-103">您可以撰寫或產生可手動執行或透過 SQL Server Agent 排程的指令碼，將 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 管理工作自動化。</span><span class="sxs-lookup"><span data-stu-id="b348f-103">You can automate [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] administrative tasks by writing or generating scripts that can be executed manually or scheduled through SQL Server Agent.</span></span> <span data-ttu-id="b348f-104">下表摘要說明可用的指令碼選項，並提供詳細資訊的連結。</span><span class="sxs-lookup"><span data-stu-id="b348f-104">The following table summarizes the scripting options available to you and provides links to more information.</span></span>  
  
 <span data-ttu-id="b348f-105">下列所有方法都支援可儲存至檔案並以獨立作業方式執行的指令碼。</span><span class="sxs-lookup"><span data-stu-id="b348f-105">All of the methodologies listed below support scripts that can be saved to a file and executed as an independent operation.</span></span> <span data-ttu-id="b348f-106">因為用於表格式模型和 PowerPivot 活頁簿的 Data Analysis Expression (DAX) 語言不符合此準則，所以未將它包含在下列清單中。</span><span class="sxs-lookup"><span data-stu-id="b348f-106">Because the Data Analysis Expression (DAX) language used for tabular models and PowerPivot workbooks does not meet the criteria, it is not included in the following list.</span></span>  
  
|<span data-ttu-id="b348f-107">方法</span><span class="sxs-lookup"><span data-stu-id="b348f-107">Methodology</span></span>|<span data-ttu-id="b348f-108">檔案格式</span><span class="sxs-lookup"><span data-stu-id="b348f-108">File format</span></span>|<span data-ttu-id="b348f-109">描述</span><span class="sxs-lookup"><span data-stu-id="b348f-109">Description</span></span>|<span data-ttu-id="b348f-110">連結</span><span class="sxs-lookup"><span data-stu-id="b348f-110">Links</span></span>|  
|-----------------|-----------------|-----------------|-----------|  
|<span data-ttu-id="b348f-111">PowerShell</span><span class="sxs-lookup"><span data-stu-id="b348f-111">PowerShell</span></span>|<span data-ttu-id="b348f-112">.ps1</span><span class="sxs-lookup"><span data-stu-id="b348f-112">.ps1</span></span>|<span data-ttu-id="b348f-113">Analysis Services 透過從命令列加入物件導覽的新提供者，以及用於備份、還原、處理和角色管理等管理工作的新指令程式，可支援 SQL Server PowerShell 指令碼環境。</span><span class="sxs-lookup"><span data-stu-id="b348f-113">Analysis Services supports the SQL Server PowerShell scripting environment through a new provider that adds object navigation from the command line, as well as new cmdlets for administrative tasks such as backup, restore, processing, and role management.</span></span><br /><br /> <span data-ttu-id="b348f-114">此外，SQL Server PowerPivot (SQLPS) 提供者也包含一般用途指令程式 `Invoke-ASCmd`，可讓您從 PowerShell 工作階段內執行 XMLA、MDX 或 DMX 指令碼檔。</span><span class="sxs-lookup"><span data-stu-id="b348f-114">Additionally, the SQL Server PowerPivot (SQLPS) provider includes a general purpose cmdlet, `Invoke-ASCmd`, which lets you run XMLA, MDX, or DMX script files from within a PowerShell session.</span></span><br /><br /> <span data-ttu-id="b348f-115">多維度和表格式模型都支援 Analysis Services PowerShell 指令碼，但從 SharePoint 存取的 PowerPivot 活頁簿不支援它。</span><span class="sxs-lookup"><span data-stu-id="b348f-115">Analysis Services PowerShell scripting is supported for both multidimensional and tabular models, but not for PowerPivot workbooks accessed from SharePoint.</span></span>|[<span data-ttu-id="b348f-116">Analysis Services PowerShell</span><span class="sxs-lookup"><span data-stu-id="b348f-116">Analysis Services PowerShell</span></span>](analysis-services-powershell.md)<br /><br /> [<span data-ttu-id="b348f-117">Windows PowerShell 生存指南</span><span class="sxs-lookup"><span data-stu-id="b348f-117">Windows PowerShell Survival Guide</span></span>](https://go.microsoft.com/fwlink/?LinkId=233747)|  
|<span data-ttu-id="b348f-118">ASSL 或 XMLA 指令碼</span><span class="sxs-lookup"><span data-stu-id="b348f-118">ASSL or XMLA Script</span></span>|<span data-ttu-id="b348f-119">.xmla</span><span class="sxs-lookup"><span data-stu-id="b348f-119">.xmla</span></span>|<span data-ttu-id="b348f-120">Analysis Services 指令碼語言 (ASSL) 是 XMLA 的延伸模組，提供對表格式或多維度模式的 Analysis Services 執行個體上之物件和作業進行資料存取。</span><span class="sxs-lookup"><span data-stu-id="b348f-120">Analysis Services Scripting Language (ASSL) is an extension to XMLA that provides data access to objects and operations on an Analysis Services instance that runs in tabular or multidimensional mode.</span></span> <span data-ttu-id="b348f-121">ASSL 包含資料定義和命令語言支援，讓 Analysis Services 物件和作業能夠以 XML 格式完整表示。</span><span class="sxs-lookup"><span data-stu-id="b348f-121">ASSL includes data definition and command language support, enabling the complete expression of Analysis Services objects and operations in an XML format.</span></span> <span data-ttu-id="b348f-122">使用 ASSL 所提供之物件和命令的指令碼儲存為 .xmla 檔案。</span><span class="sxs-lookup"><span data-stu-id="b348f-122">Scripts that use the objects and commands provided by ASSL are saved as .xmla files.</span></span> <span data-ttu-id="b348f-123">在 Analysis Services 內容中，依慣例會將 ASSL 稱為 XMLA 指令碼。</span><span class="sxs-lookup"><span data-stu-id="b348f-123">Within the context of Analysis Services, it is common practice to refer to ASSL as XMLA script.</span></span> <span data-ttu-id="b348f-124">當您的需求包含下列時，選擇這種方法：</span><span class="sxs-lookup"><span data-stu-id="b348f-124">Choose this approach when your requirements include the following:</span></span><br /><br /> <span data-ttu-id="b348f-125">您的指令碼直接在伺服器上建立物件，或執行資料定義和操作工作 (例如，重新建立和處理資料庫)。</span><span class="sxs-lookup"><span data-stu-id="b348f-125">Your script creates objects directly on a server, or performs both data definition and operational tasks (for example, recreating and processing database).</span></span><br /><br /> <span data-ttu-id="b348f-126">您需要跨多個工具和技術重複使用指令碼以發揮至極致。</span><span class="sxs-lookup"><span data-stu-id="b348f-126">You require maximum script reuse across multiple tools and technologies.</span></span> <span data-ttu-id="b348f-127">XMLA 指令碼可加入至 SQL Server Agent 中的 Analysis Services 命令工作、在 SSIS 封裝中參考，或在 PowerShell 指令碼中參考。</span><span class="sxs-lookup"><span data-stu-id="b348f-127">XMLA scripts can be added to Analysis Services command tasks in SQL Server Agent, referenced in SSIS packages, or referenced in PowerShell script.</span></span><br /><br /> <span data-ttu-id="b348f-128">指令碼必須自動執行。</span><span class="sxs-lookup"><span data-stu-id="b348f-128">The script must run unattended.</span></span> <span data-ttu-id="b348f-129">您可以使用 SQL Server Agent，來排程包含 XMLA 指令碼的作業或包含 XMLA 的 SSIS 封裝。</span><span class="sxs-lookup"><span data-stu-id="b348f-129">You can use SQL Server Agent to schedule a job that contains XMLA script or an SSIS package that contains XMLA.</span></span><br /><br /> <span data-ttu-id="b348f-130">您有使用 XMLA 的應用程式需求。</span><span class="sxs-lookup"><span data-stu-id="b348f-130">You have application requirements for using XMLA.</span></span> <span data-ttu-id="b348f-131">XMLA 是不需要 Managed 程式碼環境的介面。</span><span class="sxs-lookup"><span data-stu-id="b348f-131">XMLA is an interface that does not require a managed code environment.</span></span> <span data-ttu-id="b348f-132">您可以在不使用 .NET Framework 的應用程式中執行 XMLA 指令碼。</span><span class="sxs-lookup"><span data-stu-id="b348f-132">You can execute XMLA script in an application that does not use the .NET Framework.</span></span>|[<span data-ttu-id="b348f-133">在 Management Studio 中建立 Analysis Services 指令碼</span><span class="sxs-lookup"><span data-stu-id="b348f-133">Create Analysis Services Scripts in Management Studio</span></span>](instances/create-analysis-services-scripts-in-management-studio.md)<br /><br /> [<span data-ttu-id="b348f-134">在 SQL Server Management Studio 中使用 Analysis Services 範本</span><span class="sxs-lookup"><span data-stu-id="b348f-134">Use Analysis Services Templates in SQL Server Management Studio</span></span>](instances/use-analysis-services-templates-in-sql-server-management-studio.md)<br /><br /> [<span data-ttu-id="b348f-135">使用 SQL Server Agent 排程 SSAS 管理工作</span><span class="sxs-lookup"><span data-stu-id="b348f-135">Schedule SSAS Administrative Tasks with SQL Server Agent</span></span>](instances/schedule-ssas-administrative-tasks-with-sql-server-agent.md)<br /><br /> [<span data-ttu-id="b348f-136">使用 Analysis Services 指令碼語言 &#40;ASSL&#41; 開發</span><span class="sxs-lookup"><span data-stu-id="b348f-136">Developing with Analysis Services Scripting Language &#40;ASSL&#41;</span></span>](multidimensional-models/scripting-language-assl/developing-with-analysis-services-scripting-language-assl.md)<br /><br /> [<span data-ttu-id="b348f-137">Invoke-ASCmd 指令程式</span><span class="sxs-lookup"><span data-stu-id="b348f-137">Invoke-ASCmd cmdlet</span></span>](/powershell/module/sqlserver/invoke-ascmd)|  
|||<span data-ttu-id="b348f-138">若要建立 XMLA 指令碼，您可以使用 Management Studio 中的指令碼產生器。</span><span class="sxs-lookup"><span data-stu-id="b348f-138">To create XMLA script, you can use the script generator in Management Studio.</span></span> <span data-ttu-id="b348f-139">在物件層級中，以滑鼠右鍵按一下物件，即可產生建立、改變或刪除物件的指令碼。</span><span class="sxs-lookup"><span data-stu-id="b348f-139">At the object level, right-click an object to generate script that creates, alters, or deletes an object.</span></span> <span data-ttu-id="b348f-140">在命令層級中，例如用於處理、備份或還原、彙總設計或另一個命令，您可以使用對話方塊中的指令碼功能，選擇將指令碼放在新視窗、檔案或剪貼簿中的選項，來產生指令碼。</span><span class="sxs-lookup"><span data-stu-id="b348f-140">At the command level, such as for processing, backup or restore, aggregation design, or another command, you can generate script using the Script feature in the dialog box, choosing options that place the script in a new window, file, or clipboard.</span></span> <span data-ttu-id="b348f-141">您也可以在文字或程式碼編輯器中手動撰寫 XMLA 指令碼，或使用範本總管中的範本。</span><span class="sxs-lookup"><span data-stu-id="b348f-141">You can also write XMLA script manually in a text or code editor, or use a template in Template Explorer.</span></span> <span data-ttu-id="b348f-142">若要執行指令碼，請使用下列其中一個方法：</span><span class="sxs-lookup"><span data-stu-id="b348f-142">To run the script, use one of these approaches:</span></span><br /><br /> <span data-ttu-id="b348f-143">使用 Management Studio，在 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 執行個體上直接建立或修改物件。</span><span class="sxs-lookup"><span data-stu-id="b348f-143">Use Management Studio to directly create or modify objects on an [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] instance.</span></span><br /><br /> <span data-ttu-id="b348f-144">使用 SQL Server Agent 來排程包含 Analysis Services 命令工作的作業。</span><span class="sxs-lookup"><span data-stu-id="b348f-144">Use SQL Server Agent to schedule a job that includes an Analysis Services command task.</span></span><br /><br /> <span data-ttu-id="b348f-145">使用 Invoke-ASCmd 指令程式，在 PowerShell 工作階段中執行指令碼。</span><span class="sxs-lookup"><span data-stu-id="b348f-145">Use the Invoke-ASCmd cmdlet to run the script in a PowerShell session.</span></span>||  
|<span data-ttu-id="b348f-146">MDX 指令碼</span><span class="sxs-lookup"><span data-stu-id="b348f-146">MDX Script</span></span>|<span data-ttu-id="b348f-147">.mdx</span><span class="sxs-lookup"><span data-stu-id="b348f-147">.mdx</span></span>|<span data-ttu-id="b348f-148">多維度運算式 (MDX) 語言是分析資料來源的業界標準查詢語言，它也是 XMLA 規格的一部分。</span><span class="sxs-lookup"><span data-stu-id="b348f-148">Multidimensional Expression (MDX) language is an industry standard query language for analytical data sources that is also part of the XMLA specification.</span></span><br /><br /> <span data-ttu-id="b348f-149">您可以建立查詢資料或系統資訊的獨立 MDX 指令碼檔。</span><span class="sxs-lookup"><span data-stu-id="b348f-149">You can create a standalone MDX script file that queries data or system information.</span></span> <span data-ttu-id="b348f-150">例如，公開本機伺服器作業和伺服器健全狀況相關資訊的動態管理檢視 (DMV) 是透過 MDX Select 陳述式來存取。</span><span class="sxs-lookup"><span data-stu-id="b348f-150">For example, Dynamic Management Views (DMV) that expose information about local server operations and server health are accessed via the MDX Select statement.</span></span><br /><br /> <span data-ttu-id="b348f-151">MDX 指令碼會在多維度和表格式模式的伺服器上執行。</span><span class="sxs-lookup"><span data-stu-id="b348f-151">MDX script will run on both multidimensional and tabular mode servers.</span></span> <span data-ttu-id="b348f-152">您可以從 SQL Server Management Studio 以互動方式執行指令碼，或使用 `Invoke-ASCmd` 從 PowerShell 工作階段執行指令碼。</span><span class="sxs-lookup"><span data-stu-id="b348f-152">You can run the script interactively from SQL Server Management Studio, or from a PowerShell session using `Invoke-ASCmd`.</span></span>|[<span data-ttu-id="b348f-153">MDX 指令碼基礎觀念 &#40;Analysis Services&#41;</span><span class="sxs-lookup"><span data-stu-id="b348f-153">MDX Scripting Fundamentals &#40;Analysis Services&#41;</span></span>](multidimensional-models/mdx/mdx-scripting-fundamentals-analysis-services.md)<br /><br /> [<span data-ttu-id="b348f-154">使用動態管理檢視 &#40;DMV&#41; 監視 Analysis Services</span><span class="sxs-lookup"><span data-stu-id="b348f-154">Use Dynamic Management Views &#40;DMVs&#41; to Monitor Analysis Services</span></span>](instances/use-dynamic-management-views-dmvs-to-monitor-analysis-services.md)<br /><br /> [<span data-ttu-id="b348f-155">在 SQL Server Management Studio 中使用 Analysis Services 範本</span><span class="sxs-lookup"><span data-stu-id="b348f-155">Use Analysis Services Templates in SQL Server Management Studio</span></span>](instances/use-analysis-services-templates-in-sql-server-management-studio.md)|  
|<span data-ttu-id="b348f-156">DMX 指令碼</span><span class="sxs-lookup"><span data-stu-id="b348f-156">DMX Script</span></span>|<span data-ttu-id="b348f-157">.dmx</span><span class="sxs-lookup"><span data-stu-id="b348f-157">.dmx</span></span>|<span data-ttu-id="b348f-158">資料採礦延伸模組 (DMX) 是資料採礦模型的資料定義、資料操作和資料查詢語言。</span><span class="sxs-lookup"><span data-stu-id="b348f-158">Data Mining Extensions (DMX) is a data definition, data manipulation, and data query language for data mining models.</span></span> <span data-ttu-id="b348f-159">您可以使用範本做為入門方式。</span><span class="sxs-lookup"><span data-stu-id="b348f-159">You can use a template as a way to get started.</span></span>|[<span data-ttu-id="b348f-160">在 SQL Server Management Studio 中建立 DMX 查詢</span><span class="sxs-lookup"><span data-stu-id="b348f-160">Create a DMX Query in SQL Server Management Studio</span></span>](data-mining/create-a-dmx-query-in-sql-server-management-studio.md)<br /><br /> [<span data-ttu-id="b348f-161">在 SQL Server Management Studio 中使用 Analysis Services 範本</span><span class="sxs-lookup"><span data-stu-id="b348f-161">Use Analysis Services Templates in SQL Server Management Studio</span></span>](instances/use-analysis-services-templates-in-sql-server-management-studio.md)|  
|[!INCLUDE[ssIS](../includes/ssis-md.md)] <span data-ttu-id="b348f-162">封裝</span><span class="sxs-lookup"><span data-stu-id="b348f-162">packages</span></span>|<span data-ttu-id="b348f-163">.dtsx</span><span class="sxs-lookup"><span data-stu-id="b348f-163">.dtsx</span></span>|[!INCLUDE[ssIS](../includes/ssis-md.md)] <span data-ttu-id="b348f-164">提供的工作和資料流程會建立、修改、刪除和處理 Analysis Services 物件，包括資料採礦模型。</span><span class="sxs-lookup"><span data-stu-id="b348f-164">provides tasks and data flows that create, modify, delete, and process Analysis Services objects, including data mining models.</span></span> <span data-ttu-id="b348f-165">您可以使用 SQL Server Agent 來排程封裝執行。</span><span class="sxs-lookup"><span data-stu-id="b348f-165">You can schedule a package to run using SQL Server Agent.</span></span>|[<span data-ttu-id="b348f-166">Analysis Services 執行 DDL 工作</span><span class="sxs-lookup"><span data-stu-id="b348f-166">Analysis Services Execute DDL Task</span></span>](../integration-services/control-flow/analysis-services-execute-ddl-task.md)<br /><br /> [<span data-ttu-id="b348f-167">Analysis Services 處理工作</span><span class="sxs-lookup"><span data-stu-id="b348f-167">Analysis Services Processing Task</span></span>](../integration-services/control-flow/analysis-services-processing-task.md)<br /><br /> [<span data-ttu-id="b348f-168">資料採礦查詢工作</span><span class="sxs-lookup"><span data-stu-id="b348f-168">Data Mining Query Task</span></span>](../integration-services/control-flow/data-mining-query-task.md)<br /><br /> [<span data-ttu-id="b348f-169">資料採礦模型訓練目的地</span><span class="sxs-lookup"><span data-stu-id="b348f-169">Data Mining Model Training Destination</span></span>](../integration-services/data-flow/data-mining-model-training-destination.md)<br /><br /> [<span data-ttu-id="b348f-170">維度處理目的地</span><span class="sxs-lookup"><span data-stu-id="b348f-170">Dimension Processing Destination</span></span>](../integration-services/data-flow/dimension-processing-destination.md)<br /><br /> [<span data-ttu-id="b348f-171">分割區處理目的地</span><span class="sxs-lookup"><span data-stu-id="b348f-171">Partition Processing Destination</span></span>](../integration-services/data-flow/partition-processing-destination.md)|  
|<span data-ttu-id="b348f-172">分析管理物件</span><span class="sxs-lookup"><span data-stu-id="b348f-172">Analysis Management Objects</span></span>||<span data-ttu-id="b348f-173">分析管理物件 (AMO) 是 Managed 介面，程式設計人員可以用它來開發自動化管理作業的自訂應用程式。</span><span class="sxs-lookup"><span data-stu-id="b348f-173">Analysis Management Objects (AMO) is managed interface that programmers can use to develop custom applications that automate administrative operations.</span></span> <span data-ttu-id="b348f-174">使用 AMO，您可以開發自訂應用程式來執行您所提供的 XMLA、MDX 或 DMX 指令碼。</span><span class="sxs-lookup"><span data-stu-id="b348f-174">Using AMO, you can develop a custom application that runs XMLA, MDX, or DMX scripts that you provide.</span></span>|[<span data-ttu-id="b348f-175">使用 AMO 進行管理工作的程式設計</span><span class="sxs-lookup"><span data-stu-id="b348f-175">Programming Administrative Tasks with AMO</span></span>](https://docs.microsoft.com/bi-reference/amo/programming-administrative-tasks-with-amo)|  
  
## <a name="see-also"></a><span data-ttu-id="b348f-176">另請參閱</span><span class="sxs-lookup"><span data-stu-id="b348f-176">See Also</span></span>  
 <span data-ttu-id="b348f-177">[Analysis Services 指令碼語言 &#40;ASSL&#41; 參考](https://docs.microsoft.com/bi-reference/assl/analysis-services-scripting-language-assl-for-xmla) </span><span class="sxs-lookup"><span data-stu-id="b348f-177">[Analysis Services Scripting Language &#40;ASSL&#41; Reference](https://docs.microsoft.com/bi-reference/assl/analysis-services-scripting-language-assl-for-xmla) </span></span>  
 <span data-ttu-id="b348f-178">[流量分析管理物件 &#40;AMO 進行開發&#41;](https://docs.microsoft.com/bi-reference/amo/developing-with-analysis-management-objects-amo) </span><span class="sxs-lookup"><span data-stu-id="b348f-178">[Developing with Analysis Management Objects &#40;AMO&#41;](https://docs.microsoft.com/bi-reference/amo/developing-with-analysis-management-objects-amo) </span></span>  
 [<span data-ttu-id="b348f-179">多維度模型物件處理</span><span class="sxs-lookup"><span data-stu-id="b348f-179">Multidimensional Model Object Processing</span></span>](multidimensional-models/processing-a-multidimensional-model-analysis-services.md)  
  
  
