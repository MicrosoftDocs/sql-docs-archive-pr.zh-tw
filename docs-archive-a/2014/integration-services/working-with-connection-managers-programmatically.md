---
title: 以程式設計方式使用連線管理員 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
helpviewer_keywords:
- connection managers [Integration Services], programming
ms.assetid: 2686fe84-1ecc-48b8-9160-e7122274bd84
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 01fc61a4a5c85366c7af8c5c68a73777049d3cba
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87597897"
---
# <a name="working-with-connection-managers-programmatically"></a><span data-ttu-id="7fc6c-102">以程式設計方式使用連接管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-102">Working with Connection Managers Programmatically</span></span>
  <span data-ttu-id="7fc6c-103">在 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 中，當您在受控碼使用連線管理員時，最常呼叫的方法是相關聯之連線管理員類別的 AcquireConnection 方法。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-103">In [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)], the AcquireConnection method of the associated connection manager class is the method that you call most often when you are working with connection managers in managed code.</span></span> <span data-ttu-id="7fc6c-104">當您撰寫受控碼時，必須呼叫 AcquireConnection 方法才能使用連線管理員的功能。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-104">When you write managed code, you have to call the AcquireConnection method to use the functionality of a connection manager.</span></span> <span data-ttu-id="7fc6c-105">不論是在指令碼工作、指令碼元件、自訂物件或是自訂應用程式中撰寫 Managed 程式碼，都必須呼叫這個方法。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-105">You have to call this method regardless of whether you are writing managed code in a Script task, Script component, custom object, or custom application.</span></span>  
  
 <span data-ttu-id="7fc6c-106">若要成功呼叫 AcquireConnection 方法，您必須知道下列問題的答案：</span><span class="sxs-lookup"><span data-stu-id="7fc6c-106">To call the AcquireConnection method successfully, you have to know the answers to the following questions:</span></span>  
  
-   <span data-ttu-id="7fc6c-107">**哪些連線管理員從 AcquireConnection 方法傳回受控物件？**</span><span class="sxs-lookup"><span data-stu-id="7fc6c-107">**Which connection managers return a managed object from the AcquireConnection method?**</span></span>  
  
     <span data-ttu-id="7fc6c-108">許多連線管理員都會傳回非受控 COM 物件 (System.__ComObject)，而這些物件無法輕鬆地從受控碼中加以使用。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-108">Many connection managers return unmanaged COM objects (System.__ComObject) and these objects cannot easily be used from managed code.</span></span> <span data-ttu-id="7fc6c-109">這些連接管理員的清單包括最常使用的 OLE DB 連接管理員。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-109">The list of these connection managers includes the frequently used OLE DB connection manager.</span></span>  
  
-   <span data-ttu-id="7fc6c-110">**對於傳回受控物件的連線管理員而言，其 AcquireConnection 方法會傳回哪些物件？**</span><span class="sxs-lookup"><span data-stu-id="7fc6c-110">**For those connection managers that return a managed object, what objects do their AcquireConnection methods return?**</span></span>  
  
     <span data-ttu-id="7fc6c-111">若要將傳回值轉換成適當的類型，您必須了解 AcquireConnection 方法會傳回的物件類型。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-111">To cast the return value to the appropriate type, you have to know what type of object the AcquireConnection method returns.</span></span> <span data-ttu-id="7fc6c-112">例如，當您使用 SqlClient 提供者時，[!INCLUDE[vstecado](../includes/vstecado-md.md)] 連線管理員的 AcquireConnection 方法會傳回開啟的 SqlConnection 物件。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-112">For example, the AcquireConnection method for the [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager returns an open SqlConnection object when you use the SqlClient provider.</span></span> <span data-ttu-id="7fc6c-113">然而，檔案連線管理員的 AcquireConnection 方法只會傳回字串。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-113">However, the AcquireConnection method for the File connection manager just returns a string.</span></span>  
  
 <span data-ttu-id="7fc6c-114">本主題會回答上述隨附於 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 之連接管理員的問題。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-114">This topic answers these questions for the connection managers that are included with [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)].</span></span>  
  
## <a name="connection-managers-that-do-not-return-a-managed-object"></a><span data-ttu-id="7fc6c-115">不會傳回 Managed 物件的連接管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-115">Connection Managers That Do Not Return a Managed Object</span></span>  
 <span data-ttu-id="7fc6c-116">下表列出從 AcquireConnection 方法傳回原生 COM 物件 (System.__ComObject) 的連線管理員。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-116">The following table lists the connection managers that return a native COM object (System.__ComObject) from the AcquireConnection method.</span></span> <span data-ttu-id="7fc6c-117">這些 Unmanaged 物件無法輕鬆地從 Managed 程式碼中加以使用。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-117">These unmanaged objects cannot easily be used from managed code.</span></span>  
  
|<span data-ttu-id="7fc6c-118">連接管理員類型</span><span class="sxs-lookup"><span data-stu-id="7fc6c-118">Connection Manager Type</span></span>|<span data-ttu-id="7fc6c-119">連接管理員名稱</span><span class="sxs-lookup"><span data-stu-id="7fc6c-119">Connection Manager Name</span></span>|  
|-----------------------------|-----------------------------|  
|<span data-ttu-id="7fc6c-120">ADO</span><span class="sxs-lookup"><span data-stu-id="7fc6c-120">ADO</span></span>|<span data-ttu-id="7fc6c-121">ADO 連接管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-121">ADO Connection Manager</span></span>|  
|<span data-ttu-id="7fc6c-122">MSOLAP90</span><span class="sxs-lookup"><span data-stu-id="7fc6c-122">MSOLAP90</span></span>|[!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] <span data-ttu-id="7fc6c-123">連接管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-123">Connection Manager</span></span>|  
|<span data-ttu-id="7fc6c-124">EXCEL</span><span class="sxs-lookup"><span data-stu-id="7fc6c-124">EXCEL</span></span>|<span data-ttu-id="7fc6c-125">Excel 連接管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-125">Excel Connection Manager</span></span>|  
|<span data-ttu-id="7fc6c-126">FTP</span><span class="sxs-lookup"><span data-stu-id="7fc6c-126">FTP</span></span>|<span data-ttu-id="7fc6c-127">FTP 連接管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-127">FTP Connection Manager</span></span>|  
|<span data-ttu-id="7fc6c-128">HTTP</span><span class="sxs-lookup"><span data-stu-id="7fc6c-128">HTTP</span></span>|<span data-ttu-id="7fc6c-129">HTTP 連接管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-129">HTTP Connection Manager</span></span>|  
|<span data-ttu-id="7fc6c-130">ODBC</span><span class="sxs-lookup"><span data-stu-id="7fc6c-130">ODBC</span></span>|<span data-ttu-id="7fc6c-131">ODBC 連接管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-131">ODBC Connection Manager</span></span>|  
|<span data-ttu-id="7fc6c-132">OLEDB</span><span class="sxs-lookup"><span data-stu-id="7fc6c-132">OLEDB</span></span>|<span data-ttu-id="7fc6c-133">OLE DB 連接管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-133">OLE DB Connection Manager</span></span>|  
  
 <span data-ttu-id="7fc6c-134">一般而言，您可以從受控碼使用 [!INCLUDE[vstecado](../includes/vstecado-md.md)] 連線管理員連線至 ADO、Excel、ODBC 或 OLE DB 資料來源。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-134">Typically, you can use an [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager from managed code to connect to an ADO, Excel, ODBC, or OLE DB data source.</span></span>  
  
## <a name="return-values-from-the-acquireconnection-method"></a><span data-ttu-id="7fc6c-135">從 AcquireConnection 方法傳回值。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-135">Return Values from the AcquireConnection Method</span></span>  
 <span data-ttu-id="7fc6c-136">下表列出從 AcquireConnection 方法傳回受管理物件的連線管理員。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-136">The following table lists the connection managers that return a managed object from the AcquireConnection method.</span></span> <span data-ttu-id="7fc6c-137">這些 Managed 物件可以輕鬆地從 Managed 程式碼中加以使用。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-137">These managed objects can easily be used from managed code.</span></span>  
  
|<span data-ttu-id="7fc6c-138">連接管理員類型</span><span class="sxs-lookup"><span data-stu-id="7fc6c-138">Connection Manager Type</span></span>|<span data-ttu-id="7fc6c-139">連接管理員名稱</span><span class="sxs-lookup"><span data-stu-id="7fc6c-139">Connection Manager Name</span></span>|<span data-ttu-id="7fc6c-140">傳回值的類型</span><span class="sxs-lookup"><span data-stu-id="7fc6c-140">Type of Return Value</span></span>|<span data-ttu-id="7fc6c-141">其他資訊</span><span class="sxs-lookup"><span data-stu-id="7fc6c-141">Additional Information</span></span>|  
|-----------------------------|-----------------------------|--------------------------|----------------------------|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|[!INCLUDE[vstecado](../includes/vstecado-md.md)] <span data-ttu-id="7fc6c-142">連接管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-142">Connection Manager</span></span>|`System.Data.SqlClient.SqlConnection`||  
|<span data-ttu-id="7fc6c-143">FILE</span><span class="sxs-lookup"><span data-stu-id="7fc6c-143">FILE</span></span>|<span data-ttu-id="7fc6c-144">檔案連接管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-144">File Connection Manager</span></span>|`System.String`|<span data-ttu-id="7fc6c-145">檔案的路徑。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-145">Path to the file.</span></span>|  
|<span data-ttu-id="7fc6c-146">FLATFILE</span><span class="sxs-lookup"><span data-stu-id="7fc6c-146">FLATFILE</span></span>|<span data-ttu-id="7fc6c-147">一般檔案連接管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-147">Flat File Connection Manager</span></span>|`System.String`|<span data-ttu-id="7fc6c-148">檔案的路徑。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-148">Path to the file.</span></span>|  
|<span data-ttu-id="7fc6c-149">MSMQ</span><span class="sxs-lookup"><span data-stu-id="7fc6c-149">MSMQ</span></span>|<span data-ttu-id="7fc6c-150">MSMQ 連接管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-150">MSMQ Connection Manager</span></span>|`System.Messaging.MessageQueue`||  
|<span data-ttu-id="7fc6c-151">MULTIFILE</span><span class="sxs-lookup"><span data-stu-id="7fc6c-151">MULTIFILE</span></span>|<span data-ttu-id="7fc6c-152">多個檔案連接管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-152">Multiple Files Connection Manager</span></span>|`System.String`|<span data-ttu-id="7fc6c-153">其中一個檔案的路徑。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-153">Path to one of the files.</span></span>|  
|<span data-ttu-id="7fc6c-154">MULTIFLATFILE</span><span class="sxs-lookup"><span data-stu-id="7fc6c-154">MULTIFLATFILE</span></span>|<span data-ttu-id="7fc6c-155">多個一般檔案連接管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-155">Multiple Flat Files Connection Manager</span></span>|`System.String`|<span data-ttu-id="7fc6c-156">其中一個檔案的路徑。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-156">Path to one of the files.</span></span>|  
|<span data-ttu-id="7fc6c-157">SMOServer</span><span class="sxs-lookup"><span data-stu-id="7fc6c-157">SMOServer</span></span>|<span data-ttu-id="7fc6c-158">SMO 連線管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-158">SMO Connection Manager</span></span>|`Microsoft.SqlServer.Management.Smo.Server`||  
|<span data-ttu-id="7fc6c-159">SMTP</span><span class="sxs-lookup"><span data-stu-id="7fc6c-159">SMTP</span></span>|<span data-ttu-id="7fc6c-160">SMTP 連接管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-160">SMTP Connection Manager</span></span>|`System.String`|<span data-ttu-id="7fc6c-161">例如： `SmtpServer=<server name>;UseWindowsAuthentication=True;EnableSsl=False;`</span><span class="sxs-lookup"><span data-stu-id="7fc6c-161">For example: `SmtpServer=<server name>;UseWindowsAuthentication=True;EnableSsl=False;`</span></span>|  
|<span data-ttu-id="7fc6c-162">WMI</span><span class="sxs-lookup"><span data-stu-id="7fc6c-162">WMI</span></span>|<span data-ttu-id="7fc6c-163">WMI 連接管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-163">WMI Connection Manager</span></span>|`System.Management.ManagementScope`||  
|<span data-ttu-id="7fc6c-164">SQLMOBILE</span><span class="sxs-lookup"><span data-stu-id="7fc6c-164">SQLMOBILE</span></span>|<span data-ttu-id="7fc6c-165">SQL Server Compact 連接管理員</span><span class="sxs-lookup"><span data-stu-id="7fc6c-165">SQL Server Compact Connection Manager</span></span>|`System.Data.SqlServerCe.SqlCeConnection`||  
  
<span data-ttu-id="7fc6c-166">![Integration Services 圖示 (小型) ](media/dts-16.gif "Integration Services 圖示 (小)")會**保持最**新狀態 Integration Services  </span><span class="sxs-lookup"><span data-stu-id="7fc6c-166">![Integration Services icon (small)](media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="7fc6c-167">若要取得 Microsoft 的最新下載、文件、範例和影片以及社群中的精選解決方案，請瀏覽 MSDN 上的 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 頁面：</span><span class="sxs-lookup"><span data-stu-id="7fc6c-167">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="7fc6c-168">瀏覽 MSDN 上的 Integration Services 頁面</span><span class="sxs-lookup"><span data-stu-id="7fc6c-168">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="7fc6c-169">若要得到這些更新的自動通知，請訂閱該頁面上所提供的 RSS 摘要。</span><span class="sxs-lookup"><span data-stu-id="7fc6c-169">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7fc6c-170">另請參閱</span><span class="sxs-lookup"><span data-stu-id="7fc6c-170">See Also</span></span>  
 <span data-ttu-id="7fc6c-171">[連接至腳本工作中的資料來源](extending-packages-scripting/task/connecting-to-data-sources-in-the-script-task.md) </span><span class="sxs-lookup"><span data-stu-id="7fc6c-171">[Connecting to Data Sources in the Script Task](extending-packages-scripting/task/connecting-to-data-sources-in-the-script-task.md) </span></span>  
 <span data-ttu-id="7fc6c-172">[連接到腳本元件中的資料來源](extending-packages-scripting/data-flow-script-component/connecting-to-data-sources-in-the-script-component.md) </span><span class="sxs-lookup"><span data-stu-id="7fc6c-172">[Connecting to Data Sources in the Script Component](extending-packages-scripting/data-flow-script-component/connecting-to-data-sources-in-the-script-component.md) </span></span>  
 [<span data-ttu-id="7fc6c-173">在自訂工作中連線至資料來源</span><span class="sxs-lookup"><span data-stu-id="7fc6c-173">Connecting to Data Sources in a Custom Task</span></span>](extending-packages-custom-objects/task/connecting-to-data-sources-in-a-custom-task.md)  
  
  
