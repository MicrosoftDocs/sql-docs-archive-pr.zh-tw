---
title: 比較字串資料 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- comparing string data
- comparison options [Integration Services]
- locales [Integration Services]
- converting string data
- string comparisons
ms.assetid: 93aeb5bd-e208-46b7-8979-dea2dcd37d4c
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 5670f434470d8fad0a8b593ccde0c01ae307e417
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87599616"
---
# <a name="comparing-string-data"></a><span data-ttu-id="aad38-102">比較字串資料</span><span class="sxs-lookup"><span data-stu-id="aad38-102">Comparing String Data</span></span>
  <span data-ttu-id="aad38-103">字串比較是由 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]執行之許多轉換中的重要部分，此外在評估變數的運算式和屬性運算式時也會使用字串比較。</span><span class="sxs-lookup"><span data-stu-id="aad38-103">String comparisons are an important part of many of the transformations performed by [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)], and string comparisons are also used in the evaluation of expressions in variables and property expressions.</span></span> <span data-ttu-id="aad38-104">例如，「排序」轉換會比較資料集中的值，並以遞增或遞減的順序對資料進行排序。</span><span class="sxs-lookup"><span data-stu-id="aad38-104">For example, the Sort transformation compares values in a dataset to sort data in ascending or descending order.</span></span>  
  
## <a name="configuring-transformations-for-string-comparisons"></a><span data-ttu-id="aad38-105">設定字串比較的轉換</span><span class="sxs-lookup"><span data-stu-id="aad38-105">Configuring Transformations for String Comparisons</span></span>  
 <span data-ttu-id="aad38-106">您可以自訂「排序」、「彙總」、「模糊群組」和「模糊查閱」轉換，以變更在資料行層級比較字串的方式。</span><span class="sxs-lookup"><span data-stu-id="aad38-106">The Sort, Aggregate, Fuzzy Grouping, and Fuzzy Lookup transformations can be customized to change the way strings are compared at the column level.</span></span> <span data-ttu-id="aad38-107">例如，您可以指定比較忽略大小寫，這表示大寫和小寫字元都會被視為相同的字元。</span><span class="sxs-lookup"><span data-stu-id="aad38-107">For example, you can specify that a comparison ignores case, which means that uppercase and lowercase characters are treated as the same character.</span></span>  
  
 <span data-ttu-id="aad38-108">下列轉換使用可包含字串比較的運算式。</span><span class="sxs-lookup"><span data-stu-id="aad38-108">The following transformations use expressions that can include string comparisons.</span></span>  
  
-   <span data-ttu-id="aad38-109">「條件式分割」轉換可使用運算式中的字串比較，以決定將資料列傳送到哪個輸出。</span><span class="sxs-lookup"><span data-stu-id="aad38-109">The Conditional Split transformation can use string comparisons in expressions to determine which output to send the data row to.</span></span> <span data-ttu-id="aad38-110">如需詳細資訊，請參閱 [Conditional Split Transformation](transformations/conditional-split-transformation.md)。</span><span class="sxs-lookup"><span data-stu-id="aad38-110">For more information, see [Conditional Split Transformation](transformations/conditional-split-transformation.md).</span></span>  
  
-   <span data-ttu-id="aad38-111">「衍生的資料行」轉換可使用運算式中的字串比較，以產生新的資料行值。</span><span class="sxs-lookup"><span data-stu-id="aad38-111">The Derived Column transformation can use string comparisons in expressions to generate new column values.</span></span> <span data-ttu-id="aad38-112">如需詳細資訊，請參閱 [衍生的資料行轉換](transformations/derived-column-transformation.md)。</span><span class="sxs-lookup"><span data-stu-id="aad38-112">For more information, see [Derived Column Transformation](transformations/derived-column-transformation.md).</span></span>  
  
 <span data-ttu-id="aad38-113">變數、變數對應和優先順序條件約束也使用運算式，它們可以包含字串比較。</span><span class="sxs-lookup"><span data-stu-id="aad38-113">Variables, variable mappings, and precedence constraints also use expressions, which can include string comparisons.</span></span> <span data-ttu-id="aad38-114">如需運算式的詳細資訊，請參閱 [Integration Services &#40;SSIS&#41; 運算式](../expressions/integration-services-ssis-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="aad38-114">For more information about expressions, see [Integration Services &#40;SSIS&#41; Expressions](../expressions/integration-services-ssis-expressions.md).</span></span>  
  
## <a name="processing-during-string-comparison"></a><span data-ttu-id="aad38-115">在字串比較期間處理</span><span class="sxs-lookup"><span data-stu-id="aad38-115">Processing during String Comparison</span></span>  
 <span data-ttu-id="aad38-116">視轉換的資料和組態而定，比較字串資料的過程中可能會進行下列處理：</span><span class="sxs-lookup"><span data-stu-id="aad38-116">Depending on the data and the configuration of the transformation, the following processing may occur during the comparison of string data:</span></span>  
  
-   <span data-ttu-id="aad38-117">將資料轉換成 Unicode。</span><span class="sxs-lookup"><span data-stu-id="aad38-117">Converting data to Unicode.</span></span> <span data-ttu-id="aad38-118">如果來源資料還不是 Unicode，則比較發生之前資料會自動轉換成 Unicode。</span><span class="sxs-lookup"><span data-stu-id="aad38-118">If the source data is not already Unicode, the data is automatically converted to Unicode before the comparison occurs.</span></span>  
  
-   <span data-ttu-id="aad38-119">使用地區設定來套用用於解譯日期、時間、十進位資料之地區設定特定的規則和排序次序。</span><span class="sxs-lookup"><span data-stu-id="aad38-119">Using locale to apply locale-specific rules for interpreting date, time, decimal data, and sort order.</span></span>  
  
-   <span data-ttu-id="aad38-120">在資料行層級套用比較選項來變更比較的敏感性。</span><span class="sxs-lookup"><span data-stu-id="aad38-120">Applying comparison options at the column level to change the sensitivity of comparisons.</span></span>  
  
## <a name="converting-string-data-to-unicode"></a><span data-ttu-id="aad38-121">將字串資料轉換成 Unicode</span><span class="sxs-lookup"><span data-stu-id="aad38-121">Converting String Data to Unicode</span></span>  
 <span data-ttu-id="aad38-122">視轉換執行的作業及轉換組態而定，可以將字串資料轉換為 DT_WSTR 資料類型，這是字串字元的 Unicode 表示法。</span><span class="sxs-lookup"><span data-stu-id="aad38-122">Depending on the operations that the transformation performs and the configuration of the transformation, string data may be converted to the DT_WSTR data type, which is a Unicode representation of string characters.</span></span>  
  
 <span data-ttu-id="aad38-123">具有 DT_STR 資料類型的字串資料，會使用資料行的字碼頁來轉換成 Unicode。</span><span class="sxs-lookup"><span data-stu-id="aad38-123">String data that has the DT_STR data type is converted to Unicode using the code page of the column.</span></span> [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="aad38-124">支援資料行層級的字碼頁，而每個資料行都可以用不同的字碼頁來轉換。</span><span class="sxs-lookup"><span data-stu-id="aad38-124">supports code pages at the column level, and each column can be converted by using a different code page.</span></span>  
  
 <span data-ttu-id="aad38-125">在大多數情況下， [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 可識別資料來源中的正確字碼頁。</span><span class="sxs-lookup"><span data-stu-id="aad38-125">In most cases, [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] can identify the correct code page from the data source.</span></span> <span data-ttu-id="aad38-126">例如，在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 中，您可在資料庫和資料行層級設定定序。</span><span class="sxs-lookup"><span data-stu-id="aad38-126">For example, in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] you can set a collation at the database and column levels.</span></span> <span data-ttu-id="aad38-127">字碼頁從 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 定序 (可以是 Windows 或 SQL 定序) 衍生。</span><span class="sxs-lookup"><span data-stu-id="aad38-127">The code page is derived from a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] collation, which can be either a Windows or an SQL collation.</span></span>  
  
 <span data-ttu-id="aad38-128">如果 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 提供一個非預期的字碼頁，或者封裝使用未提供足夠資訊來判斷字碼頁是否正確的提供者來存取資料，則您可以在 OLE DB 來源和 OLE DB 目的地中指定預設字碼頁。</span><span class="sxs-lookup"><span data-stu-id="aad38-128">If [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] provides an unexpected code page, or if the package accesses a data source by using a provider that does not supply sufficient information to determine the correct code page, you can specify a default code page in the OLE DB source and the OLE DB destination.</span></span> <span data-ttu-id="aad38-129">此預設字碼頁會取代 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 提供的字碼頁。</span><span class="sxs-lookup"><span data-stu-id="aad38-129">The default code pages are used instead of the code pages that [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] provides.</span></span>  
  
 <span data-ttu-id="aad38-130">檔案不包含字碼頁。</span><span class="sxs-lookup"><span data-stu-id="aad38-130">Files do not have code pages.</span></span> <span data-ttu-id="aad38-131">但是，封裝用來連接到檔案資料的「一般檔案」和「多個一般檔案」連接管理員，會包含用來指定該檔案字碼頁的屬性。</span><span class="sxs-lookup"><span data-stu-id="aad38-131">Instead, the Flat File and the Multiple Flat Files connection managers that a package uses to connect to file data include a property for specifying the code page of the file.</span></span> <span data-ttu-id="aad38-132">字碼頁只能在檔案層級，而不能在資料行層級進行設定。</span><span class="sxs-lookup"><span data-stu-id="aad38-132">The code page can be set at the file level only, not at the column level.</span></span>  
  
## <a name="setting-locale"></a><span data-ttu-id="aad38-133">設定地區設定</span><span class="sxs-lookup"><span data-stu-id="aad38-133">Setting Locale</span></span>  
 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="aad38-134">不會使用字碼頁來推斷用於排序資料或解譯日期、時間和十進位資料之地區設定的特定規則。</span><span class="sxs-lookup"><span data-stu-id="aad38-134">does not use the code page to infer locale-specific rules for sorting data or interpreting date, time, and decimal data.</span></span> <span data-ttu-id="aad38-135">反之，轉換會讀取資料流程元件、「資料流程」工作、容器或封裝上 LocaleId 屬性設定的地區設定。</span><span class="sxs-lookup"><span data-stu-id="aad38-135">Instead, the transformation reads the locale that is set by the LocaleId property on the data flow component, Data Flow task, container, or package.</span></span> <span data-ttu-id="aad38-136">依預設，轉換的地區設定會從其「資料流程」工作繼承，此工作進而從封裝繼承。</span><span class="sxs-lookup"><span data-stu-id="aad38-136">By default, the locale of a transformation is inherited from its Data Flow task, which in turn inherits from the package.</span></span> <span data-ttu-id="aad38-137">如果「資料流程」工作在某個容器中 (如「For 迴圈」容器)，則它會從容器繼承其地區設定。</span><span class="sxs-lookup"><span data-stu-id="aad38-137">If the Data Flow task is in a container such as the For Loop container, it inherits its locale from the container.</span></span>  
  
 <span data-ttu-id="aad38-138">您也可以指定「一般檔案」連接管理員和「多個一般檔案」連接管理員的地區設定。</span><span class="sxs-lookup"><span data-stu-id="aad38-138">You can also specify a locale for a Flat File connection manager and a Multiple Flat Files connection manager.</span></span>  
  
## <a name="setting-comparison-options"></a><span data-ttu-id="aad38-139">設定比較選項</span><span class="sxs-lookup"><span data-stu-id="aad38-139">Setting Comparison Options</span></span>  
 <span data-ttu-id="aad38-140">地區設定會提供比較字串資料的基本規則。</span><span class="sxs-lookup"><span data-stu-id="aad38-140">The locale provides the basic rules for comparing string data.</span></span> <span data-ttu-id="aad38-141">例如，地區設定指定字母表中每個字母的排序位置。</span><span class="sxs-lookup"><span data-stu-id="aad38-141">For example, the locale specifies the sort position of each letter in the alphabet.</span></span> <span data-ttu-id="aad38-142">但是，這些規則對某些轉換執行的比較來說可能並不夠，而且 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 還支援一組超越地區設定之比較規則的進階比較選項。</span><span class="sxs-lookup"><span data-stu-id="aad38-142">However, these rules may not be sufficient for the comparisons that some transformations perform, and [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] supports a set of advanced comparison options that go beyond the comparison rules of a locale.</span></span> <span data-ttu-id="aad38-143">這些比較選項可在資料行層級進行設定。</span><span class="sxs-lookup"><span data-stu-id="aad38-143">These comparison options are set at the column level.</span></span> <span data-ttu-id="aad38-144">例如，其中一個比較選項可讓您忽略非空格字元。</span><span class="sxs-lookup"><span data-stu-id="aad38-144">For example, one of the comparison options lets you ignore nonspacing characters.</span></span> <span data-ttu-id="aad38-145">此選項的作用是忽略像是輔色的符號，這會使 "a" 和 "å" 與比較目的相同。</span><span class="sxs-lookup"><span data-stu-id="aad38-145">The effect of this option is to ignore diacritics such as the accent, which makes "a" and "å" identical for comparison purposes.</span></span>  
  
 <span data-ttu-id="aad38-146">下表描述比較選項和排序樣式。</span><span class="sxs-lookup"><span data-stu-id="aad38-146">The following table describes the comparison options and a sort style.</span></span>  
  
|<span data-ttu-id="aad38-147">比較選項</span><span class="sxs-lookup"><span data-stu-id="aad38-147">Comparison option</span></span>|<span data-ttu-id="aad38-148">描述</span><span class="sxs-lookup"><span data-stu-id="aad38-148">Description</span></span>|  
|-----------------------|-----------------|  
|<span data-ttu-id="aad38-149">忽略大小寫</span><span class="sxs-lookup"><span data-stu-id="aad38-149">Ignore case</span></span>|<span data-ttu-id="aad38-150">指定比較是否區分大寫與小寫字母。</span><span class="sxs-lookup"><span data-stu-id="aad38-150">Specifies whether the comparison distinguishes between uppercase and lowercase letters.</span></span> <span data-ttu-id="aad38-151">如果設定此選項，則字串比較會忽略大小寫。</span><span class="sxs-lookup"><span data-stu-id="aad38-151">If this option is set, the string comparison ignores case.</span></span> <span data-ttu-id="aad38-152">例如，「ABC」與「abc」視為一樣。</span><span class="sxs-lookup"><span data-stu-id="aad38-152">For example, "ABC" becomes the same as "abc".</span></span>|  
|<span data-ttu-id="aad38-153">忽略假名類型</span><span class="sxs-lookup"><span data-stu-id="aad38-153">Ignore kana type</span></span>|<span data-ttu-id="aad38-154">指定比較是否區分兩類日文的假名字元：平假名與片假名。</span><span class="sxs-lookup"><span data-stu-id="aad38-154">Specifies whether the comparison distinguishes between the two types of Japanese kana characters: hiragana and katakana.</span></span> <span data-ttu-id="aad38-155">如果設定此選項，則字串比較會忽略假名類型。</span><span class="sxs-lookup"><span data-stu-id="aad38-155">If this option is set, the string comparison ignores kana type.</span></span>|  
|<span data-ttu-id="aad38-156">忽略字元寬度</span><span class="sxs-lookup"><span data-stu-id="aad38-156">Ignore character width</span></span>|<span data-ttu-id="aad38-157">指定比較是否區分單一位元組字元和表示為雙位元組字元的相同字元。</span><span class="sxs-lookup"><span data-stu-id="aad38-157">Specifies whether the comparison distinguishes between a single-byte character and the same character when it is represented as a double-byte character.</span></span> <span data-ttu-id="aad38-158">如果設定此選項，則字串比較會將同一字元的單一位元組表示法和雙位元組表示法視為一樣。</span><span class="sxs-lookup"><span data-stu-id="aad38-158">If this option is set, the string comparison treats single-byte and double-byte representations of the same character as identical.</span></span>|  
|<span data-ttu-id="aad38-159">忽略非空格字元</span><span class="sxs-lookup"><span data-stu-id="aad38-159">Ignore nonspacing characters</span></span>|<span data-ttu-id="aad38-160">指定比較是否區分空格字元與變音。</span><span class="sxs-lookup"><span data-stu-id="aad38-160">Specifies whether the comparison distinguishes between spacing characters and diacritics.</span></span> <span data-ttu-id="aad38-161">如果設定此選項，則比較會忽略變音符號。</span><span class="sxs-lookup"><span data-stu-id="aad38-161">If this option is set, the comparison ignores diacritics.</span></span> <span data-ttu-id="aad38-162">例如，"å" 等於 "a"。</span><span class="sxs-lookup"><span data-stu-id="aad38-162">For example, "å" is equal to "a".</span></span>|  
|<span data-ttu-id="aad38-163">忽略符號</span><span class="sxs-lookup"><span data-stu-id="aad38-163">Ignore symbols</span></span>|<span data-ttu-id="aad38-164">指定比較是否區分字母字元與符號 (例如空白字元、標點符號、貨幣符號和數學符號)。</span><span class="sxs-lookup"><span data-stu-id="aad38-164">Specifies whether the comparison distinguishes between letter characters and symbols such as white-space characters, punctuation, currency symbols, and mathematical symbols.</span></span> <span data-ttu-id="aad38-165">如果設定此選項，則字串比較會忽略符號。</span><span class="sxs-lookup"><span data-stu-id="aad38-165">If this option is set, the string comparison ignores symbols.</span></span> <span data-ttu-id="aad38-166">例如，" New York" 與 "New York"，以及 "\*ABC" 與 "ABC"' 均被視為一樣。</span><span class="sxs-lookup"><span data-stu-id="aad38-166">For example, " New York" becomes the same as "New York" and "\*ABC" is the same as "ABC"'.</span></span>|  
|<span data-ttu-id="aad38-167">將標點符號當作符號來排序</span><span class="sxs-lookup"><span data-stu-id="aad38-167">Sort punctuation as symbols</span></span>|<span data-ttu-id="aad38-168">指定比較是否對英數字元前面的所有標點符號進行排序 (連字號和撇號除外)。</span><span class="sxs-lookup"><span data-stu-id="aad38-168">Specifies whether the comparison sorts all punctuation symbols, except the hyphen and apostrophe, before the alphanumeric characters.</span></span> <span data-ttu-id="aad38-169">例如，如果設定此選項，則「.ABC」將排在「ABC」前面。</span><span class="sxs-lookup"><span data-stu-id="aad38-169">For example, if this option is set, ".ABC" sorts before "ABC".</span></span>|  
  
 <span data-ttu-id="aad38-170">「排序」、「彙總」「模糊群組」和「模糊查閱」轉換包含這些用於比較資料的選項。</span><span class="sxs-lookup"><span data-stu-id="aad38-170">The Sort, Aggregate, Fuzzy Grouping and Fuzzy Lookup transformations include these options for comparing data.</span></span>  
  
 <span data-ttu-id="aad38-171">「模糊群組」和「模糊查閱」轉換的 [進階編輯器] 對話方塊中會顯示 **FullySensitive** 比較旗標。</span><span class="sxs-lookup"><span data-stu-id="aad38-171">The **FullySensitive** comparison flag displays in the **Advanced Editor** dialog box for the Fuzzy Grouping and Fuzzy Lookup transformations.</span></span> <span data-ttu-id="aad38-172">選取 [FullySensitive]  比較旗標表示會套用所有的比較選項。</span><span class="sxs-lookup"><span data-stu-id="aad38-172">Selecting the **FullySensitive** comparison flag means that all the comparison options apply.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="aad38-173">另請參閱</span><span class="sxs-lookup"><span data-stu-id="aad38-173">See Also</span></span>  
 <span data-ttu-id="aad38-174">[Integration Services 資料類型](integration-services-data-types.md) </span><span class="sxs-lookup"><span data-stu-id="aad38-174">[Integration Services Data Types](integration-services-data-types.md) </span></span>  
 <span data-ttu-id="aad38-175">[快速剖析](../fast-parse.md) </span><span class="sxs-lookup"><span data-stu-id="aad38-175">[Fast Parse](../fast-parse.md) </span></span>  
 [<span data-ttu-id="aad38-176">標準剖析</span><span class="sxs-lookup"><span data-stu-id="aad38-176">Standard Parse</span></span>](../standard-parse.md)  
  
  
