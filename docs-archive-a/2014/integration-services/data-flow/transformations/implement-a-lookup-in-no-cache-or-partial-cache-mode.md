---
title: 以沒有快取或部分快取模式實作查閱 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Lookup transformation
- match exactly [Integration Services]
- lookups [Integration Services]
- exact matches [Integration Services]
ms.assetid: 01b7fbca-5181-4d47-9f75-7f25af6b40d2
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 5c3958450d6371299972a69f5312a3c631c853aa
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87599105"
---
# <a name="implement-a-lookup-in-no-cache-or-partial-cache-mode"></a><span data-ttu-id="3826e-102">以沒有快取或部分快取模式實作查閱</span><span class="sxs-lookup"><span data-stu-id="3826e-102">Implement a Lookup in No Cache or Partial Cache Mode</span></span>
  <span data-ttu-id="3826e-103">您可以將查閱轉換設定為使用部分快取或沒有快取模式：</span><span class="sxs-lookup"><span data-stu-id="3826e-103">You can configure the Lookup transformation to use the partial cache or no cache mode:</span></span>  
  
-   <span data-ttu-id="3826e-104">部分快取</span><span class="sxs-lookup"><span data-stu-id="3826e-104">Partial cache</span></span>  
  
     <span data-ttu-id="3826e-105">在參考資料集中具有相符項目的資料列，以及在資料集中沒有相符項目的資料列 (選擇性)，都會儲存在快取中。</span><span class="sxs-lookup"><span data-stu-id="3826e-105">The rows with matching entries in the reference dataset and, optionally, the rows without matching entries in the dataset are stored in cache.</span></span> <span data-ttu-id="3826e-106">超過快取的記憶體大小時，查閱轉換會自動從快取中移除最不常用的資料列。</span><span class="sxs-lookup"><span data-stu-id="3826e-106">When the memory size of the cache is exceeded, the Lookup transformation automatically removes the least frequently used rows from the cache.</span></span>  
  
-   <span data-ttu-id="3826e-107">沒有快取</span><span class="sxs-lookup"><span data-stu-id="3826e-107">No cache</span></span>  
  
     <span data-ttu-id="3826e-108">沒有資料會載入到快取。</span><span class="sxs-lookup"><span data-stu-id="3826e-108">No data is loaded into cache.</span></span>  
  
 <span data-ttu-id="3826e-109">不論是選取部份快取或沒有快取，都是使用 OLE DB 連接管理員連接到參考資料集。</span><span class="sxs-lookup"><span data-stu-id="3826e-109">Whether you select partial cache or no cache, you use an OLE DB connection manager to connect to the reference dataset.</span></span> <span data-ttu-id="3826e-110">參考資料集是藉由在執行查閱轉換期間使用資料表、檢視或 SQL 查詢而產生。</span><span class="sxs-lookup"><span data-stu-id="3826e-110">The reference dataset is generated by using a table, view, or SQL query during the execution of the Lookup transformation</span></span>  
  
### <a name="to-implement-a-lookup-transformation-in-no-cache-or-partial-cache-mode"></a><span data-ttu-id="3826e-111">若要以沒有快取或部分快取模式實作查閱轉換</span><span class="sxs-lookup"><span data-stu-id="3826e-111">To implement a Lookup transformation in no cache or partial cache mode</span></span>  
  
1.  <span data-ttu-id="3826e-112">在 [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)]中，開啟包含所要封裝的 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] 專案，然後再開啟封裝。</span><span class="sxs-lookup"><span data-stu-id="3826e-112">In [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)], open the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] project that contains the package you want, and then open the package.</span></span>  
  
2.  <span data-ttu-id="3826e-113">在 **[資料流程]** 索引標籤上，加入查閱轉換。</span><span class="sxs-lookup"><span data-stu-id="3826e-113">On the **Data Flow** tab, add a Lookup transformation.</span></span>  
  
3.  <span data-ttu-id="3826e-114">從來源或先前的轉換將連接子拖曳到查閱轉換，以便將查閱轉換連接到資料流程。</span><span class="sxs-lookup"><span data-stu-id="3826e-114">Connect the Lookup transformation to the data flow by dragging a connector from a source or a previous transformation to the Lookup transformation.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3826e-115">設定為使用無快取模式的查閱轉換如果連接到包含空白日期欄位的一般檔案，則查閱轉換可能不會驗證。</span><span class="sxs-lookup"><span data-stu-id="3826e-115">A Lookup transformation that is configured to use the no cache mode might not validate if that transformation connects to a flat file that contains an empty date field.</span></span> <span data-ttu-id="3826e-116">此轉換是否會驗證將取決於一般檔案的連線管理員是否已設定為保留 null 值。</span><span class="sxs-lookup"><span data-stu-id="3826e-116">Whether the transformation validates depends on whether the connection manager for the flat file has been configured to retain null values.</span></span> <span data-ttu-id="3826e-117">若要確保查閱轉換會驗證，請在 **[一般檔案來源編輯器]** 的 **[連線管理員]** 頁面上，選取 **[將來源的 Null 值保留為資料流程中的 Null 值]** 選項。</span><span class="sxs-lookup"><span data-stu-id="3826e-117">To ensure that the Lookup transformation validates, in the **Flat File Source Editor**, on the **Connection Manager Page**, select the **Retain null values from the source as null values in the data flow** option.</span></span>  
  
4.  <span data-ttu-id="3826e-118">按兩下來源或前一個轉換以設定元件。</span><span class="sxs-lookup"><span data-stu-id="3826e-118">Double-click the source or previous transformation to configure the component.</span></span>  
  
5.  <span data-ttu-id="3826e-119">按兩下 [查閱轉換]，然後在 [查閱轉換編輯器]  的 [一般]  頁面上，選取 [部分快取]  或 [無快取]  。</span><span class="sxs-lookup"><span data-stu-id="3826e-119">Double-click the Lookup transformation, and then in the **Lookup Transformation Editor**, on the **General** page, select **Partialcache** or **No cache**.</span></span>  
  
6.  <span data-ttu-id="3826e-120">針對 **[指定如何處理無相符項目的資料列]** 清單，選取清單中的錯誤處理選項。</span><span class="sxs-lookup"><span data-stu-id="3826e-120">For **Specify how to handle rows with no matching entries** list, select an error handling option from the list.</span></span>  
  
7.  <span data-ttu-id="3826e-121">在 **[連接]** 頁面上，從 **[OLE DB 連接管理員]** 清單選取連接管理員，或按一下 **[新增]** 建立新的連接管理員。</span><span class="sxs-lookup"><span data-stu-id="3826e-121">On the **Connection** page, select a connection manager from the **OLE DB connection manager** list or click **New** to create a new connection manager.</span></span> <span data-ttu-id="3826e-122">如需相關資訊，請參閱 [OLE DB Connection Manager](../../connection-manager/ole-db-connection-manager.md)。</span><span class="sxs-lookup"><span data-stu-id="3826e-122">For more information, see [OLE DB Connection Manager](../../connection-manager/ole-db-connection-manager.md).</span></span>  
  
8.  <span data-ttu-id="3826e-123">執行下列其中一個步驟：</span><span class="sxs-lookup"><span data-stu-id="3826e-123">Do one of the following steps:</span></span>  
  
    -   <span data-ttu-id="3826e-124">按一下 **[使用資料表或檢視]** ，然後選取資料表或檢視，或按一下 **[新增]** 建立資料表或檢視。</span><span class="sxs-lookup"><span data-stu-id="3826e-124">Click **Use a table or a view**, and then either select a table or view, or click **New** to create a table or view.</span></span>  
  
    -   <span data-ttu-id="3826e-125">按一下 **[使用 SQL 查詢的結果]** ，然後在 **[SQL 命令]** 視窗中建立查詢。</span><span class="sxs-lookup"><span data-stu-id="3826e-125">Click **Use results of an SQL query**, and then build a query in the **SQL Command** window.</span></span>  
  
         <span data-ttu-id="3826e-126">-或-</span><span class="sxs-lookup"><span data-stu-id="3826e-126">-or-</span></span>  
  
         <span data-ttu-id="3826e-127">按一下 **[建立查詢]** ，即可使用 **[查詢產生器]** 提供的圖形工具建立查詢。</span><span class="sxs-lookup"><span data-stu-id="3826e-127">Click **Build Query** to build a query by using the graphical tools that the **Query Builder** provides.</span></span>  
  
         <span data-ttu-id="3826e-128">-或-</span><span class="sxs-lookup"><span data-stu-id="3826e-128">-or-</span></span>  
  
         <span data-ttu-id="3826e-129">按一下 **[瀏覽]** ，從檔案匯入 SQL 陳述式。</span><span class="sxs-lookup"><span data-stu-id="3826e-129">Click **Browse** to import an SQL statement from a file.</span></span>  
  
     <span data-ttu-id="3826e-130">若要驗證 SQL 查詢，請按一下 **[剖析查詢]** 。</span><span class="sxs-lookup"><span data-stu-id="3826e-130">To validate the SQL query, click **Parse Query**.</span></span>  
  
     <span data-ttu-id="3826e-131">若要檢視資料範例，按一下 **[預覽]** 。</span><span class="sxs-lookup"><span data-stu-id="3826e-131">To view a sample of the data, click **Preview**.</span></span>  
  
9. <span data-ttu-id="3826e-132">按一下 **[資料行]** 頁面，然後從 **[可用的輸入資料行]** 清單，拖曳至少一個資料行至 **[可用的查閱資料行]** 清單中的資料行。</span><span class="sxs-lookup"><span data-stu-id="3826e-132">Click the **Columns** page, and then drag at least one column from the **Available Input Columns** list to a column in the **Available Lookup Column** list.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3826e-133">「查閱」轉換會自動對應具有相同名稱和相同資料類型的資料行。</span><span class="sxs-lookup"><span data-stu-id="3826e-133">The Lookup transformation automatically maps columns that have the same name and the same data type.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3826e-134">資料行必須具有要對應的相符資料類型。</span><span class="sxs-lookup"><span data-stu-id="3826e-134">Columns must have matching data types to be mapped.</span></span> <span data-ttu-id="3826e-135">如需詳細資訊，請參閱 [Integration Services 資料類型](../integration-services-data-types.md)。</span><span class="sxs-lookup"><span data-stu-id="3826e-135">For more information, see [Integration Services Data Types](../integration-services-data-types.md).</span></span>  
  
10. <span data-ttu-id="3826e-136">執行下列步驟，在輸出中包含查閱資料行：</span><span class="sxs-lookup"><span data-stu-id="3826e-136">Include lookup columns in the output by doing the following steps:</span></span>  
  
    1.  <span data-ttu-id="3826e-137">從 **[可用的查閱資料行]** 清單選取資料行。</span><span class="sxs-lookup"><span data-stu-id="3826e-137">From the **Available Lookup Columns** list, select columns.</span></span>  
  
    2.  <span data-ttu-id="3826e-138">在 **[查閱作業]** 清單中，指定查閱資料行的值要取代輸入資料行中的值，還是要寫入至新的資料行。</span><span class="sxs-lookup"><span data-stu-id="3826e-138">In **Lookup Operation** list, specify whether the values from the lookup columns replace values in the input column or are written to a new column.</span></span>  
  
11. <span data-ttu-id="3826e-139">如果在步驟 5 中選取的是 **[部分快取]** ，請在 **[進階]** 頁面上設定下列快取選項：</span><span class="sxs-lookup"><span data-stu-id="3826e-139">If you selected **Partial cache** in step 5, on the **Advanced** page, set the following cache options:</span></span>  
  
    -   <span data-ttu-id="3826e-140">從 [快取大小 (32 位元)]  清單選取 32 位元環境的快取大小。</span><span class="sxs-lookup"><span data-stu-id="3826e-140">From the **Cache size (32-bit)** list, select the cache size for 32-bit environments.</span></span>  
  
    -   <span data-ttu-id="3826e-141">從 [快取大小 (64 位元)]  清單選取 64 位元環境的快取大小。</span><span class="sxs-lookup"><span data-stu-id="3826e-141">From the **Cache size (64-bit)** list, select the cache size for 64-bit environments.</span></span>  
  
    -   <span data-ttu-id="3826e-142">若要快取在參考中沒有相符項目的資料列，請選取 **[針對無相符項目的資料列啟用快取]** 。</span><span class="sxs-lookup"><span data-stu-id="3826e-142">To cache the rows without matching entries in the reference, select **Enable cache for rows with no matching entries**.</span></span>  
  
    -   <span data-ttu-id="3826e-143">從 **[來自快取的配置]** 清單，選取要用來儲存沒有相符項目的資料列的快取百分比。</span><span class="sxs-lookup"><span data-stu-id="3826e-143">From the **Allocation from cache** list, select the percentage of the cache to use to store the rows without matching entries.</span></span>  
  
12. <span data-ttu-id="3826e-144">若要修改產生參考資料集的 SQL 陳述式，選取 **[修改 SQL 陳述式]** ，然後變更顯示在文字方塊中的 SQL 陳述式。</span><span class="sxs-lookup"><span data-stu-id="3826e-144">To modify the SQL statement that generates the reference dataset, select **Modify the SQL statement**, and change the SQL statement displayed in the text box.</span></span>  
  
     <span data-ttu-id="3826e-145">如果陳述式包含參數，請按一下 **[參數]** 以將參數對應至輸入資料行。</span><span class="sxs-lookup"><span data-stu-id="3826e-145">If the statement includes parameters, click **Parameters** to map the parameters to input columns.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3826e-146">在此頁面上所指定的選擇性 SQL 陳述式會覆寫並取代在 [查閱轉換編輯器] 的 [連接] 頁面上所指定的資料表名稱。</span><span class="sxs-lookup"><span data-stu-id="3826e-146">The optional SQL statement that you specify on this page overrides and replaces the table name that you specified on the **Connection** page of the **Lookup Transformation Editor**.</span></span>  
  
13. <span data-ttu-id="3826e-147">若要設定錯誤輸出，按一下 **[錯誤輸出]** 頁面，然後設定錯誤處理選項。</span><span class="sxs-lookup"><span data-stu-id="3826e-147">To configure the error output, click the **Error Output** page and set the error handling options.</span></span> <span data-ttu-id="3826e-148">如需詳細資訊，請參閱[查閱轉換編輯器 &#40;錯誤輸出頁面&#41;](../../lookup-transformation-editor-error-output-page.md)。</span><span class="sxs-lookup"><span data-stu-id="3826e-148">For more information, see [Lookup Transformation Editor &#40;Error Output Page&#41;](../../lookup-transformation-editor-error-output-page.md).</span></span>  
  
14. <span data-ttu-id="3826e-149">按一下 **[確定]** ，將變更儲存至查閱轉換，然後再執行封裝。</span><span class="sxs-lookup"><span data-stu-id="3826e-149">Click **OK** to save your changes to the Lookup transformation, and then run the package.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3826e-150">另請參閱</span><span class="sxs-lookup"><span data-stu-id="3826e-150">See Also</span></span>  
 [<span data-ttu-id="3826e-151">Integration Services 轉換</span><span class="sxs-lookup"><span data-stu-id="3826e-151">Integration Services Transformations</span></span>](integration-services-transformations.md)  
  
  
