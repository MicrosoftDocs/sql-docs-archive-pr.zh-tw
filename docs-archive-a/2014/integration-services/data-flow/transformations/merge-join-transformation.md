---
title: 合併聯結轉換 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.mergejointrans.f1
helpviewer_keywords:
- datasets [Integration Services]
- Merge Join transformation
- datasets [Integration Services], joining
- joining datasets [Integration Services]
- joins [SQL Server], SSIS
ms.assetid: cd8b0412-f83b-4bd2-b227-e53dcfd941a8
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 262fba82293a630e410a8f24f4aec19f6f4423aa
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87707697"
---
# <a name="merge-join-transformation"></a><span data-ttu-id="5dace-102">Merge Join Transformation</span><span class="sxs-lookup"><span data-stu-id="5dace-102">Merge Join Transformation</span></span>
  <span data-ttu-id="5dace-103">合併聯結轉換提供藉由使用 FULL、LEFT 或 INNER 聯結，來聯結兩個已排序資料集所產生的輸出。</span><span class="sxs-lookup"><span data-stu-id="5dace-103">The Merge Join transformation provides an output that is generated by joining two sorted datasets using a FULL, LEFT, or INNER join.</span></span> <span data-ttu-id="5dace-104">例如，您可以使用 LEFT 聯結來聯結包含產品資訊的資料表，以及列出製造產品的國家/地區的資料表。</span><span class="sxs-lookup"><span data-stu-id="5dace-104">For example, you can use a LEFT join to join a table that includes product information with a table that lists the country/region in which a product was manufactured.</span></span> <span data-ttu-id="5dace-105">此結果為列出所有產品及其原產國家/地區的資料表。</span><span class="sxs-lookup"><span data-stu-id="5dace-105">The result is a table that lists all products and their country/region of origin.</span></span>  
  
 <span data-ttu-id="5dace-106">您可以利用下列方式設定「合併聯結」轉換：</span><span class="sxs-lookup"><span data-stu-id="5dace-106">You can configure the Merge Join transformation in the following ways:</span></span>  
  
-   <span data-ttu-id="5dace-107">指定聯結為 FULL、LEFT 或 INNER 聯結。</span><span class="sxs-lookup"><span data-stu-id="5dace-107">Specify the join is a FULL, LEFT, or INNER join.</span></span>  
  
-   <span data-ttu-id="5dace-108">指定聯結使用的資料行。</span><span class="sxs-lookup"><span data-stu-id="5dace-108">Specify the columns the join uses.</span></span>  
  
-   <span data-ttu-id="5dace-109">指定轉換是否要將 Null 值當作相當於其他 Null 處理。</span><span class="sxs-lookup"><span data-stu-id="5dace-109">Specify whether the transformation handles null values as equal to other nulls.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="5dace-110">如果 Null 值未當成相等值，則轉換會以與 SQL Server Database Engine 相同的方式處理 Null 值。</span><span class="sxs-lookup"><span data-stu-id="5dace-110">If null values are not treated as equal values, the transformation handles null values like the SQL Server Database Engine does.</span></span>  
  
 <span data-ttu-id="5dace-111">這個轉換有兩個輸入與一個輸出。</span><span class="sxs-lookup"><span data-stu-id="5dace-111">This transformation has two inputs and one output.</span></span> <span data-ttu-id="5dace-112">它不支援錯誤輸出。</span><span class="sxs-lookup"><span data-stu-id="5dace-112">It does not support an error output.</span></span>  
  
## <a name="input-requirements"></a><span data-ttu-id="5dace-113">輸入需求</span><span class="sxs-lookup"><span data-stu-id="5dace-113">Input Requirements</span></span>  
 <span data-ttu-id="5dace-114">合併聯結轉換針對其輸入需要已排序的資料。</span><span class="sxs-lookup"><span data-stu-id="5dace-114">The Merge Join Transformation requires sorted data for its inputs.</span></span> <span data-ttu-id="5dace-115">如需這項重要需求的詳細資訊，請參閱 [排序合併和合併聯結轉換的資料](sort-data-for-the-merge-and-merge-join-transformations.md)。</span><span class="sxs-lookup"><span data-stu-id="5dace-115">For more information about this important requirement, see [Sort Data for the Merge and Merge Join Transformations](sort-data-for-the-merge-and-merge-join-transformations.md).</span></span>  
  
## <a name="join-requirements"></a><span data-ttu-id="5dace-116">聯結需求</span><span class="sxs-lookup"><span data-stu-id="5dace-116">Join Requirements</span></span>  
 <span data-ttu-id="5dace-117">合併聯結轉換會要求聯結的資料行擁有相符的中繼資料。</span><span class="sxs-lookup"><span data-stu-id="5dace-117">The Merge Join transformation requires that the joined columns have matching metadata.</span></span> <span data-ttu-id="5dace-118">例如，您無法聯結數值資料類型的資料行，與字元資料類型的資料行。</span><span class="sxs-lookup"><span data-stu-id="5dace-118">For example, you cannot join a column that has a numeric data type with a column that has a character data type.</span></span> <span data-ttu-id="5dace-119">如果資料是字串資料類型，第二個輸入中的資料行長度就必須小於或等於與其合併之第一個輸入中的資料行長度。</span><span class="sxs-lookup"><span data-stu-id="5dace-119">If the data has a string data type, the length of the column in the second input must be less than or equal to the length of the column in the first input with which it is merged.</span></span>  
  
## <a name="buffer-throttling"></a><span data-ttu-id="5dace-120">緩衝區調整</span><span class="sxs-lookup"><span data-stu-id="5dace-120">Buffer Throttling</span></span>  
 <span data-ttu-id="5dace-121">您再也不必設定 `MaxBuffersPerInput` 屬性的值，因為 Microsoft 已做出變更，降低合併聯結轉換會耗用過多記憶體的風險。</span><span class="sxs-lookup"><span data-stu-id="5dace-121">You no longer have to configure the value of the `MaxBuffersPerInput` property because Microsoft has made changes that reduce the risk that the Merge Join transformation will consume excessive memory.</span></span> <span data-ttu-id="5dace-122">這個問題有時候會發生在合併聯結的多個輸入以不平均的速率產生資料時。</span><span class="sxs-lookup"><span data-stu-id="5dace-122">This problem sometimes occurred when the multiple inputs of the Merge Join produced data at uneven rates.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="5dace-123">相關工作</span><span class="sxs-lookup"><span data-stu-id="5dace-123">Related Tasks</span></span>  
 <span data-ttu-id="5dace-124">您可以透過「 [!INCLUDE[ssIS](../../../includes/ssis-md.md)] 設計師」或以程式設計方式設定屬性。</span><span class="sxs-lookup"><span data-stu-id="5dace-124">You can set properties through the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer or programmatically.</span></span>  
  
 <span data-ttu-id="5dace-125">如需有關如何設定此轉換屬性的詳細資訊，請按下列其中一個主題：</span><span class="sxs-lookup"><span data-stu-id="5dace-125">For information about how to set properties of this transformation, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="5dace-126">使用合併聯結轉換來擴充資料集</span><span class="sxs-lookup"><span data-stu-id="5dace-126">Extend a Dataset by Using the Merge Join Transformation</span></span>](merge-join-transformation.md)  
  
-   [<span data-ttu-id="5dace-127">設定資料流程元件的屬性</span><span class="sxs-lookup"><span data-stu-id="5dace-127">Set the Properties of a Data Flow Component</span></span>](../set-the-properties-of-a-data-flow-component.md)  
  
-   [<span data-ttu-id="5dace-128">排序合併和合併聯結轉換的資料</span><span class="sxs-lookup"><span data-stu-id="5dace-128">Sort Data for the Merge and Merge Join Transformations</span></span>](sort-data-for-the-merge-and-merge-join-transformations.md)  
  
## <a name="see-also"></a><span data-ttu-id="5dace-129">另請參閱</span><span class="sxs-lookup"><span data-stu-id="5dace-129">See Also</span></span>  
 <span data-ttu-id="5dace-130">[合併聯結轉換編輯器](../../merge-join-transformation-editor.md) </span><span class="sxs-lookup"><span data-stu-id="5dace-130">[Merge Join Transformation Editor](../../merge-join-transformation-editor.md) </span></span>  
 <span data-ttu-id="5dace-131">[合併轉換](merge-transformation.md) </span><span class="sxs-lookup"><span data-stu-id="5dace-131">[Merge Transformation](merge-transformation.md) </span></span>  
 <span data-ttu-id="5dace-132">[聯集全部轉換](union-all-transformation.md) </span><span class="sxs-lookup"><span data-stu-id="5dace-132">[Union All Transformation](union-all-transformation.md) </span></span>  
 [<span data-ttu-id="5dace-133">Integration Services 轉換</span><span class="sxs-lookup"><span data-stu-id="5dace-133">Integration Services Transformations</span></span>](integration-services-transformations.md)  
  
  
