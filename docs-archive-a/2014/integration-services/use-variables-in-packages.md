---
title: 在封裝中使用變數 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- user-defined variables [Integration Services]
- variables [Integration Services], use scenarios
- system variables [Integration Services]
ms.assetid: 7742e92d-46c5-4cc4-b9a3-45b688ddb787
author: chugugrace
ms.author: chugu
ms.openlocfilehash: acfb6813406bd3a143712e40ec510a4658d4e5da
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87592740"
---
# <a name="use-variables-in-packages"></a><span data-ttu-id="cba80-102">在封裝中使用變數</span><span class="sxs-lookup"><span data-stu-id="cba80-102">Use Variables in Packages</span></span>
  <span data-ttu-id="cba80-103">變數是 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 封裝之有用的彈性附加項目，可提供在封裝的物件間和父子封裝之間的通訊。</span><span class="sxs-lookup"><span data-stu-id="cba80-103">Variables are a useful and flexible addition to [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] packages; they can provide communication among objects in the package, and between parent and child packages.</span></span> <span data-ttu-id="cba80-104">變數還可用於運算式和指令碼。</span><span class="sxs-lookup"><span data-stu-id="cba80-104">Variables can also be used in expressions and scripts.</span></span>  
  
## <a name="user-defined-variables-and-system-variables"></a><span data-ttu-id="cba80-105">使用者自訂變數和系統變數</span><span class="sxs-lookup"><span data-stu-id="cba80-105">User-Defined Variables and System Variables</span></span>  
 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] <span data-ttu-id="cba80-106">提供系統變數，並支援使用者自訂變數。</span><span class="sxs-lookup"><span data-stu-id="cba80-106">provides system variables and supports user-defined variables.</span></span> <span data-ttu-id="cba80-107">建立新封裝時，會將容器或工作加入封裝，或建立事件處理常式， [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 包括容器的系統變數集。</span><span class="sxs-lookup"><span data-stu-id="cba80-107">When you create a new package, add a container or a task to a package, or create an event handler, [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] includes a set of system variables for the container.</span></span> <span data-ttu-id="cba80-108">系統變數包含關於封裝、容器、工作或事件處理常式的有用資訊。</span><span class="sxs-lookup"><span data-stu-id="cba80-108">System variables contain useful information about a package, container, task, or event handler.</span></span> <span data-ttu-id="cba80-109">例如，在執行階段， **MachineName** 系統變數包含在其上執行封裝的電腦名稱和封裝執行開始時間 **StartTime** 。</span><span class="sxs-lookup"><span data-stu-id="cba80-109">For example, at run time the **MachineName** system variable contains the name of the computer on which the package is running and **StartTime** the time the package started to run.</span></span> <span data-ttu-id="cba80-110">系統變數是唯讀的。</span><span class="sxs-lookup"><span data-stu-id="cba80-110">System variables are read-only.</span></span> <span data-ttu-id="cba80-111">如需詳細資訊，請參閱 [系統變數](system-variables.md)。</span><span class="sxs-lookup"><span data-stu-id="cba80-111">For more information, see [System Variables](system-variables.md).</span></span>  
  
 <span data-ttu-id="cba80-112">您可以建立使用者自訂變數，然後將其用於封裝。</span><span class="sxs-lookup"><span data-stu-id="cba80-112">You can create user-defined variables and then use them in packages.</span></span> <span data-ttu-id="cba80-113">在 [!INCLUDE[ssIS](../includes/ssis-md.md)]中可以多種方式使用使用者自訂變數：在指令碼中、在優先順序條件約束、「For 迴圈」容器、「衍生的資料行」轉換和「條件式分割」轉換所使用的運算式中，以及在更新屬性值的屬性運算式中。</span><span class="sxs-lookup"><span data-stu-id="cba80-113">User-defined variables can be used in many ways in [!INCLUDE[ssIS](../includes/ssis-md.md)]: in scripts; in the expressions used by precedence constraints, the For Loop container, the Derived Column transformation, and the Conditional Split transformation; and in the property expressions that update property values.</span></span>  
  
 <span data-ttu-id="cba80-114">例如，您可以在「For 迴圈」容器的評估條件中，使用使用者自訂變數。</span><span class="sxs-lookup"><span data-stu-id="cba80-114">For example, you can use a user-defined variable in the evaluation condition for the For Loop container.</span></span> <span data-ttu-id="cba80-115">您還可以將「Foreach 迴圈」容器中的列舉值集合值對應至變數，如果「執行 SQL」工作使用參數化 SQL 陳述式，則可將陳述式的參數對應到變數。</span><span class="sxs-lookup"><span data-stu-id="cba80-115">You can also map the enumerator collection value in a Foreach Loop container to a variable, and if an Execute SQL task uses a parameterized SQL statement, you can map the parameters for the statement to variables.</span></span> <span data-ttu-id="cba80-116">如需詳細資訊，請參閱 [Integration Services &#40;SSIS&#41; 變數](integration-services-ssis-variables.md)。</span><span class="sxs-lookup"><span data-stu-id="cba80-116">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md).</span></span>  
  
## <a name="variables-usage-scenarios"></a><span data-ttu-id="cba80-117">變數使用方式案例</span><span class="sxs-lookup"><span data-stu-id="cba80-117">Variables Usage Scenarios</span></span>  
 <span data-ttu-id="cba80-118">變數在 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 封裝中有許多不同的使用方式。</span><span class="sxs-lookup"><span data-stu-id="cba80-118">Variables are used in many different ways in [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] packages.</span></span> <span data-ttu-id="cba80-119">在您將使用者自訂變數新增至封裝，實作方案所需的彈性和可管理性之前，您可能會覺得封裝開發沒有太多的進展。</span><span class="sxs-lookup"><span data-stu-id="cba80-119">You will probably find that package development does not progress far before you have to add a user-defined variable to your package to implement the flexibility and manageability your solution requires.</span></span> <span data-ttu-id="cba80-120">視案例而定，也常會使用系統變數。</span><span class="sxs-lookup"><span data-stu-id="cba80-120">Depending on the scenario, system variables are also commonly used.</span></span>  
  
 <span data-ttu-id="cba80-121">**屬性運算式** ：使用變數在設定封裝和封裝物件屬性的屬性運算式中提供值。</span><span class="sxs-lookup"><span data-stu-id="cba80-121">**Property Expressions** Use variables to provide values in the property expressions that set the properties of packages and package objects.</span></span> <span data-ttu-id="cba80-122">例如， `SELECT * FROM @varTableName` 運算式會包含更新「執行 SQL」工作所執行之 SQL 陳述式的 `varTableName` 變數。</span><span class="sxs-lookup"><span data-stu-id="cba80-122">For example, the expression, `SELECT * FROM @varTableName` includes the variable `varTableName` that updates the SQL statement that an Execute SQL task runs.</span></span> <span data-ttu-id="cba80-123">`DATEPART("d", GETDATE()) == 1? @[User::varPackageFirst]:@[User::varPackageOther]`" 運算式會在該月的第一天執行 `varPackageFirst` 變數中指定的封裝，並在其他日子執行 `varPackageOther` 變數中指定的封裝，來更新「執行封裝」工作所執行的封裝。</span><span class="sxs-lookup"><span data-stu-id="cba80-123">The expression, `DATEPART("d", GETDATE()) == 1? @[User::varPackageFirst]:@[User::varPackageOther]`", updates the package that the Execute Package task runs, by running the package specified in the `varPackageFirst` variable on the first day of the month and running the package specified in the `varPackageOther` variable on other days.</span></span> <span data-ttu-id="cba80-124">如需詳細資訊，請參閱 [在封裝中使用屬性運算式](expressions/use-property-expressions-in-packages.md)。</span><span class="sxs-lookup"><span data-stu-id="cba80-124">For more information, see [Use Property Expressions in Packages](expressions/use-property-expressions-in-packages.md).</span></span>  
  
 <span data-ttu-id="cba80-125">**資料流程運算式** ：使用變數在運算式中提供值，「衍生的資料行」和「條件式分割」轉換會使用這些運算式擴展資料行，或將資料列導向不同的轉換輸出。</span><span class="sxs-lookup"><span data-stu-id="cba80-125">**Data Flow Expressions** Use variables to provide values in the expressions that the Derived Column and Conditional Split transformations use to populate columns, or to direct data rows to different transformation outputs.</span></span> <span data-ttu-id="cba80-126">例如， `@varSalutation + LastName`運算式會串連 `VarSalutation` 變數和 `LastName` 資料行中的值。</span><span class="sxs-lookup"><span data-stu-id="cba80-126">For example, the expression, `@varSalutation + LastName`, concatenates the value in the `VarSalutation` variable and the `LastName` column.</span></span> <span data-ttu-id="cba80-127">`Income < @HighIncome` 運算式會將 `Income` 資料行中、值小於 `HighIncome` 變數中的值的資料列導向輸出。</span><span class="sxs-lookup"><span data-stu-id="cba80-127">The expression, `Income < @HighIncome`, directs data rows in which the value of the `Income` column is less than the value in the `HighIncome` variable to an output.</span></span> <span data-ttu-id="cba80-128">如需詳細資訊，請參閱[衍生的資料行轉換](data-flow/transformations/derived-column-transformation.md)、[條件式分割轉換](data-flow/transformations/conditional-split-transformation.md) 和 [Integration Services &#40;SSIS&#41; 運算式](expressions/integration-services-ssis-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="cba80-128">For more information, see [Derived Column Transformation](data-flow/transformations/derived-column-transformation.md), [Conditional Split Transformation](data-flow/transformations/conditional-split-transformation.md), and [Integration Services &#40;SSIS&#41; Expressions](expressions/integration-services-ssis-expressions.md).</span></span>  
  
 <span data-ttu-id="cba80-129">**優先順序條件約束運算式**：提供要在優先順序條件約中使用的值，決定受條件約束的可執行檔是否執行。</span><span class="sxs-lookup"><span data-stu-id="cba80-129">**Precedence Constraint Expressions** Provide values to use in precedence constraints to determine whether a constrained executable runs.</span></span> <span data-ttu-id="cba80-130">這些運算式可以和執行結果 (成功、失敗、完成) 一起使用，或取代執行結果。</span><span class="sxs-lookup"><span data-stu-id="cba80-130">The expressions can be used either together with an execution outcome (success, failure, completion), or instead of an execution outcome.</span></span> <span data-ttu-id="cba80-131">例如，如果 `@varMax > @varMin` 運算式評估為 `true`，可執行檔就會執行。</span><span class="sxs-lookup"><span data-stu-id="cba80-131">For example, if the expression, `@varMax > @varMin`, evaluates to `true`, the executable runs.</span></span> <span data-ttu-id="cba80-132">如需詳細資訊，請參閱 [將運算式加入優先順序條件約束](control-flow/precedence-constraints.md)。</span><span class="sxs-lookup"><span data-stu-id="cba80-132">For more information, see [Add Expressions to Precedence Constraints](control-flow/precedence-constraints.md).</span></span>  
  
 <span data-ttu-id="cba80-133">**參數和傳回碼** ：提供值給輸入參數，或儲存輸出參數和傳回碼的值。</span><span class="sxs-lookup"><span data-stu-id="cba80-133">**Parameters and Return Codes** Provide values to input parameters, or store the values of output parameters and return codes.</span></span> <span data-ttu-id="cba80-134">您可以將變數對應到參數和傳回值來完成這個動作。</span><span class="sxs-lookup"><span data-stu-id="cba80-134">You do this by mapping the variables to parameters and return values.</span></span> <span data-ttu-id="cba80-135">例如，如果您將 `varProductId` 變數設為 23 並執行 `SELECT * from Production.Product WHERE ProductID = ?`SQL 陳述式，查詢就會擷取 `ProductID` 為 23 的產品。</span><span class="sxs-lookup"><span data-stu-id="cba80-135">For example, if you set the variable `varProductId` to 23 and run the SQL statement, `SELECT * from Production.Product WHERE ProductID = ?`, the query retrieves the product with a `ProductID` of 23.</span></span> <span data-ttu-id="cba80-136">如需詳細資訊，請參閱 [執行 SQL 工作](control-flow/execute-sql-task.md) 和 [執行 SQL 工作中的參數和傳回碼](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md)。</span><span class="sxs-lookup"><span data-stu-id="cba80-136">For more information, see [Execute SQL Task](control-flow/execute-sql-task.md) and [Parameters and Return Codes in the Execute SQL Task](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md).</span></span>  
  
 <span data-ttu-id="cba80-137">**For 迴圈運算式** ：提供要在「For 迴圈」的初始化、評估和指派運算式中使用的值。</span><span class="sxs-lookup"><span data-stu-id="cba80-137">**For Loop Expressions** Provide values to use in the initialization, evaluation, and assignment expressions of the For Loop.</span></span> <span data-ttu-id="cba80-138">例如，如果 `varCount` 變數為 2 且 `varMaxCount` 為 10，初始化運算式為 `@varCount`，評估運算式為  `@varCount < @varMaxCount`且指派運算式為 `@varCount =@varCount +1`，則迴圈就會重複 8 次。</span><span class="sxs-lookup"><span data-stu-id="cba80-138">For example, if the variable `varCount` is 2 and `varMaxCount` is 10, the initialization expression is `@varCount`, the evaluation expression is  `@varCount < @varMaxCount`, and the assignment expression is `@varCount =@varCount +1`, then the loop repeats 8 times.</span></span> <span data-ttu-id="cba80-139">如需詳細資訊，請參閱 [For 迴圈容器](control-flow/for-loop-container.md)為止。</span><span class="sxs-lookup"><span data-stu-id="cba80-139">For more information, see [For Loop Container](control-flow/for-loop-container.md).</span></span>  
  
 <span data-ttu-id="cba80-140">**父封裝變數組態** ：將值從父封裝傳遞到子封裝。</span><span class="sxs-lookup"><span data-stu-id="cba80-140">**Parent Package Variable Configurations** Pass values from parent packages to child packages.</span></span> <span data-ttu-id="cba80-141">子封裝可以使用父封裝變數組態存取父封裝中的變數。</span><span class="sxs-lookup"><span data-stu-id="cba80-141">Child packages can access variables in the parent package by using parent package variable configurations.</span></span> <span data-ttu-id="cba80-142">例如，如果子封裝必須使用和父封裝相同的日期，子封裝就可以定義父封裝變數組態，指定由父封裝中之 GETDATE 函數設定的變數。</span><span class="sxs-lookup"><span data-stu-id="cba80-142">For example, if the child package must use the same date as the parent package, the child package can define a parent package variable configuration that specifies a variable set by the GETDATE function in the parent package.</span></span> <span data-ttu-id="cba80-143">如需詳細資訊，請參閱 [執行封裝工作](control-flow/execute-package-task.md) 和 [封裝組態](../../2014/integration-services/package-configurations.md)。</span><span class="sxs-lookup"><span data-stu-id="cba80-143">For more information, see [Execute Package Task](control-flow/execute-package-task.md) and [Package Configurations](../../2014/integration-services/package-configurations.md).</span></span>  
  
 <span data-ttu-id="cba80-144">**指令碼工作和指令碼元件** ：提供唯讀和讀取/寫入變數的清單到「指令碼」工作或「指令碼」元件、更新指令碼中的讀取/寫入變數，然後在指令碼內或指令碼外使用更新的值。</span><span class="sxs-lookup"><span data-stu-id="cba80-144">**Script Task and Script Component** Provide a list of read-only and read/write variable to the Script task or Script component, update the read/write variables within the script, and then use the updated values in or outside the script.</span></span> <span data-ttu-id="cba80-145">例如，在程式碼 `numberOfCars = CType(Dts.Variables("NumberOfCars").Value, Integer)`中，指令碼變數 `numberOfCars` 會由變數 `NumberOfCars`中的值更新。</span><span class="sxs-lookup"><span data-stu-id="cba80-145">For example, in the code, `numberOfCars = CType(Dts.Variables("NumberOfCars").Value, Integer)`, the script variable `numberOfCars` is updated by the value in the variable, `NumberOfCars`.</span></span> <span data-ttu-id="cba80-146">如需詳細資訊，請參閱 [在指令碼工作中使用變數](control-flow/script-task.md)。</span><span class="sxs-lookup"><span data-stu-id="cba80-146">For more information, see [Using Variables in the Script Task](control-flow/script-task.md).</span></span>  
  
## <a name="configurations-and-variables"></a><span data-ttu-id="cba80-147">組態和變數</span><span class="sxs-lookup"><span data-stu-id="cba80-147">Configurations and Variables</span></span>  
 <span data-ttu-id="cba80-148">若要動態地更新變數，您可以建立變數的組態，使用封裝部署組態，然後在部署封裝時更新組態檔中的變數值。</span><span class="sxs-lookup"><span data-stu-id="cba80-148">To dynamically update variables, you can create configurations for the variables, deploy the configurations with the package, and then update the variable values in the configuration file when you deploy the packages.</span></span> <span data-ttu-id="cba80-149">在執行階段，封裝會使用更新的變數值。</span><span class="sxs-lookup"><span data-stu-id="cba80-149">At run time, the package uses the updated variable values.</span></span> <span data-ttu-id="cba80-150">如需詳細資訊，請參閱 [建立封裝組態](../../2014/integration-services/create-package-configurations.md)。</span><span class="sxs-lookup"><span data-stu-id="cba80-150">For more information, see [Create Package Configurations](../../2014/integration-services/create-package-configurations.md).</span></span>  
  
### <a name="to-add-modify-and-delete-user-defined-variables"></a><span data-ttu-id="cba80-151">若要加入、修改和刪除使用者自訂變數</span><span class="sxs-lookup"><span data-stu-id="cba80-151">To add, modify, and delete user-defined variables</span></span>  
  
-   [<span data-ttu-id="cba80-152">加入、刪除、變更封裝中使用者定義變數的範圍</span><span class="sxs-lookup"><span data-stu-id="cba80-152">Add, Delete, Change Scope of User-Defined Variable in a Package</span></span>](../../2014/integration-services/add-delete-change-scope-of-user-defined-variable-in-a-package.md)  
  
-   [<span data-ttu-id="cba80-153">設定使用者定義變數的屬性</span><span class="sxs-lookup"><span data-stu-id="cba80-153">Set the Properties of a User-Defined Variable</span></span>](../../2014/integration-services/set-the-properties-of-a-user-defined-variable.md)  
  
  
