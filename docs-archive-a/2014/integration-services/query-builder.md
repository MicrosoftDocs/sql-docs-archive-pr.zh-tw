---
title: 查詢產生器 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.querybuilder.f1
helpviewer_keywords:
- Query Builder dialog box
ms.assetid: 780752c9-6e3c-4f44-aaff-4f4d5e5a45c5
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 81be066d92ef1e19a141414dad4359b60efca2f9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87688005"
---
# <a name="query-builder"></a><span data-ttu-id="8df79-102">查詢產生器</span><span class="sxs-lookup"><span data-stu-id="8df79-102">Query Builder</span></span>
  <span data-ttu-id="8df79-103">使用 **[查詢產生器]** 對話方塊，即可建立要在執行 SQL 工作中使用的查詢、OLE DB 來源和 OLE DB 目的地，以及查閱轉換。</span><span class="sxs-lookup"><span data-stu-id="8df79-103">Use the **Query Builder** dialog box to create a query for use in the Execute SQL task, the OLE DB source and the OLE DB destination, and the Lookup transformation.</span></span>  
  
 <span data-ttu-id="8df79-104">您可以使用「查詢產生器」執行下列工作：</span><span class="sxs-lookup"><span data-stu-id="8df79-104">You can use Query Builder to perform the following tasks:</span></span>  
  
-   <span data-ttu-id="8df79-105">**使用查詢的圖形表示法或使用 SQL 命令** ：「查詢產生器」包含以圖形方式顯示查詢的窗格，以及顯示查詢之 SQL 文字的窗格。</span><span class="sxs-lookup"><span data-stu-id="8df79-105">**Working with a graphical representation of a query or with SQL commands** Query Builder includes a pane that displays your query graphically and a pane that displays the SQL text of your query.</span></span> <span data-ttu-id="8df79-106">您可使用圖形窗格或文字窗格。</span><span class="sxs-lookup"><span data-stu-id="8df79-106">You can work in either the graphical pane or the text pane.</span></span> <span data-ttu-id="8df79-107">「查詢產生器」會同步檢視，讓它們始終保持最新狀態。</span><span class="sxs-lookup"><span data-stu-id="8df79-107">Query Builder synchronizes the views so that they are always current.</span></span>  
  
-   <span data-ttu-id="8df79-108">**聯結相關的資料表** ：如果您將一個以上的資料表新增到查詢中，「查詢產生器」會自動決定如何與資料表產生關聯，並建構適當的聯結命令。</span><span class="sxs-lookup"><span data-stu-id="8df79-108">**Joining related tables** If you add more than one table to your query, Query Builder automatically determines how the tables are related and constructs the appropriate join command.</span></span>  
  
-   <span data-ttu-id="8df79-109">**查詢或更新資料庫** ：您可以使用查詢產生器，藉由使用 Transact-SQL SELECT 陳述式傳回資料，並建立更新、新增或刪除資料庫中記錄的查詢。</span><span class="sxs-lookup"><span data-stu-id="8df79-109">**Querying or updating databases** You can use Query Builder to return data by using Transact-SQL SELECT statements and to create queries that update, add, or delete records in a database.</span></span>  
  
-   <span data-ttu-id="8df79-110">**立即檢視並編輯結果** ：您可以執行您的查詢並使用方格 (您可以捲動並編輯資料庫中的記錄) 中的資料錄集。</span><span class="sxs-lookup"><span data-stu-id="8df79-110">**Viewing and editing results immediately** You can run your query and work with a recordset in a grid that allows you to scroll through and edit records in the database.</span></span>  
  
 <span data-ttu-id="8df79-111">[查詢產生器]\*\*\*\* 對話方塊中的圖形工具，可以讓您使用拖放作業建構查詢。</span><span class="sxs-lookup"><span data-stu-id="8df79-111">The graphical tools in the **Query Builder** dialog box let you construct queries using drag-and-drop operations.</span></span> <span data-ttu-id="8df79-112">依預設，[查詢產生器] 對話方塊會建構 SELECT 查詢，不過您也可以建立 INSERT、UPDATE 或 DELETE 查詢。</span><span class="sxs-lookup"><span data-stu-id="8df79-112">By default, the Query Builder dialog box constructs SELECT queries, but you can also build INSERT, UPDATE, or DELETE queries.</span></span> <span data-ttu-id="8df79-113">在 **[查詢產生器]** 對話方塊中，可以剖析和執行所有類型的 SQL 陳述式。</span><span class="sxs-lookup"><span data-stu-id="8df79-113">All types of SQL statements can be parsed and run in the **Query Builder** dialog box.</span></span> <span data-ttu-id="8df79-114">如需封裝中 SQL 陳述式的詳細資訊，請參閱 [Integration Services &#40;SSIS&#41; 查詢](integration-services-ssis-queries.md)。</span><span class="sxs-lookup"><span data-stu-id="8df79-114">For more information about SQL statements in packages, see [Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md).</span></span>  
  
 <span data-ttu-id="8df79-115">若要深入了解 Transact-SQL 語言及其語法，請參閱 [Transact-SQL 參考 &#40;資料庫引擎&#41;](/sql/t-sql/language-reference)。</span><span class="sxs-lookup"><span data-stu-id="8df79-115">To learn more about the Transact-SQL language and its syntax, see [Transact-SQL Reference &#40;Database Engine&#41;](/sql/t-sql/language-reference).</span></span>  
  
 <span data-ttu-id="8df79-116">您也可以在查詢中使用變數以提供值給輸入參數、擷取輸出參數的值以及儲存傳回碼。</span><span class="sxs-lookup"><span data-stu-id="8df79-116">You can also use variables in a query to provide values to an input parameter, to capture values of output parameters, and to store return codes.</span></span> <span data-ttu-id="8df79-117">若要深入了解如何在套件所用的查詢中使用變數，請參閱[執行 SQL 工作](control-flow/execute-sql-task.md)、[OLE DB 來源](data-flow/ole-db-source.md)和 [Integration Services &#40;SSIS&#41; 查詢](integration-services-ssis-queries.md)。</span><span class="sxs-lookup"><span data-stu-id="8df79-117">To learn more about using variables in the queries that packages use, see [Execute SQL Task](control-flow/execute-sql-task.md), [OLE DB Source](data-flow/ole-db-source.md), and [Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md).</span></span> <span data-ttu-id="8df79-118">若要深入了解如何在執行 SQL 工作中使用變數，請參閱 [執行 SQL 工作中的參數和傳回碼](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md) 和 [執行 SQL 工作中的結果集](../../2014/integration-services/result-sets-in-the-execute-sql-task.md)。</span><span class="sxs-lookup"><span data-stu-id="8df79-118">To learn more about using variables in the Execute SQL Task, see [Parameters and Return Codes in the Execute SQL Task](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md) and [Result Sets in the Execute SQL Task](../../2014/integration-services/result-sets-in-the-execute-sql-task.md).</span></span>  
  
 <span data-ttu-id="8df79-119">「查閱」和「模糊」查閱轉換也可以使用具有參數和傳回碼的變數。</span><span class="sxs-lookup"><span data-stu-id="8df79-119">The Lookup and Fuzzy lookup transformations can also use variables with parameters and return codes.</span></span> <span data-ttu-id="8df79-120">OLE DB 來源的相關資訊也適用於這兩個轉換。</span><span class="sxs-lookup"><span data-stu-id="8df79-120">The information about the OLE DB source applies to these two transformations also.</span></span>  
  
## <a name="options"></a><span data-ttu-id="8df79-121">選項</span><span class="sxs-lookup"><span data-stu-id="8df79-121">Options</span></span>  
 <span data-ttu-id="8df79-122">**工具列**</span><span class="sxs-lookup"><span data-stu-id="8df79-122">**Toolbar**</span></span>  
 <span data-ttu-id="8df79-123">使用工具列來管理資料集、選取要顯示的窗格，以及控制查詢功能。</span><span class="sxs-lookup"><span data-stu-id="8df79-123">Use the toolbar to manage datasets, select panes to display, and control query functions.</span></span>  
  
|<span data-ttu-id="8df79-124">值</span><span class="sxs-lookup"><span data-stu-id="8df79-124">Value</span></span>|<span data-ttu-id="8df79-125">描述</span><span class="sxs-lookup"><span data-stu-id="8df79-125">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="8df79-126">**顯示/隱藏圖表窗格**</span><span class="sxs-lookup"><span data-stu-id="8df79-126">**Show/Hide Diagram Pane**</span></span>|<span data-ttu-id="8df79-127">顯示或隱藏 **[圖表]** 窗格。</span><span class="sxs-lookup"><span data-stu-id="8df79-127">Shows or hides the **Diagram** pane.</span></span>|  
|<span data-ttu-id="8df79-128">**顯示/隱藏方格窗格**</span><span class="sxs-lookup"><span data-stu-id="8df79-128">**Show/Hide Grid Pane**</span></span>|<span data-ttu-id="8df79-129">顯示或隱藏 **[方格]** 窗格。</span><span class="sxs-lookup"><span data-stu-id="8df79-129">Shows or hides the **Grid** pane.</span></span>|  
|<span data-ttu-id="8df79-130">**顯示/隱藏 SQL 窗格**</span><span class="sxs-lookup"><span data-stu-id="8df79-130">**Show/Hide SQL Pane**</span></span>|<span data-ttu-id="8df79-131">顯示或隱藏 [ **SQL** ] 窗格。</span><span class="sxs-lookup"><span data-stu-id="8df79-131">Shows or hides the **SQL** pane.</span></span>|  
|<span data-ttu-id="8df79-132">**顯示/隱藏結果窗格**</span><span class="sxs-lookup"><span data-stu-id="8df79-132">**Show/Hide Results Pane**</span></span>|<span data-ttu-id="8df79-133">顯示或隱藏 **[結果]** 窗格。</span><span class="sxs-lookup"><span data-stu-id="8df79-133">Shows or hides the **Results** pane.</span></span>|  
|<span data-ttu-id="8df79-134">**執行**</span><span class="sxs-lookup"><span data-stu-id="8df79-134">**Run**</span></span>|<span data-ttu-id="8df79-135">執行查詢。</span><span class="sxs-lookup"><span data-stu-id="8df79-135">Runs the query.</span></span> <span data-ttu-id="8df79-136">結果會顯示在結果窗格中。</span><span class="sxs-lookup"><span data-stu-id="8df79-136">Results are displayed in the result pane.</span></span>|  
|<span data-ttu-id="8df79-137">**確認 SQL**</span><span class="sxs-lookup"><span data-stu-id="8df79-137">**Verify SQL**</span></span>|<span data-ttu-id="8df79-138">確認 SQL 陳述式有效。</span><span class="sxs-lookup"><span data-stu-id="8df79-138">Verifies that the SQL statement is valid.</span></span>|  
|<span data-ttu-id="8df79-139">**昇冪**</span><span class="sxs-lookup"><span data-stu-id="8df79-139">**Sort Ascending**</span></span>|<span data-ttu-id="8df79-140">在方格窗格中之選取的資料行上，依遞增順序排序輸出資料列。</span><span class="sxs-lookup"><span data-stu-id="8df79-140">Sorts output rows on the selected column in the grid pane, in ascending order.</span></span>|  
|<span data-ttu-id="8df79-141">**遞減排序**</span><span class="sxs-lookup"><span data-stu-id="8df79-141">**Sort Descending**</span></span>|<span data-ttu-id="8df79-142">在方格窗格中之選取的資料行上，依遞減順序排序輸出資料列。</span><span class="sxs-lookup"><span data-stu-id="8df79-142">Sorts output rows on the selected column in the grid pane, in descending order.</span></span>|  
|<span data-ttu-id="8df79-143">**移除篩選**</span><span class="sxs-lookup"><span data-stu-id="8df79-143">**Remove Filter**</span></span>|<span data-ttu-id="8df79-144">選取方格窗格中的某資料行名稱，然後按一下 **[移除篩選]** ，即可移除該資料行的排序準則。</span><span class="sxs-lookup"><span data-stu-id="8df79-144">Select a column name in the grid pane, and then click **Remove Filter** to remove sort criteria for the column.</span></span>|  
|<span data-ttu-id="8df79-145">**使用群組依據**</span><span class="sxs-lookup"><span data-stu-id="8df79-145">**Use Group By**</span></span>|<span data-ttu-id="8df79-146">將 GROUP BY 功能加入至查詢。</span><span class="sxs-lookup"><span data-stu-id="8df79-146">Adds GROUP BY functionality to the query.</span></span>|  
|<span data-ttu-id="8df79-147">**加入資料表**</span><span class="sxs-lookup"><span data-stu-id="8df79-147">**Add Table**</span></span>|<span data-ttu-id="8df79-148">將新的資料表加入至查詢。</span><span class="sxs-lookup"><span data-stu-id="8df79-148">Adds a new table to the query.</span></span>|  
  
 <span data-ttu-id="8df79-149">**查詢定義**</span><span class="sxs-lookup"><span data-stu-id="8df79-149">**Query Definition**</span></span>  
 <span data-ttu-id="8df79-150">查詢定義會提供可在其中定義和測試查詢的工具列和窗格。</span><span class="sxs-lookup"><span data-stu-id="8df79-150">The query definition provides a toolbar and panes in which to define and test the query.</span></span>  
  
|<span data-ttu-id="8df79-151">窗格</span><span class="sxs-lookup"><span data-stu-id="8df79-151">Pane</span></span>|<span data-ttu-id="8df79-152">描述</span><span class="sxs-lookup"><span data-stu-id="8df79-152">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="8df79-153">**圖表**窗格</span><span class="sxs-lookup"><span data-stu-id="8df79-153">**Diagram** pane</span></span>|<span data-ttu-id="8df79-154">在圖表中顯示查詢。</span><span class="sxs-lookup"><span data-stu-id="8df79-154">Displays the query in a diagram.</span></span> <span data-ttu-id="8df79-155">此圖表顯示查詢所包括的資料表及其聯結方式。</span><span class="sxs-lookup"><span data-stu-id="8df79-155">The diagram shows the tables included in the query, and how they are joined.</span></span> <span data-ttu-id="8df79-156">選取或清除資料表之資料行旁邊的核取方塊，以便在查詢輸出中加入或移除。</span><span class="sxs-lookup"><span data-stu-id="8df79-156">Select or clear the check box next to a column in a table to add or remove it from the query output.</span></span><br /><br /> <span data-ttu-id="8df79-157">將資料表加入查詢時，查詢產生器會依據資料表中的索引鍵來建立以資料表為基礎的資料表之間的聯結。</span><span class="sxs-lookup"><span data-stu-id="8df79-157">When you add tables to the query, Query Builder creates joins between tables based on tables, depending on the keys in the table.</span></span> <span data-ttu-id="8df79-158">若要加入聯結，請將欄位從一個資料表拖曳至另一個資料表的欄位。</span><span class="sxs-lookup"><span data-stu-id="8df79-158">To add a join, drag a field from one table onto a field in another table.</span></span> <span data-ttu-id="8df79-159">若要管理聯結，請以滑鼠右鍵按一下聯結，然後選取功能表選項。</span><span class="sxs-lookup"><span data-stu-id="8df79-159">To manage a join, right-click the join, and then select a menu option.</span></span><br /><br /> <span data-ttu-id="8df79-160">以滑鼠右鍵按一下 [**圖表**] 窗格，即可加入或移除資料表、選取所有資料表，以及顯示或隱藏窗格。</span><span class="sxs-lookup"><span data-stu-id="8df79-160">Right-click the **Diagram** pane to add or remove tables, select all the tables, and show or hide panes.</span></span>|  
|<span data-ttu-id="8df79-161">**方格**窗格</span><span class="sxs-lookup"><span data-stu-id="8df79-161">**Grid** pane</span></span>|<span data-ttu-id="8df79-162">在方格中顯示查詢。</span><span class="sxs-lookup"><span data-stu-id="8df79-162">Displays the query in a grid.</span></span> <span data-ttu-id="8df79-163">您可以使用此方格，將資料行加入至查詢、從查詢移除資料行，以及變更每個資料行的設定。</span><span class="sxs-lookup"><span data-stu-id="8df79-163">You can use this pane to add to and remove columns from the query and change the settings for each column.</span></span>|  
|<span data-ttu-id="8df79-164">**SQL**窗格</span><span class="sxs-lookup"><span data-stu-id="8df79-164">**SQL** pane</span></span>|<span data-ttu-id="8df79-165">以 SQL 文字顯示查詢。</span><span class="sxs-lookup"><span data-stu-id="8df79-165">Displays the query as SQL text.</span></span> <span data-ttu-id="8df79-166">在 **[圖表]** 窗格和 **[方格]** 窗格中所做的變更會出現在此處，而在此處所做的變更會出現在 **[圖表]** 窗格和 **[方格]** 窗格中。</span><span class="sxs-lookup"><span data-stu-id="8df79-166">Changes made in the **Diagram** pane and the **Grid** pane will appear here, and changes made here will appear in the **Diagram** pane and the **Grid** pane.</span></span>|  
|<span data-ttu-id="8df79-167">**結果** 窗格</span><span class="sxs-lookup"><span data-stu-id="8df79-167">**Results** pane</span></span>|<span data-ttu-id="8df79-168">當您在工具列上按一下 **[執行]** 時，會顯示查詢的結果。</span><span class="sxs-lookup"><span data-stu-id="8df79-168">Displays the results of the query when you click **Run** on the toolbar.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="8df79-169">另請參閱</span><span class="sxs-lookup"><span data-stu-id="8df79-169">See Also</span></span>  
 <span data-ttu-id="8df79-170">[執行 SQL 工作](control-flow/execute-sql-task.md) </span><span class="sxs-lookup"><span data-stu-id="8df79-170">[Execute SQL Task](control-flow/execute-sql-task.md) </span></span>  
 <span data-ttu-id="8df79-171">[OLE DB 來源](data-flow/ole-db-source.md) </span><span class="sxs-lookup"><span data-stu-id="8df79-171">[OLE DB Source](data-flow/ole-db-source.md) </span></span>  
 <span data-ttu-id="8df79-172">[OLE DB 目的地](data-flow/ole-db-destination.md) </span><span class="sxs-lookup"><span data-stu-id="8df79-172">[OLE DB Destination](data-flow/ole-db-destination.md) </span></span>  
 <span data-ttu-id="8df79-173">[查閱轉換](data-flow/transformations/lookup-transformation.md) </span><span class="sxs-lookup"><span data-stu-id="8df79-173">[Lookup Transformation](data-flow/transformations/lookup-transformation.md) </span></span>  
 <span data-ttu-id="8df79-174">[Integration Services &#40;SSIS&#41; 查詢](integration-services-ssis-queries.md) </span><span class="sxs-lookup"><span data-stu-id="8df79-174">[Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md) </span></span>  
 [<span data-ttu-id="8df79-175">Integration Services 套件中的 MERGE</span><span class="sxs-lookup"><span data-stu-id="8df79-175">MERGE in Integration Services Packages</span></span>](control-flow/merge-in-integration-services-packages.md)  
  
  
