---
title: Integration Services 程式設計概觀 | Microsoft Docs
ms.custom: ''
ms.date: 11/25/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
helpviewer_keywords:
- Integration Services, programming
- architecture [Integration Services]
- assemblies [Integration Services]
- SSIS, programming
- SQL Server Integration Services, programming
- run-time engine [Integration Services]
- packages [Integration Services], programming
- data flow engine [Integration Services]
- languages [Integration Services]
ms.assetid: 262babc6-eea5-4609-bc65-07d64cbcfee9
author: chugugrace
ms.author: chugu
ms.openlocfilehash: d9dc548b2987f068f579f053a6b2d205186b416e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87596175"
---
# <a name="integration-services-programming-overview"></a><span data-ttu-id="c2ce6-102">Integration Services 程式設計概觀</span><span class="sxs-lookup"><span data-stu-id="c2ce6-102">Integration Services Programming Overview</span></span>
  [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="c2ce6-103">[!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 的架構會區隔資料移動和轉換與套件控制流程和管理。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-103">[!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] has an architecture that separates data movement and transformation from package control flow and management.</span></span> <span data-ttu-id="c2ce6-104">定義這個架構的是兩個不同的引擎，當您針對 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 進行程式設計時，可以將這兩個引擎自動化及擴充。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-104">There are two distinct engines that define this architecture and that can be automated and extended when programming [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)].</span></span> <span data-ttu-id="c2ce6-105">執行階段引擎會實作控制流程和封裝管理基礎結構，該基礎結構可讓開發人員控制執行流程及設定記錄、事件處理常式和變數的選項。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-105">The run-time engine implements the control flow and package management infrastructure that lets developers control the flow of execution and set options for logging, event handlers, and variables.</span></span> <span data-ttu-id="c2ce6-106">資料流程引擎是一種特殊且高效率的引擎，它是專門用來擷取、轉換及載入資料。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-106">The data flow engine is a specialized, high performance engine that is exclusively dedicated to extracting, transforming, and loading data.</span></span> <span data-ttu-id="c2ce6-107">在針對 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 進行程式設計時，您將會針對這兩個引擎進行程式設計。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-107">When programming [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)], you will be programming against these two engines.</span></span>  
  
 <span data-ttu-id="c2ce6-108">下列影像說明 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 的架構。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-108">The following image depicts the architecture of [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="c2ce6-109">![Integration Services 架構](media/mw-dts-01.gif "Integration Services 架構")</span><span class="sxs-lookup"><span data-stu-id="c2ce6-109">![Integration Services architecture](media/mw-dts-01.gif "Integration Services architecture")</span></span>  
  
## <a name="integration-services-run-time-engine"></a><span data-ttu-id="c2ce6-110">Integration Services 執行階段引擎</span><span class="sxs-lookup"><span data-stu-id="c2ce6-110">Integration Services Run-time Engine</span></span>  
 <span data-ttu-id="c2ce6-111">[!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 執行階段引擎會控制封裝的管理與執行，其方式是實作可啟用執行順序、記錄、變數和事件處理的基礎結構。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-111">The [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] run-time engine controls the management and execution of packages, by implementing the infrastructure that enables execution order, logging, variables, and event handling.</span></span> <span data-ttu-id="c2ce6-112">針對 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 執行階段引擎進行程式設計，可讓開發人員將封裝的建立、組態設定和執行自動化，並建立自訂工作和其他延伸模組。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-112">Programming the [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] run-time engine lets developers automate the creation, configuration, and execution of packages and create custom tasks and other extensions.</span></span>  
  
 <span data-ttu-id="c2ce6-113">如需詳細資訊，請參閱[以指令碼工作擴充套件](extending-packages-scripting/task/extending-the-package-with-the-script-task.md)、[開發自訂工作](extending-packages-custom-objects/task/developing-a-custom-task.md)和[以程式設計方式建置套件](building-packages-programmatically/building-packages-programmatically.md)。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-113">For more information, see [Extending the Package with the Script Task](extending-packages-scripting/task/extending-the-package-with-the-script-task.md), [Developing a Custom Task](extending-packages-custom-objects/task/developing-a-custom-task.md), and [Building Packages Programmatically](building-packages-programmatically/building-packages-programmatically.md).</span></span>  
  
## <a name="integration-services-data-flow-engine"></a><span data-ttu-id="c2ce6-114">Integration Services 資料流程引擎</span><span class="sxs-lookup"><span data-stu-id="c2ce6-114">Integration Services Data Flow Engine</span></span>  
 <span data-ttu-id="c2ce6-115">資料流程引擎會管理資料流程工作，該工作是一項特殊且高效能的工作，專門用來移動及轉換各種不同來源中的資料。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-115">The data flow engine manages the data flow task, which is a specialized, high performance task dedicated to moving and transforming data from disparate sources.</span></span> <span data-ttu-id="c2ce6-116">與其他工作不同的是，資料流程工作包含了其他稱為資料流程元件的物件，這些可能是來源、轉換或目的地。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-116">Unlike other tasks, the data flow task contains additional objects called data flow components, which can be sources, transformations, or destinations.</span></span> <span data-ttu-id="c2ce6-117">這些元件是此工作的核心移動部分，</span><span class="sxs-lookup"><span data-stu-id="c2ce6-117">These components are the core moving parts of the task.</span></span> <span data-ttu-id="c2ce6-118">它們會定義資料的移動和轉換。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-118">They define the movement and transformation of data.</span></span> <span data-ttu-id="c2ce6-119">針對資料流程引擎進行程式設計可讓開發人員將資料流程工作中元件的建立和組態設定自動化，並建立自訂元件。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-119">Programming the data flow engine lets developers automate the creation and configuration of the components in a data flow task, and create custom components.</span></span>  
  
 <span data-ttu-id="c2ce6-120">如需詳細[資訊，請](extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md)參閱 [使用腳本元件擴充資料流程] (擴充-封裝-腳本/資料流程---------------------------------- [ ](building-packages-programmatically/building-packages-programmatically.md)---------------------</span><span class="sxs-lookup"><span data-stu-id="c2ce6-120">For more information, see [Extending the Data Flow with the Script Component](extending-packages-scripting/data-flow-script-component/extending-the-data-flow-with-the-script-component.md, [Developing a Custom Data Flow Component](extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md), and [Building Packages Programmatically](building-packages-programmatically/building-packages-programmatically.md).</span></span>  
  
## <a name="supported-languages"></a><span data-ttu-id="c2ce6-121">支援的語言</span><span class="sxs-lookup"><span data-stu-id="c2ce6-121">Supported Languages</span></span>  
 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] <span data-ttu-id="c2ce6-122">完全支援 [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-122">fully supports the [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="c2ce6-123">如此可讓開發人員使用所選的 .NET 相容語言來針對 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 進行程式設計。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-123">This lets developers program [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] in their choice of .NET-compliant languages.</span></span> <span data-ttu-id="c2ce6-124">雖然執行階段引擎和資料流程引擎都是以機器碼所撰寫，但是兩者都可透過完全受管理的物件模型來使用。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-124">Although both the run-time engine and the data flow engine are written in native code, they are both available through a fully managed object model.</span></span>  
  
 <span data-ttu-id="c2ce6-125">您可以在 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] [!INCLUDE[msCoName](../includes/msconame-md.md)] 或是其他程式碼或文字編輯器中設計 [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] 套件、自訂工作和元件的程式。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-125">You can program [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] packages, custom tasks, and components in [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] or in another code or text editor.</span></span> [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] <span data-ttu-id="c2ce6-126">提供開發人員許多工具與功能，使之可以簡化及加快反覆執行程式碼撰寫、偵錯與測試週期的速度。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-126">offers the developer many tools and features to simplify and accelerate the iterative cycles of coding, debugging, and testing.</span></span> [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] <span data-ttu-id="c2ce6-127">也可簡化部署工作。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-127">also makes deployment easier.</span></span> <span data-ttu-id="c2ce6-128">但是，您不需要 [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] 編譯及建立 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 程式碼專案。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-128">However, you do not need [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] to compile and build [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] code projects.</span></span> <span data-ttu-id="c2ce6-129">[!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] SDK 包含 [!INCLUDE[vbprvb](../includes/vbprvb-md.md)] 和 [!INCLUDE[csprcs](../includes/csprcs-md.md)] 編譯器與相關工具。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-129">The [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] SDK includes the [!INCLUDE[vbprvb](../includes/vbprvb-md.md)] and [!INCLUDE[csprcs](../includes/csprcs-md.md)] compilers and related tools.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="c2ce6-130">依預設，[!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] 會隨 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 一起安裝，但是不會安裝 [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] SDK。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-130">By default, the [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] is installed with [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], but the [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] SDK is not.</span></span> <span data-ttu-id="c2ce6-131">除非已在電腦上安裝 SDK，而且 SDK 文件集是包含在線上叢書集合中，否則本節中的 SDK 內容連結將不會有任何作用。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-131">Unless the SDK is installed on the computer and the SDK documentation is included in the Books Online collection, links to SDK content in this section will not work.</span></span> <span data-ttu-id="c2ce6-132">在安裝 [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] SDK 之後，您可以遵循[新增或移除 SQL Server 的產品文件集](../index.yml)中的指示，將 SDK 文件集新增至線上叢書集合和目錄。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-132">After you have installed the [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] SDK, you can add the SDK documentation to the Books Online collection and table of contents by following the instructions in [Add or Remove Product Documentation for SQL Server](../index.yml).</span></span>  
  
 <span data-ttu-id="c2ce6-133">[!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 指令碼工作和指令碼元件會將 [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] Tools for Applications (VSTA) 作為內嵌指令碼環境使用。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-133">The [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] Script task and Script component use [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] Tools for Applications (VSTA) as an embedded scripting environment.</span></span> <span data-ttu-id="c2ce6-134">VSTA 支援 [!INCLUDE[msCoName](../includes/msconame-md.md)] Visual Basic 和 [!INCLUDE[msCoName](../includes/msconame-md.md)] Visual C#。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-134">VSTA supports [!INCLUDE[msCoName](../includes/msconame-md.md)] Visual Basic and [!INCLUDE[msCoName](../includes/msconame-md.md)] Visual C#.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="c2ce6-135">[!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 應用程式開發介面與 COM 指令碼語言 (如 VBScript) 不相容。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-135">The [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] application programming interfaces are incompatible with COM-based scripting languages such as VBScript.</span></span>  
  
## <a name="locating-assemblies"></a><span data-ttu-id="c2ce6-136">尋找組件</span><span class="sxs-lookup"><span data-stu-id="c2ce6-136">Locating Assemblies</span></span>  
 <span data-ttu-id="c2ce6-137">在 [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)]中， [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 組件已經升級至 .NET 4.0。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-137">In [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)], the [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] assemblies were upgraded to .NET 4.0.</span></span> <span data-ttu-id="c2ce6-138">.NET 4 有個別的全域組件快取，位於 *\<drive>* :\Windows\Microsoft.NET\assembly。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-138">There is a separate global assembly cache for .NET 4, located in *\<drive>*:\Windows\Microsoft.NET\assembly.</span></span> <span data-ttu-id="c2ce6-139">您可以在此路徑底下 (通常在 GAC_MSIL 資料夾中) 找到所有 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 組件。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-139">You can find all of the [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] assemblies under this path, usually in the GAC_MSIL folder.</span></span>  
  
 <span data-ttu-id="c2ce6-140">如同舊版 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]，核心 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 擴充性 .dll 檔案也位於 *\<drive>* :\Program Files\Microsoft SQL Server\100\SDK\Assemblies。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-140">As in previous versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the core [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] extensibility .dll files are also located at *\<drive>*:\Program Files\Microsoft SQL Server\100\SDK\Assemblies.</span></span>  
  
## <a name="commonly-used-assemblies"></a><span data-ttu-id="c2ce6-141">常用的組件</span><span class="sxs-lookup"><span data-stu-id="c2ce6-141">Commonly Used Assemblies</span></span>  
 <span data-ttu-id="c2ce6-142">下表列出在使用 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 開發 [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] 程式時經常使用的組件。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-142">The following table lists the assemblies that are frequently used when programming [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] using the [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)].</span></span>  
  
|<span data-ttu-id="c2ce6-143">組件</span><span class="sxs-lookup"><span data-stu-id="c2ce6-143">Assembly</span></span>|<span data-ttu-id="c2ce6-144">描述</span><span class="sxs-lookup"><span data-stu-id="c2ce6-144">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="c2ce6-145">Microsoft.SqlServer.ManagedDTS.dll</span><span class="sxs-lookup"><span data-stu-id="c2ce6-145">Microsoft.SqlServer.ManagedDTS.dll</span></span>|<span data-ttu-id="c2ce6-146">包含 Managed 執行階段引擎。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-146">Contains the managed run-time engine.</span></span>|  
|<span data-ttu-id="c2ce6-147">Microsoft.SqlServer.RuntimeWrapper.dll</span><span class="sxs-lookup"><span data-stu-id="c2ce6-147">Microsoft.SqlServer.RuntimeWrapper.dll</span></span>|<span data-ttu-id="c2ce6-148">包含原生執行階段引擎的主要 Interop 組件 (PIA) 或包裝函數。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-148">Contains the primary interop assembly (PIA), or wrapper, for the native run-time engine.</span></span>|  
|<span data-ttu-id="c2ce6-149">Microsoft.SqlServer.PipelineHost.dll</span><span class="sxs-lookup"><span data-stu-id="c2ce6-149">Microsoft.SqlServer.PipelineHost.dll</span></span>|<span data-ttu-id="c2ce6-150">包含 Managed 資料流程引擎。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-150">Contains the managed data flow engine.</span></span>|  
|<span data-ttu-id="c2ce6-151">Microsoft.SqlServer.PipelineWrapper.dll</span><span class="sxs-lookup"><span data-stu-id="c2ce6-151">Microsoft.SqlServer.PipelineWrapper.dll</span></span>|<span data-ttu-id="c2ce6-152">包含原生資料流程引擎的主要 Interop 組件 (PIA) 或包裝函數。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-152">Contains the primary interop assembly (PIA), or wrapper, for the native data flow engine.</span></span>|  

<span data-ttu-id="c2ce6-153">![Integration Services 圖示 (小型) ](media/dts-16.gif "Integration Services 圖示 (小)")會**保持最**新狀態 Integration Services  </span><span class="sxs-lookup"><span data-stu-id="c2ce6-153">![Integration Services icon (small)](media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="c2ce6-154">若要取得 Microsoft 的最新下載、文件、範例和影片以及社群中的精選解決方案，請瀏覽 MSDN 上的 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 頁面：</span><span class="sxs-lookup"><span data-stu-id="c2ce6-154">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="c2ce6-155">瀏覽 MSDN 上的 Integration Services 頁面</span><span class="sxs-lookup"><span data-stu-id="c2ce6-155">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="c2ce6-156">若要得到這些更新的自動通知，請訂閱該頁面上所提供的 RSS 摘要。</span><span class="sxs-lookup"><span data-stu-id="c2ce6-156">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>  
  
  
