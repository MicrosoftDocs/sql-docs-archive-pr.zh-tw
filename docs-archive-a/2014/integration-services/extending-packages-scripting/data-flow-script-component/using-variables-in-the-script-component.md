---
title: 在指令碼元件中使用變數 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
helpviewer_keywords:
- Script component [Integration Services], using variables
ms.assetid: 92d1881a-1ef1-43ae-b1ca-48d0536bdbc2
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 4328a938c56ad8383c12cdae1d6511604ec65582
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87704314"
---
# <a name="using-variables-in-the-script-component"></a><span data-ttu-id="b6687-102">在指令碼元件中使用變數</span><span class="sxs-lookup"><span data-stu-id="b6687-102">Using Variables in the Script Component</span></span>
  <span data-ttu-id="b6687-103">變數會儲存封裝及其容器、工作與事件處理常式在執行階段所能使用的值。</span><span class="sxs-lookup"><span data-stu-id="b6687-103">Variables store values that a package and its containers, tasks, and event handlers can use at run time.</span></span> <span data-ttu-id="b6687-104">如需詳細資訊，請參閱 [Integration Services &#40;SSIS&#41; 變數](../../integration-services-ssis-variables.md)。</span><span class="sxs-lookup"><span data-stu-id="b6687-104">For more information, see [Integration Services &#40;SSIS&#41; Variables](../../integration-services-ssis-variables.md).</span></span>  
  
 <span data-ttu-id="b6687-105">您可以在 [ `ReadOnlyVariables` `ReadWriteVariables` **腳本轉換編輯器**] 的 [**腳本**] 頁面上，于和欄位中輸入以逗號分隔的變數清單，讓現有的變數可供自訂腳本進行唯讀或讀取/寫入存取。</span><span class="sxs-lookup"><span data-stu-id="b6687-105">You can make existing variables available for read-only or read/write access by your custom script by entering comma-delimited lists of variables in the `ReadOnlyVariables` and `ReadWriteVariables` fields on the **Script** page of the **Script Transformation Editor**.</span></span> <span data-ttu-id="b6687-106">請記住變數名稱有區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="b6687-106">Keep in mind that variable names are case-sensitive.</span></span> <span data-ttu-id="b6687-107">使用 `Value` 屬性讀取和寫入個別變數。</span><span class="sxs-lookup"><span data-stu-id="b6687-107">Use the `Value` property to read from and write to individual variables.</span></span> <span data-ttu-id="b6687-108">當指令碼在執行階段操作變數時，指令碼元件會在幕後處理任何所需的鎖定。</span><span class="sxs-lookup"><span data-stu-id="b6687-108">The Script component handles any required locking behind the scenes as your script manipulates the variables at run time.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="b6687-109">`ReadWriteVariables` 的集合只能在 `PostExecute` 方法中使用，才能最佳化效能並將鎖定衝突的風險降到最低。</span><span class="sxs-lookup"><span data-stu-id="b6687-109">The collection of `ReadWriteVariables` is only available in the `PostExecute` method to maximize performance and minimize the risk of locking conflicts.</span></span> <span data-ttu-id="b6687-110">因此您無法在處理每一列資料時，直接增量封裝變數值。</span><span class="sxs-lookup"><span data-stu-id="b6687-110">Therefore you cannot directly increment the value of a package variable as you process each row of data.</span></span> <span data-ttu-id="b6687-111">必須改增量區域變數值，並在處理所有的資料之後，將封裝變數值設定為 `PostExecute` 方法中的區域變數值。</span><span class="sxs-lookup"><span data-stu-id="b6687-111">Increment the value of a local variable instead, and set the value of the package variable to the value of the local variable in the `PostExecute` method after all data has been processed.</span></span> <span data-ttu-id="b6687-112">您也可以使用 <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> 屬性，以解決這個限制，如本主題稍後所述。</span><span class="sxs-lookup"><span data-stu-id="b6687-112">You can also use the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> property to work around this limitation, as described later in this topic.</span></span> <span data-ttu-id="b6687-113">不過，在處理每個資料列時直接寫入封裝變數，將會對效能產生負面的影響，並增加鎖定衝突的風險。</span><span class="sxs-lookup"><span data-stu-id="b6687-113">However, writing directly to a package variable as each row is processed will negatively impact performance and increase the risk of locking conflicts.</span></span>  
  
 <span data-ttu-id="b6687-114">如需 [指令碼轉換編輯器] 之 [指令碼] 頁面的詳細資訊，請參閱[在指令碼元件編輯器中設定指令碼元件](configuring-the-script-component-in-the-script-component-editor.md)和[指令碼轉換編輯器 &#40;指令碼頁面&#41;](../../script-transformation-editor-script-page.md)。</span><span class="sxs-lookup"><span data-stu-id="b6687-114">For more information about the **Script** page of the **Script Transformation Editor**, see [Configuring the Script Component in the Script Component Editor](configuring-the-script-component-in-the-script-component-editor.md) and [Script Transformation Editor &#40;Script Page&#41;](../../script-transformation-editor-script-page.md).</span></span>  
  
 <span data-ttu-id="b6687-115">指令碼元件會在 `Variables` 專案項目中建立 `ComponentWrapper` 集合類別，它的每個預先設定的變數值 (屬性與變數本身的名稱相同) 都有強式類型的存取子屬性。</span><span class="sxs-lookup"><span data-stu-id="b6687-115">The Script component creates a `Variables` collection class in the `ComponentWrapper` project item with a strongly-typed accessor property for the value of each preconfigured variable where the property has the same name as the variable itself.</span></span> <span data-ttu-id="b6687-116">此集合是透過 `Variables` 類別的 `ScriptMain` 屬性來公開。</span><span class="sxs-lookup"><span data-stu-id="b6687-116">This collection is exposed through the `Variables` property of the `ScriptMain` class.</span></span> <span data-ttu-id="b6687-117">存取子屬性會提供適當的唯讀或是讀取/寫入權限給變數值。</span><span class="sxs-lookup"><span data-stu-id="b6687-117">The accessor property provides read-only or read/write permission to the value of the variable as appropriate.</span></span> <span data-ttu-id="b6687-118">例如，如果您已將名為 `MyIntegerVariable` 的整數變數加入 `ReadOnlyVariables` 清單，可以使用下列程式碼在指令碼中擷取其值：</span><span class="sxs-lookup"><span data-stu-id="b6687-118">For example, if you have added an integer variable named `MyIntegerVariable` to the `ReadOnlyVariables` list, you can retrieve its value in your script by using the following code:</span></span>  
  
 `Dim myIntegerVariableValue As Integer = Me.Variables.MyIntegerVariable`  
  
 <span data-ttu-id="b6687-119">您也可以使用透過呼叫 `Me.VariableDispenser` 來存取的 <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> 屬性，以使用指令碼元件中的變數。</span><span class="sxs-lookup"><span data-stu-id="b6687-119">You can also use the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> property, accessed by calling `Me.VariableDispenser`, to work with variables in the Script component.</span></span> <span data-ttu-id="b6687-120">在這種情況下，您不是為變數使用具類型和具名的存取子屬性，而是直接存取變數。</span><span class="sxs-lookup"><span data-stu-id="b6687-120">In this case you are not using the typed and named accessor properties for variables, but accessing the variables directly.</span></span> <span data-ttu-id="b6687-121">在使用 <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A>時，您必須在自己的程式碼中處理變數值的鎖定語意和資料類型的轉換。</span><span class="sxs-lookup"><span data-stu-id="b6687-121">When using the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A>, you must handle both the locking semantics and the casting of data types for variable values in your own code.</span></span> <span data-ttu-id="b6687-122">如果您想要使用在設計階段無法使用，但是會在執行階段以程式設計方式建立的變數，就必須使用 <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> 屬性，而不是具名與具類型的存取子屬性。</span><span class="sxs-lookup"><span data-stu-id="b6687-122">You have to use the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> property instead of the named and typed accessor properties if you want to work with a variable that is not available at design time but is created programmatically at run time.</span></span>  
  
<span data-ttu-id="b6687-123">![Integration Services 圖示 (小型) ](../../media/dts-16.gif "Integration Services 圖示 (小)")會**保持最**新狀態 Integration Services  </span><span class="sxs-lookup"><span data-stu-id="b6687-123">![Integration Services icon (small)](../../media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="b6687-124">若要取得 Microsoft 的最新下載、文件、範例和影片以及社群中的精選解決方案，請瀏覽 MSDN 上的 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] 頁面：</span><span class="sxs-lookup"><span data-stu-id="b6687-124">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="b6687-125">瀏覽 MSDN 上的 Integration Services 頁面</span><span class="sxs-lookup"><span data-stu-id="b6687-125">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="b6687-126">若要得到這些更新的自動通知，請訂閱該頁面上所提供的 RSS 摘要。</span><span class="sxs-lookup"><span data-stu-id="b6687-126">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b6687-127">另請參閱</span><span class="sxs-lookup"><span data-stu-id="b6687-127">See Also</span></span>  
 <span data-ttu-id="b6687-128">[Integration Services &#40;SSIS&#41; 變數](../../integration-services-ssis-variables.md) </span><span class="sxs-lookup"><span data-stu-id="b6687-128">[Integration Services &#40;SSIS&#41; Variables](../../integration-services-ssis-variables.md) </span></span>  
 [<span data-ttu-id="b6687-129">在封裝中使用變數</span><span class="sxs-lookup"><span data-stu-id="b6687-129">Use Variables in Packages</span></span>](../../use-variables-in-packages.md)  
  
  
