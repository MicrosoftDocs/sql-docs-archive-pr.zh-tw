---
title: 在指令碼元件編輯器中設定指令碼元件 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
dev_langs:
- VB
helpviewer_keywords:
- SSIS Script component
- Script Component Editor
- SSIS Script component, configuring
- Script component [Integration Services], configuring
ms.assetid: 586dd799-f383-4d6d-b1a1-f09233d14f0a
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 4a9925d29c7a960c46e217f1e96c0bcae4f217b9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87597218"
---
# <a name="configuring-the-script-component-in-the-script-component-editor"></a><span data-ttu-id="b5b2a-102">在指令碼元件編輯器中設定指令碼元件</span><span class="sxs-lookup"><span data-stu-id="b5b2a-102">Configuring the Script Component in the Script Component Editor</span></span>
  <span data-ttu-id="b5b2a-103">您在指令碼元件中撰寫自訂程式碼之前，必須選取您要建立的資料流程元件的類型 (來源、轉換或是目的地)，然後在 [指令碼轉換編輯器]  中設定元件的中繼資料與屬性。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-103">Before you write custom code in the Script component, you must select the type of data flow component that you want to create-source, transformation, or destination-and then configure the component's metadata and properties in the **Script Transformation Editor**.</span></span>

## <a name="selecting-the-type-of-component-to-create"></a><span data-ttu-id="b5b2a-104">選取要建立的元件類型</span><span class="sxs-lookup"><span data-stu-id="b5b2a-104">Selecting the Type of Component to Create</span></span>
 <span data-ttu-id="b5b2a-105">當您將指令碼元件新增至 [!INCLUDE[ssIS](../../../includes/ssis-md.md)] 設計工具的 [資料流程] 窗格時，[選取指令碼元件類型]  對話方塊便會出現。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-105">When you add a Script component to the Data Flow pane of [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, the **Select Script Component Type** dialog box appears.</span></span> <span data-ttu-id="b5b2a-106">您可以將元件預先設定為來源、轉換或目的地。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-106">You preconfigure the component as a source, transformation, or destination.</span></span> <span data-ttu-id="b5b2a-107">在做出初步選擇之後，便可繼續在 [指令碼轉換編輯器]  中設定元件。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-107">After you make this initial selection, you can continue to configure the component in the **Script Transformation Editor**.</span></span>

 <span data-ttu-id="b5b2a-108">若要為指令碼元件設定預設的指令碼語言，請使用 [選項] 對話方塊的 [一般] 頁面上的 [指令碼語言] 選項。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-108">To set the default script language for the Script component, use the **Scripting language** option on the **General** page of the **Options** dialog box.</span></span> <span data-ttu-id="b5b2a-109">如需相關資訊，請參閱 [General Page](../../general-page-of-integration-services-designers-options.md)。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-109">For more information, see [General Page](../../general-page-of-integration-services-designers-options.md).</span></span>

## <a name="understanding-the-two-design-time-modes"></a><span data-ttu-id="b5b2a-110">了解兩個設計階段模式</span><span class="sxs-lookup"><span data-stu-id="b5b2a-110">Understanding the Two Design-Time Modes</span></span>
 <span data-ttu-id="b5b2a-111">在 [!INCLUDE[ssIS](../../../includes/ssis-md.md)] 設計師中，指令碼元件有中繼資料設計與程式碼設計兩種模式。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-111">In [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, the Script component has two modes: metadata design mode and code design mode.</span></span>

 <span data-ttu-id="b5b2a-112">當您開啟 [指令碼轉換編輯器]  時，元件會進入中繼資料設計模式。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-112">When you open the **Script Transformation Editor**, the component enters metadata design mode.</span></span> <span data-ttu-id="b5b2a-113">在此模式中，您可以選取輸入資料行，以及加入或設定輸出與輸出資料行，但是無法撰寫程式碼。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-113">In this mode, you can select input columns, and add or configure outputs and output columns, but you cannot write code.</span></span> <span data-ttu-id="b5b2a-114">在您已設定好元件的中繼資料之後，便可切換到程式碼設計模式以撰寫指令碼。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-114">After you have configured the component's metadata, you can switch to code design mode to write the script.</span></span>

 <span data-ttu-id="b5b2a-115">當您按一下 [編輯指令碼]  以切換到程式碼設計模式時，指令碼元件會鎖定中繼資料以防止其他變更，接著會從輸入和輸出的中繼資料自動產生基底程式碼。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-115">When you switch to code design mode by clicking **Edit Script**, the Script component locks metadata to prevent additional changes, and then automatically generates base code from the metadata of the inputs and outputs.</span></span> <span data-ttu-id="b5b2a-116">在完成自動產生的程式碼之後，將可以輸入自訂程式碼。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-116">After the autogenerated code is complete, you will be able to enter your custom code.</span></span> <span data-ttu-id="b5b2a-117">您的程式碼使用自動產生的基底類別以處理輸入資料列、存取緩衝區和緩衝區中的資料行，以及從封裝擷取連接管理員與變數，全部都做為強式類型的物件。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-117">Your code uses the auto-generated base classes to process input rows, to access buffers and columns in the buffers, and to retrieve connection managers and variables from the package, all as strongly-typed objects.</span></span>

 <span data-ttu-id="b5b2a-118">在程式碼設計模式中輸入自訂程式碼之後，便可切換回中繼資料設計模式。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-118">After entering your custom code in code design mode, you can switch back to metadata design mode.</span></span> <span data-ttu-id="b5b2a-119">這並不會刪除您已輸入的任何程式碼，然而，對中繼資料的後續變更會造成重新產生基底類別。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-119">This does not delete any code that you have entered; however, subsequent changes to the metadata cause the base class to be regenerated.</span></span> <span data-ttu-id="b5b2a-120">之後，您的元件可能會無法驗證，因為自訂程式碼所參考的物件可能不再存在或是可能已修改過。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-120">Afterward, your component may fail validation because objects referenced by your custom code may no longer exist or may have been modified.</span></span> <span data-ttu-id="b5b2a-121">在此情況下，您必須手動修正程式碼，才能針對重新產生的基底類別成功地編譯程式碼。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-121">In this case, you must fix your code manually so that it can be compiled successfully against the regenerated base class.</span></span>

## <a name="configuring-the-component-in-metadata-design-mode"></a><span data-ttu-id="b5b2a-122">在中繼資料設計模式中設定元件</span><span class="sxs-lookup"><span data-stu-id="b5b2a-122">Configuring the Component in Metadata Design Mode</span></span>
 <span data-ttu-id="b5b2a-123">在中繼資料設計模式中，您可以選取輸入資料行，以及加入和設定輸出與輸出資料行，但是無法撰寫程式碼。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-123">In metadata design mode, you can select input columns, and add and configure outputs and output columns, but you cannot write code.</span></span> <span data-ttu-id="b5b2a-124">在您已設定好元件的中繼資料之後，便可切換到程式碼設計模式以撰寫指令碼。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-124">After you have configured the component's metadata, switch to code design mode to write the script.</span></span>

 <span data-ttu-id="b5b2a-125">您必須在自訂編輯器中設定的屬性，端視指令碼元件的使用而定。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-125">The properties that you must configure in the custom editor depend on the usage of the Script component.</span></span> <span data-ttu-id="b5b2a-126">指令碼元件可以設定為來源、轉換或目的地。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-126">The Script component can be configured as a source, a transformation, or a destination.</span></span> <span data-ttu-id="b5b2a-127">視元件的使用方式而定，可支援輸入、輸出或兩者。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-127">Depending on how the component is used, it supports either an input or outputs or both.</span></span> <span data-ttu-id="b5b2a-128">您將撰寫的自訂程式碼會負責處理輸入和輸出資料列與資料行。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-128">The custom code that you will write processes the input and output rows and columns.</span></span>

### <a name="inputs-columns-page-of-the-script-transformation-editor"></a><span data-ttu-id="b5b2a-129">指令碼轉換編輯器的輸入資料行頁面</span><span class="sxs-lookup"><span data-stu-id="b5b2a-129">Inputs Columns Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="b5b2a-130">會為轉換和目的地，但不會為來源顯示 [指令碼轉換編輯器] 的 [輸入資料行] 頁面。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-130">The **Input Columns** page of the **Script Transformation Editor** is displayed for transformations and destinations, but not for sources.</span></span> <span data-ttu-id="b5b2a-131">在本頁，您選取要提供給自訂指令碼使用的輸入資料行，並指定這些資料行的唯讀或讀寫存取權限。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-131">On this page, you select the available input columns that you want to make available to your custom script, and specify read-only or read/write access to them.</span></span>

 <span data-ttu-id="b5b2a-132">在將會根據此中繼資料產生的程式碼專案中，BufferWrapper 專案項目包含每個輸入的類別，而且這個類別包含每個選取的輸入資料行之具類型的存取子屬性。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-132">In the code project that will be generated based on this metadata, the BufferWrapper project item contains a class for each input, and this class contains typed accessor properties for each input column selected.</span></span> <span data-ttu-id="b5b2a-133">例如，如果您從名為的輸入中選取整數**CustomerID**資料行和字串**CustomerName**資料行 `CustomerInput` ，則 BufferWrapper 專案專案會包含 `CustomerInput` 衍生自的類別 <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer> ，而 `CustomerInput` 類別會公開名為**CustomerID**的整數屬性和名為**CustomerName**的字串屬性。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-133">For example, if you select an integer **CustomerID** column and a string **CustomerName** column from an input named `CustomerInput`, the BufferWrapper project item will contain a `CustomerInput` class that derives from <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer>, and the `CustomerInput` class will expose an integer property named **CustomerID** and a string property named **CustomerName**.</span></span> <span data-ttu-id="b5b2a-134">這個慣例使得撰寫具有類型檢查的程式碼變得可能，如下所示：</span><span class="sxs-lookup"><span data-stu-id="b5b2a-134">This convention makes it possible to write code with type-checking like the following:</span></span>

```vb
Dim currentCustomerID as Integer = CustomerInput.CustomerID
Dim currentCustomerName as String = CustomerInput.CustomerName
```

 <span data-ttu-id="b5b2a-135">如需如何為特定類型的資料流程元件設定輸入資料行的詳細資訊，請參閱[開發特定類型的指令碼元件](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md)之下的適當範例。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-135">For more information about how to configure input columns for a specific type of data flow component, see the appropriate example under [Developing Specific Types of Script Components](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span></span>

### <a name="inputs-and-outputs-page-of-the-script-transformation-editor"></a><span data-ttu-id="b5b2a-136">指令碼轉換編輯器的輸入及輸出頁面</span><span class="sxs-lookup"><span data-stu-id="b5b2a-136">Inputs and Outputs Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="b5b2a-137">會為來源、轉換和目的地顯示 [指令碼轉換編輯器] 的 [輸入及輸出] 頁面。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-137">The **Input and Outputs** page of the **Script Transformation Editor** is displayed for sources, transformations, and destinations.</span></span> <span data-ttu-id="b5b2a-138">在本頁，您可以加入、移除和設定要在自訂指令碼中使用的輸入、輸出和輸出資料行，但具有下列限制：</span><span class="sxs-lookup"><span data-stu-id="b5b2a-138">On this page, you add, remove, and configure inputs, outputs, and output columns that you want to use in your custom script, within the following limitations:</span></span>

-   <span data-ttu-id="b5b2a-139">當做為來源使用時，指令碼元件沒有輸入並且支援多個輸出。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-139">When used as a source, the Script component has no input and supports multiple outputs.</span></span>

-   <span data-ttu-id="b5b2a-140">當做為轉換使用時，指令碼元件可支援一個輸入和多個輸出。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-140">When used as a transformation, the Script component supports one input and multiple outputs.</span></span>

-   <span data-ttu-id="b5b2a-141">當做為目的地使用時，指令碼元件支援一個輸入並且沒有輸出。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-141">When used as a destination, the Script component supports one input and has no outputs.</span></span>

 <span data-ttu-id="b5b2a-142">在將會根據此中繼資料產生的程式碼專案中，BufferWrapper 專案項目包含每個輸入與輸出的類別。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-142">In the code project that will be generated based on this metadata, the BufferWrapper project item contains a class for each input and output.</span></span> <span data-ttu-id="b5b2a-143">例如，如果您建立名為的輸出 `CustomerOutput` ，則 BufferWrapper 專案專案會包含一個 `CustomerOutput` 衍生自的類別 <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer> ，而該 `CustomerOutput` 類別會包含所建立之每個輸出資料行的具類型存取子屬性。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-143">For example, if you create an output named `CustomerOutput`, the BufferWrapper project item will contain a `CustomerOutput` class that derives from <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer>, and the `CustomerOutput` class will contain typed accessor properties for each output column created.</span></span>

 <span data-ttu-id="b5b2a-144">您只能在 [輸入及輸出]  頁面上設定輸出資料行。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-144">You can configure output columns only on the **Input and Outputs** page.</span></span> <span data-ttu-id="b5b2a-145">您可以在 [輸入資料行]  頁面上，選取轉換和目的地的輸入資料行。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-145">You can select input columns for transformations and destinations on the **Input Columns** page.</span></span> <span data-ttu-id="b5b2a-146">在 BufferWrapper 專案項目中為您建立的具類型之存取子屬性對於輸出資料行而言將是唯寫的。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-146">The typed accessor properties created for you in the BufferWrapper project item will be write-only for output columns.</span></span> <span data-ttu-id="b5b2a-147">輸入資料行的存取子屬性將是唯讀或是讀取/寫入，端視您為 [輸入資料行]  頁面上的每個資料行所選取的使用類型而定。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-147">The accessor properties for input columns will be read-only or read/write depending on the usage type that you have selected for each column on the **Input Columns** page.</span></span>

 <span data-ttu-id="b5b2a-148">如需為特定類型的資料流程元件設定輸入和輸出的詳細資訊，請參閱[開發特定類型的指令碼元件](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md)之下的適當範例。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-148">For more information about configuring inputs and outputs for a specific type of data flow component see the appropriate example under [Developing Specific Types of Script Components](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span></span>

> [!NOTE]
>  <span data-ttu-id="b5b2a-149">雖然您無法在指令碼元件中將輸出直接設定為錯誤輸出，以自動處理錯誤資料列，不過可以建立其他輸出與使用指令碼，適時地將資料列導向此輸出，以重新產生錯誤輸出的功能。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-149">Although you cannot directly configure an output as an error output in the Script component for automatic handling of error rows, you can reproduce the functionality of an error output by creating an additional output and using script to direct rows to this output when appropriate.</span></span> <span data-ttu-id="b5b2a-150">如需詳細資訊，請參閱[模擬指令碼元件的錯誤輸出](../../data-flow/transformations/script-component.md)。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-150">For more information, see [Simulating an Error Output for the Script Component](../../data-flow/transformations/script-component.md).</span></span>

#### <a name="exclusiongroup-and-synchronousinputid-properties-of-outputs"></a><span data-ttu-id="b5b2a-151">輸出的 ExclusionGroup 與 SynchronousInputID 屬性</span><span class="sxs-lookup"><span data-stu-id="b5b2a-151">ExclusionGroup and SynchronousInputID Properties of Outputs</span></span>
 <span data-ttu-id="b5b2a-152">`ExclusionGroup` 屬性只有在具有同步輸出的轉換中才有非零值，在這裡程式碼會執行篩選或分支，並將每個資料列導向具有相同非零 `ExclusionGroup` 值的其中一個輸出。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-152">The `ExclusionGroup` property has a non-zero value only in transformations with synchronous outputs, where your code performs filtering or branching and directs each row to one of the outputs that share the same non-zero `ExclusionGroup` value.</span></span> <span data-ttu-id="b5b2a-153">例如，轉換可以將資料列導向至預設輸出或是錯誤輸出。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-153">For example, the transformation can direct rows either to the default output or to an error output.</span></span> <span data-ttu-id="b5b2a-154">當您為此狀況建立其他輸出時，請確定將 `SynchronousInputID` 屬性值設定為整數，以符合元件輸入的 `ID`。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-154">When you create additional outputs for this scenario, make sure to set the value of the `SynchronousInputID` property to the integer that matches the `ID` of the component's input.</span></span>

 <span data-ttu-id="b5b2a-155">`SynchronousInputID` 屬性只有在具有同步輸出的轉換中才有非零值。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-155">The `SynchronousInputID` property has a non-zero value only in transformations with synchronous outputs.</span></span> <span data-ttu-id="b5b2a-156">如果此屬性的值是零，即表示輸出是非同步的。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-156">If the value of this property is zero, it means that the output is asynchronous.</span></span> <span data-ttu-id="b5b2a-157">若是同步輸出，亦即將資料列傳遞到選取的輸出或是沒有加入任何新資料列的輸出，則這個屬性應該會包含元件輸入的 `ID`。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-157">For a synchronous output, where rows are passed through to the selected output or outputs without adding any new rows, this property should contain the `ID` of the component's input.</span></span>

> [!NOTE]
>  <span data-ttu-id="b5b2a-158">當 [**腳本轉換編輯器**] 建立第一個輸出時，編輯器會將 `SynchronousInputID` 輸出的屬性設定為 `ID` 元件輸入的。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-158">When the **Script Transformation Editor** creates the first output, the editor sets the `SynchronousInputID` property of the output to the `ID` of the component's input.</span></span> <span data-ttu-id="b5b2a-159">然而，當編輯器建立後續的輸出時，編輯器會將這些輸出的 `SynchronousInputID` 屬性設定為零。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-159">However, when the editor creates subsequent outputs, the editor sets the `SynchronousInputID` properties of those outputs to zero.</span></span>
> 
>  <span data-ttu-id="b5b2a-160">如果您要建立具有同步輸出的元件，則每個輸出都必須 `SynchronousInputID` 將其屬性設定為 `ID` 元件輸入的。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-160">If you are creating a component with synchronous outputs, each output must have its `SynchronousInputID` property set to the `ID` of the component's input.</span></span> <span data-ttu-id="b5b2a-161">因此，編輯器在第一個輸出之後所建立的每個輸出，都必須將其 `SynchronousInputID` 值從零變更為元件輸入的 `ID`。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-161">Therefore, each output that the editor creates after the first output must have its `SynchronousInputID` value changed from zero to the `ID` of the component's input.</span></span>
> 
>  <span data-ttu-id="b5b2a-162">如果您以非同步輸出建立元件，每個輸出都必須將其 `SynchronousInputID` 屬性設定為零。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-162">If you are creating a component with asynchronous outputs, each output must have its `SynchronousInputID` property set to zero.</span></span> <span data-ttu-id="b5b2a-163">因此，第一個輸出必須將其 `SynchronousInputID` 值從元件的 `ID` 輸入變更為零。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-163">Therefore, the first output must have its `SynchronousInputID` value changed from the `ID` of the component's input to zero.</span></span>

 <span data-ttu-id="b5b2a-164">如需將資料列導向指令碼元件中兩個同步輸出的其中一個的範例，請參閱[使用指令碼元件建立同步轉換](../../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md)。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-164">For an example of directing rows to one of two synchronous outputs in the Script component, see [Creating a Synchronous Transformation with the Script Component](../../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md).</span></span>

### <a name="object-names-in-generated-script"></a><span data-ttu-id="b5b2a-165">產生的指令碼中的物件名稱</span><span class="sxs-lookup"><span data-stu-id="b5b2a-165">Object Names in Generated Script</span></span>
 <span data-ttu-id="b5b2a-166">指令碼元件會剖析輸入與輸出的名稱，並剖析在輸入與輸出中的資料行名稱，而且會根據這些名稱在 BufferWrapper 專案項目中產生類別和屬性。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-166">The Script component parses the names of inputs and outputs, and parse the names of columns in the inputs and outputs, and based on these names generates classes and properties in the BufferWrapper project item.</span></span> <span data-ttu-id="b5b2a-167">如果找到的名稱包括不屬於 Unicode 類別 (`UppercaseLetter`、`LowercaseLetter`、`TitlecaseLetter`、`ModifierLetter`、`OtherLetter` 或 `DecimalDigitLetter`) 的字元，在產生的名稱中會捨棄無效的字元。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-167">If the found names include characters that do not belong to the Unicode categories `UppercaseLetter`, `LowercaseLetter`, `TitlecaseLetter`, `ModifierLetter`, `OtherLetter`, or `DecimalDigitLetter`, the invalid characters are dropped in the generated names.</span></span> <span data-ttu-id="b5b2a-168">例如，空格會予以捨棄，因此具為名稱為 **FirstName** 和 [**First Name**] 的兩個輸入資料行，都會轉譯為具有 **FirstName** 的資料行名稱，並產生無法預測的結果。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-168">For example, spaces are dropped, therefore two input columns that have the names **FirstName** and [**First Name**] are both interpreted as having the column name **FirstName**, with unpredictable results.</span></span> <span data-ttu-id="b5b2a-169">為了避免這個情況，指令碼元件所使用的輸入與輸出的名稱和輸入與輸出資料行的名稱，應該只包含本節中所列的 Unicode 類別裡的字元。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-169">To avoid this situation, the names of inputs and outputs and of input and output columns used by the Script component should contain only characters in the Unicode categories listed in this section.</span></span>

### <a name="script-page-of-the-script-transformation-editor"></a><span data-ttu-id="b5b2a-170">指令碼轉換編輯器的指令碼頁面</span><span class="sxs-lookup"><span data-stu-id="b5b2a-170">Script Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="b5b2a-171">在 [指令碼工作編輯器] 的 [指令碼] 頁面上，為指令碼工作指派一個唯一的名稱與描述。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-171">On the **Script** page of the **Script Task Editor**, you assign a unique name and a description for the Script task.</span></span> <span data-ttu-id="b5b2a-172">您也可以指派下列屬性的值。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-172">You can also assign values for the following properties.</span></span>

> [!NOTE]
>  <span data-ttu-id="b5b2a-173">在 [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] 和更新的版本中，所有指令碼都是先行編譯。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-173">In [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] and later versions, all scripts are precompiled.</span></span> <span data-ttu-id="b5b2a-174">在舊版中，您可以藉由工作的 `Precompile` 屬性，指定指令碼是否已經先行編譯。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-174">In previous versions, you specified whether scripts were precompiled by setting a `Precompile` property for the task.</span></span>

#### <a name="validateexternalmetadata-property"></a><span data-ttu-id="b5b2a-175">ValidateExternalMetadata 屬性</span><span class="sxs-lookup"><span data-stu-id="b5b2a-175">ValidateExternalMetadata Property</span></span>
 <span data-ttu-id="b5b2a-176">`ValidateExternalMetadata` 屬性的布林值可指定元件要在設計階段針對外部資料來源執行驗證，還是將驗證延後到執行階段執行。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-176">The Boolean value of the `ValidateExternalMetadata` property specifies whether the component should perform validation against external data sources at design time, or whether it should postpone validation until run time.</span></span> <span data-ttu-id="b5b2a-177">依預設，此屬性的值是 `True`，也就是，外部中繼資料是在設計階段與執行階段進行驗證。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-177">By default, the value of this property is `True`; that is, the external metadata is validated both at design time and at run time.</span></span> <span data-ttu-id="b5b2a-178">當外部資料來源在設計階段無法使用時，您可能會想要將此屬性的值設定為 `False`：例如，當封裝只在執行階段下載來源或建立目的地時。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-178">You may want to set the value of this property to `False` when an external data source is not available at design time: for example, when the package downloads the source or creates the destination only at run time.</span></span>

#### <a name="readonlyvariables-and-readwritevariables-properties"></a><span data-ttu-id="b5b2a-179">ReadOnlyVariables 與 ReadWriteVariables 屬性</span><span class="sxs-lookup"><span data-stu-id="b5b2a-179">ReadOnlyVariables and ReadWriteVariables Properties</span></span>
 <span data-ttu-id="b5b2a-180">您可以輸入現有變數的逗號分隔清單做為這些屬性的值，使得變數可在指令碼元件程式碼中以唯讀或讀取/寫入的方式來存取。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-180">You can enter comma-delimited lists of existing variables as the values of these properties to make the variables available for read-only or read/write access within the Script component code.</span></span> <span data-ttu-id="b5b2a-181">在程式碼中，變數是透過自動產生的基底類別之 <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadOnlyVariables%2A> 與 <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadWriteVariables%2A> 屬性來存取。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-181">Variables are accessed in code through the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadOnlyVariables%2A> and <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadWriteVariables%2A> properties of the autogenerated base class.</span></span> <span data-ttu-id="b5b2a-182">如需詳細資訊，請參閱[在指令碼元件中使用變數](using-variables-in-the-script-component.md)。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-182">For more information, see [Using Variables in the Script Component](using-variables-in-the-script-component.md).</span></span>

> [!NOTE]
>  <span data-ttu-id="b5b2a-183">變數名稱會區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-183">Variable names are case-sensitive.</span></span>

#### <a name="scriptlanguage"></a><span data-ttu-id="b5b2a-184">ScriptLanguage</span><span class="sxs-lookup"><span data-stu-id="b5b2a-184">ScriptLanguage</span></span>
 <span data-ttu-id="b5b2a-185">您可以選擇使用 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic 或 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# 做為指令碼元件的程式設計語言。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-185">You can select either [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic or [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# as the programming language for the Script component.</span></span>

#### <a name="edit-script-button"></a><span data-ttu-id="b5b2a-186">編輯指令碼按鈕</span><span class="sxs-lookup"><span data-stu-id="b5b2a-186">Edit Script Button</span></span>
 <span data-ttu-id="b5b2a-187">[編輯指令碼]  按鈕會開啟 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools for Applications (VSTA) IDE，您可以在此撰寫自訂指令碼。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-187">The **Edit Script** button opens the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools for Applications (VSTA) IDE in which you write your custom script.</span></span> <span data-ttu-id="b5b2a-188">如需詳細資訊，請參閱[編碼和偵錯指令碼元件](coding-and-debugging-the-script-component.md)。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-188">For more information, see [Coding and Debugging the Script Component](coding-and-debugging-the-script-component.md).</span></span>

### <a name="connection-managers-page-of-the-script-transformation-editor"></a><span data-ttu-id="b5b2a-189">指令碼轉換編輯器的連接管理員頁面</span><span class="sxs-lookup"><span data-stu-id="b5b2a-189">Connection Managers Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="b5b2a-190">在 [指令碼轉換編輯器] 的 [連線管理員] 頁面上，您可以新增和移除要在自訂指令碼中使用的連線管理員。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-190">On the **Connection Managers** page of the **Script Transformation Editor**, you add and remove connection managers that you want to use in your custom script.</span></span> <span data-ttu-id="b5b2a-191">一般而言，您需要在建立來源或是目的地元件時，參考連接管理員。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-191">Normally you need to reference connection managers when you create a source or destination component.</span></span>

 <span data-ttu-id="b5b2a-192">在將會根據此中繼資料產生的程式碼專案中，`ComponentWrapper` 專案項目包含 `Connections` 集合類別，這個類別對於每個選取的連接管理員，都有具類型的存取子屬性。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-192">In the code project that will be generated based on this metadata, the `ComponentWrapper` project item contains a `Connections` collection class that has a typed accessor property for each selected connection manager.</span></span> <span data-ttu-id="b5b2a-193">每個具類型的存取子屬性都有做為連接管理員的相同名稱，並且會傳回連接管理員參考做為 <xref:Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100> 的執行個體。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-193">Each typed accessor property has the same name as the connection manager itself and returns a reference to the connection manager as an instance of <xref:Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100>.</span></span> <span data-ttu-id="b5b2a-194">例如，如果您已在編輯器的 [連線管理員] 頁面中新增名為 `MyADONETConnection` 的連線管理員，就可以使用下列程式碼，取得指令碼中連線管理員的參考：</span><span class="sxs-lookup"><span data-stu-id="b5b2a-194">For example, if you have added a connection manager named `MyADONETConnection` on the **Connection Managers** page of the editor, you can obtain a reference to the connection manager in your script by using the following code:</span></span>

```vb
Dim myADONETConnectionManager As IDTSConnectionManager100 = _
    Me.Connections.MyADONETConnection
```

 <span data-ttu-id="b5b2a-195">如需詳細資訊，請參閱[在指令碼元件中連線至資料來源](connecting-to-data-sources-in-the-script-component.md)。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-195">For more information, see [Connecting to Data Sources in the Script Component](connecting-to-data-sources-in-the-script-component.md).</span></span>

<span data-ttu-id="b5b2a-196">![Integration Services 圖示 (小型) ](../../media/dts-16.gif "Integration Services 圖示 (小)")會**保持最**新狀態 Integration Services  </span><span class="sxs-lookup"><span data-stu-id="b5b2a-196">![Integration Services icon (small)](../../media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="b5b2a-197">若要取得 Microsoft 的最新下載、文件、範例和影片以及社群中的精選解決方案，請瀏覽 MSDN 上的 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] 頁面：</span><span class="sxs-lookup"><span data-stu-id="b5b2a-197">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="b5b2a-198">瀏覽 MSDN 上的 Integration Services 頁面</span><span class="sxs-lookup"><span data-stu-id="b5b2a-198">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="b5b2a-199">若要得到這些更新的自動通知，請訂閱該頁面上所提供的 RSS 摘要。</span><span class="sxs-lookup"><span data-stu-id="b5b2a-199">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>

## <a name="see-also"></a><span data-ttu-id="b5b2a-200">另請參閱</span><span class="sxs-lookup"><span data-stu-id="b5b2a-200">See Also</span></span>
 [<span data-ttu-id="b5b2a-201">編碼和偵錯指令碼元件</span><span class="sxs-lookup"><span data-stu-id="b5b2a-201">Coding and Debugging the Script Component</span></span>](coding-and-debugging-the-script-component.md)


