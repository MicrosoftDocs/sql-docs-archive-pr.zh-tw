---
title: 語法 (SSIS) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- expressions [Integration Services], syntax
- syntax [Integration Services]
ms.assetid: 61c053c5-1182-4ad0-b804-51cbd19aa0ba
author: chugugrace
ms.author: chugu
ms.openlocfilehash: d7be12ee5e0467e3789fbe2771d881d9ae3f25f3
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87701353"
---
# <a name="syntax-ssis"></a><span data-ttu-id="89f30-102">語法 (SSIS)</span><span class="sxs-lookup"><span data-stu-id="89f30-102">Syntax (SSIS)</span></span>
  <span data-ttu-id="89f30-103">[!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 運算式語法與 C 和 C# 語言使用的語法類似。</span><span class="sxs-lookup"><span data-stu-id="89f30-103">The [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] expression syntax is similar to the syntax that the C and C# languages use.</span></span> <span data-ttu-id="89f30-104">運算式的元素包括識別碼 (資料行和變數)、常值、運算子以及函數。</span><span class="sxs-lookup"><span data-stu-id="89f30-104">Expressions include elements such as identifiers (columns and variables), literals, operators, and functions.</span></span> <span data-ttu-id="89f30-105">本主題摘要說明運算式評估工具語法套用至不同運算式元素時的獨特需求。</span><span class="sxs-lookup"><span data-stu-id="89f30-105">This topic summarizes the unique requirements of the expression evaluator syntax as they apply to different expression elements.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="89f30-106">在舊版 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]中，當運算式的評估結果具有 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 資料類型 DT_WSTR 或 DT_STR 時，結果就會具有 4000 個字元的限制。</span><span class="sxs-lookup"><span data-stu-id="89f30-106">In previous releases of [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)], there was a 4000-character limit on the evaluation result of an expression when the result had the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] data type DT_WSTR or DT_STR.</span></span> <span data-ttu-id="89f30-107">這項限制已移除。</span><span class="sxs-lookup"><span data-stu-id="89f30-107">This limit has been removed.</span></span>  
  
 <span data-ttu-id="89f30-108">如需使用特定運算子及函數的範例運算式，請參閱下列主題中每個運算子及函數的相關主題：[運算子 &#40;SSIS 運算式&#41;](operators-ssis-expression.md) 和[函數 &#40;SSIS 運算式&#41;](functions-ssis-expression.md)。</span><span class="sxs-lookup"><span data-stu-id="89f30-108">For sample expressions that use specific operators and functions, see the topic about each operator and function in the topics: [Operators &#40;SSIS Expression&#41;](operators-ssis-expression.md) and [Functions &#40;SSIS Expression&#41;](functions-ssis-expression.md).</span></span>  
  
 <span data-ttu-id="89f30-109">如需使用多個運算子、函數以及識別碼和常值的範例運算式，請參閱 [進階 Integration Services 運算式範例](examples-of-advanced-integration-services-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="89f30-109">For sample expressions that use multiple operators and functions as well as identifiers and literals, see [Examples of Advanced Integration Services Expressions](examples-of-advanced-integration-services-expressions.md).</span></span>  
  
 <span data-ttu-id="89f30-110">如需屬性運算式中使用的範例運算式，請參閱 [在封裝中使用屬性運算式](use-property-expressions-in-packages.md)。</span><span class="sxs-lookup"><span data-stu-id="89f30-110">For sample expressions to use in property expressions, see [Use Property Expressions in Packages](use-property-expressions-in-packages.md).</span></span>  
  
## <a name="identifiers"></a><span data-ttu-id="89f30-111">識別碼</span><span class="sxs-lookup"><span data-stu-id="89f30-111">Identifiers</span></span>  
 <span data-ttu-id="89f30-112">運算式可以包括資料行和變數識別碼。</span><span class="sxs-lookup"><span data-stu-id="89f30-112">Expressions can include column and variable identifiers.</span></span> <span data-ttu-id="89f30-113">資料行可在資料來源中產生，或在資料流程中藉由轉換建立。</span><span class="sxs-lookup"><span data-stu-id="89f30-113">The columns can originate in the data source or can be created by transformations in the data flow.</span></span> <span data-ttu-id="89f30-114">運算式可以使用歷程識別碼來參考資料行。</span><span class="sxs-lookup"><span data-stu-id="89f30-114">Expressions can use lineage identifiers to refer to columns.</span></span> <span data-ttu-id="89f30-115">歷程識別碼是用來識別封裝元素的唯一號碼。</span><span class="sxs-lookup"><span data-stu-id="89f30-115">Lineage identifiers are numbers that uniquely identify package elements.</span></span> <span data-ttu-id="89f30-116">運算式中參考的歷程識別碼必須包括井字號 (#) 前置詞。</span><span class="sxs-lookup"><span data-stu-id="89f30-116">Lineage identifiers, referenced in an expression, must include the pound (#) prefix.</span></span> <span data-ttu-id="89f30-117">例如，歷程識別碼 138 是使用 #138 參考。</span><span class="sxs-lookup"><span data-stu-id="89f30-117">For example, the lineage identifier 138 is referenced using #138.</span></span>  
  
 <span data-ttu-id="89f30-118">運算式可包括 [!INCLUDE[ssIS](../../includes/ssis-md.md)] 提供的系統變數和自訂變數。</span><span class="sxs-lookup"><span data-stu-id="89f30-118">Expressions can include the system variables that [!INCLUDE[ssIS](../../includes/ssis-md.md)] provides and custom variables.</span></span> <span data-ttu-id="89f30-119">在運算式中參考變數時，必須包括 \@ 前置詞。</span><span class="sxs-lookup"><span data-stu-id="89f30-119">Variables, when referenced in an expression, must include the \@ prefix.</span></span> <span data-ttu-id="89f30-120">例如，`Counter` 變數是使用 \@Counter 來參考。</span><span class="sxs-lookup"><span data-stu-id="89f30-120">For example, the `Counter` variable is referenced using \@Counter.</span></span> <span data-ttu-id="89f30-121">\@ 字元並非變數名稱的一部分；該字元僅用來向運算式評估工具表示該識別碼為變數。</span><span class="sxs-lookup"><span data-stu-id="89f30-121">The \@ character is not part of the variable name; it only indicates to the expression evaluator that the identifier is a variable.</span></span> <span data-ttu-id="89f30-122">如需詳細資訊，請參閱[識別碼 &#40;SSIS&#41;](identifiers-ssis.md)。</span><span class="sxs-lookup"><span data-stu-id="89f30-122">For more information, see [Identifiers &#40;SSIS&#41;](identifiers-ssis.md).</span></span>  
  
## <a name="literals"></a><span data-ttu-id="89f30-123">常值</span><span class="sxs-lookup"><span data-stu-id="89f30-123">Literals</span></span>  
 <span data-ttu-id="89f30-124">運算式可以包含數值、字串及布林常值。</span><span class="sxs-lookup"><span data-stu-id="89f30-124">Expressions can include numeric, string, and Boolean literals.</span></span> <span data-ttu-id="89f30-125">運算式中使用的字串常值必須加上引號。</span><span class="sxs-lookup"><span data-stu-id="89f30-125">String literals used in expressions must be enclosed in quotation marks.</span></span> <span data-ttu-id="89f30-126">數值和布林常值則不使用引號。</span><span class="sxs-lookup"><span data-stu-id="89f30-126">Numeric and Boolean literals do not take quotation marks.</span></span> <span data-ttu-id="89f30-127">運算式語言包括常逸出之字元的逸出序列。</span><span class="sxs-lookup"><span data-stu-id="89f30-127">The expression language includes escape sequences for characters that are frequently escaped.</span></span> <span data-ttu-id="89f30-128">如需詳細資訊，請參閱[常值 &#40;SSIS&#41;](numeric-string-and-boolean-literals.md)。</span><span class="sxs-lookup"><span data-stu-id="89f30-128">For more information, see [Literals &#40;SSIS&#41;](numeric-string-and-boolean-literals.md).</span></span>  
  
## <a name="operators"></a><span data-ttu-id="89f30-129">操作員</span><span class="sxs-lookup"><span data-stu-id="89f30-129">Operators</span></span>  
 <span data-ttu-id="89f30-130">運算式評估工具包含一組運算子，提供與 Transact-SQL、C++ 和 C# 語言中運算子類似的功能。</span><span class="sxs-lookup"><span data-stu-id="89f30-130">The expression evaluator provides a set of operators that provides functionality similar to the set of operators in languages such as Transact-SQL, C++, and C#.</span></span> <span data-ttu-id="89f30-131">不過，運算式語言還包括額外的運算子，並且使用您可能不熟悉的不同符號。</span><span class="sxs-lookup"><span data-stu-id="89f30-131">However, the expression language includes additional operators and uses different symbols than those you may be familiar with.</span></span> <span data-ttu-id="89f30-132">如需詳細資訊，請參閱[運算子 &#40;SSIS 運算式&#41;](operators-ssis-expression.md)。</span><span class="sxs-lookup"><span data-stu-id="89f30-132">For more information, see [Operators &#40;SSIS Expression&#41;](operators-ssis-expression.md).</span></span>  
  
### <a name="namespace-resolution-operator"></a><span data-ttu-id="89f30-133">命名空間解析運算子</span><span class="sxs-lookup"><span data-stu-id="89f30-133">Namespace Resolution Operator</span></span>  
 <span data-ttu-id="89f30-134">運算式使用命名空間解析運算子 (::) 使相同名稱的變數意義明確。</span><span class="sxs-lookup"><span data-stu-id="89f30-134">Expressions use the namespace resolution operator (::) to disambiguate variables that have the same name.</span></span> <span data-ttu-id="89f30-135">藉由使用命名空間解析運算子，您可以利用變數的命名空間限定變數，如此即可在封裝中使用多個相同名稱的變數。</span><span class="sxs-lookup"><span data-stu-id="89f30-135">By using the namespace resolution operator, you can qualify the variable with its namespace, which makes it possible to use multiple variables with the same name in a package.</span></span>  
  
#### <a name="cast-operator"></a><span data-ttu-id="89f30-136">轉換運算子</span><span class="sxs-lookup"><span data-stu-id="89f30-136">Cast Operator</span></span>  
 <span data-ttu-id="89f30-137">轉換運算子會將運算式結果、資料行值、變數值以及常數從一種資料類型轉換為另一種。</span><span class="sxs-lookup"><span data-stu-id="89f30-137">The cast operator converts expression results, column values, variable values, and constants from one data type to another.</span></span> <span data-ttu-id="89f30-138">運算式語言提供的轉換運算子與 C 和 C# 語言提供的轉換運算子類似。</span><span class="sxs-lookup"><span data-stu-id="89f30-138">The cast operator provided by the expression language is similar to the one provided by the C and C# languages.</span></span> <span data-ttu-id="89f30-139">在 Transact-SQL 中，CAST 和 CONVERT 函數即提供此功能。</span><span class="sxs-lookup"><span data-stu-id="89f30-139">In Transact-SQL, the CAST and CONVERT functions provide this functionality.</span></span> <span data-ttu-id="89f30-140">轉換運算子的語法與 CAST 和 CONVERT 所使用的語法不同之處如下：</span><span class="sxs-lookup"><span data-stu-id="89f30-140">The syntax of the cast operator is different from ones used by CAST and CONVERT in the following ways:</span></span>  
  
-   <span data-ttu-id="89f30-141">它可使用運算式作為引數。</span><span class="sxs-lookup"><span data-stu-id="89f30-141">It can use an expression as an argument.</span></span>  
  
-   <span data-ttu-id="89f30-142">其語法不包括 CAST 關鍵字。</span><span class="sxs-lookup"><span data-stu-id="89f30-142">Its syntax does not include the CAST keyword.</span></span>  
  
-   <span data-ttu-id="89f30-143">其語法不包括 AS 關鍵字。</span><span class="sxs-lookup"><span data-stu-id="89f30-143">Its syntax does not include the AS keyword.</span></span>  
  
##### <a name="conditional-operator"></a><span data-ttu-id="89f30-144">條件運算子</span><span class="sxs-lookup"><span data-stu-id="89f30-144">Conditional Operator</span></span>  
 <span data-ttu-id="89f30-145">條件運算子會根據布林運算式的評估，傳回兩種運算式的其中一種。</span><span class="sxs-lookup"><span data-stu-id="89f30-145">The conditional operator returns one of two expressions, based on the evaluation of a Boolean expression.</span></span> <span data-ttu-id="89f30-146">運算式語言提供的條件運算子與 C 和 C# 語言提供的條件運算子類似。</span><span class="sxs-lookup"><span data-stu-id="89f30-146">The conditional operator provided by the expression language is similar to the one provided by the C and C# languages.</span></span> <span data-ttu-id="89f30-147">在多維度運算式 (MDX) 中，IIF 函數即提供類似的功能。</span><span class="sxs-lookup"><span data-stu-id="89f30-147">In multidimensional expressions (MDX), the IIF function provides similar functionality.</span></span>  
  
###### <a name="logical-operators"></a><span data-ttu-id="89f30-148">邏輯運算子</span><span class="sxs-lookup"><span data-stu-id="89f30-148">Logical Operators</span></span>  
 <span data-ttu-id="89f30-149">運算式語言支援邏輯 NOT 運算子所使用的 !</span><span class="sxs-lookup"><span data-stu-id="89f30-149">The expression language supports the !</span></span> <span data-ttu-id="89f30-150">字元。</span><span class="sxs-lookup"><span data-stu-id="89f30-150">character for the logical NOT operator.</span></span> <span data-ttu-id="89f30-151">在 Transact-SQL 中，!</span><span class="sxs-lookup"><span data-stu-id="89f30-151">In Transact-SQL, the !</span></span> <span data-ttu-id="89f30-152">運算子內建在一組關係運算子中。</span><span class="sxs-lookup"><span data-stu-id="89f30-152">operator is built into the set of relational operators.</span></span> <span data-ttu-id="89f30-153">例如，Transact-SQL 提供 > 和 !> 運算子。</span><span class="sxs-lookup"><span data-stu-id="89f30-153">For example, Transact-SQL provides the > and the !> operators.</span></span> <span data-ttu-id="89f30-154">[!INCLUDE[ssIS](../../includes/ssis-md.md)] 運算式語言不支援 ! 運算子和其他</span><span class="sxs-lookup"><span data-stu-id="89f30-154">The [!INCLUDE[ssIS](../../includes/ssis-md.md)] expression language does not support the combination of the !</span></span> <span data-ttu-id="89f30-155">運算子的組合。</span><span class="sxs-lookup"><span data-stu-id="89f30-155">operator and other operators.</span></span> <span data-ttu-id="89f30-156">例如，將 ! 和 > 結合至 !> 則</span><span class="sxs-lookup"><span data-stu-id="89f30-156">For example, it is not valid to combine !</span></span> <span data-ttu-id="89f30-157">無效。</span><span class="sxs-lookup"><span data-stu-id="89f30-157">and > into !>.</span></span> <span data-ttu-id="89f30-158">不過，針對不等於 (not-equal-to) 比較，運算式語言支援內建的 != 字元組合。</span><span class="sxs-lookup"><span data-stu-id="89f30-158">However, the expression language does support a built-in != combination of characters for the not-equal-to comparison.</span></span>  
  
###### <a name="equality-operators"></a><span data-ttu-id="89f30-159">相等運算子</span><span class="sxs-lookup"><span data-stu-id="89f30-159">Equality Operators</span></span>  
 <span data-ttu-id="89f30-160">運算式評估工具文法描述提供 == 相等運算子。</span><span class="sxs-lookup"><span data-stu-id="89f30-160">The expression evaluator grammar provides the == equality operator.</span></span> <span data-ttu-id="89f30-161">此運算子相當於 Transact-SQL 中的 = 運算子以及 C# 中的 == 運算子。</span><span class="sxs-lookup"><span data-stu-id="89f30-161">This operator is the equivalent of the = operator in Transact-SQL and the == operator in C#.</span></span>  
  
## <a name="functions"></a><span data-ttu-id="89f30-162">Functions</span><span class="sxs-lookup"><span data-stu-id="89f30-162">Functions</span></span>  
 <span data-ttu-id="89f30-163">運算式語言包括與 Transact-SQL 函數和 C# 方法類似的日期和時間函數、數學函數以及字串函數。</span><span class="sxs-lookup"><span data-stu-id="89f30-163">The expression language includes date and time functions, mathematical functions, and string functions that are similar to Transact-SQL functions and C# methods.</span></span>  
  
 <span data-ttu-id="89f30-164">其中有少數函數的名稱與 Transact-SQL 函數相同，但是在運算式評估工具中其功能則稍有不同。</span><span class="sxs-lookup"><span data-stu-id="89f30-164">A few functions have the same names as Transact-SQL functions, but have subtly different functionality in the expression evaluator.</span></span>  
  
-   <span data-ttu-id="89f30-165">在 Transact-SQL 中，ISNULL 函數會以指定的值取代 Null 值，而運算式評估工具 ISNULL 函數則根據運算式是否為 Null 傳回布林。</span><span class="sxs-lookup"><span data-stu-id="89f30-165">In Transact-SQL, the ISNULL function replaces null values with a specified value, whereas the expression evaluator ISNULL function returns a Boolean based on whether an expression is null.</span></span>  
  
-   <span data-ttu-id="89f30-166">在 Transact-SQL 中，ROUND 函數包括截斷結果集的選項，而運算式評估工具 ROUND 函數則沒有。</span><span class="sxs-lookup"><span data-stu-id="89f30-166">In Transact-SQL, the ROUND function includes an option to truncate the result set, whereas the expression evaluator ROUND function does not.</span></span>  
  
 <span data-ttu-id="89f30-167">如需詳細資訊，請參閱[函數 &#40;SSIS 運算式&#41;](functions-ssis-expression.md)。</span><span class="sxs-lookup"><span data-stu-id="89f30-167">For more information, see [Functions &#40;SSIS Expression&#41;](functions-ssis-expression.md).</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="89f30-168">相關工作</span><span class="sxs-lookup"><span data-stu-id="89f30-168">Related Tasks</span></span>  
 [<span data-ttu-id="89f30-169">在資料流程元件中使用運算式</span><span class="sxs-lookup"><span data-stu-id="89f30-169">Use an Expression in a Data Flow Component</span></span>](../use-an-expression-in-a-data-flow-component.md)  
  
## <a name="related-content"></a><span data-ttu-id="89f30-170">相關內容</span><span class="sxs-lookup"><span data-stu-id="89f30-170">Related Content</span></span>  
  
-   <span data-ttu-id="89f30-171">pragmaticworks.com 上的技術文件： [SSIS 運算式小抄](https://pragmaticworks.com/Resources/Cheat-Sheets/SSIS-Expression-Cheat-Sheet)</span><span class="sxs-lookup"><span data-stu-id="89f30-171">Technical article, [SSIS Expression Cheat Sheet](https://pragmaticworks.com/Resources/Cheat-Sheets/SSIS-Expression-Cheat-Sheet), on pragmaticworks.com</span></span>  
  
-   <span data-ttu-id="89f30-172">social.technet.microsoft.com 上的技術文件： [SSIS 運算式範例](https://go.microsoft.com/fwlink/?LinkId=220761)</span><span class="sxs-lookup"><span data-stu-id="89f30-172">Technical article, [SSIS Expression Examples](https://go.microsoft.com/fwlink/?LinkId=220761), on social.technet.microsoft.com</span></span>  
  
  
