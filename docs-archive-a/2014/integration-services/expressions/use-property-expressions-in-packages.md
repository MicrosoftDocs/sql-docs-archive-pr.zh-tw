---
title: 在套件中使用屬性運算式 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- packages [Integration Services], expressions
- Integration Services packages, expressions
- SQL Server Integration Services packages, expressions
- dynamic properties
- updating package properties
- SSIS packages, expressions
- expressions [Integration Services], property expressions
- property expressions [Integration Services]
ms.assetid: a4bfc925-3ef6-431e-b1dd-7e0023d3a92d
author: chugugrace
ms.author: chugu
ms.openlocfilehash: bb373428e91cfc8cb4b26a986da6d795ab2fea98
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87598504"
---
# <a name="use-property-expressions-in-packages"></a><span data-ttu-id="96d53-102">在封裝中使用屬性運算式</span><span class="sxs-lookup"><span data-stu-id="96d53-102">Use Property Expressions in Packages</span></span>
  <span data-ttu-id="96d53-103">屬性運算式是指派給屬性的運算式，用於在執行階段啟用該屬性的動態更新。</span><span class="sxs-lookup"><span data-stu-id="96d53-103">A property expression is an expression that is assigned to a property to enable dynamic update of the property at run time.</span></span> <span data-ttu-id="96d53-104">例如，屬性運算式可更新「收件者」欄位，傳送郵件工作透過插入儲存在變數中的電子郵件地址來使用該欄位。</span><span class="sxs-lookup"><span data-stu-id="96d53-104">For example, a property expression can update the To line that a Send Mail task uses by inserting an e-mail address that is stored in a variable.</span></span>

 <span data-ttu-id="96d53-105">運算式可加入封裝、工作、「Foreach 迴圈」、「For 迴圈」、「時序」、Foreach 列舉值、事件處理常式、封裝或專案層級的連接管理員或記錄提供者中。</span><span class="sxs-lookup"><span data-stu-id="96d53-105">An expression can be added to a package, task, Foreach Loop, For Loop, Sequence, Foreach enumerator, event handler, a package or project level connection manager, or log provider.</span></span> <span data-ttu-id="96d53-106">此物件任何為讀取/寫入的屬性，都可以實作屬性運算式。</span><span class="sxs-lookup"><span data-stu-id="96d53-106">Any property of these objects that is read/write can implement a property expression.</span></span> [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] <span data-ttu-id="96d53-107">也支援在資料流程元件的某些自訂屬性中，使用屬性運算式。</span><span class="sxs-lookup"><span data-stu-id="96d53-107">also supports the use of property expressions in some custom properties of data flow components.</span></span> <span data-ttu-id="96d53-108">變數和優先順序條件約束不支援屬性運算式，但是它們包含您可以在其中使用運算式的特殊屬性。</span><span class="sxs-lookup"><span data-stu-id="96d53-108">Variables and precedence constraints do not support property expressions, but they include special properties in which you can use expressions.</span></span>

 <span data-ttu-id="96d53-109">屬性運算式可以使用下列不同的方式進行更新：</span><span class="sxs-lookup"><span data-stu-id="96d53-109">Property expressions can be updated in different ways:</span></span>

-   <span data-ttu-id="96d53-110">使用者定義變數可包含在封裝組態中，然後在部署封裝時進行更新。</span><span class="sxs-lookup"><span data-stu-id="96d53-110">User-defined variables can be included in package configurations and then updated when the package is deployed.</span></span> <span data-ttu-id="96d53-111">在執行階段，會使用更新的變數值來評估屬性運算式。</span><span class="sxs-lookup"><span data-stu-id="96d53-111">At run time, the property expression is evaluated using the updated variable value.</span></span>

-   <span data-ttu-id="96d53-112">在執行階段更新包含在運算式中的系統變數，這樣會變更屬性評估的結果。</span><span class="sxs-lookup"><span data-stu-id="96d53-112">System variables that are included in expressions are updated at run time, which changes the results of the property evaluation.</span></span>

-   <span data-ttu-id="96d53-113">在執行階段評估日期和時間函數，並將更新的值提供給屬性運算式。</span><span class="sxs-lookup"><span data-stu-id="96d53-113">Date and time functions are evaluated at run time and provide the updated values to property expressions.</span></span>

-   <span data-ttu-id="96d53-114">運算式中的變數可由指令碼工作和「指令碼」元件所執行的指令碼進行更新。</span><span class="sxs-lookup"><span data-stu-id="96d53-114">Variables in expressions can be updated by the scripts that the Script task and the Script component run.</span></span>

 <span data-ttu-id="96d53-115">運算式是使用 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] 運算式語言所建立。</span><span class="sxs-lookup"><span data-stu-id="96d53-115">The expressions are built using the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] expression language.</span></span> <span data-ttu-id="96d53-116">這些運算式可以使用系統變數或使用者定義變數，以及運算式語言提供的運算子、函數和類型轉換。</span><span class="sxs-lookup"><span data-stu-id="96d53-116">The expressions can use system or user-defined variables, together with the operators, functions, and type casts that the expression language provides.</span></span>

> [!NOTE]
>  <span data-ttu-id="96d53-117">使用者定義變數和系統變數的名稱會區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="96d53-117">The names of user-defined and system variables are case-sensitive.</span></span>

 <span data-ttu-id="96d53-118">如需詳細資訊，請參閱 [Integration Services &#40;SSIS&#41; 運算式](integration-services-ssis-expressions.md)為止。</span><span class="sxs-lookup"><span data-stu-id="96d53-118">For more information, see [Integration Services &#40;SSIS&#41; Expressions](integration-services-ssis-expressions.md).</span></span>

 <span data-ttu-id="96d53-119">屬性運算式的重要用法是為封裝之每個部署的執行個體自訂組態。</span><span class="sxs-lookup"><span data-stu-id="96d53-119">An important use of property expressions is to customize configurations for each deployed instance of a package.</span></span> <span data-ttu-id="96d53-120">這樣可以動態地更新不同環境的封裝屬性。</span><span class="sxs-lookup"><span data-stu-id="96d53-120">This makes it possible to dynamically update package properties for different environments.</span></span> <span data-ttu-id="96d53-121">例如，您可以建立將變數指派給連接管理員之連接字串的屬性運算式，然後在部署封裝時更新該變數，以確保連接字串在執行階段是正確的。</span><span class="sxs-lookup"><span data-stu-id="96d53-121">For example, you can create a property expression that assigns a variable to the connection string of a connection manager, and then update the variable when the package is deployed, ensuring that the connection string is correct at run time.</span></span> <span data-ttu-id="96d53-122">在評估屬性運算式前會載入封裝組態。</span><span class="sxs-lookup"><span data-stu-id="96d53-122">Package configurations are loaded before the property expressions are evaluated.</span></span>

 <span data-ttu-id="96d53-123">屬性只可使用一個屬性運算式，而屬性運算式只可套用至一個屬性。</span><span class="sxs-lookup"><span data-stu-id="96d53-123">A property can use only one property expression and a property expression can apply only to one property.</span></span> <span data-ttu-id="96d53-124">不過，您可以建立多個相同的屬性運算式，並將它們指派給不同的屬性。</span><span class="sxs-lookup"><span data-stu-id="96d53-124">However, you can build multiple identical property expressions and assign them to different properties.</span></span>

 <span data-ttu-id="96d53-125">部分屬性是使用於自列舉值的值加以設定。</span><span class="sxs-lookup"><span data-stu-id="96d53-125">Some properties are set by using values from enumerators.</span></span> <span data-ttu-id="96d53-126">在屬性運算式中參考列舉值成員時，您必須使用相當於列舉值成員之易記名稱的數值。</span><span class="sxs-lookup"><span data-stu-id="96d53-126">When you reference the enumerator member in a property expression, you must use the numeric value that is equivalent to the friendly name of the enumerator member.</span></span> <span data-ttu-id="96d53-127">例如，如果屬性運算式設定 `LoggingMode` 屬性，而該屬性使用於自 `DTSLoggingMode` 列舉的值，則屬性運算式就必須使用 0、1 或 2 來取代易記名稱 `Enabled`、`Disabled` 或 `UseParentSetting`。</span><span class="sxs-lookup"><span data-stu-id="96d53-127">For example, if a property expression sets the `LoggingMode` property, which uses a value from the `DTSLoggingMode` enumeration, the property expression must use 0, 1, or 2 instead of the friendly names `Enabled`, `Disabled`, or `UseParentSetting`.</span></span> <span data-ttu-id="96d53-128">如需詳細資訊，請參閱 [屬性運算式中的列舉常數](enumerated-constants-in-property-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="96d53-128">For more information, see [Enumerated Constants in Property Expressions](enumerated-constants-in-property-expressions.md).</span></span>

## <a name="property-expression-user-interface"></a><span data-ttu-id="96d53-129">屬性運算式使用者介面</span><span class="sxs-lookup"><span data-stu-id="96d53-129">Property Expression User Interface</span></span>
 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] <span data-ttu-id="96d53-130">提供一組用於建立和管理屬性運算式的工具。</span><span class="sxs-lookup"><span data-stu-id="96d53-130">provides a set of tools for building and managing property expressions.</span></span>

-   <span data-ttu-id="96d53-131">[運算式]  頁面，位於工作的自訂編輯器、For 迴圈容器和 Foreach 容器中。</span><span class="sxs-lookup"><span data-stu-id="96d53-131">The **Expressions** page, found in the custom editors for tasks, the For Loop container, and the Foreach containers.</span></span> <span data-ttu-id="96d53-132">該 [運算式]  頁面可讓您編輯運算式，以及檢視工作、Foreach 迴圈或 For 迴圈所使用的屬性運算式清單。</span><span class="sxs-lookup"><span data-stu-id="96d53-132">The **Expressions** page lets you edit expressions and view a list of the property expressions that a task, Foreach Loop, or For Loop uses.</span></span>

-   <span data-ttu-id="96d53-133">[屬性]  視窗，用於編輯運算式及檢視封裝或封裝物件所使用的屬性運算式清單。</span><span class="sxs-lookup"><span data-stu-id="96d53-133">The **Properties** window, for editing expressions and viewing a list of the property expressions that a package or package objects use.</span></span>

-   <span data-ttu-id="96d53-134">[屬性運算式編輯器]  對話方塊，用於建立、更新和刪除屬性運算式。</span><span class="sxs-lookup"><span data-stu-id="96d53-134">The **Property Expressions Editor** dialog box, for creating, updating, and deleting property expressions.</span></span>

-   <span data-ttu-id="96d53-135">[運算式產生器]  對話方塊，用於使用圖形工具建立運算式。</span><span class="sxs-lookup"><span data-stu-id="96d53-135">The **Expression Builder** dialog box, for building an expression using graphical tools.</span></span> <span data-ttu-id="96d53-136">該 [運算式產生器]  對話方塊可評估運算式以供您檢閱，而無需將評估結果指派給屬性。</span><span class="sxs-lookup"><span data-stu-id="96d53-136">The **Expression Builder** dialog box can evaluate expressions for your review without assigning the evaluation result to the property.</span></span>

 <span data-ttu-id="96d53-137">下圖顯示用於加入、變更及移除屬性運算式的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="96d53-137">The following diagram shows the user interfaces that you use to add, change, and remove property expressions.</span></span>

 <span data-ttu-id="96d53-138">![屬性運算式的使用者介面](../media/ssis-propertyexpressionui.gif "屬性運算式的使用者介面")</span><span class="sxs-lookup"><span data-stu-id="96d53-138">![The user interface for property expressions](../media/ssis-propertyexpressionui.gif "The user interface for property expressions")</span></span>

 <span data-ttu-id="96d53-139">在 [屬性] 視窗和 [運算式] 頁面上，按一下 [運算式] 集合層級上的瀏覽按鈕 ([...])，以開啟 [屬性運算式編輯器] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="96d53-139">In the **Properties** window and the **Expressions** page, click the browse button **(...)** at the **Expressions** collection level to open the **Property Expressions Editor** dialog box.</span></span> <span data-ttu-id="96d53-140">[屬性運算式編輯器] 可讓您將屬性對應至運算式，並輸入屬性運算式。</span><span class="sxs-lookup"><span data-stu-id="96d53-140">The Property Expressions Editor allows you to map a property to an expression and to type a property expression.</span></span> <span data-ttu-id="96d53-141">如果您想要使用圖形運算式工具來建立並驗證運算式，請按一下運算式層級上的瀏覽按鈕 ([...])  ，以開啟 [運算式產生器]  對話方塊，然後再建立或修改並選擇性地驗證運算式。</span><span class="sxs-lookup"><span data-stu-id="96d53-141">If you want to use the graphical expression tools to create and then validate the expression, click the browse button **(...)** at the expression level to open the **Expression Builder** dialog box, and then create or modify and optionally validate the expression.</span></span>

 <span data-ttu-id="96d53-142">您還可以從 [屬性運算式編輯器] 對話方塊，開啟 [運算式產生器] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="96d53-142">You can also open the **Expression Builder** dialog box from the **Property Expressions Editor** dialog box.</span></span>

#### <a name="to-work-with-property-expressions"></a><span data-ttu-id="96d53-143">處理屬性運算式</span><span class="sxs-lookup"><span data-stu-id="96d53-143">To work with property expressions</span></span>

-   [<span data-ttu-id="96d53-144">新增或變更屬性運算式</span><span class="sxs-lookup"><span data-stu-id="96d53-144">Add or Change a Property Expression</span></span>](add-or-change-a-property-expression.md)

### <a name="setting-property-expressions-of-data-flow-components"></a><span data-ttu-id="96d53-145">設定資料流程元件的屬性運算式</span><span class="sxs-lookup"><span data-stu-id="96d53-145">Setting Property Expressions of Data Flow Components</span></span>
 <span data-ttu-id="96d53-146">如果在 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]中建構封裝，支援屬性運算式之資料流程元件的屬性便會在其所屬的資料流程工作上公開。</span><span class="sxs-lookup"><span data-stu-id="96d53-146">If you construct a package in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], the properties of data flow components that support property expressions are exposed on the Data Flow task to which they belong.</span></span> <span data-ttu-id="96d53-147">若要加入、變更及移除資料流程元件的屬性運算式，請以滑鼠右鍵按一下資料流程元件所屬資料流程的資料流程工作，並按一下 [屬性]  。</span><span class="sxs-lookup"><span data-stu-id="96d53-147">To add, change, and remove the property expressions of data flow components, you right-click the Data Flow task for the data flow to which the data flow components belong and click **Properties**.</span></span> <span data-ttu-id="96d53-148">[屬性] 視窗會列出可搭配使用屬性運算式之資料流程元件的屬性。</span><span class="sxs-lookup"><span data-stu-id="96d53-148">The Properties window lists the properties of data flow components with which you can use property expressions.</span></span> <span data-ttu-id="96d53-149">例如，若要建立或修改屬性運算式，以用於 SampleCustomer 資料流程中資料列取樣轉換的 SamplingValue 屬性，請以滑鼠右鍵按一下資料列取樣轉換所屬資料流程的資料流程工作，並按一下 [屬性]  。</span><span class="sxs-lookup"><span data-stu-id="96d53-149">For example, to create or modify a property expression for the SamplingValue property of a Row Sampling transformation in a data flow named SampleCustomer, right-click the Data Flow task for the data flow to which the Row Sampling transformation belongs and click **Properties**.</span></span> <span data-ttu-id="96d53-150">SamplingValue 屬性會列在 [屬性] 視窗中，其格式為 [SampleCustomer].[SamplingValue]。</span><span class="sxs-lookup"><span data-stu-id="96d53-150">The SamplingValue property is listed in the Properties window, and has the format [SampleCustomer].[SamplingValue].</span></span>

 <span data-ttu-id="96d53-151">在 [屬性] 視窗中，您可以使用與其他 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] 物件類型之屬性運算式相同的方式，來加入、變更及移除屬性運算式。</span><span class="sxs-lookup"><span data-stu-id="96d53-151">In the Properties window, you add, change, and remove property expressions for data flow components in the same way as property expressions for other [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] object types.</span></span> <span data-ttu-id="96d53-152">[屬性] 視窗也可讓您存取用於加入、變更或移除資料流程元件之屬性運算式的各種對話方塊和產生器。</span><span class="sxs-lookup"><span data-stu-id="96d53-152">The Properties window also provides access to the various dialog boxes and builders that you use to add, change, or remove property expressions for data flow components.</span></span> <span data-ttu-id="96d53-153">如需屬性運算式可更新之資料流程元件屬性的詳細資訊，請參閱 [轉換自訂屬性](../data-flow/transformations/transformation-custom-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="96d53-153">For more information about the properties of data flow components that can be updated by property expressions, see [Transformation Custom Properties](../data-flow/transformations/transformation-custom-properties.md).</span></span>

## <a name="loading-property-expressions"></a><span data-ttu-id="96d53-154">載入屬性運算式</span><span class="sxs-lookup"><span data-stu-id="96d53-154">Loading Property Expressions</span></span>
 <span data-ttu-id="96d53-155">您不能指定或控制屬性運算式載入的時機。</span><span class="sxs-lookup"><span data-stu-id="96d53-155">You cannot specify or control when property expressions are loaded.</span></span> <span data-ttu-id="96d53-156">驗證封裝和封裝物件時便會評估和載入屬性運算式。</span><span class="sxs-lookup"><span data-stu-id="96d53-156">The property expressions are evaluated and loaded when the package and the package objects are validated.</span></span> <span data-ttu-id="96d53-157">儲存封裝、在「 [!INCLUDE[ssIS](../../../includes/ssis-md.md)] 設計師」中開啟封裝以及執行封裝時，都會進行驗證。</span><span class="sxs-lookup"><span data-stu-id="96d53-157">Validation occurs when you save the package, open the package in [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, and run the package.</span></span>

 <span data-ttu-id="96d53-158">因此，必須等到您在加入屬性運算式之後儲存封裝、執行封裝或重新開啟封裝之後，您才會在「 [!INCLUDE[ssIS](../../../includes/ssis-md.md)] 設計師」中看到使用屬性運算式之封裝物件屬性的更新值。</span><span class="sxs-lookup"><span data-stu-id="96d53-158">You will therefore not see the updated values of the properties of the package objects that use property expressions in [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer until you save the package, run the package, or reopen the package after adding the property expressions.</span></span>

 <span data-ttu-id="96d53-159">呼叫不同物件類型 (連接管理員、記錄提供者和列舉值) 特有的方法時，也會載入與該物件類型相關聯的屬性運算式。</span><span class="sxs-lookup"><span data-stu-id="96d53-159">The property expressions associated with different types of objects-connection managers, log providers, and enumerators-are also loaded when methods specific to that object type are called.</span></span> <span data-ttu-id="96d53-160">例如，連接管理員的屬性會在 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] 建立連接執行個體之前載入。</span><span class="sxs-lookup"><span data-stu-id="96d53-160">For example, the properties of connection managers are loaded before [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] creates an instance of the connection.</span></span>

 <span data-ttu-id="96d53-161">屬性運算式會在載入封裝組態之後載入。</span><span class="sxs-lookup"><span data-stu-id="96d53-161">Property expressions are loaded after package configurations have loaded.</span></span> <span data-ttu-id="96d53-162">例如，變數會先由其組態進行更新，然後再評估並載入使用這些變數的屬性運算式。</span><span class="sxs-lookup"><span data-stu-id="96d53-162">For example, variables are updated first by their configurations, and then the property expressions that use the variables are evaluated and loaded.</span></span> <span data-ttu-id="96d53-163">這表示屬性運算式永遠都會使用組態所設定的變數值。</span><span class="sxs-lookup"><span data-stu-id="96d53-163">This means that the property expressions always use the values of variables that are set by configurations.</span></span>

> [!NOTE]
>  <span data-ttu-id="96d53-164">您不能使用 `Set` **dtexec**公用程式的選項來填入屬性運算式。</span><span class="sxs-lookup"><span data-stu-id="96d53-164">You cannot use the `Set` option of the **dtexec** utility to populate a property expression.</span></span>

 <span data-ttu-id="96d53-165">下表摘要說明評估與載入 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] 之屬性運算式的時機。</span><span class="sxs-lookup"><span data-stu-id="96d53-165">The following table summarizes when property expressions of [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] are evaluated and loaded.</span></span>

|<span data-ttu-id="96d53-166">物件類型</span><span class="sxs-lookup"><span data-stu-id="96d53-166">Object type</span></span>|<span data-ttu-id="96d53-167">載入與評估</span><span class="sxs-lookup"><span data-stu-id="96d53-167">Load and evaluate</span></span>|
|-----------------|-----------------------|
|<span data-ttu-id="96d53-168">封裝、Foreach 迴圈、For 迴圈、時序、工作和資料流程元件</span><span class="sxs-lookup"><span data-stu-id="96d53-168">Package, Foreach loop, For Loop, Sequence, tasks, and data flow components</span></span>|<span data-ttu-id="96d53-169">載入組態後</span><span class="sxs-lookup"><span data-stu-id="96d53-169">After loading configurations</span></span><br /><br /> <span data-ttu-id="96d53-170">驗證前</span><span class="sxs-lookup"><span data-stu-id="96d53-170">Before validation</span></span><br /><br /> <span data-ttu-id="96d53-171">執行前</span><span class="sxs-lookup"><span data-stu-id="96d53-171">Before execution</span></span>|
|<span data-ttu-id="96d53-172">連接管理員</span><span class="sxs-lookup"><span data-stu-id="96d53-172">Connection managers</span></span>|<span data-ttu-id="96d53-173">載入組態後</span><span class="sxs-lookup"><span data-stu-id="96d53-173">After loading configurations</span></span><br /><br /> <span data-ttu-id="96d53-174">驗證前</span><span class="sxs-lookup"><span data-stu-id="96d53-174">Before validation</span></span><br /><br /> <span data-ttu-id="96d53-175">執行前</span><span class="sxs-lookup"><span data-stu-id="96d53-175">Before execution</span></span><br /><br /> <span data-ttu-id="96d53-176">建立連接執行個體前</span><span class="sxs-lookup"><span data-stu-id="96d53-176">Before creating a connection instance</span></span>|
|<span data-ttu-id="96d53-177">記錄提供者</span><span class="sxs-lookup"><span data-stu-id="96d53-177">Log providers</span></span>|<span data-ttu-id="96d53-178">載入組態後</span><span class="sxs-lookup"><span data-stu-id="96d53-178">After loading configurations</span></span><br /><br /> <span data-ttu-id="96d53-179">驗證前</span><span class="sxs-lookup"><span data-stu-id="96d53-179">Before validation</span></span><br /><br /> <span data-ttu-id="96d53-180">執行前</span><span class="sxs-lookup"><span data-stu-id="96d53-180">Before execution</span></span><br /><br /> <span data-ttu-id="96d53-181">開啟記錄檔前</span><span class="sxs-lookup"><span data-stu-id="96d53-181">Before opening logs</span></span>|
|<span data-ttu-id="96d53-182">Foreach 列舉值</span><span class="sxs-lookup"><span data-stu-id="96d53-182">Foreach enumerators</span></span>|<span data-ttu-id="96d53-183">載入組態後</span><span class="sxs-lookup"><span data-stu-id="96d53-183">After loading configurations</span></span><br /><br /> <span data-ttu-id="96d53-184">驗證前</span><span class="sxs-lookup"><span data-stu-id="96d53-184">Before validation</span></span><br /><br /> <span data-ttu-id="96d53-185">執行前</span><span class="sxs-lookup"><span data-stu-id="96d53-185">Before execution</span></span><br /><br /> <span data-ttu-id="96d53-186">每次列舉迴圈前</span><span class="sxs-lookup"><span data-stu-id="96d53-186">Before each enumeration of the loop</span></span>|

## <a name="using-property-expressions-in-the-foreach-loop"></a><span data-ttu-id="96d53-187">在 Foreach 迴圈中使用屬性運算式</span><span class="sxs-lookup"><span data-stu-id="96d53-187">Using Property Expressions in the Foreach Loop</span></span>
 <span data-ttu-id="96d53-188">實作屬性運算式通常非常適合用於設定「Foreach 迴圈」容器內所使用之連接管理員的 `ConnectionString` 屬性值。</span><span class="sxs-lookup"><span data-stu-id="96d53-188">It is frequently useful to implement a property expression to set the value of the `ConnectionString` property of connection managers that are used inside the Foreach Loop container.</span></span> <span data-ttu-id="96d53-189">在列舉值將它目前的值對應到迴圈的每個反覆運算上的變數之後，屬性運算式就可以使用這個變數的值來動態更新 `ConnectionString` 屬性的值。</span><span class="sxs-lookup"><span data-stu-id="96d53-189">After the enumerator maps its current value to a variable on each iteration of the loop, the property expression can use the value of this variable to update the value of the `ConnectionString` property dynamically .</span></span>

 <span data-ttu-id="96d53-190">如果想要將屬性運算式用於「Foreach 迴圈」使用之檔案、多個檔案、一般檔案和多個一般檔案連接管理員的 `ConnectionString` 屬性，您必須考慮幾件事。</span><span class="sxs-lookup"><span data-stu-id="96d53-190">If you want to use property expressions with the `ConnectionString` property of File, Multiple Files, Flat Files, and Multiple Flat Files connection managers that a Foreach Loop uses, there are some things that you should consider.</span></span> <span data-ttu-id="96d53-191">可以將 `MaxConcurrentExecutables` 屬性設定為大於 1 或等於 -1 的值，以便將封裝設定為並行執行多個可執行檔。</span><span class="sxs-lookup"><span data-stu-id="96d53-191">A package can be configured to run multiple executables concurrently by setting the `MaxConcurrentExecutables` property either to a value greater than 1 or to the value -1.</span></span> <span data-ttu-id="96d53-192">-1 的值表示允許同時執行的最大可執行檔數目等於處理器數目再加 2。</span><span class="sxs-lookup"><span data-stu-id="96d53-192">A value of -1 allows the maximum number of concurrently running executables to equal the number of processors plus two.</span></span> <span data-ttu-id="96d53-193">為了避免平行執行可執行檔的負面結果，`MaxConcurrentExecutables` 值應該設定為 1。</span><span class="sxs-lookup"><span data-stu-id="96d53-193">To avoid negative consequences from the parallel execution of executables, the value `MaxConcurrentExecutables` should be set to 1.</span></span> <span data-ttu-id="96d53-194">如果 `MaxConcurrentExecutables` 未設定為 1，就無法保證 `ConnectionString` 屬性的值，而且結果會無法預測。</span><span class="sxs-lookup"><span data-stu-id="96d53-194">If `MaxConcurrentExecutables` is not set to 1, then the value of the `ConnectionString` property cannot be guaranteed and results are unpredictable.</span></span>

 <span data-ttu-id="96d53-195">例如，可考慮使用「Foreach 迴圈」列舉資料夾中的檔案、擷取檔案名稱，然後使用執行 SQL 工作將每一個檔案名稱插入資料表中。</span><span class="sxs-lookup"><span data-stu-id="96d53-195">For example, consider a Foreach Loop that enumerates files in a folder, retrieves the file names, and then uses an Execute SQL task to insert each file name into a table.</span></span> <span data-ttu-id="96d53-196">如果 `MaxConcurrentExecutables` 未設為 1，而執行 SQL 工作的兩個執行個體又試圖同時寫入資料表，就可能發生寫入衝突。</span><span class="sxs-lookup"><span data-stu-id="96d53-196">If `MaxConcurrentExecutables` is not set to 1, then write conflicts could occur if two instances of the Execute SQL task attempted to write to the table at the same time.</span></span>

## <a name="sample-property-expressions"></a><span data-ttu-id="96d53-197">範例屬性運算式</span><span class="sxs-lookup"><span data-stu-id="96d53-197">Sample Property Expressions</span></span>
 <span data-ttu-id="96d53-198">下列範例運算式顯示如何在屬性運算式中使用系統變數、運算子、函數和字串常值。</span><span class="sxs-lookup"><span data-stu-id="96d53-198">The following sample expressions show how to use system variables, operators, functions, and string literals in property expressions.</span></span>

### <a name="property-expression-for-the-loggingmode-property-of-a-package"></a><span data-ttu-id="96d53-199">封裝之 LoggingMode 屬性的屬性運算式</span><span class="sxs-lookup"><span data-stu-id="96d53-199">Property Expression for the LoggingMode Property of a Package</span></span>
 <span data-ttu-id="96d53-200">下列屬性運算式可用以設定封裝的 LoggingMode 屬性。</span><span class="sxs-lookup"><span data-stu-id="96d53-200">The following property expression can be used to set the LoggingMode property of a package.</span></span> <span data-ttu-id="96d53-201">此運算式使用 DAY 和 GETDATE 函數來取得代表日期之日 (Day) 部分的整數。</span><span class="sxs-lookup"><span data-stu-id="96d53-201">The expression uses the DAY and GETDATE functions to get an integer that represents the day datepart of a date.</span></span> <span data-ttu-id="96d53-202">如果日期是 1 日或 15 日，記錄功能將會啟用，否則便會停用記錄功能。</span><span class="sxs-lookup"><span data-stu-id="96d53-202">If the day is the 1st or 15th, logging is enabled; otherwise, logging is disabled.</span></span> <span data-ttu-id="96d53-203">值1是 LoggingMode 枚舉器成員的整數對應項 `Enabled` ，而值2則是成員的整數對應項 `Disabled` 。</span><span class="sxs-lookup"><span data-stu-id="96d53-203">The value 1 is the integer equivalent of the LoggingMode enumerator member `Enabled`, and the value 2 is the integer equivalent of the member `Disabled`.</span></span> <span data-ttu-id="96d53-204">您必須在運算式中使用數值代替列舉值成員名稱。</span><span class="sxs-lookup"><span data-stu-id="96d53-204">You must use the numeric value instead of the enumerator member name in the expression.</span></span>

 `DAY((DT_DBTIMESTAMP)GETDATE())==1||DAY((DT_DBTIMESTAMP)GETDATE())==15?1:2`

### <a name="property-expression-for-the-subject-of-an-e-mail-message"></a><span data-ttu-id="96d53-205">電子郵件訊息主旨的屬性運算式</span><span class="sxs-lookup"><span data-stu-id="96d53-205">Property Expression for the Subject of an E-mail Message</span></span>
 <span data-ttu-id="96d53-206">下列屬性運算式可用以設定傳送郵件工作的 Subject 屬性，以及提供有用的電子郵件主旨。</span><span class="sxs-lookup"><span data-stu-id="96d53-206">The following property expression can be used to set the Subject property of a Send Mail task and provide a useful e-mail subject.</span></span> <span data-ttu-id="96d53-207">該運算式會使用字串常值、系統變數、串連 (+) 與轉換運算子，以及 DATEDIFF 與 GETDATE 函數的組合。</span><span class="sxs-lookup"><span data-stu-id="96d53-207">The expression uses a combination of string literals, system variables, the concatenation (+) and cast operators, and the DATEDIFF and GETDATE functions.</span></span> <span data-ttu-id="96d53-208">系統變數是 `PackageName` 與 `StartTime` 變數。</span><span class="sxs-lookup"><span data-stu-id="96d53-208">The system variables are the `PackageName` and `StartTime` variables.</span></span>

 `"PExpression-->Package: (" + @[System::PackageName] + ") Started:"+  (DT_WSTR, 30) @[System::StartTime] + " Duration:"  +  (DT_WSTR,10) (DATEDIFF( "ss", @[System::StartTime] , GETDATE()  )) + " seconds"`

 <span data-ttu-id="96d53-209">如果封裝名稱為 EmailRowCountPP，於 2005 年 3 月 4 日執行且執行持續時間為 9 秒，則運算式會評估為下列字串。</span><span class="sxs-lookup"><span data-stu-id="96d53-209">If the package name is EmailRowCountPP, was run on 3/4/2005, and the duration of the run was 9 seconds, the expression evaluates to the following string.</span></span>

 <span data-ttu-id="96d53-210">PExpression-->Package: (EmailRowCountPP) Started:3/4/2005 11:06:18 AM Duration:9 seconds。</span><span class="sxs-lookup"><span data-stu-id="96d53-210">PExpression-->Package: (EmailRowCountPP) Started:3/4/2005 11:06:18 AM Duration:9 seconds.</span></span>

### <a name="property-expression-for-the-message-of-an-e-mail-message"></a><span data-ttu-id="96d53-211">電子郵件訊息之訊息的屬性運算式</span><span class="sxs-lookup"><span data-stu-id="96d53-211">Property Expression for the Message of an E-mail Message</span></span>
 <span data-ttu-id="96d53-212">下列屬性運算式可用以設定傳送郵件工作的 MessageSource 屬性。</span><span class="sxs-lookup"><span data-stu-id="96d53-212">The following property expression can be used to set the MessageSource property of a Send Mail task.</span></span> <span data-ttu-id="96d53-213">該運算式會使用字串常值、使用者定義變數和串連 (+) 運算子的組合。</span><span class="sxs-lookup"><span data-stu-id="96d53-213">The expression uses a combination of string literals, user-defined variables, and the concatenation (+) operator.</span></span> <span data-ttu-id="96d53-214">使用者定義變數的名稱是 `nasdaqrawrows`、 `nyserawrows`與 `amexrawrows`。</span><span class="sxs-lookup"><span data-stu-id="96d53-214">The user-defined variables are named `nasdaqrawrows`, `nyserawrows`, and `amexrawrows`.</span></span> <span data-ttu-id="96d53-215">字串 "\n" 表示換行字元。</span><span class="sxs-lookup"><span data-stu-id="96d53-215">The string "\n" indicates a carriage return.</span></span>

 `"Rows Processed: "  +   "\n" +"   NASDAQ: "  +   (dt_wstr,9)@[nasdaqrawrows]   + "\n" + "   NYSE: "  +  (dt_wstr,9)@[nyserawrows]  + "\n" + "   Amex: "  +  (dt_wstr,9)@[amexrawrows]`

 <span data-ttu-id="96d53-216">如果 `nasdaqrawrows` 是 7058、 `nyserawrows` 是 3528，而 `amexrawrows` 是 1102，運算式會評估為下列字串。</span><span class="sxs-lookup"><span data-stu-id="96d53-216">If `nasdaqrawrows` is 7058, `nyserawrows` is 3528, and `amexrawrows` is 1102, the expression evaluates to the following string.</span></span>

 <span data-ttu-id="96d53-217">處理的資料列：</span><span class="sxs-lookup"><span data-stu-id="96d53-217">Rows Processed:</span></span>

 <span data-ttu-id="96d53-218">NASDAQ: 7058</span><span class="sxs-lookup"><span data-stu-id="96d53-218">NASDAQ: 7058</span></span>

 <span data-ttu-id="96d53-219">NYSE: 3528</span><span class="sxs-lookup"><span data-stu-id="96d53-219">NYSE: 3528</span></span>

 <span data-ttu-id="96d53-220">AMEX: 1102</span><span class="sxs-lookup"><span data-stu-id="96d53-220">AMEX: 1102</span></span>

### <a name="property-expression-for-the-executable-property-of-an-execute-process-task"></a><span data-ttu-id="96d53-221">執行處理工作之 Executable 屬性的屬性運算式</span><span class="sxs-lookup"><span data-stu-id="96d53-221">Property Expression for the Executable Property of an Execute Process Task</span></span>
 <span data-ttu-id="96d53-222">下列屬性運算式可用以設定「執行處理」工作的 Executable 屬性。</span><span class="sxs-lookup"><span data-stu-id="96d53-222">The following property expression can be used to set the Executable property of an Execute Process task.</span></span> <span data-ttu-id="96d53-223">該運算式會使用字串常值、運算子和函數的組合。</span><span class="sxs-lookup"><span data-stu-id="96d53-223">The expression uses a combination of string literals, operators, and functions.</span></span> <span data-ttu-id="96d53-224">該運算式會使用 DATEPART 和 GETDATE 函數，以及條件運算子。</span><span class="sxs-lookup"><span data-stu-id="96d53-224">The expression uses the DATEPART and GETDATE functions and the conditional operator.</span></span>

 `DATEPART("weekday", GETDATE()) ==2?"notepad.exe":"mspaint.exe"`

 <span data-ttu-id="96d53-225">如果是一星期中的第二天，則「執行處理」工作會執行 notepad.exe，否則該工作會執行 mspaint.exe。</span><span class="sxs-lookup"><span data-stu-id="96d53-225">If it is the second day in the week, the Execute Process task runs notepad.exe, otherwise the task runs mspaint.exe.</span></span>

### <a name="property-expression-for-the-connectionstring-property-of-a-flat-file-connection-manager"></a><span data-ttu-id="96d53-226">一般檔案連接管理員之 ConnectionString 屬性的屬性運算式</span><span class="sxs-lookup"><span data-stu-id="96d53-226">Property Expression for the ConnectionString Property of a Flat File Connection Manager</span></span>
 <span data-ttu-id="96d53-227">下列屬性運算式可用以設定「一般檔案」連線管理員的 ConnectionString 屬性。</span><span class="sxs-lookup"><span data-stu-id="96d53-227">The following property expression can be used to set the ConnectionString property of a Flat File connection manager.</span></span> <span data-ttu-id="96d53-228">該運算式會使用 `myfilenamefull`單一使用者定義變數，該變數包含文字檔的路徑。</span><span class="sxs-lookup"><span data-stu-id="96d53-228">The expression uses a single user-defined variable, `myfilenamefull`, which contains the path to a text file.</span></span>

 `@[User::myfilenamefull]`

> [!NOTE]
>  <span data-ttu-id="96d53-229">連接管理員的屬性運算式只可使用 [屬性] 視窗進行存取。</span><span class="sxs-lookup"><span data-stu-id="96d53-229">Property expressions for connection managers can be accessed only by using the Properties window.</span></span> <span data-ttu-id="96d53-230">若要檢視連線管理員的屬性，您必須在 [屬性] 視窗開啟時，在 [[!INCLUDE[ssIS](../../../includes/ssis-md.md)] 設計師] 的 [連線管理員] 區域中選取連線管理員，或以滑鼠右鍵按一下連線管理員並選取 [屬性]。</span><span class="sxs-lookup"><span data-stu-id="96d53-230">To view the properties for a connection manager, you must select the connection manager in the **Connection Managers** area of [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer when the Properties window is open, or right-click the connection manager and select **Properties**.</span></span>

### <a name="property-expression-for-the-configstring-property-of-a-text-file-log-provider"></a><span data-ttu-id="96d53-231">文字檔記錄提供者之 ConfigString 屬性的屬性運算式</span><span class="sxs-lookup"><span data-stu-id="96d53-231">Property Expression for the ConfigString Property of a Text File Log Provider</span></span>
 <span data-ttu-id="96d53-232">下列屬性運算式可用以設定文字檔記錄提供者的 ConfigString 屬性。</span><span class="sxs-lookup"><span data-stu-id="96d53-232">The following property expression can be used to set the ConfigString property of a Text File log provider.</span></span> <span data-ttu-id="96d53-233">該運算式會使用 `varConfigString`單一使用者定義變數，該變數包含要使用之檔案連線管理員的名稱。</span><span class="sxs-lookup"><span data-stu-id="96d53-233">The expression uses a single user-defined variable, `varConfigString`, which contains the name of the File connection manager to use.</span></span> <span data-ttu-id="96d53-234">檔案連接管理員會指定要在其中寫入記錄項目之文字檔的路徑。</span><span class="sxs-lookup"><span data-stu-id="96d53-234">The File connection manager specifies the path of the text file to which log entries are written.</span></span>

 `@[User::varConfigString]`

> [!NOTE]
>  <span data-ttu-id="96d53-235">記錄提供者的屬性運算式只可使用 [屬性] 視窗進行存取。</span><span class="sxs-lookup"><span data-stu-id="96d53-235">Property expressions for log providers can be accessed only by using the Properties window.</span></span> <span data-ttu-id="96d53-236">若要檢視記錄提供者的屬性，您必須在 [屬性] 視窗開啟時，在 [[!INCLUDE[ssIS](../../../includes/ssis-md.md)] 設計師] 的封裝總管索引標籤上選取記錄提供者，或以滑鼠右鍵按一下封裝總管中的記錄提供者，並按一下 [屬性]。</span><span class="sxs-lookup"><span data-stu-id="96d53-236">To view the properties of a log provider, you must select the log provider on the **Package Explorer** tab of [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer when the Properties window is open, or right-click the log provider in Package Explorer and click **Properties**.</span></span>

## <a name="external-resources"></a><span data-ttu-id="96d53-237">外部資源</span><span class="sxs-lookup"><span data-stu-id="96d53-237">External Resources</span></span>

-   [<span data-ttu-id="96d53-238">運算式和組態螢光筆標示 (CodePlex 專案)</span><span class="sxs-lookup"><span data-stu-id="96d53-238">Expression and Configuration Highlighter (CodePlex Project)</span></span>](https://go.microsoft.com/fwlink/?LinkId=146625)

-   <span data-ttu-id="96d53-239">social.technet.microsoft.com 上的技術文件： [SSIS 運算式範例](https://go.microsoft.com/fwlink/?LinkId=220761)</span><span class="sxs-lookup"><span data-stu-id="96d53-239">Technical article, [SSIS Expression Examples](https://go.microsoft.com/fwlink/?LinkId=220761), on social.technet.microsoft.com</span></span>

## <a name="see-also"></a><span data-ttu-id="96d53-240">另請參閱</span><span class="sxs-lookup"><span data-stu-id="96d53-240">See Also</span></span>
 [<span data-ttu-id="96d53-241">在套件中使用變數</span><span class="sxs-lookup"><span data-stu-id="96d53-241">Use Variables in Packages</span></span>](../use-variables-in-packages.md)


