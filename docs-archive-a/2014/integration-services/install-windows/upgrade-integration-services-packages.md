---
title: 升級 Integration Services 套件 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Integration Services, migrating
- migrating packages [Integration Services]
ms.assetid: 68dbdf81-032c-4a73-99f6-41420e053980
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 5a6ca4f80b25a8cc4628da4382c1aae971c74bf5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87596186"
---
# <a name="upgrade-integration-services-packages"></a><span data-ttu-id="2621f-102">升級 Integration Services 封裝</span><span class="sxs-lookup"><span data-stu-id="2621f-102">Upgrade Integration Services Packages</span></span>
  <span data-ttu-id="2621f-103">當您將或的實例 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 升級 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 為目前的版本時 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ，現有的 [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] 封裝並不會自動升級為目前版本所使用的封裝格式 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="2621f-103">When you upgrade an instance of [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] to the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], your existing [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] packages are not automatically upgraded to the package format that the current release [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] uses.</span></span> <span data-ttu-id="2621f-104">您必須選取升級方法並手動升級您的封裝。</span><span class="sxs-lookup"><span data-stu-id="2621f-104">You will have to select an upgrade method and manually upgrade your packages.</span></span>  
  
 <span data-ttu-id="2621f-105">當您升級封裝時，會將 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 任何腳本工作和腳本元件中的腳本遷移至 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] 適用于應用程式 (VSTA) 的工具。</span><span class="sxs-lookup"><span data-stu-id="2621f-105">When you upgrade a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] migrates the scripts in any Script task and Script component to [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications (VSTA).</span></span> <span data-ttu-id="2621f-106">在中 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] ，腳本工作或腳本元件中用於 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] 應用程式 (VSA) 的腳本。</span><span class="sxs-lookup"><span data-stu-id="2621f-106">In [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], the scripts in Script tasks or Script components used [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] for Applications (VSA).</span></span> <span data-ttu-id="2621f-107">如需您可能必須在移轉之前對指令碼進行的變更以及指令碼轉換失敗的詳細資訊，請參閱[將指令碼移轉到 VSTA](../../sql-server/install/migrate-scripts-to-vsta.md)。</span><span class="sxs-lookup"><span data-stu-id="2621f-107">For more information about changes that you might have to make to the scripts before migration and about script conversion failure, see [Migrate Scripts to VSTA](../../sql-server/install/migrate-scripts-to-vsta.md).</span></span>  
  
 <span data-ttu-id="2621f-108">如需將專案轉換為專案部署模型時升級封裝的相關資訊，請參閱 [將專案部署至 Integration Services 伺服器](../deploy-projects-to-integration-services-server.md)。</span><span class="sxs-lookup"><span data-stu-id="2621f-108">For information on upgrading packages when you convert a project to the project deployment model, see [Deploy Projects to Integration Services Server](../deploy-projects-to-integration-services-server.md).</span></span>  
  
## <a name="sql-server-2000-data-transformation-services-packages"></a><span data-ttu-id="2621f-109">SQL Server 2000 Data Transformation Services 封裝</span><span class="sxs-lookup"><span data-stu-id="2621f-109">SQL Server 2000 Data Transformation Services Packages</span></span>  
 <span data-ttu-id="2621f-110">目前的版本已不再支援遷移或執行資料轉換服務 (DTS) 封裝 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="2621f-110">Support for migrating or running Data Transformation Services (DTS) packages has been discontinued in the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span></span> <span data-ttu-id="2621f-111">下列 DTS 功能已停用：</span><span class="sxs-lookup"><span data-stu-id="2621f-111">The following DTS functionality has been discontinued.</span></span>  
  
-   <span data-ttu-id="2621f-112">DTS 執行階段</span><span class="sxs-lookup"><span data-stu-id="2621f-112">DTS runtime</span></span>  
  
-   <span data-ttu-id="2621f-113">DTS API</span><span class="sxs-lookup"><span data-stu-id="2621f-113">DTS API</span></span>  
  
-   <span data-ttu-id="2621f-114">可將 DTS 封裝移轉到下一版 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="2621f-114">Package Migration Wizard for migrating DTS packages to the next version of [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]</span></span>  
  
-   <span data-ttu-id="2621f-115">DTS 封裝維護的支援 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]</span><span class="sxs-lookup"><span data-stu-id="2621f-115">Support for DTS package maintenance in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]</span></span>  
  
-   <span data-ttu-id="2621f-116">執行 DTS 2000 封裝工作</span><span class="sxs-lookup"><span data-stu-id="2621f-116">Execute DTS 2000 Package task</span></span>  
  
-   <span data-ttu-id="2621f-117">DTS 封包的 Upgrade Advisor 掃描。</span><span class="sxs-lookup"><span data-stu-id="2621f-117">Upgrade Advisor scan of DTS packages.</span></span>  
  
 <span data-ttu-id="2621f-118">下列選項可用於移轉 DTS 封裝。</span><span class="sxs-lookup"><span data-stu-id="2621f-118">The following options are available for migrating DTS packages.</span></span>  
  
-   <span data-ttu-id="2621f-119">將封裝移轉到 [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] 或 [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)]，然後再將封裝升級到 [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="2621f-119">Migrate the packages to [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] or [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)], and then upgrade the packages to [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)].</span></span>  
  
     <span data-ttu-id="2621f-120">如需將 DTS 套件移轉到 [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] 和 [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] 的相關資訊，請參閱[移轉 Data Transformation Services 封裝](https://go.microsoft.com/fwlink/?LinkId=251870) (2005) 和[移轉 Data Transformation Services 封裝](https://go.microsoft.com/fwlink/?LinkId=251871) (2008)。</span><span class="sxs-lookup"><span data-stu-id="2621f-120">For information about migrating DTS packages to [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] and [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)], see [Migrating Data Transformation Services Packages](https://go.microsoft.com/fwlink/?LinkId=251870) (2005) and [Migrating Data Transformation Services Packages](https://go.microsoft.com/fwlink/?LinkId=251871) (2008).</span></span>  
  
-   <span data-ttu-id="2621f-121">使用 [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)] 重新建立 DTS 封裝。</span><span class="sxs-lookup"><span data-stu-id="2621f-121">Recreate the DTS packages by using [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)].</span></span>  
  
     <span data-ttu-id="2621f-122">如需 [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)] 中新功能的相關資訊，請參閱 [新功能 &#40;Integration Services&#41;](../what-s-new-in-integration-services-in-sql-server-2016.md)。</span><span class="sxs-lookup"><span data-stu-id="2621f-122">For information about the new features in [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)], see [What's New &#40;Integration Services&#41;](../what-s-new-in-integration-services-in-sql-server-2016.md).</span></span> <span data-ttu-id="2621f-123">如需 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 套件之結構的概觀，請參閱 [Integration Services &#40;SSIS&#41; 套件](../integration-services-ssis-packages.md)。</span><span class="sxs-lookup"><span data-stu-id="2621f-123">For an overview of the structure of [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] packages, see [Integration Services &#40;SSIS&#41; Packages](../integration-services-ssis-packages.md).</span></span>  
  
## <a name="selecting-an-upgrade-method"></a><span data-ttu-id="2621f-124">選取升級方法</span><span class="sxs-lookup"><span data-stu-id="2621f-124">Selecting an Upgrade Method</span></span>  
 <span data-ttu-id="2621f-125">您可以使用各種方法來升級 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 和 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 套件。</span><span class="sxs-lookup"><span data-stu-id="2621f-125">You can use various methods to upgrade [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] packages.</span></span> <span data-ttu-id="2621f-126">對於其中某些方法而言，升級只是暫時性。</span><span class="sxs-lookup"><span data-stu-id="2621f-126">For some of these methods, the upgrade is only temporary.</span></span> <span data-ttu-id="2621f-127">對於其他方法而言，升級則是永久性。</span><span class="sxs-lookup"><span data-stu-id="2621f-127">For others, the upgrade is permanent.</span></span> <span data-ttu-id="2621f-128">下表將描述每種方法以及升級是暫時性或永久性。</span><span class="sxs-lookup"><span data-stu-id="2621f-128">The following table describes each of these methods and whether the upgrade is temporary or permanent.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="2621f-129">當您使用隨目前之 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 版本安裝的 **dtexec** 公用程式 (dtexec.exe) 執行 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 或 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 套件時，暫時套件升級將會拉長執行的時間。</span><span class="sxs-lookup"><span data-stu-id="2621f-129">When you run a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] package using the **dtexec** utility (dtexec.exe) that is installed with the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the temporary package upgrade increases the execution time.</span></span> <span data-ttu-id="2621f-130">所增加的封裝執行時間長短，取決於封裝的大小。</span><span class="sxs-lookup"><span data-stu-id="2621f-130">The rate of increase in package execution time varies depending on the size of the package.</span></span> <span data-ttu-id="2621f-131">如要避免執行時間增加，建議您在執行前先升級封裝。</span><span class="sxs-lookup"><span data-stu-id="2621f-131">To avoid an increase in the execution time, it is recommended that you upgrade the package before running it.</span></span>  
  
|<span data-ttu-id="2621f-132">升級方法</span><span class="sxs-lookup"><span data-stu-id="2621f-132">Upgrade Method</span></span>|<span data-ttu-id="2621f-133">升級的類型</span><span class="sxs-lookup"><span data-stu-id="2621f-133">Type of Upgrade</span></span>|  
|--------------------|---------------------|  
|<span data-ttu-id="2621f-134">使用隨目前 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 版本安裝的 **dtexec** 公用程式 (dtexec.exe) 執行 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 或 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 套件。</span><span class="sxs-lookup"><span data-stu-id="2621f-134">Use the **dtexec** utility (dtexec.exe) that is installed with the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to run a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] package.</span></span><br /><br /> <span data-ttu-id="2621f-135">如需詳細資訊，請參閱 [dtexec Utility](../packages/dtexec-utility.md)。</span><span class="sxs-lookup"><span data-stu-id="2621f-135">For more information, see [dtexec Utility](../packages/dtexec-utility.md).</span></span>|<span data-ttu-id="2621f-136">封裝升級是暫時性的。</span><span class="sxs-lookup"><span data-stu-id="2621f-136">The package upgrade is temporary.</span></span> <span data-ttu-id="2621f-137">針對 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]，指令碼移轉是暫時性的。</span><span class="sxs-lookup"><span data-stu-id="2621f-137">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is temporary.</span></span><br /><br /> <span data-ttu-id="2621f-138">這些變更無法儲存。</span><span class="sxs-lookup"><span data-stu-id="2621f-138">The changes cannot be saved.</span></span>|  
|<span data-ttu-id="2621f-139">在 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 中，開啟 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 或 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] 封裝檔案。</span><span class="sxs-lookup"><span data-stu-id="2621f-139">Open a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] package file in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span>|<span data-ttu-id="2621f-140">如果您儲存了封裝，封裝升級就是永久性。不過，如果您沒有儲存封裝，封裝升級就是暫時性。</span><span class="sxs-lookup"><span data-stu-id="2621f-140">The package upgrade is permanent if you save the package; otherwise, it is temporary if you do not save the package.</span></span><br /><br /> <span data-ttu-id="2621f-141">針對 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 封裝，如果您儲存了封裝，指令碼移轉就是永久性。不過，如果您沒有儲存封裝，指令碼移轉就是暫時性。</span><span class="sxs-lookup"><span data-stu-id="2621f-141">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is permanent if you save the package; otherwise, it is temporary if you do not save the package.</span></span>|  
|<span data-ttu-id="2621f-142">在 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 的現有專案中加入 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 或 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] 封裝。</span><span class="sxs-lookup"><span data-stu-id="2621f-142">Add a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] package to an existing project in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span>|<span data-ttu-id="2621f-143">封裝升級是永久性的。</span><span class="sxs-lookup"><span data-stu-id="2621f-143">The package upgrade is permanent.</span></span> <span data-ttu-id="2621f-144">針對 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 封裝，指令碼移轉是永久性的。</span><span class="sxs-lookup"><span data-stu-id="2621f-144">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is permanent.</span></span>|  
|<span data-ttu-id="2621f-145">開啟 [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] 中的 [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] 或 [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] 專案檔案，然後使用 [[!INCLUDE[ssIS](../../includes/ssis-md.md)] 封裝升級精靈] 升級專案中的多個封裝。</span><span class="sxs-lookup"><span data-stu-id="2621f-145">Open a [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] or [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] project file in [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)], and then use the [!INCLUDE[ssIS](../../includes/ssis-md.md)] Package Upgrade Wizard to upgrade multiple packages in the project.</span></span><br /><br /> <span data-ttu-id="2621f-146">如需詳細資訊，請參閱 [使用 SSIS 封裝升級精靈來升級 Integration Services 封裝](upgrade-integration-services-packages-using-the-ssis-package-upgrade-wizard.md) 和 [SSIS 封裝升級精靈 F1 說明](../ssis-package-upgrade-wizard-f1-help.md)。</span><span class="sxs-lookup"><span data-stu-id="2621f-146">For more information, see [Upgrade Integration Services Packages Using the SSIS Package Upgrade Wizard](upgrade-integration-services-packages-using-the-ssis-package-upgrade-wizard.md) and [SSIS Package Upgrade Wizard F1 Help](../ssis-package-upgrade-wizard-f1-help.md).</span></span>|<span data-ttu-id="2621f-147">封裝升級是永久性的。</span><span class="sxs-lookup"><span data-stu-id="2621f-147">The package upgrade is permanent.</span></span> <span data-ttu-id="2621f-148">針對 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 封裝，指令碼移轉是永久性的。</span><span class="sxs-lookup"><span data-stu-id="2621f-148">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is permanent.</span></span>|  
|<span data-ttu-id="2621f-149">使用隨目前 <xref:Microsoft.SqlServer.Dts.Runtime.Application.Upgrade%2A> 方法來升級一或多個 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 封裝。</span><span class="sxs-lookup"><span data-stu-id="2621f-149">Use the <xref:Microsoft.SqlServer.Dts.Runtime.Application.Upgrade%2A> method to upgrade one or more [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] packages.</span></span>|<span data-ttu-id="2621f-150">封裝升級是永久性的。</span><span class="sxs-lookup"><span data-stu-id="2621f-150">The package upgrade is permanent.</span></span> <span data-ttu-id="2621f-151">針對 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 封裝，指令碼移轉是永久性的。</span><span class="sxs-lookup"><span data-stu-id="2621f-151">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is permanent.</span></span>|  
  
## <a name="custom-applications-and-custom-components"></a><span data-ttu-id="2621f-152">自訂應用程式和自訂元件</span><span class="sxs-lookup"><span data-stu-id="2621f-152">Custom Applications and Custom Components</span></span>  
 [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] <span data-ttu-id="2621f-153">自訂元件無法搭配目前的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]版本使用。</span><span class="sxs-lookup"><span data-stu-id="2621f-153">custom components will not work with the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="2621f-154">您可以使用目前的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 版本工具執行及管理內含 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 和 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)][!INCLUDE[ssIS](../../includes/ssis-md.md)] 自訂元件的封裝。</span><span class="sxs-lookup"><span data-stu-id="2621f-154">You can use the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] tools to run and manage packages that include [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] and [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)][!INCLUDE[ssIS](../../includes/ssis-md.md)] custom components.</span></span> <span data-ttu-id="2621f-155">我們在下列檔案中加入四個繫結重新導向規則，協助將執行階段元件從 10.0.0.0 版 ([!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]) 重新導向至 11.0.0.0 版 ([!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="2621f-155">We added four binding redirection rules to the following files to help redirect the runtime assemblies from version 10.0.0.0 ([!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]) to version 11.0.0.0 ([!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]).</span></span>  
  
-   <span data-ttu-id="2621f-156">DTExec.exe.config</span><span class="sxs-lookup"><span data-stu-id="2621f-156">DTExec.exe.config</span></span>  
  
-   <span data-ttu-id="2621f-157">dtshost.exe.config</span><span class="sxs-lookup"><span data-stu-id="2621f-157">dtshost.exe.config</span></span>  
  
-   <span data-ttu-id="2621f-158">DTSWizard.exe.config</span><span class="sxs-lookup"><span data-stu-id="2621f-158">DTSWizard.exe.config</span></span>  
  
-   <span data-ttu-id="2621f-159">DTUtil.exe.config</span><span class="sxs-lookup"><span data-stu-id="2621f-159">DTUtil.exe.config</span></span>  
  
-   <span data-ttu-id="2621f-160">DTExecUI.exe.config</span><span class="sxs-lookup"><span data-stu-id="2621f-160">DTExecUI.exe.config</span></span>  
  
 <span data-ttu-id="2621f-161">若要使用 [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] 設計包含 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 和 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 自訂群組件的套件，您需要修改位於下列位置的 devenv.exe.config 檔案 *\<drive>* ： \Program Files\Microsoft Visual Studio 10.0 \ common7\ide。</span><span class="sxs-lookup"><span data-stu-id="2621f-161">To use [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] to design packages that include [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] and [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] custom components, you need to modify the devenv.exe.config file that is located at *\<drive>*:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE.</span></span>  
  
 <span data-ttu-id="2621f-162">如果要使用這些封裝搭配 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]版本執行階段所建置的應用程式，必須在可執行檔的 \*.exe.config 檔案的組態區段中包含重新導向規則。</span><span class="sxs-lookup"><span data-stu-id="2621f-162">To use these packages with customer applications that are built with the runtime for [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], include redirection rules in the configuration section of the \*.exe.config file for the executable.</span></span> <span data-ttu-id="2621f-163">規則會將執行階段組件重新導向至 11.0.0.0 版 ([!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="2621f-163">The rules redirect the runtime assemblies to version 11.0.0.0 ([!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]).</span></span> <span data-ttu-id="2621f-164">如需組件版本重新導向的詳細資訊，請參閱 [\<runtime> 的 \<assemblyBinding> 項目](https://msdn.microsoft.com/library/twy1dw1e.aspx) (機器翻譯)。</span><span class="sxs-lookup"><span data-stu-id="2621f-164">For more information about assembly version redirection, see [\<assemblyBinding> Element for \<runtime>](https://msdn.microsoft.com/library/twy1dw1e.aspx).</span></span>  
  
### <a name="locating-the-assemblies"></a><span data-ttu-id="2621f-165">尋找組件</span><span class="sxs-lookup"><span data-stu-id="2621f-165">Locating the Assemblies</span></span>  
 <span data-ttu-id="2621f-166">在 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]中， [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 組件已經升級至 .NET 4.0。</span><span class="sxs-lookup"><span data-stu-id="2621f-166">In [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] assemblies were upgraded to .NET 4.0.</span></span> <span data-ttu-id="2621f-167">.NET 4 有個別的全域組件快取，位於 *\<drive>* :\Windows\Microsoft.NET\assembly。</span><span class="sxs-lookup"><span data-stu-id="2621f-167">There is a separate global assembly cache for .NET 4, located in *\<drive>*:\Windows\Microsoft.NET\assembly.</span></span> <span data-ttu-id="2621f-168">您可以在此路徑底下 (通常在 GAC_MSIL 資料夾中) 找到所有 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 組件。</span><span class="sxs-lookup"><span data-stu-id="2621f-168">You can find all of the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] assemblies under this path, usually in the GAC_MSIL folder.</span></span>  
  
 <span data-ttu-id="2621f-169">如同舊版 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]，核心 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 擴充性 .dll 檔案也位於 *\<drive>* :\Program Files\Microsoft SQL Server\100\SDK\Assemblies。</span><span class="sxs-lookup"><span data-stu-id="2621f-169">As in previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the core [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] extensibility .dll files are also located at *\<drive>*:\Program Files\Microsoft SQL Server\100\SDK\Assemblies.</span></span>  
  
## <a name="understanding-sql-server-package-upgrade-results"></a><span data-ttu-id="2621f-170">了解 SQL Server 封裝升級結果</span><span class="sxs-lookup"><span data-stu-id="2621f-170">Understanding SQL Server Package Upgrade Results</span></span>  
 <span data-ttu-id="2621f-171">升級封裝期間，[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 及 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 封裝中的大多數元件及功能皆會順利地轉換成目前 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 版本的對應項目。</span><span class="sxs-lookup"><span data-stu-id="2621f-171">During the package upgrade process, most components and features in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] packages convert seamlessly to their counterparts in the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="2621f-172">不過，其中有許多元件和功能不會升級，或者具有您應該注意的升級結果。</span><span class="sxs-lookup"><span data-stu-id="2621f-172">However, there are several components and features that either will not be upgraded or have upgrade results of which you should be aware.</span></span> <span data-ttu-id="2621f-173">下表將識別這些元件和功能。</span><span class="sxs-lookup"><span data-stu-id="2621f-173">The following table identifies these components and features.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="2621f-174">若要識別哪些封裝具有下表所列的問題，請執行 Upgrade Advisor。</span><span class="sxs-lookup"><span data-stu-id="2621f-174">To identify which packages have the issues listed in this table, run Upgrade Advisor.</span></span> <span data-ttu-id="2621f-175">如需詳細資訊，請參閱＜ [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md)＞。</span><span class="sxs-lookup"><span data-stu-id="2621f-175">For more information, see [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span></span>  
  
|<span data-ttu-id="2621f-176">元件或功能</span><span class="sxs-lookup"><span data-stu-id="2621f-176">Component or Feature</span></span>|<span data-ttu-id="2621f-177">升級結果</span><span class="sxs-lookup"><span data-stu-id="2621f-177">Upgrade Results</span></span>|  
|--------------------------|---------------------|  
|<span data-ttu-id="2621f-178">連接字串</span><span class="sxs-lookup"><span data-stu-id="2621f-178">Connection strings</span></span>|<span data-ttu-id="2621f-179">對於 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 及 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 封裝，某些提供者的名稱已有所變更，需要在連接字串中使用不同的值。</span><span class="sxs-lookup"><span data-stu-id="2621f-179">For [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] packages, the names of certain providers have changed and require different values in the connection strings.</span></span> <span data-ttu-id="2621f-180">若要更新連接字串，請使用下列其中一個程序：</span><span class="sxs-lookup"><span data-stu-id="2621f-180">To update the connection strings, use one of the following procedures:</span></span><br /><br /> <span data-ttu-id="2621f-181">-使用 [ [!INCLUDE[ssIS](../../includes/ssis-md.md)] 封裝升級嚮導] 來升級封裝，然後選取 [**更新連接字串以使用新的提供者名稱**] 選項。</span><span class="sxs-lookup"><span data-stu-id="2621f-181">-Use the [!INCLUDE[ssIS](../../includes/ssis-md.md)] Package Upgrade Wizard to upgrade the package, and select the **Update connection strings to use new provider names** option.</span></span><br /><br /> <span data-ttu-id="2621f-182">-在 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] 的 [選項] 對話方塊的 [一般] 頁面上，選取 [**更新連接字串以使用新的提供者名稱**] 選項。</span><span class="sxs-lookup"><span data-stu-id="2621f-182">-In [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], on the General page of the Options dialog box, select the **Update connection strings to use new provider names** option.</span></span> <span data-ttu-id="2621f-183">如需此選項的詳細資訊，請參閱[一般頁面](../general-page-of-integration-services-designers-options.md)。</span><span class="sxs-lookup"><span data-stu-id="2621f-183">For more information about this option, see [General Page](../general-page-of-integration-services-designers-options.md).</span></span><br /><br /> <span data-ttu-id="2621f-184">-在 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] 中，開啟套件並手動變更 ConnectionString 屬性的文字。</span><span class="sxs-lookup"><span data-stu-id="2621f-184">-In [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], open the package and manually change the text of the ConnectionString property.</span></span><br /><br /> <span data-ttu-id="2621f-185">請注意：當連接字串儲存在組態檔或資料來源檔案中，或者運算式設定 `ConnectionString` 屬性時，您無法使用先前的程序更新連接字串。</span><span class="sxs-lookup"><span data-stu-id="2621f-185">Note: You cannot use the previous procedures to update a connection string when the connection string is stored in either a configuration file or a data source file, or when an expression sets the `ConnectionString` property.</span></span> <span data-ttu-id="2621f-186">在這些情況下，若要更新連接字串，您必須手動更新檔案或運算式。</span><span class="sxs-lookup"><span data-stu-id="2621f-186">To update the connection string in these cases, you must manually update the file or the expression.</span></span><br /><br /> <span data-ttu-id="2621f-187">如需資料來源的詳細資訊，請參閱 [資料來源](../connection-manager/data-sources.md)。</span><span class="sxs-lookup"><span data-stu-id="2621f-187">For more information about data sources, see [Data Sources](../connection-manager/data-sources.md).</span></span>|  
|<span data-ttu-id="2621f-188">查閱轉換</span><span class="sxs-lookup"><span data-stu-id="2621f-188">Lookup transformation</span></span>|<span data-ttu-id="2621f-189">對於 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 封裝，升級程序會自動將查閱轉換升級為目前的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 版本。</span><span class="sxs-lookup"><span data-stu-id="2621f-189">For [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] packages, the upgrade process automatically upgrades the Lookup transformation to the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span></span> <span data-ttu-id="2621f-190">但目前版本中的此元件另有一些功能可以供您使用。</span><span class="sxs-lookup"><span data-stu-id="2621f-190">However, the current release of this component has some additional capabilities of which you might want to take advantage.</span></span><br /><br /> <span data-ttu-id="2621f-191">如需相關資訊，請參閱 [Lookup Transformation](../data-flow/transformations/lookup-transformation.md)。</span><span class="sxs-lookup"><span data-stu-id="2621f-191">For more information, see [Lookup Transformation](../data-flow/transformations/lookup-transformation.md).</span></span>|  
|<span data-ttu-id="2621f-192">指令碼工作和指令碼元件</span><span class="sxs-lookup"><span data-stu-id="2621f-192">Script task and Script component</span></span>|<span data-ttu-id="2621f-193">針對 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 封裝，升級程序會自動將指令碼工作和指令碼元件中的指令碼，從 VSA 移轉到 VSTA。</span><span class="sxs-lookup"><span data-stu-id="2621f-193">For [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] packages, the upgrade process automatically migrates scripts in the Script task and Script component from VSA to VSTA.</span></span><br /><br /> <span data-ttu-id="2621f-194">如需您可能必須在移轉之前對指令碼進行的變更以及指令碼轉換失敗的詳細資訊，請參閱[將指令碼移轉到 VSTA](../../sql-server/install/migrate-scripts-to-vsta.md)。</span><span class="sxs-lookup"><span data-stu-id="2621f-194">For more information about changes that you might have to make to the scripts before migration and about script conversion failure, see [Migrate Scripts to VSTA](../../sql-server/install/migrate-scripts-to-vsta.md).</span></span>|  
  
### <a name="scripts-that-depend-on-adodbdll"></a><span data-ttu-id="2621f-195">以 ADODB.dll 為基礎的指令碼</span><span class="sxs-lookup"><span data-stu-id="2621f-195">Scripts that Depend on ADODB.dll</span></span>  
 <span data-ttu-id="2621f-196">明確參考 ADODB.dll 的指令碼工作和指令碼元件指令碼可能無法升級，或是在未安裝 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] 或 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] 的電腦上執行。</span><span class="sxs-lookup"><span data-stu-id="2621f-196">Script Task and Script Component scripts that explicitly reference ADODB.dll may not upgrade or run on machines without [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] installed.</span></span> <span data-ttu-id="2621f-197">為了升級這些指令碼工作或指令碼元件指令碼，建議您移除 ADODB.dll 的相依性。</span><span class="sxs-lookup"><span data-stu-id="2621f-197">In order to upgrade these Script Task or Script Component scripts, it is recommended that you remove the dependency on ADODB.dll.</span></span>  <span data-ttu-id="2621f-198">建議以 Ado.Net 來替代 Managed 程式碼 (例如 VB 和 C# 指令碼)。</span><span class="sxs-lookup"><span data-stu-id="2621f-198">Ado.Net is the recommended alternative for managed code such as VB and C# scripts.</span></span>  
  
## <a name="external-resources"></a><span data-ttu-id="2621f-199">外部資源</span><span class="sxs-lookup"><span data-stu-id="2621f-199">External Resources</span></span>  
  
-   <span data-ttu-id="2621f-200">msdn.microsoft.com 上的技術文章：[5 Tips for a Smooth SSIS Upgrade to SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=235321) (將 SSIS 順利升級至 SQL Server 2012 的 5 個秘訣)。</span><span class="sxs-lookup"><span data-stu-id="2621f-200">Technical article, [5 Tips for a Smooth SSIS Upgrade to SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=235321), on msdn.microsoft.com.</span></span>  
  
-   <span data-ttu-id="2621f-201">blogs.msdn.com 上的部落格文章： [在 Denali 中製作現有的自訂 SSIS 延伸模組和應用程式工作](https://go.microsoft.com/fwlink/?LinkId=238157)。</span><span class="sxs-lookup"><span data-stu-id="2621f-201">Blog entry, [Making your Existing Custom SSIS Extensions and Applications Work in Denali](https://go.microsoft.com/fwlink/?LinkId=238157), on blogs.msdn.com.</span></span>  
  
-   <span data-ttu-id="2621f-202">channel9.msdn.com 上的網路廣播：[Upgrading SSIS Packages to SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=258674) (將 SSIS 套件升級至 SQL Server 2012)。</span><span class="sxs-lookup"><span data-stu-id="2621f-202">Webcast, [Upgrading SSIS Packages to SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=258674), on channel9.msdn.com.</span></span>  
  
  
