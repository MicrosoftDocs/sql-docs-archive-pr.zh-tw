---
title: 將運算式加入優先順序條件約束 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- precedence executables [Integration Services]
- precedence constraints [Integration Services], adding expressions
- adding expressions
- constrained executables [Integration Services]
- combining constraints
- expressions [Integration Services], constraints
ms.assetid: 5574d89a-a68e-4b84-80ea-da93305e5ca1
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 6dfc73a484020a51738b8ef93e20d96d16edbf1c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87595244"
---
# <a name="add-expressions-to-precedence-constraints"></a><span data-ttu-id="5acfb-102">將運算式加入優先順序條件約束</span><span class="sxs-lookup"><span data-stu-id="5acfb-102">Add Expressions to Precedence Constraints</span></span>
  <span data-ttu-id="5acfb-103">優先順序條件約束可以使用運算式來定義兩個可執行檔之間的條件約束：優先順序可執行檔和受條件約束的可執行檔。</span><span class="sxs-lookup"><span data-stu-id="5acfb-103">A precedence constraint can use an expression to define the constraint between two executables: the precedence executable and the constrained executable.</span></span> <span data-ttu-id="5acfb-104">可執行檔可以是工作或容器。</span><span class="sxs-lookup"><span data-stu-id="5acfb-104">The executables can be tasks or containers.</span></span> <span data-ttu-id="5acfb-105">運算式可以單獨使用，或與優先順序可執行檔的執行結果組合使用。</span><span class="sxs-lookup"><span data-stu-id="5acfb-105">The expression can be used alone or in combination with the execution result of the precedence executable.</span></span> <span data-ttu-id="5acfb-106">可執行檔的執行結果為成功或失敗。</span><span class="sxs-lookup"><span data-stu-id="5acfb-106">The execution result of an executable is either success or failure.</span></span> <span data-ttu-id="5acfb-107">設定優先順序條件約束的執行結果時，可以將執行結果設為 `Success`、`Failure` 或 `Completion`。</span><span class="sxs-lookup"><span data-stu-id="5acfb-107">When you configure the execution result of a precedence constraint, you can set the execution result to `Success`, `Failure`, or `Completion`.</span></span> <span data-ttu-id="5acfb-108">`Success` 表示優先順序可執行檔必須執行成功；`Failure` 表示優先順序可執行檔必須執行失敗；`Completion` 則指示不論優先順序工作成功與否，受條件約束的可執行檔都應該執行。</span><span class="sxs-lookup"><span data-stu-id="5acfb-108">`Success` requires that the precedence executable succeed, `Failure` requires that the precedence executable fail, and `Completion` indicates that the constrained executable should run regardless of whether the precedence task succeeds or fails.</span></span> <span data-ttu-id="5acfb-109">如需詳細資訊，請參閱 [優先順序條件約束](control-flow/precedence-constraints.md)。</span><span class="sxs-lookup"><span data-stu-id="5acfb-109">For more information, see [Precedence Constraints](control-flow/precedence-constraints.md).</span></span>  
  
 <span data-ttu-id="5acfb-110">運算式必須評估為 `True` 或 `False`，且必須是有效的 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 運算式。</span><span class="sxs-lookup"><span data-stu-id="5acfb-110">The expression must evaluate to `True` or `False` and it must be a valid [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] expression.</span></span> <span data-ttu-id="5acfb-111">運算式可以使用常值、系統及自訂變數，以及 [!INCLUDE[ssIS](../includes/ssis-md.md)] 運算式文法提供的函數與運算子。</span><span class="sxs-lookup"><span data-stu-id="5acfb-111">The expression can use literals, system and custom variables, and the functions and operators that the [!INCLUDE[ssIS](../includes/ssis-md.md)] expression grammar provides.</span></span> <span data-ttu-id="5acfb-112">例如，運算式 `@Count == SQRT(144) + 10` 使用變數 `Count`、SQRT 函數及等於 (==) 和加 (+) 運算子。</span><span class="sxs-lookup"><span data-stu-id="5acfb-112">For example, the expression `@Count == SQRT(144) + 10` uses the variable `Count`, the SQRT function , and the equal (==) and add (+) operators.</span></span> <span data-ttu-id="5acfb-113">如需詳細資訊，請參閱 [Integration Services &#40;SSIS&#41; 運算式](expressions/integration-services-ssis-expressions.md)為止。</span><span class="sxs-lookup"><span data-stu-id="5acfb-113">For more information, see [Integration Services &#40;SSIS&#41; Expressions](expressions/integration-services-ssis-expressions.md).</span></span>  
  
 <span data-ttu-id="5acfb-114">在下圖中，工作 A 及工作 B 由使用執行結果及運算式的優先順序條件約束連結。</span><span class="sxs-lookup"><span data-stu-id="5acfb-114">In the following illustration, task A and task B are linked by a precedence constraint that uses an execution result and an expression.</span></span> <span data-ttu-id="5acfb-115">條件約束值設為 `Success` 且運算式為 `@X >== @Z`。</span><span class="sxs-lookup"><span data-stu-id="5acfb-115">The constraint value is set to `Success` and the expression is  `@X >== @Z`.</span></span> <span data-ttu-id="5acfb-116">工作 B (受條件約束的工作) 只在工作 A 順利完成且變數 `X` 的值大於或等於變數 `Z` 的值時執行。</span><span class="sxs-lookup"><span data-stu-id="5acfb-116">Task B, the constrained task, runs only if task A completes successfully and the value of variable `X` is greater than or equal to the value of variable `Z`.</span></span>  
  
 <span data-ttu-id="5acfb-117">![兩個工作之間的優先順序條件約束](media/mw-dts-03.gif "兩個工作之間的優先順序條件約束")</span><span class="sxs-lookup"><span data-stu-id="5acfb-117">![Precedence constraint between two tasks](media/mw-dts-03.gif "Precedence constraint between two tasks")</span></span>  
  
 <span data-ttu-id="5acfb-118">可執行檔也可以使用包含不同運算式的多個優先順序條件約束來連結。</span><span class="sxs-lookup"><span data-stu-id="5acfb-118">Executables can also be linked by using multiple precedence constraints that contain different expressions.</span></span> <span data-ttu-id="5acfb-119">例如在下圖中，工作 B 和 C 由使用執行結果及運算式的優先順序條件約束連結至工作 A。</span><span class="sxs-lookup"><span data-stu-id="5acfb-119">For example, in the following illustration, tasks B and C are linked to task A by precedence constraints that use execution results and expressions.</span></span> <span data-ttu-id="5acfb-120">兩個條件約束值都設為 `Success.`。一個優先順序條件約束包含運算式 `@X >== @Z`，另一個優先順序條件約束包含運算式 `@X < @Z`。</span><span class="sxs-lookup"><span data-stu-id="5acfb-120">Both of the constraint values are set to `Success.` One precedence constraint includes the expression `@X >== @Z`, and the other precedence constraint includes the expression `@X < @Z`.</span></span> <span data-ttu-id="5acfb-121">視變數 `X` 與 `Z` 的值而定，工作 C 或工作 B 會執行。</span><span class="sxs-lookup"><span data-stu-id="5acfb-121">Depending on the values of variable `X` and variable `Z`, either task C or task B runs.</span></span>  
  
 <span data-ttu-id="5acfb-122">![優先順序條件約束上的運算式](media/mw-dts-04.gif "優先順序條件約束上的運算式")</span><span class="sxs-lookup"><span data-stu-id="5acfb-122">![Expressions on precedence constraints](media/mw-dts-04.gif "Expressions on precedence constraints")</span></span>  
  
 <span data-ttu-id="5acfb-123">使用 [[!INCLUDE[ssIS](../includes/ssis-md.md)] 設計師] 中的 [優先順序條件約束編輯器]\*\*\*\* 及 [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] 提供的 [屬性] 視窗，可以新增或修改運算式。</span><span class="sxs-lookup"><span data-stu-id="5acfb-123">You can add or modify an expression by using the **Precedence Constraint Editor** in [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer and the Properties window that [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] provides.</span></span> <span data-ttu-id="5acfb-124">然而，[屬性] 視窗不提供運算式語法的驗證。</span><span class="sxs-lookup"><span data-stu-id="5acfb-124">However, the Properties window does not provide verification of the expression syntax.</span></span>  
  
 <span data-ttu-id="5acfb-125">如果優先順序條件約束包含運算式，則會在 [控制流程]\*\*\*\* 索引標籤之設計介面上優先順序條件約束的旁邊出現圖示，且圖示上的工具提示會顯示運算式。</span><span class="sxs-lookup"><span data-stu-id="5acfb-125">If a precedence constraint includes an expression, an icon appears on the design surface of the **Control Flow** tab, next to the precedence constraint, and the ToolTip on the icon displays the expression.</span></span>  
  
## <a name="combining-execution-values-and-expressions"></a><span data-ttu-id="5acfb-126">組合執行值與運算式</span><span class="sxs-lookup"><span data-stu-id="5acfb-126">Combining Execution Values and Expressions</span></span>  
 <span data-ttu-id="5acfb-127">下表描述將執行值條件約束與優先順序條件約束中的運算式進行組合的影響。</span><span class="sxs-lookup"><span data-stu-id="5acfb-127">The following table describes the effects of combining an execution value constraint and an expression in a precedence constraint.</span></span>  
  
|<span data-ttu-id="5acfb-128">評估作業</span><span class="sxs-lookup"><span data-stu-id="5acfb-128">Evaluation operation</span></span>|<span data-ttu-id="5acfb-129">條件約束評估為</span><span class="sxs-lookup"><span data-stu-id="5acfb-129">Constraint evaluates to</span></span>|<span data-ttu-id="5acfb-130">運算式評估為</span><span class="sxs-lookup"><span data-stu-id="5acfb-130">Expression evaluates to</span></span>|<span data-ttu-id="5acfb-131">受條件約束的可執行檔執行</span><span class="sxs-lookup"><span data-stu-id="5acfb-131">Constrained executable runs</span></span>|  
|--------------------------|-----------------------------|-----------------------------|---------------------------------|  
|<span data-ttu-id="5acfb-132">條件約束</span><span class="sxs-lookup"><span data-stu-id="5acfb-132">Constraint</span></span>|<span data-ttu-id="5acfb-133">是</span><span class="sxs-lookup"><span data-stu-id="5acfb-133">True</span></span>|<span data-ttu-id="5acfb-134">N/A</span><span class="sxs-lookup"><span data-stu-id="5acfb-134">N/A</span></span>|<span data-ttu-id="5acfb-135">是</span><span class="sxs-lookup"><span data-stu-id="5acfb-135">True</span></span>|  
|<span data-ttu-id="5acfb-136">條件約束</span><span class="sxs-lookup"><span data-stu-id="5acfb-136">Constraint</span></span>|<span data-ttu-id="5acfb-137">否</span><span class="sxs-lookup"><span data-stu-id="5acfb-137">False</span></span>|<span data-ttu-id="5acfb-138">N/A</span><span class="sxs-lookup"><span data-stu-id="5acfb-138">N/A</span></span>|<span data-ttu-id="5acfb-139">否</span><span class="sxs-lookup"><span data-stu-id="5acfb-139">False</span></span>|  
|<span data-ttu-id="5acfb-140">運算是</span><span class="sxs-lookup"><span data-stu-id="5acfb-140">Expression</span></span>|<span data-ttu-id="5acfb-141">N/A</span><span class="sxs-lookup"><span data-stu-id="5acfb-141">N/A</span></span>|<span data-ttu-id="5acfb-142">True</span><span class="sxs-lookup"><span data-stu-id="5acfb-142">True</span></span>|<span data-ttu-id="5acfb-143">True</span><span class="sxs-lookup"><span data-stu-id="5acfb-143">True</span></span>|  
|<span data-ttu-id="5acfb-144">運算是</span><span class="sxs-lookup"><span data-stu-id="5acfb-144">Expression</span></span>|<span data-ttu-id="5acfb-145">N/A</span><span class="sxs-lookup"><span data-stu-id="5acfb-145">N/A</span></span>|<span data-ttu-id="5acfb-146">False</span><span class="sxs-lookup"><span data-stu-id="5acfb-146">False</span></span>|<span data-ttu-id="5acfb-147">False</span><span class="sxs-lookup"><span data-stu-id="5acfb-147">False</span></span>|  
|<span data-ttu-id="5acfb-148">條件約束與運算式</span><span class="sxs-lookup"><span data-stu-id="5acfb-148">Constraint and Expression</span></span>|<span data-ttu-id="5acfb-149">True</span><span class="sxs-lookup"><span data-stu-id="5acfb-149">True</span></span>|<span data-ttu-id="5acfb-150">True</span><span class="sxs-lookup"><span data-stu-id="5acfb-150">True</span></span>|<span data-ttu-id="5acfb-151">True</span><span class="sxs-lookup"><span data-stu-id="5acfb-151">True</span></span>|  
|<span data-ttu-id="5acfb-152">條件約束與運算式</span><span class="sxs-lookup"><span data-stu-id="5acfb-152">Constraint and Expression</span></span>|<span data-ttu-id="5acfb-153">是</span><span class="sxs-lookup"><span data-stu-id="5acfb-153">True</span></span>|<span data-ttu-id="5acfb-154">False</span><span class="sxs-lookup"><span data-stu-id="5acfb-154">False</span></span>|<span data-ttu-id="5acfb-155">False</span><span class="sxs-lookup"><span data-stu-id="5acfb-155">False</span></span>|  
|<span data-ttu-id="5acfb-156">條件約束與運算式</span><span class="sxs-lookup"><span data-stu-id="5acfb-156">Constraint and Expression</span></span>|<span data-ttu-id="5acfb-157">False</span><span class="sxs-lookup"><span data-stu-id="5acfb-157">False</span></span>|<span data-ttu-id="5acfb-158">True</span><span class="sxs-lookup"><span data-stu-id="5acfb-158">True</span></span>|<span data-ttu-id="5acfb-159">否</span><span class="sxs-lookup"><span data-stu-id="5acfb-159">False</span></span>|  
|<span data-ttu-id="5acfb-160">條件約束與運算式</span><span class="sxs-lookup"><span data-stu-id="5acfb-160">Constraint and Expression</span></span>|<span data-ttu-id="5acfb-161">False</span><span class="sxs-lookup"><span data-stu-id="5acfb-161">False</span></span>|<span data-ttu-id="5acfb-162">False</span><span class="sxs-lookup"><span data-stu-id="5acfb-162">False</span></span>|<span data-ttu-id="5acfb-163">False</span><span class="sxs-lookup"><span data-stu-id="5acfb-163">False</span></span>|  
|<span data-ttu-id="5acfb-164">條件約束或運算式</span><span class="sxs-lookup"><span data-stu-id="5acfb-164">Constraint or Expression</span></span>|<span data-ttu-id="5acfb-165">True</span><span class="sxs-lookup"><span data-stu-id="5acfb-165">True</span></span>|<span data-ttu-id="5acfb-166">True</span><span class="sxs-lookup"><span data-stu-id="5acfb-166">True</span></span>|<span data-ttu-id="5acfb-167">True</span><span class="sxs-lookup"><span data-stu-id="5acfb-167">True</span></span>|  
|<span data-ttu-id="5acfb-168">條件約束或運算式</span><span class="sxs-lookup"><span data-stu-id="5acfb-168">Constraint or Expression</span></span>|<span data-ttu-id="5acfb-169">是</span><span class="sxs-lookup"><span data-stu-id="5acfb-169">True</span></span>|<span data-ttu-id="5acfb-170">False</span><span class="sxs-lookup"><span data-stu-id="5acfb-170">False</span></span>|<span data-ttu-id="5acfb-171">True</span><span class="sxs-lookup"><span data-stu-id="5acfb-171">True</span></span>|  
|<span data-ttu-id="5acfb-172">條件約束或運算式</span><span class="sxs-lookup"><span data-stu-id="5acfb-172">Constraint or Expression</span></span>|<span data-ttu-id="5acfb-173">False</span><span class="sxs-lookup"><span data-stu-id="5acfb-173">False</span></span>|<span data-ttu-id="5acfb-174">True</span><span class="sxs-lookup"><span data-stu-id="5acfb-174">True</span></span>|<span data-ttu-id="5acfb-175">True</span><span class="sxs-lookup"><span data-stu-id="5acfb-175">True</span></span>|  
|<span data-ttu-id="5acfb-176">條件約束或運算式</span><span class="sxs-lookup"><span data-stu-id="5acfb-176">Constraint or Expression</span></span>|<span data-ttu-id="5acfb-177">False</span><span class="sxs-lookup"><span data-stu-id="5acfb-177">False</span></span>|<span data-ttu-id="5acfb-178">False</span><span class="sxs-lookup"><span data-stu-id="5acfb-178">False</span></span>|<span data-ttu-id="5acfb-179">False</span><span class="sxs-lookup"><span data-stu-id="5acfb-179">False</span></span>|  
  
### <a name="to-add-an-expression-to-a-precedence-constraint"></a><span data-ttu-id="5acfb-180">將運算式加入優先順序條件約束</span><span class="sxs-lookup"><span data-stu-id="5acfb-180">To add an expression to a precedence constraint</span></span>  
  
-   [<span data-ttu-id="5acfb-181">在優先順序條件約束中使用運算式</span><span class="sxs-lookup"><span data-stu-id="5acfb-181">Use an Expression in a Precedence Constraint</span></span>](../../2014/integration-services/use-an-expression-in-a-precedence-constraint.md)  
  
-   [<span data-ttu-id="5acfb-182">設定優先順序條件約束的屬性</span><span class="sxs-lookup"><span data-stu-id="5acfb-182">Set the Properties of a Precedence Constraint</span></span>](../../2014/integration-services/set-the-properties-of-a-precedence-constraint.md)  
  
## <a name="external-resources"></a><span data-ttu-id="5acfb-183">外部資源</span><span class="sxs-lookup"><span data-stu-id="5acfb-183">External Resources</span></span>  
 <span data-ttu-id="5acfb-184">social.technet.microsoft.com 上的技術文件： [SSIS 運算式範例](https://go.microsoft.com/fwlink/?LinkId=220761)</span><span class="sxs-lookup"><span data-stu-id="5acfb-184">Technical article, [SSIS Expression Examples](https://go.microsoft.com/fwlink/?LinkId=220761), on social.technet.microsoft.com</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5acfb-185">另請參閱</span><span class="sxs-lookup"><span data-stu-id="5acfb-185">See Also</span></span>  
 <span data-ttu-id="5acfb-186">[多個優先順序條件約束](../../2014/integration-services/multiple-precedence-constraints.md) </span><span class="sxs-lookup"><span data-stu-id="5acfb-186">[Multiple Precedence Constraints](../../2014/integration-services/multiple-precedence-constraints.md) </span></span>  
 [<span data-ttu-id="5acfb-187">優先順序條件約束</span><span class="sxs-lookup"><span data-stu-id="5acfb-187">Precedence Constraints</span></span>](control-flow/precedence-constraints.md)  
  
  
