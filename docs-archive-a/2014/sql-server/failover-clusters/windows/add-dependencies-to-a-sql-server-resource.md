---
title: 將相依性加入 SQL Server 資源 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- resource dependencies [SQL Server]
- failover clustering [SQL Server], dependencies
- clusters [SQL Server], dependencies
- dependencies [SQL Server], clustering
ms.assetid: 25dbb751-139b-4c8e-ac62-3ec23110611f
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 8610d3dc847d0d2b8dd6f570aa543d766adf68c0
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87595578"
---
# <a name="add-dependencies-to-a-sql-server-resource"></a><span data-ttu-id="e276c-102">將相依性加入 SQL Server 資源</span><span class="sxs-lookup"><span data-stu-id="e276c-102">Add Dependencies to a SQL Server Resource</span></span>
  <span data-ttu-id="e276c-103">此主題描述如何使用容錯移轉叢集管理員嵌入式管理單元，將相依性加入至 AlwaysOn 容錯移轉叢集執行個體 (FCI) 資源。</span><span class="sxs-lookup"><span data-stu-id="e276c-103">This topic describes how to add dependencies to an AlwaysOn Failover Cluster Instance (FCI) resource by using the Failover Cluster Manager snap-in.</span></span> <span data-ttu-id="e276c-104">容錯移轉叢集管理員嵌入式管理單元是 Windows Server 容錯移轉叢集 (WSFC) 服務的叢集管理應用程式。</span><span class="sxs-lookup"><span data-stu-id="e276c-104">The Failover Cluster Manager snap-in is the cluster management application for the Windows Server Failover Clustering (WSFC) service.</span></span>  
  
-   <span data-ttu-id="e276c-105">**開始之前：** [限制事項](#Restrictions)、[必要條件](#Prerequisites)</span><span class="sxs-lookup"><span data-stu-id="e276c-105">**Before you begin:**  [Limitations and Restrictions](#Restrictions), [Prerequisites](#Prerequisites)</span></span>  
  
-   <span data-ttu-id="e276c-106">**使用下列項目將相依性新增至 SQL Server 資源：** [Windows 容錯移轉叢集管理員](#WinClusManager)</span><span class="sxs-lookup"><span data-stu-id="e276c-106">**To add a dependency to a SQL Server resource, using:** [Windows Failover Cluster Manager](#WinClusManager)</span></span>  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="e276c-107">開始之前</span><span class="sxs-lookup"><span data-stu-id="e276c-107">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="e276c-108">限制事項</span><span class="sxs-lookup"><span data-stu-id="e276c-108">Limitations and Restrictions</span></span>  
 <span data-ttu-id="e276c-109">如果將任何其他資源新增到 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 群組，那些資源必須永遠有唯一的 SQL 網路名稱資源以及它們自己的 SQL IP 位址資源，這是很重要的一點。</span><span class="sxs-lookup"><span data-stu-id="e276c-109">It is important to note that if you add any other resources to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] group, those resources must always have their own unique SQL network name resources and their own SQL IP address resources.</span></span>  
  
 <span data-ttu-id="e276c-110">請不要在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]以外的地方，使用現有的 SQL 網路名稱資源與 SQL IP 位址資源。</span><span class="sxs-lookup"><span data-stu-id="e276c-110">Do not use the existing SQL network name resources and SQL IP address resources for anything other than [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="e276c-111">如果與其他資源共用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 資源，可能會發生以下問題：</span><span class="sxs-lookup"><span data-stu-id="e276c-111">If [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] resources are shared with other resources, the following problems may occur:</span></span>  
  
-   <span data-ttu-id="e276c-112">可能會發生未預期的過時狀況。</span><span class="sxs-lookup"><span data-stu-id="e276c-112">Outages that are not expected may occur.</span></span>  
  
-   <span data-ttu-id="e276c-113">可能無法順利安裝 Service Pack。</span><span class="sxs-lookup"><span data-stu-id="e276c-113">Service pack installations may not be successful.</span></span>  
  
-   <span data-ttu-id="e276c-114">可能無法順利進行 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安裝程式。</span><span class="sxs-lookup"><span data-stu-id="e276c-114">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup program may not be successful.</span></span> <span data-ttu-id="e276c-115">如果發生這個問題，您就無法安裝其他的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 執行個體，或執行例行的維護工作。</span><span class="sxs-lookup"><span data-stu-id="e276c-115">If this problem occurs, you cannot install additional instances of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] or perform routine maintenance.</span></span>  
  
 <span data-ttu-id="e276c-116">請考慮這些額外問題：</span><span class="sxs-lookup"><span data-stu-id="e276c-116">Consider these additional issues:</span></span>  
  
-   <span data-ttu-id="e276c-117">具 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 複寫功能的 FTP：對於使用具 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 複寫功能 FTP 的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 執行個體，FTP 服務所使用實體磁碟必須與設定要使用 FTP 服務的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安裝相同。</span><span class="sxs-lookup"><span data-stu-id="e276c-117">FTP with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] replication: For instances of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that use FTP with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] replication, your FTP service must use one of the same physical disks as the installation of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that is set up to use the FTP service.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="e276c-118">資源相依性：如果您將資源新增至 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 群組，且要仰賴該 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 資源以確保能夠使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]，[!INCLUDE[msCoName](../../../includes/msconame-md.md)] 建議您在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent 資源上新增相依性。</span><span class="sxs-lookup"><span data-stu-id="e276c-118">resource dependencies: If you add a resource to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] group and you have a dependency on the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] resource to make sure that [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is available, [!INCLUDE[msCoName](../../../includes/msconame-md.md)] recommends that you add a dependency on the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent resource.</span></span> <span data-ttu-id="e276c-119">請不要在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 資源上新增相依性。</span><span class="sxs-lookup"><span data-stu-id="e276c-119">Do not add a dependency on the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] resource.</span></span> <span data-ttu-id="e276c-120">若要確定執行 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的電腦維持在高度可用的狀態，請設定 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 資源，這樣如果 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 資源發生失敗，就不會影響到 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 群組。</span><span class="sxs-lookup"><span data-stu-id="e276c-120">To make sure that the computer that is running [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] remains highly available, configure the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent resource so that it does not affect the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] group if the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent resource fails.</span></span>  
  
-   <span data-ttu-id="e276c-121">檔案共用與印表機資源：安裝「檔案共用」資源或「印表機」叢集資源時，不應該將它們放在與執行 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的電腦相同實體磁碟資源上。</span><span class="sxs-lookup"><span data-stu-id="e276c-121">File shares and printer resources: When you install File Share resources or Printer cluster resources, they should not be put on the same physical disk resources as the computer that is running [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="e276c-122">如果它們都放在相同的實體磁碟資源上，效能可能會降低，而且執行 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]的電腦可能會失去服務能力。</span><span class="sxs-lookup"><span data-stu-id="e276c-122">If they are put on the same physical disk resources, you may experience performance degradation and loss of service to the computer that is running [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="e276c-123">MS DTC 考量：安裝作業系統並設定 FCI 之後，您必須使用容錯移轉叢集管理員嵌入式管理單元，設定 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] 分散式交易協調器 (MS DTC) 在叢集中使用。</span><span class="sxs-lookup"><span data-stu-id="e276c-123">MS DTC considerations: After you install the operating system and configure your FCI, you must configure [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Distributed Transaction Coordinator (MS DTC) to work in a cluster by using the Failover Cluster Manager snap-in.</span></span> <span data-ttu-id="e276c-124">如果無法將 MS DTC 設定為搭配群集使用，也不會封鎖 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安裝程式，但如果沒有正確設定 MS DTC，則 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 應用程式功能可能會受到影響。</span><span class="sxs-lookup"><span data-stu-id="e276c-124">Failure to cluster MS DTC will not block [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup, but [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] application functionality may be affected if MS DTC is not properly configured.</span></span>  
  
     <span data-ttu-id="e276c-125">如果將 MS DTC 安裝在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 群組中，而且您有其他相依於 MS DTC 的資源，當此群組離線或發生容錯移轉時，MS DTC 將無法使用。</span><span class="sxs-lookup"><span data-stu-id="e276c-125">If you install MS DTC in your [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] group and you have other resources that are dependent on MS DTC, MS DTC will not be available if this group is offline or during a failover.</span></span> [!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="e276c-126">建議您將 MS DTC 放在本身具有實體磁碟資源的群組中 (如果可能)。</span><span class="sxs-lookup"><span data-stu-id="e276c-126">recommends that you put MS DTC in its own group with its own physical disk resource, if it is possible.</span></span>  
  
###  <a name="prerequisites"></a><a name="Prerequisites"></a> <span data-ttu-id="e276c-127">必要條件</span><span class="sxs-lookup"><span data-stu-id="e276c-127">Prerequisites</span></span>  
 <span data-ttu-id="e276c-128">如果將 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安裝到具有多部磁碟機的 WSFC 資源群組中，並選擇將您的資料放在其中一部磁碟機上，則 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 資源會被設定為僅相依於該磁碟機。</span><span class="sxs-lookup"><span data-stu-id="e276c-128">If you install [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] into a WSFC resource group with multiple disk drives and choose to place your data on one of the drives, the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] resource will be set to be dependent only on that drive.</span></span> <span data-ttu-id="e276c-129">若要將資料或記錄檔放到其他磁碟，您就必須先對那台磁碟的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 資源新增相依性。</span><span class="sxs-lookup"><span data-stu-id="e276c-129">To put data or logs on another disk, you must first add a dependency to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] resource for the additional disk.</span></span>  
  
##  <a name="using-the-failover-cluster-manager-snap-in"></a><a name="WinClusManager"></a> <span data-ttu-id="e276c-130">使用容錯移轉叢集管理員嵌入式管理單元</span><span class="sxs-lookup"><span data-stu-id="e276c-130">Using the Failover Cluster Manager Snap-in</span></span>  
 <span data-ttu-id="e276c-131">**加入 SQL Server 資源的相依性**</span><span class="sxs-lookup"><span data-stu-id="e276c-131">**To add a dependency to a SQL Server resource**</span></span>  
  
-   <span data-ttu-id="e276c-132">開啟 [容錯移轉叢集管理員] 嵌入式管理單元。</span><span class="sxs-lookup"><span data-stu-id="e276c-132">Open the Failover Cluster Manager snap-in.</span></span>  
  
-   <span data-ttu-id="e276c-133">找出包含要依存之適用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 資源的群組。</span><span class="sxs-lookup"><span data-stu-id="e276c-133">Locate the group that contains the applicable [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] resource that you would like to make dependent.</span></span>  
  
-   <span data-ttu-id="e276c-134">如果這個群組中已經具有磁碟的資源，請移至步驟 4。</span><span class="sxs-lookup"><span data-stu-id="e276c-134">If the resource for the disk is already in this group, go to step 4.</span></span> <span data-ttu-id="e276c-135">否則請尋找包含該磁碟的群組。</span><span class="sxs-lookup"><span data-stu-id="e276c-135">Otherwise, locate the group that contains the disk.</span></span> <span data-ttu-id="e276c-136">如果該群組與包含 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的群組各由不同的節點所擁有，請將包含磁碟資源的群組移到擁有 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 群組的節點。</span><span class="sxs-lookup"><span data-stu-id="e276c-136">If that group and the group that contains [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] are not owned by the same node, move the group containing the resource for the disk to the node that owns the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] group.</span></span>  
  
-   <span data-ttu-id="e276c-137">選取 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 資源，開啟 **[屬性]** 對話方塊，並使用 **[相依性]** 索引標籤，將磁碟加入至 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的相依性集合。</span><span class="sxs-lookup"><span data-stu-id="e276c-137">Select the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] resource, open the **Properties** dialog box, and use the **Dependencies** tab to add the disk to the set of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] dependencies.</span></span>  
  
  
