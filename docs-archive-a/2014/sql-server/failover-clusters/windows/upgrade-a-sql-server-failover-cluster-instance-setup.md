---
title: 升級 SQL Server 容錯移轉叢集執行個體 (安裝程式) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- upgrading clusters
- clusters [SQL Server], upgrading
- failover clustering [SQL Server], creating clusters
- clusters [SQL Server], creating
- failover clustering [SQL Server], upgrading
ms.assetid: ea8b7d66-e5a1-402f-9928-8f7310e84f5c
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: a45628055ee12f5d771c863dec7a3368cdae5940
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87708109"
---
# <a name="upgrade-a-sql-server-failover-cluster-instance-setup"></a><span data-ttu-id="a7585-102">升級 SQL Server 容錯移轉叢集執行個體 (安裝程式)</span><span class="sxs-lookup"><span data-stu-id="a7585-102">Upgrade a SQL Server Failover Cluster Instance (Setup)</span></span>
  <span data-ttu-id="a7585-103">您可以使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安裝精靈或命令提示字元，將 [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] 容錯移轉叢集升級為 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 容錯移轉叢集。</span><span class="sxs-lookup"><span data-stu-id="a7585-103">You can upgrade a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster to a [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] failover cluster by using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Installation Wizard or a command prompt.</span></span>  
  
 <span data-ttu-id="a7585-104">在容錯移轉叢集升級期間，停機時間僅包含容錯移轉時間以及執行升級指令碼所需的時間。</span><span class="sxs-lookup"><span data-stu-id="a7585-104">During the failover cluster upgrade, downtime is limited to failover time and the time that is required for upgrade scripts to run.</span></span> <span data-ttu-id="a7585-105">如果您遵循容錯移轉叢集輪流升級程序，就會將停機時間減到最少。</span><span class="sxs-lookup"><span data-stu-id="a7585-105">If you follow the failover cluster rolling upgrade process, your downtime is minimal.</span></span> <span data-ttu-id="a7585-106">視您是否在容錯移轉叢集節點上設有所有必要元件而定，您可能會在安裝這些必要元件時造成額外的停機時間。</span><span class="sxs-lookup"><span data-stu-id="a7585-106">Depending on whether you have all the prerequisites on the failover cluster nodes, you might incur additional downtime while you install these prerequisites.</span></span> <span data-ttu-id="a7585-107">如需有關如何在升級期間將停機時間降至最低的詳細資訊，請參閱此頁面上的[升級容錯移轉叢集之前的最佳作法](#BestPractices)一節。</span><span class="sxs-lookup"><span data-stu-id="a7585-107">For more information about how to minimize the downtime during upgrade, see the [Best Practices Before Upgrading Failover Cluster](#BestPractices) section on this page.</span></span>  
  
 <span data-ttu-id="a7585-108">如需如何升級的詳細資訊，請參閱[支援的版本與版本升級](../../../database-engine/install-windows/supported-version-and-edition-upgrades.md)和[升級至 SQL Server 2014](../../../database-engine/install-windows/upgrade-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="a7585-108">For more information about how to upgrade, see [Supported Version and Edition Upgrades](../../../database-engine/install-windows/supported-version-and-edition-upgrades.md) and [Upgrade to SQL Server 2014](../../../database-engine/install-windows/upgrade-sql-server.md).</span></span>  
  
 <span data-ttu-id="a7585-109">如需命令提示字元使用方式範例語法的詳細資訊，請參閱[從命令提示字元安裝 SQL Server 2014](../../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md)。</span><span class="sxs-lookup"><span data-stu-id="a7585-109">For more information about sample syntax for command prompt usage, see [Install SQL Server 2014 from the Command Prompt](../../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md).</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="a7585-110">Prerequisites</span><span class="sxs-lookup"><span data-stu-id="a7585-110">Prerequisites</span></span>  
 <span data-ttu-id="a7585-111">在開始之前，請檢閱以下重要資訊：</span><span class="sxs-lookup"><span data-stu-id="a7585-111">Before you begin, review the following important information:</span></span>  
  
-   [<span data-ttu-id="a7585-112">安裝容錯移轉叢集之前</span><span class="sxs-lookup"><span data-stu-id="a7585-112">Before Installing Failover Clustering</span></span>](../install/before-installing-failover-clustering.md)  
  
-   <span data-ttu-id="a7585-113">[使用 Upgrade Advisor 來準備升級](../../install/use-upgrade-advisor-to-prepare-for-upgrades.md)。</span><span class="sxs-lookup"><span data-stu-id="a7585-113">[Use Upgrade Advisor to Prepare for Upgrades](../../install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span></span>  
  
-   [<span data-ttu-id="a7585-114">升級 Database Engine</span><span class="sxs-lookup"><span data-stu-id="a7585-114">Upgrade Database Engine</span></span>](../../../database-engine/install-windows/upgrade-database-engine.md)  
  
-   <span data-ttu-id="a7585-115">安裝程式會在叢集作業系統上安裝 .NET Framework 4.0。</span><span class="sxs-lookup"><span data-stu-id="a7585-115">Setup installs .NET Framework 4.0 on a clustered operating system.</span></span> <span data-ttu-id="a7585-116">若要盡量縮短任何可能的停機時間，您可以考慮在執行安裝程式前先安裝 .NET Framework 4.0。</span><span class="sxs-lookup"><span data-stu-id="a7585-116">To minimize any possible downtime, consider installing .NET Framework 4.0 before you run Setup.</span></span>  
  
-   <span data-ttu-id="a7585-117">若要確定 Visual Studio 元件可以正確安裝， [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 需要安裝更新。</span><span class="sxs-lookup"><span data-stu-id="a7585-117">To make sure that the Visual Studio component can be installed correctly, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] requires you to install an update.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="a7585-118">安裝程式會檢查此更新的狀態，然後需要您下載並安裝更新才能繼續安裝 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a7585-118">Setup checks for the presence of this update and then requires you to download and install the update before you can continue with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] installation.</span></span> <span data-ttu-id="a7585-119">若要避免 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安裝程式期間的中斷，您可以先下載並安裝更新，然後執行如下所述的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安裝程式 (或安裝 Windows Update 上可用 .NET 3.5 SP1 的所有更新)：</span><span class="sxs-lookup"><span data-stu-id="a7585-119">To avoid the interruption during [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup, you can download and install the update before running [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup as described below (or install all the updates for .NET 3.5 SP1 available on Windows Update):</span></span>  
  
     <span data-ttu-id="a7585-120">如果您將安裝 [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] 在 Windows Server 2008 SP2 作業系統的電腦上，您可以從[這裡](https://go.microsoft.com/fwlink/?LinkId=198093)取得所需的更新</span><span class="sxs-lookup"><span data-stu-id="a7585-120">If you install [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] on a computer with the Windows Server 2008 SP2 operating system, you can get the required update from [here](https://go.microsoft.com/fwlink/?LinkId=198093)</span></span>  
  
     <span data-ttu-id="a7585-121">如果您將 [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] 安裝在 [!INCLUDE[win7](../../../includes/win7-md.md)] SP1 或 [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)] SP1 作業系統的電腦上，則已包含此更新。</span><span class="sxs-lookup"><span data-stu-id="a7585-121">If you install [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] on a computer with the [!INCLUDE[win7](../../../includes/win7-md.md)] SP1 or [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)] SP1 operating system, this update in included.</span></span>  
  
-   <span data-ttu-id="a7585-122">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安裝程式不再安裝 .NET Framework 3.5 SP1，但是在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 上安裝 [!INCLUDE[firstref_longhorn](../../../includes/firstref-longhorn-md.md)] 時，可能會需要 .NET Framework 3.5 SP1。</span><span class="sxs-lookup"><span data-stu-id="a7585-122">.NET Framework 3.5 SP1 is no longer installed by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup, but may be required while installing [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] on [!INCLUDE[firstref_longhorn](../../../includes/firstref-longhorn-md.md)].</span></span> <span data-ttu-id="a7585-123">如需詳細資訊，請參閱 [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] [版本](https://go.microsoft.com/fwlink/?LinkId=296445)資訊。</span><span class="sxs-lookup"><span data-stu-id="a7585-123">For more information, see [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)][Release Notes](https://go.microsoft.com/fwlink/?LinkId=296445).</span></span>  
  
-   <span data-ttu-id="a7585-124">若是本機安裝，您必須以管理員身分執行 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安裝程式。</span><span class="sxs-lookup"><span data-stu-id="a7585-124">For local installations, you must run [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup as an administrator.</span></span> <span data-ttu-id="a7585-125">如果您是從遠端共用位置安裝 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ，則必須使用對遠端共用位置具有讀取權限的網域帳戶。</span><span class="sxs-lookup"><span data-stu-id="a7585-125">If you install [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] from a remote share, you must use a domain account that has read permissions on the remote share.</span></span>  
  
-   <span data-ttu-id="a7585-126">若要將實例升級 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 為 [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] 容錯移轉叢集，要升級的實例必須是容錯移轉叢集。</span><span class="sxs-lookup"><span data-stu-id="a7585-126">To upgrade an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to a [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] failover cluster, the instance being upgraded must be a failover cluster.</span></span>  
  
     <span data-ttu-id="a7585-127">若要將獨立的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 執行個體移動到 [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] 容錯移轉叢集，請安裝新的 [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] 容錯移轉叢集，然後利用「複製資料庫精靈」，從獨立的執行個體移轉使用者資料庫。</span><span class="sxs-lookup"><span data-stu-id="a7585-127">To move a stand-alone instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to a [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] failover cluster, install a new [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] failover cluster, and then migrate user databases from the stand-alone instance by using the Copy Database Wizard.</span></span> <span data-ttu-id="a7585-128">如需詳細資訊，請參閱 [Use the Copy Database Wizard](../../../relational-databases/databases/use-the-copy-database-wizard.md)。</span><span class="sxs-lookup"><span data-stu-id="a7585-128">For more information, see [Use the Copy Database Wizard](../../../relational-databases/databases/use-the-copy-database-wizard.md).</span></span>  
  
## <a name="rolling-upgrades"></a><span data-ttu-id="a7585-129">輪流升級</span><span class="sxs-lookup"><span data-stu-id="a7585-129">Rolling Upgrades</span></span>  
 <span data-ttu-id="a7585-130">若要將 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 容錯移轉叢集升級為 [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)]，您必須在每個容錯移轉叢集節點上使用升級動作來執行安裝程式 (從被動節點開始，一次一個)。</span><span class="sxs-lookup"><span data-stu-id="a7585-130">To upgrade a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster to [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)], you must run setup with upgrade action on each failover cluster node, one at a time, starting with the passive nodes.</span></span> <span data-ttu-id="a7585-131">當您升級每個節點時，它就不會包含在容錯移轉叢集的可能擁有者中。</span><span class="sxs-lookup"><span data-stu-id="a7585-131">As you upgrade each node, it is left out of the possible owners of the failover cluster.</span></span> <span data-ttu-id="a7585-132">如果發生非預期的容錯移轉，在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安裝程式將叢集資源群組擁有權移至升級的節點之前，升級的節點不會參與容錯移轉。</span><span class="sxs-lookup"><span data-stu-id="a7585-132">If there is an unexpected failover, the upgraded nodes do not participate in the failover until cluster resource group ownership is moved to an upgraded node by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup.</span></span>  
  
 <span data-ttu-id="a7585-133">根據預設，安裝程式會自動決定容錯移轉至升級節點的時機。</span><span class="sxs-lookup"><span data-stu-id="a7585-133">By default, Setup automatically determines when to fail over to an upgraded node.</span></span> <span data-ttu-id="a7585-134">這個時機會取決於容錯移轉叢集執行個體中的節點總數以及已經升級的節點數目而定。</span><span class="sxs-lookup"><span data-stu-id="a7585-134">This depends on the total number of nodes in the failover cluster instance and the number of nodes that have already been upgraded.</span></span> <span data-ttu-id="a7585-135">如果半數以上的節點都已經升級，當您在下一個節點上執行升級時，安裝程式就會導致系統容錯移轉至升級的節點。</span><span class="sxs-lookup"><span data-stu-id="a7585-135">When half of the nodes or more have already been upgraded, Setup causes a failover to an upgraded node when you perform upgrade on the next node.</span></span> <span data-ttu-id="a7585-136">容錯移轉至升級的節點之後，叢集群組就會移至升級的節點。</span><span class="sxs-lookup"><span data-stu-id="a7585-136">Upon failover to an upgraded node, the cluster group is moved to an upgraded node.</span></span> <span data-ttu-id="a7585-137">系統會將所有升級的節點都放置在可能擁有者的清單中，並從可能擁有者的清單中移除尚未升級的所有節點。</span><span class="sxs-lookup"><span data-stu-id="a7585-137">All the upgraded nodes are put in the possible owners list and all the nodes that are not yet upgraded are removed from the possible owners list.</span></span> <span data-ttu-id="a7585-138">當您升級其餘每個節點時，它就會加入至容錯移轉叢集的可能擁有者。</span><span class="sxs-lookup"><span data-stu-id="a7585-138">As you upgrade each remaining node, it is added to the possible owners of the failover cluster.</span></span>  
  
 <span data-ttu-id="a7585-139">這個程序會導致停機時間僅會包含整個容錯移轉叢集升級期間的單一容錯移轉時間和資料庫升級指令碼執行時間。</span><span class="sxs-lookup"><span data-stu-id="a7585-139">This process results in downtime limited to one failover time and database upgrade script execution time during the whole failover cluster upgrade.</span></span>  
  
 <span data-ttu-id="a7585-140">若要在升級程序期間控制叢集節點的容錯移轉行為，請從命令提示字元執行升級作業，然後使用 /FAILOVERCLUSTERROLLOWNERSHIP 參數。</span><span class="sxs-lookup"><span data-stu-id="a7585-140">To control the failover behavior of cluster nodes during the upgrade process, run the upgrade operation at the command prompt and use the /FAILOVERCLUSTERROLLOWNERSHIP parameter.</span></span> <span data-ttu-id="a7585-141">如需詳細資訊，請參閱[從命令提示字元安裝 SQL Server 2014](../../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md)。</span><span class="sxs-lookup"><span data-stu-id="a7585-141">For more information, see [Install SQL Server 2014 from the Command Prompt](../../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md).</span></span>  
  
 <span data-ttu-id="a7585-142">**注意**如果有單一節點容錯移轉叢集， [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安裝程式會讓 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 資源群組離線。</span><span class="sxs-lookup"><span data-stu-id="a7585-142">**Note** If there is a single-node failover cluster, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup takes the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] resource group offline.</span></span>  
  
## <a name="considerations-when-upgrading-from-ssversion2005"></a><span data-ttu-id="a7585-143">從 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 升級時的考量</span><span class="sxs-lookup"><span data-stu-id="a7585-143">Considerations when Upgrading from [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]</span></span>  
 <span data-ttu-id="a7585-144">如果您為叢集安全性原則指定了網域群組，就無法在 [!INCLUDE[nextref_longhorn](../../../includes/nextref-longhorn-md.md)] 上指定服務 SID。</span><span class="sxs-lookup"><span data-stu-id="a7585-144">If you specified domain groups for the cluster security policy, you cannot specify service SID on [!INCLUDE[nextref_longhorn](../../../includes/nextref-longhorn-md.md)].</span></span> <span data-ttu-id="a7585-145">如果您想要使用服務 SID，則需要執行並存升級。</span><span class="sxs-lookup"><span data-stu-id="a7585-145">If you want to use the service SID, you need to perform a side by side upgrade.</span></span>  
  
 <span data-ttu-id="a7585-146">當您選取 [!INCLUDE[ssDE](../../../includes/ssde-md.md)] 進行升級時，全文檢索搜尋會包含在安裝程式中，不論它是否已在 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 中安裝。</span><span class="sxs-lookup"><span data-stu-id="a7585-146">When you select [!INCLUDE[ssDE](../../../includes/ssde-md.md)] for upgrade, full-text search is included in the setup regardless of whether it was installed in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span>  
  
 <span data-ttu-id="a7585-147">如果已在 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 中啟用全文檢索搜尋，安裝程式會重建全文檢索搜尋目錄，不論可供您使用的選項為何。</span><span class="sxs-lookup"><span data-stu-id="a7585-147">If full-text search was enabled in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], Setup rebuilds the full-text search catalog regardless of the options available to you.</span></span>  
  
## <a name="upgrading-to-a-sssql14-multi-subnet-failover-cluster"></a><span data-ttu-id="a7585-148">升級至 [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] 多重子網路容錯移轉叢集</span><span class="sxs-lookup"><span data-stu-id="a7585-148">Upgrading to a [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] Multi-Subnet Failover Cluster</span></span>  
 <span data-ttu-id="a7585-149">可能的升級案例有兩種：</span><span class="sxs-lookup"><span data-stu-id="a7585-149">There are two possible scenarios for upgrades:</span></span>  
  
1.  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="a7585-150">容錯移轉叢集目前設定在單一子網路上：您必須先啟動安裝程式，並遵循升級程序進行，以將現有叢集升級至 [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a7585-150">failover cluster is currently configured on a single subnet: You must first upgrade the existing cluster to [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] by launching Setup and following the upgrade process.</span></span> <span data-ttu-id="a7585-151">在完成升級現有的容錯移轉叢集之後，使用 AddNode 功能，以加入位在不同子網路上的節點。</span><span class="sxs-lookup"><span data-stu-id="a7585-151">After completing the upgrade of the existing failover cluster, add a node that is on a different subnet using the AddNode functionality.</span></span> <span data-ttu-id="a7585-152">請確認叢集網路組態頁面中的 IP 位址資源相依性已變更為 OR。</span><span class="sxs-lookup"><span data-stu-id="a7585-152">Confirm the IP address resource dependency change to OR in the cluster network configuration page.</span></span> <span data-ttu-id="a7585-153">您現在已擁有 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 多重子網路容錯移轉叢集。</span><span class="sxs-lookup"><span data-stu-id="a7585-153">You now have a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] multi-subnet failover cluster.</span></span>  
  
2.  <span data-ttu-id="a7585-154">目前已使用延展 V-LAN 技術，將 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 容錯移轉叢集設定在多重子網路中：您必須先將現有的叢集升級到 [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a7585-154">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster is currently configured on multiple subnets using the stretch V-LAN technology: You must first upgrade the existing cluster to [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)].</span></span> <span data-ttu-id="a7585-155">由於延伸 V-LAN 技術會設定單一子網路網路，網路組態必須變更為多重子網路，而且要使用 Windows 容錯移轉叢集管理工具變更 IP 位址資源相依性，並將 IP 相依性變更為 OR。</span><span class="sxs-lookup"><span data-stu-id="a7585-155">Because stretch V-LAN technology configures a single subnet, the network configuration must to be changed to multiple subnets, and change the IP address resource dependency using the Windows Failover Cluster administration tool and change the IP dependency to OR.</span></span>  
  
###  <a name="best-practices-before-upgrading-a-ssnoversion-failover-cluster"></a><a name="BestPractices"></a><span data-ttu-id="a7585-156">升級容錯移轉叢集之前的最佳作法 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="a7585-156">Best Practices Before Upgrading a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Failover Cluster</span></span>  
 <span data-ttu-id="a7585-157">若要排除重新啟動所產生的非預期停機時間，請在所有容錯移轉叢集節點上預先安裝 .NET Framework 4.0 的不必重新開機封裝，然後在叢集節點上執行升級。</span><span class="sxs-lookup"><span data-stu-id="a7585-157">To eliminate unexpected downtime caused by a restart, preinstall the no-reboot package for .NET Framework 4.0 on all the failover cluster nodes before you run the upgrade on the cluster nodes.</span></span> <span data-ttu-id="a7585-158">下面是預先安裝必要元件的建議步驟：</span><span class="sxs-lookup"><span data-stu-id="a7585-158">We recommend the following steps to preinstall the prerequisites:</span></span>  
  
-   <span data-ttu-id="a7585-159">安裝 .NET 4.0 的不必重新開機封裝，並且只升級以被動節點開始的共用元件。</span><span class="sxs-lookup"><span data-stu-id="a7585-159">Install the no-reboot package for .NET Framework 4.0, and upgrade only the shared components starting with the passive nodes.</span></span> <span data-ttu-id="a7585-160">這樣會安裝 [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 4.0、Windows Installer 4.5 和 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的支援檔案。</span><span class="sxs-lookup"><span data-stu-id="a7585-160">This installs [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 4.0, Windows Installer 4.5, and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] support files.</span></span>  
  
-   <span data-ttu-id="a7585-161">視需要重新啟動一次或多次。</span><span class="sxs-lookup"><span data-stu-id="a7585-161">Restart one or more times, as required.</span></span>  
  
-   <span data-ttu-id="a7585-162">容錯移轉至升級的節點。</span><span class="sxs-lookup"><span data-stu-id="a7585-162">Fail over to an upgraded node.</span></span>  
  
-   <span data-ttu-id="a7585-163">在剩餘的最後一個節點上升級共用的元件。</span><span class="sxs-lookup"><span data-stu-id="a7585-163">Upgrade the shared components on the last remaining node.</span></span>  
  
 <span data-ttu-id="a7585-164">當您已經升級所有共用的元件而且已經安裝必要元件之後，請啟動容錯移轉叢集升級程序。</span><span class="sxs-lookup"><span data-stu-id="a7585-164">After all the shared components are upgraded and prerequisites are installed, start the failover cluster upgrade process.</span></span> <span data-ttu-id="a7585-165">您必須在每個容錯移轉叢集節點上執行升級，從被動節點開始而且直到擁有叢集資源群組的節點為止。</span><span class="sxs-lookup"><span data-stu-id="a7585-165">You have to run upgrade on each failover cluster node, starting with the passive nodes first and making your way toward the node that owns the cluster resource group.</span></span>  
  
-   <span data-ttu-id="a7585-166">您無法將功能加入至現有的容錯移轉叢集。</span><span class="sxs-lookup"><span data-stu-id="a7585-166">You cannot add features to an existing failover cluster.</span></span>  
  
-   <span data-ttu-id="a7585-167">變更容錯移轉叢集的版本會受限於特定狀況。</span><span class="sxs-lookup"><span data-stu-id="a7585-167">Changing the edition of the failover cluster is limited to certain scenarios.</span></span> <span data-ttu-id="a7585-168">如需詳細資訊，請參閱 [支援的版本與版本升級](../../../database-engine/install-windows/supported-version-and-edition-upgrades.md)。</span><span class="sxs-lookup"><span data-stu-id="a7585-168">For more information, see [Supported Version and Edition Upgrades](../../../database-engine/install-windows/supported-version-and-edition-upgrades.md).</span></span>  
  
##  <a name="to-upgrade-a-ssnoversion-failover-cluster"></a><a name="UpgradeSteps"></a> <span data-ttu-id="a7585-169">若要升級 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 容錯移轉叢集</span><span class="sxs-lookup"><span data-stu-id="a7585-169">To Upgrade a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Failover Cluster</span></span>  
  
#### <a name="to-upgrade-a-ssnoversion-failover-cluster"></a><span data-ttu-id="a7585-170">若要升級 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 容錯移轉叢集</span><span class="sxs-lookup"><span data-stu-id="a7585-170">To upgrade a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster</span></span>  
  
1.  <span data-ttu-id="a7585-171">插入 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安裝媒體，然後在根資料夾中，按兩下 Setup.exe。</span><span class="sxs-lookup"><span data-stu-id="a7585-171">Insert the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] installation media, and from the root folder, double-click Setup.exe.</span></span> <span data-ttu-id="a7585-172">若要從網路共用區進行安裝，請移到共用區上的根資料夾，然後按兩下 Setup.exe。</span><span class="sxs-lookup"><span data-stu-id="a7585-172">To install from a network share, move to the root folder on the share, and then double-click Setup.exe.</span></span> <span data-ttu-id="a7585-173">如果您之前未安裝必要元件，系統可能會要求您安裝。</span><span class="sxs-lookup"><span data-stu-id="a7585-173">You may be asked to install the prerequisites, if they are not previously installed.</span></span>  
  
2.  > [!IMPORTANT]  
    >  <span data-ttu-id="a7585-174">如需步驟3和4的詳細資訊，請參閱[升級容錯移轉叢集之前的最佳作法](#BestPractices)一節。</span><span class="sxs-lookup"><span data-stu-id="a7585-174">For more information about steps 3 and 4, see the [Best Practices Before Upgrading Failover Cluster](#BestPractices) section.</span></span>  
  
3.  <span data-ttu-id="a7585-175">安裝必要元件之後，安裝精靈會啟動 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安裝中心。</span><span class="sxs-lookup"><span data-stu-id="a7585-175">After prerequisites are installed, the Installation Wizard starts the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Installation Center.</span></span> <span data-ttu-id="a7585-176">若要升級現有的實例 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ，請按一下 [**從、、或升級] [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] 。**</span><span class="sxs-lookup"><span data-stu-id="a7585-176">To upgrade an existing instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], click **Upgrade from [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)], [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)], or [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)].**</span></span>  
  
4.  <span data-ttu-id="a7585-177">如果需要安裝程式支援檔案， [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安裝程式就會安裝這些檔案。</span><span class="sxs-lookup"><span data-stu-id="a7585-177">If Setup support files are required, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup installs them.</span></span> <span data-ttu-id="a7585-178">如果系統指示您重新啟動電腦，請先重新啟動，然後再繼續進行。</span><span class="sxs-lookup"><span data-stu-id="a7585-178">If you are instructed to restart your computer, restart before you continue.</span></span>  
  
5.  <span data-ttu-id="a7585-179">系統組態檢查會在電腦上執行探索作業。</span><span class="sxs-lookup"><span data-stu-id="a7585-179">The System Configuration Checker runs a discovery operation on your computer.</span></span> <span data-ttu-id="a7585-180">若要繼續，請[!INCLUDE[clickOK](../../../includes/clickok-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a7585-180">To continue, [!INCLUDE[clickOK](../../../includes/clickok-md.md)].</span></span>  
  
6.  <span data-ttu-id="a7585-181">在 [產品金鑰] 頁面上，針對符合舊產品版本的新版本輸入 PID 金鑰。</span><span class="sxs-lookup"><span data-stu-id="a7585-181">On the Product Key page, enter the PID key for the new version edition that matches the edition of the old product version.</span></span> <span data-ttu-id="a7585-182">例如，若要升級 Enterprise 容錯移轉叢集，您必須提供 [!INCLUDE[ssEnterprise](../../../includes/ssenterprise-md.md)]的 PID 金鑰。</span><span class="sxs-lookup"><span data-stu-id="a7585-182">For example, to upgrade an Enterprise failover cluster, you must supply a PID key for [!INCLUDE[ssEnterprise](../../../includes/ssenterprise-md.md)].</span></span> <span data-ttu-id="a7585-183">選取 [下一步] 以繼續操作。</span><span class="sxs-lookup"><span data-stu-id="a7585-183">Click **Next** to continue.</span></span> <span data-ttu-id="a7585-184">請注意，您針對容錯移轉叢集升級所使用的 PID 金鑰在相同 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 執行個體的所有容錯移轉叢集節點之間必須一致。</span><span class="sxs-lookup"><span data-stu-id="a7585-184">Be aware that the PID key that you use for a failover cluster upgrade must be consistent across all failover cluster nodes in the same [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="a7585-185">如需詳細資訊，請參閱[SQL Server 2014 的版本和元件](../../editions-and-components-of-sql-server-2016.md)和[支援的版本與版本升級](../../../database-engine/install-windows/supported-version-and-edition-upgrades.md)。</span><span class="sxs-lookup"><span data-stu-id="a7585-185">For more information, see [Editions and Components of SQL Server 2014](../../editions-and-components-of-sql-server-2016.md) and [Supported Version and Edition Upgrades](../../../database-engine/install-windows/supported-version-and-edition-upgrades.md).</span></span>  
  
7.  <span data-ttu-id="a7585-186">在 [授權條款] 頁面上，閱讀授權合約，然後選取要接受授權條款和條件的核取方塊。</span><span class="sxs-lookup"><span data-stu-id="a7585-186">On the License Terms page, read the license agreement, and then select the check box to accept the license terms and conditions.</span></span> <span data-ttu-id="a7585-187">若要協助提升 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]，您也可以啟用功能使用方式選項，並傳送報告給 [!INCLUDE[msCoName](../../../includes/msconame-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a7585-187">To help improve [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], you can also enable the feature usage option and send reports to [!INCLUDE[msCoName](../../../includes/msconame-md.md)].</span></span> <span data-ttu-id="a7585-188">**按 [下一步] 繼續**。</span><span class="sxs-lookup"><span data-stu-id="a7585-188">**Click Next to continue**.</span></span> <span data-ttu-id="a7585-189">若要結束安裝程式，請按一下 **[取消]** 。</span><span class="sxs-lookup"><span data-stu-id="a7585-189">To end Setup, click **Cancel**.</span></span>  
  
8.  <span data-ttu-id="a7585-190">在 [選取執行個體] 頁面中，指定要升級為 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的 [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)]執行個體。</span><span class="sxs-lookup"><span data-stu-id="a7585-190">On the Select Instance page, specify the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance to upgrade to [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)].</span></span> <span data-ttu-id="a7585-191">**按 [下一步] 繼續**。</span><span class="sxs-lookup"><span data-stu-id="a7585-191">**Click Next to continue**.</span></span>  
  
9. <span data-ttu-id="a7585-192">在 [特徵選取] 頁面上，系統會預先選取要升級的功能。</span><span class="sxs-lookup"><span data-stu-id="a7585-192">On the Feature Selection page, the features to upgrade are preselected.</span></span> <span data-ttu-id="a7585-193">當您選取功能名稱之後，每一個元件群組的描述就會出現在右窗格中。</span><span class="sxs-lookup"><span data-stu-id="a7585-193">A description for each component group appears in the right pane after you select the feature name.</span></span> <span data-ttu-id="a7585-194">請注意，您無法變更要升級的功能，而且您無法在升級作業期間加入功能。</span><span class="sxs-lookup"><span data-stu-id="a7585-194">Be aware that you cannot change the features to be upgraded, and you cannot add features during the upgrade operation.</span></span> <span data-ttu-id="a7585-195">若要在升級作業完成後將功能加入升級的實例 [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] ，請參閱[將功能加入至 SQL Server 2014 的實例 &#40;安裝&#41;](../../../database-engine/install-windows/add-features-to-an-instance-of-sql-server-setup.md)。</span><span class="sxs-lookup"><span data-stu-id="a7585-195">To add features to an upgraded instance of [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] after the upgrade operation is complete, see [Add Features to an Instance of SQL Server 2014 &#40;Setup&#41;](../../../database-engine/install-windows/add-features-to-an-instance-of-sql-server-setup.md).</span></span>  
  
     <span data-ttu-id="a7585-196">右窗格會顯示選取功能的必要條件。</span><span class="sxs-lookup"><span data-stu-id="a7585-196">The prerequisites for the selected features are displayed on the right-hand pane.</span></span> <span data-ttu-id="a7585-197">SQL Server 安裝程式將會在這個程序稍後說明的安裝步驟期間安裝尚未安裝的必要條件。</span><span class="sxs-lookup"><span data-stu-id="a7585-197">SQL Server Setup will install the prerequisite that are not already installed during the installation step described later in this procedure.</span></span>  
  
10. <span data-ttu-id="a7585-198">在 [執行個體組態] 頁面上，系統會根據舊的執行個體自動填入欄位。</span><span class="sxs-lookup"><span data-stu-id="a7585-198">On the Instance Configuration page, fields are automatically populated from the old instance.</span></span> <span data-ttu-id="a7585-199">您可以選擇指定新的 InstanceID 值。</span><span class="sxs-lookup"><span data-stu-id="a7585-199">You can choose to specify the new InstanceID value.</span></span>  
  
     <span data-ttu-id="a7585-200">**執行個體識別碼** ：依預設，此執行個體名稱會當作執行個體識別碼使用。</span><span class="sxs-lookup"><span data-stu-id="a7585-200">**Instance ID** - By default, the instance name is used as the Instance ID.</span></span> <span data-ttu-id="a7585-201">這是用來識別 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]執行個體的安裝目錄和登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="a7585-201">This is used to identify installation directories and registry keys for your instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="a7585-202">這是預設執行個體和具名執行個體的狀況。</span><span class="sxs-lookup"><span data-stu-id="a7585-202">This is the case for default instances and named instances.</span></span> <span data-ttu-id="a7585-203">如果是預設執行個體，執行個體名稱和執行個體識別碼將會是 MSSQLSERVER。</span><span class="sxs-lookup"><span data-stu-id="a7585-203">For a default instance, the instance name and instance ID would be MSSQLSERVER.</span></span> <span data-ttu-id="a7585-204">若要使用非預設的執行個體識別碼，請選取 [執行個體識別碼]\*\*\*\* 核取方塊並提供值。</span><span class="sxs-lookup"><span data-stu-id="a7585-204">To use a nondefault instance ID, select the **Instance ID** check box and provide a value.</span></span> <span data-ttu-id="a7585-205">如果您覆寫預設值，就必須針對在所有容錯移轉叢集節點上升級的執行個體指定相同的執行個體識別碼。</span><span class="sxs-lookup"><span data-stu-id="a7585-205">If you override the default value, you must specify the same Instance ID for the instance being upgraded on all the failover cluster nodes.</span></span> <span data-ttu-id="a7585-206">升級之執行個體的執行個體識別碼在這些節點之間必須相符。</span><span class="sxs-lookup"><span data-stu-id="a7585-206">The Instance ID for the upgraded instance must match across the nodes.</span></span>  
  
     <span data-ttu-id="a7585-207">偵測**到的實例和功能**-此方格會顯示執行 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安裝程式之電腦上的實例。</span><span class="sxs-lookup"><span data-stu-id="a7585-207">**Detected instances and features** - The grid shows instances of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that are on the computer where Setup is running.</span></span> <span data-ttu-id="a7585-208">**按 [下一步] 繼續**。</span><span class="sxs-lookup"><span data-stu-id="a7585-208">**Click Next to continue**.</span></span>  
  
11. <span data-ttu-id="a7585-209">[磁碟空間需求] 頁面會計算您所指定之功能的所需磁碟空間，並且比較空間需求與執行安裝程式之電腦的可用磁碟空間。</span><span class="sxs-lookup"><span data-stu-id="a7585-209">The Disk Space Requirements page calculates the required disk space for the features that you specify, and compares requirements to the available disk space on the computer where Setup is running.</span></span>  
  
12. <span data-ttu-id="a7585-210">在 [全文檢索搜尋升級] 頁面上，針對升級的資料庫指定升級選項。</span><span class="sxs-lookup"><span data-stu-id="a7585-210">On the Full-Text Search Upgrade page, specify the upgrade options for the databases being upgraded.</span></span> <span data-ttu-id="a7585-211">如需詳細資訊，請參閱 [全文檢索搜尋升級選項](../../install/full-text-search-upgrade-options.md)。</span><span class="sxs-lookup"><span data-stu-id="a7585-211">For more information, see [Full-Text Search Upgrade Options](../../install/full-text-search-upgrade-options.md).</span></span>  
  
13. <span data-ttu-id="a7585-212">在 **[錯誤報告]** 頁面上，指定您想要傳送給 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] 的資訊，這可協助改善 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a7585-212">On the **Error Reporting** page, specify the information that you want to send to [!INCLUDE[msCoName](../../../includes/msconame-md.md)] that will help improve [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="a7585-213">錯誤報告選項預設為啟用。</span><span class="sxs-lookup"><span data-stu-id="a7585-213">By default, options for error reporting is enabled.</span></span>  
  
14. <span data-ttu-id="a7585-214">在升級作業開始之前，系統組態檢查會執行一組額外的規則，以便使用您已指定的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 功能來驗證電腦組態。</span><span class="sxs-lookup"><span data-stu-id="a7585-214">The System Configuration Checker runs one more set of rules to validate your computer configuration with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] features that you have specified, before the upgrade operation begins.</span></span>  
  
15. <span data-ttu-id="a7585-215">[叢集升級報表] 頁面會顯示容錯移轉叢集執行個體中的節點清單以及每個節點上 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 元件的執行個體版本資訊。</span><span class="sxs-lookup"><span data-stu-id="a7585-215">The Cluster Upgrade Report page displays the list of nodes in the failover cluster instance and the instance version information for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] components on each node.</span></span> <span data-ttu-id="a7585-216">它會顯示資料庫指令碼狀態和複寫指令碼狀態。</span><span class="sxs-lookup"><span data-stu-id="a7585-216">It displays the database script status and replication script status.</span></span> <span data-ttu-id="a7585-217">此外，它也會顯示當您按一下 [下一步]\*\*\*\* 時所進行之動作的參考用訊息。</span><span class="sxs-lookup"><span data-stu-id="a7585-217">In addition, it also displays informational messages on what will occur when you click **Next**.</span></span> <span data-ttu-id="a7585-218">根據已升級的容錯移轉叢集節點數目和節點總數，安裝程式會顯示當您按 **[下一步]** 時所發生的容錯移轉行為。</span><span class="sxs-lookup"><span data-stu-id="a7585-218">Depending on the number of failover cluster nodes that have already been upgraded and total number of nodes, Setup displays the failover behavior that happens when you click **Next**.</span></span> <span data-ttu-id="a7585-219">如果您尚未安裝必要元件，它也會發出可能產生不必要停機時間的警告。</span><span class="sxs-lookup"><span data-stu-id="a7585-219">It also warns about potential unnecessary downtime if you have not installed the prerequisites already.</span></span>  
  
16. <span data-ttu-id="a7585-220">[準備升級] 頁面會顯示在安裝期間指定之安裝選項的樹狀檢視。</span><span class="sxs-lookup"><span data-stu-id="a7585-220">The Ready to Upgrade page displays a tree view of installation options that were specified during Setup.</span></span> <span data-ttu-id="a7585-221">若要繼續，請按一下 **[升級]** 。</span><span class="sxs-lookup"><span data-stu-id="a7585-221">To continue, click **Upgrade**.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="a7585-222">安裝程式會先安裝選取功能所需的必要條件，之後再進行功能安裝。</span><span class="sxs-lookup"><span data-stu-id="a7585-222">Setup will first install the required prerequisites for the selected features followed by the feature installation.</span></span>  
  
17. <span data-ttu-id="a7585-223">在升級期間，[進度] 頁面會提供狀態，好讓您可以在安裝程式進行時監視目前節點的升級進度。</span><span class="sxs-lookup"><span data-stu-id="a7585-223">During upgrade, the Progress page provides status so that you can monitor the upgrade progress on the current node as Setup continues.</span></span>  
  
18. <span data-ttu-id="a7585-224">升級目前的節點之後，[叢集升級報表] 頁面就會顯示所有容錯移轉叢集節點的升級狀態資訊、每個容錯移轉叢集節點的功能，以及其版本資訊。</span><span class="sxs-lookup"><span data-stu-id="a7585-224">After the upgrade of the current node, the Cluster Upgrade Report page displays an upgrade status information for all the failover cluster nodes, features on each failover cluster node, and their version information.</span></span> <span data-ttu-id="a7585-225">請確認所顯示的版本資訊並且繼續進行其餘節點的升級作業。</span><span class="sxs-lookup"><span data-stu-id="a7585-225">Confirm the version information that is displayed and continue with the upgrade of the remaining nodes.</span></span> <span data-ttu-id="a7585-226">如果發生容錯移轉至升級節點的行為，這也會出現在狀態頁面上。</span><span class="sxs-lookup"><span data-stu-id="a7585-226">If the failover to upgraded nodes occurred, this is also apparent on the status page.</span></span> <span data-ttu-id="a7585-227">您也可以在 Windows 叢集管理員工具中檢查，然後確認。</span><span class="sxs-lookup"><span data-stu-id="a7585-227">You can also check in the Windows Cluster administrator tool to confirm.</span></span>  
  
19. <span data-ttu-id="a7585-228">升級之後，[完成] 頁面會提供安裝和其他重要注意事項之摘要記錄檔的連結。</span><span class="sxs-lookup"><span data-stu-id="a7585-228">After upgrade, the Complete page provides a link to the summary log file for the installation and other important notes.</span></span> <span data-ttu-id="a7585-229">若要完成 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安裝程序，請按一下 **[關閉]** 。</span><span class="sxs-lookup"><span data-stu-id="a7585-229">To complete the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] installation process, click **Close**.</span></span>  
  
20. <span data-ttu-id="a7585-230">如果指示您重新啟動電腦，請立刻執行。</span><span class="sxs-lookup"><span data-stu-id="a7585-230">If you are instructed to restart the computer, do so now.</span></span> <span data-ttu-id="a7585-231">當您完成安裝時，請務必閱讀安裝精靈所提供的訊息。</span><span class="sxs-lookup"><span data-stu-id="a7585-231">It is important to read the message from the Installation Wizard when you have finished with Setup.</span></span> <span data-ttu-id="a7585-232">如需安裝程式記錄檔的詳細資訊，請參閱 [檢視與讀取 SQL Server 安裝程式記錄檔](../../../database-engine/install-windows/view-and-read-sql-server-setup-log-files.md)。</span><span class="sxs-lookup"><span data-stu-id="a7585-232">For more information about Setup log files, see [View and Read SQL Server Setup Log Files](../../../database-engine/install-windows/view-and-read-sql-server-setup-log-files.md).</span></span>  
  
21. <span data-ttu-id="a7585-233">若要完成升級程序，請在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 容錯移轉叢集的所有其他節點上重複步驟 1 到 21。</span><span class="sxs-lookup"><span data-stu-id="a7585-233">To complete the upgrade process, repeat steps 1 to 21 on all the other nodes on the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster.</span></span>  
  
## <a name="to-upgrade-a-ssnoversion-multi-subnet-failover-cluster"></a><span data-ttu-id="a7585-234">若要升級 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 多重子網路容錯移轉叢集</span><span class="sxs-lookup"><span data-stu-id="a7585-234">To upgrade a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Multi-Subnet Failover Cluster</span></span>  
  
#### <a name="to-upgrade-to-a-ssnoversion-multi-subnet-failover-cluster-existing-ssnoversion-cluster-is-a-non-multi-subnet-cluster"></a><span data-ttu-id="a7585-235">若要升級到 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 多重子網路容錯移轉叢集 (現有的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 叢集為非多重子網路叢集)。</span><span class="sxs-lookup"><span data-stu-id="a7585-235">To upgrade to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] multi-subnet failover Cluster (Existing [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] cluster is a non multi-subnet cluster).</span></span>  
  
1.  <span data-ttu-id="a7585-236">遵循上面的[升級 SQL Server 容錯移轉](#UpgradeSteps)叢集一節中所述的步驟1到24，將您的叢集升級至 [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="a7585-236">Follow the steps 1 through 24 described in the [To upgrade a SQL Server failover cluster](#UpgradeSteps) section above to upgrade your cluster to [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)].</span></span>  
  
2.  <span data-ttu-id="a7585-237">使用 AddNode 安裝程式動作將節點加入到不同的子網路，並在 [叢集網路組態]\*\*\*\* 頁面確認 IP 位址資源相依性為 OR。</span><span class="sxs-lookup"><span data-stu-id="a7585-237">Add a node on a different subnet using the AddNode Setup action and confirm the IP address resource dependency to OR on the **Cluster Network Configuration** page.</span></span> <span data-ttu-id="a7585-238">如需詳細資訊，請參閱[在 SQL Server 容錯移轉叢集中新增或移除節點 &#40;安裝程式&#41;](../install/add-or-remove-nodes-in-a-sql-server-failover-cluster-setup.md)。</span><span class="sxs-lookup"><span data-stu-id="a7585-238">For more information, see [Add or Remove Nodes in a SQL Server Failover Cluster &#40;Setup&#41;](../install/add-or-remove-nodes-in-a-sql-server-failover-cluster-setup.md).</span></span>  
  
#### <a name="to-upgrade-a-multi-subnet-cluster-currently-using-stretch-v-lan"></a><span data-ttu-id="a7585-239">若要升級目前使用延展 V-Lan 的多重子網路叢集。</span><span class="sxs-lookup"><span data-stu-id="a7585-239">To upgrade a multi-subnet cluster currently using Stretch V-Lan.</span></span>  
  
1.  <span data-ttu-id="a7585-240">遵循上面的[升級 SQL Server 容錯移轉](#UpgradeSteps)叢集一節中所述的步驟1到24，將您的叢集升級至 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="a7585-240">Follow the steps 1 through 24 described in the [To upgrade a SQL Server failover cluster](#UpgradeSteps) section above to upgrade your cluster to [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)].</span></span>  
  
2.  <span data-ttu-id="a7585-241">變更網路設定，將遠端節點移到不同的子網路。</span><span class="sxs-lookup"><span data-stu-id="a7585-241">Change the network settings to move the remote node to a different subnet.</span></span>  
  
3.  <span data-ttu-id="a7585-242">使用 Windows 容錯移轉叢集管理工具，為新的子網路加入新的 IP 位址，並將 IP 位址資源相依性設定為 OR。</span><span class="sxs-lookup"><span data-stu-id="a7585-242">Using the Windows Failover Cluster management tool, add a new IP address for the new subnet set the IP address resource dependency to OR.</span></span>  
  
## <a name="next-steps"></a><span data-ttu-id="a7585-243">後續步驟</span><span class="sxs-lookup"><span data-stu-id="a7585-243">Next Steps</span></span>  
 <span data-ttu-id="a7585-244">在升級為 [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)]之後，請完成下列工作：</span><span class="sxs-lookup"><span data-stu-id="a7585-244">After you upgrade to [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)], complete the following tasks:</span></span>  
  
-   <span data-ttu-id="a7585-245">註冊伺服器</span><span class="sxs-lookup"><span data-stu-id="a7585-245">Register your servers</span></span>  
  
     <span data-ttu-id="a7585-246">升級會移除先前 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 執行個體的登錄設定。</span><span class="sxs-lookup"><span data-stu-id="a7585-246">Upgrade removes registry settings for the previous [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="a7585-247">在升級之後，您必須重新註冊伺服器。</span><span class="sxs-lookup"><span data-stu-id="a7585-247">After you upgrade, you must reregister your servers.</span></span>  
  
-   <span data-ttu-id="a7585-248">更新統計資料</span><span class="sxs-lookup"><span data-stu-id="a7585-248">Update statistics</span></span>  
  
     <span data-ttu-id="a7585-249">若要協助最佳化查詢效能，我們建議您在升級之後，更新所有資料庫的統計資料。</span><span class="sxs-lookup"><span data-stu-id="a7585-249">To help optimize query performance, we recommend that you update statistics on all databases following upgrade.</span></span> <span data-ttu-id="a7585-250">請使用 **sp_updatestats** 預存程序來更新 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 資料庫中使用者定義資料表的統計資料。</span><span class="sxs-lookup"><span data-stu-id="a7585-250">Use the **sp_updatestats** stored procedure to update statistics in user-defined tables in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] databases.</span></span>  
  
-   <span data-ttu-id="a7585-251">設定新的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安裝。</span><span class="sxs-lookup"><span data-stu-id="a7585-251">Configure your new [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] installation</span></span>  
  
     <span data-ttu-id="a7585-252">為了減少系統的可攻擊介面區， [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 可以選擇性地安裝和啟用主要服務和功能。</span><span class="sxs-lookup"><span data-stu-id="a7585-252">To reduce the attackable surface area of a system, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] selectively installs and enables key services and features.</span></span> <span data-ttu-id="a7585-253">如需有關介面區組態的詳細資訊，請參閱這一版的讀我檔案。</span><span class="sxs-lookup"><span data-stu-id="a7585-253">For more information about surface area configuration, see the readme file for this release.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a7585-254">另請參閱</span><span class="sxs-lookup"><span data-stu-id="a7585-254">See Also</span></span>  
 <span data-ttu-id="a7585-255">[從命令提示字元安裝 SQL Server 2014](../../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md) </span><span class="sxs-lookup"><span data-stu-id="a7585-255">[Install SQL Server 2014 from the Command Prompt](../../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md) </span></span>  
 [<span data-ttu-id="a7585-256">檢視與讀取 SQL Server 安裝程式記錄檔</span><span class="sxs-lookup"><span data-stu-id="a7585-256">View and Read SQL Server Setup Log Files</span></span>](../../../database-engine/install-windows/view-and-read-sql-server-setup-log-files.md)  
  
  
