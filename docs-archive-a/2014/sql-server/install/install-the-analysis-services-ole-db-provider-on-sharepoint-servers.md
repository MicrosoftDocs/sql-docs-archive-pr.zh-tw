---
title: 在 SharePoint 伺服器上安裝 Analysis Services OLE DB Provider |Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
ms.assetid: 2c62daf9-1f2d-4508-a497-af62360ee859
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: 371d344a451e7702a525e0cb6afa3421b6598cac
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87598165"
---
# <a name="install-the-analysis-services-ole-db-provider-on-sharepoint-servers"></a><span data-ttu-id="17252-102">在 SharePoint 伺服器上安裝 Analysis Services OLE DB 提供者</span><span class="sxs-lookup"><span data-stu-id="17252-102">Install the Analysis Services OLE DB Provider on SharePoint Servers</span></span>
  <span data-ttu-id="17252-103">Microsoft OLE DB Provider for Analysis Services (MSOLAP) 是用戶端應用程式用來與 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 資料互動的介面。</span><span class="sxs-lookup"><span data-stu-id="17252-103">The Microsoft OLE DB Provider for Analysis Services (MSOLAP) is an interface that client applications use to interact with [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data.</span></span> <span data-ttu-id="17252-104">在包含 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)]的 SharePoint 環境中，提供者會處理 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 資料的連接要求。</span><span class="sxs-lookup"><span data-stu-id="17252-104">In a SharePoint environment that includes [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], the provider handles connection requests for [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data.</span></span>  
  
 <span data-ttu-id="17252-105">資料提供者內含在 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 安裝套件 (spPowerPivot.msi) 中，但是可能需要手動安裝。</span><span class="sxs-lookup"><span data-stu-id="17252-105">The data provider is included in the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package (spPowerPivot.msi), but might require manual installation.</span></span> <span data-ttu-id="17252-106">在兩種情況下您可能必須在 SharePoint 伺服器上手動安裝用戶端程式庫或資料提供者。</span><span class="sxs-lookup"><span data-stu-id="17252-106">There are two reasons why you might need to manually install a client library or data provider on a SharePoint server.</span></span>  
  
-   <span data-ttu-id="17252-107">**啟用回溯相容性**。</span><span class="sxs-lookup"><span data-stu-id="17252-107">**Enable backwards compatibility**.</span></span> [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] <span data-ttu-id="17252-108">活頁簿會在其連接字串中指定 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 版本的 Analysis Services OLE DB 提供者。</span><span class="sxs-lookup"><span data-stu-id="17252-108">workbooks specify the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the Analysis Services OLE DB provider in their connection string.</span></span> <span data-ttu-id="17252-109">如此一來，此提供者版本必須存在電腦上，要求才能成功。</span><span class="sxs-lookup"><span data-stu-id="17252-109">As such, this provider version must be present on the computer in order for the request to succeed.</span></span>  
  
-   <span data-ttu-id="17252-110">**在專用 Excel Services 執行個體上啟用資料存取**。</span><span class="sxs-lookup"><span data-stu-id="17252-110">**Enable data access on a dedicated Excel Services instance**.</span></span> <span data-ttu-id="17252-111">如果您的 SharePoint 伺服器陣列在同樣沒有 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)]的伺服器上包含 Excel Services，則使用 [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] 安裝套件來安裝 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 版的提供者和其他用戶端連接性元件。</span><span class="sxs-lookup"><span data-stu-id="17252-111">If your SharePoint farm includes Excel Services on a server that does not also have [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], install the [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] version of the provider and other client connectivity components by using the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="17252-112">這些案例不會互斥。</span><span class="sxs-lookup"><span data-stu-id="17252-112">These scenarios are not mutually exclusive.</span></span> <span data-ttu-id="17252-113">若您在包含執行 Excel Services 但沒有 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 執行個體之應用程式伺服器的伺服器陣列上裝載多個活頁簿版本，則需要在每一部 Excel Services 電腦上同時安裝舊版和新版資料提供者。</span><span class="sxs-lookup"><span data-stu-id="17252-113">Hosting multiple workbook versions on a farm that includes application servers running Excel Services without a [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] instance will require that you install both older and newer versions of the data provider on each Excel Services computer.</span></span>  
  
  
##  <a name="versions-of-the-ole-db-provider-supporting-powerpivot-data-access"></a><a name="bkmk_vers"></a><span data-ttu-id="17252-114">支援 PowerPivot 資料存取的 OLE DB 提供者版本</span><span class="sxs-lookup"><span data-stu-id="17252-114">Versions of the OLE DB Provider Supporting PowerPivot Data Access</span></span>  
 <span data-ttu-id="17252-115">SharePoint 伺服器陣列可能包含多個 Analysis Services OLE DB 提供者版本，包括不支援 PowerPivot 資料存取的舊版。</span><span class="sxs-lookup"><span data-stu-id="17252-115">A SharePoint farm might include multiple versions of the Analysis Services OLE DB provider, including older versions that do not support PowerPivot data access.</span></span>  
  
 <span data-ttu-id="17252-116">根據預設，SharePoint 2010 會安裝提供者的 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 版本。</span><span class="sxs-lookup"><span data-stu-id="17252-116">By default, SharePoint 2010 installs the [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] version of the provider.</span></span> <span data-ttu-id="17252-117">此版本雖然識別為 MSOLAP.4 (與用於 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]的版本號碼相同)，但是不適用於 PowerPivot 資料存取。</span><span class="sxs-lookup"><span data-stu-id="17252-117">Although it is identified as MSOLAP.4 (the same version number used for [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]), this version does not work for PowerPivot data access.</span></span> <span data-ttu-id="17252-118">您必須具有 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 或 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 版的提供者，才能成功連接。</span><span class="sxs-lookup"><span data-stu-id="17252-118">In order for connections to succeed, you must have the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] or [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] version of the provider.</span></span>  
  
 <span data-ttu-id="17252-119">OLE DB 提供者在 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 之後的版本中，包含適用於 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 資料結構的傳輸和連接支援。</span><span class="sxs-lookup"><span data-stu-id="17252-119">A post [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] version of the OLE DB provider includes transports and connection support for [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data structures.</span></span> [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] <span data-ttu-id="17252-120">活頁簿會使用這個提供者的新版，向伺服器陣列中的 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 伺服器要求查詢處理。</span><span class="sxs-lookup"><span data-stu-id="17252-120">workbooks use newer versions of this provider to request query processing from [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] servers in the farm.</span></span> <span data-ttu-id="17252-121">若要取得已更新的版本，可以透過 [SQL Server 功能套件] 頁面下載並安裝。</span><span class="sxs-lookup"><span data-stu-id="17252-121">To get an updated version, you can download and install it through a SQL Server Feature Pack page.</span></span>  
  
 <span data-ttu-id="17252-122">下表描述有效的版本：</span><span class="sxs-lookup"><span data-stu-id="17252-122">The following table describes the valid versions:</span></span>  
  
|<span data-ttu-id="17252-123">產品版本</span><span class="sxs-lookup"><span data-stu-id="17252-123">Product version</span></span>|<span data-ttu-id="17252-124">檔案版本</span><span class="sxs-lookup"><span data-stu-id="17252-124">File version</span></span>|<span data-ttu-id="17252-125">有效：</span><span class="sxs-lookup"><span data-stu-id="17252-125">Valid for:</span></span>|  
|---------------------|------------------|----------------|  
|[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]|<span data-ttu-id="17252-126">檔案系統中的 MSOLAP100.dll</span><span class="sxs-lookup"><span data-stu-id="17252-126">MSOLAP100.dll in the file system</span></span><br /><br /> <span data-ttu-id="17252-127">Excel 連接字串中的 MSOLAP.4</span><span class="sxs-lookup"><span data-stu-id="17252-127">MSOLAP.4 in an Excel connection string</span></span><br /><br /> <span data-ttu-id="17252-128">檔案版本詳細資料中的 10.50.1600 或更新版本</span><span class="sxs-lookup"><span data-stu-id="17252-128">10.50.1600 or later in file version details</span></span>|<span data-ttu-id="17252-129">使用以 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 版的 PowerPivot for Excel 建立的資料模型。</span><span class="sxs-lookup"><span data-stu-id="17252-129">Use for data models created using the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of PowerPivot for Excel.</span></span>|  
|[!INCLUDE[ssSQL11](../../includes/sssql11-md.md)]|<span data-ttu-id="17252-130">檔案系統中的 MSOLAP110.dll</span><span class="sxs-lookup"><span data-stu-id="17252-130">MSOLAP110.dll in the file system</span></span><br /><br /> <span data-ttu-id="17252-131">Excel 連接字串中的 MSOLAP.5</span><span class="sxs-lookup"><span data-stu-id="17252-131">MSOLAP.5 in an Excel connection string</span></span><br /><br /> <span data-ttu-id="17252-132">檔案版本詳細資料中的 11.0.0000 或更新版本</span><span class="sxs-lookup"><span data-stu-id="17252-132">11.0.0000 or later in file version details</span></span>|<span data-ttu-id="17252-133">用於以 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] 或 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 版 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel 建立的資料模型。</span><span class="sxs-lookup"><span data-stu-id="17252-133">Use for data models created using the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] or [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] version of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel.</span></span>|  
|[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]|<span data-ttu-id="17252-134">檔案系統中的 MSOLAP120.dll</span><span class="sxs-lookup"><span data-stu-id="17252-134">MSOLAP120.dll in the file system</span></span><br /><br /> <span data-ttu-id="17252-135">檔案版本詳細資料中的 12.0.20000 或更新版本</span><span class="sxs-lookup"><span data-stu-id="17252-135">12.0.20000 or later in file version details</span></span>|<span data-ttu-id="17252-136">用於 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 模型之外的資料模型。</span><span class="sxs-lookup"><span data-stu-id="17252-136">Use for data models other than [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] models.</span></span>|  
  
  
##  <a name="why-you-need-to-install-the-ole-db-provider"></a><a name="bkmk_why"></a><span data-ttu-id="17252-137">為何需要安裝 OLE DB 提供者</span><span class="sxs-lookup"><span data-stu-id="17252-137">Why you need to install the OLE DB Provider</span></span>  
 <span data-ttu-id="17252-138">下列兩種情況需要在伺服器陣列中的伺服器上手動安裝 OLE DB 提供者。</span><span class="sxs-lookup"><span data-stu-id="17252-138">There are two scenarios that call for manually installing the OLE DB provider on servers in the farm.</span></span>  
  
 <span data-ttu-id="17252-139">**最常見的情況** 是伺服器陣列的文件庫中同時儲存新舊版本的 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 活頁簿。</span><span class="sxs-lookup"><span data-stu-id="17252-139">**The most common scenario** is when you have older and newer versions of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] workbooks that are saved in document libraries in the farm.</span></span> <span data-ttu-id="17252-140">如果組織的分析師使用 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 版的 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel，並將活頁簿儲存至 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 安裝，則舊版活頁簿將無法運作。</span><span class="sxs-lookup"><span data-stu-id="17252-140">If analysts in your organization are using the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel, and they save those workbooks to a [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation, the older workbook will not work.</span></span> <span data-ttu-id="17252-141">其連接字串會參考較舊版本的提供者，除非您安裝它，否則不會在伺服器上。</span><span class="sxs-lookup"><span data-stu-id="17252-141">Its connection string will reference an older version of the provider, which won't be on the server unless you install it.</span></span> <span data-ttu-id="17252-142">同時安裝兩個版本，即可存取在新舊版 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel 中建立之 PowerPivot 活頁簿的資料。</span><span class="sxs-lookup"><span data-stu-id="17252-142">Installing both versions will enable data access for PowerPivot workbooks created in older and newer versions of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel.</span></span> [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] <span data-ttu-id="17252-143">安裝程式不會安裝提供者的 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 版本，因此若要使用舊版活頁簿，您必須手動安裝該版本。</span><span class="sxs-lookup"><span data-stu-id="17252-143">Setup does not install the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the provider, so you must install it manually if you are using workbooks from a previous version.</span></span>  
  
 <span data-ttu-id="17252-144">**第二個情況** 是您有伺服器在執行 Excel Services 的 SharePoint 伺服器陣列中，而不是在執行 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)]的伺服器陣列中。</span><span class="sxs-lookup"><span data-stu-id="17252-144">**The second scenario** is when you have a server in a SharePoint farm that runs Excel Services, but not [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span> <span data-ttu-id="17252-145">在此情況下，執行 Excel Services 的應用程式伺服器必須手動更新，才能使用新版的提供者。</span><span class="sxs-lookup"><span data-stu-id="17252-145">In this case, the application server that runs Excel Services must be manually updated to use a newer version of the provider.</span></span> <span data-ttu-id="17252-146">連接至 PowerPivot for SharePoint 執行個體需要此元件。</span><span class="sxs-lookup"><span data-stu-id="17252-146">This is necessary for connecting to a PowerPivot for SharePoint instance.</span></span> <span data-ttu-id="17252-147">如果 Excel Services 正在使用舊版的提供者，則連接要求將會失敗。</span><span class="sxs-lookup"><span data-stu-id="17252-147">If Excel Services is using an older version of the provider, the connection request will fail.</span></span> <span data-ttu-id="17252-148">請注意，必須使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安裝程式或 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 安裝套件 (spPowerPivot.msi) 來安裝提供者，以確保安裝支援 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 所需的所有元件。</span><span class="sxs-lookup"><span data-stu-id="17252-148">Note that the provider must be installed by using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] setup or the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package (spPowerPivot.msi) in order to ensure that all components required support [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] are installed.</span></span>  
  
  
##  <a name="install-the-sql-server-2012-ole-db-provider-on-an-excel-services-server-by-using-sql-server-setup"></a><a name="bkmk_sql11"></a><span data-ttu-id="17252-149">使用 SQL Server 安裝程式，在 Excel Services 伺服器上安裝 SQL Server 2012 OLE DB 提供者</span><span class="sxs-lookup"><span data-stu-id="17252-149">Install the SQL Server 2012 OLE DB Provider on an Excel Services server by using SQL Server Setup</span></span>  
 <span data-ttu-id="17252-150">使用下列指示，將 OLE DB 提供者和其他用戶端連接性元件加入至未安裝這些元件的 SharePoint 伺服器，例如執行 Excel Services 但未在相同硬體上安裝 PowerPivot for SharePoint 的應用程式伺服器。</span><span class="sxs-lookup"><span data-stu-id="17252-150">Use the following instructions to add the OLE DB provider and other client connectivity components to SharePoint servers that do not already have them installed, such as application servers that run Excel Services without PowerPivot for SharePoint on the same hardware.</span></span>  
  
 <span data-ttu-id="17252-151">使用以下指示來安裝目前的 Analysis Services OLE DB 提供者，並將 **Microsoft.AnalysisServices.Xmla.dll** 加入至全域組件。</span><span class="sxs-lookup"><span data-stu-id="17252-151">Use these instructions to install the current Analysis Services OLE DB provider and to add the **Microsoft.AnalysisServices.Xmla.dll** to the global assembly.</span></span>  
  
#### <a name="run-sql-server-setup-and-install-the-client-connectivity-tools"></a><span data-ttu-id="17252-152">執行 SQL Server 安裝程式及安裝用戶端連接工具</span><span class="sxs-lookup"><span data-stu-id="17252-152">Run SQL Server Setup and Install the Client Connectivity Tools</span></span>  
  
1.  <span data-ttu-id="17252-153">在主控 Excel Services 的應用程式伺服器上，執行 SQL Server 安裝程式。</span><span class="sxs-lookup"><span data-stu-id="17252-153">On the application server that hosts Excel Services, run SQL Server Setup.</span></span>  
  
2.  <span data-ttu-id="17252-154">在 [安裝] 頁面上，選擇 **[新增 SQL Server 獨立安裝或將功能加入至現有安裝]**。</span><span class="sxs-lookup"><span data-stu-id="17252-154">On the Installation page, choose **New SQL Server stand-alone installation or add features to an existing installation**.</span></span>  
  
3.  <span data-ttu-id="17252-155">在 [安裝類型] 頁面上，選擇 **[執行 SQL Server 2012 的新安裝]**。</span><span class="sxs-lookup"><span data-stu-id="17252-155">On the Installation Type page, choose **Perform a new installation of SQL Server 2012**.</span></span>  
  
4.  <span data-ttu-id="17252-156">在 [安裝程式角色] 頁面上，選擇 **[SQL Server 功能安裝]**。</span><span class="sxs-lookup"><span data-stu-id="17252-156">On the Setup Role page, choose **SQL Server Feature Installation**.</span></span>  
  
5.  <span data-ttu-id="17252-157">在 **[特徵選取]** 頁面上，按一下 **[用戶端工具連接性]**。</span><span class="sxs-lookup"><span data-stu-id="17252-157">On the **Feature Selection** page, click **Client Tools Connectivity**.</span></span> <span data-ttu-id="17252-158">此選項會安裝 **Microsoft.AnalysisServices.Xmla.dll**。</span><span class="sxs-lookup"><span data-stu-id="17252-158">This option installs **Microsoft.AnalysisServices.Xmla.dll**</span></span>  
  
     <span data-ttu-id="17252-159">請勿選取其他任何功能。</span><span class="sxs-lookup"><span data-stu-id="17252-159">Do not select any other features.</span></span>  
  
6.  <span data-ttu-id="17252-160">按 **[下一步]** 完成精靈，然後按一下 **[安裝]** 執行安裝程式。</span><span class="sxs-lookup"><span data-stu-id="17252-160">Click **Next** to finish the wizard, and then click **Install** to run Setup.</span></span>  
  
7.  <span data-ttu-id="17252-161">如果您有其他伺服器執行 Excel Services 但是並未在相同的伺服器上安裝 PowerPivot for SharePoint，請重複上述步驟。</span><span class="sxs-lookup"><span data-stu-id="17252-161">Repeat the previous steps if you have other servers running Excel Services, without a PowerPivot for SharePoint installation on the same server.</span></span>  
  
#### <a name="verify-msolap5-is-a-trusted-provider"></a><span data-ttu-id="17252-162">確認 MSOLAP.5 是受信任的提供者</span><span class="sxs-lookup"><span data-stu-id="17252-162">Verify MSOLAP.5 is a trusted provider</span></span>  
  
1.  <span data-ttu-id="17252-163">在 [管理中心]，按一下 **[管理服務應用程式]**，然後按一下 Excel Services 服務應用程式。</span><span class="sxs-lookup"><span data-stu-id="17252-163">In Central Administration, click **Manage service applications**, and then click the Excel Services service application.</span></span>  
  
2.  <span data-ttu-id="17252-164">按一下 **[信任的資料提供者]** 。</span><span class="sxs-lookup"><span data-stu-id="17252-164">Click **Trusted Data Providers**.</span></span>  
  
3.  <span data-ttu-id="17252-165">確認 MSOLAP.5 出現在清單中。</span><span class="sxs-lookup"><span data-stu-id="17252-165">Verify that MSOLAP.5 appears in the list.</span></span> <span data-ttu-id="17252-166">根據您設定 PowerPivot for SharePoint 的方式，MSOLAP.5 可能已經是受信任的提供者。</span><span class="sxs-lookup"><span data-stu-id="17252-166">Depending on how you configured PowerPivot for SharePoint, MSOLAP.5 might already be trusted.</span></span> <span data-ttu-id="17252-167">如果您使用 PowerPivot 組態工具，但之後將此動作排除在工作清單之外，則 Excel Services 將不會信任 MSOLAP.5，且現在必須手動加入 MSOLAP.5。</span><span class="sxs-lookup"><span data-stu-id="17252-167">If you used the PowerPivot Configuration tool, but then excluded this action from the task list, MSOLAP.5 will not be trusted by Excel Services and now needs to be added manually.</span></span>  
  
4.  <span data-ttu-id="17252-168">如果未列出 MSOLAP，請按一下 **[新增信任的資料提供者]**。</span><span class="sxs-lookup"><span data-stu-id="17252-168">If MSOLAP is not listed, click **Add Trusted Data Provider**.</span></span>  
  
5.  <span data-ttu-id="17252-169">在 [提供者識別碼] 中，輸入 `MSOLAP.5`。</span><span class="sxs-lookup"><span data-stu-id="17252-169">In Provider ID, type `MSOLAP.5`.</span></span>  
  
6.  <span data-ttu-id="17252-170">對於 [提供者類型]，請確認已選取 OLE DB。</span><span class="sxs-lookup"><span data-stu-id="17252-170">For Provider Type, ensure that OLE DB is selected.</span></span>  
  
7.  <span data-ttu-id="17252-171">在 [提供者描述] 中，輸入 **Microsoft OLE DB Provider for OLAP Services 11.0**。</span><span class="sxs-lookup"><span data-stu-id="17252-171">In Provider Description, type **Microsoft OLE DB Provider for OLAP Services 11.0**.</span></span>  
  
#### <a name="verify-installation"></a><span data-ttu-id="17252-172">確認安裝</span><span class="sxs-lookup"><span data-stu-id="17252-172">Verify installation</span></span>  
  
1.  <span data-ttu-id="17252-173">移至 Program files\Microsoft Analysis Services\AS OLEDB\110。</span><span class="sxs-lookup"><span data-stu-id="17252-173">Go to Program files\Microsoft Analysis Services\AS OLEDB\110.</span></span>  
  
2.  <span data-ttu-id="17252-174">以滑鼠右鍵按一下 msolap110.dll，然後選取 **[內容]**。</span><span class="sxs-lookup"><span data-stu-id="17252-174">Right-click msolap110.dll and select **Properties**.</span></span>  
  
3.  <span data-ttu-id="17252-175">按一下 [詳細資訊] 。</span><span class="sxs-lookup"><span data-stu-id="17252-175">Click **Details**.</span></span>  
  
4.  <span data-ttu-id="17252-176">檢視檔案版本資訊。</span><span class="sxs-lookup"><span data-stu-id="17252-176">View the file version information.</span></span> <span data-ttu-id="17252-177">版本應包含 11.00. \<buildnumber> 。</span><span class="sxs-lookup"><span data-stu-id="17252-177">The version should include 11.00.\<buildnumber>.</span></span>  
  
5.  <span data-ttu-id="17252-178">在 Windows\assembly 資料夾中，確認已列出 Microsoft.AnalysisServices.Xmla.dll 版本 11.0.0.0。</span><span class="sxs-lookup"><span data-stu-id="17252-178">In the Windows\assembly folder, verify that Microsoft.AnalysisServices.Xmla.dll, version 11.0.0.0, is listed.</span></span>  
  
  
##  <a name="use-the-powerpivot-for-sharepoint-installation-package-sppowerpivotmsi-to-install-the-sql-server-2012-ole-db-provider"></a><a name="bkmk_install2012_from_sppowerpivot_msi"></a><span data-ttu-id="17252-179">使用 PowerPivot for SharePoint 安裝套件 ( # A0) 安裝 SQL Server 2012 OLE DB 提供者</span><span class="sxs-lookup"><span data-stu-id="17252-179">Use the PowerPivot for SharePoint Installation package (spPowerPivot.msi) to install the SQL Server 2012 OLE DB Provider</span></span>  
 <span data-ttu-id="17252-180">使用 [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] 安裝套件 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] (spPowerPivot.msi) **來將**OLE DB 提供者安裝於 Excel Services 伺服器上。</span><span class="sxs-lookup"><span data-stu-id="17252-180">Install the [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] OLE DB Provider on and Excel Services Server by using the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package **(spPowerPivot.msi)**.</span></span>  
  
#### <a name="download-the-msolap5-provider-from-the-sssql11sp1-feature-pack"></a><span data-ttu-id="17252-181">從 [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] 功能套件下載 MSOLAP.5 提供者。</span><span class="sxs-lookup"><span data-stu-id="17252-181">Download the MSOLAP.5 provider from the [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] Feature Pack.</span></span>  
  
1.  <span data-ttu-id="17252-182">瀏覽至 [Microsoft® SQL Server® 2012 SP1 功能套件](https://www.microsoft.com/download/details.aspx?id=35580)</span><span class="sxs-lookup"><span data-stu-id="17252-182">Browse to [Microsoft® SQL Server® 2012 SP1 Feature Pack](https://www.microsoft.com/download/details.aspx?id=35580)</span></span>  
  
2.  <span data-ttu-id="17252-183">按一下 **[安裝指示]**。</span><span class="sxs-lookup"><span data-stu-id="17252-183">Click **Install Instructions**.</span></span>  
  
3.  <span data-ttu-id="17252-184">請參閱 "Microsoft Analysis Services OLE DB Provider for Microsoft SQL Server 2012 SP1" 一節。</span><span class="sxs-lookup"><span data-stu-id="17252-184">See the section "Microsoft Analysis Services OLE DB Provider for Microsoft SQL Server 2012 SP1".</span></span> <span data-ttu-id="17252-185">下載檔案並開始安裝。</span><span class="sxs-lookup"><span data-stu-id="17252-185">Download the file and start the installation.</span></span>  
  
4.  <span data-ttu-id="17252-186">在 **[特徵選取]** 頁面上，選取 **[Analysis Services OLE DB Provider for SQL Server]**。</span><span class="sxs-lookup"><span data-stu-id="17252-186">On the **Feature Selection** page, select **Analysis Services OLE DB Provider for SQL Server**.</span></span> <span data-ttu-id="17252-187">取消選取其他元件，並完成安裝。</span><span class="sxs-lookup"><span data-stu-id="17252-187">Unselect the other components and complete the installation.</span></span> <span data-ttu-id="17252-188">如需 spPowerPivot.msi 的詳細資訊，請參閱[&#40;SharePoint 2013&#41;安裝或卸載 PowerPivot for SharePoint 增益集](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013)。</span><span class="sxs-lookup"><span data-stu-id="17252-188">For more information on spPowerPivot.msi, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013).</span></span>  
  
5.  <span data-ttu-id="17252-189">向 SharePoint Excel Services 註冊 MSOLAP.5 當做信任的提供者。</span><span class="sxs-lookup"><span data-stu-id="17252-189">Register MSOLAP.5 as a trusted provider with SharePoint Excel Services.</span></span> <span data-ttu-id="17252-190">如需詳細資訊，請參閱 [加入 MSOLAP.5 做為 Excel Services 中受信任的資料提供者](https://technet.microsoft.com/library/hh758436.aspx)。</span><span class="sxs-lookup"><span data-stu-id="17252-190">For more information, see [Add MSOLAP.5 as a Trusted Data Provider in Excel Services](https://technet.microsoft.com/library/hh758436.aspx).</span></span>  
  
  
##  <a name="install-the-sql-server-2008-r2-ole-db-provider-to-host-earlier-version-workbooks"></a><a name="bkmk_kj"></a><span data-ttu-id="17252-191">安裝 SQL Server 2008 R2 OLE DB 提供者以裝載舊版活頁簿</span><span class="sxs-lookup"><span data-stu-id="17252-191">Install the SQL Server 2008 R2 OLE DB Provider to host earlier version workbooks</span></span>  
 <span data-ttu-id="17252-192">請依照下列指示安裝 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 版的 MSOLAP.4 提供者，並且登錄 Microsoft.AnalysisServices.ChannelTransport.dll 檔。</span><span class="sxs-lookup"><span data-stu-id="17252-192">Use the following instructions to install the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the MSOLAP.4 provider, and register the Microsoft.AnalysisServices.ChannelTransport.dll file.</span></span> <span data-ttu-id="17252-193">ChannelTransport 是 Analysis Services OLE DB 提供者的子元件。</span><span class="sxs-lookup"><span data-stu-id="17252-193">The ChannelTransport is a subcomponent of the Analysis Services OLE DB provider.</span></span> <span data-ttu-id="17252-194">[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 版的提供者會在使用 ChannelTransport 建立連接時讀取登錄。</span><span class="sxs-lookup"><span data-stu-id="17252-194">The [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the provider reads the registry when using ChannelTransport to make a connection.</span></span> <span data-ttu-id="17252-195">登錄此檔案是一個後續安裝步驟，只需要針對 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 伺服器上 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] 提供者處理的連接執行。</span><span class="sxs-lookup"><span data-stu-id="17252-195">Registering this file is a post-installation step required only for connections handled by the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] provider on a [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] server.</span></span>  
  
#### <a name="step-1-download-and-install-the-client-library"></a><span data-ttu-id="17252-196">步驟 1：下載和安裝用戶端文件庫</span><span class="sxs-lookup"><span data-stu-id="17252-196">Step 1: Download and install the client library</span></span>  
  
1.  <span data-ttu-id="17252-197">在 [SQL Server 2008 R2 功能套件頁面](https://www.microsoft.com/download/details.aspx?id=44272)上，尋找 Microsoft Analysis Services OLE DB Provider for Microsoft SQL Server 2008 R2。</span><span class="sxs-lookup"><span data-stu-id="17252-197">On the [SQL Server 2008 R2 Feature Pack page](https://www.microsoft.com/download/details.aspx?id=44272), find Microsoft Analysis Services OLE DB Provider for Microsoft SQL Server 2008 R2.</span></span>  
  
2.  <span data-ttu-id="17252-198">下載 `SQLServer2008_ASOLEDB10.msi` 安裝程式的 x64 封裝。</span><span class="sxs-lookup"><span data-stu-id="17252-198">Download the x64 Package of the `SQLServer2008_ASOLEDB10.msi` installation program.</span></span> <span data-ttu-id="17252-199">雖然檔案名稱包含 SQLServer2008，但這是用於 SQL Server 2008 R2 版提供者的正確檔案。</span><span class="sxs-lookup"><span data-stu-id="17252-199">Although the file name contains SQLServer2008, it is the correct file for the SQL Server 2008 R2 version of the provider.</span></span>  
  
3.  <span data-ttu-id="17252-200">在已安裝 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)]的電腦上，執行 .msi 安裝程式庫。</span><span class="sxs-lookup"><span data-stu-id="17252-200">On the computer that has an installation of [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], run the .msi to install the library.</span></span>  
  
4.  <span data-ttu-id="17252-201">如果您的伺服器陣列中有其他只執行 Excel Services 的伺服器，但同一部伺服器上沒有 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] ，請重複上述步驟，在 Excel Services 電腦上安裝 2008 R2 版的提供者。</span><span class="sxs-lookup"><span data-stu-id="17252-201">If you have other servers in the farm that run just Excel Services, without [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] on the same server, repeat the previous steps to install the 2008 R2 version of the provider on the Excel Services computer.</span></span>  
  
#### <a name="step-2-register-the-microsoftanalysisserviceschanneltransportdll-file"></a><span data-ttu-id="17252-202">步驟 2：登錄 Microsoft.AnalysisServices.ChannelTransport.dll 檔</span><span class="sxs-lookup"><span data-stu-id="17252-202">Step 2: Register the Microsoft.AnalysisServices.ChannelTransport.dll file</span></span>  
  
1.  <span data-ttu-id="17252-203">使用 regasm.exe 公用程式登錄檔案。</span><span class="sxs-lookup"><span data-stu-id="17252-203">Use the regasm.exe utility to register the file.</span></span> <span data-ttu-id="17252-204">如果您之前未執行 regasm.exe，請將其父資料夾 C:\Windows\Microsoft.NET\Framework64\v4.0.30319 新增 \\ 至系統路徑變數。</span><span class="sxs-lookup"><span data-stu-id="17252-204">If you have not run regasm.exe before, add its parent folder, C:\Windows\Microsoft.NET\Framework64\v4.0.30319\\, to the system path variable.</span></span>  
  
2.  <span data-ttu-id="17252-205">使用管理員權限來開啟命令提示字元。</span><span class="sxs-lookup"><span data-stu-id="17252-205">Open a command prompt with administrator permissions.</span></span>  
  
3.  <span data-ttu-id="17252-206">移至此資料夾 C:\Windows\assembly\GAC_MSIL\Microsoft.AnalysisServices.ChannelTransport\10.0.0.0__89845dcd8080cc91</span><span class="sxs-lookup"><span data-stu-id="17252-206">Go to this folder C:\Windows\assembly\GAC_MSIL\Microsoft.AnalysisServices.ChannelTransport\10.0.0.0__89845dcd8080cc91</span></span>  
  
4.  <span data-ttu-id="17252-207">輸入下列命令：`regasm microsoft.analysisservices.channeltransport.dll`</span><span class="sxs-lookup"><span data-stu-id="17252-207">Enter the following command: `regasm microsoft.analysisservices.channeltransport.dll`</span></span>  
  
5.  <span data-ttu-id="17252-208">針對您手動安裝 2008 R2 版提供者的任何電腦重複上述步驟。</span><span class="sxs-lookup"><span data-stu-id="17252-208">Repeat the previous steps for any computer on which you manually installed the 2008 R2 version of the provider.</span></span>  
  
#### <a name="verify-installation"></a><span data-ttu-id="17252-209">確認安裝</span><span class="sxs-lookup"><span data-stu-id="17252-209">Verify installation</span></span>  
  
1.  <span data-ttu-id="17252-210">您現在應該能夠配量或篩選 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 活頁簿。</span><span class="sxs-lookup"><span data-stu-id="17252-210">You should now be able to slice or filter [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] workbooks.</span></span> <span data-ttu-id="17252-211">如果發生錯誤，請確認您使用的是 64 位元版的 regasm.exe 來登錄檔案。</span><span class="sxs-lookup"><span data-stu-id="17252-211">If an error occurs, verify that you used the 64-bit version of regasm.exe to register the file.</span></span>  
  
2.  <span data-ttu-id="17252-212">此外，您可以檢查檔案版本。</span><span class="sxs-lookup"><span data-stu-id="17252-212">Additionally, you can check the file version.</span></span>  
  
     <span data-ttu-id="17252-213">前往 `C:\Program files\Microsoft Analysis Services\AS OLEDB\10`。</span><span class="sxs-lookup"><span data-stu-id="17252-213">Go to `C:\Program files\Microsoft Analysis Services\AS OLEDB\10`.</span></span> <span data-ttu-id="17252-214">以滑鼠右鍵按一下 **msolap100.dll** ，然後選取 **[屬性]**。</span><span class="sxs-lookup"><span data-stu-id="17252-214">Right-click **msolap100.dll** and select **Properties**.</span></span> <span data-ttu-id="17252-215">按一下 [詳細資訊] 。</span><span class="sxs-lookup"><span data-stu-id="17252-215">Click **Details**.</span></span>  
  
     <span data-ttu-id="17252-216">檢視檔案版本資訊。</span><span class="sxs-lookup"><span data-stu-id="17252-216">View the file version information.</span></span> <span data-ttu-id="17252-217">版本應包含 10.50. \<buildnumber> 。</span><span class="sxs-lookup"><span data-stu-id="17252-217">The version should include 10.50.\<buildnumber>.</span></span>  
  
  
## <a name="see-also"></a><span data-ttu-id="17252-218">另請參閱</span><span class="sxs-lookup"><span data-stu-id="17252-218">See Also</span></span>  
 [<span data-ttu-id="17252-219">PowerPivot for SharePoint 2010 安裝</span><span class="sxs-lookup"><span data-stu-id="17252-219">PowerPivot for SharePoint 2010 Installation</span></span>](../../../2014/sql-server/install/powerpivot-for-sharepoint-2010-installation.md)  
  
  
