---
title: " (查詢執行的選項-SQL Server-ANSI 頁面) |Microsoft Docs"
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
f1_keywords:
- VS.ToolsOptionsPages.QueryExecution.SqlServer.SqlExecutionAnsi
ms.assetid: 0f4c6887-0562-417e-806c-b5cffb1e7c5c
author: rothja
ms.author: jroth
ms.openlocfilehash: 198505c5d14b9fda510d4635dbaa3d3d49483ddf
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87599649"
---
# <a name="options-query-execution-sql-server-ansi-page"></a><span data-ttu-id="2fae6-102"> (查詢執行的選項-SQL Server-ANSI 頁面) </span><span class="sxs-lookup"><span data-stu-id="2fae6-102">Options (Query Execution-SQL Server-ANSI Page)</span></span>
  <span data-ttu-id="2fae6-103">這些 ANSI (ISO) 標準 SET 選項共同定義了使用者查詢的查詢處理環境是執行觸發，還是預存程序。</span><span class="sxs-lookup"><span data-stu-id="2fae6-103">Together, these ANSI (ISO) standard SET options define the query processing environment for the duration of the user's query, a running trigger, or a stored procedure.</span></span> <span data-ttu-id="2fae6-104">不過，這些 SET 選項並沒有包含符合 ISO 標準所需的所有選項。</span><span class="sxs-lookup"><span data-stu-id="2fae6-104">These SET options, however, do not include all of the options required to conform to the ISO standard.</span></span> <span data-ttu-id="2fae6-105">使用此頁面來指定 [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 將使用 ISO 標準中指定的全部或部分設定來執行查詢。</span><span class="sxs-lookup"><span data-stu-id="2fae6-105">Use this page to specify that [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] will run the queries using all or a portion of the settings specified in the ISO standard.</span></span> <span data-ttu-id="2fae6-106">這些選項的變更僅適用於新的 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 查詢。</span><span class="sxs-lookup"><span data-stu-id="2fae6-106">Changes to these options are applied only to new [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] queries.</span></span> <span data-ttu-id="2fae6-107">若要變更目前查詢的選項，請按一下 [**查詢**] 功能表上的 [**查詢選項**]，或在查詢視窗中按一下滑鼠右鍵， [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 然後選取 [**查詢選項**]。</span><span class="sxs-lookup"><span data-stu-id="2fae6-107">To change the options for the current queries, click **Query Options** on the **Query** menu, or right-click in the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Query window and select **Query Options**.</span></span> <span data-ttu-id="2fae6-108">在 **[查詢選項]** 對話方塊中，於 **[執行]** 之下，按一下 **[ANSI]**。</span><span class="sxs-lookup"><span data-stu-id="2fae6-108">In the **Query Options** dialog box, under **Execution**, click **ANSI**.</span></span>  
  
## <a name="ui-element-list"></a><span data-ttu-id="2fae6-109">UI 元素清單</span><span class="sxs-lookup"><span data-stu-id="2fae6-109">UI element list</span></span>  
 <span data-ttu-id="2fae6-110">**SET ANSI_DEFAULTS**</span><span class="sxs-lookup"><span data-stu-id="2fae6-110">**SET ANSI_DEFAULTS**</span></span>  
 <span data-ttu-id="2fae6-111">選取此核取方塊，即可選取所有預設的 ISO 設定。</span><span class="sxs-lookup"><span data-stu-id="2fae6-111">Select this check box to select all of the default ISO settings.</span></span> <span data-ttu-id="2fae6-112">並非所有 ISO 選項皆預設為選取。</span><span class="sxs-lookup"><span data-stu-id="2fae6-112">Not all ISO options are selected by default.</span></span>  
  
 <span data-ttu-id="2fae6-113">**SET QUOTED_IDENTIFIER**</span><span class="sxs-lookup"><span data-stu-id="2fae6-113">**SET QUOTED_IDENTIFIER**</span></span>  
 <span data-ttu-id="2fae6-114">如果選取此核取方塊， [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 就會依循 ISO 有關引號分隔識別碼和常值字串的規則。</span><span class="sxs-lookup"><span data-stu-id="2fae6-114">When this check box is selected, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] follows the ISO rules regarding quotation mark delimiting identifiers and literal strings.</span></span> <span data-ttu-id="2fae6-115">以引號分隔的識別碼可能是 Transact-SQL 的保留關鍵字，或是包含通常識別碼的 Transact-SQL 語法規則不允許的字元。</span><span class="sxs-lookup"><span data-stu-id="2fae6-115">Identifiers delimited by quotation marks can be either Transact-SQL reserved keywords or can contain characters not usually allowed by the Transact-SQL syntax rules for identifiers.</span></span> <span data-ttu-id="2fae6-116">依預設，這個核取方塊為已選取。</span><span class="sxs-lookup"><span data-stu-id="2fae6-116">This check box is selected by default.</span></span>  
  
 <span data-ttu-id="2fae6-117">**SET ANSI_NULL_DFLT_ON**</span><span class="sxs-lookup"><span data-stu-id="2fae6-117">**SET ANSI_NULL_DFLT_ON**</span></span>  
 <span data-ttu-id="2fae6-118">當此值已設定，在 CREATE TABLE 或 ALTER TABLE 陳述式期間未明確定義為 NOT NULL 的所有使用者自訂的資料類型或資料行，都會預設為允許 Null 值。</span><span class="sxs-lookup"><span data-stu-id="2fae6-118">When this value is set, all user-defined data types or columns that are not explicitly defined as NOT NULL during a CREATE TABLE or ALTER TABLE statement default to allowing null values.</span></span> <span data-ttu-id="2fae6-119">依預設，這個核取方塊為已選取。</span><span class="sxs-lookup"><span data-stu-id="2fae6-119">This check box is selected by default.</span></span>  
  
 <span data-ttu-id="2fae6-120">**SET IMPLICIT_TRANSACTIONS**</span><span class="sxs-lookup"><span data-stu-id="2fae6-120">**SET IMPLICIT_TRANSACTIONS**</span></span>  
 <span data-ttu-id="2fae6-121">如果選取此核取方塊，SET IMPLICIT_TRANSACTIONS 會將連接設定為隱含交易模式。</span><span class="sxs-lookup"><span data-stu-id="2fae6-121">When this check box is selected, SET IMPLICIT_TRANSACTIONS sets the connection into implicit transaction mode.</span></span> <span data-ttu-id="2fae6-122">如果清除此核取方塊，則會將連接設定為自動認可交易模式。</span><span class="sxs-lookup"><span data-stu-id="2fae6-122">When this check box is cleared, it returns the connection to autocommit transaction mode.</span></span> <span data-ttu-id="2fae6-123">若要檢閱選取後會啟動隱含交易的陳述式，請參閱 [SET IMPLICIT_TRANSACTIONS &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-implicit-transactions-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="2fae6-123">To review the statements that start an implicit transaction when selected, see [SET IMPLICIT_TRANSACTIONS &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-implicit-transactions-transact-sql).</span></span> <span data-ttu-id="2fae6-124">依預設，不會勾選此核取方塊。</span><span class="sxs-lookup"><span data-stu-id="2fae6-124">This check box is cleared by default.</span></span>  
  
 <span data-ttu-id="2fae6-125">**SET CURSOR_CLOSE_ON_COMMIT**</span><span class="sxs-lookup"><span data-stu-id="2fae6-125">**SET CURSOR_CLOSE_ON_COMMIT**</span></span>  
 <span data-ttu-id="2fae6-126">如果選取此核取方塊，交易認可後開啟的資料指標就會自動關閉 (符合 ISO)。</span><span class="sxs-lookup"><span data-stu-id="2fae6-126">When this check box is selected, any open cursors are closed automatically (in compliance with ISO) when a transaction is committed.</span></span> <span data-ttu-id="2fae6-127">這個值若設定為 OFF，資料指標跨交易界限時會維持開啟，只有在關閉連接或明確地關閉時才會關閉資料指標。</span><span class="sxs-lookup"><span data-stu-id="2fae6-127">When this value is set to OFF, cursors remain open across transaction boundaries, closing only when the connection is closed or when they are explicitly closed.</span></span> <span data-ttu-id="2fae6-128">依預設，不會勾選此核取方塊。</span><span class="sxs-lookup"><span data-stu-id="2fae6-128">This check box is cleared by default.</span></span>  
  
 <span data-ttu-id="2fae6-129">**SET ANSI_PADDING**</span><span class="sxs-lookup"><span data-stu-id="2fae6-129">**SET ANSI_PADDING**</span></span>  
 <span data-ttu-id="2fae6-130">控制資料行針對數值名稱長度短於資料行所定義大小的儲存方式，以及資料行針對 **char**、 **varchar**、 **binary**以及 **varbinary** 資料尾端具有空白之數值的儲存方式。</span><span class="sxs-lookup"><span data-stu-id="2fae6-130">Controls the way the column stores value names shorter than the defined size of the column, and the way the column stores values that have trailing blanks in **char**, **varchar**, **binary**, and **varbinary** data.</span></span> <span data-ttu-id="2fae6-131">這項設定只會影響新資料行的定義。</span><span class="sxs-lookup"><span data-stu-id="2fae6-131">This setting affects only the definition of new columns.</span></span> <span data-ttu-id="2fae6-132">建立好資料行之後， [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 會根據建立資料行之時的設定來儲存值。</span><span class="sxs-lookup"><span data-stu-id="2fae6-132">After the column is created, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] stores the values based on the setting when the column was created.</span></span> <span data-ttu-id="2fae6-133">這項設定後來的變更並不會影響現有的資料行。</span><span class="sxs-lookup"><span data-stu-id="2fae6-133">Existing columns are not affected by a later change to this setting.</span></span> <span data-ttu-id="2fae6-134">依預設，這個核取方塊為已選取。</span><span class="sxs-lookup"><span data-stu-id="2fae6-134">This check box is selected by default.</span></span>  
  
 <span data-ttu-id="2fae6-135">**SET ANSI_WARNINGS**</span><span class="sxs-lookup"><span data-stu-id="2fae6-135">**SET ANSI_WARNINGS**</span></span>  
 <span data-ttu-id="2fae6-136">指定數個錯誤狀況的 ISO 標準行為：</span><span class="sxs-lookup"><span data-stu-id="2fae6-136">Specifies ISO standard behavior for several error conditions:</span></span>  
  
-   <span data-ttu-id="2fae6-137">如果選取此核取方塊，而 Null 值出現在彙總函式 (例如，SUM、AVG、MAX、MIN、STDEV、STDEVP、VAR、VARP 或 COUNT) 中，就會產生警告訊息。</span><span class="sxs-lookup"><span data-stu-id="2fae6-137">When this check box is selected, if null values appear in aggregate functions (such as SUM, AVG, MAX, MIN, STDEV, STDEVP, VAR, VARP, or COUNT), a warning message is generated.</span></span> <span data-ttu-id="2fae6-138">設定為 OFF 時，則不會發出警告。</span><span class="sxs-lookup"><span data-stu-id="2fae6-138">When OFF, no warning is issued.</span></span>  
  
-   <span data-ttu-id="2fae6-139">如果清除此核取方塊，除以零及算術溢位錯誤會造成陳述式回復，並產生錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="2fae6-139">When this check box is cleared, divide-by-zero and arithmetic overflow errors cause the statement to be rolled back and an error message to be generated.</span></span> <span data-ttu-id="2fae6-140">設定為 OFF 時，除以零及算術溢位錯誤會造成傳回 Null 值。</span><span class="sxs-lookup"><span data-stu-id="2fae6-140">When OFF, divide-by-zero and arithmetic overflow errors cause null values to be returned.</span></span> <span data-ttu-id="2fae6-141">如果在 **character**、**Unicode** 或 **binary** 資料行中嘗試 INSERT 或 UPDATE 作業，且新值長度超過資料行的大小上限時，除以零或算術溢位錯誤會造成傳回 Null 值。</span><span class="sxs-lookup"><span data-stu-id="2fae6-141">The behavior in which a divide-by-zero or arithmetic overflow error causes null values to be returned occurs if an INSERT or UPDATE operation is attempted on a **character**, **Unicode**, or **binary** column in which the length of a new value exceeds the maximum size of the column.</span></span> <span data-ttu-id="2fae6-142">如果 SET ANSI_WARNINGS 為 ON，INSERT 或 UPDATE 作業就會依 ISO 標準的指定加以取消。</span><span class="sxs-lookup"><span data-stu-id="2fae6-142">If SET ANSI_WARNINGS is ON, the INSERT or UPDATE operation is canceled as specified by the ISO standard.</span></span> <span data-ttu-id="2fae6-143">字元資料行尾端的空格會被忽略，二進位資料行尾端的 Null 也會被忽略。</span><span class="sxs-lookup"><span data-stu-id="2fae6-143">Trailing blanks are ignored for character columns and trailing nulls are ignored for binary columns.</span></span> <span data-ttu-id="2fae6-144">當它是 OFF 時，便會將資料截斷成為資料行大小，陳述式會繼續作業。</span><span class="sxs-lookup"><span data-stu-id="2fae6-144">When OFF, data is truncated to the size of the column and the statement succeeds.</span></span>  
  
 <span data-ttu-id="2fae6-145">依預設，這個核取方塊為已選取。</span><span class="sxs-lookup"><span data-stu-id="2fae6-145">This check box is selected by default.</span></span>  
  
 <span data-ttu-id="2fae6-146">**SET ANSI_NULLS**</span><span class="sxs-lookup"><span data-stu-id="2fae6-146">**SET ANSI_NULLS**</span></span>  
 -   <span data-ttu-id="2fae6-147">指定搭配 null 值一起使用時，等於 (=) 和不等於 (<>) 比較運算子的 ISO 相容行為。</span><span class="sxs-lookup"><span data-stu-id="2fae6-147">Specifies ISO compliant behavior of the equals (=) and not equal to (<>) comparison operators when used with null values.</span></span> <span data-ttu-id="2fae6-148">如果選取 SET ANSI_NULLS，所有針對 Null 值的比較，都會評估為 UNKNOWN，也就是符合 ISO 的行為。</span><span class="sxs-lookup"><span data-stu-id="2fae6-148">When SET ANSI_NULLS is selected, all comparisons against a null value evaluate to UNKNOWN, the ISO compliant behavior.</span></span> <span data-ttu-id="2fae6-149">如果未選取 SET ANSI_NULLS，所有資料針對 Null 值的比較，都會評估為 TRUE。</span><span class="sxs-lookup"><span data-stu-id="2fae6-149">When SET ANSI_NULLS is not selected, comparisons of all data against a null value evaluate to TRUE.</span></span> <span data-ttu-id="2fae6-150">依預設，這個核取方塊為已選取。</span><span class="sxs-lookup"><span data-stu-id="2fae6-150">This check box is selected by default.</span></span>  
  
 <span data-ttu-id="2fae6-151">**重設為預設值**</span><span class="sxs-lookup"><span data-stu-id="2fae6-151">**Reset to Default**</span></span>  
 <span data-ttu-id="2fae6-152">將此頁面上的所有值重設為原始預設值。</span><span class="sxs-lookup"><span data-stu-id="2fae6-152">Resets all values on this page to the original default values.</span></span>  
  
  
