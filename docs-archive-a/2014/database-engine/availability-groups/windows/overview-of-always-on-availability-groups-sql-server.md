---
title: AlwaysOn 可用性群組 (SQL Server) 的總覽 |Microsoft Docs
ms.custom: ''
ms.date: 10/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- secondary databases [SQL Server], in availability group
- primary databases [SQL Server], in availability group
- Availability Groups [SQL Server], about
- Availability Groups [SQL Server], data movement
- Availability Groups [SQL Server]
ms.assetid: 04fd9d95-4624-420f-a3be-1794309b3a47
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: bc49a841daaeb0f7bda6f793890433f26c6b5c1f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87592848"
---
# <a name="overview-of-alwayson-availability-groups-sql-server"></a><span data-ttu-id="8cbfc-102">AlwaysOn 可用性群組概觀 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="8cbfc-102">Overview of AlwaysOn Availability Groups (SQL Server)</span></span>
  <span data-ttu-id="8cbfc-103">此主題介紹在 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] 中設定與管理一個或多個可用性群組的 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)]中心概念。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-103">This topic introduces the [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] concepts that are central for configuring and managing one or more availability groups in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)].</span></span> <span data-ttu-id="8cbfc-104">如需可用性群組所提供的優點摘要以及 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] 術語的概觀，請參閱 [AlwaysOn 可用性群組 &#40;SQL Server&#41;](always-on-availability-groups-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-104">For a summary of the benefits offered by availability groups and an overview of [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] terminology, see [AlwaysOn Availability Groups &#40;SQL Server&#41;](always-on-availability-groups-sql-server.md).</span></span>

 <span data-ttu-id="8cbfc-105">*可用性群組*支援一組可一起容錯移轉之離散化使用者資料庫（稱為「*可用性資料庫*」（availability database））的容錯移轉環境。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-105">An *availability group* supports a failover environment for a discrete set of user databases, known as *availability databases*, that fail over together.</span></span> <span data-ttu-id="8cbfc-106">可用性群組支援一組主要的資料庫，以及一到八組對應的次要資料庫。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-106">An availability group supports a set of primary databases and one to eight sets of corresponding secondary databases.</span></span> <span data-ttu-id="8cbfc-107">次要資料庫「並非」  備份。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-107">Secondary databases are *not* backups.</span></span> <span data-ttu-id="8cbfc-108">請持續定期備份您的資料庫及其交易記錄。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-108">Continue to back up your databases and their transaction logs on a regular basis.</span></span>

> [!TIP]
>  <span data-ttu-id="8cbfc-109">您可為主要資料庫建立任何類型的備份。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-109">You can create any type of backup of a primary database.</span></span> <span data-ttu-id="8cbfc-110">或者，您亦可為次要資料庫建立記錄備份和僅限複製的完整備份。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-110">Alternatively, you can create log backups and copy-only full backups of secondary databases.</span></span> <span data-ttu-id="8cbfc-111">如需詳細資訊，請參閱[使用中次要：在次要複本上備份 &#40;AlwaysOn 可用性群組&#41;](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md)。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-111">For more information, see [Active Secondaries: Backup on Secondary Replicas &#40;AlwaysOn Availability Groups&#41;](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md).</span></span>

 <span data-ttu-id="8cbfc-112">每一組可用性資料庫都是由 *「可用性複本」* (Availability Replica) 主控。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-112">Each set of availability database is hosted by an *availability replica*.</span></span> <span data-ttu-id="8cbfc-113">有兩種類型的可用性複本：單一 *「主要複本」* (Primary Replica)，</span><span class="sxs-lookup"><span data-stu-id="8cbfc-113">Two types of availability replicas exist: a single *primary replica*.</span></span> <span data-ttu-id="8cbfc-114">以及一到八個「次要複本」  (Secondary Replica)。前者裝載主要資料庫，後者各裝載一組次要資料庫，而且可以當做可用性群組的潛在容錯移轉目標。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-114">which hosts the primary databases, and one to eight *secondary replicas*, each of which hosts a set of secondary databases and serves as a potential failover targets for the availability group.</span></span> <span data-ttu-id="8cbfc-115">可用性群組會在可用性複本層級容錯移轉。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-115">An availability group fails over at the level of an availability replica.</span></span> <span data-ttu-id="8cbfc-116">可用性複本僅在資料庫層級針對某個可用性群組中的一組資料庫提供備援。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-116">An availability replica provides redundancy only at the database level-for the set of databases in one availability group.</span></span> <span data-ttu-id="8cbfc-117">資料庫問題，例如資料庫因為資料檔案遺失而變得可疑或交易記錄損毀，並不會造成容錯移轉。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-117">Failovers are not caused by database issues such as a database becoming suspect due to a loss of a data file or corruption of a transaction log.</span></span>

 <span data-ttu-id="8cbfc-118">主要複本提供主要資料庫，以供用戶端讀寫連接使用。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-118">The primary replica makes the primary databases available for read-write connections from clients.</span></span> <span data-ttu-id="8cbfc-119">另外，在資料庫層級發生的 *「資料同步處理」*(Data Synchronization) 程序中，</span><span class="sxs-lookup"><span data-stu-id="8cbfc-119">Also, in a process known as *data synchronization*, which occurs at the database level.</span></span> <span data-ttu-id="8cbfc-120">主要複本會將每個主要資料庫的交易記錄檔記錄傳送到每個次要資料庫。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-120">The primary replica sends transaction log records of each primary database to every secondary database.</span></span> <span data-ttu-id="8cbfc-121">每個次要複本都會快取交易記錄檔記錄 (「強行寫入」  記錄檔)，然後將它們套用到對應的次要資料庫。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-121">Every secondary replica caches the transaction log records (*hardens* the log) and then applies them to its corresponding secondary database.</span></span> <span data-ttu-id="8cbfc-122">資料同步處理在主要資料庫和每個連接的次要資料庫之間發生，與其他資料庫無關。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-122">Data synchronization occurs between the primary database and each connected secondary database, independently of the other databases.</span></span> <span data-ttu-id="8cbfc-123">因此，次要資料庫可以暫停或失敗，而不影響其他次要資料庫，主要資料庫也可以暫停或失敗，而不影響其他主要資料庫。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-123">Therefore, a secondary database can be suspended or fail without affecting other secondary databases, and a primary database can be suspended or fail without affecting other primary databases.</span></span>

 <span data-ttu-id="8cbfc-124">或者，您可以設定一個或多個次要複本以支援對次要資料庫的唯讀存取，而且您可以設定任何次要複本以允許在次要資料庫上進行備份。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-124">Optionally, you can configure one or more secondary replicas to support read-only access to secondary databases, and you can configure any secondary replica to permit backups on secondary databases.</span></span>

 <span data-ttu-id="8cbfc-125">部署 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] 需要一個 Windows Server 容錯移轉叢集 (WSFC) 叢集。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-125">Deploying [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] requires a Windows Server Failover Clustering (WSFC) cluster.</span></span> <span data-ttu-id="8cbfc-126">給定可用性群組的每個可用性複本都必須位在相同 WSFC 叢集的不同節點上。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-126">Each availability replica of a given availability group must reside on a different node of the same WSFC cluster.</span></span> <span data-ttu-id="8cbfc-127">唯一的例外狀況是在移轉至另一個 WSFC 叢集期間，可用性群組可以暫時跨兩個叢集。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-127">The only exception is that while being migrated to another WSFC cluster, an availability group can temporarily straddle two clusters.</span></span>

 <span data-ttu-id="8cbfc-128">對於您建立的每個可用性群組，系統會建立一個 WSFC 資源群組。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-128">A WSFC resource group is created for every availability group that you create.</span></span> <span data-ttu-id="8cbfc-129">WSFC 叢集會監視此資源群組，以評估主要複本的健康情況。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-129">The WSFC cluster monitors this resource group to evaluate the health of the primary replica.</span></span> <span data-ttu-id="8cbfc-130">[!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] 的仲裁會以 WSFC 叢集中的所有節點為基礎，而不論給定叢集節點是否裝載任何可用性複本。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-130">The quorum for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] is based on all nodes in the WSFC cluster regardless of whether a given cluster node hosts any availability replicas.</span></span> <span data-ttu-id="8cbfc-131">相較於資料庫鏡像， [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]沒有見證角色。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-131">In contrast to database mirroring, there is no witness role in [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span>

> [!NOTE]
>  <span data-ttu-id="8cbfc-132">如需 SQL Server AlwaysOn 元件與 WSFC 叢集之關聯性的相關資訊，請參閱 [SQL Server 的 Windows Server 容錯移轉叢集 &#40;WSFC&#41;](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-132">For information about the relationship of SQL Server AlwaysOn components to the WSFC cluster, see [Windows Server Failover Clustering &#40;WSFC&#41; with SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md).</span></span>

 <span data-ttu-id="8cbfc-133">下圖顯示可用性群組，其中包含一個主要複本和四個次要複本。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-133">The following illustration shows an availability group that contains one primary replica and four secondary replicas.</span></span> <span data-ttu-id="8cbfc-134">最多可支援八個次要複本，包括一個主要複本和兩個同步認可次要複本。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-134">Up to eight secondary replicas are supported, including one primary replica and two synchronous-commit secondary replicas.</span></span>

 <span data-ttu-id="8cbfc-135">![具有五個複本的可用性群組](../../media/aoag-agintrofigure.gif "具有五個複本的可用性群組")</span><span class="sxs-lookup"><span data-stu-id="8cbfc-135">![Availability group with five replicas](../../media/aoag-agintrofigure.gif "Availability group with five replicas")</span></span>


##  <a name="availability-databases"></a><a name="AvDbs"></a><span data-ttu-id="8cbfc-136">可用性資料庫</span><span class="sxs-lookup"><span data-stu-id="8cbfc-136">Availability Databases</span></span>
 <span data-ttu-id="8cbfc-137">若要將資料庫加入可用性群組，該資料庫必須是存在於裝載主要複本之伺服器執行個體的線上讀寫資料庫。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-137">To add a database to an availability group, the database must be an online, read-write database that exists on the server instance that hosts the primary replica.</span></span> <span data-ttu-id="8cbfc-138">當您加入資料庫時，該資料庫會加入可用性群組做為主要資料庫，同時仍然可以供用戶端使用。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-138">When you add a database, it joins the availability group as a primary database, while remaining available to clients.</span></span> <span data-ttu-id="8cbfc-139">在新主要資料庫的備份還原到裝載次要複本的伺服器執行個體 (使用 RESTORE WITH NORECOVERY) 之前，不會存在任何對應的次要資料庫。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-139">No corresponding secondary database exists until backups of the new primary database are restored to the server instance that hosts the secondary replica (using RESTORE WITH NORECOVERY).</span></span> <span data-ttu-id="8cbfc-140">新的次要資料庫在加入可用性群組之前，處於 RESTORING 狀態。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-140">The new secondary database is in the RESTORING state until it is joined to the availability group.</span></span> <span data-ttu-id="8cbfc-141">如需詳細資訊，請參閱[於 AlwaysOn 次要資料庫啟動資料移動 &#40;SQL Server&#41;](start-data-movement-on-an-always-on-secondary-database-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-141">For more information, see [Start Data Movement on an AlwaysOn Secondary Database &#40;SQL Server&#41;](start-data-movement-on-an-always-on-secondary-database-sql-server.md).</span></span>

 <span data-ttu-id="8cbfc-142">加入時，會將次要資料庫置於 ONLINE 狀態，並起始對應主要資料庫的資料同步處理。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-142">Joining places the secondary database into the ONLINE state and initiates data synchronization with the corresponding primary database.</span></span> <span data-ttu-id="8cbfc-143">*「資料同步處理」* (Data Synchronization) 是將主要資料庫的變更重現在次要資料庫上的程序。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-143">*Data synchronization* is the process by which changes to a primary database are reproduced on a secondary database.</span></span> <span data-ttu-id="8cbfc-144">資料同步處理涉及主要資料庫將交易記錄檔記錄傳送到次要資料庫。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-144">Data synchronization involves the primary database sending transaction log records to the secondary database.</span></span>

> [!IMPORTANT]
>  <span data-ttu-id="8cbfc-145">可用性資料庫有時候在 [!INCLUDE[tsql](../../../includes/tsql-md.md)]、PowerShell 和 SQL Server 管理物件 (SMO) 名稱中會稱為「資料庫複本」  。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-145">An availability database is sometimes called a *database replica* in [!INCLUDE[tsql](../../../includes/tsql-md.md)], PowerShell, and SQL Server Management Objects (SMO) names.</span></span> <span data-ttu-id="8cbfc-146">例如，在 AlwaysOn 動態管理檢視名稱中就使用了「資料庫複本」一詞，這個檢視會傳回可用性資料庫的相關資訊：**sys.dm_hadr_database_replica_states** 和 **sys.dm_hadr_database_replica_cluster_states**。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-146">For example, the term "database replica" is used in the names of the AlwaysOn dynamic management views that return information about availability databases:  **sys.dm_hadr_database_replica_states** and **sys.dm_hadr_database_replica_cluster_states**.</span></span> <span data-ttu-id="8cbfc-147">但在《SQL Server 線上叢書》中，「複本」一詞通常是指可用性複本。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-147">However, in SQL Server Books Online, the term "replica" typically refers to availability replicas.</span></span> <span data-ttu-id="8cbfc-148">例如「主要複本」與「次要複本」一律指可用性複本。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-148">For example, "primary replica" and "secondary replica" always refer to availability replicas.</span></span>

##  <a name="availability-replicas"></a><a name="AGsARsADBs"></a><span data-ttu-id="8cbfc-149">可用性複本</span><span class="sxs-lookup"><span data-stu-id="8cbfc-149">Availability Replicas</span></span>
 <span data-ttu-id="8cbfc-150">每個可用性群組都會定義一組兩個或多個容錯移轉夥伴，稱為可用性複本。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-150">Each availability group defines a set of two or more failover partners known as availability replicas.</span></span> <span data-ttu-id="8cbfc-151">*「可用性複本」* (Availability Replica) 是可用性群組的元件。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-151">*Availability replicas* are components of the availability group.</span></span> <span data-ttu-id="8cbfc-152">每個可用性複本都會在可用性群組中裝載一個可用性資料庫的副本。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-152">Each availability replica hosts a copy of the availability databases in the availability group.</span></span> <span data-ttu-id="8cbfc-153">對於給定的可用性群組而言，可用性複本必須由位於某個 WSFC 叢集中不同節點上的個別 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 執行個體所裝載。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-153">For a given availability group, the availability replicas must be hosted by separate instances of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] residing on different nodes of a WSFC cluster.</span></span> <span data-ttu-id="8cbfc-154">這些伺服器執行個體每一個都必須啟用 AlwaysOn。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-154">Each of these server instances must be enabled for AlwaysOn.</span></span>

 <span data-ttu-id="8cbfc-155">給定的執行個體只能裝載每個可用性群組的一個可用性複本。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-155">A given instance can host only one availability replica per availability group.</span></span> <span data-ttu-id="8cbfc-156">但是，每一個執行個體都可以用於多個可用性群組。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-156">However, each instance can be used for many availability groups.</span></span> <span data-ttu-id="8cbfc-157">給定的執行個體可以是獨立執行個體或 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 容錯移轉叢集執行個體 (FCI)。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-157">A given instance can be either a stand-alone instance or a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster instance (FCI).</span></span> <span data-ttu-id="8cbfc-158">如果您需要伺服器層級的備援性，請使用容錯移轉叢集執行個體。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-158">If you require server-level redundancy, use Failover Cluster Instances.</span></span>

 <span data-ttu-id="8cbfc-159">每個可用性複本都會獲指派一個初始角色，即「主要角色」  或「次要角色」  ，這個角色是由該複本的可用性資料庫所繼承。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-159">Every availability replica is assigned an initial role-either the *primary role* or the *secondary role*, which is inherited by the availability databases of that replica.</span></span> <span data-ttu-id="8cbfc-160">給定複本的角色會決定所裝載的是讀寫資料庫還是唯讀資料庫。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-160">The role of a given replica determines whether it hosts read-write databases or read-only databases.</span></span> <span data-ttu-id="8cbfc-161">其中一個複本 (也就是所謂的「主要複本」  ) 會獲指派主要角色並裝載讀寫資料庫，也就是「主要資料庫」  。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-161">One replica, known as the *primary replica*, is assigned the primary role and hosts read-write databases, which are known as *primary databases*.</span></span> <span data-ttu-id="8cbfc-162">至少有一個其他複本 (也就是所謂的 「次要複本」  ) 會獲指派次要角色。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-162">At least one other replica, known as a *secondary replica*, is assigned the secondary role.</span></span> <span data-ttu-id="8cbfc-163">次要複本會裝載唯讀資料庫，也就是次要資料庫。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-163">A secondary replica hosts read-only databases, known as secondary databases.</span></span>

> [!NOTE]
>  <span data-ttu-id="8cbfc-164">當可用性複本的角色未定 (例如在容錯移轉期間) 時，其資料庫會暫時處於 NOT SYNCHRONIZING 狀態。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-164">When the role of an availability replica is indeterminate, such as during a failover, its databases are temporarily in a NOT SYNCHRONIZING state.</span></span> <span data-ttu-id="8cbfc-165">在可用性複本的角色解析之前，會將其角色設為 RESOLVING。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-165">Their role is set to RESOLVING until the role of the availability replica has resolved.</span></span> <span data-ttu-id="8cbfc-166">如果可用性複本解析為主要角色，其資料庫會變成主要資料庫。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-166">If an availability replica resolves to the primary role, its databases become the primary databases.</span></span> <span data-ttu-id="8cbfc-167">如果可用性複本解析為次要角色，其資料庫會變成次要資料庫。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-167">If an availability replica resolves to the secondary role, its databases become secondary databases.</span></span>

##  <a name="availability-modes"></a><a name="AvailabilityModes"></a><span data-ttu-id="8cbfc-168">可用性模式</span><span class="sxs-lookup"><span data-stu-id="8cbfc-168">Availability Modes</span></span>
 <span data-ttu-id="8cbfc-169">可用性模式是每個可用性複本的屬性。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-169">The availability mode is a property of each availability replica.</span></span> <span data-ttu-id="8cbfc-170">可用性模式會決定在給定次要複本將交易記錄寫入至磁碟 (儲存記錄) 之前，主要複本是否等待認可資料庫上的交易。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-170">The availability mode determines whether the primary replica waits to commit transactions on a database until a given secondary replica has written the transaction log records to disk (hardened the log).</span></span> [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]<span data-ttu-id="8cbfc-171">支援兩個可用性模式：「非同步認可模式」  和「同步認可模式」  。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-171">supports two availability modes-*asynchronous-commit mode* and *synchronous-commit mode*.</span></span>

-   <span data-ttu-id="8cbfc-172">**非同步認可模式**</span><span class="sxs-lookup"><span data-stu-id="8cbfc-172">**Asynchronous-commit mode**</span></span>

     <span data-ttu-id="8cbfc-173">使用此可用性模式的可用性複本就是所謂的「非同步認可複本」\*\*。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-173">An availability replica that uses this availability mode is known as an*asynchronous-commit replica*.</span></span> <span data-ttu-id="8cbfc-174">在非同步認可模式下，主要複本會認可交易，而不等候確認非同步認可次要複本已經強行寫入記錄。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-174">Under asynchronous-commit mode, the primary replica commits transactions without waiting for acknowledgement that an asynchronous-commit secondary replica has hardened the log.</span></span> <span data-ttu-id="8cbfc-175">非同步認可模式會將次要資料庫上的交易延遲降至最低，但允許這些資料庫落後主要資料庫，因此可能會發生資料遺失。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-175">Asynchronous-commit mode minimizes transaction latency on the secondary databases but allows them to lag behind the primary databases, making some data loss possible.</span></span>

-   <span data-ttu-id="8cbfc-176">**同步認可模式**</span><span class="sxs-lookup"><span data-stu-id="8cbfc-176">**Synchronous-commit mode**</span></span>

     <span data-ttu-id="8cbfc-177">使用此可用性模式的可用性複本就是所謂的「同步認可複本」  。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-177">An availability replica that uses this availability mode is known as a *synchronous-commit replica*.</span></span> <span data-ttu-id="8cbfc-178">在同步認可模式下認可交易之前，同步認可主要複本會等候同步認可次要複本確認它已完成強行寫入記錄。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-178">Under synchronous-commit mode, before committing transactions, a synchronous-commit primary replica waits for a synchronous-commit secondary replica to acknowledge that it has finished hardening the log.</span></span> <span data-ttu-id="8cbfc-179">同步認可模式可確定，一旦給定次要資料庫與主要資料庫同步處理之後，認可的交易就會受到完整保護。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-179">Synchronous-commit mode ensures that once a given secondary database is synchronized with the primary database, committed transactions are fully protected.</span></span> <span data-ttu-id="8cbfc-180">這種保護是以增加交易延遲做為代價。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-180">This protection comes at the cost of increased transaction latency.</span></span>

 <span data-ttu-id="8cbfc-181">如需詳細資訊，請參閱[可用性模式 &#40;AlwaysOn 可用性群組&#41;](availability-modes-always-on-availability-groups.md)。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-181">For more information, see [Availability Modes &#40;AlwaysOn Availability Groups&#41;](availability-modes-always-on-availability-groups.md).</span></span>

##  <a name="types-of-failover"></a><a name="FormsOfFailover"></a><span data-ttu-id="8cbfc-182">容錯移轉的類型</span><span class="sxs-lookup"><span data-stu-id="8cbfc-182">Types of Failover</span></span>
 <span data-ttu-id="8cbfc-183">在主要複本與次要複本之間的工作階段內容中，主要和次要角色在程序中可能可以互換，稱為 *「容錯移轉」* (Failover)。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-183">Within the context of a session between the primary replica and a secondary replica, the primary and secondary roles are potentially interchangeable in a process known as *failover*.</span></span> <span data-ttu-id="8cbfc-184">在容錯移轉期間，目標次要複本會轉換到主要角色，變成新的主要複本。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-184">During a failover the target secondary replica transitions to the primary role, becoming the new primary replica.</span></span> <span data-ttu-id="8cbfc-185">新的主要複本會將其資料庫變成線上狀態做為主要資料庫，而且用戶端應用程式可以連接至這些資料庫。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-185">The new primary replica brings its databases online as the primary databases, and client applications can connect to them.</span></span> <span data-ttu-id="8cbfc-186">當先前的主要複本可以使用時，會轉換到次要角色，變成次要複本。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-186">When the former primary replica is available, it transitions to the secondary role, becoming a secondary replica.</span></span> <span data-ttu-id="8cbfc-187">先前的主要資料庫就會變成次要資料庫，而且資料同步處理會繼續。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-187">The former primary databases become secondary databases and data synchronization resumes.</span></span>

 <span data-ttu-id="8cbfc-188">容錯移轉的形式共有三種：自動、手動和強制 (有遺失資料的可能)。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-188">Three forms of failover exist-automatic, manual, and forced (with possible data loss).</span></span> <span data-ttu-id="8cbfc-189">給定次要複本支援的容錯移轉形式取決於其可用性模式，而且針對同步認可模式，則取決於主要複本和目標次要複本上的容錯移轉模式，如下所示。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-189">The form or forms of failover supported by a given secondary replica depends on its availability mode, and, for synchronous-commit mode, on the failover mode on the primary replica and target secondary replica, as follows.</span></span>

-   <span data-ttu-id="8cbfc-190">如果目標次要複本目前與 avt1」同步處理，則同步認可模式支援兩種形式的容錯移轉*規劃的手動故障*轉移和*自動容錯移轉*。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-190">Synchronous-commit mode supports two forms of failover-*planned manual failover* and *automatic failover*, if the target secondary replica is currently synchronized with the avt1.</span></span> <span data-ttu-id="8cbfc-191">這些容錯移轉形式的支援取決於容錯移轉夥伴上的 *「容錯移轉模式屬性」* (Failover Mode Property) 設定。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-191">The support for these forms of failover depends on the setting of the *failover mode property* on the failover partners.</span></span> <span data-ttu-id="8cbfc-192">如果容錯移轉模式在主要或次要複本上設為「手動」，則只支援該次要複本的手動容錯移轉。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-192">If failover mode is set to "manual" on either the primary or secondary replica, only manual failover is supported for that secondary replica.</span></span> <span data-ttu-id="8cbfc-193">如果容錯移轉模式在主要和次要複本上都設為「自動」，則在該次要複本上同時支援自動和手動容錯移轉。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-193">If failover mode is set to "automatic" on both the primary and secondary replicas, both automatic and manual failover are supported on that secondary replica.</span></span>

    -   <span data-ttu-id="8cbfc-194">**已規劃的手動容錯移轉** (不會遺失資料)</span><span class="sxs-lookup"><span data-stu-id="8cbfc-194">**Planned manual failover** (without data loss)</span></span>

         <span data-ttu-id="8cbfc-195">在資料庫管理員發出容錯移轉命令，並使同步處理的次要複本轉換到主要角色 (擁有資料保護保證)，而主要複本轉換到次要角色之後，會發生手動容錯移轉。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-195">A manual failover occurs after a database administrator issues a failover command and causes a synchronized secondary replica to transition to the primary role (with guaranteed data protection) and the primary replica to transition to the secondary role.</span></span> <span data-ttu-id="8cbfc-196">手動容錯移轉要求主要複本和目標次要複本都在同步認可模式下執行，而且次要複本必須已經經過同步處理。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-196">A manual failover requires that both the primary replica and the target secondary replica are running under synchronous-commit mode, and the secondary replica must already be synchronized.</span></span>

    -   <span data-ttu-id="8cbfc-197">**自動容錯移轉** (不會遺失資料)</span><span class="sxs-lookup"><span data-stu-id="8cbfc-197">**Automatic failover** (without data loss)</span></span>

         <span data-ttu-id="8cbfc-198">自動容錯移轉的發生，是為了回應造成同步處理的次要複本轉換到主要角色 (擁有資料保護保證) 的失敗。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-198">An automatic failover occurs in response to a failure that causes a synchronized secondary replica to transition to the primary role (with guaranteed data protection).</span></span> <span data-ttu-id="8cbfc-199">當先前的主要複本變成可以使用時，會轉換到次要角色。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-199">When the former primary replica becomes available, it transitions to the secondary role.</span></span> <span data-ttu-id="8cbfc-200">自動容錯移轉要求主要複本和目標次要複本都在同步認可模式下執行，而且容錯移轉模式設為「自動」。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-200">Automatic failover requires that both the primary replica and the target secondary replica are running under synchronous-commit mode with the failover mode set to "Automatic".</span></span> <span data-ttu-id="8cbfc-201">此外，次要複本必須已經過同步處理、擁有 WSFC 仲裁，而且符合可用性群組之 [具彈性的容錯移轉原則](flexible-automatic-failover-policy-availability-group.md)所指定的條件。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-201">In addition, the secondary replica must already be synchronized, have WSFC quorum, and meet the conditions specified by the [flexible failover policy](flexible-automatic-failover-policy-availability-group.md)of the availability group.</span></span>

        > [!IMPORTANT]
        >  <span data-ttu-id="8cbfc-202">SQL Server 容錯移轉叢集執行個體 (FCI) 不支援依照可用性群組進行自動容錯移轉，因此任何由 FCI 裝載的可用性複本只能設定為手動容錯移轉。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-202">SQL Server Failover Cluster Instances (FCIs) do not support automatic failover by availability groups, so any availability replica that is hosted by an FCI can only be configured for manual failover.</span></span>

    > [!NOTE]
    >  <span data-ttu-id="8cbfc-203">請注意，如果您在已同步處理的次要複本上發出強制容錯移轉命令，次要複本的行為會與規劃的手動容錯移轉相同。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-203">Note that if you issue a forced failover command on a synchronized secondary replica, the secondary replica behaves the same as for a planned manual failover.</span></span>

-   <span data-ttu-id="8cbfc-204">在非同步認可模式下，容錯移轉的唯一形式為強制手動容錯移轉 (可能會遺失資料)，通常稱為「強制容錯移轉」  。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-204">Under asynchronous-commit mode, the only form of failover is forced manual failover (with possible data loss), typically called *forced failover*.</span></span> <span data-ttu-id="8cbfc-205">強制容錯移轉只能手動起始，因此視為一種手動容錯移轉。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-205">Forced failover is considered a form of manual failover because it can only be initiated manually.</span></span> <span data-ttu-id="8cbfc-206">強制容錯移轉是一個災難復原選項。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-206">Forced failover is a disaster recovery option.</span></span> <span data-ttu-id="8cbfc-207">它是目標次要複本沒有與主要複本同步處理時，唯一可行的容錯移轉形式。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-207">It is the only form of failover that is possible when the target secondary replica is not synchronized with the primary replica.</span></span>

 <span data-ttu-id="8cbfc-208">如需詳細資訊，請參閱[容錯移轉及容錯移轉模式 &#40;AlwaysOn 可用性群組&#41;](failover-and-failover-modes-always-on-availability-groups.md)。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-208">For more information, see [Failover and Failover Modes &#40;AlwaysOn Availability Groups&#41;](failover-and-failover-modes-always-on-availability-groups.md).</span></span>

##  <a name="client-connections"></a><a name="ClientConnections"></a> <span data-ttu-id="8cbfc-209">用戶端連接</span><span class="sxs-lookup"><span data-stu-id="8cbfc-209">Client Connections</span></span>
 <span data-ttu-id="8cbfc-210">您可以建立可用性群組接聽程式，以便將用戶端連接提供給給定可用性群組的主要複本。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-210">You can provide client connectivity to the primary replica of a given availability group by creating an availability group listener.</span></span> <span data-ttu-id="8cbfc-211">*「可用性群組接聽程式」* (Availability Group Listener) 會將連接至給定可用性群組的一組資源提供給適當可用性複本的直接用戶端連接。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-211">An *availability group listener* provides a set of resources that is attached to a given availability group to direct client connections to the appropriate availability replica.</span></span>

 <span data-ttu-id="8cbfc-212">可用性群組接聽程式與當做虛擬網路名稱 (VNN)、一個或多個虛擬 IP 位址 (VIP)，以及 TCP 通訊埠編號的唯一 DNS 名稱相關聯。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-212">An availability group listener is associated with a unique DNS name that serves as a virtual network name (VNN), one or more virtual IP addresses (VIPs), and a TCP port number.</span></span> <span data-ttu-id="8cbfc-213">如需詳細資訊，請參閱[可用性群組接聽程式、用戶端連接性及應用程式容錯移轉 &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md)。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-213">For more information, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>

> [!TIP]
>  <span data-ttu-id="8cbfc-214">如果可用性群組只有兩個可用性複本，而且未設定為允許以唯讀方式存取次要複本，則用戶端可以使用 [資料庫鏡像連接字串](../../database-mirroring/connect-clients-to-a-database-mirroring-session-sql-server.md)連接到主要複本。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-214">If an availability group possesses only two availability replicas and is not configured to allow read-access to the secondary replica, clients can connect to the primary replica by using a [database mirroring connection string](../../database-mirroring/connect-clients-to-a-database-mirroring-session-sql-server.md).</span></span> <span data-ttu-id="8cbfc-215">在您將資料庫從資料庫鏡像移轉到 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]之後，這個方法可能暫時很實用。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-215">This approach can be useful temporarily after you migrate a database from database mirroring to [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="8cbfc-216">在您加入其他次要複本之前，您需要為可用性群組建立可用性群組接聽程式，並更新您的應用程式使用此接聽程式的網路名稱。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-216">Before you add additional secondary replicas, you will need to create an availability group listener the availability group and update your applications to use the network name of the listener.</span></span>

##  <a name="active-secondary-replicas"></a><a name="ActiveSecondaries"></a><span data-ttu-id="8cbfc-217">作用中次要複本</span><span class="sxs-lookup"><span data-stu-id="8cbfc-217">Active Secondary Replicas</span></span>
 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="8cbfc-218">支援使用中次要複本。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-218">supports active secondary replicas.</span></span> <span data-ttu-id="8cbfc-219">使用中次要複本功能提供下列支援：</span><span class="sxs-lookup"><span data-stu-id="8cbfc-219">Active secondary capabilities include support for:</span></span>

-   <span data-ttu-id="8cbfc-220">**對次要複本執行備份作業**</span><span class="sxs-lookup"><span data-stu-id="8cbfc-220">**Performing backup operations on secondary replicas**</span></span>

     <span data-ttu-id="8cbfc-221">次要複本可以備份記錄以及完整資料庫、檔案或檔案群組的 [只複製](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md) 備份。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-221">The secondary replicas support performing log backups and [copy-only](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md) backups of a full database, file, or filegroup.</span></span> <span data-ttu-id="8cbfc-222">您可以設定可用性群組來指定應該執行備份之處的喜好設定。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-222">You can configure the availability group to specify a preference for where backups should be performed.</span></span> <span data-ttu-id="8cbfc-223">請務必了解，喜好設定並不是由 SQL Server 強制施行，所以它對於隨選備份沒有任何影響。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-223">It is important to understand that the preference is not enforced by SQL Server, so it has no impact on ad-hoc backups.</span></span> <span data-ttu-id="8cbfc-224">這個喜好設定的解譯取決於您在給定可用性群組之每個資料庫的備份作業中所編寫的邏輯 (如果有的話)。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-224">The interpretation of this preference depends on the logic, if any, that you script into your back jobs for each of the databases in a given availability group.</span></span> <span data-ttu-id="8cbfc-225">對於各個可用性複本，您可以指定此複本與同一個可用性群組中之其他複本的備份優先權。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-225">For an individual availability replica, you can specify your priority for performing backups on this replica relative to the other replicas in the same availability group.</span></span> <span data-ttu-id="8cbfc-226">如需詳細資訊，請參閱[使用中次要：在次要複本上備份 &#40;AlwaysOn 可用性群組&#41;](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md)。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-226">For more information, see [Active Secondaries: Backup on Secondary Replicas &#40;AlwaysOn Availability Groups&#41;](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md).</span></span>

-   <span data-ttu-id="8cbfc-227">**對一個或多個次要複本進行唯讀存取 (可讀取的次要複本)**</span><span class="sxs-lookup"><span data-stu-id="8cbfc-227">**Read-only access to one or more secondary replicas (readable secondary replicas)**</span></span>

     <span data-ttu-id="8cbfc-228">以次要角色執行時，您可以將任何可用性複本設定為允許對其本機資料庫進行唯讀存取，但有一些作業則不一定受到支援。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-228">Any availability replica can be configured to allow read-only access to its local databases when performing the secondary role, though some operations are not fully supported.</span></span> <span data-ttu-id="8cbfc-229">此外，若要避免在主要複本上執行唯讀工作負載，可以在以主要角色執行時，將複本設定為僅允許讀寫存取。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-229">Also, if you would like to prevent read-only workloads from running on the primary replica, you can configure the replicas to allow only read-write access when running under the primary role.</span></span> <span data-ttu-id="8cbfc-230">如需詳細資訊，請參閱[使用中次要：在次要複本上備份 &#40;AlwaysOn 可用性群組&#41;](active-secondaries-readable-secondary-replicas-always-on-availability-groups.md)。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-230">For more information, see [Active Secondaries: Readable Secondary Replicas &#40;AlwaysOn Availability Groups&#41;](active-secondaries-readable-secondary-replicas-always-on-availability-groups.md).</span></span>

     <span data-ttu-id="8cbfc-231">若可用性群組目前擁有可用性群組接聽程式及一或多個可讀取的次要複本，[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 會將讀取意圖的連接要求路由至其中一個複本 (「唯讀路由」  )。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-231">If an availability group currently possesses an availability group listener and one or more readable secondary replicas, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can route read-intent connection requests to one of them (*read-only routing*).</span></span> <span data-ttu-id="8cbfc-232">如需詳細資訊，請參閱[可用性群組接聽程式、用戶端連接性及應用程式容錯移轉 &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md)。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-232">For more information, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>

##  <a name="session-timeout-period"></a><a name="SessionTimeoutPerios"></a><span data-ttu-id="8cbfc-233">會話-超時時間</span><span class="sxs-lookup"><span data-stu-id="8cbfc-233">Session-Timeout Period</span></span>
 <span data-ttu-id="8cbfc-234">工作階段逾時期限是可用性複本屬性，它決定在連接關閉之前，與另一個可用性複本的連接保持非使用中的時間。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-234">The session-timeout period is an availability-replica property that determines how long connection with another availability replica can remain inactive before the connection is closed.</span></span> <span data-ttu-id="8cbfc-235">主要與次要複本會彼此 Ping，表示它們仍在使用中。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-235">The primary and secondary replicas ping each other to signal that they are still active.</span></span> <span data-ttu-id="8cbfc-236">在逾時期限內從另一個複本接收到 Ping，表示連接仍為開啟狀態，且伺服器執行個體正在進行通訊。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-236">Receiving a ping from the other replica during the timeout period indicates that the connection is still open and that the server instances are communicating.</span></span> <span data-ttu-id="8cbfc-237">接收到 Ping 時，可用性複本會重設它在該連接上的工作階段逾時計數器。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-237">On receiving a ping, an availability replica resets its session-timeout counter on that connection.</span></span>

 <span data-ttu-id="8cbfc-238">工作階段逾時期限防止複本無限期地等候從另一個複本接收 Ping。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-238">The session-timeout period prevents either replica from waiting indefinitely to receive a ping from the other replica.</span></span> <span data-ttu-id="8cbfc-239">如果在工作階段逾時期限內未收到另一個複本的 Ping，則複本會逾時。它的連接會關閉，而逾時的複本則進入 DISCONNECTED 狀態。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-239">If no ping is received from the other replica within the session-timeout period, the replica times out. Its connection is closed, and the timed-out replica enters the DISCONNECTED state.</span></span> <span data-ttu-id="8cbfc-240">即使中斷連接的複本設定成同步認可模式，交易仍不會等候該複本重新連接及重新同步處理。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-240">Even if a disconnected replica is configured for synchronous-commit mode, transactions will not wait for that replica to reconnect and resynchronize.</span></span>

 <span data-ttu-id="8cbfc-241">每個可用性複本的預設工作階段逾時期限為 10 秒。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-241">The default session-timeout period for each availability replica is 10 seconds.</span></span> <span data-ttu-id="8cbfc-242">此值是使用者可設定的，最小值為 5 秒。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-242">This value is user-configurable, with a minimum of 5 seconds.</span></span> <span data-ttu-id="8cbfc-243">通常我們建議您讓逾時期限保持在 10 秒或更久。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-243">Generally, we recommend that you keep the time-out period at 10 seconds or greater.</span></span> <span data-ttu-id="8cbfc-244">將這個值設定為小於 10 秒，可能會使負荷重的系統宣告假性失敗。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-244">Setting the value to less than 10 seconds creates the possibility of a heavily loaded system declaring a false failure.</span></span>

> [!NOTE]
>  <span data-ttu-id="8cbfc-245">在解析角色中，工作階段逾時期限不適用，因為不會發生 Ping。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-245">In the resolving role, the session-timeout period does not apply because pinging does not occur.</span></span>

##  <a name="automatic-page-repair"></a><a name="APR"></a><span data-ttu-id="8cbfc-246">自動修復頁面</span><span class="sxs-lookup"><span data-stu-id="8cbfc-246">Automatic Page Repair</span></span>
 <span data-ttu-id="8cbfc-247">每個可用性複本都會嘗試解決阻止讀取資料頁面的特定類型錯誤，以便從本機資料庫上的損毀頁面自動復原。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-247">Each availability replica tries to automatically recover from corrupted pages on a local database by resolving certain types of errors that prevent reading a data page.</span></span> <span data-ttu-id="8cbfc-248">如果次要複本無法讀取某個頁面，此複本會向主要複本要求一個全新頁面副本。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-248">If a secondary replica cannot read a page, the replica requests a fresh copy of the page from the primary replica.</span></span> <span data-ttu-id="8cbfc-249">如果主要複本無法讀取某個頁面，此複本會向所有次要複本廣播全新副本的要求，並先取得頁面以回應。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-249">If the primary replica cannot read a page, the replica broadcasts a request for a fresh copy to all the secondary replicas and gets the page from the first to respond.</span></span> <span data-ttu-id="8cbfc-250">如果這個要求成功，無法讀取的頁面就會使用副本取代，這通常會解決錯誤。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-250">If this request succeeds, the unreadable page is replaced by the copy, which usually resolves the error.</span></span>

 <span data-ttu-id="8cbfc-251">如需詳細資訊，請參閱[自動修復頁面 &#40;適用於可用性群組和資料庫鏡像&#41;](../../../sql-server/failover-clusters/automatic-page-repair-availability-groups-database-mirroring.md)。</span><span class="sxs-lookup"><span data-stu-id="8cbfc-251">For more information, see [Automatic Page Repair &#40;For Availability Groups and Database Mirroring&#41;](../../../sql-server/failover-clusters/automatic-page-repair-availability-groups-database-mirroring.md).</span></span>

##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="8cbfc-252">相關工作</span><span class="sxs-lookup"><span data-stu-id="8cbfc-252">Related Tasks</span></span>

-   [<span data-ttu-id="8cbfc-253">具有 AlwaysOn 可用性群組 &#40;SQL Server 的消費者入門&#41;</span><span class="sxs-lookup"><span data-stu-id="8cbfc-253">Getting Started with AlwaysOn Availability Groups &#40;SQL Server&#41;</span></span>](getting-started-with-always-on-availability-groups-sql-server.md)

##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="8cbfc-254">相關內容</span><span class="sxs-lookup"><span data-stu-id="8cbfc-254">Related Content</span></span>

-   <span data-ttu-id="8cbfc-255">**部落格：**</span><span class="sxs-lookup"><span data-stu-id="8cbfc-255">**Blogs:**</span></span>

     [<span data-ttu-id="8cbfc-256">AlwaysON - HADRON 學習系列：具備 HADRON 功能之資料庫的工作者集區使用方式</span><span class="sxs-lookup"><span data-stu-id="8cbfc-256">AlwaysON - HADRON Learning Series: Worker Pool Usage for HADRON Enabled Databases</span></span>](https://blogs.msdn.com/b/psssql/archive/2012/05/17/alwayson-hadron-learning-series-worker-pool-usage-for-hadron-enabled-databases.aspx)

     [<span data-ttu-id="8cbfc-257">SQL Server AlwaysOn 團隊部落格：官方 SQL Server AlwaysOn 團隊部落格</span><span class="sxs-lookup"><span data-stu-id="8cbfc-257">SQL Server AlwaysOn Team Blogs: The official SQL Server AlwaysOn Team Blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)

     [<span data-ttu-id="8cbfc-258">CSS SQL Server 工程師部落格</span><span class="sxs-lookup"><span data-stu-id="8cbfc-258">CSS SQL Server Engineers Blogs</span></span>](https://blogs.msdn.com/b/psssql/)

-   <span data-ttu-id="8cbfc-259">**影片：**</span><span class="sxs-lookup"><span data-stu-id="8cbfc-259">**Videos:**</span></span>

     [<span data-ttu-id="8cbfc-260">Microsoft SQL Server Code-Named "Denali" AlwaysOn 系列，第 1 部：新一代高可用性解決方案簡介</span><span class="sxs-lookup"><span data-stu-id="8cbfc-260">Microsoft SQL Server Code-Named "Denali" AlwaysOn Series,Part 1: Introducing the Next Generation High Availability Solution</span></span>](https://channel9.msdn.com/Events/TechEd/NorthAmerica/2011/DBI302)

     [<span data-ttu-id="8cbfc-261">Microsoft SQL Server Code-Named "Denali" AlwaysOn 系列，第 2 部：使用 AlwaysOn 建立關鍵任務的高可用性方案</span><span class="sxs-lookup"><span data-stu-id="8cbfc-261">Microsoft SQL Server Code-Named "Denali" AlwaysOn Series,Part 2: Building a Mission-Critical High Availability Solution Using AlwaysOn</span></span>](https://channel9.msdn.com/Events/TechEd/NorthAmerica/2011/DBI404)

-   <span data-ttu-id="8cbfc-262">**白皮書：**</span><span class="sxs-lookup"><span data-stu-id="8cbfc-262">**Whitepapers:**</span></span>

     [<span data-ttu-id="8cbfc-263">Microsoft SQL Server AlwaysOn 高可用性和災害復原方案指南</span><span class="sxs-lookup"><span data-stu-id="8cbfc-263">Microsoft SQL Server AlwaysOn Solutions Guide for High Availability and Disaster Recovery</span></span>](https://go.microsoft.com/fwlink/?LinkId=227600)

     [<span data-ttu-id="8cbfc-264">Microsoft 的 SQL Server 2012 白皮書</span><span class="sxs-lookup"><span data-stu-id="8cbfc-264">Microsoft White Papers for SQL Server 2012</span></span>](https://msdn.microsoft.com/library/hh403491.aspx)

     [<span data-ttu-id="8cbfc-265">SQL Server 客戶諮詢團隊白皮書</span><span class="sxs-lookup"><span data-stu-id="8cbfc-265">SQL Server Customer Advisory Team Whitepapers</span></span>](http://sqlcat.com/)

## <a name="see-also"></a><span data-ttu-id="8cbfc-266">另請參閱</span><span class="sxs-lookup"><span data-stu-id="8cbfc-266">See Also</span></span>
 <span data-ttu-id="8cbfc-267">[可用性模式 &#40;AlwaysOn 可用性群組&#41;](availability-modes-always-on-availability-groups.md) [容錯移轉和容錯移轉模式 &#40;AlwaysOn 可用性群組](failover-and-failover-modes-always-on-availability-groups.md)&#41;AlwaysOn 可用性群組的[transact-sql 語句](transact-sql-statements-for-always-on-availability-groups.md)&#40;總覽 SQL Server&#41;的[PowerShell Cmdlet](overview-of-powershell-cmdlets-for-always-on-availability-groups-sql-server.md) AlwaysOn 可用性群組 &#40;[記憶體內部 OLTP 資料庫的高可用性支援](../../../relational-databases/in-memory-oltp/high-availability-support-for-in-memory-oltp-databases.md)[必要條件，AlwaysOn 可用性群組的限制和建議 &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md) [建立和設定可用性群組 &#40;](creation-and-configuration-of-availability-groups-sql-server.md) SQL Server&#41;作用中[次要複本：可讀取的次要複本 &#40;](active-secondaries-readable-secondary-replicas-always-on-availability-groups.md) AlwaysOn 可用性群組使用[中次要資料庫：在次要複本上備份&#41;&#40;](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md) [可用性群組接聽程式、用戶端連線能力，以及應用程式容錯移轉 AlwaysOn 可用性群組&#41;](../../listeners-client-connectivity-application-failover.md) &#40;</span><span class="sxs-lookup"><span data-stu-id="8cbfc-267">[Availability Modes &#40;AlwaysOn Availability Groups&#41;](availability-modes-always-on-availability-groups.md) [Failover and Failover Modes &#40;AlwaysOn Availability Groups&#41;](failover-and-failover-modes-always-on-availability-groups.md) [Overview of Transact-SQL Statements for AlwaysOn Availability Groups &#40;SQL Server&#41;](transact-sql-statements-for-always-on-availability-groups.md) [Overview of PowerShell Cmdlets for AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-powershell-cmdlets-for-always-on-availability-groups-sql-server.md) [High Availability Support for In-Memory OLTP databases](../../../relational-databases/in-memory-oltp/high-availability-support-for-in-memory-oltp-databases.md) [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md) [Creation and Configuration of Availability Groups &#40;SQL Server&#41;](creation-and-configuration-of-availability-groups-sql-server.md) [Active Secondaries: Readable Secondary Replicas &#40;AlwaysOn Availability Groups&#41;](active-secondaries-readable-secondary-replicas-always-on-availability-groups.md) [Active Secondaries: Backup on Secondary Replicas &#40;AlwaysOn Availability Groups&#41;](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md) [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md)</span></span>

