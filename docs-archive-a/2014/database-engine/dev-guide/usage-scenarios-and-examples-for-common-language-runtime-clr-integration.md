---
title: Common Language Runtime (CLR) 整合的使用案例和範例 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: reference
helpviewer_keywords:
- scenarios [CLR integration]
- common language runtime [SQL Server], samples
- examples [CLR integration]
- sample applications [CLR integration]
- database objects [CLR integration], samples
- managed code [SQL Server], samples
ms.assetid: 33aac25f-abb4-4f29-af88-4a0dacd80ae7
author: mashamsft
ms.author: mathoma
ms.openlocfilehash: 30a54064d398ec6db09a9ccd54eed9411a7f905a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87701686"
---
# <a name="usage-scenarios-and-examples-for-common-language-runtime-clr-integration"></a><span data-ttu-id="239b4-102">Common Language Runtime (CLR) 整合的使用案例和範例</span><span class="sxs-lookup"><span data-stu-id="239b4-102">Usage Scenarios and Examples for Common Language Runtime (CLR) Integration</span></span>
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="239b4-103">包括範例應用程式、封裝範例和許多編碼範例，可用於了解 Common Language Runtime (CLR) 整合的可程式性功能。</span><span class="sxs-lookup"><span data-stu-id="239b4-103">includes sample applications, package samples, and numerous coding samples that you can use to learn about the programmability features of common language runtime (CLR) integration.</span></span>  
  
 <span data-ttu-id="239b4-104">如需執行這些範例和其他材料的完整 Visual Studio 專案，請流覽[Microsoft SQL Server 的社區專案 & CodePlex 上的範例](https://go.microsoft.com/fwlink/?LinkID=193935)。</span><span class="sxs-lookup"><span data-stu-id="239b4-104">For complete Visual Studio projects implementing these samples and additional materials, visit [Microsoft SQL Server Community Projects & Samples on CodePlex](https://go.microsoft.com/fwlink/?LinkID=193935).</span></span>  
  
|<span data-ttu-id="239b4-105">名稱</span><span class="sxs-lookup"><span data-stu-id="239b4-105">Name</span></span>|<span data-ttu-id="239b4-106">描述</span><span class="sxs-lookup"><span data-stu-id="239b4-106">Description</span></span>|  
|----------|-----------------|  
|[<span data-ttu-id="239b4-107">從 CLR UDF 存取機器碼</span><span class="sxs-lookup"><span data-stu-id="239b4-107">Accessing Native Code from a CLR UDF</span></span>](../../../2014/database-engine/dev-guide/accessing-native-code-from-a-clr-udf.md)|<span data-ttu-id="239b4-108">示範如何從資料庫內組件中的使用者定義函數來叫用原生 (Unmanaged) C++ 程式碼的函數。</span><span class="sxs-lookup"><span data-stu-id="239b4-108">Shows how to invoke a function in native (unmanaged) C++ code from a user-defined function in an assembly, in your database.</span></span>|  
|[<span data-ttu-id="239b4-109">陣列參數範例</span><span class="sxs-lookup"><span data-stu-id="239b4-109">Array Parameter Sample</span></span>](../../../2014/database-engine/dev-guide/array-parameter-sample.md)|<span data-ttu-id="239b4-110">示範如何將資訊的陣列從用戶端傳遞至伺服器上的 CLR 整合預存程序，以便在資料庫中建立、更新或刪除資料列集。</span><span class="sxs-lookup"><span data-stu-id="239b4-110">Demonstrates how to create, update, or delete a set of rows in a database by passing an array of information from a client to a CLR integration stored procedure on the server.</span></span> <span data-ttu-id="239b4-111">這項作業是使用 UDT 來完成。</span><span class="sxs-lookup"><span data-stu-id="239b4-111">This is done using a UDT.</span></span>|  
|[<span data-ttu-id="239b4-112">行事曆感知日期和時間 UDT 範例</span><span class="sxs-lookup"><span data-stu-id="239b4-112">Calendar-Aware Date and Time UDT Sample</span></span>](../../../2014/database-engine/dev-guide/calendar-aware-date-and-time-udt-sample.md)|<span data-ttu-id="239b4-113">定義兩種 UDT，它們提供處理日期和時間的行事曆認知能力。</span><span class="sxs-lookup"><span data-stu-id="239b4-113">Defines two UDTs that provide calendar-aware handling of dates and times.</span></span>|  
|[<span data-ttu-id="239b4-114">CLR 交易範例</span><span class="sxs-lookup"><span data-stu-id="239b4-114">CLR Transactions Sample</span></span>](../../../2014/database-engine/dev-guide/clr-transactions-sample.md)|<span data-ttu-id="239b4-115">示範使用位於 System.Transactions 命名空間內的 Managed API 控制交易。</span><span class="sxs-lookup"><span data-stu-id="239b4-115">Demonstrates controlling transactions by using the managed APIs located in the System.Transactions namespace.</span></span>|  
|[<span data-ttu-id="239b4-116">使用 CLR 及 XML 建立連絡人</span><span class="sxs-lookup"><span data-stu-id="239b4-116">Contact Creation using CLR and XML</span></span>](../../../2014/database-engine/dev-guide/contact-creation-using-clr-and-xml.md)|<span data-ttu-id="239b4-117">SQL Server 的「連絡人」範例提供了一些有用的公用程式，以構成基底 AdventureWorks2012 範例資料庫最上層的額外功能層。</span><span class="sxs-lookup"><span data-stu-id="239b4-117">The Contact sample for SQL Server provides some useful utilities that form an extra layer of functionality on top of the base AdventureWorks2012 sample database.</span></span> <span data-ttu-id="239b4-118">第一個公用程式會建立 AdventureWorks2012 資料庫所含各類人員的連絡記錄。</span><span class="sxs-lookup"><span data-stu-id="239b4-118">The first utility creates contact records for various types of people involved in the AdventureWorks2012 database.</span></span> <span data-ttu-id="239b4-119">連絡資訊是使用 XML 來指定並傳遞至以 C# 為基礎或 VB 預存程序，以便建立 XML 並將它放入包含此資料庫的正確資料表中。</span><span class="sxs-lookup"><span data-stu-id="239b4-119">The contact information is specified by using XML and is passed to a C#-based or VB stored procedure to create the XML and place it in the proper tables with the database.</span></span>|  
|[<span data-ttu-id="239b4-120">Currency 類型及轉換函數</span><span class="sxs-lookup"><span data-stu-id="239b4-120">Currency Type and Conversion Function</span></span>](../../../2014/database-engine/dev-guide/currency-type-and-conversion-function.md)|<span data-ttu-id="239b4-121">使用 C# 語言定義 Currency 使用者定義資料類型。</span><span class="sxs-lookup"><span data-stu-id="239b4-121">Defines a Currency user-defined data type using C#.</span></span>|  
|[<span data-ttu-id="239b4-122">使用 CLR 處理大型物件</span><span class="sxs-lookup"><span data-stu-id="239b4-122">Handling Large Objects Using CLR</span></span>](../../../2014/database-engine/dev-guide/handling-large-objects-using-clr.md)|<span data-ttu-id="239b4-123">示範在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 和檔案系統 (伺服器可使用 CLR 預存程序進行存取) 之間傳送大型二進位物件 (LOB)。</span><span class="sxs-lookup"><span data-stu-id="239b4-123">Demonstrates transferring large binary objects (LOBs) between [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and a file system accessible to the server using CLR stored procedures.</span></span>|  
|[<span data-ttu-id="239b4-124">Hello World Ready 範例</span><span class="sxs-lookup"><span data-stu-id="239b4-124">Hello World Ready Sample</span></span>](../../../2014/database-engine/dev-guide/hello-world-ready-sample.md)|<span data-ttu-id="239b4-125">示範建立、部署和測試以簡單 World Ready CLR 整合為基礎之預存程序的基本作業。</span><span class="sxs-lookup"><span data-stu-id="239b4-125">Demonstrates the basic operations to create, deploy, and test a simple world ready CLR integration-based stored procedure.</span></span>|  
|[<span data-ttu-id="239b4-126">Hello World 範例</span><span class="sxs-lookup"><span data-stu-id="239b4-126">Hello World Sample</span></span>](../../../2014/database-engine/dev-guide/hello-world-sample.md)|<span data-ttu-id="239b4-127">示範建立、部署和測試以簡單 CLR 整合為基礎之預存程序的基本作業。</span><span class="sxs-lookup"><span data-stu-id="239b4-127">Demonstrates the basic operations to create, deploy, and test a simple CLR integration-based stored procedure.</span></span>|  
|[<span data-ttu-id="239b4-128">同處理序資料存取範例</span><span class="sxs-lookup"><span data-stu-id="239b4-128">In-Process Data Access Sample</span></span>](../../../2014/database-engine/dev-guide/in-process-data-access-sample.md)|<span data-ttu-id="239b4-129">包含示範 CLR 同處理序資料存取提供者之各種功能的數個簡單函數。</span><span class="sxs-lookup"><span data-stu-id="239b4-129">Contains a number of simple functions demonstrating various features of the CLR in-process data access provider.</span></span>|  
|[<span data-ttu-id="239b4-130">結果集範例</span><span class="sxs-lookup"><span data-stu-id="239b4-130">Result Set Sample</span></span>](../../../2014/database-engine/dev-guide/result-set-sample.md)|<span data-ttu-id="239b4-131">示範如何在閱讀查詢結果時執行命令，而不必開啟新連接也不將所有結果讀取到記憶體中。</span><span class="sxs-lookup"><span data-stu-id="239b4-131">Demonstrates how to execute commands while reading through results of a query, without opening a new connection and without reading all results into memory.</span></span>|  
|[<span data-ttu-id="239b4-132">傳送資料集範例</span><span class="sxs-lookup"><span data-stu-id="239b4-132">Send DataSet Sample</span></span>](../../../2014/database-engine/dev-guide/send-dataset-sample.md)|<span data-ttu-id="239b4-133">示範如何在伺服器端以 CLR 為基礎的預存程序內傳回以 ADO.NET 為基礎的資料集，做為用戶端的結果集。</span><span class="sxs-lookup"><span data-stu-id="239b4-133">Demonstrates how to return an ADO.NET based DataSet within a server side CLR-based stored procedure as a result set to the client.</span></span>|  
|[<span data-ttu-id="239b4-134">字串公用程式函數範例</span><span class="sxs-lookup"><span data-stu-id="239b4-134">String Utility Functions Sample</span></span>](../../../2014/database-engine/dev-guide/string-utility-functions-sample.md)|<span data-ttu-id="239b4-135">包含資料流資料表值函式 (TVF)，以 C# 與 Visual Basic 撰寫，將逗號分隔的字串分割成包含一個資料行的資料表。</span><span class="sxs-lookup"><span data-stu-id="239b4-135">Contains a streaming table-valued function (TVF), written in Visual C# and Visual Basic, which splits a comma-separated string into a table with one column.</span></span>|  
|[<span data-ttu-id="239b4-136">增補感知的字串操作範例</span><span class="sxs-lookup"><span data-stu-id="239b4-136">Supplementary-Aware String Manipulation Sample</span></span>](../../../2014/database-engine/dev-guide/supplementary-aware-string-manipulation-sample.md)|<span data-ttu-id="239b4-137">顯示可以同時處理 Unicode 和 Surrogate 字元字串的五個增補感知 [!INCLUDE[tsql](../../includes/tsql-md.md)] 字串函數的實作。</span><span class="sxs-lookup"><span data-stu-id="239b4-137">Shows the implementation of five supplementary-aware [!INCLUDE[tsql](../../includes/tsql-md.md)] string functions that can handle both Unicode and surrogate strings.</span></span>|  
|[<span data-ttu-id="239b4-138">UDT 公用程式</span><span class="sxs-lookup"><span data-stu-id="239b4-138">UDT Utilities</span></span>](../../../2014/database-engine/dev-guide/udt-utilities.md)|<span data-ttu-id="239b4-139">包含數個使用者定義資料類型 (UDT) 公用程式函數。</span><span class="sxs-lookup"><span data-stu-id="239b4-139">Contains a number of user-defined data type (UDT) utility functions.</span></span>|  
|[<span data-ttu-id="239b4-140">未使用的組件清除</span><span class="sxs-lookup"><span data-stu-id="239b4-140">Unused Assembly Cleanup</span></span>](../../../2014/database-engine/dev-guide/unused-assembly-cleanup.md)|<span data-ttu-id="239b4-141">包含 .NET 預存程序，該預存程序會查詢中繼資料目錄，藉以在目前的資料庫中刪除未使用的組件。</span><span class="sxs-lookup"><span data-stu-id="239b4-141">Contains a .NET stored procedure that deletes unused assemblies in the current database by querying the metadata catalogs.</span></span>|  
|[<span data-ttu-id="239b4-142">使用者定義型別</span><span class="sxs-lookup"><span data-stu-id="239b4-142">User Defined Type</span></span>](../../../2014/database-engine/dev-guide/user-defined-type.md)|<span data-ttu-id="239b4-143">顯示從 [!INCLUDE[tsql](../../includes/tsql-md.md)] 和使用 System.Data.SqlClient 的用戶端應用程式建立及使用簡單的 UDT。</span><span class="sxs-lookup"><span data-stu-id="239b4-143">Shows the creation and use of a simple UDT from both [!INCLUDE[tsql](../../includes/tsql-md.md)] and a client application using System.Data.SqlClient.</span></span>|  
|[<span data-ttu-id="239b4-144">UTF8 字串使用者自訂資料類型 &#40;UDT&#41;</span><span class="sxs-lookup"><span data-stu-id="239b4-144">UTF8 String User-Defined Data Type &#40;UDT&#41;</span></span>](../../../2014/database-engine/dev-guide/utf8-string-user-defined-data-type-udt.md)|<span data-ttu-id="239b4-145">示範 UDT 的實作，即擴充資料庫的類型系統來為 UTF8 編碼值提供儲存體。</span><span class="sxs-lookup"><span data-stu-id="239b4-145">Demonstrates the implementation of a UDT that extends the type system of the database to provide storage for UTF8 encoded values.</span></span>|  
  
  
