---
title: 將 SQL Server 與 SMB Fileshare 作為儲存選項一起安裝 | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: install
ms.topic: conceptual
ms.assetid: 8b7810b2-637e-46a3-9fe1-d055898ba639
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 3d59c2861e2419d76d3dc8e3fc3aaab91bf1e99b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87688161"
---
# <a name="install-sql-server-with-smb-fileshare-as-a-storage-option"></a><span data-ttu-id="6af81-102">將 SQL Server 與 SMB Fileshare 當做儲存選項一起安裝</span><span class="sxs-lookup"><span data-stu-id="6af81-102">Install SQL Server with SMB Fileshare as a Storage Option</span></span>
  <span data-ttu-id="6af81-103">從 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] 開始，系統資料庫 (Master、Model、MSDB 和 TempDB) 與 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 使用者資料庫可以當做儲存選項與伺服器訊息區塊 (SMB) 檔案伺服器一起安裝。</span><span class="sxs-lookup"><span data-stu-id="6af81-103">Starting [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], system databases (Master, Model, MSDB, and TempDB), and [!INCLUDE[ssDE](../../includes/ssde-md.md)] user databases can be installed with Server Message Block (SMB) file server as a storage option.</span></span> <span data-ttu-id="6af81-104">這同時適用於 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 獨立安裝和 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 容錯移轉叢集安裝 (FCI)。</span><span class="sxs-lookup"><span data-stu-id="6af81-104">This applies to both [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] stand-alone and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] failover cluster installations (FCI).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6af81-105">SMB 檔案共用目前不支援檔案資料流。</span><span class="sxs-lookup"><span data-stu-id="6af81-105">Filestream is currently not supported on an SMB file share.</span></span>  
  
## <a name="installation-considerations"></a><span data-ttu-id="6af81-106">安裝考量</span><span class="sxs-lookup"><span data-stu-id="6af81-106">Installation Considerations</span></span>  
  
### <a name="smb-file-share-formats"></a><span data-ttu-id="6af81-107">SMB 檔案共用格式：</span><span class="sxs-lookup"><span data-stu-id="6af81-107">SMB File share Formats:</span></span>  
 <span data-ttu-id="6af81-108">指定 SMB 檔案共用時，支援獨立和 FCI 資料庫的通用命名慣例 (UNC) 路徑格式如下：</span><span class="sxs-lookup"><span data-stu-id="6af81-108">While specifying the SMB file share, the following are supported Universal Naming Convention (UNC) Path formats for standalone and FCI databases:</span></span>  
  
-   <span data-ttu-id="6af81-109">\\\ServerName\ShareName</span><span class="sxs-lookup"><span data-stu-id="6af81-109">\\\ServerName\ShareName</span></span>\  
  
-   <span data-ttu-id="6af81-110">\\\ServerName\ShareName</span><span class="sxs-lookup"><span data-stu-id="6af81-110">\\\ServerName\ShareName</span></span>  
  
 <span data-ttu-id="6af81-111">如需通用命名慣例的詳細資訊，請參閱[UNC](https://go.microsoft.com/fwlink/?LinkId=245534) (https://go.microsoft.com/fwlink/?LinkId=245534) 。</span><span class="sxs-lookup"><span data-stu-id="6af81-111">For more information about Universal Naming Convention, see [UNC](https://go.microsoft.com/fwlink/?LinkId=245534) (https://go.microsoft.com/fwlink/?LinkId=245534).</span></span>  
  
 <span data-ttu-id="6af81-112">不建議使用回送 UNC 路徑 (伺服器名稱為 localhost (127.0.0.1) 的 UNC 路徑，或是本機電腦名稱)。</span><span class="sxs-lookup"><span data-stu-id="6af81-112">The loopback UNC path (a UNC path whose server name is localhost, 127.0.0.1, or the local machine name) is not supported.</span></span> <span data-ttu-id="6af81-113">使用檔案伺服器叢集的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] (裝載於 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行的相同節點上) 也不受支援，這是特殊案例。</span><span class="sxs-lookup"><span data-stu-id="6af81-113">As a special case, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] using File Server Cluster which is hosted on the same node [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is running is also not supported.</span></span> <span data-ttu-id="6af81-114">為了避免這個狀況發生，建議將 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 和檔案伺服器叢集建立在不同的 Windows 叢集上。</span><span class="sxs-lookup"><span data-stu-id="6af81-114">To prevent this situation, it is recommended that [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and File Server Cluster to be created on separated Windows Clusters.</span></span>  
  
 <span data-ttu-id="6af81-115">底下的 UNC 路徑格式不受支援：</span><span class="sxs-lookup"><span data-stu-id="6af81-115">The below UNC path formats are not supported:</span></span>  
  
-   <span data-ttu-id="6af81-116">迴路路徑，例如 \\\localhost\\..\ 或 \\\127.0.0.1\\...</span><span class="sxs-lookup"><span data-stu-id="6af81-116">Loopback path, e.g., \\\localhost\\..\ or \\\127.0.0.1\\...</span></span>\  
  
-   <span data-ttu-id="6af81-117">管理共用，例如 \\\servername\x$</span><span class="sxs-lookup"><span data-stu-id="6af81-117">Administrative shares, e.g., \\\servername\x$</span></span>  
  
-   <span data-ttu-id="6af81-118">其他 UNC 路徑格式，例如 \\\\?\x:</span><span class="sxs-lookup"><span data-stu-id="6af81-118">Other UNC path formats like \\\\?\x:</span></span>\  
  
-   <span data-ttu-id="6af81-119">對應的網路磁碟機。</span><span class="sxs-lookup"><span data-stu-id="6af81-119">Mapped network drives.</span></span>  
  
### <a name="supported-data-definition-language-ddl-statements"></a><span data-ttu-id="6af81-120">支援的資料定義語言 (DDL) 陳述式</span><span class="sxs-lookup"><span data-stu-id="6af81-120">Supported Data Definition Language (DDL) statements</span></span>  
 <span data-ttu-id="6af81-121">以下的 [!INCLUDE[tsql](../../includes/tsql-md.md)] DDL 陳述式和 Database Engine 預存程序支援 SMB 檔案共用：</span><span class="sxs-lookup"><span data-stu-id="6af81-121">The following [!INCLUDE[tsql](../../includes/tsql-md.md)] DDL statements and database engine stored procedures support SMB file shares:</span></span>  
  
1.  [<span data-ttu-id="6af81-122">CREATE DATABASE &#40;SQL Server Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="6af81-122">CREATE DATABASE &#40;SQL Server Transact-SQL&#41;</span></span>](/sql/t-sql/statements/create-database-sql-server-transact-sql)  
  
2.  [<span data-ttu-id="6af81-123">ALTER DATABASE &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="6af81-123">ALTER DATABASE &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-database-transact-sql)  
  
3.  [<span data-ttu-id="6af81-124">RESTORE &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="6af81-124">RESTORE &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/restore-statements-transact-sql)  
  
4.  [<span data-ttu-id="6af81-125">BACKUP &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="6af81-125">BACKUP &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/backup-transact-sql)  
  
5.  [<span data-ttu-id="6af81-126">sp_attach_db &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="6af81-126">sp_attach_db &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-attach-db-transact-sql)  
  
6.  [<span data-ttu-id="6af81-127">sp_attach_single_file_db &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="6af81-127">sp_attach_single_file_db &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-attach-single-file-db-transact-sql)  
  
### <a name="installation-options"></a><span data-ttu-id="6af81-128">安裝選項</span><span class="sxs-lookup"><span data-stu-id="6af81-128">Installation options</span></span>  
  
-   <span data-ttu-id="6af81-129">在安裝程式 UI [資料庫引擎設定] 頁面的 [資料目錄] 索引標籤中，將 [資料根目錄] 參數設定為 "\\\fileserver1\share1\"。</span><span class="sxs-lookup"><span data-stu-id="6af81-129">In setup UI "Database Engine Configuration" page, "Data Directories" tab, set the parameter "Data root directory as "\\\fileserver1\share1\".</span></span>  
  
-   <span data-ttu-id="6af81-130">在命令提示字元安裝中，將 "/INSTALLSQLDATADIR" 指定為 "\\\fileserver1\share1\"。</span><span class="sxs-lookup"><span data-stu-id="6af81-130">In command prompt installation, specify the "/INSTALLSQLDATADIR" as "\\\fileserver1\share1\".</span></span>  
  
     <span data-ttu-id="6af81-131">以下是使用 SMB 檔案共用選項在獨立伺服器上安裝 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的範例語法：</span><span class="sxs-lookup"><span data-stu-id="6af81-131">Here is the sample syntax to install [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] on a Standalone server using SMB file share option:</span></span>  
  
    ```  
    Setup.exe /q /ACTION=Install /FEATURES=SQL /INSTANCENAME=MSSQLSERVER /SQLSVCACCOUNT="<DomainName\UserName>" /SQLSVCPASSWORD="<StrongPassword>" /SQLSYSADMINACCOUNTS="<DomainName\UserName>" /AGTSVCACCOUNT="<DomainName\UserName>" /AGTSVCPASSWORD="<StrongPassword>" /INSTALLSQLDATADIR="\\FileServer\Share1\" /IACCEPTSQLSERVERLICENSETERMS  
    ```  
  
     <span data-ttu-id="6af81-132">安裝具有 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 和 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 等預設執行個體的單一節點 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]容錯移轉叢集執行個體：</span><span class="sxs-lookup"><span data-stu-id="6af81-132">To install a single-node [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] failover cluster instance with the [!INCLUDE[ssDE](../../includes/ssde-md.md)] and [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], default instance:</span></span>  
  
    ```  
    setup.exe /q /ACTION=InstallFailoverCluster /InstanceName=MSSQLSERVER /INDICATEPROGRESS /ASSYSADMINACCOUNTS="<DomainName\UserName>" /ASDATADIR=<Drive>:\OLAP\Data /ASLOGDIR=<Drive>:\OLAP\Log /ASBACKUPDIR=<Drive>:\OLAP\Backup /ASCONFIGDIR=<Drive>:\OLAP\Config /ASTEMPDIR=<Drive>:\OLAP\Temp /FAILOVERCLUSTERDISKS="<Cluster Disk Resource Name - for example, 'Disk S:'" /FAILOVERCLUSTERNETWORKNAME="<Insert Network Name>" /FAILOVERCLUSTERIPADDRESSES="IPv4;xx.xxx.xx.xx;Cluster Network;xxx.xxx.xxx.x" /FAILOVERCLUSTERGROUP="MSSQLSERVER" /Features=AS,SQL /ASSVCACCOUNT="<DomainName\UserName>" /ASSVCPASSWORD="xxxxxxxxxxx" /AGTSVCACCOUNT="<DomainName\UserName>" /AGTSVCPASSWORD="xxxxxxxxxxx" /INSTALLSQLDATADIR="\\FileServer\Share1\" /SQLCOLLATION="SQL_Latin1_General_CP1_CS_AS" /SQLSVCACCOUNT="<DomainName\UserName>" /SQLSVCPASSWORD="xxxxxxxxxxx" /SQLSYSADMINACCOUNTS="<DomainName\UserName> /IACCEPTSQLSERVERLICENSETERMS  
    ```  
  
     <span data-ttu-id="6af81-133">如需在中使用各種命令列參數選項的詳細資訊 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] ，請參閱[從命令提示字元安裝 SQL Server 2014](../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md)。</span><span class="sxs-lookup"><span data-stu-id="6af81-133">For more information about the usage of various command line parameter options in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], see [Install SQL Server 2014 from the Command Prompt](../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md).</span></span>  
  
## <a name="operating-system-considerations-smb-protocol-vs-ssnoversion"></a><span data-ttu-id="6af81-134">作業系統考量 (SMB 通訊協定與 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)])</span><span class="sxs-lookup"><span data-stu-id="6af81-134">Operating System Considerations (SMB Protocol vs. [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)])</span></span>  
 <span data-ttu-id="6af81-135">不同的 Windows 作業系統有不同的 SMB 通訊協定版本，而且 SMB 通訊協定版本對於 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]而言是透明的。</span><span class="sxs-lookup"><span data-stu-id="6af81-135">Different Windows operating systems has different SMB protocol versions, and the SMB protocol version is transparent to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="6af81-136">您可以找到不同 SMB 通訊協定版本相對於 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]的優點。</span><span class="sxs-lookup"><span data-stu-id="6af81-136">You can find the benefits of different SMB protocol versions with respect to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span>  
  
|<span data-ttu-id="6af81-137">作業系統</span><span class="sxs-lookup"><span data-stu-id="6af81-137">Operating System</span></span>|<span data-ttu-id="6af81-138">SMB2 通訊協定版本</span><span class="sxs-lookup"><span data-stu-id="6af81-138">SMB2 protocol version</span></span>|<span data-ttu-id="6af81-139">對 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="6af81-139">Benefits to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span></span>|  
|----------------------|---------------------------|-------------------------------------------|  
|[!INCLUDE[firstref_longhorn](../../includes/firstref-longhorn-md.md)] <span data-ttu-id="6af81-140">SP 2</span><span class="sxs-lookup"><span data-stu-id="6af81-140">SP 2</span></span>|<span data-ttu-id="6af81-141">2.0</span><span class="sxs-lookup"><span data-stu-id="6af81-141">2.0</span></span>|<span data-ttu-id="6af81-142">相較於舊版 SMB，新版中已改良效能。</span><span class="sxs-lookup"><span data-stu-id="6af81-142">Improved performance over previous SMB versions.</span></span><br /><br /> <span data-ttu-id="6af81-143">持久性，有助於從暫時性網路問題復原。</span><span class="sxs-lookup"><span data-stu-id="6af81-143">Durability, which helps recover from temporary network glitches.</span></span>|  
|[!INCLUDE[winserver2008r2](../../includes/winserver2008r2-md.md)] <span data-ttu-id="6af81-144">SP 1，包括 Server Core</span><span class="sxs-lookup"><span data-stu-id="6af81-144">SP 1, including Server Core</span></span>|<span data-ttu-id="6af81-145">2.1</span><span class="sxs-lookup"><span data-stu-id="6af81-145">2.1</span></span>|<span data-ttu-id="6af81-146">支援大型 MTU，有助於大型資料傳送，例如 SQL 備份和還原。</span><span class="sxs-lookup"><span data-stu-id="6af81-146">Support for large MTU, which benefits large data transfers, such as SQL backup and restore.</span></span> <span data-ttu-id="6af81-147">此功能必須由使用者啟用。</span><span class="sxs-lookup"><span data-stu-id="6af81-147">This capability must be enabled by user.</span></span> <span data-ttu-id="6af81-148">如需如何啟用此功能的詳細資料，請參閱 [SMB 的新功能](https://go.microsoft.com/fwlink/?LinkID=237319) (https://go.microsoft.com/fwlink/?LinkID=237319) 。</span><span class="sxs-lookup"><span data-stu-id="6af81-148">For more details on how to enable this capability, see [What's New in SMB](https://go.microsoft.com/fwlink/?LinkID=237319) (https://go.microsoft.com/fwlink/?LinkID=237319).</span></span><br /><br /> <span data-ttu-id="6af81-149">大幅改良效能，特別是針對 SQL OLTP 樣式工作負載方面。</span><span class="sxs-lookup"><span data-stu-id="6af81-149">Significant performance improvements, specifically for SQL OLTP style workloads.</span></span> <span data-ttu-id="6af81-150">這些效能改良需要套用 Hotfix。</span><span class="sxs-lookup"><span data-stu-id="6af81-150">These performance improvements require applying a hotfix.</span></span> <span data-ttu-id="6af81-151">如需 Hotfix 的詳細資訊，請參閱[本文](https://go.microsoft.com/fwlink/?LinkId=237320) (https://go.microsoft.com/fwlink/?LinkId=237320) 。</span><span class="sxs-lookup"><span data-stu-id="6af81-151">For more information on the hotfix, see [this](https://go.microsoft.com/fwlink/?LinkId=237320) (https://go.microsoft.com/fwlink/?LinkId=237320).</span></span>|  
|[!INCLUDE[win8srv](../../includes/win8srv-md.md)]<span data-ttu-id="6af81-152">，包括 Server Core</span><span class="sxs-lookup"><span data-stu-id="6af81-152">, including Server Core</span></span>|<span data-ttu-id="6af81-153">3.0</span><span class="sxs-lookup"><span data-stu-id="6af81-153">3.0</span></span>|<span data-ttu-id="6af81-154">支援以透明方式容錯移轉檔案共用，不需任何停機時間，而且系統管理員也不需要介入檔案伺服器叢集組態的 SQL DBA 或檔案伺服器管理員。</span><span class="sxs-lookup"><span data-stu-id="6af81-154">Support for transparent failover of file shares providing zero downtime with no administrator intervention required for SQL DBA or file server administrator in file server cluster configurations.</span></span><br /><br /> <span data-ttu-id="6af81-155">支援同時使用多網路介面的 IO，並容忍網路介面失敗。</span><span class="sxs-lookup"><span data-stu-id="6af81-155">Support for IO using multiple network interfaces simultaneously, as well as tolerance to network interface failure.</span></span><br /><br /> <span data-ttu-id="6af81-156">支援具有 RDMA 功能的網路介面。</span><span class="sxs-lookup"><span data-stu-id="6af81-156">Support for network interfaces with RDMA capabilities.</span></span><br /><br /> <span data-ttu-id="6af81-157">如需這些功能和伺服器訊息區塊的詳細資訊，請參閱[伺服器訊息區塊概觀](https://go.microsoft.com/fwlink/?LinkId=253174) (https://go.microsoft.com/fwlink/?LinkId=253174) 。</span><span class="sxs-lookup"><span data-stu-id="6af81-157">For more information on these features and Server Message Block, see [Server Message Block overview](https://go.microsoft.com/fwlink/?LinkId=253174) (https://go.microsoft.com/fwlink/?LinkId=253174).</span></span><br /><br /> <span data-ttu-id="6af81-158">支援向外延展檔案伺服器 (SoFS) 的持續可用性。</span><span class="sxs-lookup"><span data-stu-id="6af81-158">Support for Scale Out File Server (SoFS) with continuous availability.</span></span>|  
|[!INCLUDE[win8srv](../../includes/win8srv-md.md)] <span data-ttu-id="6af81-159">R2，包括 Server Core</span><span class="sxs-lookup"><span data-stu-id="6af81-159">R2, including Server Core</span></span>|<span data-ttu-id="6af81-160">3.2</span><span class="sxs-lookup"><span data-stu-id="6af81-160">3.2</span></span>|<span data-ttu-id="6af81-161">支援以透明方式容錯移轉檔案共用，不需任何停機時間，而且系統管理員也不需要介入檔案伺服器叢集組態的 SQL DBA 或檔案伺服器管理員。</span><span class="sxs-lookup"><span data-stu-id="6af81-161">Support for transparent failover of file shares providing zero downtime with no administrator intervention required for SQL DBA or file server administrator in file server cluster configurations.</span></span><br /><br /> <span data-ttu-id="6af81-162">利用 SMB Multichannel，支援同時使用多網路介面的 IO，並容忍網路介面失敗。</span><span class="sxs-lookup"><span data-stu-id="6af81-162">Support for IO using multiple network interfaces simultaneously, as well as tolerance to network interface failure, using SMB Multichannel.</span></span><br /><br /> <span data-ttu-id="6af81-163">利用 SMB Direct 支援具有 RDMA 功能的網路介面。</span><span class="sxs-lookup"><span data-stu-id="6af81-163">Support for network interfaces with RDMA capabilities using SMB Direct.</span></span><br /><br /> <span data-ttu-id="6af81-164">如需這些功能和伺服器訊息區塊的詳細資訊，請參閱[伺服器訊息區塊概觀](https://go.microsoft.com/fwlink/?LinkId=253174) (https://go.microsoft.com/fwlink/?LinkId=253174) 。</span><span class="sxs-lookup"><span data-stu-id="6af81-164">For more information on these features and Server Message Block, see [Server Message Block overview](https://go.microsoft.com/fwlink/?LinkId=253174) (https://go.microsoft.com/fwlink/?LinkId=253174).</span></span><br /><br /> <span data-ttu-id="6af81-165">支援向外延展檔案伺服器 (SoFS) 的持續可用性。</span><span class="sxs-lookup"><span data-stu-id="6af81-165">Support for Scale Out File Server (SoFS) with continuous availability.</span></span><br /><br /> <span data-ttu-id="6af81-166">最佳化對 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] OLTP 的常用小型隨機讀取/寫入 I/O。</span><span class="sxs-lookup"><span data-stu-id="6af81-166">Optimized for small random read/write I/O common to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] OLTP.</span></span><br /><br /> <span data-ttu-id="6af81-167">預設會啟動最大傳輸單位 (MTU)，可大幅提高大型循序傳送的效能，例如 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資料倉儲及資料庫備份或還原。</span><span class="sxs-lookup"><span data-stu-id="6af81-167">Maximum Transmission Unit (MTU) is turned on by default, which significantly enhances performance in large sequential transfers like [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data warehouse and database backup or restore.</span></span>|  
  
## <a name="security-considerations"></a><span data-ttu-id="6af81-168">安全性考量</span><span class="sxs-lookup"><span data-stu-id="6af81-168">Security Considerations</span></span>  
  
-   <span data-ttu-id="6af81-169">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 服務帳戶和 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 服務帳戶應該擁有 SMB 共用資料夾的 FULL CONTROL 共用權限及 NTFS 權限。</span><span class="sxs-lookup"><span data-stu-id="6af81-169">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service account and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] agent service account should have FULL CONTROL share permissions and NTFS permissions on the SMB share folders.</span></span> <span data-ttu-id="6af81-170">如果使用 SMB 檔案伺服器， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 服務帳戶可以是網域帳戶或系統帳戶。</span><span class="sxs-lookup"><span data-stu-id="6af81-170">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service account can be a domain account or a system account if an SMB file server is used.</span></span> <span data-ttu-id="6af81-171">如需共用和 NTFS 權限的詳細資訊，請參閱[檔案伺服器的共用及 NTSF 權限](https://go.microsoft.com/fwlink/?LinkId=245535) (https://go.microsoft.com/fwlink/?LinkId=245535) 。</span><span class="sxs-lookup"><span data-stu-id="6af81-171">For more information about share and NTFS permissions, see [Share and NTFS Permissions on a File Server](https://go.microsoft.com/fwlink/?LinkId=245535) (https://go.microsoft.com/fwlink/?LinkId=245535).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6af81-172">SMB 共用資料夾的 FULL CONTROL 共用權限及 NTFS 權限僅限於： [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 服務帳戶、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 服務帳戶以及具有管理伺服器角色的 Windows 使用者。</span><span class="sxs-lookup"><span data-stu-id="6af81-172">The FULL CONTROL share permissions and NTFS permissions on the SMB share folders should be restricted to: [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service account, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account and windows users with admin server roles.</span></span>  
  
     <span data-ttu-id="6af81-173">建議使用網域帳戶當做 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 服務帳戶。</span><span class="sxs-lookup"><span data-stu-id="6af81-173">It is recommended to use domain account as a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service account.</span></span> <span data-ttu-id="6af81-174">如果系統帳戶當做服務帳戶使用，請以下列格式授與電腦帳戶的許可權： _<domain_name>_ **\\** _<computer_name>_ **$** 。</span><span class="sxs-lookup"><span data-stu-id="6af81-174">If system account is used as a service account, grant the permissions for the machine account in the format: _<domain_name>_**\\**_<computer_name>_**$**.</span></span>  
  
    > [!NOTE]  
    >  -   <span data-ttu-id="6af81-175">在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安裝期間，如果將 SMB 檔案共用指定為儲存選項，則必須將網域帳戶指定為服務帳戶。</span><span class="sxs-lookup"><span data-stu-id="6af81-175">During [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] setup, it is required to specify domain account as a service account if SMB file share is specified as a storage option.</span></span> <span data-ttu-id="6af81-176">在 SMB 檔案共用中，系統帳戶只能指定為服務帳戶後續 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安裝。</span><span class="sxs-lookup"><span data-stu-id="6af81-176">With SMB file share, System account can only be specified as a service account post [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] installation.</span></span>  
    > -   <span data-ttu-id="6af81-177">虛擬帳戶無法對遠端位置驗證。</span><span class="sxs-lookup"><span data-stu-id="6af81-177">Virtual accounts cannot be authenticated to a remote location.</span></span> <span data-ttu-id="6af81-178">所有虛擬帳戶都使用電腦帳戶的權限。</span><span class="sxs-lookup"><span data-stu-id="6af81-178">All virtual accounts use the permission of machine account.</span></span> <span data-ttu-id="6af81-179">使用下列格式提供電腦帳戶：<網域名稱> **\\** <電腦名稱> **$** 。</span><span class="sxs-lookup"><span data-stu-id="6af81-179">Provision the machine account in the format _<domain_name>_**\\**_<computer_name>_**$**.</span></span>  
  
-   <span data-ttu-id="6af81-180">在叢集安裝期間，用來安裝 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的帳戶應該擁有當做資料目錄使用之 SMB 檔案共用資料夾，或是其他任何資料夾 (使用者資料庫目錄、使用者資料庫記錄檔目錄、TempDB 目錄、TempDB 記錄檔目錄、備份目錄) 的 FULL CONTROL 權限。</span><span class="sxs-lookup"><span data-stu-id="6af81-180">The account used to install [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] should have FULL CONTROL permissions on the SMB file share folder used as the data directory, or any other data folders (User database directory, user database log directory, TempDB directory, TempDB log directory, backup directory) during Cluster Setup.</span></span>  
  
-   <span data-ttu-id="6af81-181">用於安裝 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的帳戶應該具有 SMB 檔案伺服器的 SeSecurityPrivilege 權限。</span><span class="sxs-lookup"><span data-stu-id="6af81-181">The account used to install [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] should be granted SeSecurityPrivilege privileges on the SMB file server.</span></span> <span data-ttu-id="6af81-182">若要授與此權限，請使用檔案伺服器上的 [本機安全性原則] 主控台，將 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安裝程式帳戶新增至 [管理稽核和安全性記錄檔] 原則中。</span><span class="sxs-lookup"><span data-stu-id="6af81-182">To grant this privilege, use the Local Security Policy console on the file server to add the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] setup account to the Manage auditing and security log policy.</span></span> <span data-ttu-id="6af81-183">在 [本機安全性原則] 主控台中 [本機原則] 下的 [使用者權利指派] 區段可以找到此設定。</span><span class="sxs-lookup"><span data-stu-id="6af81-183">This setting is available in the User Rights Assignments section under Local Policies in the Local Security Policy console.</span></span>  
  
## <a name="known-issues"></a><span data-ttu-id="6af81-184">已知問題</span><span class="sxs-lookup"><span data-stu-id="6af81-184">Known Issues</span></span>  
  
-   <span data-ttu-id="6af81-185">在您卸離位於連接網路之儲存裝置上的 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 資料庫之後，當您嘗試重新附加 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資料庫時，可能會遇到資料庫權限問題。</span><span class="sxs-lookup"><span data-stu-id="6af81-185">After you detach a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] database that resides on network-attached storage, you might run into database permission issue while trying to reattach the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="6af81-186">[這篇知識庫文章](https://go.microsoft.com/fwlink/?LinkId=237321) (https://go.microsoft.com/fwlink/?LinkId=237321) 有此問題的定義。</span><span class="sxs-lookup"><span data-stu-id="6af81-186">The issue is defined in [this KB article](https://go.microsoft.com/fwlink/?LinkId=237321) (https://go.microsoft.com/fwlink/?LinkId=237321).</span></span> <span data-ttu-id="6af81-187">若要暫時解決此問題，請參閱此知識庫文件中的＜ **其他相關資訊** ＞。</span><span class="sxs-lookup"><span data-stu-id="6af81-187">To work around this issue, see the **More Information** section in the KB article.</span></span>  
  
-   <span data-ttu-id="6af81-188">有些協力廠商 (像是 NetApp 裝置) 未支援所有 SQL Server API 呼叫。</span><span class="sxs-lookup"><span data-stu-id="6af81-188">Some third parties, like NetApp device do not support all SQL Server API calls.</span></span> <span data-ttu-id="6af81-189">有了這些，您可能會得到：</span><span class="sxs-lookup"><span data-stu-id="6af81-189">With these you might get:</span></span>   
    <span data-ttu-id="6af81-190">2015-06-04 13：14： 19.97 spid9s 錯誤：17053，嚴重性：16，狀態：1。</span><span class="sxs-lookup"><span data-stu-id="6af81-190">2015-06-04 13:14:19.97 spid9s      Error: 17053, Severity: 16, State: 1.</span></span>  
    <span data-ttu-id="6af81-191">2015-06-04 13：14： 19.97 spid9s DoDevIoCtlOut ( # A1 GetOverlappedResult ( # A3：作業系統錯誤 1 (不正確的函式。 ) 發生。</span><span class="sxs-lookup"><span data-stu-id="6af81-191">2015-06-04 13:14:19.97 spid9s      DoDevIoCtlOut() GetOverlappedResult() : Operating system error 1(Incorrect function.) encountered.</span></span>  
  
     <span data-ttu-id="6af81-192">若是 NTFS，此錯誤不會有影響；</span><span class="sxs-lookup"><span data-stu-id="6af81-192">For NTFS, the error is harmless.</span></span>  <span data-ttu-id="6af81-193">但若是 ReFS，則可能導致效能大幅降低。</span><span class="sxs-lookup"><span data-stu-id="6af81-193">but for ReFS, it can lead to significant performance degradation.</span></span>  
  
-   <span data-ttu-id="6af81-194">如果 SMB 檔案共用當做 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]叢集執行個體的儲存選項使用，則 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 容錯移轉叢集診斷記錄預設將無法寫入檔案共用，因為 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資源 DLL 缺少此檔案共用的讀取/寫入權限。</span><span class="sxs-lookup"><span data-stu-id="6af81-194">If SMB file share is used as a storage option for a clustered instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], by default the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Failover Cluster Diagnostics Log cannot be written to the file share because [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Resource DLL lacks the read/write permission on the file share.</span></span> <span data-ttu-id="6af81-195">若要解決這個問題，請嘗試下列其中一個方法：</span><span class="sxs-lookup"><span data-stu-id="6af81-195">To resolve this issue, try one of the following methods:</span></span>  
  
    1.  <span data-ttu-id="6af81-196">授與檔案共用的讀取/寫入權限給叢集中的所有電腦物件。</span><span class="sxs-lookup"><span data-stu-id="6af81-196">Grant read/write permissions on the file share to all computer objects in the cluster.</span></span>  
  
    2.  <span data-ttu-id="6af81-197">將診斷記錄的位置設定為本機檔案路徑。</span><span class="sxs-lookup"><span data-stu-id="6af81-197">Set the location of the diagnostic logs to a local file path.</span></span> <span data-ttu-id="6af81-198">請參閱下列範例：</span><span class="sxs-lookup"><span data-stu-id="6af81-198">See the following example:</span></span>  
  
        ```sql  
        ALTER SERVER CONFIGURATION  
        SET DIAGNOSTICS LOG PATH = 'C:\logs';  
        ```  
  
## <a name="see-also"></a><span data-ttu-id="6af81-199">另請參閱</span><span class="sxs-lookup"><span data-stu-id="6af81-199">See Also</span></span>  
 <span data-ttu-id="6af81-200">[規劃 SQL Server 安裝](../../../2014/sql-server/install/planning-a-sql-server-installation.md) </span><span class="sxs-lookup"><span data-stu-id="6af81-200">[Planning a SQL Server Installation](../../../2014/sql-server/install/planning-a-sql-server-installation.md) </span></span>  
 <span data-ttu-id="6af81-201">[安裝 how to 主題](../../../2014/sql-server/install/installation-how-to-topics.md) </span><span class="sxs-lookup"><span data-stu-id="6af81-201">[Installation How-to Topics](../../../2014/sql-server/install/installation-how-to-topics.md) </span></span>  
 [<span data-ttu-id="6af81-202">設定 Windows 服務帳戶與權限</span><span class="sxs-lookup"><span data-stu-id="6af81-202">Configure Windows Service Accounts and Permissions</span></span>](../configure-windows/configure-windows-service-accounts-and-permissions.md)  
  
  
