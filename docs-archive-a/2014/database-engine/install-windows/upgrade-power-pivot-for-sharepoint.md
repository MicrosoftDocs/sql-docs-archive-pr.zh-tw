---
title: 升級 PowerPivot for SharePoint |Microsoft Docs
ms.custom: ''
ms.date: 03/25/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
ms.assetid: 80ba9e43-f3f0-4730-9fb1-2afd2dd3e6fc
author: Minewiskan
ms.author: owend
ms.openlocfilehash: bebcfed02aa30ffc686b2a74807b6a4cc3955c90
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87594156"
---
# <a name="upgrade-powerpivot-for-sharepoint"></a><span data-ttu-id="9de82-102">升級 PowerPivot for SharePoint</span><span class="sxs-lookup"><span data-stu-id="9de82-102">Upgrade PowerPivot for SharePoint</span></span>
  <span data-ttu-id="9de82-103">本主題概述將 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 部署升級至 [!INCLUDE[ssGeminiLong](../../includes/ssgeminilong-md.md)]所需的步驟。</span><span class="sxs-lookup"><span data-stu-id="9de82-103">This topic summarizes the steps required to upgrade a deployment of [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] to [!INCLUDE[ssGeminiLong](../../includes/ssgeminilong-md.md)].</span></span> <span data-ttu-id="9de82-104">特定步驟取決於您環境目前所執行的 SharePoint 版本，並包含 PowerPivot for SharePoint 增益集 (**spPowerPivot.msi**)。</span><span class="sxs-lookup"><span data-stu-id="9de82-104">The specific steps depend on the version of SharePoint your environment is currently running and include the PowerPivot for SharePoint Add-in (**spPowerPivot.msi**).</span></span>  
  
 <span data-ttu-id="9de82-105">**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2010 | SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="9de82-105">**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2010 | SharePoint 2013</span></span>  
  
 <span data-ttu-id="9de82-106">如需版本資訊，請參閱＜ [SQL Server 2014 版本資訊](https://go.microsoft.com/fwlink/?LinkID=296445)＞。</span><span class="sxs-lookup"><span data-stu-id="9de82-106">For release notes, see [SQL Server 2014 Release Notes](https://go.microsoft.com/fwlink/?LinkID=296445).</span></span>  
  

  
## <a name="background"></a><span data-ttu-id="9de82-107">背景</span><span class="sxs-lookup"><span data-stu-id="9de82-107">Background</span></span>  
  
-   <span data-ttu-id="9de82-108">如果您要升級含有兩個 (含) 以上 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 執行個體的多伺服器 SharePoint 2010 伺服器陣列，必須在繼續升級下一部伺服器 **之前** ，完整升級每部伺服器。</span><span class="sxs-lookup"><span data-stu-id="9de82-108">If you are upgrading a multi-server SharePoint 2010 farm that has two or more [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] instances, you must fully upgrade each server **before** continuing to the next server.</span></span> <span data-ttu-id="9de82-109">完整升級包括執行 SQL Server 安裝程式來升級 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 程式檔案，然後再執行 SharePoint 升級動作來設定已升級的服務。</span><span class="sxs-lookup"><span data-stu-id="9de82-109">A full upgrade includes running SQL Server Setup to upgrade [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] program files, followed by SharePoint upgrade actions that configure the upgraded services.</span></span> <span data-ttu-id="9de82-110">在適當的 PowerPivot 組態工具或 Windows PowerShell 中執行升級動作之前，伺服器可用性會受到限制。</span><span class="sxs-lookup"><span data-stu-id="9de82-110">Server availability will be limited until you run upgrade actions in the appropriate PowerPivot Configuration Tool or Windows PowerShell.</span></span>  
  
-   <span data-ttu-id="9de82-111">SharePoint 2010 伺服陣列中的所有 PowerPivot 系統服務與 Analysis Services 執行個體都必須是相同的版本。</span><span class="sxs-lookup"><span data-stu-id="9de82-111">All instances of PowerPivot System Service and Analysis Services in a SharePoint 2010 farm must be the same version.</span></span> <span data-ttu-id="9de82-112">如需有關如何驗證版本的詳細資訊，請參閱本主題中的 [驗證 PowerPivot 元件和服務的版本](#bkmk_verify_versions) 一節。</span><span class="sxs-lookup"><span data-stu-id="9de82-112">For information on how to verify the version, see the section [Verify the Versions of PowerPivot Components and Services](#bkmk_verify_versions) in this topic.</span></span>  
  
-   <span data-ttu-id="9de82-113">PowerPivot 組態工具是 SQL Server 共用功能之一，所有共用功能都會同時升級。</span><span class="sxs-lookup"><span data-stu-id="9de82-113">The PowerPivot configuration tools are one of the SQL Server shared features and all shared features upgrade at the same time.</span></span> <span data-ttu-id="9de82-114">如果您在升級過程中選取需要共用功能升級的其他 SQL Server 執行個體或功能，則 PowerPivot 組態工具也會一併升級。</span><span class="sxs-lookup"><span data-stu-id="9de82-114">If during an upgrade process you select other SQL Server instances or features that require a shared feature upgrade, then the PowerPivot configuration tool will also be upgraded.</span></span> <span data-ttu-id="9de82-115">如果升級 PowerPivot 組態工具但是未升級 PowerPivot 執行個體，可能會發生問題。</span><span class="sxs-lookup"><span data-stu-id="9de82-115">You may have issues if the PowerPivot configuration tool is upgraded but your PowerPivot instance is not.</span></span> <span data-ttu-id="9de82-116">如需 SQL Server 共用功能的詳細資訊，請參閱[使用安裝精靈升級至 SQL Server 2014 &#40;安裝程式&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md)。</span><span class="sxs-lookup"><span data-stu-id="9de82-116">For more information about SQL Server shared features, see [Upgrade to SQL Server 2014 Using the Installation Wizard &#40;Setup&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md).</span></span>  
  
-   <span data-ttu-id="9de82-117">PowerPivot for SharePoint 增益集 (**spPowerPivot.msi**) 會與舊版並排安裝。</span><span class="sxs-lookup"><span data-stu-id="9de82-117">The PowerPivot for SharePoint Add-in (**spPowerPivot.msi**) installs side by side with previous versions.</span></span> <span data-ttu-id="9de82-118">例如， [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 增益集會安裝至資料夾 `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools`。</span><span class="sxs-lookup"><span data-stu-id="9de82-118">For example the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] add-in installs to the folder `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools`.</span></span>  
  

  
##  <a name="prerequisites"></a><a name="bkmk_prereq"></a> <span data-ttu-id="9de82-119">必要條件</span><span class="sxs-lookup"><span data-stu-id="9de82-119">Prerequisites</span></span>  
 <span data-ttu-id="9de82-120">**權限**</span><span class="sxs-lookup"><span data-stu-id="9de82-120">**Permissions**</span></span>  
  
-   <span data-ttu-id="9de82-121">您必須是伺服器陣列管理員，才能升級 PowerPivot for SharePoint 安裝。</span><span class="sxs-lookup"><span data-stu-id="9de82-121">You must be a farm administrator to upgrade a PowerPivot for SharePoint installation.</span></span> <span data-ttu-id="9de82-122">您必須是本機系統管理員，才能執行 SQL Server 安裝程式。</span><span class="sxs-lookup"><span data-stu-id="9de82-122">You must be a local administrator to run SQL Server Setup.</span></span>  
  
-   <span data-ttu-id="9de82-123">您必須要有伺服器陣列組態資料庫的 **db_owner** 權限。</span><span class="sxs-lookup"><span data-stu-id="9de82-123">You must have **db_owner** permissions on the farm configuration database.</span></span>  
  
 <span data-ttu-id="9de82-124">**SQL Server:**</span><span class="sxs-lookup"><span data-stu-id="9de82-124">**SQL Server:**</span></span>  
  
-   <span data-ttu-id="9de82-125">如果現有的 PowerPivot 安裝為 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] ，則 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 需要 Service Pack 2 (SP2) ，才能升級至 [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="9de82-125">If the existing PowerPivot installation is [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)], the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] Service Pack 2 (SP2) is required for an upgrade to [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span>  
  
-   <span data-ttu-id="9de82-126">如果現有的 PowerPivot 安裝為 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] ，則 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] 需要 Service Pack 1 (SP1) ，才能升級至 [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="9de82-126">If the existing PowerPivot installation is [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] Service Pack 1 (SP1) is required for an upgrade to [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span>  
  
 <span data-ttu-id="9de82-127">**SharePoint 2010：**</span><span class="sxs-lookup"><span data-stu-id="9de82-127">**SharePoint 2010:**</span></span>  
  
-   <span data-ttu-id="9de82-128">如果現有的安裝是執行 SharePoint 2010，請先安裝 SharePoint 2010 Service Pack 2，再升級至 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="9de82-128">If the existing installation is running SharePoint 2010, install the SharePoint 2010 Service Pack 2 before upgrading to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span> <span data-ttu-id="9de82-129">如需詳細資訊，請參閱＜ [Service Pack 2 for Microsoft SharePoint 2010](https://www.microsoft.com/download/details.aspx?id=39672)＞。</span><span class="sxs-lookup"><span data-stu-id="9de82-129">For more information, see [Service Pack 2 for Microsoft SharePoint 2010](https://www.microsoft.com/download/details.aspx?id=39672).</span></span> <span data-ttu-id="9de82-130">使用 PowerShell 命令 `(Get-SPfarm).BuildVersion.ToString()` 來驗證版本。</span><span class="sxs-lookup"><span data-stu-id="9de82-130">Use the PowerShell command `(Get-SPfarm).BuildVersion.ToString()` to verify the version.</span></span> <span data-ttu-id="9de82-131">若要將組建版本參照至發行日期，請參閱＜ [SharePoint 2010 組建編號](http://www.toddklindt.com/blog/Lists/Posts/Post.aspx?ID=224)＞。</span><span class="sxs-lookup"><span data-stu-id="9de82-131">To reference the build version to release date, see [SharePoint 2010 Build Numbers](http://www.toddklindt.com/blog/Lists/Posts/Post.aspx?ID=224).</span></span>  
  
 
  
##  <a name="upgrade-an-existing-sharepoint-2013-farm"></a><a name="bkmk_uprgade_sharepoint2013"></a> <span data-ttu-id="9de82-132">升級現有的 SharePoint 2013 伺服器陣列</span><span class="sxs-lookup"><span data-stu-id="9de82-132">Upgrade an Existing SharePoint 2013 Farm</span></span>  
 <span data-ttu-id="9de82-133">若要將部署在 SharePoint 2013 中的 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 升級，請執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="9de82-133">To upgrade [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] deployed in SharePoint 2013, do the following:</span></span>  
  
 <span data-ttu-id="9de82-134">![PowerPivot for SharePoint 2013 升級](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2013.png "PowerPivot for SharePoint 2013 升級")</span><span class="sxs-lookup"><span data-stu-id="9de82-134">![powerpivot for sharepoint 2013 upgrade](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2013.png "powerpivot for sharepoint 2013 upgrade")</span></span>  
  
1.  <span data-ttu-id="9de82-135">在以 SharePoint 模式執行 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 的後端伺服器上，執行 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 安裝程式。</span><span class="sxs-lookup"><span data-stu-id="9de82-135">Run [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Setup on backend server(s) that run [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in SharePoint mode.</span></span> <span data-ttu-id="9de82-136">如果該伺服器主控多個 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]執行個體，則至少要升級 **POWERPIVOT** 執行個體。</span><span class="sxs-lookup"><span data-stu-id="9de82-136">If the server hosts multiple instances of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], upgrade at least the **POWERPIVOT** instance.</span></span> <span data-ttu-id="9de82-137">下列清單是有關 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 升級的安裝精靈步驟摘要：</span><span class="sxs-lookup"><span data-stu-id="9de82-137">The following list is a summary of setup wizard steps related to a [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] upgrade:</span></span>  
  
    1.  <span data-ttu-id="9de82-138">在 [ [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安裝精靈] 中，按一下 **[安裝]** 。</span><span class="sxs-lookup"><span data-stu-id="9de82-138">In the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Setup Wizard, click **Installation**.</span></span>  
  
    2.  <span data-ttu-id="9de82-139">按一下 [從 SQL Server 升級...]。</span><span class="sxs-lookup"><span data-stu-id="9de82-139">Click **Upgrade from SQL Server.....**.</span></span>  
  
    3.  <span data-ttu-id="9de82-140">在 **[選取執行個體]** 頁面上，選取 **[POWERPIVOT]** 執行個體名稱，然後按 **[下一步]** 。</span><span class="sxs-lookup"><span data-stu-id="9de82-140">On the **Select Instance** page, select the **POWERPIVOT** instance name and then click **Next**.</span></span>  
  
    4.  <span data-ttu-id="9de82-141">如需詳細資訊，請參閱[使用安裝精靈升級至 SQL Server 2014 &#40;安裝程式&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md)</span><span class="sxs-lookup"><span data-stu-id="9de82-141">For more information, see [Upgrade to SQL Server 2014 Using the Installation Wizard &#40;Setup&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md)</span></span>  
  
2.  <span data-ttu-id="9de82-142">重新啟動伺服器。</span><span class="sxs-lookup"><span data-stu-id="9de82-142">Restart the server.</span></span>  
  
3.  <span data-ttu-id="9de82-143">在 SharePoint 2013 伺服器陣列中的每部伺服器上，執行 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for SharePoint 增益集 (**spPowerPivot.msi**)，以安裝資料提供者。</span><span class="sxs-lookup"><span data-stu-id="9de82-143">Run the [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for SharePoint add-in (**spPowerPivot.msi**) on each server in the SharePoint 2013 farm to install the data providers.</span></span> <span data-ttu-id="9de82-144">但是執行 SQL Server 安裝精靈所在的伺服器除外，安裝精靈也會升級資料提供者。</span><span class="sxs-lookup"><span data-stu-id="9de82-144">The exception is servers where you ran the SQL Server setup wizard, which also upgrades data providers.</span></span> <span data-ttu-id="9de82-145">如需詳細資訊，請參閱[安裝或卸載 PowerPivot for SharePoint 增益集 &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013)。</span><span class="sxs-lookup"><span data-stu-id="9de82-145">For more information, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013).</span></span>  
  
4.  <span data-ttu-id="9de82-146">在其中一個 SharePoint 應用程式伺服器上**執行 PowerPivot for SharePoint 2013 組態** 工具，以增益集所安裝的更新方案檔案來設定 SharePoint 伺服器陣列。</span><span class="sxs-lookup"><span data-stu-id="9de82-146">**Run the PowerPivot for SharePoint 2013 Configuration** tool on one of the SharePoint application servers to configure the SharePoint farm with the updated solution files that the add-in installed.</span></span> <span data-ttu-id="9de82-147">您無法使用 SharePoint 管理中心來進行此步驟。</span><span class="sxs-lookup"><span data-stu-id="9de82-147">You cannot use Central SharePoint Administration for this step.</span></span> <span data-ttu-id="9de82-148">如需詳細資訊，請參閱下列：</span><span class="sxs-lookup"><span data-stu-id="9de82-148">For more information, see the following:</span></span>  
  
    1.  <span data-ttu-id="9de82-149">在 Windows 的 [開始] 頁面中，輸入 **PowerPivot** ，然後在搜尋結果中，按一下 **[PowerPivot for SharePoint 2013 組態]**。</span><span class="sxs-lookup"><span data-stu-id="9de82-149">From the Windows Start page, type **PowerPivot** and in the search results, click **PowerPivot for SharePoint 2013 Configuration**.</span></span> <span data-ttu-id="9de82-150">請注意，搜尋可能會將組態工具的兩個版本皆傳回。</span><span class="sxs-lookup"><span data-stu-id="9de82-150">Note the search may return both versions of the configuration tool.</span></span>  
  
         <span data-ttu-id="9de82-151">![兩個 PowerPivot 組態工具](../../analysis-services/media/as-powerpivot-configtools-bothicons.gif "兩個 PowerPivot 組態工具")</span><span class="sxs-lookup"><span data-stu-id="9de82-151">![two powerpivot configuratoin tools](../../analysis-services/media/as-powerpivot-configtools-bothicons.gif "two powerpivot configuratoin tools")</span></span>  
  
         <span data-ttu-id="9de82-152">Or</span><span class="sxs-lookup"><span data-stu-id="9de82-152">Or</span></span>  
  
         <span data-ttu-id="9de82-153">在 **[開始]** 功能表上，指向 **[所有程式]**，然後依序按一下 [ [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)]]、 **[組態工具]** 和 **[PowerPivot for SharePoint 2013 組態工具]**。</span><span class="sxs-lookup"><span data-stu-id="9de82-153">On the **Start** menu, point to **All Programs**, click [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)], click **Configuration Tools**, and then click **PowerPivot for SharePoint 2013 Configuration Too**.</span></span> <span data-ttu-id="9de82-154">請注意，只有在本機伺服器上安裝了 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 時，才會列出此工具。</span><span class="sxs-lookup"><span data-stu-id="9de82-154">Note that this tool is listed only when [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] is installed on the local server.</span></span>  
  
    2.  <span data-ttu-id="9de82-155">啟動時，組態工具會檢查 PowerPivot 伺服器陣列方案以及 PowerPivot Web 應用程式方案的狀態。</span><span class="sxs-lookup"><span data-stu-id="9de82-155">At startup, the configuration tool checks the upgrade status of the PowerPivot farm solution and PowerPivot web application solutions.</span></span> <span data-ttu-id="9de82-156">如果偵測到這些方案的舊版本，您會看到「偵測**到較新版本的 PowerPivot 方案檔。請選取升級選項以升級您的伺服器**陣列」。</span><span class="sxs-lookup"><span data-stu-id="9de82-156">If older versions of these solutions are detected, you will see the message "**Newer versions of the PowerPivot solution files have been detected. Please select the upgrade option to upgrade your farm**."</span></span> <span data-ttu-id="9de82-157">按一下 [確定]  以關閉系統驗證訊息。</span><span class="sxs-lookup"><span data-stu-id="9de82-157">Click **OK** to close the system validation message.</span></span>  
  
    3.  <span data-ttu-id="9de82-158">按一下 **[升級功能、服務、應用程式和方案]** ，然後按一下 **[確定]** 。</span><span class="sxs-lookup"><span data-stu-id="9de82-158">Click **Upgrade Features, Services, Applications and Solutions**, and then click **OK**.</span></span>  
  
    4.  <span data-ttu-id="9de82-159">檢閱左窗格工作清單中的動作，並排除您不希望該工具執行的任何動作。</span><span class="sxs-lookup"><span data-stu-id="9de82-159">Review the actions in the left pane task list and exclude any that you do not want the tool to perform.</span></span> <span data-ttu-id="9de82-160">預設包含所有動作。</span><span class="sxs-lookup"><span data-stu-id="9de82-160">All actions are included by default.</span></span> <span data-ttu-id="9de82-161">若要移除動作，請在左邊工作清單中選取該動作，然後清除 **[參數]** 頁面上的 **[在工作清單中包含這個動作]** 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="9de82-161">To remove an action, select it in the left task list, and then on the **Parameters** page, clear the **Include this action in the task list** checkbox.</span></span>  
  
    5.  <span data-ttu-id="9de82-162">或者，在 **[指令碼]** 或 **[輸出]** 索引標籤中檢閱詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="9de82-162">Optionally, review detailed information in the **Script** or **Output** tab.</span></span>  
  
         <span data-ttu-id="9de82-163">[輸出] 索引標籤是此工具即將執行之動作的摘要。</span><span class="sxs-lookup"><span data-stu-id="9de82-163">The Output tab is a summary of the actions that will be performed by the tool.</span></span> <span data-ttu-id="9de82-164">此資訊會儲存在記錄檔中： `C:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\SPAddinConfiguration\Log`。</span><span class="sxs-lookup"><span data-stu-id="9de82-164">This information is saved in log files at `C:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\SPAddinConfiguration\Log`.</span></span>  
  
         <span data-ttu-id="9de82-165">[指令碼] 索引標籤會顯示 PowerShell 指令程式，或參考此工具將執行的 PowerShell 指令碼檔案。</span><span class="sxs-lookup"><span data-stu-id="9de82-165">The Script tab shows the PowerShell cmdlets or references the PowerShell script files that the tool will run.</span></span>  
  
    6.  <span data-ttu-id="9de82-166">按一下 **[驗證]** 來檢查每個動作是否有效。</span><span class="sxs-lookup"><span data-stu-id="9de82-166">Click **Validate** to check whether each action is valid.</span></span> <span data-ttu-id="9de82-167">如果無法使用 **[驗證]** ，表示所有動作都適用於您的系統。</span><span class="sxs-lookup"><span data-stu-id="9de82-167">If **Validate** is not available, it means that all of the actions are valid for your system.</span></span> <span data-ttu-id="9de82-168">如果可以使用 **[驗證]** ，表示您可能已經修改輸入值 (例如，Excel 服務應用程式名稱)，或此工具可能已經判定府執行特定動作。</span><span class="sxs-lookup"><span data-stu-id="9de82-168">If **Validate** is available, you might have modified an input value (for example, the Excel service application name), or the tool might have determined that a particular action cannot be performed.</span></span> <span data-ttu-id="9de82-169">如果無法執行某個動作，您必須排除該動作，或修正造成此動作標示為無效的基礎條件。</span><span class="sxs-lookup"><span data-stu-id="9de82-169">If an action cannot be performed, you must exclude it or fix the underlying conditions that cause the action to be flagged as invalid.</span></span>  
  
        > [!IMPORTANT]  
        >  <span data-ttu-id="9de82-170">您必須一律先處理第一個動作 **[升級伺服器陣列方案]** 。</span><span class="sxs-lookup"><span data-stu-id="9de82-170">The first action, **Upgrade Farm Solution**, must always be processed first.</span></span> <span data-ttu-id="9de82-171">此動作會註冊用來設定伺服器的 PowerShell 指令程式。</span><span class="sxs-lookup"><span data-stu-id="9de82-171">It registers the PowerShell cmdlets that are used to configure the server.</span></span> <span data-ttu-id="9de82-172">如果此動作出現錯誤，請不要繼續。</span><span class="sxs-lookup"><span data-stu-id="9de82-172">If you get an error on this action, do not continue.</span></span> <span data-ttu-id="9de82-173">在處理工作清單中的其他動作之前，請改用此錯誤所提供的資訊診斷並解決問題。</span><span class="sxs-lookup"><span data-stu-id="9de82-173">Instead, use the information provided by the error to diagnose and resolve the problem before processing additional actions in the task list.</span></span>  
  
    7.  <span data-ttu-id="9de82-174">按一下 **[執行]** ，執行適用於此工作的所有動作。</span><span class="sxs-lookup"><span data-stu-id="9de82-174">Click **Run** to perform all of the actions that are valid for this task.</span></span> <span data-ttu-id="9de82-175">只有在通過驗證檢查的情況下，才可以使用 **[執行]** 。</span><span class="sxs-lookup"><span data-stu-id="9de82-175">**Run** is available only after the validation check is passed.</span></span> <span data-ttu-id="9de82-176">當您按一下 [執行] 時，會出現下列警告，提醒您動作是在批次模式下處理：「**工具中標示為有效的所有組態設定都會套用到 SharePoint 伺服器陣列。您要繼續嗎？** 」</span><span class="sxs-lookup"><span data-stu-id="9de82-176">When you click **Run**, the following warning appears, reminding you that actions are processed in batch mode: "**All of the configuration settings that are flagged as valid in the tool will be applied to the SharePoint farm. Do you want to continue?**".</span></span>  
  
    8.  <span data-ttu-id="9de82-177">按一下 **[是]** 繼續。</span><span class="sxs-lookup"><span data-stu-id="9de82-177">Click **Yes** to continue.</span></span>  
  
    9. <span data-ttu-id="9de82-178">在伺服器陣列中升級方案和功能可能需要數分鐘才能完成。</span><span class="sxs-lookup"><span data-stu-id="9de82-178">Upgrading solutions and features in the farm can take several minutes to complete.</span></span> <span data-ttu-id="9de82-179">在這段期間內，PowerPivot 資料的連接要求**將會失敗**，並出現類似下列錯誤：「無法重新整理**資料**」或「**嘗試執行要求的動作時發生錯誤。請再試一次**。」</span><span class="sxs-lookup"><span data-stu-id="9de82-179">During this time, connection requests for PowerPivot data **will fail** with errors similar to "**Unable to refresh data**" or "**An error has occurred trying to perform the requested action. Please try again**."</span></span> <span data-ttu-id="9de82-180">升級完成後，伺服器將會變成可以使用，而且將不再發生這些錯誤。</span><span class="sxs-lookup"><span data-stu-id="9de82-180">After upgrade is finished, the server will become available and these errors will no longer occur.</span></span>  
  
     <span data-ttu-id="9de82-181">如需詳細資訊，請參閱下列：</span><span class="sxs-lookup"><span data-stu-id="9de82-181">For more information, see the following:</span></span>  
  
    -   [<span data-ttu-id="9de82-182">PowerPivot 設定工具</span><span class="sxs-lookup"><span data-stu-id="9de82-182">PowerPivot Configuration Tools</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-configuration-tools)  
  
    -   [<span data-ttu-id="9de82-183">設定或修復 PowerPivot for SharePoint 2013 &#40;PowerPivot 設定工具&#41;</span><span class="sxs-lookup"><span data-stu-id="9de82-183">Configure or Repair PowerPivot for SharePoint 2013 &#40;PowerPivot Configuration Tool&#41;</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/configure-or-repair-power-pivot-for-sharepoint-2013)  
  
    -   [<span data-ttu-id="9de82-184">使用 Windows PowerShell 的 PowerPivot 設定</span><span class="sxs-lookup"><span data-stu-id="9de82-184">PowerPivot Configuration using Windows PowerShell</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-configuration-using-windows-powershell)  
  
    -   [<span data-ttu-id="9de82-185">PowerPivot for SharePoint 的 PowerShell 參考</span><span class="sxs-lookup"><span data-stu-id="9de82-185">PowerShell Reference for PowerPivot for SharePoint</span></span>](/sql/analysis-services/powershell/powershell-reference-for-power-pivot-for-sharepoint)  
  
5.  <span data-ttu-id="9de82-186">透過執行升級後的步驟以及檢查伺服器陣列中的 PowerPivot 伺服器版本，驗證升級成功。</span><span class="sxs-lookup"><span data-stu-id="9de82-186">Verify that upgrade succeeded by performing the post-upgrade steps and by checking the version of PowerPivot servers in the farm.</span></span> <span data-ttu-id="9de82-187">如需詳細資訊，請參閱本主題中的 [Post-upgrade verification tasks](#verify) 和下列章節：</span><span class="sxs-lookup"><span data-stu-id="9de82-187">For more information, see [Post-upgrade verification tasks](#verify) in this topic and the following section.</span></span>  
  
 
  
##  <a name="upgrade-an-existing-sharepoint-2010-farm"></a><a name="bkmk_uprgade_sharepoint2010"></a> <span data-ttu-id="9de82-188">升級現有的 SharePoint 2010 伺服器陣列</span><span class="sxs-lookup"><span data-stu-id="9de82-188">Upgrade an Existing SharePoint 2010 Farm</span></span>  
 <span data-ttu-id="9de82-189">若要將部署在 SharePoint 2010 中的 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 升級，請執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="9de82-189">To upgrade [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] deployed in SharePoint 2010, do the following:</span></span>  
  
 <span data-ttu-id="9de82-190">![PowerPivot for SharePoint 2010 升級](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2010.png "PowerPivot for SharePoint 2010 升級")</span><span class="sxs-lookup"><span data-stu-id="9de82-190">![powerpivot for sharepoint 2010 upgrade](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2010.png "powerpivot for sharepoint 2010 upgrade")</span></span>  
  
1.  <span data-ttu-id="9de82-191">下載 [Service Pack 2 for Microsoft SharePoint 2010](https://www.microsoft.com/download/details.aspx?id=39672) ，並套用至伺服器陣列中的所有伺服器。</span><span class="sxs-lookup"><span data-stu-id="9de82-191">Download [Service Pack 2 for Microsoft SharePoint 2010](https://www.microsoft.com/download/details.aspx?id=39672) and apply it on all servers in the farm.</span></span> <span data-ttu-id="9de82-192">確認 SharePoint SP2 安裝成功。</span><span class="sxs-lookup"><span data-stu-id="9de82-192">Verify that SharePoint SP2 installation succeeded.</span></span> <span data-ttu-id="9de82-193">在管理中心的 [升級與移轉] 頁面上，開啟 [檢查產品與修補安裝狀態] 頁面，以檢視與 SP2 相關的狀態訊息。</span><span class="sxs-lookup"><span data-stu-id="9de82-193">In Central Administration, on the Upgrade and Migration page, open the Check product and patch installation status page to view status messages related to SP2.</span></span>  
  
2.  <span data-ttu-id="9de82-194">確認 SharePoint 2010 Administration Windows 服務正在執行中。</span><span class="sxs-lookup"><span data-stu-id="9de82-194">Verify that the SharePoint 2010 Administration Windows service is running.</span></span>  
  
    ```powershell
    Get-Service | Where {$_.displayname -like "*SharePoint*"}  
    ```  
  
3.  <span data-ttu-id="9de82-195">確認 SharePoint 管理中心已經啟動 **SharePoint** 服務、 **SQL Server Analysis Services** 和 **SQL Server PowerPivot 系統服務** ，或使用下列 PowerShell 命令：</span><span class="sxs-lookup"><span data-stu-id="9de82-195">Verify the **SharePoint** services **SQL Server Analysis Services** and **SQL Server PowerPivot System Service** are started in SharePoint Central Administration or use the following PowerShell command:.</span></span>  
  
    ```powershell
    Get-SPServiceInstance | where {$_.typename -like "*sql*"}  
    ```  
  
4.  <span data-ttu-id="9de82-196">確認 **Windows** 服務 **SQL Server Analysis Services (PowerPivot)** 執行中。</span><span class="sxs-lookup"><span data-stu-id="9de82-196">Verify the **Windows** service **SQL Server Analysis Services (PowerPivot)** is running.</span></span>  
  
    ```powershell
    Get-Service | where {$_.displayname -like "*powerpivot*"}  
    ```  
  
5.  <span data-ttu-id="9de82-197">**在以 SharePoint 模式執行 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] SQL Server Analysis Services (PowerPivot)** Windows 服務的第一部 SharePoint 應用程式伺服器上， **SQL Server Analysis Services (PowerPivot)** ，以升級 POWERPIVOT 執行個體。</span><span class="sxs-lookup"><span data-stu-id="9de82-197">**Run [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Setup** on the first SharePoint application server that runs the **SQL Server Analysis Services (PowerPivot)** Windows service to upgrade the POWERPIVOT instance.</span></span> <span data-ttu-id="9de82-198">在 [SQL Server 安裝精靈] 的 [安裝] 頁面上，選擇升級選項。</span><span class="sxs-lookup"><span data-stu-id="9de82-198">On the Installation page of the SQL Server Setup Wizard, choose the upgrade option.</span></span> <span data-ttu-id="9de82-199">如需詳細資訊，請參閱[使用安裝精靈升級至 SQL Server 2014 &#40;安裝程式&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md)。</span><span class="sxs-lookup"><span data-stu-id="9de82-199">For more information, see [Upgrade to SQL Server 2014 Using the Installation Wizard &#40;Setup&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md).</span></span>  
  
6.  <span data-ttu-id="9de82-200">在執行組態工具之前，請先**重新啟動伺服器** 。</span><span class="sxs-lookup"><span data-stu-id="9de82-200">**Restart the server** before running the configuration tool.</span></span> <span data-ttu-id="9de82-201">此步驟可確保 SQL Server 安裝程式安裝的任何更新或必要條件完全在系統上設定。</span><span class="sxs-lookup"><span data-stu-id="9de82-201">This step ensures that any updates or prerequisites installed by SQL Server Setup are fully configured on the system.</span></span>  
  
7.  <span data-ttu-id="9de82-202">在執行 SQL Server Analysis Services (PowerPivot) 服務的第一個 SharePoint 應用程式伺服器上**執行 powerpivot 設定工具**，以升級 SharePoint 中的方案和 Web 服務。</span><span class="sxs-lookup"><span data-stu-id="9de82-202">**Run the PowerPivot Configuration Tool** on the first SharePoint application server that runs SQL Server Analysis Services (PowerPivot) service to upgrade the solutions and Web services in SharePoint.</span></span> <span data-ttu-id="9de82-203">您無法使用管理中心進行此步驟。</span><span class="sxs-lookup"><span data-stu-id="9de82-203">You cannot use Central Administration for this step.</span></span>  
  
    1.  <span data-ttu-id="9de82-204">指向 **[開始]** 功能表上的 **[所有程式]**，按一下 [ [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)]]，然後按一下 **[組態工具]**，再按一下 **[PowerPivot 組態工具]**。</span><span class="sxs-lookup"><span data-stu-id="9de82-204">On the **Start** menu, point to **All Programs**, click [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)], click **Configuration Tools**, and then click **PowerPivot Configuration Tool**.</span></span> <span data-ttu-id="9de82-205">請注意，只有在本機伺服器上安裝了 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 時，才會列出此工具。</span><span class="sxs-lookup"><span data-stu-id="9de82-205">Note that this tool is listed only when [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] is installed on the local server.</span></span>  
  
    2.  <span data-ttu-id="9de82-206">啟動時，組態工具會檢查 PowerPivot 伺服器陣列方案以及 PowerPivot Web 應用程式方案的狀態。</span><span class="sxs-lookup"><span data-stu-id="9de82-206">At startup, the configuration tool checks the upgrade status of the PowerPivot farm solution and PowerPivot web application solutions.</span></span> <span data-ttu-id="9de82-207">如果偵測到這些方案的舊版本，您會看到「偵測到較新版本的 PowerPivot 方案檔。</span><span class="sxs-lookup"><span data-stu-id="9de82-207">If older versions of these solutions are detected, you will see the message "Newer versions of the PowerPivot solution files have been detected.</span></span> <span data-ttu-id="9de82-208">請選取升級選項以升級您的伺服器陣列」。</span><span class="sxs-lookup"><span data-stu-id="9de82-208">Please select the upgrade option to upgrade your farm."</span></span> <span data-ttu-id="9de82-209">按一下 **[確定]** 以關閉訊息。</span><span class="sxs-lookup"><span data-stu-id="9de82-209">Click **OK** to close the message.</span></span>  
  
    3.  <span data-ttu-id="9de82-210">按一下 **[升級功能、服務、應用程式和方案]** ，然後按一下 **[確定]** 繼續。</span><span class="sxs-lookup"><span data-stu-id="9de82-210">Click **Upgrade Features, Services, Applications and Solutions**, and then click **OK** to continue.</span></span>  
  
    4.  <span data-ttu-id="9de82-211">此時會出現下列警告：「PowerPivot 管理儀表板中的活頁簿即將升級為最新版本。</span><span class="sxs-lookup"><span data-stu-id="9de82-211">The following warning appears: "Workbooks in the PowerPivot Management Dashboard are about to be upgraded to the latest version.</span></span> <span data-ttu-id="9de82-212">您對現有活頁簿所做的任何自訂內容都將遺失。</span><span class="sxs-lookup"><span data-stu-id="9de82-212">Any customizations you made to the existing workbooks will be lost.</span></span> <span data-ttu-id="9de82-213">您要繼續嗎？」</span><span class="sxs-lookup"><span data-stu-id="9de82-213">Do you want to continue?"</span></span>  
  
         <span data-ttu-id="9de82-214">此警告指的是 PowerPivot 管理儀表板中，針對資料重新整理活動報告的活頁簿。</span><span class="sxs-lookup"><span data-stu-id="9de82-214">This warning refers to workbooks in the PowerPivot Management Dashboard that report on data refresh activity.</span></span> <span data-ttu-id="9de82-215">如果您自訂這些活頁簿，當現有的檔案取代成較新的版本時，您對這些活頁簿所做的任何變更都會遺失。</span><span class="sxs-lookup"><span data-stu-id="9de82-215">If you customized these workbooks, any changes you made to those workbooks will be lost when existing files are replaced with newer versions.</span></span>  
  
         <span data-ttu-id="9de82-216">按一下 **[是]** ，將活頁簿覆寫成較新的版本。</span><span class="sxs-lookup"><span data-stu-id="9de82-216">Click **Yes** to overwrite the workbooks with newer versions.</span></span> <span data-ttu-id="9de82-217">否則，按一下 **[否]** ，返回首頁。</span><span class="sxs-lookup"><span data-stu-id="9de82-217">Otherwise, click **No** to return to the home page.</span></span> <span data-ttu-id="9de82-218">將活頁簿儲存到不同的位置，讓您擁有一個副本，然後在準備好繼續時，返回此步驟。</span><span class="sxs-lookup"><span data-stu-id="9de82-218">Save the workbooks to a different location so that you have a copy, and then return to this step when you are ready to continue.</span></span>  
  
         <span data-ttu-id="9de82-219">如需有關自訂儀表板中使用之活頁簿的詳細資訊，請參閱 [自訂 PowerPivot 管理儀表板](https://go.microsoft.com/fwlink/?linkID=229639)。</span><span class="sxs-lookup"><span data-stu-id="9de82-219">For more information about customizing workbooks used in the dashboard, see [Customizing the PowerPivot Management Dashboard](https://go.microsoft.com/fwlink/?linkID=229639).</span></span>  
  
    5.  <span data-ttu-id="9de82-220">檢閱工作清單中的動作，並排除您不希望該工具執行的任何動作。</span><span class="sxs-lookup"><span data-stu-id="9de82-220">Review the actions in the task list and exclude any that you do not want the tool to perform.</span></span> <span data-ttu-id="9de82-221">預設包含所有動作。</span><span class="sxs-lookup"><span data-stu-id="9de82-221">All actions are included by default.</span></span> <span data-ttu-id="9de82-222">若要移除動作，請在工作清單中選取該動作，然後清除 [參數] 頁面上的 **[在工作清單中包含這個動作]** 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="9de82-222">To remove an action, select it in the task list, and then clear the **Include this action in the task list** checkbox on the Parameters page.</span></span>  
  
    6.  <span data-ttu-id="9de82-223">或者，在 **[輸出]** 索引標籤或 **[指令碼]** 索引標籤中檢閱詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="9de82-223">Optionally, review detailed information in the **Output** tab or **Script** tab.</span></span>  
  
         <span data-ttu-id="9de82-224">[輸出] 索引標籤是此工具即將執行之動作的摘要。</span><span class="sxs-lookup"><span data-stu-id="9de82-224">The Output tab is a summary of the actions that will be performed by the tool.</span></span> <span data-ttu-id="9de82-225">此資訊會儲存在記錄檔中： `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\ConfigurationTool\Log`。</span><span class="sxs-lookup"><span data-stu-id="9de82-225">This information is saved in log files at `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\ConfigurationTool\Log`.</span></span>  
  
         <span data-ttu-id="9de82-226">[指令碼] 索引標籤會顯示 PowerShell 指令程式，或參考此工具將執行的 PowerShell 指令碼檔案。</span><span class="sxs-lookup"><span data-stu-id="9de82-226">The Script tab shows the PowerShell cmdlets or references the PowerShell script files that the tool will run.</span></span>  
  
    7.  <span data-ttu-id="9de82-227">按一下 **[驗證]** 來檢查每個動作是否有效。</span><span class="sxs-lookup"><span data-stu-id="9de82-227">Click **Validate** to check whether each action is valid.</span></span> <span data-ttu-id="9de82-228">如果無法使用 **[驗證]** ，表示所有動作都適用於您的系統。</span><span class="sxs-lookup"><span data-stu-id="9de82-228">If **Validate** is not available, it means that all of the actions are valid for your system.</span></span> <span data-ttu-id="9de82-229">如果可以使用 **[驗證]** ，表示您可能已經修改輸入值 (例如，Excel 服務應用程式名稱)，或此工具可能已經判定府執行特定動作。</span><span class="sxs-lookup"><span data-stu-id="9de82-229">If **Validate** is available, you might have modified an input value (for example, the Excel service application name), or the tool might have determined that a particular action cannot be performed.</span></span> <span data-ttu-id="9de82-230">如果無法執行某個動作，您必須排除該動作，或修正造成此動作標示為無效的基礎條件。</span><span class="sxs-lookup"><span data-stu-id="9de82-230">If an action cannot be performed, you must exclude it or fix the underlying conditions that cause the action to be flagged as invalid.</span></span>  
  
        > [!IMPORTANT]  
        >  <span data-ttu-id="9de82-231">您必須一律先處理第一個動作 **[升級伺服器陣列方案]** 。</span><span class="sxs-lookup"><span data-stu-id="9de82-231">The first action, **Upgrade Farm Solution**, must always be processed first.</span></span> <span data-ttu-id="9de82-232">此動作會註冊用來設定伺服器的 PowerShell 指令程式。</span><span class="sxs-lookup"><span data-stu-id="9de82-232">It registers the PowerShell cmdlets that are used to configure the server.</span></span> <span data-ttu-id="9de82-233">如果此動作出現錯誤，請不要繼續。</span><span class="sxs-lookup"><span data-stu-id="9de82-233">If you get an error on this action, do not continue.</span></span> <span data-ttu-id="9de82-234">在處理工作清單中的其他動作之前，請改用此錯誤所提供的資訊診斷並解決問題。</span><span class="sxs-lookup"><span data-stu-id="9de82-234">Instead, use the information provided by the error to diagnose and resolve the problem before processing additional actions in the task list.</span></span>  
  
    8.  <span data-ttu-id="9de82-235">按一下 **[執行]** ，執行適用於此工作的所有動作。</span><span class="sxs-lookup"><span data-stu-id="9de82-235">Click **Run** to perform all of the actions that are valid for this task.</span></span> <span data-ttu-id="9de82-236">只有在通過驗證檢查的情況下，才可以使用 **[執行]** 。</span><span class="sxs-lookup"><span data-stu-id="9de82-236">**Run** is available only after the validation check is passed.</span></span> <span data-ttu-id="9de82-237">當您按一下 [執行] 時，會出現下列警告，提醒您動作是在批次模式下處理：「工具中標示為有效的所有組態設定都會套用到 SharePoint 伺服器陣列。</span><span class="sxs-lookup"><span data-stu-id="9de82-237">When you click **Run**, the following warning appears, reminding you that actions are processed in batch mode: "All of the configuration settings that are flagged as valid in the tool will be applied to the SharePoint farm.</span></span> <span data-ttu-id="9de82-238">您要繼續嗎？」</span><span class="sxs-lookup"><span data-stu-id="9de82-238">Do you want to continue?"</span></span>  
  
    9. <span data-ttu-id="9de82-239">按一下 **[是]** 繼續。</span><span class="sxs-lookup"><span data-stu-id="9de82-239">Click **Yes** to continue.</span></span>  
  
    10. <span data-ttu-id="9de82-240">在伺服器陣列中升級方案和功能可能需要數分鐘才能完成。</span><span class="sxs-lookup"><span data-stu-id="9de82-240">Upgrading solutions and features in the farm can take several minutes to complete.</span></span> <span data-ttu-id="9de82-241">在這段期間內，PowerPivot 資料的連接要求將會失敗，並出現類似「無法重新整理資料」或「嘗試執行要求的動作時發生錯誤」的錯誤。</span><span class="sxs-lookup"><span data-stu-id="9de82-241">During this time, connection requests for PowerPivot data will fail with errors like "Unable to refresh data" or "An error has occurred trying to perform the requested action.</span></span> <span data-ttu-id="9de82-242">請再試一次」。</span><span class="sxs-lookup"><span data-stu-id="9de82-242">Please try again."</span></span> <span data-ttu-id="9de82-243">升級完成後，伺服器將會變成可以使用，而且將不再發生這些錯誤。</span><span class="sxs-lookup"><span data-stu-id="9de82-243">After upgrade is finished, the server will become available and these errors will no longer occur.</span></span>  
  
8.  <span data-ttu-id="9de82-244">針對伺服器陣列中的每個 SQL Server Analysis Services (PowerPivot) 服務**重複此**程式： 1) 執行 SQL Server 安裝程式 2) 執行 PowerPivot 設定工具。</span><span class="sxs-lookup"><span data-stu-id="9de82-244">**Repeat the process** for each SQL Server Analysis Services (PowerPivot) service in the farm: 1) Run SQL Server setup 2) Run the PowerPivot Configuration tool.</span></span>  
  
9. <span data-ttu-id="9de82-245">透過執行升級後的步驟以及檢查伺服器陣列中的 PowerPivot 伺服器版本，驗證升級成功。</span><span class="sxs-lookup"><span data-stu-id="9de82-245">Verify that upgrade succeeded by performing the post-upgrade steps and by checking the version of PowerPivot servers in the farm.</span></span> <span data-ttu-id="9de82-246">如需詳細資訊，請參閱本主題中的 [Post-upgrade verification tasks](#verify) 和下列章節：</span><span class="sxs-lookup"><span data-stu-id="9de82-246">For more information, see [Post-upgrade verification tasks](#verify) in this topic and the following section.</span></span>  
  
10. <span data-ttu-id="9de82-247">**疑難排解錯誤**</span><span class="sxs-lookup"><span data-stu-id="9de82-247">**Troubleshooting errors**</span></span>  
  
     <span data-ttu-id="9de82-248">您可以在 [參數] 窗格中檢視每個動作的錯誤資訊。</span><span class="sxs-lookup"><span data-stu-id="9de82-248">You can view error information in the Parameters pane for each action.</span></span>  
  
     <span data-ttu-id="9de82-249">針對與方案部署或撤銷相關的問題，請確認已啟動 SharePoint 2010 Administrator 服務。</span><span class="sxs-lookup"><span data-stu-id="9de82-249">For problems related to solution deployment or retraction, verify the SharePoint 2010 Administrator service is started.</span></span> <span data-ttu-id="9de82-250">此服務會執行觸發伺服器陣列中組態變更的計時器作業。</span><span class="sxs-lookup"><span data-stu-id="9de82-250">This service runs the timer jobs that trigger configuration changes in a farm.</span></span> <span data-ttu-id="9de82-251">如果該服務未執行，方案部署或撤銷將會失敗。</span><span class="sxs-lookup"><span data-stu-id="9de82-251">If the service is not running, solution deployment or retraction will fail.</span></span> <span data-ttu-id="9de82-252">持續性錯誤指的是現有的部署或撤銷作業已經在佇列中，因此會攔截組態工具的其他動作。</span><span class="sxs-lookup"><span data-stu-id="9de82-252">Persistent errors indicate that an existing deployment or retraction job is already in the queue and blocking further action from the configuration tool.</span></span>  
  
    1.  <span data-ttu-id="9de82-253">以管理員身分啟動 SharePoint 2010 管理命令介面，然後執行下列命令來檢視佇列中的作業：</span><span class="sxs-lookup"><span data-stu-id="9de82-253">Start the SharePoint 2010 Management Shell as an administrator and then run the following command to view jobs in the queue:</span></span>  
  
        ```cmd
        stsadm -o enumdeployments  
        ```  
  
    2.  <span data-ttu-id="9de82-254">檢閱現有部署的下列資訊：[類型] 是 [撤銷] 或 [部署]、[檔案] 是 powerpivotwebapp.wsp 或 powerpivotfarm.wsp。</span><span class="sxs-lookup"><span data-stu-id="9de82-254">Review existing deployments for the following information: **Type** is Retraction or Deployment, **File** is powerpivotwebapp.wsp or powerpivotfarm.wsp.</span></span>  
  
    3.  <span data-ttu-id="9de82-255">針對與 PowerPivot 方案相關的部署或若是方案撤銷，複製**JobId**的 GUID 值，然後將它貼入下列命令 (使用 Shell 的 [編輯] 功能表上的 [標記]、[複製] 和 [貼上] 命令，將 GUID 複製) ：</span><span class="sxs-lookup"><span data-stu-id="9de82-255">For deployments or retractions related to PowerPivot solutions, copy the GUID value for **JobId** and then paste it into the following command (use the Mark, Copy, and Paste commands on the Shell's Edit menu to copy the GUID):</span></span>  
  
        ```cmd
        stsadm -o canceldeployment -id "<GUID>"  
        ```  
  
    4.  <span data-ttu-id="9de82-256">依序按一下 **[驗證]** 和 **[執行]** ，重試組態工具中的工作。</span><span class="sxs-lookup"><span data-stu-id="9de82-256">Retry the task in the configuration tool by clicking **Validate** followed by **Run**.</span></span>  
  
     <span data-ttu-id="9de82-257">至於其他所有錯誤，請檢查 ULS 記錄檔。</span><span class="sxs-lookup"><span data-stu-id="9de82-257">For all other errors, check the ULS logs.</span></span> <span data-ttu-id="9de82-258">如需詳細資訊，請參閱[設定及查看 SharePoint 記錄檔和診斷記錄 &#40;PowerPivot for SharePoint&#41;](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/configure-and-view-sharepoint-and-diagnostic-logging)。</span><span class="sxs-lookup"><span data-stu-id="9de82-258">For more information, see [Configure and View SharePoint Log Files  and Diagnostic Logging &#40;PowerPivot for SharePoint&#41;](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/configure-and-view-sharepoint-and-diagnostic-logging).</span></span>  
  

  
##  <a name="workbooks"></a><a name="bkmk_workbooks"></a> <span data-ttu-id="9de82-259">活頁簿</span><span class="sxs-lookup"><span data-stu-id="9de82-259">Workbooks</span></span>  
 <span data-ttu-id="9de82-260">升級伺服器不一定會升級伺服器上執行的 PowerPivot 活頁簿，但是使用舊版 PowerPivot for Excel 建立的舊活頁簿仍可如常運作，並使用該版提供的功能。</span><span class="sxs-lookup"><span data-stu-id="9de82-260">Upgrading a server does not necessarily upgrade the PowerPivot workbooks that run on it, but older workbooks created in the previous version of PowerPivot for Excel will continue to work as before, using the features available in that release.</span></span> <span data-ttu-id="9de82-261">活頁簿可以維持運作，是由於已升級的伺服器具有屬於舊版安裝的 Analysis Services OLE DB 提供者版本所致。</span><span class="sxs-lookup"><span data-stu-id="9de82-261">Workbooks remain functional because an upgraded server has the version of the Analysis Services OLE DB provider that was part of the previous installation.</span></span>  
  
  
  
##  <a name="data-refresh"></a><a name="bkmk_datarefresh"></a> <span data-ttu-id="9de82-262">資料重新整理</span><span class="sxs-lookup"><span data-stu-id="9de82-262">Data Refresh</span></span>  
 <span data-ttu-id="9de82-263">升級會影響資料重新整理作業。</span><span class="sxs-lookup"><span data-stu-id="9de82-263">Upgrade will impact data refresh operations.</span></span> <span data-ttu-id="9de82-264">伺服器的排程資料重新整理僅適用於符合伺服器版本的活頁簿。</span><span class="sxs-lookup"><span data-stu-id="9de82-264">Scheduled data refresh on the server is available only for workbooks that match the server version.</span></span> <span data-ttu-id="9de82-265">如果您裝載舊版的活頁簿，資料重新整理可能不再適用於這些活頁簿。</span><span class="sxs-lookup"><span data-stu-id="9de82-265">If you are hosting workbooks from the previous version, data refresh might no longer work for those workbooks.</span></span> <span data-ttu-id="9de82-266">若要重新啟用資料重新整理，您必須升級活頁簿。</span><span class="sxs-lookup"><span data-stu-id="9de82-266">To re-enable data refresh, you must upgrade the workbooks.</span></span> <span data-ttu-id="9de82-267">您可以在 PowerPivot for Excel 中升級每個活頁簿，或是針對 SharePoint 2010 中的資料重新整理功能啟用自動升級。</span><span class="sxs-lookup"><span data-stu-id="9de82-267">You can upgrade each workbook manually in PowerPivot for Excel, or enable the auto-upgrade for data refresh feature in SharePoint 2010.</span></span> <span data-ttu-id="9de82-268">自動升級會在執行資料重新整理之前將活頁簿升級為最新版本，讓資料重新整理作業依排程執行。</span><span class="sxs-lookup"><span data-stu-id="9de82-268">Auto-upgrade will upgrade a workbook to the current version prior to running data refresh, allowing data refresh operations to remain on schedule.</span></span>  
  

  
##  <a name="verify-the-versions-of-powerpivot-components-and-services"></a><a name="bkmk_verify_versions"></a><span data-ttu-id="9de82-269">確認 PowerPivot 元件和服務的版本</span><span class="sxs-lookup"><span data-stu-id="9de82-269">Verify the Versions of PowerPivot Components and Services</span></span>  
 <span data-ttu-id="9de82-270">[!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 系統服務和 Analysis Services 的所有執行個體必須是相同版本。</span><span class="sxs-lookup"><span data-stu-id="9de82-270">All instances of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] System Service and Analysis Services must be the same version.</span></span> <span data-ttu-id="9de82-271">若要確認所有伺服器元件都是相同的版本，請檢查以下版本資訊：</span><span class="sxs-lookup"><span data-stu-id="9de82-271">To verify that all server components are at the same version, check version information for the following:</span></span>  
  
### <a name="verify-the-version-of-powerpivot-solutions-and-the-powerpivot-system-service"></a><span data-ttu-id="9de82-272">驗證 PowerPivot 方案和 PowerPivot 系統服務的版本</span><span class="sxs-lookup"><span data-stu-id="9de82-272">Verify the version of PowerPivot Solutions and the PowerPivot System Service</span></span>  
 <span data-ttu-id="9de82-273">執行下列 PowerShell 命令：</span><span class="sxs-lookup"><span data-stu-id="9de82-273">Run the following PowerShell command:</span></span>  
  
```powershell
Get-PowerPivotSystemService  
```  
  
 <span data-ttu-id="9de82-274">驗證 **CurrentSolutionVersion**。</span><span class="sxs-lookup"><span data-stu-id="9de82-274">Verify the **CurrentSolutionVersion**.</span></span> [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]<span data-ttu-id="9de82-275">為版本 12.0. \<major build> 。\<minor build></span><span class="sxs-lookup"><span data-stu-id="9de82-275">is version 12.0.\<major build>.\<minor build></span></span>  
  
### <a name="verify-the-version-of-the-analysis-services-windows-service"></a><span data-ttu-id="9de82-276">驗證 Analysis Services Windows 服務的版本</span><span class="sxs-lookup"><span data-stu-id="9de82-276">Verify the version of the Analysis Services Windows Service</span></span>  
 <span data-ttu-id="9de82-277">如果您只有升級 SharePoint 2010 伺服陣列中的部分 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 伺服器，則未升級之伺服器上的 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 執行個體將會比預期在伺服器陣列中的版本還舊。</span><span class="sxs-lookup"><span data-stu-id="9de82-277">If you upgraded only some of your [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] servers in a SharePoint 2010 farm, the instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] on un-upgraded servers will be older than the version expected in the farm.</span></span> <span data-ttu-id="9de82-278">您必須將所有的伺服器升級至相同版本，才可以加以使用。</span><span class="sxs-lookup"><span data-stu-id="9de82-278">You will need to upgrade all of your servers to the same version in order for them to be usable.</span></span> <span data-ttu-id="9de82-279">使用下列其中一種方法來驗證每部電腦上 (PowerPivot) Windows 服務的 SQL Server Analysis Services 版本。</span><span class="sxs-lookup"><span data-stu-id="9de82-279">Use one of the following methods to verify the version of the SQL Server Analysis Services (PowerPivot) Windows service on each computer.</span></span>  
  
 <span data-ttu-id="9de82-280">**Windows 檔案總管**：</span><span class="sxs-lookup"><span data-stu-id="9de82-280">**Windows File Explorer**:</span></span>  
  
1.  <span data-ttu-id="9de82-281">瀏覽至 **Bin** 資料夾，尋找 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 執行個體。</span><span class="sxs-lookup"><span data-stu-id="9de82-281">Navigate to the **Bin** folder for the [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] instance.</span></span> <span data-ttu-id="9de82-282">例如 `C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\bin` 。</span><span class="sxs-lookup"><span data-stu-id="9de82-282">For example `C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\bin`.</span></span>  
  
2.  <span data-ttu-id="9de82-283">以滑鼠右鍵按一下 `msmdsrv.exe`，然後選取 **[屬性]** 。</span><span class="sxs-lookup"><span data-stu-id="9de82-283">Right-click `msmdsrv.exe`, and select **Properties**.</span></span>  
  
3.  <span data-ttu-id="9de82-284">按一下 [詳細資訊] 。</span><span class="sxs-lookup"><span data-stu-id="9de82-284">Click **Details**.</span></span>  
  
4.  [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]<span data-ttu-id="9de82-285">檔案版本應為 \<major build> 12.00 ... \<minor build></span><span class="sxs-lookup"><span data-stu-id="9de82-285">file version should be 12.00.\<major build>.\<minor build>.</span></span>  
  
5.  <span data-ttu-id="9de82-286">驗證這個編號與 PowerPivot 方案和系統服務版本相同。</span><span class="sxs-lookup"><span data-stu-id="9de82-286">Verify that this number is identical to the PowerPivot solution and system service version.</span></span>  
  
 <span data-ttu-id="9de82-287">**服務啟動資訊：**</span><span class="sxs-lookup"><span data-stu-id="9de82-287">**Service start information:**</span></span>  
  
 <span data-ttu-id="9de82-288">當 PowerPivot 服務啟動時，會將版本資訊寫入至 Windows 事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="9de82-288">When the PowerPivot service starts, it writes version information into the Windows event log.</span></span>  
  
1.  <span data-ttu-id="9de82-289">執行 Windows `eventvwr`</span><span class="sxs-lookup"><span data-stu-id="9de82-289">Run Windows `eventvwr`</span></span>  
  
2.  <span data-ttu-id="9de82-290">建立來源 `MSOLAP$POWERPIVOT`的篩選。</span><span class="sxs-lookup"><span data-stu-id="9de82-290">Create a filter for source `MSOLAP$POWERPIVOT`.</span></span>  
  
3.  <span data-ttu-id="9de82-291">尋找類似下列的資訊層級事件</span><span class="sxs-lookup"><span data-stu-id="9de82-291">Look for an information level event similar to the following</span></span>  
  
     <span data-ttu-id="9de82-292">服務已啟動。</span><span class="sxs-lookup"><span data-stu-id="9de82-292">Service started.</span></span> <span data-ttu-id="9de82-293">Microsoft SQL Server Analysis Services 64 Bit Evaluation (x64) RTM **12.0.2000.8**。</span><span class="sxs-lookup"><span data-stu-id="9de82-293">Microsoft SQL Server Analysis Services 64 Bit Evaluation (x64) RTM **12.0.2000.8**.</span></span>  
  
 <span data-ttu-id="9de82-294">**使用 PowerShell 來驗證檔案版本。**</span><span class="sxs-lookup"><span data-stu-id="9de82-294">**Use PowerShell to verify file version.**</span></span>  
  
 <span data-ttu-id="9de82-295">您可以使用 PowerShell 來驗證產品版本。</span><span class="sxs-lookup"><span data-stu-id="9de82-295">You can use PowerShell to verify the product version.</span></span> <span data-ttu-id="9de82-296">如果您想要編寫指令碼或自動化版本驗證，PowerShell 是個好選項。</span><span class="sxs-lookup"><span data-stu-id="9de82-296">PowerShell is a good option if you want to script or automate version verification.</span></span>  
  
```powershell
(Get-ChildItem "C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT2000\OLAP\bin\msmdsrv.exe").VersionInfo  
```  
  
 <span data-ttu-id="9de82-297">上述 PowerShell 命令會傳回類似下列資訊：</span><span class="sxs-lookup"><span data-stu-id="9de82-297">The above PowerShell command returns information similar to the following:</span></span>  
  
 <span data-ttu-id="9de82-298">ProductVersion   FileVersion           FileName</span><span class="sxs-lookup"><span data-stu-id="9de82-298">ProductVersion   FileVersion           FileName</span></span>  
  
 <span data-ttu-id="9de82-299">**12.0.2000.8** 2014.0120.200    C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT2000\OLAP\bin\msmdsrv.exe</span><span class="sxs-lookup"><span data-stu-id="9de82-299">**12.0.2000.8** 2014.0120.200    C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT2000\OLAP\bin\msmdsrv.exe</span></span>  
  
### <a name="verify-the-msolap-data-provider-version-on-sharepoint"></a><span data-ttu-id="9de82-300">驗證 SharePoint 上的 MSOLAP 資料提供者版本</span><span class="sxs-lookup"><span data-stu-id="9de82-300">Verify the MSOLAP Data Provider Version on SharePoint</span></span>  
 <span data-ttu-id="9de82-301">使用下列指示即可查看 Excel Services 信任的 Analysis Services OLE DB 提供者版本。</span><span class="sxs-lookup"><span data-stu-id="9de82-301">Use the following instructions to check which versions of the Analysis Services OLE DB providers are trusted by Excel Services.</span></span> <span data-ttu-id="9de82-302">您必須是伺服陣列或服務應用程式系統管理員，才能檢查 Excel Services 信任的資料提供者設定。</span><span class="sxs-lookup"><span data-stu-id="9de82-302">You must be a farm or service application administrator to check the trusted data provider settings of Excel Services.</span></span>  
  
1.  <span data-ttu-id="9de82-303">在 [管理中心] 的 [應用程式管理] 中，按一下 **[管理服務應用程式]** 。</span><span class="sxs-lookup"><span data-stu-id="9de82-303">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="9de82-304">按一下 Excel Services 服務應用程式的名稱，例如 **[ExcelServiceApp1]** 。</span><span class="sxs-lookup"><span data-stu-id="9de82-304">Click the name of the Excel Services service application, for example **ExcelServiceApp1**.</span></span>  
  
3.  <span data-ttu-id="9de82-305">按一下 **[信任的資料提供者]** 。</span><span class="sxs-lookup"><span data-stu-id="9de82-305">Click **Trusted Data Providers**.</span></span> <span data-ttu-id="9de82-306">您應該會看到 MSOLAP.5 (Microsoft OLE DB Provider for OLAP Services 11.0)。</span><span class="sxs-lookup"><span data-stu-id="9de82-306">You should see MSOLAP.5 (Microsoft OLE DB Provider for OLAP Services 11.0).</span></span> <span data-ttu-id="9de82-307">如果您已升級 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 安裝，也會看到舊版的 MSOLAP.4。</span><span class="sxs-lookup"><span data-stu-id="9de82-307">If you upgraded your [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation, you will also see MSOLAP.4 from the previous version.</span></span>  
  
4.  <span data-ttu-id="9de82-308">如需詳細資訊，請參閱 [加入 MSOLAP.5 做為 Excel Services 中受信任的資料提供者](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/add-msolap-5-as-a-trusted-data-provider-in-excel-services)。</span><span class="sxs-lookup"><span data-stu-id="9de82-308">For more information, see [Add MSOLAP.5 as a Trusted Data Provider in Excel Services](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/add-msolap-5-as-a-trusted-data-provider-in-excel-services).</span></span>  
  
 <span data-ttu-id="9de82-309">MSOLAP.4 會描述為 Microsoft OLE DB Provider for OLAP Services 10.0。</span><span class="sxs-lookup"><span data-stu-id="9de82-309">MSOLAP.4 is described as the Microsoft OLE DB Provider for OLAP Services 10.0.</span></span> <span data-ttu-id="9de82-310">這個版本可能是與 Excel Services 一併安裝的 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 預設版本，或者是 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 版本。</span><span class="sxs-lookup"><span data-stu-id="9de82-310">This version might be the default version from [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] that is installed with Excel Services, or it might be the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version.</span></span> <span data-ttu-id="9de82-311">SharePoint 安裝的預設版本不支援 PowerPivot 資料存取。</span><span class="sxs-lookup"><span data-stu-id="9de82-311">The default version that SharePoint installs does not support PowerPivot data access.</span></span> <span data-ttu-id="9de82-312">您必須擁有 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 版本或更新的版本，才能連接 SharePoint 上的 PowerPivot 活頁簿。</span><span class="sxs-lookup"><span data-stu-id="9de82-312">You must have the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version or later to connect to PowerPivot workbooks on SharePoint.</span></span> <span data-ttu-id="9de82-313">若要確認您擁有 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 版本，請使用上一節中說明如何檢視檔案屬性以確認版本的指示。</span><span class="sxs-lookup"><span data-stu-id="9de82-313">To verify you have the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version, use the instructions in the previous section that explain how to verify the version by viewing file properties.</span></span>  
  
### <a name="verify-the-adomdnet-data-provider-version"></a><span data-ttu-id="9de82-314">驗證 ADOMD.NET 資料提供者版本</span><span class="sxs-lookup"><span data-stu-id="9de82-314">Verify the ADOMD.NET Data Provider Version</span></span>  
 <span data-ttu-id="9de82-315">使用下列指示來檢查所安裝的 ADOMD.NET 版本。</span><span class="sxs-lookup"><span data-stu-id="9de82-315">Use the following instructions to check which version of ADOMD.NET is installed.</span></span> <span data-ttu-id="9de82-316">您必須是伺服陣列或服務應用程式系統管理員，才能檢查 Excel Services 信任的資料提供者設定。</span><span class="sxs-lookup"><span data-stu-id="9de82-316">You must be a farm or service application administrator to check the trusted data provider settings of Excel Services.</span></span>  
  
1.  <span data-ttu-id="9de82-317">在 SharePoint 應用程式伺服器上，瀏覽至 `c:\Windows\Assembly`。</span><span class="sxs-lookup"><span data-stu-id="9de82-317">On your SharePoint application server, browse to `c:\Windows\Assembly`.</span></span>  
  
2.  <span data-ttu-id="9de82-318">依組件名稱排序，並搜尋 **Microsoft.Analysis Services.Adomd.Client**。</span><span class="sxs-lookup"><span data-stu-id="9de82-318">Sort by assembly name and find the **Microsoft.Analysis Services.Adomd.Client**.</span></span>  
  
3.  <span data-ttu-id="9de82-319">確認您的版本為 12.0. \<build number> 。</span><span class="sxs-lookup"><span data-stu-id="9de82-319">Verify you have version 12.0.\<build number>.</span></span>  
  

##  <a name="upgrading-multiple-powerpivot-for-sharepoint-servers-in-a-sharepoint-farm"></a><a name="geminifarm"></a><span data-ttu-id="9de82-320">升級 SharePoint 伺服器陣列中的多部 PowerPivot for SharePoint 伺服器</span><span class="sxs-lookup"><span data-stu-id="9de82-320">Upgrading Multiple PowerPivot for SharePoint Servers in a SharePoint Farm</span></span>  
 <span data-ttu-id="9de82-321">在包含多部 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 伺服器的多重伺服器拓撲中，所有伺服器執行個體和元件都必須是相同版本。</span><span class="sxs-lookup"><span data-stu-id="9de82-321">In a multi-server topology that includes more than one [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] server, all server instances and components must be the same version.</span></span> <span data-ttu-id="9de82-322">執行最新軟體版本的伺服器會設定伺服陣列中所有伺服器的層級。</span><span class="sxs-lookup"><span data-stu-id="9de82-322">The server that runs the highest version of the software sets the level for all servers in the farm.</span></span> <span data-ttu-id="9de82-323">如果您只要升級部分伺服器，執行較舊版軟體的伺服器在升級之前將變成無法使用。</span><span class="sxs-lookup"><span data-stu-id="9de82-323">If you upgrade just some of the servers, the ones that are running older versions of the software will become unavailable until they are also upgraded.</span></span>  
  
 <span data-ttu-id="9de82-324">升級第一部伺服器之後，尚未升級的其他伺服器 **將會變成無法使用**。</span><span class="sxs-lookup"><span data-stu-id="9de82-324">After you upgrade the first server, additional servers that are not yet upgraded **will become unavailable**.</span></span> <span data-ttu-id="9de82-325">在所有伺服器執行相同層級之後，即可恢復使用。</span><span class="sxs-lookup"><span data-stu-id="9de82-325">Availability is restored after all servers run at the same level.</span></span>  
  
 <span data-ttu-id="9de82-326">SQL Server 安裝程式會就地升級實體電腦上的 PowerPivot 方案檔案，但是若要升級伺服器陣列使用的方案，則必須使用本主題前面章節中所描述的 PowerPivot 組態工具。</span><span class="sxs-lookup"><span data-stu-id="9de82-326">SQL Server Setup upgrades the PowerPivot solution files in place on the physical computer, but to upgrade the solutions in use by the farm, you must use the PowerPivot Configuration Tool described in a previous section of this topic..</span></span>  

##  <a name="applying-a-qfe-to-a-powerpivot-instance-in-the-farm"></a><a name="qfe"></a><span data-ttu-id="9de82-327">將 QFE 套用至伺服器陣列中的 PowerPivot 實例</span><span class="sxs-lookup"><span data-stu-id="9de82-327">Applying a QFE to a PowerPivot instance in the farm</span></span>  
 <span data-ttu-id="9de82-328">修補 PowerPivot for SharePoint 伺服器會將現有的程式檔案更新成包含特定問題修正的較新版本。</span><span class="sxs-lookup"><span data-stu-id="9de82-328">Patching a PowerPivot for SharePoint server updates existing program files with a newer version that includes a fix for a specific problem.</span></span> <span data-ttu-id="9de82-329">將 QFE 套用至多重伺服器拓撲時，沒有您必須先開始的主要伺服器。</span><span class="sxs-lookup"><span data-stu-id="9de82-329">When applying a QFE to a multi-server topology, there is no primary server that you must begin with.</span></span> <span data-ttu-id="9de82-330">只要您將相同的 QFE 套用至伺服陣列中的其他 PowerPivot 伺服器，就可以從任何伺服器開始。</span><span class="sxs-lookup"><span data-stu-id="9de82-330">You can start with any server as long as you apply the same QFE to the other PowerPivot servers in the farm.</span></span>  
  
 <span data-ttu-id="9de82-331">套用 QFE 時，您也必須在伺服器陣列組態資料庫中執行更新伺服器版本資訊的組態設定。</span><span class="sxs-lookup"><span data-stu-id="9de82-331">When you apply the QFE, you must also perform a configuration step that updates the server version information in the farm configuration database.</span></span> <span data-ttu-id="9de82-332">已修補之伺服器的版本會變成預期的伺服陣列新版本。</span><span class="sxs-lookup"><span data-stu-id="9de82-332">The version of the patched server becomes the new expected version for the farm.</span></span> <span data-ttu-id="9de82-333">在所有機器上套用並設定 QFE 之前，沒有 QFE 的 PowerPivot for SharePoint 執行個體將無法用於處理 PowerPivot 資料的要求。</span><span class="sxs-lookup"><span data-stu-id="9de82-333">Until the QFE is applied and configured across all machines, the PowerPivot for SharePoint instances that do not have the QFE will be unavailable to handle requests for PowerPivot data.</span></span>  
  
 <span data-ttu-id="9de82-334">為確保正確套用並設定 QFE，請遵循下列指示進行：</span><span class="sxs-lookup"><span data-stu-id="9de82-334">To ensure the QFE is applied and configured correctly, follow these instructions:</span></span>  
  
1.  <span data-ttu-id="9de82-335">使用隨附在 QFE 中的指示，安裝修補程式。</span><span class="sxs-lookup"><span data-stu-id="9de82-335">Install the patch using the instructions that are provided with the QFE.</span></span>  
  
2.  <span data-ttu-id="9de82-336">啟動 PowerPivot 組態工具。</span><span class="sxs-lookup"><span data-stu-id="9de82-336">Start the PowerPivot Configuration Tool.</span></span>  
  
3.  <span data-ttu-id="9de82-337">按一下 **[升級功能、服務、應用程式和方案]** ，然後按一下 **[確定]** 。</span><span class="sxs-lookup"><span data-stu-id="9de82-337">Click **Upgrade Features, Services, Applications and Solutions**, and then click **OK**.</span></span>  
  
4.  <span data-ttu-id="9de82-338">檢閱升級工作中所包含的動作，然後按一下 **[驗證]** 。</span><span class="sxs-lookup"><span data-stu-id="9de82-338">Review the actions that are included in the upgrade task, and then click **Validate**.</span></span>  
  
5.  <span data-ttu-id="9de82-339">按一下 **[執行]** 套用動作。</span><span class="sxs-lookup"><span data-stu-id="9de82-339">Click **Run** to apply the actions.</span></span>  
  
6.  <span data-ttu-id="9de82-340">針對伺服器陣列中的其他 PowerPivot for SharePoint 執行個體，重複這個動作。</span><span class="sxs-lookup"><span data-stu-id="9de82-340">Repeat for additional PowerPivot for SharePoint instances in the farm.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="9de82-341">在多重伺服器部署中，請務必先修補並設定每個執行個體，然後再繼續進行下一部機器。</span><span class="sxs-lookup"><span data-stu-id="9de82-341">In a multi-server deployment, be sure to both patch and configure each instance before continuing to the next machine.</span></span> <span data-ttu-id="9de82-342">PowerPivot 組態工具必須先完成目前執行個體的升級工作，才能移到下一個執行個體。</span><span class="sxs-lookup"><span data-stu-id="9de82-342">The PowerPivot Configuration Tool must complete the upgrade task for the current instance before you move on to the next instance.</span></span>  
  
 <span data-ttu-id="9de82-343">若要檢查伺服器陣列中服務的版本資訊，請在管理中心中的 [升級與修補管理] 區段中，使用 **[檢查產品與修補程式安裝狀態]** 頁面。</span><span class="sxs-lookup"><span data-stu-id="9de82-343">To check version information for services in the farm, use the **Check product and patch installation status** page in the Upgrade and Patch Management section in Central Administration.</span></span>  
  
##  <a name="post-upgrade-verification-tasks"></a><a name="verify"></a> <span data-ttu-id="9de82-344">升級後的驗證工作</span><span class="sxs-lookup"><span data-stu-id="9de82-344">Post-upgrade verification tasks</span></span>  
 <span data-ttu-id="9de82-345">升級完成後，使用下列步驟來驗證伺服器正常運作。</span><span class="sxs-lookup"><span data-stu-id="9de82-345">After upgrade is complete, use the following steps to verify the server is operational.</span></span>  
  
|<span data-ttu-id="9de82-346">Task</span><span class="sxs-lookup"><span data-stu-id="9de82-346">Task</span></span>|<span data-ttu-id="9de82-347">連結</span><span class="sxs-lookup"><span data-stu-id="9de82-347">Link</span></span>|  
|----------|----------|  
|<span data-ttu-id="9de82-348">確認伺服器在執行 PowerPivot for SharePoint 的所有電腦上執行。</span><span class="sxs-lookup"><span data-stu-id="9de82-348">Verify the service is running on all computers that run PowerPivot for SharePoint.</span></span>|[<span data-ttu-id="9de82-349">啟動或停止 PowerPivot for SharePoint 伺服器</span><span class="sxs-lookup"><span data-stu-id="9de82-349">Start or Stop a PowerPivot for SharePoint Server</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/start-or-stop-a-power-pivot-for-sharepoint-server)|  
|<span data-ttu-id="9de82-350">確認網站集合層級的功能啟用。</span><span class="sxs-lookup"><span data-stu-id="9de82-350">Verify feature activation at the site collection level.</span></span>|[<span data-ttu-id="9de82-351">在管理中心為網站集合啟用 PowerPivot 功能整合</span><span class="sxs-lookup"><span data-stu-id="9de82-351">Activate PowerPivot Feature Integration for Site Collections in Central Administration</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/activate-power-pivot-integration-for-site-collections-in-ca)|  
|<span data-ttu-id="9de82-352">確認個別的 PowerPivot 活頁簿會透過開啟活頁簿，並按一下篩選與交叉分析篩選器起始查詢來正確載入。</span><span class="sxs-lookup"><span data-stu-id="9de82-352">Verify individual PowerPivot workbooks are loading properly by opening a workbook and clicking on filters and slicers to initiate a query.</span></span>|<span data-ttu-id="9de82-353">檢查快取的檔案是否存在硬碟上。</span><span class="sxs-lookup"><span data-stu-id="9de82-353">Check for the presence of cached files on the hard drive.</span></span> <span data-ttu-id="9de82-354">快取的檔案可確認資料檔案已在實體伺服器上載入。</span><span class="sxs-lookup"><span data-stu-id="9de82-354">A cached file confirms that the data file was loaded on that physical server.</span></span> <span data-ttu-id="9de82-355">尋找 c:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\Backup 資料夾中的快取檔案。</span><span class="sxs-lookup"><span data-stu-id="9de82-355">Look for cached files in the c:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\Backup folder.</span></span>|  
|<span data-ttu-id="9de82-356">在設定為資料重新整理的所選活頁簿上測試資料重新整理。</span><span class="sxs-lookup"><span data-stu-id="9de82-356">Test data refresh on selected workbooks that are configured for data refresh.</span></span>|<span data-ttu-id="9de82-357">測試資料重新整理最簡單的方式就是修改資料重新整理排程，也就是選擇 **[並且盡快重新整理]** 核取方塊，讓資料重新整理立即執行。</span><span class="sxs-lookup"><span data-stu-id="9de82-357">The easiest way to test data refresh is to modify a data refresh schedule, choosing the **Also refresh as soon as possible** checkbox so that data refresh runs immediately.</span></span> <span data-ttu-id="9de82-358">此步驟將判斷目前活頁簿的資料重新整理是否成功。</span><span class="sxs-lookup"><span data-stu-id="9de82-358">This step will determine whether data refresh is successful for the current workbook.</span></span> <span data-ttu-id="9de82-359">針對其他常用的活頁簿重複這些步驟以確保資料重新整理運作正常。</span><span class="sxs-lookup"><span data-stu-id="9de82-359">Repeat these steps for other frequently used workbooks to ensure that data refresh is functional.</span></span> <span data-ttu-id="9de82-360">如需排程資料重新整理的詳細資訊，請參閱排程資料重新整理[&#40;PowerPivot for SharePoint&#41;](../../../2014/analysis-services/schedule-a-data-refresh-powerpivot-for-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="9de82-360">For more information about scheduling data refresh, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](../../../2014/analysis-services/schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>|  
|<span data-ttu-id="9de82-361">一段時間之後，監視 PowerPivot 管理儀表板中的資料重新整理報表以確認沒有資料重新整理錯誤。</span><span class="sxs-lookup"><span data-stu-id="9de82-361">Over time, monitor the data refresh reports in PowerPivot Management Dashboard to confirm there are no data refresh errors.</span></span>|[<span data-ttu-id="9de82-362">PowerPivot 管理儀表板和使用量資料</span><span class="sxs-lookup"><span data-stu-id="9de82-362">PowerPivot Management Dashboard and Usage Data</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-management-dashboard-and-usage-data)|  
  
 <span data-ttu-id="9de82-363">如需如何設定 PowerPivot 設定和功能的詳細資訊，請參閱[管理中心的 Powerpivot 伺服器管理和](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-server-administration-and-configuration-in-central-administration)設定。</span><span class="sxs-lookup"><span data-stu-id="9de82-363">For more information about how to configure PowerPivot settings and features, see [PowerPivot Server Administration and Configuration in Central Administration](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-server-administration-and-configuration-in-central-administration).</span></span>  
  
 <span data-ttu-id="9de82-364">如需引導您完成所有安裝後設定工作的逐步指示，請參閱[初始設定 &#40;PowerPivot for SharePoint&#41;](../../../2014/sql-server/install/initial-configuration-powerpivot-for-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="9de82-364">For step-by-step instructions that guide you through all of the post-installation configuration tasks, see [Initial Configuration &#40;PowerPivot for SharePoint&#41;](../../../2014/sql-server/install/initial-configuration-powerpivot-for-sharepoint.md).</span></span>  

## <a name="see-also"></a><span data-ttu-id="9de82-365">另請參閱</span><span class="sxs-lookup"><span data-stu-id="9de82-365">See Also</span></span>  
 <span data-ttu-id="9de82-366">[SQL Server 2014 版本所支援的功能](../../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md) </span><span class="sxs-lookup"><span data-stu-id="9de82-366">[Features Supported by the Editions of SQL Server 2014](../../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md) </span></span>  
 [<span data-ttu-id="9de82-367">PowerPivot for SharePoint 2010 安裝</span><span class="sxs-lookup"><span data-stu-id="9de82-367">PowerPivot for SharePoint 2010 Installation</span></span>](../../../2014/sql-server/install/powerpivot-for-sharepoint-2010-installation.md)  
