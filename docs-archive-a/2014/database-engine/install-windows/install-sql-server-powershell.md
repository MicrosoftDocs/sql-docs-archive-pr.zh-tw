---
title: 安裝 SQL Server PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: install
ms.topic: conceptual
ms.assetid: 854c0b2f-02d2-46a4-a8cc-6b7a5d191cf8
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 53a2a295e6c38fead219e876cfedf040c2188b52
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87688185"
---
# <a name="install-sql-server-powershell"></a><span data-ttu-id="5f1dc-102">安裝 SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="5f1dc-102">Install SQL Server PowerShell</span></span>
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="5f1dc-103">安裝程式若偵測到您選取了內含 PowerShell 元件的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 功能，但卻未安裝 Windows PowerShell 2.0，其將會停止。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-103">Setup will stop if it detects that you have selected [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] features that include PowerShell components, but Windows PowerShell 2.0 is not installed.</span></span> <span data-ttu-id="5f1dc-104">您必須使用 Windows Management Framework 安裝 Windows PowerShell 2.0，然後重新執行安裝程式。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-104">You must install PowerShell by using the Windows Management Framework, and then rerun Setup.</span></span>  
  
## <a name="installing-ssnoversion-powershell-support"></a><span data-ttu-id="5f1dc-105">安裝 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell 支援</span><span class="sxs-lookup"><span data-stu-id="5f1dc-105">Installing [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell Support</span></span>  
 <span data-ttu-id="5f1dc-106">您可以使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安裝程式安裝提供 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Windows PowerShell 支援的軟體。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-106">You install the software that provides [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] support for Windows PowerShell by using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Setup.</span></span> <span data-ttu-id="5f1dc-107">當您選取需要 PowerShell 支援的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 功能時，安裝程式會檢查有無安裝 Windows PowerShell 2.0。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-107">When you select any [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] features that require PowerShell support, Setup checks that Windows PowerShell 2.0 is installed.</span></span> <span data-ttu-id="5f1dc-108">PowerShell 2.0 若已存在，安裝程式將會安裝下列 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell 元件：</span><span class="sxs-lookup"><span data-stu-id="5f1dc-108">If PowerShell 2.0 is present, Setup then installs the following [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell components:</span></span>  
  
-   <span data-ttu-id="5f1dc-109">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell 嵌入式管理單元。這些嵌入式管理單元是可實作 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]之兩種 Windows PowerShell 支援的 dll 檔案：</span><span class="sxs-lookup"><span data-stu-id="5f1dc-109">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell snap-ins. The snap-ins are dll files that implement two types of Windows PowerShell support for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]:</span></span>  
  
    -   <span data-ttu-id="5f1dc-110">一組 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 指令程式。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-110">A set of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cmdlets.</span></span> <span data-ttu-id="5f1dc-111">指令程式是實作特定動作的命令。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-111">Cmdlets are commands that implement a specific action.</span></span> <span data-ttu-id="5f1dc-112">例如 **Invoke-Sqlcmd** 會執行 [!INCLUDE[tsql](../../includes/tsql-md.md)] 或 XQuery 指令碼 (此指令碼也可使用 **sqlcmd** 公用程式加以執行)，而 **Invoke-PolicyEvaluation** 則會報告 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 物件是否符合原則型管理原則。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-112">For example, **Invoke-Sqlcmd** runs a [!INCLUDE[tsql](../../includes/tsql-md.md)] or XQuery script that can also be run by using the **sqlcmd** utility, and **Invoke-PolicyEvaluation** reports whether [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] objects comply with policy-based management policies.</span></span>  
  
    -   <span data-ttu-id="5f1dc-113">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 提供者。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-113">A [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] provider.</span></span> <span data-ttu-id="5f1dc-114">此提供者可讓您使用類似於檔案系統路徑的路徑來導覽 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 物件階層。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-114">The provider lets you navigate the hierarchy of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] objects using a path similar to a file system path.</span></span> <span data-ttu-id="5f1dc-115">每一個物件都與 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 管理物件模型中的類別有關聯。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-115">Each object is associated with a class from the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Management object models.</span></span> <span data-ttu-id="5f1dc-116">您可以使用此類別的方法和屬性來針對物件執行工作。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-116">You can use the methods and properties of the class to perform work on the objects.</span></span> <span data-ttu-id="5f1dc-117">例如，如果您執行 cd 切換到路徑中的資料庫物件，您可以使用 Microsoft.SqlServer.Managment.SMO.Database 類別的方法和屬性來管理資料庫。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-117">For example, if you cd to a databases object in a path, you can use the methods and properties of the Microsoft.SqlServer.Managment.SMO.Database class to manage the database.</span></span>  
  
-   <span data-ttu-id="5f1dc-118">匯入 Windows PowerShell 2.0 會話的**sqlps**模組，用以載入嵌入式 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 管理單元。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-118">The **sqlps** module that is imported into Windows PowerShell 2.0 sessions to load the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] snap-ins.</span></span>  
  
-   <span data-ttu-id="5f1dc-119">已淘汰的**sqlps**公用程式，可啟動 Windows PowerShell 2.0 會話並匯入**sqlps**模組。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-119">The deprecated **sqlps** utility that starts a Windows PowerShell 2.0 session and imports the **sqlps** module.</span></span>  
  
-   [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] <span data-ttu-id="5f1dc-120">支援從物件總管樹狀結構啟動 Windows PowerShell 工作階段。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-120">supports starting Windows PowerShell sessions from the Object Explorer tree.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="5f1dc-121">代理程式支援 Windows PowerShell 作業步驟。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-121">Agent supports Windows PowerShell job steps.</span></span>  
  
 <span data-ttu-id="5f1dc-122">如果尚未安裝或卸載 Windows PowerShell 2.0，您必須遵循[Windows Management Framework](https://go.microsoft.com/fwlink/?LinkId=186214)頁面上的指示進行安裝。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-122">If Windows PowerShell 2.0 has not been installed, or has been uninstalled, you must install it by following the instructions on the [Windows Management Framework](https://go.microsoft.com/fwlink/?LinkId=186214) page.</span></span>  
  
 <span data-ttu-id="5f1dc-123">如果在安裝程式完成之後解除安裝了 Windows PowerShell，將會造成 Windows PowerShell 的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 功能無法運作。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-123">If Windows PowerShell is uninstalled after Setup finishes, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] features for Windows PowerShell will not function.</span></span> <span data-ttu-id="5f1dc-124">Windows PowerShell 可以由 Windows 使用者解除安裝，而且某些 Windows 作業系統升級可能也會要求解除安裝 Windows PowerShell。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-124">Windows PowerShell can be uninstalled by Windows users, and uninstalling Windows PowerShell might be required by some Windows operating system upgrades.</span></span> <span data-ttu-id="5f1dc-125">如果要使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell 功能，您必須使用 Windows Management Framework 安裝 PowerShell 2.0。</span><span class="sxs-lookup"><span data-stu-id="5f1dc-125">To use the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell features, you must reinstall PowerShell 2.0 by using the Windows Management Framework.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5f1dc-126">另請參閱</span><span class="sxs-lookup"><span data-stu-id="5f1dc-126">See Also</span></span>  
 [<span data-ttu-id="5f1dc-127">SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="5f1dc-127">SQL Server PowerShell</span></span>](../../powershell/sql-server-powershell.md)  
  
  
