---
title: 升級全文檢索搜尋 | Microsoft 文件
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: search
ms.topic: conceptual
helpviewer_keywords:
- full-text search [SQL Server], installing
- migrating full-text indexes [SQL Server]
- upgrading Full-Text Search
- installing Full-Text Search
- full-text search [SQL Server], upgrading
ms.assetid: 2fee4691-f2b5-472f-8ccc-fa625b654520
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: d2bdf0bdee452101bbafb8108426faf6604e7626
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87598260"
---
# <a name="upgrade-full-text-search"></a><span data-ttu-id="3f2ee-102">升級全文檢索搜尋</span><span class="sxs-lookup"><span data-stu-id="3f2ee-102">Upgrade Full-Text Search</span></span>
  <span data-ttu-id="3f2ee-103">將全文檢索搜尋升級為 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 的作業會在安裝期間完成，而且當您使用 [複製資料庫精靈] 以附加、還原或複製舊版 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的資料庫檔案和全文檢索目錄時，也會完成此作業。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-103">Upgrading full-text search to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] is done during setup and when database files and full-text catalogs from the earlier version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] are attached, restored, or copied using the Copy Database Wizard.</span></span>  
  
 <span data-ttu-id="3f2ee-104">本主題討論升級全文檢索搜尋的下列各方面：</span><span class="sxs-lookup"><span data-stu-id="3f2ee-104">This topic discusses the following aspects of upgrading full-text search:</span></span>  
  
-   [<span data-ttu-id="3f2ee-105">升級伺服器執行個體</span><span class="sxs-lookup"><span data-stu-id="3f2ee-105">Upgrading a Server Instance</span></span>](#Upgrade_Server)  
  
-   [<span data-ttu-id="3f2ee-106">全文檢索升級選項</span><span class="sxs-lookup"><span data-stu-id="3f2ee-106">Full-Text Upgrade Options</span></span>](#FT_Upgrade_Options)  
  
-   [<span data-ttu-id="3f2ee-107">選擇全文檢索升級選項的考慮</span><span class="sxs-lookup"><span data-stu-id="3f2ee-107">Considerations for Choosing a Full-Text Upgrade Option</span></span>](#Choosing_Upgade_Option)  
  
-   [<span data-ttu-id="3f2ee-108">將資料庫升級為 SQL Server 2014 時移轉全文檢索索引</span><span class="sxs-lookup"><span data-stu-id="3f2ee-108">Migrating Full-Text Indexes When Upgrading a Database to SQL Server 2014</span></span>](#Upgrade_Db)  
  
-   [<span data-ttu-id="3f2ee-109">將 SQL Server 2005 全文檢索目錄還原至 SQL Server 2014 的考量</span><span class="sxs-lookup"><span data-stu-id="3f2ee-109">Considerations for Restoring a SQL Server 2005 Full-Text Catalog to SQL Server 2014</span></span>](#Considerations_for_Restore)  
  
-   [<span data-ttu-id="3f2ee-110">將 SQL Server 2005 資料庫附加至 SQL Server 2014</span><span class="sxs-lookup"><span data-stu-id="3f2ee-110">Attaching a SQL Server 2005 database to SQL Server 2014</span></span>](#Attaching_2005_ft_catalogs)  
  
##  <a name="upgrading-a-server-instance"></a><a name="Upgrade_Server"></a><span data-ttu-id="3f2ee-111">升級伺服器實例</span><span class="sxs-lookup"><span data-stu-id="3f2ee-111">Upgrading a Server Instance</span></span>  
 <span data-ttu-id="3f2ee-112">進行就地升級時， [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 的執行個體會與舊版 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]並存安裝，而資料會進行移轉。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-112">For an in-place upgrade, an instance of [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] is set up side-by-side with the old version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], and data is migrated.</span></span> <span data-ttu-id="3f2ee-113">如果舊版 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 已安裝全文檢索搜尋，系統就會自動安裝新版全文檢索搜尋。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-113">If the old version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] had full-text search installed, a new version of full-text search is automatically installed.</span></span> <span data-ttu-id="3f2ee-114">並存安裝表示下列各個元件可存在於 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]的執行個體層級。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-114">Side-by-side install means that each of the following components exists at the instance-level of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="3f2ee-115">斷詞工具、字幹分析器和篩選</span><span class="sxs-lookup"><span data-stu-id="3f2ee-115">Word breakers, stemmers, and filters</span></span>  
 <span data-ttu-id="3f2ee-116">各個執行個體現在會使用自己的斷詞工具、字幹分析器和篩選集，而不再使用這些元件的作業系統版本。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-116">Each instance now uses its own set of word breakers, stemmers, and filters, rather than relying on the operating system version of these components.</span></span> <span data-ttu-id="3f2ee-117">您還能在個別執行個體層級中，輕易地註冊和設定這些元件。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-117">These components are also easier to register and configure at a per-instance level.</span></span> <span data-ttu-id="3f2ee-118">如需詳細資訊，請參閱 [設定及管理搜尋的斷詞工具與字幹分析器](configure-and-manage-word-breakers-and-stemmers-for-search.md) 和 [設定及管理搜尋的篩選](configure-and-manage-filters-for-search.md)。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-118">For more information, see [Configure and Manage Word Breakers and Stemmers for Search](configure-and-manage-word-breakers-and-stemmers-for-search.md) and [Configure and Manage Filters for Search](configure-and-manage-filters-for-search.md).</span></span>  
  
 <span data-ttu-id="3f2ee-119">篩選背景程式主機</span><span class="sxs-lookup"><span data-stu-id="3f2ee-119">Filter daemon host</span></span>  
 <span data-ttu-id="3f2ee-120">全文檢索篩選背景程式主機處理序可安全無虞地載入並驅動用於索引和查詢的擴充外部元件，例如斷詞工具、字幹分析器和篩選，而無損全文檢索引擎的完整性。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-120">The full-text filter daemon hosts are processes that safely load and drive extensible external components used for index and query, such as word breakers, stemmers, and filters, without compromising the integrity of the Full-Text Engine.</span></span> <span data-ttu-id="3f2ee-121">伺服器執行個體會針對所有多執行緒篩選使用多執行緒處理序，而針對所有單一執行緒篩選使用單一執行緒處理序。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-121">A server instance uses a multithreaded process for all multithreaded filters and a single-threaded process for all single-threaded filters.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] <span data-ttu-id="3f2ee-122">針對 FDHOST 啟動器服務 (MSSQLFDLauncher) 導入了服務帳戶。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-122">introduced a service account for the FDHOST Launcher service (MSSQLFDLauncher).</span></span> <span data-ttu-id="3f2ee-123">這個服務會將服務帳戶資訊傳播至特定 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]執行個體的篩選背景程式主機處理序。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-123">This service propagates the service account information to the filter daemon host processes of a specific instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="3f2ee-124">如需設定服務帳戶的相關資訊，請參閱 [設定全文檢索篩選背景程式啟動器的服務帳戶](set-the-service-account-for-the-full-text-filter-daemon-launcher.md)。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-124">For information about setting the service account, see [Set the Service Account for the Full-text Filter Daemon Launcher](set-the-service-account-for-the-full-text-filter-daemon-launcher.md).</span></span>  
  
 <span data-ttu-id="3f2ee-125">在 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]中，每個全文檢索索引都位於屬於檔案群組、具有實體路徑而且被視為資料庫檔案的全文檢索目錄中。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-125">In [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], each full-text index resides in a full-text catalog that belongs to a filegroup, has a physical path, and is treated as a database file.</span></span> <span data-ttu-id="3f2ee-126">在 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 和更新版本中，全文檢索目錄是包含一組全文檢索索引的邏輯或虛擬物件。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-126">In [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] and later versions, a full-text catalog is a logical or virtual object that contains a group of full-text indexes.</span></span> <span data-ttu-id="3f2ee-127">因此，新的全文檢索目錄不會被視為具有實體路徑的資料庫檔案。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-127">Therefore, a new full-text catalog is not treated as a database file with a physical path.</span></span> <span data-ttu-id="3f2ee-128">不過，在升級含有資料檔案的任何全文檢索目錄期間，系統會在相同的磁碟上建立新的檔案群組。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-128">However, during upgrade of any full-text catalog that contains data files, a new filegroup is created on same disk.</span></span> <span data-ttu-id="3f2ee-129">這會在升級之後保留舊磁碟 I/O 行為。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-129">This maintains the old disk I/O behavior after upgrade.</span></span> <span data-ttu-id="3f2ee-130">如果根路徑存在，則任何來自該目錄的全文檢索索引都會放置於新的檔案群組中。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-130">Any full-text index from that catalog is placed in the new filegroup if the root path exists.</span></span> <span data-ttu-id="3f2ee-131">如果舊的全文檢索目錄路徑無效，升級作業就會將全文檢索索引保留在與基底資料表相同的檔案群組中，或是保留在分割區資料表的主要檔案群組中。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-131">If the old full-text catalog path is invalid, the upgrade keeps the full-text index in the same filegroup as the base table or, for a partitioned table, in the primary filegroup.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]<span data-ttu-id="3f2ee-132">[!INCLUDE[tsql](../../includes/tsql-md.md)]指定全文檢索目錄的 DDL 語句會繼續正常運作。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-132">[!INCLUDE[tsql](../../includes/tsql-md.md)] DDL statements that specify full-text catalogs continue to work correctly.</span></span>  
  
##  <a name="full-text-upgrade-options"></a><a name="FT_Upgrade_Options"></a><span data-ttu-id="3f2ee-133">全文檢索升級選項</span><span class="sxs-lookup"><span data-stu-id="3f2ee-133">Full-Text Upgrade Options</span></span>  
 <span data-ttu-id="3f2ee-134">將伺服器執行個體升級為 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]時，使用者介面可讓您選擇下列其中一個全文檢索升級選項。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-134">When upgrading a server instance to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], the user interface allows you to choose one of the following full-text upgrade options.</span></span>  
  
 <span data-ttu-id="3f2ee-135">匯入</span><span class="sxs-lookup"><span data-stu-id="3f2ee-135">Import</span></span>  
 <span data-ttu-id="3f2ee-136">匯入全文檢索目錄。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-136">Full-text catalogs are imported.</span></span> <span data-ttu-id="3f2ee-137">一般而言，匯入的速度明顯比重建的速度更快。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-137">Typically, import is significantly faster than rebuild.</span></span> <span data-ttu-id="3f2ee-138">例如，只有使用一個 CPU 時，匯入的執行速度大約比重建的速度快 10 倍。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-138">For example, when using only one CPU, import runs about 10 times faster than rebuild.</span></span> <span data-ttu-id="3f2ee-139">不過，匯入的全文檢索目錄並不會使用與 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]最新版本一起安裝的新斷詞工具。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-139">However, an imported full-text catalog does not use the new word breakers installed with the latest version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="3f2ee-140">為確保查詢結果的一致性，必須重建全文檢索目錄。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-140">To ensure consistency in query results, full-text catalogs have to be rebuilt.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3f2ee-141">重建可以在多執行緒模式中執行，而且如果有 10 個以上的 CPU 可用，當您允許重建使用所有 CPU 時，重建的執行速度可能會比匯入的速度更快。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-141">Rebuild can run in multi-threaded mode, and if more than 10 CPUs are available, rebuild might run faster than import if you allow rebuild to use all of the CPUs.</span></span>  
  
 <span data-ttu-id="3f2ee-142">如果無法使用全文檢索目錄，將會重建關聯的全文檢索索引。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-142">If a full-text catalog is not available, the associated full-text indexes are rebuilt.</span></span> <span data-ttu-id="3f2ee-143">只有針對 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 資料庫才可以使用此選項。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-143">This option is available for only [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] databases.</span></span>  
  
 <span data-ttu-id="3f2ee-144">如需有關匯入全文檢索索引之影響的詳細資訊，請參閱本主題後面的「選擇全文檢索升級選項的考量」。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-144">For information about the impact of importing full-text index, see "Considerations for Choosing a Full-Text Upgrade Option," later in this topic.</span></span>  
  
 <span data-ttu-id="3f2ee-145">重建</span><span class="sxs-lookup"><span data-stu-id="3f2ee-145">Rebuild</span></span>  
 <span data-ttu-id="3f2ee-146">全文檢索目錄會使用新的增強斷詞工具重建。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-146">Full-text catalogs are rebuilt using the new and enhanced word breakers.</span></span> <span data-ttu-id="3f2ee-147">重建索引可能需要一些時間，而且在升級之後可能需要相當多的 CPU 和記憶體。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-147">Rebuilding indexes can take a while, and a significant amount of CPU and memory might be required after the upgrade.</span></span>  
  
 <span data-ttu-id="3f2ee-148">重設</span><span class="sxs-lookup"><span data-stu-id="3f2ee-148">Reset</span></span>  
 <span data-ttu-id="3f2ee-149">重設全文檢索目錄。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-149">Full-text catalogs are reset.</span></span> <span data-ttu-id="3f2ee-150">從 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]進行升級時，全文檢索目錄檔案會遭到移除，但是全文檢索目錄和全文檢索索引的中繼資料則會保留。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-150">When upgrading from [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], full-text catalog files are removed, but the metadata for full-text catalogs and full-text indexes is retained.</span></span> <span data-ttu-id="3f2ee-151">在升級之後，所有的全文檢索索引都會停用變更追蹤，而且不會自動啟動搜耙。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-151">After being upgraded, all full-text indexes are disabled for change tracking and crawls are not started automatically.</span></span> <span data-ttu-id="3f2ee-152">當您在升級完成之後手動發出完整母體擴展之前，此目錄將會維持空白狀態。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-152">The catalog will remain empty until you manually issue a full population, after the upgrade completes.</span></span>  
  
##  <a name="considerations-for-choosing-a-full-text-upgrade-option"></a><a name="Choosing_Upgade_Option"></a><span data-ttu-id="3f2ee-153">選擇全文檢索升級選項的考慮</span><span class="sxs-lookup"><span data-stu-id="3f2ee-153">Considerations for Choosing a Full-Text Upgrade Option</span></span>  
 <span data-ttu-id="3f2ee-154">當您為升級作業選擇升級選項時，請考慮下列事項：</span><span class="sxs-lookup"><span data-stu-id="3f2ee-154">When choosing the upgrade option for your upgrade, consider the following:</span></span>  
  
-   <span data-ttu-id="3f2ee-155">您需要查詢結果中的一致性嗎？</span><span class="sxs-lookup"><span data-stu-id="3f2ee-155">Do you require consistency in query results?</span></span>  
  
     [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] <span data-ttu-id="3f2ee-156">會安裝新的斷詞工具，供全文索引與語意搜尋之用。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-156">installs new word breakers for use by Full-Text and Semantic Search.</span></span> <span data-ttu-id="3f2ee-157">編製索引及查詢時皆可使用斷詞工具。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-157">The word breakers are used both at indexing time and at query time.</span></span> <span data-ttu-id="3f2ee-158">如不重建全文索引目錄，可能會造成搜尋結果不一致。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-158">If you do not rebuild the full-text catalogs, your search results may be inconsistent.</span></span> <span data-ttu-id="3f2ee-159">當您發出全文索引查詢，尋找在舊版 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 斷詞工具中與目前之斷詞工具中斷詞方式相異的片語，可能會無法擷取含有該片語的文件或資料列。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-159">If you issue a full-text query that looks for a phrase that is broken differently by the word breaker in a previous version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and the current word breaker, a document or row containing the phrase might not be retrieved.</span></span> <span data-ttu-id="3f2ee-160">這是索引片語所使用的分解邏輯與查詢所用者不相同所致。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-160">This is because the indexed phrases were broken using different logic than the query is using.</span></span> <span data-ttu-id="3f2ee-161">此方案會使用新的斷詞工具重新擴展 (重建) 全文索引目錄，讓索引與查詢時的行為一致。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-161">The solution is to repopulate (rebuild) the full-text catalogs with the new word breakers so that index time and query time behavior are identical.</span></span> <span data-ttu-id="3f2ee-162">您可以選擇 [重建] 選項以完成這個作業，也可以在選擇 [匯入] 選項之後手動重建。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-162">You can choose the Rebuild option to accomplish this, or you can rebuild manually after choosing the Import option.</span></span>  
  
-   <span data-ttu-id="3f2ee-163">是否有任何全文檢索索引建立在整數全文檢索索引鍵資料行上？</span><span class="sxs-lookup"><span data-stu-id="3f2ee-163">Were any full-text indexes built on integer full-text key columns?</span></span>  
  
     <span data-ttu-id="3f2ee-164">重建會執行內部最佳化，以便在某些情況中改善已升級之全文檢索索引的查詢效能。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-164">Rebuilding performs internal optimizations that improve the query performance of the upgraded full-text index in some cases.</span></span> <span data-ttu-id="3f2ee-165">具體而言，如果您擁有包含全文檢索索引的全文檢索目錄，其中基底資料表的全文檢索索引鍵資料行是整數資料類型，則重建會在升級之後達到理想的全文檢索查詢效能。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-165">Specifically, if you have full-text catalogs that contain full-text indexes for which the full-text key column of the base table is an integer data type, rebuilding achieves ideal performance of full-text queries after upgrade.</span></span> <span data-ttu-id="3f2ee-166">在此情況中，我們強烈建議您使用 **[重建]** 選項。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-166">In this case, we highly recommend you to use the **Rebuild** option.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3f2ee-167">若為 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]中的全文檢索索引，我們建議當做全文檢索索引鍵的資料行必須是整數資料類型。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-167">For full-text indexes in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], we recommend that the column serving as the full-text key be an integer data type.</span></span> <span data-ttu-id="3f2ee-168">如需詳細資訊，請參閱 [改善全文檢索索引的效能](improve-the-performance-of-full-text-indexes.md)。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-168">For more information, see [Improve the Performance of Full-Text Indexes](improve-the-performance-of-full-text-indexes.md).</span></span>  
  
-   <span data-ttu-id="3f2ee-169">將伺服器執行個體保持在線上狀態的優先權為何？</span><span class="sxs-lookup"><span data-stu-id="3f2ee-169">What is the priority for getting your server instance online?</span></span>  
  
     <span data-ttu-id="3f2ee-170">在升級期間匯入或重建會耗用大量 CPU 資源，因而延遲將其餘伺服器執行個體升級並保持在線上狀態的時間。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-170">Importing or rebuilding during upgrade takes a lot of CPU resources, which delays getting the rest of the server instance upgraded and online.</span></span> <span data-ttu-id="3f2ee-171">如果盡可能將伺服器執行個體保持在線上狀態很重要，而且您願意在升級之後執行手動母體擴展，則適合使用 **[重設]** 。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-171">If getting the server instance online as soon as possible is important and if you are willing to run a manual population after the upgrade, **Reset** is suitable.</span></span>  
  
## <a name="ensuring-consistent-query-results-after-importing-a-sql-server-2005-full-text-index"></a><span data-ttu-id="3f2ee-172">確保匯入 SQL Server 2005 全文檢索索引之後的查詢結果一致性</span><span class="sxs-lookup"><span data-stu-id="3f2ee-172">Ensuring Consistent Query Results after Importing a SQL Server 2005 Full-Text Index</span></span>  
 <span data-ttu-id="3f2ee-173">新舊斷詞工具的行為稍微不同，因此如果已在將 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 資料庫升級至 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]時匯入全文檢索目錄，則查詢與全文檢索索引內容之間可能會不相符。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-173">If a full-text catalog was imported when upgrading a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] database to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], mismatches between the query and the full-text index content might occur because of differences in the behavior of the old and new word breakers.</span></span> <span data-ttu-id="3f2ee-174">在此情況中，若要確保查詢與全文檢索索引內容之間完全相符，請選擇下列其中一個選項：</span><span class="sxs-lookup"><span data-stu-id="3f2ee-174">In this case, to guarantee a total match between queries and the full-text index content, choose one of the following options:</span></span>  
  
-   <span data-ttu-id="3f2ee-175">重建包含全文檢索索引的全文檢索目錄 ([ALTER FULLTEXT CATALOG](/sql/t-sql/statements/alter-fulltext-catalog-transact-sql)*catalog_name* REBUILD)</span><span class="sxs-lookup"><span data-stu-id="3f2ee-175">Rebuild the full-text catalog that contains the full-text index ([ALTER FULLTEXT CATALOG](/sql/t-sql/statements/alter-fulltext-catalog-transact-sql)*catalog_name* REBUILD)</span></span>  
  
-   <span data-ttu-id="3f2ee-176">針對全文檢索索引發出 FULL POPULATION ([ALTER FULLTEXT INDEX](/sql/t-sql/statements/alter-fulltext-index-transact-sql) ON *table_name* START FULL POPULATION)。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-176">Issue a FULL POPULATION on the full-text index ([ALTER FULLTEXT INDEX](/sql/t-sql/statements/alter-fulltext-index-transact-sql) ON *table_name* START FULL POPULATION).</span></span>  
  
 <span data-ttu-id="3f2ee-177">如需斷詞工具的詳細資訊，請參閱 [設定及管理搜尋的斷詞工具與字幹分析器](configure-and-manage-word-breakers-and-stemmers-for-search.md)。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-177">For more information about word breakers, see [Configure and Manage Word Breakers and Stemmers for Search](configure-and-manage-word-breakers-and-stemmers-for-search.md).</span></span>  
  
## <a name="upgrading-noise-word-files-to-stoplists"></a><span data-ttu-id="3f2ee-178">將非搜尋字檔案升級為停用字詞表</span><span class="sxs-lookup"><span data-stu-id="3f2ee-178">Upgrading Noise-Word Files to Stoplists</span></span>  
 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] <span data-ttu-id="3f2ee-179">非搜尋字已取代為 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 和更新版本中的停用字詞。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-179">noise words have been replaced by stopwords in [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] and later versions.</span></span> <span data-ttu-id="3f2ee-180">當資料庫從 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 升級為 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]時，便不再使用非搜尋字檔案。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-180">When a database is upgraded to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] from [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], the noise-word files are no longer used.</span></span> <span data-ttu-id="3f2ee-181">不過，這些舊的非搜尋字檔案會儲存在 FTDATA\ FTNoiseThesaurusBak 資料夾中，而且您之後可以在更新或建立對應的 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 停用字詞表時使用它們。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-181">However, the old noise-word files are stored in the FTDATA\ FTNoiseThesaurusBak folder, and you can use them later when updating or building the corresponding [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] stoplists.</span></span>  
  
 <span data-ttu-id="3f2ee-182">從 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]升級之後：</span><span class="sxs-lookup"><span data-stu-id="3f2ee-182">After upgrading from [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]:</span></span>  
  
-   <span data-ttu-id="3f2ee-183">如果您從未在 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]的安裝中新增、修改或刪除任何非搜尋字檔案，則系統停用字詞表應該能符合您的需求。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-183">If you never added, modified, or deleted any noise-word files in your installation of [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], the system stoplist should meet your needs.</span></span>  
  
-   <span data-ttu-id="3f2ee-184">如果曾在 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]中修改過非搜尋字檔案，則這些修改會在升級時遺失。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-184">If your noise-word files were modified in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], those modifications are lost during upgrade.</span></span> <span data-ttu-id="3f2ee-185">若要重新建立這些更新，您必須在對應的 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 停用字詞表中以手動方式重新建立這些修改。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-185">To re-create those updates, you must manually recreate those modifications in the corresponding [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] stoplist.</span></span> <span data-ttu-id="3f2ee-186">如需詳細資訊，請參閱 [ALTER FULLTEXT STOPLIST &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-fulltext-stoplist-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-186">For more information, see [ALTER FULLTEXT STOPLIST &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-fulltext-stoplist-transact-sql).</span></span>  
  
-   <span data-ttu-id="3f2ee-187">如果不想將任何停用字詞套用至全文檢索索引 (例如，如果刪除或清除了 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 安裝中的非搜尋字檔案)，則必須針對每個已升級的全文檢索索引關閉停用字詞表。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-187">If you do not want to apply any stopwords to your full-text indexes (for example, if you deleted or erased your noise-word files in your [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] installation), you must turn off the stoplist for each upgraded full-text index.</span></span> <span data-ttu-id="3f2ee-188">執行下列 [!INCLUDE[tsql](../../includes/tsql-md.md)] 陳述式 (以升級後資料庫的名稱取代 *database* ，並以 *table* 的名稱取代 *table*)：</span><span class="sxs-lookup"><span data-stu-id="3f2ee-188">Run the following [!INCLUDE[tsql](../../includes/tsql-md.md)] statement (replacing *database* with the name of the upgraded database and *table* with the name of the *table*):</span></span>  
  
    ```  
    Use database;   
    ALTER FULLTEXT INDEX ON table  
       SET STOPLIST OFF;  
    GO  
    ```  
  
     <span data-ttu-id="3f2ee-189">STOPLIST OFF 子句會移除停用字詞篩選，而且它將會觸發資料表的母體擴展，但不會篩選任何視為非搜尋字的字詞。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-189">The STOPLIST OFF clause removes stop-word filtering, and it will trigger a population of the table, without filtering any words considered to be noise.</span></span>  
  
## <a name="backup-and-imported-full-text-catalogs"></a><span data-ttu-id="3f2ee-190">備份與匯入的全文檢索目錄</span><span class="sxs-lookup"><span data-stu-id="3f2ee-190">Backup and Imported Full-Text Catalogs</span></span>  
 <span data-ttu-id="3f2ee-191">對於升級期間重建或重設的全文檢索目錄 (以及新的全文檢索目錄) 而言，此全文檢索目錄是邏輯概念，而且不會位於檔案群組中。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-191">For full-text catalogs that are rebuilt or reset during upgrade (and for new full-text catalogs), the fulltext catalog is a logical concept and does not reside in a filegroup.</span></span> <span data-ttu-id="3f2ee-192">因此，若要備份 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]中的全文檢索目錄，您必須識別包含此目錄之全文檢索索引的每個檔案群組，然後逐一備份它們。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-192">Therefore, to back up a full-text catalog in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], you must identify every filegroup that contains a full-text index of the catalog and back each of them up, one by one.</span></span> <span data-ttu-id="3f2ee-193">如需詳細資訊，請參閱 [備份並還原全文檢索目錄與索引](back-up-and-restore-full-text-catalogs-and-indexes.md)。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-193">For more information, see [Back Up and Restore Full-Text Catalogs and Indexes](back-up-and-restore-full-text-catalogs-and-indexes.md).</span></span>  
  
 <span data-ttu-id="3f2ee-194">對於已經從 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]匯入的全文檢索目錄而言，此全文檢索目錄仍然是位於其檔案群組中的資料庫檔案。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-194">For full-text catalogs that have been imported from [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], the full-text catalog is still a database file in its own filegroup.</span></span> <span data-ttu-id="3f2ee-195">全文檢索目錄的 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 備份程序仍然適用，但是 MSFTESQL 服務不存在 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]中。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-195">The [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] backup process for full-text catalogs still applies except that the MSFTESQL service does not exist in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span> <span data-ttu-id="3f2ee-196">如需 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 程序的相關資訊，請參閱《SQL Server 2005 線上叢書》中的 [備份與還原全文檢索目錄](https://go.microsoft.com/fwlink/?LinkId=209154) 。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-196">For information about the [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] process, see [Backing Up and Restoring Full-Text Catalogs](https://go.microsoft.com/fwlink/?LinkId=209154) in SQL Server 2005 Books Online.</span></span>  
  
##  <a name="migrating-full-text-indexes-when-upgrading-a-database-to-sscurrent"></a><a name="Upgrade_Db"></a><span data-ttu-id="3f2ee-197">將資料庫升級至時，遷移全文檢索索引[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3f2ee-197">Migrating Full-Text Indexes When Upgrading a Database to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]</span></span>  
 <span data-ttu-id="3f2ee-198">您可以使用附加、還原或 [複製資料庫精靈]，將舊版 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的資料庫檔案和全文檢索目錄升級為現有的 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 伺服器執行個體。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-198">Database files and full-text catalogs from a previous version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] can be upgraded to an existing [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] server instance by using attach, restore, or the Copy Database Wizard.</span></span> [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] <span data-ttu-id="3f2ee-199">系統會匯入、重設或重建全文檢索索引 (如果有的話)。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-199">full-text indexes, if any, are either imported, reset, or rebuilt.</span></span> <span data-ttu-id="3f2ee-200">**upgrade_option** 伺服器屬性會控制此伺服器執行個體在這些資料庫升級期間所使用的全文檢索升級選項。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-200">The **upgrade_option** server property controls which full-text upgrade option the server instance uses during these database upgrades.</span></span>  
  
 <span data-ttu-id="3f2ee-201">當您將任何 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 資料庫附加、還原或複製到 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]時，該資料庫會立即可用，然後自動升級。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-201">After you attach, restore, or copy any [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] database to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], the database becomes available immediately and is then automatically upgraded.</span></span> <span data-ttu-id="3f2ee-202">根據進行索引的資料數量而定，匯入可能需要數個小時，而重建可能需要十倍以上的時間。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-202">Depending the amount of data being indexed, importing can take several hours, and rebuilding can take up to ten times longer.</span></span> <span data-ttu-id="3f2ee-203">此外，請注意，當升級選項設定為 [匯入] 時，如果全文檢索目錄無法使用，系統就會重建相關聯的全文檢索索引。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-203">Note also that when the upgrade option is set to import, if a full-text catalog is not available, the associated full-text indexes are rebuilt.</span></span>  
  
 <span data-ttu-id="3f2ee-204">**變更伺服器執行個體的全文檢索升級行為**</span><span class="sxs-lookup"><span data-stu-id="3f2ee-204">**To change full-text upgrade behavior on a server instance**</span></span>  
  
-   [!INCLUDE[tsql](../../includes/tsql-md.md)]<span data-ttu-id="3f2ee-205">：使用[sp \_ 全文檢索 \_ 服務](/sql/relational-databases/system-stored-procedures/sp-fulltext-service-transact-sql)的**升級 \_ 選項**動作</span><span class="sxs-lookup"><span data-stu-id="3f2ee-205">: Use the **upgrade\_option** action of [sp\_fulltext\_service](/sql/relational-databases/system-stored-procedures/sp-fulltext-service-transact-sql)</span></span>  
  
-   [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] <span data-ttu-id="3f2ee-206">**：** 使用 [伺服器屬性]\*\*\*\* 對話方塊的 [全文檢索升級選項]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-206">**:** Use the **Full-Text Upgrade Option** of the **Server Properties** dialog box.</span></span> <span data-ttu-id="3f2ee-207">如需詳細資訊，請參閱 [管理及監視伺服器執行個體的全文檢索搜尋](manage-and-monitor-full-text-search-for-a-server-instance.md)。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-207">For more information, see [Manage and Monitor Full-Text Search for a Server Instance](manage-and-monitor-full-text-search-for-a-server-instance.md).</span></span>  
  
##  <a name="considerations-for-restoring-a-ssversion2005-full-text-catalog-to-sscurrent"></a><a name="Considerations_for_Restore"></a> <span data-ttu-id="3f2ee-208">還原 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 全文檢索目錄的考量 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3f2ee-208">Considerations for Restoring a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] Full-Text Catalog to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]</span></span>  
 <span data-ttu-id="3f2ee-209">將全文檢索資料從 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 資料庫升級為 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 的其中一種方法是將完整資料庫備份還原至 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-209">One method of upgrading fulltext data from a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] database to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] is to restore a full database backup to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span>  
  
 <span data-ttu-id="3f2ee-210">匯入 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 全文檢索目錄時，您可以備份和還原資料庫與目錄檔案。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-210">While importing a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] full-text catalog, you can back up and restore the database and the catalog file.</span></span> <span data-ttu-id="3f2ee-211">此行為與 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]的行為相同：</span><span class="sxs-lookup"><span data-stu-id="3f2ee-211">The behavior is the same as in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]:</span></span>  
  
-   <span data-ttu-id="3f2ee-212">完整資料庫備份將會包含全文檢索目錄。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-212">The full database backup will include the full-text catalog.</span></span> <span data-ttu-id="3f2ee-213">若要參考全文檢索目錄，請使用其 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 檔案名稱：sysft_+*catalog-name*。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-213">To refer to the full-text catalog, use its [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] file name, sysft_+*catalog-name*.</span></span>  
  
-   <span data-ttu-id="3f2ee-214">如果全文檢索目錄處於離線狀態，備份將會失敗。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-214">If the full-text catalog is offline, the backup will fail.</span></span>  
  
 <span data-ttu-id="3f2ee-215">如需備份和還原 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 全文檢索目錄的詳細資訊，請參閱《 [線上叢書》中的](https://go.microsoft.com/fwlink/?LinkId=121052) 備份與還原全文檢索目錄 [和](https://go.microsoft.com/fwlink/?LinkId=121053)檔案備份、還原及全文檢索目錄 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-215">For more information about backing up and restoring [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] full-text catalogs, see [Backing Up and Restoring Full-Text Catalogs](https://go.microsoft.com/fwlink/?LinkId=121052) and [File Backup and Restore and Full-Text Catalogs](https://go.microsoft.com/fwlink/?LinkId=121053)in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] Books Online.</span></span>  
  
 <span data-ttu-id="3f2ee-216">在 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]中還原資料庫時，系統會針對此全文檢索目錄建立新的資料庫檔案。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-216">When the database is restored on [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], a new database file will be created for the full-text catalog.</span></span> <span data-ttu-id="3f2ee-217">這個檔案的預設名稱為 ftrow_*catalog-name*.ndf。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-217">The default name of this file is ftrow_*catalog-name*.ndf.</span></span> <span data-ttu-id="3f2ee-218">例如，如果您的 *catalog-name* 是 `cat1`， [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 資料庫檔案的預設名稱會是 `ftrow_cat1.ndf`。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-218">For example, if you *catalog-name* is `cat1`, the default name of the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] database file would be `ftrow_cat1.ndf`.</span></span> <span data-ttu-id="3f2ee-219">但是，如果預設名稱已經用於目標目錄中，新的資料庫檔案就會命名為 `ftrow_` *catalog-name* `{` *guid* `}.ndf` ，其中*guid*是新檔案的全域唯一識別碼。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-219">But if the default name is already being used in the target directory, the new database file would be named `ftrow_`*catalog-name*`{`*GUID*`}.ndf`, where *GUID* is the Globally Unique Identifier of the new file.</span></span>  
  
 <span data-ttu-id="3f2ee-220">匯入目錄之後，會更新 **sys.database_files** 和 **sys.master_files**以移除目錄項目，而且 **sys.fulltext_catalogs** 中的 **path** 資料行會設成 NULL。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-220">After the catalogs have been imported, the **sys.database_files** and **sys.master_file**s are updated to remove the catalog entries and the **path** column in **sys.fulltext_catalogs** is set to NULL.</span></span>  
  
 <span data-ttu-id="3f2ee-221">**備份資料庫**</span><span class="sxs-lookup"><span data-stu-id="3f2ee-221">**To back up a database**</span></span>  
  
-   [<span data-ttu-id="3f2ee-222">完整資料庫備份 &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="3f2ee-222">Full Database Backups &#40;SQL Server&#41;</span></span>](../backup-restore/full-database-backups-sql-server.md)  
  
-   <span data-ttu-id="3f2ee-223">[交易記錄備份 &#40;SQL Server&#41;](../backup-restore/transaction-log-backups-sql-server.md) (僅限完整復原模式)</span><span class="sxs-lookup"><span data-stu-id="3f2ee-223">[Transaction Log Backups &#40;SQL Server&#41;](../backup-restore/transaction-log-backups-sql-server.md) (full recovery model only)</span></span>  
  
 <span data-ttu-id="3f2ee-224">**還原資料庫備份**</span><span class="sxs-lookup"><span data-stu-id="3f2ee-224">**To restore a database backup**</span></span>  
  
-   [<span data-ttu-id="3f2ee-225">完整資料庫還原 &#40;簡單復原模式&#41;</span><span class="sxs-lookup"><span data-stu-id="3f2ee-225">Complete Database Restores &#40;Simple Recovery Model&#41;</span></span>](../backup-restore/complete-database-restores-simple-recovery-model.md)  
  
-   [<span data-ttu-id="3f2ee-226">完整資料庫還原 &#40;完整復原模式&#41;</span><span class="sxs-lookup"><span data-stu-id="3f2ee-226">Complete Database Restores &#40;Full Recovery Model&#41;</span></span>](../backup-restore/complete-database-restores-full-recovery-model.md)  
  
### <a name="example"></a><span data-ttu-id="3f2ee-227">範例</span><span class="sxs-lookup"><span data-stu-id="3f2ee-227">Example</span></span>  
 <span data-ttu-id="3f2ee-228">下列範例會在 [RESTORE](/sql/t-sql/statements/restore-statements-transact-sql) 陳述式中使用 MOVE 子句來還原名為 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 的 `ftdb1`資料庫。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-228">The following example uses the MOVE clause in the [RESTORE](/sql/t-sql/statements/restore-statements-transact-sql) statement, to restore a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] database named `ftdb1`.</span></span> <span data-ttu-id="3f2ee-229">[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 資料庫、記錄和目錄檔案都會移至 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 伺服器執行個體上的新位置，如下所示：</span><span class="sxs-lookup"><span data-stu-id="3f2ee-229">The [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] database, log, and catalog files are moved to new locations on the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] server instance, as follows:</span></span>  
  
-   <span data-ttu-id="3f2ee-230">資料庫檔案 `ftdb1.mdf`會移至 `C:\Program Files\Microsoft SQL Server\MSSQL.1MSSQL12.MSSQLSERVER\MSSQL\DATA\ftdb1.mdf`。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-230">The database file, `ftdb1.mdf`, is moved to `C:\Program Files\Microsoft SQL Server\MSSQL.1MSSQL12.MSSQLSERVER\MSSQL\DATA\ftdb1.mdf`.</span></span>  
  
-   <span data-ttu-id="3f2ee-231">記錄檔 `ftdb1_log.ldf` 會移至記錄磁片磁碟機上的記錄檔目錄， *log_drive* `:\` *log_directory* `\ftdb1_log.ldf` 。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-231">The log file, `ftdb1_log.ldf`, is moved to a log directory on your log disk drive, *log_drive*`:\`*log_directory*`\ftdb1_log.ldf`.</span></span>  
  
-   <span data-ttu-id="3f2ee-232">對應至 `sysft_cat90` 目錄的目錄檔案會移至 `C:\temp`。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-232">The catalog files that correspond to the `sysft_cat90` catalog are moved to `C:\temp`.</span></span> <span data-ttu-id="3f2ee-233">匯入全文檢索索引之後，它們會自動放置於資料庫檔案 C:\ftrow_sysft_cat90.ndf 中，而且系統會刪除 C:\temp。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-233">After the full-text indexes are imported, they will automatically be placed in a database file, C:\ftrow_sysft_cat90.ndf, and the C:\temp will be deleted.</span></span>  
  
```  
RESTORE DATABASE [ftdb1] FROM  DISK = N'C:\temp\ftdb1.bak' WITH  FILE = 1,  
   MOVE N'ftdb1' TO N'C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\DATA\ftdb1.mdf',  
    MOVE N'ftdb1_log' TO N'log_drive:\log_directory\ftdb1_log.ldf',  
    MOVE N'sysft_cat90' TO N'C:\temp';  
```  
  
##  <a name="attaching-a-sql-server-2005-database-to-sscurrent"></a><a name="Attaching_2005_ft_catalogs"></a><span data-ttu-id="3f2ee-234">將 SQL Server 2005 資料庫附加至[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3f2ee-234">Attaching a SQL Server 2005 Database to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]</span></span>  
 <span data-ttu-id="3f2ee-235">在 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 和更新版本中，全文檢索目錄是參考一組全文檢索索引的邏輯概念。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-235">In [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] and later versions, a full-text catalog is a logical concept that refers to a group of full-text indexes.</span></span> <span data-ttu-id="3f2ee-236">全文檢索目錄是不屬於任何檔案群組的虛擬物件。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-236">The full-text catalog is a virtual object that does not belong to any filegroup.</span></span> <span data-ttu-id="3f2ee-237">不過，當您將包含全文檢索目錄檔案的 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 資料庫附加至 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 伺服器執行個體時，系統就會從先前的位置附加這些目錄檔案以及其他資料庫檔案，此行為與 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]的行為相同。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-237">However, when you attach a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] database that contains full-text catalog files onto a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] server instance, the catalog files are attached from their previous location along with the other database files, the same as in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span></span>  
  
 <span data-ttu-id="3f2ee-238">在 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 上，每個所附加之全文檢索目錄的狀態都與從 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]中卸離資料庫時的狀態相同。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-238">The state of each attached full-text catalog on [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] is the same as when the database was detached from [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="3f2ee-239">如果卸離作業暫停了任何全文檢索索引母體擴展，就會在 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]上繼續進行母體擴展，而且全文檢索索引會變成可用於全文檢索搜尋。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-239">If any full-text index population was suspended by the detach operation, the population is resumed on [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], and the full-text index becomes available for full-text search.</span></span>  
  
 <span data-ttu-id="3f2ee-240">如果 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 找不到全文檢索目錄檔案，或者在附加作業期間移動了全文檢索檔案，但沒有指定新的位置，此行為就會取決於選取的全文檢索升級選項。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-240">If [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] cannot find a full-text catalog file or if the full-text file was moved during the attach operation without specifying a new location, the behavior depends on the selected full-text upgrade option.</span></span> <span data-ttu-id="3f2ee-241">如果全文檢索升級選項是 [匯入]\*\*\*\* 或 [重建]\*\*\*\*，系統就會重建附加的全文檢索目錄。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-241">If the full-text upgrade option is **Import** or **Rebuild**, the attached full-text catalog is rebuilt.</span></span> <span data-ttu-id="3f2ee-242">如果全文檢索升級選項是 [重設]\*\*\*\*，系統就會重設附加的全文檢索目錄。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-242">If the full-text upgrade option is **Reset**, the attached full-text catalog is reset.</span></span>  
  
 <span data-ttu-id="3f2ee-243">如需卸離和附加資料庫的詳細資訊，請參閱[資料庫卸離和附加 &#40;SQL Server&#41;](../databases/database-detach-and-attach-sql-server.md)、[CREATE DATABASE &#40;SQL Server Transact-SQL&#41;](/sql/t-sql/statements/create-database-sql-server-transact-sql)、[sp_attach_db](/sql/relational-databases/system-stored-procedures/sp-attach-db-transact-sql) 和 [sp_detach_db &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-detach-db-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="3f2ee-243">For more information about detaching and attaching a database, see [Database Detach and Attach &#40;SQL Server&#41;](../databases/database-detach-and-attach-sql-server.md), [CREATE DATABASE &#40;SQL Server Transact-SQL&#41;](/sql/t-sql/statements/create-database-sql-server-transact-sql), [sp_attach_db](/sql/relational-databases/system-stored-procedures/sp-attach-db-transact-sql), and [sp_detach_db &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-detach-db-transact-sql).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3f2ee-244">另請參閱</span><span class="sxs-lookup"><span data-stu-id="3f2ee-244">See Also</span></span>  
 <span data-ttu-id="3f2ee-245">[全文檢索搜尋使用者入門](get-started-with-full-text-search.md) </span><span class="sxs-lookup"><span data-stu-id="3f2ee-245">[Get Started with Full-Text Search](get-started-with-full-text-search.md) </span></span>  
 <span data-ttu-id="3f2ee-246">[設定及管理搜尋的斷詞工具與字幹分析器](configure-and-manage-word-breakers-and-stemmers-for-search.md) </span><span class="sxs-lookup"><span data-stu-id="3f2ee-246">[Configure and Manage Word Breakers and Stemmers for Search](configure-and-manage-word-breakers-and-stemmers-for-search.md) </span></span>  
 [<span data-ttu-id="3f2ee-247">設定及管理搜尋的篩選</span><span class="sxs-lookup"><span data-stu-id="3f2ee-247">Configure and Manage Filters for Search</span></span>](configure-and-manage-filters-for-search.md)  
  
  
