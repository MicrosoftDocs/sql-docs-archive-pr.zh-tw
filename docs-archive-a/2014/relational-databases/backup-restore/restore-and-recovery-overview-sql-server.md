---
title: 還原和復原概觀 (SQL Server) | Microsoft 文件
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- restoring tables [SQL Server]
- backups [SQL Server], restore scenarios
- database backups [SQL Server], restore scenarios
- database restores [SQL Server]
- restoring [SQL Server]
- restores [SQL Server]
- table restores [SQL Server]
- restoring databases [SQL Server], about restoring databases
- database restores [SQL Server], scenarios
ms.assetid: e985c9a6-4230-4087-9fdb-de8571ba5a5f
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 2b8f032dce4f2eb09ef80cfa8c6333de2d563a81
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87705198"
---
# <a name="restore-and-recovery-overview-sql-server"></a><span data-ttu-id="a6ca1-102">還原和復原概觀 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="a6ca1-102">Restore and Recovery Overview (SQL Server)</span></span>
  <span data-ttu-id="a6ca1-103">若要從失敗復原 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資料庫，資料庫管理員必須依邏輯正確和有意義的還原順序來還原一組 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 備份。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-103">To recover a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database from a failure, a database administrator has to restore a set of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] backups in a logically correct and meaningful restore sequence.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a6ca1-104">還原及復原，可從一整個資料庫、單一資料檔或資料頁面的備份還原資料，如下所示：</span><span class="sxs-lookup"><span data-stu-id="a6ca1-104">restore and recovery supports restoring data from backups of a whole database, a data file, or a data page, as follows:</span></span>  
  
-   <span data-ttu-id="a6ca1-105">資料庫 ( *「完整資料庫還原」* (Complete database restore))</span><span class="sxs-lookup"><span data-stu-id="a6ca1-105">The database (a *complete database restore*)</span></span>  
  
     <span data-ttu-id="a6ca1-106">將會還原並復原整個資料庫，且在還原與復原作業期間，資料庫會離線。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-106">The whole database is restored and recovered, and the database is offline for the duration of the restore and recovery operations.</span></span>  
  
-   <span data-ttu-id="a6ca1-107">資料檔 ( *「檔案還原」* )</span><span class="sxs-lookup"><span data-stu-id="a6ca1-107">The data file (a *file restore*)</span></span>  
  
     <span data-ttu-id="a6ca1-108">還原與復原一個資料檔或一組檔案。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-108">A data file or a set of files is restored and recovered.</span></span> <span data-ttu-id="a6ca1-109">在檔案還原過程中，包含該檔案的檔案群組會在還原的持續時間內自動離線。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-109">During a file restore, the filegroups that contain the files are automatically offline for the duration of the restore.</span></span> <span data-ttu-id="a6ca1-110">任何存取離線檔案群組的嘗試都會產生錯誤。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-110">Any attempt to access an offline filegroup causes an error.</span></span>  
  
-   <span data-ttu-id="a6ca1-111">資料頁 ( *「分頁還原」* (Page restore))</span><span class="sxs-lookup"><span data-stu-id="a6ca1-111">The data page (a *page restore*)</span></span>  
  
     <span data-ttu-id="a6ca1-112">在完整復原模式或大量記錄復原模式下，您可以還原各個資料庫。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-112">Under the full recovery model or bulk-logged recovery model, you can restore individual databases.</span></span> <span data-ttu-id="a6ca1-113">不論檔案群組的數目為何，在任何資料庫上都可以執行分頁還原。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-113">Page restores can be performed on any database, regardless of the number of filegroups.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a6ca1-114">備份與還原可以跨所有支援的作業系統運作，不管它們是 64 位元還是 32 位元系統都一樣。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-114">backup and restore work across all supported operating systems, whether they are 64-bit or 32-bit systems.</span></span> <span data-ttu-id="a6ca1-115">如需有關支援的作業系統的詳細資訊，請參閱[安裝 SQL Server 2014 的硬體和軟體需求](../../sql-server/install/hardware-and-software-requirements-for-installing-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-115">For information about the supported operating systems, see [Hardware and Software Requirements for Installing SQL Server 2014](../../sql-server/install/hardware-and-software-requirements-for-installing-sql-server.md).</span></span> <span data-ttu-id="a6ca1-116">如需舊版 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]之備份支援的相關資訊，請參閱 [RESTORE &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-transact-sql)的＜相容性支援＞一節。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-116">For information about support for backups from earlier versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], see the "Compatibility Support" section of [RESTORE &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-transact-sql).</span></span>  
  
 <span data-ttu-id="a6ca1-117">**本主題內容：**</span><span class="sxs-lookup"><span data-stu-id="a6ca1-117">**In this Topic:**</span></span>  
  
-   [<span data-ttu-id="a6ca1-118">還原案例的總覽</span><span class="sxs-lookup"><span data-stu-id="a6ca1-118">Overview of Restore Scenarios</span></span>](#RestoreScenariosOv)  
  
-   [<span data-ttu-id="a6ca1-119">復原模式及支援的還原作業</span><span class="sxs-lookup"><span data-stu-id="a6ca1-119">Recovery Models and Supported Restore Operations</span></span>](#RMsAndSupportedRestoreOps)  
  
-   [<span data-ttu-id="a6ca1-120">簡單復原模式下的還原限制</span><span class="sxs-lookup"><span data-stu-id="a6ca1-120">Restore Restrictions Under the Simple Recovery Model</span></span>](#RMsimpleScenarios)  
  
-   [<span data-ttu-id="a6ca1-121">在大量記錄復原模式下還原</span><span class="sxs-lookup"><span data-stu-id="a6ca1-121">Restore Under the Bulk-Logged Recovery Model</span></span>](#RMblogRestore)  
  
-   [<span data-ttu-id="a6ca1-122">Database Recovery Advisor (SQL Server Management Studio) </span><span class="sxs-lookup"><span data-stu-id="a6ca1-122">Database Recovery Advisor (SQL Server Management Studio)</span></span>](#DRA)  
  
-   [<span data-ttu-id="a6ca1-123">相關內容</span><span class="sxs-lookup"><span data-stu-id="a6ca1-123">Related Content</span></span>](#RelatedContent)  
  
##  <a name="overview-of-restore-scenarios"></a><a name="RestoreScenariosOv"></a> <span data-ttu-id="a6ca1-124">還原案例概觀</span><span class="sxs-lookup"><span data-stu-id="a6ca1-124">Overview of Restore Scenarios</span></span>  
 <span data-ttu-id="a6ca1-125">*中的* 「還原案例」 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] (Restore scenario) 是指先從一個或多個備份還原資料，再復原資料庫的程序。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-125">A *restore scenario* in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is the process of restoring data from one or more backups and then recovering the database.</span></span> <span data-ttu-id="a6ca1-126">支援的還原實例視資料庫的復原模式與 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]的版本而定。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-126">The supported restore scenarios depend on the recovery model of the database and the edition of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="a6ca1-127">下表介紹各種復原模式可能支援的還原實例。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-127">The following table introduces the possible restore scenarios that are supported for different recovery models.</span></span>  
  
|<span data-ttu-id="a6ca1-128">中的</span><span class="sxs-lookup"><span data-stu-id="a6ca1-128">Restore scenario</span></span>|<span data-ttu-id="a6ca1-129">在簡單復原模式下</span><span class="sxs-lookup"><span data-stu-id="a6ca1-129">Under simple recovery model</span></span>|<span data-ttu-id="a6ca1-130">在完整/大量記錄復原模式下</span><span class="sxs-lookup"><span data-stu-id="a6ca1-130">Under full/bulk-logged recovery models</span></span>|  
|----------------------|---------------------------------|----------------------------------------------|  
|<span data-ttu-id="a6ca1-131">完整資料庫還原</span><span class="sxs-lookup"><span data-stu-id="a6ca1-131">Complete database restore</span></span>|<span data-ttu-id="a6ca1-132">這是基本還原策略。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-132">This is the basic restore strategy.</span></span> <span data-ttu-id="a6ca1-133">完整資料庫還原可能只包括還原和復原完整資料庫備份。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-133">A complete database restore might involve simply restoring and recovering a full database backup.</span></span> <span data-ttu-id="a6ca1-134">此外，完整資料庫還原也可能包括還原完整資料庫備份，接著再還原和復原差異備份。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-134">Alternatively, a complete database restore might involve restoring a full database backup followed by restoring and recovering a differential backup.</span></span><br /><br /> <span data-ttu-id="a6ca1-135">如需詳細資訊，請參閱[完整資料庫還原 &#40;簡單復原模式&#41;](complete-database-restores-simple-recovery-model.md)。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-135">For more information, see [Complete Database Restores &#40;Simple Recovery Model&#41;](complete-database-restores-simple-recovery-model.md).</span></span>|<span data-ttu-id="a6ca1-136">這是基本還原策略。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-136">This is the basic restore strategy.</span></span> <span data-ttu-id="a6ca1-137">完整的資料庫還原包括還原完整資料庫備份和選用的差異備份 (如果有的話)，然後依照順序還原所有後續的記錄備份。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-137">A complete database restore involve restoring a full database backup and, optionally, a differential backup (if any), followed by restoring all subsequent log backups (in sequence).</span></span> <span data-ttu-id="a6ca1-138">復原最後一個記錄備份，並且加以還原 (RESTORE WITH RECOVERY)，即完成完整資料庫還原。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-138">The complete database restore is finished by recovering the last log backup and also restoring it (RESTORE WITH RECOVERY).</span></span><br /><br /> <span data-ttu-id="a6ca1-139">如需詳細資訊，請參閱[完整資料庫還原 &#40;完整復原模式&#41;](complete-database-restores-full-recovery-model.md)。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-139">For more information, see [Complete Database Restores &#40;Full Recovery Model&#41;](complete-database-restores-full-recovery-model.md)</span></span>|  
|<span data-ttu-id="a6ca1-140">File restore **\***</span><span class="sxs-lookup"><span data-stu-id="a6ca1-140">File restore **\***</span></span>|<span data-ttu-id="a6ca1-141">還原一個或多個損毀的唯讀檔案，而不還原整個資料庫。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-141">Restore one or more damaged read-only files, without restoring the entire database.</span></span> <span data-ttu-id="a6ca1-142">唯有當資料庫至少有一個唯讀檔案群組時，才能使用檔案還原。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-142">File restore is available only if the database has at least one read-only filegroup.</span></span>|<span data-ttu-id="a6ca1-143">還原一個或多個檔案，而不還原整個資料庫。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-143">Restores one or more files, without restoring the entire database.</span></span> <span data-ttu-id="a6ca1-144">可以在資料庫離線時，或在資料庫仍在線上時 (適用於某些 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]版本) 執行檔案還原。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-144">File restore can be performed while the database is offline or, for some editions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], while the database remains online.</span></span> <span data-ttu-id="a6ca1-145">在檔案還原期間，包含正在還原中之檔案的檔案群組一律為離線狀態。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-145">During a file restore, the filegroups that contain the files that are being restored are always offline.</span></span>|  
|<span data-ttu-id="a6ca1-146">分頁還原</span><span class="sxs-lookup"><span data-stu-id="a6ca1-146">Page restore</span></span>|<span data-ttu-id="a6ca1-147">不適用</span><span class="sxs-lookup"><span data-stu-id="a6ca1-147">Not applicable</span></span>|<span data-ttu-id="a6ca1-148">還原一個或多個損毀的頁面。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-148">Restores one or more damaged pages.</span></span> <span data-ttu-id="a6ca1-149">可以在資料庫離線時，或在資料庫仍在線上時 (適用於某些 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]版本) 執行頁面還原。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-149">Page restore can be performed while the database is offline or, for some editions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], while the database remains online.</span></span> <span data-ttu-id="a6ca1-150">在分頁還原期間，正在還原中的頁面一律為離線狀態。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-150">During a page restore, the pages that are being restored are always offline.</span></span><br /><br /> <span data-ttu-id="a6ca1-151">未中斷的記錄備份鏈結必須可用 (直到目前記錄檔)，而且它們必須全都套用，才能使分頁與目前記錄檔保持一樣新。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-151">An unbroken chain of log backups must be available, up to the current log file, and they must all be applied to bring the page up to date with the current log file.</span></span><br /><br /> <span data-ttu-id="a6ca1-152">如需詳細資訊，請參閱[還原頁面 &#40;SQL Server&#41;](restore-pages-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-152">For more information, see [Restore Pages &#40;SQL Server&#41;](restore-pages-sql-server.md).</span></span>|  
|<span data-ttu-id="a6ca1-153">分次還原 **\***</span><span class="sxs-lookup"><span data-stu-id="a6ca1-153">Piecemeal restore **\***</span></span>|<span data-ttu-id="a6ca1-154">在檔案群組層級上，從主要檔案群組開始，接著是所有讀取/寫入次要檔案群組，分階段還原和復原資料庫。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-154">Restore and recover the database in stages at the filegroup level, starting with the primary and all read/write, secondary filegroups.</span></span>|<span data-ttu-id="a6ca1-155">從主要檔案群組開始，在檔案群組層級上分階段還原和復原資料庫。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-155">Restore and recover the database in stages at the filegroup level, starting with the primary filegroup.</span></span>|  
  
 <span data-ttu-id="a6ca1-156">**\*** 只有 Enterprise 版才支援線上還原。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-156">**\*** Online restore is supported only in the Enterprise edition.</span></span>  
  
 <span data-ttu-id="a6ca1-157">不論還原資料的方式如何，在復原資料庫之前， [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] 保證整個資料庫在邏輯上是一致的。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-157">Regardless of how data is restored, before a database can be recovered, the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] guarantees that the whole database is logically consistent.</span></span> <span data-ttu-id="a6ca1-158">例如，如果您要還原檔案，除非您已經將其向前復原到足以和資料庫保持一致的程度，否則無法加以復原並使其回到線上。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-158">For example, if you restore a file, you cannot recover it and bring it online until it has been rolled far enough forward to be consistent with the database.</span></span>  
  
### <a name="advantages-of-a-file-or-page-restore"></a><span data-ttu-id="a6ca1-159">檔案或分頁還原的優點</span><span class="sxs-lookup"><span data-stu-id="a6ca1-159">Advantages of a File or Page Restore</span></span>  
 <span data-ttu-id="a6ca1-160">還原與復原檔案或頁面 (而非整個資料庫) 可提供下列優點：</span><span class="sxs-lookup"><span data-stu-id="a6ca1-160">Restoring and recovering files or pages, instead of the whole database, provides the following advantages:</span></span>  
  
-   <span data-ttu-id="a6ca1-161">還原較少的資料，可縮短複製和復原資料所需的時間。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-161">Restoring less data reduces the time required to copy and recover it.</span></span>  
  
-   <span data-ttu-id="a6ca1-162">在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 上，還原檔案或頁面可以讓資料庫中的其他資料在還原作業期間維持線上狀態。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-162">On [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] restoring files or pages might allow other data in the database to remain online during the restore operation.</span></span>  
  
##  <a name="recovery-models-and-supported-restore-operations"></a><a name="RMsAndSupportedRestoreOps"></a><span data-ttu-id="a6ca1-163">復原模式及支援的還原作業</span><span class="sxs-lookup"><span data-stu-id="a6ca1-163">Recovery Models and Supported Restore Operations</span></span>  
 <span data-ttu-id="a6ca1-164">資料庫可用的還原作業，取決於其復原模式。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-164">The restore operations that are available for a database depend on its recovery model.</span></span> <span data-ttu-id="a6ca1-165">下表摘要說明每一種復原模式是否支援給定的還原實例，及其支援的範圍。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-165">The following table summarizes whether and to what extent each of the recovery models supports a given restore scenario.</span></span>  
  
|<span data-ttu-id="a6ca1-166">還原作業</span><span class="sxs-lookup"><span data-stu-id="a6ca1-166">Restore operation</span></span>|<span data-ttu-id="a6ca1-167">完整復原模式</span><span class="sxs-lookup"><span data-stu-id="a6ca1-167">Full recovery model</span></span>|<span data-ttu-id="a6ca1-168">大量記錄復原模式</span><span class="sxs-lookup"><span data-stu-id="a6ca1-168">Bulk-logged recovery model</span></span>|<span data-ttu-id="a6ca1-169">簡單復原模式</span><span class="sxs-lookup"><span data-stu-id="a6ca1-169">Simple recovery model</span></span>|  
|-----------------------|-------------------------|---------------------------------|---------------------------|  
|<span data-ttu-id="a6ca1-170">資料復原</span><span class="sxs-lookup"><span data-stu-id="a6ca1-170">Data recovery</span></span>|<span data-ttu-id="a6ca1-171">完整復原 (如果有記錄可以使用)。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-171">Complete recovery (if the log is available).</span></span>|<span data-ttu-id="a6ca1-172">有損失部分資料的風險。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-172">Some data-loss exposure.</span></span>|<span data-ttu-id="a6ca1-173">自上次完整或差異備份之後的任何資料，都會遺失。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-173">Any data since last full or differential backup is lost.</span></span>|  
|<span data-ttu-id="a6ca1-174">時間點還原</span><span class="sxs-lookup"><span data-stu-id="a6ca1-174">Point-in-time restore</span></span>|<span data-ttu-id="a6ca1-175">記錄備份涵蓋的任何時間。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-175">Any time covered by the log backups.</span></span>|<span data-ttu-id="a6ca1-176">如果記錄備份含有大量記錄變更，則不允許。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-176">Disallowed if the log backup contains any bulk-logged changes.</span></span>|<span data-ttu-id="a6ca1-177">不支援。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-177">Not supported.</span></span>|  
|<span data-ttu-id="a6ca1-178">File restore **\***</span><span class="sxs-lookup"><span data-stu-id="a6ca1-178">File restore **\***</span></span>|<span data-ttu-id="a6ca1-179">完整支援。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-179">Full support.</span></span>|<span data-ttu-id="a6ca1-180">有時。 **\*\***</span><span class="sxs-lookup"><span data-stu-id="a6ca1-180">Sometimes.**\*\***</span></span>|<span data-ttu-id="a6ca1-181">僅適用於唯讀的次要檔案。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-181">Available only for read-only secondary files.</span></span>|  
|<span data-ttu-id="a6ca1-182">Page restore **\***</span><span class="sxs-lookup"><span data-stu-id="a6ca1-182">Page restore **\***</span></span>|<span data-ttu-id="a6ca1-183">完整支援。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-183">Full support.</span></span>|<span data-ttu-id="a6ca1-184">有時。 **\*\***</span><span class="sxs-lookup"><span data-stu-id="a6ca1-184">Sometimes.**\*\***</span></span>|<span data-ttu-id="a6ca1-185">無。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-185">None.</span></span>|  
|<span data-ttu-id="a6ca1-186">分次 (檔案群組-等級) 還原 **\***</span><span class="sxs-lookup"><span data-stu-id="a6ca1-186">Piecemeal (filegroup-level) restore **\***</span></span>|<span data-ttu-id="a6ca1-187">完整支援。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-187">Full support.</span></span>|<span data-ttu-id="a6ca1-188">有時。 **\*\***</span><span class="sxs-lookup"><span data-stu-id="a6ca1-188">Sometimes.**\*\***</span></span>|<span data-ttu-id="a6ca1-189">僅適用於唯讀的次要檔案。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-189">Available only for read-only secondary files.</span></span>|  
  
 <span data-ttu-id="a6ca1-190">**\*** 只有 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="a6ca1-190">**\*** Available only in the Enterprise edition of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span></span>  
  
 <span data-ttu-id="a6ca1-191">**\*\*** 如需了解必要條件，請參閱此主題稍後的 [簡單復原模式下的還原限制](#RMsimpleScenarios)。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-191">**\*\*** For the required conditions, see [Restore Restrictions Under the Simple Recovery Model](#RMsimpleScenarios), later in this topic.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="a6ca1-192">不論資料庫的復原模式為何，比建立備份之版本還舊的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 版本，都無法還原 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 備份。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-192">Regardless of the recovery model of a database, a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] backup cannot be restored by a version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that is older than the version that created the backup.</span></span>  
  
##  <a name="restore-scenarios-under-the-simple-recovery-model"></a><a name="RMsimpleScenarios"></a><span data-ttu-id="a6ca1-193">簡單復原模式下的還原案例</span><span class="sxs-lookup"><span data-stu-id="a6ca1-193">Restore Scenarios Under the Simple Recovery Model</span></span>  
 <span data-ttu-id="a6ca1-194">簡單復原模式在還原作業上具有下列限制：</span><span class="sxs-lookup"><span data-stu-id="a6ca1-194">The simple recovery model imposes the following restrictions on restore operations:</span></span>  
  
-   <span data-ttu-id="a6ca1-195">檔案還原及分次還原僅適用於唯讀的次要檔案群組。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-195">File restore and piecemeal restore are available only for read-only secondary filegroups.</span></span> <span data-ttu-id="a6ca1-196">如需有關這些資訊還原案例，請參閱[檔案還原 &#40;簡單復原模式&#41;](file-restores-simple-recovery-model.md) 和[分次還原 &#40;SQL Server&#41;](piecemeal-restores-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-196">For information about these restore scenarios, see [File Restores &#40;Simple Recovery Model&#41;](file-restores-simple-recovery-model.md) and [Piecemeal Restores &#40;SQL Server&#41;](piecemeal-restores-sql-server.md).</span></span>  
  
-   <span data-ttu-id="a6ca1-197">不允許分頁還原。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-197">Page restore is not allowed.</span></span>  
  
-   <span data-ttu-id="a6ca1-198">不允許時間點還原。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-198">Point-in-time restore is not allowed.</span></span>  
  
 <span data-ttu-id="a6ca1-199">如果這些限制中有任何一項不適合您的復原需要，即建議您考慮使用完整復原模式。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-199">If any of these restrictions are inappropriate for your recovery needs, we recommend that you consider using the full recovery model.</span></span> <span data-ttu-id="a6ca1-200">如需詳細資訊，請參閱 [備份概觀 &#40;SQL Server&#41;](backup-overview-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-200">For more information, see [Backup Overview &#40;SQL Server&#41;](backup-overview-sql-server.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="a6ca1-201">不論資料庫的復原模式為何，比建立備份之版本還舊的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 版本，都無法還原 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 備份。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-201">Regardless of the recovery model of a database, a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] backup cannot be restored by a version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that is older than the version that created the backup.</span></span>  
  
##  <a name="restore-under-the-bulk-logged-recovery-model"></a><a name="RMblogRestore"></a> <span data-ttu-id="a6ca1-202">大量記錄復原模式下的還原</span><span class="sxs-lookup"><span data-stu-id="a6ca1-202">Restore Under the Bulk-Logged Recovery Model</span></span>  
 <span data-ttu-id="a6ca1-203">本節討論大量記錄復原模式的特殊還原考量，此為專門用做完整復原模式的補充。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-203">This section discusses restore considerations that are unique to bulk-logged recovery model, which is intended exclusively as a supplement to the full recovery model.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a6ca1-204">如需大量記錄復原模式的介紹，請參閱[交易記錄 &#40;SQL Server&#41;](../logs/the-transaction-log-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-204">For an introduction to the bulk-logged recovery model, see [The Transaction Log &#40;SQL Server&#41;](../logs/the-transaction-log-sql-server.md).</span></span>  
  
 <span data-ttu-id="a6ca1-205">一般而言，大量記錄復原模式與完整復原模式類似，針對完整復原模式所描述的資訊也同時適用於兩者。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-205">Generally, the bulk-logged recovery model is similar to the full recovery model, and the information described for the full recovery model also applies to both.</span></span> <span data-ttu-id="a6ca1-206">但是，大量記錄復原模式會影響時間點復原與線上還原。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-206">However, point-in-time recovery and online restore are affected by the bulk-logged recovery model.</span></span>  
  
### <a name="restrictions-for-point-in-time-recovery"></a><span data-ttu-id="a6ca1-207">時間點復原的限制</span><span class="sxs-lookup"><span data-stu-id="a6ca1-207">Restrictions for Point-in-time Recovery</span></span>  
 <span data-ttu-id="a6ca1-208">如果大量記錄復原模式下建立的記錄備份包含大量記錄變更，就不允許時間點復原。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-208">If a log backup taken under the bulk-logged recovery model contains bulk-logged changes, point-in-time recovery is not allowed.</span></span> <span data-ttu-id="a6ca1-209">嘗試對包含大量變更的記錄備份執行時間點復原將會造成還原作業失敗。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-209">Trying to perform point-in-time recovery on a log backup that contains bulk changes will cause the restore operation to fail.</span></span>  
  
### <a name="restrictions-for-online-restore"></a><span data-ttu-id="a6ca1-210">對線上還原的限制</span><span class="sxs-lookup"><span data-stu-id="a6ca1-210">Restrictions for Online Restore</span></span>  
 <span data-ttu-id="a6ca1-211">線上還原順序只有在符合下列條件時才能運作：</span><span class="sxs-lookup"><span data-stu-id="a6ca1-211">An online restore sequence works only if the following conditions are met:</span></span>  
  
-   <span data-ttu-id="a6ca1-212">必須在開始還原順序之前完成所有必要的記錄備份。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-212">All required log backups must have been taken before the restore sequence starts.</span></span>  
  
-   <span data-ttu-id="a6ca1-213">必須在開始線上還原順序之前先備份大量變更。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-213">Bulk changes must be backed before starting the online restore sequence.</span></span>  
  
-   <span data-ttu-id="a6ca1-214">如果資料庫中有大量變更存在，所有的檔案都必須在線上，或者是[無用](remove-defunct-filegroups-sql-server.md)</span><span class="sxs-lookup"><span data-stu-id="a6ca1-214">If bulk changes exist in the database, all files must be either online or[defunct](remove-defunct-filegroups-sql-server.md).</span></span> <span data-ttu-id="a6ca1-215">(這表示它不再是資料庫的一部分)。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-215">(This means that it is no longer part of the database.)</span></span>  
  
 <span data-ttu-id="a6ca1-216">如果沒有符合這些條件，線上還原順序就會失敗。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-216">If these conditions are not met, the online restore sequence fails.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a6ca1-217">我們建議您先切換到完整復原模式，再開始線上還原。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-217">We recommend switching to the full recovery model before starting an online restore.</span></span> <span data-ttu-id="a6ca1-218">如需詳細資訊，請參閱[復原模式 &#40;SQL Server &#41;](recovery-models-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-218">For more information, see [Recovery Models &#40;SQL Server&#41;](recovery-models-sql-server.md).</span></span>  
  
 <span data-ttu-id="a6ca1-219">如需有關如何執行線上還原的詳細資訊，請參閱[線上還原 &#40;SQL Server&#41;](online-restore-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-219">For information about how to perform an online restore, see [Online Restore &#40;SQL Server&#41;](online-restore-sql-server.md).</span></span>  
  
##  <a name="database-recovery-advisor-sql-server-management-studio"></a><a name="DRA"></a> <span data-ttu-id="a6ca1-220">Database Recovery Advisor (SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="a6ca1-220">Database Recovery Advisor (SQL Server Management Studio)</span></span>  
 <span data-ttu-id="a6ca1-221">Database Recovery Advisor 有助於建構實作最佳化正確還原順序的還原計畫。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-221">The Database Recovery Advisor facilitates constructing restore plans that implement optimal correct restore sequences.</span></span> <span data-ttu-id="a6ca1-222">我們已經處理了客戶所要求的許多已知資料庫還原問題和增強功能。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-222">Many known database restore issues and enhancements requested by customers have been addressed.</span></span> <span data-ttu-id="a6ca1-223">Database Recovery Advisor 導入的主要增強功能包括：</span><span class="sxs-lookup"><span data-stu-id="a6ca1-223">Major enhancements introduced by the Database Recovery Advisor include the following:</span></span>  
  
-   <span data-ttu-id="a6ca1-224">**還原計畫演算法：** 用來建構還原計畫的演算法已經大幅改善，特別是針對複雜的還原狀況。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-224">**Restore-plan algorithm:**  The algorithm used to construct restore plans has improved significantly, particularly for complex restore scenarios.</span></span> <span data-ttu-id="a6ca1-225">相較於舊版 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]而言，可更有效率地處理許多邊緣案例 (包括時間點還原的分岔案例)。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-225">Many edge cases, including forking scenarios in point-in-time restores, are handled more efficiently than in previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="a6ca1-226">**時間點還原：** Database Recovery Advisor 大幅簡化了將資料庫還原到特定時間點的作業。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-226">**Point-in-time restores:**  The Database Recovery Advisor greatly simplifies restoring a database to a given point in time.</span></span> <span data-ttu-id="a6ca1-227">視覺備份時間表大幅增強時間點還原的支援。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-227">A visual backup timeline significantly enhances support for point-in-time restores.</span></span> <span data-ttu-id="a6ca1-228">這個視覺化時間表可讓您識別當做還原資料庫之目標復原點的可行時間點。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-228">This visual timeline allows you to identify a feasible point in time as the target recovery point for restoring a database.</span></span> <span data-ttu-id="a6ca1-229">時間表可加快周遊分岔復原路徑 (跨多個復原分岔之路徑)。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-229">The timeline facilitates traversing a forked recovery path (a path that spans recovery forks).</span></span> <span data-ttu-id="a6ca1-230">特定時間點還原計畫會自動包含與還原至目標時間點 (日期和時間) 有關的備份。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-230">A given point-in-time restore plan automatically includes the backups that are relevant to the restoring to your target point in time (date and time).</span></span> <span data-ttu-id="a6ca1-231">如需詳細資訊，請參閱[將 SQL Server 資料庫還原至某個時間點 &#40;完整復原模式&#41;](restore-a-sql-server-database-to-a-point-in-time-full-recovery-model.md)。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-231">For more information, see [Restore a SQL Server Database to a Point in Time &#40;Full Recovery Model&#41;](restore-a-sql-server-database-to-a-point-in-time-full-recovery-model.md).</span></span>  
  
 <span data-ttu-id="a6ca1-232">如需有關 Database Recovery Advisor 的詳細資訊，請參閱下列 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 管理能力部落格：</span><span class="sxs-lookup"><span data-stu-id="a6ca1-232">For more information, see about the Database Recovery Advisor, see the following [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Manageability blogs:</span></span>  
  
-   <span data-ttu-id="a6ca1-233">[Recovery Advisor：簡介](https://blogs.msdn.com/b/managingsql/archive/2011/07/13/recovery-advisor-an-introduction.aspx) \(英文\)</span><span class="sxs-lookup"><span data-stu-id="a6ca1-233">[Recovery Advisor: An Introduction](https://blogs.msdn.com/b/managingsql/archive/2011/07/13/recovery-advisor-an-introduction.aspx)</span></span>  
  
-   <span data-ttu-id="a6ca1-234">[Recovery Advisor：使用 SSMS 來建立/還原分割備份](https://docs.microsoft.com/archive/blogs/managingsql/recovery-advisor-using-ssms-to-createrestore-split-backups) \(英文\)</span><span class="sxs-lookup"><span data-stu-id="a6ca1-234">[Recovery Advisor: Using SSMS to create/restore split backups](https://docs.microsoft.com/archive/blogs/managingsql/recovery-advisor-using-ssms-to-createrestore-split-backups)</span></span>  
  
##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="a6ca1-235">相關內容</span><span class="sxs-lookup"><span data-stu-id="a6ca1-235">Related Content</span></span>  
 <span data-ttu-id="a6ca1-236">無。</span><span class="sxs-lookup"><span data-stu-id="a6ca1-236">None.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a6ca1-237">另請參閱</span><span class="sxs-lookup"><span data-stu-id="a6ca1-237">See Also</span></span>  
 [<span data-ttu-id="a6ca1-238">備份概觀 &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="a6ca1-238">Backup Overview &#40;SQL Server&#41;</span></span>](backup-overview-sql-server.md)  
  
  
