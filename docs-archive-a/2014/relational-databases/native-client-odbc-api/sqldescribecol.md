---
title: SQLDescribeCol |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLDescribeCol function
ms.assetid: ffbf34c6-8268-434f-829a-82009a6cda59
author: rothja
ms.author: jroth
ms.openlocfilehash: bc7ca9602e433f5e9ad26c39117e216eb0cc9564
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87705118"
---
# <a name="sqldescribecol"></a><span data-ttu-id="443bd-102">SQLDescribeCol</span><span class="sxs-lookup"><span data-stu-id="443bd-102">SQLDescribeCol</span></span>
  <span data-ttu-id="443bd-103">針對執行的語句， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native CLIENT ODBC 驅動程式不需要查詢伺服器來描述結果集中的資料行。</span><span class="sxs-lookup"><span data-stu-id="443bd-103">For executed statements, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does not need to query the server to describe columns in a result set.</span></span> <span data-ttu-id="443bd-104">在此情況下， `SQLDescribeCol` 並不會造成伺服器往返。</span><span class="sxs-lookup"><span data-stu-id="443bd-104">In this case, `SQLDescribeCol` does not cause a server roundtrip.</span></span> <span data-ttu-id="443bd-105">如同[SQLColAttribute](sqlnumresultcols.md)， `SQLDescribeCol` 在已備妥但未執行的語句上呼叫，會產生伺服器往返。</span><span class="sxs-lookup"><span data-stu-id="443bd-105">Like [SQLColAttribute](sqlnumresultcols.md), calling `SQLDescribeCol` on prepared but not executed statements generates a server roundtrip.</span></span>  
  
 <span data-ttu-id="443bd-106">當 [!INCLUDE[tsql](../../includes/tsql-md.md)] 陳述式或陳述式批次傳回多個結果資料列集時，按序數參考的資料行有可能源自於個別的資料表，或是參考結果集中完全不同的資料行。</span><span class="sxs-lookup"><span data-stu-id="443bd-106">When a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement or statement batch returns multiple result row sets, it is possible for a column, referenced by ordinal, to originate in a separate table or to refer to an entirely different column in the result set.</span></span> <span data-ttu-id="443bd-107">`SQLDescribeCol`應針對每個集合呼叫。</span><span class="sxs-lookup"><span data-stu-id="443bd-107">`SQLDescribeCol` should be called for each set.</span></span> <span data-ttu-id="443bd-108">當結果集變更時，應用程式應該在提取資料列結果以前先重新繫結資料值。</span><span class="sxs-lookup"><span data-stu-id="443bd-108">When the result set changes, the application should rebind data values prior to fetching row results.</span></span> <span data-ttu-id="443bd-109">如需有關處理多個結果集傳回的詳細資訊，請參閱[SQLMoreResults](sqlmoreresults.md)。</span><span class="sxs-lookup"><span data-stu-id="443bd-109">For more information about handling multiple result set returns, see [SQLMoreResults](sqlmoreresults.md).</span></span>  
  
 <span data-ttu-id="443bd-110">當已備妥的 SQL 陳述式批次產生多個結果集時，只有第一個結果集會報告資料行屬性。</span><span class="sxs-lookup"><span data-stu-id="443bd-110">Column attributes are reported for only the first result set when multiple result sets are generated by a prepared batch of SQL statements.</span></span>  
  
 <span data-ttu-id="443bd-111">對於大數值資料類型，在*DataTypePtr*中傳回的值是 SQL_VARCHAR、SQL_VARBINARY 或 SQL_NVARCHAR。</span><span class="sxs-lookup"><span data-stu-id="443bd-111">For large value data types, the value returned in *DataTypePtr* is SQL_VARCHAR, SQL_VARBINARY, or SQL_NVARCHAR.</span></span> <span data-ttu-id="443bd-112">*ColumnSizePtr*中的 SQL_SS_LENGTH_UNLIMITED 值表示大小為「無限制」。</span><span class="sxs-lookup"><span data-stu-id="443bd-112">A value of SQL_SS_LENGTH_UNLIMITED in *ColumnSizePtr* indicates that the size is "unlimited".</span></span>  
  
 <span data-ttu-id="443bd-113">從開始，database engine 的改進 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] 可讓 SQLDescribeCol 取得預期結果的更精確描述。</span><span class="sxs-lookup"><span data-stu-id="443bd-113">Improvements in the database engine starting with [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] allow SQLDescribeCol to obtain more accurate descriptions of the expected results.</span></span> <span data-ttu-id="443bd-114">這些更精確的結果可能與舊版的 SQLDescribeCol 所傳回的值不同 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="443bd-114">These more accurate results may differ from the values returned by SQLDescribeCol in previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="443bd-115">如需詳細資訊，請參閱[中繼資料探索](../native-client/features/metadata-discovery.md)。</span><span class="sxs-lookup"><span data-stu-id="443bd-115">For more information, see [Metadata Discovery](../native-client/features/metadata-discovery.md).</span></span>  
  
## <a name="sqldescribecol-support-for-enhanced-date-and-time-features"></a><span data-ttu-id="443bd-116">SQLDescribeCol 對增強型日期和時間功能的支援</span><span class="sxs-lookup"><span data-stu-id="443bd-116">SQLDescribeCol Support for Enhanced Date and Time Features</span></span>  
 <span data-ttu-id="443bd-117">針對日期/時間類型所傳回的值如下：</span><span class="sxs-lookup"><span data-stu-id="443bd-117">The values returned for date/time types are as follows:</span></span>  
  
||<span data-ttu-id="443bd-118">*DataTypePtr*</span><span class="sxs-lookup"><span data-stu-id="443bd-118">*DataTypePtr*</span></span>|<span data-ttu-id="443bd-119">*ColumnSizePtr*</span><span class="sxs-lookup"><span data-stu-id="443bd-119">*ColumnSizePtr*</span></span>|<span data-ttu-id="443bd-120">*DecimalDigitsPtr*</span><span class="sxs-lookup"><span data-stu-id="443bd-120">*DecimalDigitsPtr*</span></span>|  
|-|-------------------|---------------------|------------------------|  
|<span data-ttu-id="443bd-121">Datetime</span><span class="sxs-lookup"><span data-stu-id="443bd-121">datetime</span></span>|<span data-ttu-id="443bd-122">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="443bd-122">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="443bd-123">23</span><span class="sxs-lookup"><span data-stu-id="443bd-123">23</span></span>|<span data-ttu-id="443bd-124">3</span><span class="sxs-lookup"><span data-stu-id="443bd-124">3</span></span>|  
|<span data-ttu-id="443bd-125">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="443bd-125">smalldatetime</span></span>|<span data-ttu-id="443bd-126">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="443bd-126">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="443bd-127">16</span><span class="sxs-lookup"><span data-stu-id="443bd-127">16</span></span>|<span data-ttu-id="443bd-128">0</span><span class="sxs-lookup"><span data-stu-id="443bd-128">0</span></span>|  
|<span data-ttu-id="443bd-129">date</span><span class="sxs-lookup"><span data-stu-id="443bd-129">date</span></span>|<span data-ttu-id="443bd-130">SQL_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="443bd-130">SQL_TYPE_DATE</span></span>|<span data-ttu-id="443bd-131">10</span><span class="sxs-lookup"><span data-stu-id="443bd-131">10</span></span>|<span data-ttu-id="443bd-132">0</span><span class="sxs-lookup"><span data-stu-id="443bd-132">0</span></span>|  
|<span data-ttu-id="443bd-133">time</span><span class="sxs-lookup"><span data-stu-id="443bd-133">time</span></span>|<span data-ttu-id="443bd-134">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="443bd-134">SQL_SS_TIME2</span></span>|<span data-ttu-id="443bd-135">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="443bd-135">8, 10..16</span></span>|<span data-ttu-id="443bd-136">0..7</span><span class="sxs-lookup"><span data-stu-id="443bd-136">0..7</span></span>|  
|<span data-ttu-id="443bd-137">datetime2</span><span class="sxs-lookup"><span data-stu-id="443bd-137">datetime2</span></span>|<span data-ttu-id="443bd-138">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="443bd-138">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="443bd-139">19, 21..27</span><span class="sxs-lookup"><span data-stu-id="443bd-139">19, 21..27</span></span>|<span data-ttu-id="443bd-140">0..7</span><span class="sxs-lookup"><span data-stu-id="443bd-140">0..7</span></span>|  
|<span data-ttu-id="443bd-141">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="443bd-141">datetimeoffset</span></span>|<span data-ttu-id="443bd-142">SQL_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="443bd-142">SQL_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="443bd-143">26, 28..34</span><span class="sxs-lookup"><span data-stu-id="443bd-143">26, 28..34</span></span>|<span data-ttu-id="443bd-144">0..7</span><span class="sxs-lookup"><span data-stu-id="443bd-144">0..7</span></span>|  
  
 <span data-ttu-id="443bd-145">如需詳細資訊，請參閱[ODBC&#41;&#40;的日期和時間改善](../native-client-odbc-date-time/date-and-time-improvements-odbc.md)。</span><span class="sxs-lookup"><span data-stu-id="443bd-145">For more information, see [Date and Time Improvements &#40;ODBC&#41;](../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span></span>  
  
## <a name="sqldescribecol-support-for-large-clr-udts"></a><span data-ttu-id="443bd-146">SQLDescribeCol 對於大型 CLR UDT 的支援</span><span class="sxs-lookup"><span data-stu-id="443bd-146">SQLDescribeCol Support for Large CLR UDTs</span></span>  
 <span data-ttu-id="443bd-147">`SQLDescribeCol` 支援大型 CLR 使用者定義型別 (UDT)。</span><span class="sxs-lookup"><span data-stu-id="443bd-147">`SQLDescribeCol` supports large CLR user-defined types (UDTs).</span></span> <span data-ttu-id="443bd-148">如需詳細資訊，請參閱[&#40;ODBC&#41;的大型 CLR 使用者定義類型](../native-client/odbc/large-clr-user-defined-types-odbc.md)。</span><span class="sxs-lookup"><span data-stu-id="443bd-148">For more information, see [Large CLR User-Defined Types &#40;ODBC&#41;](../native-client/odbc/large-clr-user-defined-types-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="443bd-149">另請參閱</span><span class="sxs-lookup"><span data-stu-id="443bd-149">See Also</span></span>  
 <span data-ttu-id="443bd-150">[SQLDescribeCol 函式](https://go.microsoft.com/fwlink/?LinkID=59338) </span><span class="sxs-lookup"><span data-stu-id="443bd-150">[SQLDescribeCol Function](https://go.microsoft.com/fwlink/?LinkID=59338) </span></span>  
 [<span data-ttu-id="443bd-151">ODBC API 實作詳細資料</span><span class="sxs-lookup"><span data-stu-id="443bd-151">ODBC API Implementation Details</span></span>](odbc-api-implementation-details.md)  
  
  
