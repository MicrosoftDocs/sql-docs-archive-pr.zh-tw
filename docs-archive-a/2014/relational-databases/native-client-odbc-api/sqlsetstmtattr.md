---
title: SQLSetStmtAttr |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLSetStmtAttr function
ms.assetid: 799c80fd-c561-4912-8562-9229076dfd19
author: rothja
ms.author: jroth
ms.openlocfilehash: 725a7917f817af44f17f8da06d484171cbe9a25d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87595964"
---
# <a name="sqlsetstmtattr"></a><span data-ttu-id="495ff-102">SQLSetStmtAttr</span><span class="sxs-lookup"><span data-stu-id="495ff-102">SQLSetStmtAttr</span></span>
  <span data-ttu-id="495ff-103">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC 驅動程式不支援混合式 (索引鍵集/動態) 資料指標模型。</span><span class="sxs-lookup"><span data-stu-id="495ff-103">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does not support the mixed (keyset/dynamic) cursor model.</span></span> <span data-ttu-id="495ff-104">如果設定的值不等於 0，使用 SQL_ATTR_KEYSET_SIZE 設定索引鍵值大小的嘗試將會失敗。</span><span class="sxs-lookup"><span data-stu-id="495ff-104">Attempts to set the keyset size using SQL_ATTR_KEYSET_SIZE will fail if the value set is not equal to 0.</span></span>  
  
 <span data-ttu-id="495ff-105">應用程式會在所有語句上設定 SQL_ATTR_ROW_ARRAY_SIZE，以宣告**SQLFetch**或[SQLFetchScroll](sqlfetchscroll.md)函式呼叫所傳回的資料列數目。</span><span class="sxs-lookup"><span data-stu-id="495ff-105">The application sets SQL_ATTR_ROW_ARRAY_SIZE on all statements to declare the number of rows returned on a **SQLFetch** or [SQLFetchScroll](sqlfetchscroll.md) function call.</span></span> <span data-ttu-id="495ff-106">在表示伺服器資料指標的陳述式上，驅動程式會使用 SQL_ATTR_ROW_ARRAY_SIZE 決定伺服器所產生之資料列區塊的大小以滿足來自資料指標的提取要求。</span><span class="sxs-lookup"><span data-stu-id="495ff-106">On statements indicating a server cursor, the driver uses SQL_ATTR_ROW_ARRAY_SIZE to determine the size of the block of rows the server generates to satisfy a fetch request from the cursor.</span></span> <span data-ttu-id="495ff-107">在動態資料指標的區塊大小內，如果交易隔離等級足以確保可重複讀取已認可的交易，資料列成員資格與排序是固定的。</span><span class="sxs-lookup"><span data-stu-id="495ff-107">Within the block size of a dynamic cursor, row membership and ordering are fixed if the transaction isolation level is sufficient to ensure repeatable reads of committed transactions.</span></span> <span data-ttu-id="495ff-108">在此值指出的區塊之外，資料指標是完全動態的。</span><span class="sxs-lookup"><span data-stu-id="495ff-108">The cursor is completely dynamic outside of the block indicated by this value.</span></span> <span data-ttu-id="495ff-109">伺服器資料指標區塊大小是完全動態的，而且可以在提取處理的任何點變更。</span><span class="sxs-lookup"><span data-stu-id="495ff-109">Server cursor block size is completely dynamic and can be changed at any point in fetch processing.</span></span>  
  
## <a name="sqlsetstmtattr-and-table-valued-parameters"></a><span data-ttu-id="495ff-110">SQLSetStmtAttr 和資料表值參數</span><span class="sxs-lookup"><span data-stu-id="495ff-110">SQLSetStmtAttr and Table-Valued Parameters</span></span>  
 <span data-ttu-id="495ff-111">SQLSetStmtAttr 可以用來設定應用程式參數描述元中的 SQL_SOPT_SS_PARAM_FOCUS (APD) ，然後再存取資料表值參數資料行的描述項欄位。</span><span class="sxs-lookup"><span data-stu-id="495ff-111">SQLSetStmtAttr can be used to set SQL_SOPT_SS_PARAM_FOCUS in the application parameter descriptor (APD) before accessing descriptor fields for table-valued parameter columns.</span></span>  
  
 <span data-ttu-id="495ff-112">如果嘗試將 SQL_SOPT_SS_PARAM_FOCUS 設定為不是資料表值參數之參數的序數，則 SQLSetStmtAttr 會傳回 SQL_ERROR 並使用 SQLSTATE = HY024 和訊息「不正確屬性值」來建立診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="495ff-112">If an attempt is made to set SQL_SOPT_SS_PARAM_FOCUS to the ordinal of a parameter that is not a table-valued parameter, SQLSetStmtAttr returns SQL_ERROR and a diagnostic record is created with SQLSTATE = HY024 and the message "Invalid attribute value".</span></span> <span data-ttu-id="495ff-113">當傳回 SQL_ERROR 時，SQL_SOPT_SS_PARAM_FOCUS 不會變更。</span><span class="sxs-lookup"><span data-stu-id="495ff-113">SQL_SOPT_SS_PARAM_FOCUS is not changed when SQL_ERROR is returned.</span></span>  
  
 <span data-ttu-id="495ff-114">將 SQL_SOPT_SS_PARAM_FOCUS 設定為 0 會還原參數之描述項記錄的存取權。</span><span class="sxs-lookup"><span data-stu-id="495ff-114">Setting SQL_SOPT_SS_PARAM_FOCUS to 0 restores access to descriptor records for parameters.</span></span>  
  
 <span data-ttu-id="495ff-115">SQLSetStmtAttr 也可以用來設定 SQL_SOPT_SS_NAME_SCOPE。</span><span class="sxs-lookup"><span data-stu-id="495ff-115">SQLSetStmtAttr can also be used to set SQL_SOPT_SS_NAME_SCOPE.</span></span> <span data-ttu-id="495ff-116">如需詳細資訊，請參閱本主題稍後的「SQL_SOPT_SS_NAME_SCOPE」一節。</span><span class="sxs-lookup"><span data-stu-id="495ff-116">For more information, see the SQL_SOPT_SS_NAME_SCOPE section, later in this topic.</span></span>  
  
 <span data-ttu-id="495ff-117">如需詳細資訊，請參閱備妥之[語句的資料表值參數中繼資料](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md)。</span><span class="sxs-lookup"><span data-stu-id="495ff-117">For more information, see [Table-Valued Parameter Metadata for Prepared Statements](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md).</span></span>  
  
 <span data-ttu-id="495ff-118">如需資料表值參數的詳細資訊，請參閱[ODBC&#41;&#40;的資料表值參數](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md)。</span><span class="sxs-lookup"><span data-stu-id="495ff-118">For more information about table-valued parameters, see [Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span></span>  
  
## <a name="sqlsetstmtattr-support-for-sparse-columns"></a><span data-ttu-id="495ff-119">疏鬆資料行的 SQLSetStmtAttr 支援</span><span class="sxs-lookup"><span data-stu-id="495ff-119">SQLSetStmtAttr Support for Sparse Columns</span></span>  
 <span data-ttu-id="495ff-120">SQLSetStmtAttr 可以用來設定 SQL_SOPT_SS_NAME_SCOPE。</span><span class="sxs-lookup"><span data-stu-id="495ff-120">SQLSetStmtAttr can be used to set SQL_SOPT_SS_NAME_SCOPE.</span></span> <span data-ttu-id="495ff-121">如需詳細資訊，請參閱本主題稍後的 SQL_SOPT_SS_NAME_SCOPE 一節。如需稀疏資料行的詳細資訊，請參閱[&#40;ODBC&#41;的稀疏資料行支援](../native-client/odbc/sparse-columns-support-odbc.md)。</span><span class="sxs-lookup"><span data-stu-id="495ff-121">For more information, see the SQL_SOPT_SS_NAME_SCOPE section, later in this topic.For more information about sparse columns, see [Sparse Columns Support &#40;ODBC&#41;](../native-client/odbc/sparse-columns-support-odbc.md).</span></span>  
  
## <a name="statement-attributes"></a><span data-ttu-id="495ff-122">陳述式屬性</span><span class="sxs-lookup"><span data-stu-id="495ff-122">Statement Attributes</span></span>  
 <span data-ttu-id="495ff-123">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC 驅動程式也支援下列驅動程式專屬的陳述式屬性。</span><span class="sxs-lookup"><span data-stu-id="495ff-123">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver also supports the following driver-specific statement attributes.</span></span>  
  
### <a name="sql_sopt_ss_cursor_options"></a><span data-ttu-id="495ff-124">SQL_SOPT_SS_CURSOR_OPTIONS</span><span class="sxs-lookup"><span data-stu-id="495ff-124">SQL_SOPT_SS_CURSOR_OPTIONS</span></span>  
 <span data-ttu-id="495ff-125">SQL_SOPT_SS_CURSOR 屬性會指定驅動程式是否會在資料指標上使用驅動程式專屬的效能選項。</span><span class="sxs-lookup"><span data-stu-id="495ff-125">The SQL_SOPT_SS_CURSOR attribute specifies whether the driver will use driver-specific performance options on cursors.</span></span> <span data-ttu-id="495ff-126">設定這些選項時，不允許[SQLGetData](sqlgetdata.md) 。</span><span class="sxs-lookup"><span data-stu-id="495ff-126">[SQLGetData](sqlgetdata.md) is not allowed when these options are set.</span></span> <span data-ttu-id="495ff-127">預設值為 SQL_CO_OFF。</span><span class="sxs-lookup"><span data-stu-id="495ff-127">The default setting is SQL_CO_OFF.</span></span> <span data-ttu-id="495ff-128">*Valueptr 是*值的類型是 SQLLEN。</span><span class="sxs-lookup"><span data-stu-id="495ff-128">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="495ff-129">*Valueptr 是*值</span><span class="sxs-lookup"><span data-stu-id="495ff-129">*ValuePtr* value</span></span>|<span data-ttu-id="495ff-130">描述</span><span class="sxs-lookup"><span data-stu-id="495ff-130">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="495ff-131">SQL_CO_OFF</span><span class="sxs-lookup"><span data-stu-id="495ff-131">SQL_CO_OFF</span></span>|<span data-ttu-id="495ff-132">預設值：</span><span class="sxs-lookup"><span data-stu-id="495ff-132">Default.</span></span> <span data-ttu-id="495ff-133">停用快速順向、唯讀資料指標和自動擷取，可讓您在順向、唯讀資料指標上**SQLGetData** 。</span><span class="sxs-lookup"><span data-stu-id="495ff-133">Disables fast forward-only, read-only cursors and autofetch, enables **SQLGetData** on forward-only, read-only cursors.</span></span> <span data-ttu-id="495ff-134">當 SQL_SOPT_SS_CURSOR_OPTIONS 設定為 SQL_CO_OFF 時，資料指標類型將不會變更。</span><span class="sxs-lookup"><span data-stu-id="495ff-134">When SQL_SOPT_SS_CURSOR_OPTIONS is set to SQL_CO_OFF, the cursor type will not change.</span></span> <span data-ttu-id="495ff-135">也就是說，快速順向資料指標仍是快速順向資料指標。</span><span class="sxs-lookup"><span data-stu-id="495ff-135">That is, fast forward-only cursor will remain a fast forward-only cursor.</span></span> <span data-ttu-id="495ff-136">若要變更資料指標類型，應用程式現在必須使用/SQL_ATTR_CURSOR_TYPE 設定不同的資料指標類型 `SQLSetStmtAttr` 。</span><span class="sxs-lookup"><span data-stu-id="495ff-136">To change the cursor type, the application must now set a different cursor type using `SQLSetStmtAttr`/SQL_ATTR_CURSOR_TYPE.</span></span>|  
|<span data-ttu-id="495ff-137">SQL_CO_FFO</span><span class="sxs-lookup"><span data-stu-id="495ff-137">SQL_CO_FFO</span></span>|<span data-ttu-id="495ff-138">啟用快速順向、唯讀資料指標，在順向、唯讀資料指標上停用**SQLGetData** 。</span><span class="sxs-lookup"><span data-stu-id="495ff-138">Enables fast forward-only, read-only cursors, disables **SQLGetData** on forward-only, read-only cursors.</span></span>|  
|<span data-ttu-id="495ff-139">SQL_CO_AF</span><span class="sxs-lookup"><span data-stu-id="495ff-139">SQL_CO_AF</span></span>|<span data-ttu-id="495ff-140">在任何資料指標類型上啟用自動擷取選項。</span><span class="sxs-lookup"><span data-stu-id="495ff-140">Enables the autofetch option on any cursor type.</span></span> <span data-ttu-id="495ff-141">當針對語句控制碼設定此選項時， **SQLExecute**或**SQLExecDirect**會產生隱含的**SQLFetchScroll** (SQL_FIRST) 。</span><span class="sxs-lookup"><span data-stu-id="495ff-141">When this option is set for a statement handle, **SQLExecute** or **SQLExecDirect** will generate an implicit **SQLFetchScroll** (SQL_FIRST).</span></span> <span data-ttu-id="495ff-142">資料指標會開啟，而且第一個批次的資料列會在伺服器的單一往返中傳回。</span><span class="sxs-lookup"><span data-stu-id="495ff-142">The cursor is opened and the first batch of rows is returned in a single roundtrip to the server.</span></span>|  
|<span data-ttu-id="495ff-143">SQL_CO_FFO_AF</span><span class="sxs-lookup"><span data-stu-id="495ff-143">SQL_CO_FFO_AF</span></span>|<span data-ttu-id="495ff-144">使用自動擷取選項啟用快速順向資料指標。</span><span class="sxs-lookup"><span data-stu-id="495ff-144">Enables fast forward-only cursors with the autofetch option.</span></span> <span data-ttu-id="495ff-145">這在同時指定 SQL_CO_AF 和 SQL_CO_FFO 時相同。</span><span class="sxs-lookup"><span data-stu-id="495ff-145">It is the same as if both SQL_CO_AF and SQL_CO_FFO are specified.</span></span>|  
  
 <span data-ttu-id="495ff-146">設定這些選項時，如果伺服器偵測到已經提取最後一個資料列，則會自動關閉資料指標。</span><span class="sxs-lookup"><span data-stu-id="495ff-146">When these options are set, the server closes the cursor automatically when it detects that the last row has been fetched.</span></span> <span data-ttu-id="495ff-147">應用程式仍然必須呼叫[SQLFreeStmt](sqlfreestmt.md) (SQL_CLOSE) 或[SQLCloseCursor](sqlclosecursor.md)，但驅動程式不需要將關閉通知傳送至伺服器。</span><span class="sxs-lookup"><span data-stu-id="495ff-147">The application must still call [SQLFreeStmt](sqlfreestmt.md) (SQL_CLOSE) or [SQLCloseCursor](sqlclosecursor.md), but the driver does not have to send the close notification to the server.</span></span>  
  
 <span data-ttu-id="495ff-148">如果選取清單包含**text**、 **Ntext**或**image**資料行，則快速順向資料指標會轉換成動態資料指標，並允許**SQLGetData** 。</span><span class="sxs-lookup"><span data-stu-id="495ff-148">If the select list contains a **text**, **ntext**, or **image** column, the fast forward-only cursor is converted to a dynamic cursor and **SQLGetData** is allowed.</span></span>  
  
### <a name="sql_sopt_ss_defer_prepare"></a><span data-ttu-id="495ff-149">SQL_SOPT_SS_DEFER_PREPARE</span><span class="sxs-lookup"><span data-stu-id="495ff-149">SQL_SOPT_SS_DEFER_PREPARE</span></span>  
 <span data-ttu-id="495ff-150">SQL_SOPT_SS_DEFER_PREPARE 屬性會決定是否要立即準備或延後語句，直到執行**SQLExecute**、 [SQLDescribeCol](sqldescribecol.md)或[SQLDescribeParam](sqldescribeparam.md)為止。</span><span class="sxs-lookup"><span data-stu-id="495ff-150">The SQL_SOPT_SS_DEFER_PREPARE attribute determines whether the statement is prepared immediately or deferred until **SQLExecute**, [SQLDescribeCol](sqldescribecol.md) or [SQLDescribeParam](sqldescribeparam.md) is executed.</span></span> <span data-ttu-id="495ff-151">在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 7.0 和先前版本中，會忽略此屬性 (沒有延遲準備)。</span><span class="sxs-lookup"><span data-stu-id="495ff-151">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 7.0 and earlier, this property is ignored (no deferred prepare).</span></span> <span data-ttu-id="495ff-152">*Valueptr 是*值的類型是 SQLLEN。</span><span class="sxs-lookup"><span data-stu-id="495ff-152">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="495ff-153">*Valueptr 是*值</span><span class="sxs-lookup"><span data-stu-id="495ff-153">*ValuePtr* value</span></span>|<span data-ttu-id="495ff-154">描述</span><span class="sxs-lookup"><span data-stu-id="495ff-154">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="495ff-155">SQL_DP_ON</span><span class="sxs-lookup"><span data-stu-id="495ff-155">SQL_DP_ON</span></span>|<span data-ttu-id="495ff-156">預設值：</span><span class="sxs-lookup"><span data-stu-id="495ff-156">Default.</span></span> <span data-ttu-id="495ff-157">呼叫[SQLPrepare](https://go.microsoft.com/fwlink/?LinkId=59360)函式之後，將會延遲語句準備，直到呼叫**SQLExecute**或中繼屬性作業 (**SQLDescribeCol**或**SQLDescribeParam**) 執行為止。</span><span class="sxs-lookup"><span data-stu-id="495ff-157">After calling [SQLPrepare Function](https://go.microsoft.com/fwlink/?LinkId=59360), the statement preparation is deferred until **SQLExecute** is called or metaproperty operation (**SQLDescribeCol** or **SQLDescribeParam**) is executed.</span></span>|  
|<span data-ttu-id="495ff-158">SQL_DP_OFF</span><span class="sxs-lookup"><span data-stu-id="495ff-158">SQL_DP_OFF</span></span>|<span data-ttu-id="495ff-159">一旦執行**SQLPrepare** ，就會準備語句。</span><span class="sxs-lookup"><span data-stu-id="495ff-159">The statement is prepared as soon as **SQLPrepare** is executed.</span></span>|  
  
### <a name="sql_sopt_ss_regionalize"></a><span data-ttu-id="495ff-160">SQL_SOPT_SS_REGIONALIZE</span><span class="sxs-lookup"><span data-stu-id="495ff-160">SQL_SOPT_SS_REGIONALIZE</span></span>  
 <span data-ttu-id="495ff-161">SQL_SOPT_SS_REGIONALIZE 屬性用於決定陳述式層級的資料轉換。</span><span class="sxs-lookup"><span data-stu-id="495ff-161">The SQL_SOPT_SS_REGIONALIZE attribute is used to determine data conversion at the statement level.</span></span> <span data-ttu-id="495ff-162">將日期、時間和貨幣值轉換為字元字串時，此屬性會使驅動程式遵從用戶端的地區設定。</span><span class="sxs-lookup"><span data-stu-id="495ff-162">The attribute causes the driver to respect the client locale setting when converting date, time, and currency values to character strings.</span></span> <span data-ttu-id="495ff-163">此轉換僅能從 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 原生資料類型轉換成字元字串。</span><span class="sxs-lookup"><span data-stu-id="495ff-163">The conversion is from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] native data types to character strings only.</span></span>  
  
 <span data-ttu-id="495ff-164">*Valueptr 是*值的類型是 SQLLEN。</span><span class="sxs-lookup"><span data-stu-id="495ff-164">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="495ff-165">*Valueptr 是*值</span><span class="sxs-lookup"><span data-stu-id="495ff-165">*ValuePtr* value</span></span>|<span data-ttu-id="495ff-166">描述</span><span class="sxs-lookup"><span data-stu-id="495ff-166">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="495ff-167">SQL_RE_OFF</span><span class="sxs-lookup"><span data-stu-id="495ff-167">SQL_RE_OFF</span></span>|<span data-ttu-id="495ff-168">預設值：</span><span class="sxs-lookup"><span data-stu-id="495ff-168">Default.</span></span> <span data-ttu-id="495ff-169">此驅動程式不會使用用戶端地區設定，將日期、時間和貨幣資料轉換成字元字串資料。</span><span class="sxs-lookup"><span data-stu-id="495ff-169">The driver does not convert date, time, and currency data to character string data using the client locale setting.</span></span>|  
|<span data-ttu-id="495ff-170">SQL_RE_ON</span><span class="sxs-lookup"><span data-stu-id="495ff-170">SQL_RE_ON</span></span>|<span data-ttu-id="495ff-171">將日期、時間和貨幣資料轉換成字元字串資料時，此驅動程式會使用用戶端地區設定。</span><span class="sxs-lookup"><span data-stu-id="495ff-171">The driver uses the client locale setting when converting date, time, and currency data to character string data.</span></span>|  
  
 <span data-ttu-id="495ff-172">地區轉換設定適用於貨幣、數值、日期和時間資料類型。</span><span class="sxs-lookup"><span data-stu-id="495ff-172">Regional conversion settings apply to currency, numeric, date, and time data types.</span></span> <span data-ttu-id="495ff-173">此轉換設定只有在貨幣、數值、日期或時間值轉換為字元字串時，才會套用到輸出轉換。</span><span class="sxs-lookup"><span data-stu-id="495ff-173">The conversion setting is only applicable to output conversions when currency, numeric, date, or time values are converted to character strings.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="495ff-174">當 SQL_SOPT_SS_REGIONALIZE 陳述式選項開啟時，驅動程式會針對目前的使用者使用地區設定的登錄設定。</span><span class="sxs-lookup"><span data-stu-id="495ff-174">When the statement option SQL_SOPT_SS_REGIONALIZE is on, the driver uses the locale registry settings for the current user.</span></span> <span data-ttu-id="495ff-175">如果應用程式是透過呼叫**SetThreadLocale**，則驅動程式不接受目前線程的地區設定。</span><span class="sxs-lookup"><span data-stu-id="495ff-175">The driver does not honor the current thread's locale if the application sets it by, for example, calling **SetThreadLocale**.</span></span>  
  
 <span data-ttu-id="495ff-176">變更資料來源的地區行為可能會導致應用程式失敗。</span><span class="sxs-lookup"><span data-stu-id="495ff-176">Altering the regional behavior of a data source can cause application failure.</span></span> <span data-ttu-id="495ff-177">剖析日期字串並預期日期字串如 ODBC 定義之方式顯示的應用程式，可能會受到變更此值的負面影響。</span><span class="sxs-lookup"><span data-stu-id="495ff-177">An application that parses date strings and expects date strings to appear as defined by ODBC, could be adversely affected by altering this value.</span></span>  
  
### <a name="sql_sopt_ss_textptr_logging"></a><span data-ttu-id="495ff-178">SQL_SOPT_SS_TEXTPTR_LOGGING</span><span class="sxs-lookup"><span data-stu-id="495ff-178">SQL_SOPT_SS_TEXTPTR_LOGGING</span></span>  
 <span data-ttu-id="495ff-179">SQL_SOPT_SS_TEXTPTR_LOGGING 屬性會在包含**文字**或**影像**資料的資料行上，切換作業的記錄。</span><span class="sxs-lookup"><span data-stu-id="495ff-179">The SQL_SOPT_SS_TEXTPTR_LOGGING attribute toggles logging of operations on columns containing **text** or **image** data.</span></span> <span data-ttu-id="495ff-180">*Valueptr 是*值的類型是 SQLLEN。</span><span class="sxs-lookup"><span data-stu-id="495ff-180">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="495ff-181">*Valueptr 是*值</span><span class="sxs-lookup"><span data-stu-id="495ff-181">*ValuePtr* value</span></span>|<span data-ttu-id="495ff-182">描述</span><span class="sxs-lookup"><span data-stu-id="495ff-182">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="495ff-183">SQL_TL_OFF</span><span class="sxs-lookup"><span data-stu-id="495ff-183">SQL_TL_OFF</span></span>|<span data-ttu-id="495ff-184">停用在**文字**和**影像**資料上執行之作業的記錄。</span><span class="sxs-lookup"><span data-stu-id="495ff-184">Disables logging of operations performed on **text** and **image** data.</span></span>|  
|<span data-ttu-id="495ff-185">SQL_TL_ON</span><span class="sxs-lookup"><span data-stu-id="495ff-185">SQL_TL_ON</span></span>|<span data-ttu-id="495ff-186">預設值：</span><span class="sxs-lookup"><span data-stu-id="495ff-186">Default.</span></span> <span data-ttu-id="495ff-187">啟用在**文字**和**影像**資料上執行之作業的記錄。</span><span class="sxs-lookup"><span data-stu-id="495ff-187">Enables logging of operations performed on **text** and **image** data.</span></span>|  
  
### <a name="sql_sopt_ss_hidden_columns"></a><span data-ttu-id="495ff-188">SQL_SOPT_SS_HIDDEN_COLUMNS</span><span class="sxs-lookup"><span data-stu-id="495ff-188">SQL_SOPT_SS_HIDDEN_COLUMNS</span></span>  
 <span data-ttu-id="495ff-189">SQL_SOPT_SS_HIDDEN_COLUMNS 屬性會在結果集中公開 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] SELECT FOR BROWSE 陳述式內隱藏的資料行。</span><span class="sxs-lookup"><span data-stu-id="495ff-189">The SQL_SOPT_SS_HIDDEN_COLUMNS attribute exposes, in the result set, columns hidden in a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] SELECT FOR BROWSE statement.</span></span> <span data-ttu-id="495ff-190">此驅動程式預設不會公開這些資料行。</span><span class="sxs-lookup"><span data-stu-id="495ff-190">The driver does not expose these columns by default.</span></span> <span data-ttu-id="495ff-191">*Valueptr 是*值的類型是 SQLLEN。</span><span class="sxs-lookup"><span data-stu-id="495ff-191">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="495ff-192">*Valueptr 是*值</span><span class="sxs-lookup"><span data-stu-id="495ff-192">*ValuePtr* value</span></span>|<span data-ttu-id="495ff-193">描述</span><span class="sxs-lookup"><span data-stu-id="495ff-193">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="495ff-194">SQL_HC_OFF</span><span class="sxs-lookup"><span data-stu-id="495ff-194">SQL_HC_OFF</span></span>|<span data-ttu-id="495ff-195">預設值：</span><span class="sxs-lookup"><span data-stu-id="495ff-195">Default.</span></span> <span data-ttu-id="495ff-196">FOR BROWSE 資料行會從結果集隱藏起來。</span><span class="sxs-lookup"><span data-stu-id="495ff-196">FOR BROWSE columns are hidden from the result set.</span></span>|  
|<span data-ttu-id="495ff-197">SQL_HC_ON</span><span class="sxs-lookup"><span data-stu-id="495ff-197">SQL_HC_ON</span></span>|<span data-ttu-id="495ff-198">公開 FOR BROWSE 資料行。</span><span class="sxs-lookup"><span data-stu-id="495ff-198">Exposes FOR BROWSE columns.</span></span>|  
  
### <a name="sql_sopt_ss_querynotification_msgtext"></a><span data-ttu-id="495ff-199">SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT</span><span class="sxs-lookup"><span data-stu-id="495ff-199">SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT</span></span>  
 <span data-ttu-id="495ff-200">SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT 屬性會傳回查詢通知要求的訊息文字。</span><span class="sxs-lookup"><span data-stu-id="495ff-200">The SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT attribute returns the message text for the query notification request.</span></span>  
  
### <a name="sql_sopt_ss_querynotification_options"></a><span data-ttu-id="495ff-201">SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS</span><span class="sxs-lookup"><span data-stu-id="495ff-201">SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS</span></span>  
 <span data-ttu-id="495ff-202">SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS 屬性會指定用於查詢通知要求的選項。</span><span class="sxs-lookup"><span data-stu-id="495ff-202">The SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS attribute specifies the options used for the query notification request.</span></span> <span data-ttu-id="495ff-203">這些是使用 `name=value` 語法在字串中指定，如下所示。</span><span class="sxs-lookup"><span data-stu-id="495ff-203">These are specified in a string with `name=value` syntax as specified below.</span></span> <span data-ttu-id="495ff-204">應用程式會負責建立此服務以及在佇列外部讀取通知。</span><span class="sxs-lookup"><span data-stu-id="495ff-204">The application is responsible for creating the service and reading notifications off of the queue.</span></span>  
  
 <span data-ttu-id="495ff-205">查詢通知選項字串的語法為：</span><span class="sxs-lookup"><span data-stu-id="495ff-205">The syntax of the query notifications options string is:</span></span>  
  
 `service=<service-name>[;(local database=<database>|broker instance=<broker instance>)]`  
  
 <span data-ttu-id="495ff-206">例如：</span><span class="sxs-lookup"><span data-stu-id="495ff-206">For example:</span></span>  
  
 `service=mySSBService;local database=mydb`  
  
### <a name="sql_sopt_ss_querynotification_timeout"></a><span data-ttu-id="495ff-207">SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT</span><span class="sxs-lookup"><span data-stu-id="495ff-207">SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT</span></span>  
 <span data-ttu-id="495ff-208">SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT 屬性會指定查詢通知維持作用中的秒數。</span><span class="sxs-lookup"><span data-stu-id="495ff-208">The SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT attribute specifies the number of seconds that the query notification is to remain active.</span></span> <span data-ttu-id="495ff-209">預設值是 432000 秒 (5 天)。</span><span class="sxs-lookup"><span data-stu-id="495ff-209">The default value is 432000 seconds (5 days).</span></span> <span data-ttu-id="495ff-210">*Valueptr 是*值的類型是 SQLLEN。</span><span class="sxs-lookup"><span data-stu-id="495ff-210">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
### <a name="sql_sopt_ss_param_focus"></a><span data-ttu-id="495ff-211">SQL_SOPT_SS_PARAM_FOCUS</span><span class="sxs-lookup"><span data-stu-id="495ff-211">SQL_SOPT_SS_PARAM_FOCUS</span></span>  
 <span data-ttu-id="495ff-212">SQL_SOPT_SS_PARAM_FOCUS 屬性會指定後續 SQLBindParameter、SQLGetDescField、SQLSetDescField、SQLGetDescRec 和 SQLSetDescRec 呼叫的焦點。</span><span class="sxs-lookup"><span data-stu-id="495ff-212">The SQL_SOPT_SS_PARAM_FOCUS attribute specifies the focus for subsequent SQLBindParameter, SQLGetDescField, SQLSetDescField, SQLGetDescRec, and SQLSetDescRec calls.</span></span>  
  
 <span data-ttu-id="495ff-213">SQL_SOPT_SS_PARAM_FOCUS 的類型是 SQLULEN。</span><span class="sxs-lookup"><span data-stu-id="495ff-213">The type for SQL_SOPT_SS_PARAM_FOCUS is SQLULEN.</span></span>  
  
 <span data-ttu-id="495ff-214">預設值為 0，表示這些呼叫處理的參數會對應到 SQL 陳述式中的參數標記。</span><span class="sxs-lookup"><span data-stu-id="495ff-214">The default is 0, which means that these calls address parameters that correspond to parameter markers in the SQL statement.</span></span> <span data-ttu-id="495ff-215">設定為資料表值參數的參數號碼時，這些呼叫會處理該資料表值參數的資料行。</span><span class="sxs-lookup"><span data-stu-id="495ff-215">When set to the parameter number of a table-valued parameter, these calls address columns of that table-valued parameter.</span></span> <span data-ttu-id="495ff-216">設定為非資料表值參數之參數號碼的值時，這些呼叫會傳回錯誤 IM020：「參數焦點沒有參考資料表值參數」。</span><span class="sxs-lookup"><span data-stu-id="495ff-216">When set to a value that is not the parameter number of a table-valued parameter, these calls return the error IM020: "Parameter focus does not refer to a table-valued parameter".</span></span>  
  
### <a name="sql_sopt_ss_name_scope"></a><span data-ttu-id="495ff-217">SQL_SOPT_SS_NAME_SCOPE</span><span class="sxs-lookup"><span data-stu-id="495ff-217">SQL_SOPT_SS_NAME_SCOPE</span></span>  
 <span data-ttu-id="495ff-218">SQL_SOPT_SS_NAME_SCOPE 屬性會指定後續目錄函數呼叫的名稱範圍。</span><span class="sxs-lookup"><span data-stu-id="495ff-218">The SQL_SOPT_SS_NAME_SCOPE attribute specifies the name scope for subsequent catalog function calls.</span></span> <span data-ttu-id="495ff-219">SQLColumns 所傳回的結果集會根據 SQL_SOPT_SS_NAME_SCOPE 的設定而定。</span><span class="sxs-lookup"><span data-stu-id="495ff-219">The result set returned by SQLColumns depends on the setting of SQL_SOPT_SS_NAME_SCOPE.</span></span>  
  
 <span data-ttu-id="495ff-220">SQL_SOPT_SS_NAME_SCOPE 的類型是 SQLULEN。</span><span class="sxs-lookup"><span data-stu-id="495ff-220">The type for SQL_SOPT_SS_NAME_SCOPE is SQLULEN.</span></span>  
  
|<span data-ttu-id="495ff-221">*Valueptr 是*值</span><span class="sxs-lookup"><span data-stu-id="495ff-221">*ValuePtr* value</span></span>|<span data-ttu-id="495ff-222">描述</span><span class="sxs-lookup"><span data-stu-id="495ff-222">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="495ff-223">SQL_SS_NAME_SCOPE_TABLE</span><span class="sxs-lookup"><span data-stu-id="495ff-223">SQL_SS_NAME_SCOPE_TABLE</span></span>|<span data-ttu-id="495ff-224">預設值：</span><span class="sxs-lookup"><span data-stu-id="495ff-224">Default.</span></span><br /><br /> <span data-ttu-id="495ff-225">使用資料表值參數時，指出應該傳回實際資料表的中繼資料。</span><span class="sxs-lookup"><span data-stu-id="495ff-225">When using table-valued parameters, indicates that metadata for actual tables should be returned.</span></span><br /><br /> <span data-ttu-id="495ff-226">使用「稀疏資料行」功能時，SQLColumns 只會傳回不是 sparse 成員的資料行 `column_set` 。</span><span class="sxs-lookup"><span data-stu-id="495ff-226">When using the sparse columns feature, SQLColumns will return only columns that are not members of the sparse `column_set`.</span></span>|  
|<span data-ttu-id="495ff-227">SQL_SS_NAME_SCOPE_TABLE_TYPE</span><span class="sxs-lookup"><span data-stu-id="495ff-227">SQL_SS_NAME_SCOPE_TABLE_TYPE</span></span>|<span data-ttu-id="495ff-228">表示應用程式需要資料表類型 (而非實際資料表) 的中繼資料 (目錄函數應該傳回資料表類型的中繼資料)。</span><span class="sxs-lookup"><span data-stu-id="495ff-228">Indicates that the application requires metadata for a table type, rather than an actual table (catalog functions should return metadata for table types).</span></span> <span data-ttu-id="495ff-229">然後，應用程式會傳遞資料表值參數的 TYPE_NAME 做為*TableName*參數。</span><span class="sxs-lookup"><span data-stu-id="495ff-229">The application then passes the TYPE_NAME of the table-valued parameter as the *TableName* parameter.</span></span>|  
|<span data-ttu-id="495ff-230">SQL_SS_NAME_SCOPE_EXTENDED</span><span class="sxs-lookup"><span data-stu-id="495ff-230">SQL_SS_NAME_SCOPE_EXTENDED</span></span>|<span data-ttu-id="495ff-231">使用「稀疏資料行」功能時，SQLColumns 會傳回所有資料行，而不論 `column_set` 成員資格為何。</span><span class="sxs-lookup"><span data-stu-id="495ff-231">When using the sparse columns feature, SQLColumns returns all columns, regardless of `column_set` membership.</span></span>|  
|<span data-ttu-id="495ff-232">SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET</span><span class="sxs-lookup"><span data-stu-id="495ff-232">SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET</span></span>|<span data-ttu-id="495ff-233">使用「稀疏資料行」功能時，SQLColumns 只會傳回屬於 sparse 成員的資料行 `column_set` 。</span><span class="sxs-lookup"><span data-stu-id="495ff-233">When using the sparse columns feature, SQLColumns returns only columns that are members of the sparse `column_set`.</span></span>|  
|<span data-ttu-id="495ff-234">SQL_SS_NAME_SCOPE_DEFAULT</span><span class="sxs-lookup"><span data-stu-id="495ff-234">SQL_SS_NAME_SCOPE_DEFAULT</span></span>|<span data-ttu-id="495ff-235">等於 SQL_SS_NAME_SCOPE_TABLE。</span><span class="sxs-lookup"><span data-stu-id="495ff-235">Equal to SQL_SS_NAME_SCOPE_TABLE.</span></span>|  
  
 <span data-ttu-id="495ff-236">SS_TYPE_CATALOG_NAME 和 SS_TYPE_SCHEMA_NAME 分別與*CatalogName*和*SchemaName*參數搭配使用，以識別資料表值參數的目錄和架構。</span><span class="sxs-lookup"><span data-stu-id="495ff-236">SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME are used with the *CatalogName* and *SchemaName* parameters, respectively, to identify the catalog and schema for the table-valued parameter.</span></span> <span data-ttu-id="495ff-237">當應用程式完成擷取資料表值參數的中繼資料時，必須將 SQL_SOPT_SS_NAME_SCOPE 社回 SQL_SS_NAME_SCOPE_TABLE 的預設值。</span><span class="sxs-lookup"><span data-stu-id="495ff-237">When an application has finished retrieving metadata for table-valued parameters, it must set SQL_SOPT_SS_NAME_SCOPE back to its default value of SQL_SS_NAME_SCOPE_TABLE.</span></span>  
  
 <span data-ttu-id="495ff-238">當 SQL_SOPT_SS_NAME_SCOPE 設定為 SQL_SS_NAME_SCOPE_TABLE 時，連結伺服器的查詢會失敗。</span><span class="sxs-lookup"><span data-stu-id="495ff-238">When SQL_SOPT_SS_NAME_SCOPE is set to SQL_SS_NAME_SCOPE_TABLE, queries to linked servers fail.</span></span> <span data-ttu-id="495ff-239">使用包含伺服器元件的目錄呼叫 SQLColumns 或 SQLPrimaryKeys 將會失敗。</span><span class="sxs-lookup"><span data-stu-id="495ff-239">Calls to SQLColumns or SQLPrimaryKeys with a catalog that contains a server component will fail.</span></span>  
  
 <span data-ttu-id="495ff-240">如果嘗試將 SQL_SOPT_SS_NAME_SCOPE 設定為無效值，會傳回 SQL_ERROR，並產生包含 SQLSTATE HY024 與「屬性值無效」訊息的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="495ff-240">If you attempt to set SQL_SOPT_SS_NAME_SCOPE to an invalid value, SQL_ERROR is returned and a diagnostic record is generated with SQLSTATE HY024 and the message "Invalid attribute value".</span></span>  
  
 <span data-ttu-id="495ff-241">如果 SQL_SOPT_SS_NAME_SCOPE 具有 SQL_SS_NAME_SCOPE_TABLE 以外的值，則會呼叫其他 then SQLTables、SQLColumns 或 SQLPrimaryKeys 的目錄函式，SQL_ERROR 傳回。</span><span class="sxs-lookup"><span data-stu-id="495ff-241">If a catalog function other then SQLTables, SQLColumns, or SQLPrimaryKeys is called when SQL_SOPT_SS_NAME_SCOPE has a value other than SQL_SS_NAME_SCOPE_TABLE, SQL_ERROR is returned.</span></span> <span data-ttu-id="495ff-242">此時會產生包含 SQLSTATE HY010 與「函數順序錯誤 (SQL_SOPT_SS_NAME_SCOPE 未設定為 SQL_SS_NAME_SCOPE_TABLE)」訊息的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="495ff-242">A diagnostic record is generated with SQLSTATE HY010 and the message "Function sequence error (SQL_SOPT_SS_NAME_SCOPE is not set to SQL_SS_NAME_SCOPE_TABLE)".</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="495ff-243">另請參閱</span><span class="sxs-lookup"><span data-stu-id="495ff-243">See Also</span></span>  
 <span data-ttu-id="495ff-244">[SQLGetStmtAttr 函式](https://go.microsoft.com/fwlink/?LinkId=59355) </span><span class="sxs-lookup"><span data-stu-id="495ff-244">[SQLGetStmtAttr Function](https://go.microsoft.com/fwlink/?LinkId=59355) </span></span>  
 [<span data-ttu-id="495ff-245">ODBC API 實作詳細資料</span><span class="sxs-lookup"><span data-stu-id="495ff-245">ODBC API Implementation Details</span></span>](odbc-api-implementation-details.md)  
  
  
