---
title: SQLRowCount |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLRowCount function
ms.assetid: 967ed3d4-3d31-4485-ac92-027076ebc829
author: rothja
ms.author: jroth
ms.openlocfilehash: 410023d960bad6dde1060a509cc1bf46f67d77cc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87606260"
---
# <a name="sqlrowcount"></a><span data-ttu-id="83b34-102">SQLRowCount</span><span class="sxs-lookup"><span data-stu-id="83b34-102">SQLRowCount</span></span>
  <span data-ttu-id="83b34-103">當參數值的陣列針對語句執行進行系結時， `SQLRowCount` 如果參數值的任何資料列在語句執行時產生錯誤狀況，則會傳回 SQL_ERROR。</span><span class="sxs-lookup"><span data-stu-id="83b34-103">When arrays of parameter values are bound for statement execution, `SQLRowCount` returns SQL_ERROR if any row of parameter values generates an error condition in statement execution.</span></span> <span data-ttu-id="83b34-104">函數的*RowCountPtr*引數不會傳回任何值。</span><span class="sxs-lookup"><span data-stu-id="83b34-104">No value is returned through the *RowCountPtr* argument of the function.</span></span>  
  
 <span data-ttu-id="83b34-105">應用程式可以利用 SQL_ATTR_PARAMS_PROCESSED_PTR 陳述式屬性擷取錯誤發生前所處理的參數數目。</span><span class="sxs-lookup"><span data-stu-id="83b34-105">The application can take advantage of the SQL_ATTR_PARAMS_PROCESSED_PTR statement attribute to capture the number of parameters processed prior to the error occurring.</span></span>  
  
 <span data-ttu-id="83b34-106">此外，應用程式可以使用透過 SQL_ATTR_PARAM_STATUS_PTR 陳述式屬性繫結的狀態值陣列，擷取衝突參數資料列的陣列位移。</span><span class="sxs-lookup"><span data-stu-id="83b34-106">Further, the application can use an array of status values, bound by using the SQL_ATTR_PARAM_STATUS_PTR statement attribute, to capture the array offsets of offending parameter rows.</span></span> <span data-ttu-id="83b34-107">應用程式可以周遊狀態陣列來判斷所處理的資料列實際數目。</span><span class="sxs-lookup"><span data-stu-id="83b34-107">The application can traverse the status array to determine the actual number of rows processed.</span></span>  
  
 <span data-ttu-id="83b34-108">當 [!INCLUDE[tsql](../../includes/tsql-md.md)] 執行具有 output 子句的 INSERT、UPDATE、DELETE 或 MERGE 語句時，SQLRowCount 將不會傳回受影響的資料列計數，直到 OUTPUT 子句所產生的結果集內的所有資料列都已耗用為止。</span><span class="sxs-lookup"><span data-stu-id="83b34-108">When a [!INCLUDE[tsql](../../includes/tsql-md.md)] INSERT, UPDATE, DELETE, or MERGE statement with an OUTPUT clause is executed, SQLRowCount will not return the count of rows affected until all the rows in the result set generated by the OUTPUT clause have been consumed.</span></span> <span data-ttu-id="83b34-109">若要 sconsume 這些資料列，您可以呼叫 SQLFetch 或 SQLFetchScroll。</span><span class="sxs-lookup"><span data-stu-id="83b34-109">To sconsume these rows, you call SQLFetch or SQLFetchScroll.</span></span> <span data-ttu-id="83b34-110">SQLResultCols 會傳回-1，直到所有結果資料列都已耗用為止。</span><span class="sxs-lookup"><span data-stu-id="83b34-110">SQLResultCols will return -1 until all result rows have been consumed.</span></span> <span data-ttu-id="83b34-111">在 SQLFetch 或 SQLFetchScroll 傳回 SQL_NO_DATA 之後，應用程式必須呼叫 SQLRowCount 來判斷受影響的資料列數目，再呼叫 SQLMoreResults 以移至下一個結果。</span><span class="sxs-lookup"><span data-stu-id="83b34-111">After SQLFetch or SQLFetchScroll returns SQL_NO_DATA, the application must call SQLRowCount to determine the number of rows affected before calling SQLMoreResults to move to the next result.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="83b34-112">另請參閱</span><span class="sxs-lookup"><span data-stu-id="83b34-112">See Also</span></span>  
 <span data-ttu-id="83b34-113">[SQLRowCount 函式](https://go.microsoft.com/fwlink/?LinkId=59367) </span><span class="sxs-lookup"><span data-stu-id="83b34-113">[SQLRowCount Function](https://go.microsoft.com/fwlink/?LinkId=59367) </span></span>  
 [<span data-ttu-id="83b34-114">ODBC API 實作詳細資料</span><span class="sxs-lookup"><span data-stu-id="83b34-114">ODBC API Implementation Details</span></span>](odbc-api-implementation-details.md)  
  
  
