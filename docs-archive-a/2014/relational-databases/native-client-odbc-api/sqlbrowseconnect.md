---
title: SQLBrowseConnect |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLBrowseConnect function
ms.assetid: 57faf388-c7ca-4696-9845-34e0a10cc5f7
author: rothja
ms.author: jroth
ms.openlocfilehash: ca203e02195d72683744aa8dd31d41a81c260ab4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87709386"
---
# <a name="sqlbrowseconnect"></a><span data-ttu-id="c2720-102">SQLBrowseConnect</span><span class="sxs-lookup"><span data-stu-id="c2720-102">SQLBrowseConnect</span></span>
  <span data-ttu-id="c2720-103">**SQLBrowseConnect**會使用可分類為三種連接資訊層級的關鍵字。</span><span class="sxs-lookup"><span data-stu-id="c2720-103">**SQLBrowseConnect** uses keywords that can be categorized into three levels of connection information.</span></span> <span data-ttu-id="c2720-104">下表針對每個關鍵字指出是否傳回有效值清單以及關鍵字是否為選擇性。</span><span class="sxs-lookup"><span data-stu-id="c2720-104">For each keyword, the following table indicates whether a list of valid values is returned and whether the keyword is optional.</span></span>  
  
## <a name="level-1"></a><span data-ttu-id="c2720-105">層級 1</span><span class="sxs-lookup"><span data-stu-id="c2720-105">Level 1</span></span>  
  
|<span data-ttu-id="c2720-106">關鍵字</span><span class="sxs-lookup"><span data-stu-id="c2720-106">Keyword</span></span>|<span data-ttu-id="c2720-107">傳回清單？</span><span class="sxs-lookup"><span data-stu-id="c2720-107">List returned?</span></span>|<span data-ttu-id="c2720-108">選擇性？</span><span class="sxs-lookup"><span data-stu-id="c2720-108">Optional?</span></span>|<span data-ttu-id="c2720-109">描述</span><span class="sxs-lookup"><span data-stu-id="c2720-109">Description</span></span>|  
|-------------|--------------------|---------------|-----------------|  
|<span data-ttu-id="c2720-110">DSN</span><span class="sxs-lookup"><span data-stu-id="c2720-110">DSN</span></span>|<span data-ttu-id="c2720-111">N/A</span><span class="sxs-lookup"><span data-stu-id="c2720-111">N/A</span></span>|<span data-ttu-id="c2720-112">否</span><span class="sxs-lookup"><span data-stu-id="c2720-112">No</span></span>|<span data-ttu-id="c2720-113">**SQLDataSources**所傳回之資料來源的名稱。</span><span class="sxs-lookup"><span data-stu-id="c2720-113">Name of the data source returned by **SQLDataSources**.</span></span> <span data-ttu-id="c2720-114">如果使用 DRIVER 關鍵字，就無法使用 DSN 關鍵字。</span><span class="sxs-lookup"><span data-stu-id="c2720-114">The DSN keyword cannot be used if the DRIVER keyword is used.</span></span>|  
|<span data-ttu-id="c2720-115">DRIVER</span><span class="sxs-lookup"><span data-stu-id="c2720-115">DRIVER</span></span>|<span data-ttu-id="c2720-116">N/A</span><span class="sxs-lookup"><span data-stu-id="c2720-116">N/A</span></span>|<span data-ttu-id="c2720-117">否</span><span class="sxs-lookup"><span data-stu-id="c2720-117">No</span></span>|<span data-ttu-id="c2720-118">Microsoft？</span><span class="sxs-lookup"><span data-stu-id="c2720-118">Microsoft??</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="c2720-119">Native Client ODBC 驅動程式名稱是 { [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native client 11}。</span><span class="sxs-lookup"><span data-stu-id="c2720-119">Native Client ODBC driver name is {[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 11}.</span></span> <span data-ttu-id="c2720-120">如果使用 DSN 關鍵字，就無法使用 DRIVER 關鍵字。</span><span class="sxs-lookup"><span data-stu-id="c2720-120">The DRIVER keyword cannot be used if the DSN keyword is used.</span></span>|  
  
## <a name="level-2"></a><span data-ttu-id="c2720-121">層級 2</span><span class="sxs-lookup"><span data-stu-id="c2720-121">Level 2</span></span>  
  
|<span data-ttu-id="c2720-122">關鍵字</span><span class="sxs-lookup"><span data-stu-id="c2720-122">Keyword</span></span>|<span data-ttu-id="c2720-123">傳回清單？</span><span class="sxs-lookup"><span data-stu-id="c2720-123">List returned?</span></span>|<span data-ttu-id="c2720-124">選擇性？</span><span class="sxs-lookup"><span data-stu-id="c2720-124">Optional?</span></span>|<span data-ttu-id="c2720-125">描述</span><span class="sxs-lookup"><span data-stu-id="c2720-125">Description</span></span>|  
|-------------|--------------------|---------------|-----------------|  
|<span data-ttu-id="c2720-126">SERVER</span><span class="sxs-lookup"><span data-stu-id="c2720-126">SERVER</span></span>|<span data-ttu-id="c2720-127">是</span><span class="sxs-lookup"><span data-stu-id="c2720-127">Yes</span></span>|<span data-ttu-id="c2720-128">否</span><span class="sxs-lookup"><span data-stu-id="c2720-128">No</span></span>|<span data-ttu-id="c2720-129">事件來源所在之網路上的伺服器名稱。</span><span class="sxs-lookup"><span data-stu-id="c2720-129">Name of the server on the network on which the data source resides.</span></span> <span data-ttu-id="c2720-130">可以輸入 "(local)" 這個詞彙做為伺服器，在這種情況下可以使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的本機複本，即使這是非網路的版本。</span><span class="sxs-lookup"><span data-stu-id="c2720-130">The term "(local)" can be entered as the server, in which case a local copy of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] can be used, even when this is a non-networked version.</span></span>|  
|<span data-ttu-id="c2720-131">UID</span><span class="sxs-lookup"><span data-stu-id="c2720-131">UID</span></span>|<span data-ttu-id="c2720-132">否</span><span class="sxs-lookup"><span data-stu-id="c2720-132">No</span></span>|<span data-ttu-id="c2720-133">是</span><span class="sxs-lookup"><span data-stu-id="c2720-133">Yes</span></span>|<span data-ttu-id="c2720-134">使用者登入識別碼。</span><span class="sxs-lookup"><span data-stu-id="c2720-134">User login ID.</span></span>|  
|<span data-ttu-id="c2720-135">PWD</span><span class="sxs-lookup"><span data-stu-id="c2720-135">PWD</span></span>|<span data-ttu-id="c2720-136">否</span><span class="sxs-lookup"><span data-stu-id="c2720-136">No</span></span>|<span data-ttu-id="c2720-137">是 (依使用者而定)</span><span class="sxs-lookup"><span data-stu-id="c2720-137">Yes (depends on the user)</span></span>|<span data-ttu-id="c2720-138">使用者指定的密碼。</span><span class="sxs-lookup"><span data-stu-id="c2720-138">User-specified password.</span></span>|  
|<span data-ttu-id="c2720-139">APP</span><span class="sxs-lookup"><span data-stu-id="c2720-139">APP</span></span>|<span data-ttu-id="c2720-140">否</span><span class="sxs-lookup"><span data-stu-id="c2720-140">No</span></span>|<span data-ttu-id="c2720-141">是</span><span class="sxs-lookup"><span data-stu-id="c2720-141">Yes</span></span>|<span data-ttu-id="c2720-142">呼叫**SQLBrowseConnect**的應用程式名稱。</span><span class="sxs-lookup"><span data-stu-id="c2720-142">Name of the application calling **SQLBrowseConnect**.</span></span>|  
|<span data-ttu-id="c2720-143">WSID</span><span class="sxs-lookup"><span data-stu-id="c2720-143">WSID</span></span>|<span data-ttu-id="c2720-144">否</span><span class="sxs-lookup"><span data-stu-id="c2720-144">No</span></span>|<span data-ttu-id="c2720-145">是</span><span class="sxs-lookup"><span data-stu-id="c2720-145">Yes</span></span>|<span data-ttu-id="c2720-146">工作站識別碼。</span><span class="sxs-lookup"><span data-stu-id="c2720-146">Workstation ID.</span></span> <span data-ttu-id="c2720-147">一般而言，這是應用程式執行所在之電腦的網路名稱。</span><span class="sxs-lookup"><span data-stu-id="c2720-147">Typically, this is the network name of the computer on which the application runs.</span></span>|  
  
## <a name="level-3"></a><span data-ttu-id="c2720-148">Level 3</span><span class="sxs-lookup"><span data-stu-id="c2720-148">Level 3</span></span>  
  
|<span data-ttu-id="c2720-149">關鍵字</span><span class="sxs-lookup"><span data-stu-id="c2720-149">Keyword</span></span>|<span data-ttu-id="c2720-150">傳回清單？</span><span class="sxs-lookup"><span data-stu-id="c2720-150">List returned?</span></span>|<span data-ttu-id="c2720-151">選擇性？</span><span class="sxs-lookup"><span data-stu-id="c2720-151">Optional?</span></span>|<span data-ttu-id="c2720-152">描述</span><span class="sxs-lookup"><span data-stu-id="c2720-152">Description</span></span>|  
|-------------|--------------------|---------------|-----------------|  
|<span data-ttu-id="c2720-153">DATABASE</span><span class="sxs-lookup"><span data-stu-id="c2720-153">DATABASE</span></span>|<span data-ttu-id="c2720-154">是</span><span class="sxs-lookup"><span data-stu-id="c2720-154">Yes</span></span>|<span data-ttu-id="c2720-155">是</span><span class="sxs-lookup"><span data-stu-id="c2720-155">Yes</span></span>|<span data-ttu-id="c2720-156">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資料庫的名稱。</span><span class="sxs-lookup"><span data-stu-id="c2720-156">Name of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database.</span></span>|  
|<span data-ttu-id="c2720-157">LANGUAGE</span><span class="sxs-lookup"><span data-stu-id="c2720-157">LANGUAGE</span></span>|<span data-ttu-id="c2720-158">是</span><span class="sxs-lookup"><span data-stu-id="c2720-158">Yes</span></span>|<span data-ttu-id="c2720-159">是</span><span class="sxs-lookup"><span data-stu-id="c2720-159">Yes</span></span>|<span data-ttu-id="c2720-160">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 所用的國家語言。</span><span class="sxs-lookup"><span data-stu-id="c2720-160">National language used by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|  
  
 <span data-ttu-id="c2720-161">**SQLBrowseConnect**會忽略儲存在 ODBC 資料來源定義中的資料庫和語言關鍵字的值。</span><span class="sxs-lookup"><span data-stu-id="c2720-161">**SQLBrowseConnect** ignores the values of the DATABASE and LANGUAGE keywords stored in the ODBC data source definitions.</span></span> <span data-ttu-id="c2720-162">如果傳遞至**SQLBrowseConnect**的連接字串中指定的資料庫或語言無效，則**SQLBrowseConnect**會傳回 SQL_NEED_DATA 和層級3連接屬性。</span><span class="sxs-lookup"><span data-stu-id="c2720-162">If the database or language specified in the connection string passed to **SQLBrowseConnect** is invalid, **SQLBrowseConnect** returns SQL_NEED_DATA and the level 3 connection attributes.</span></span>  
  
 <span data-ttu-id="c2720-163">下列屬性是藉由呼叫[SQLSetConnectAttr](sqlsetconnectattr.md)來設定，可判斷**SQLBrowseConnect**所傳回的結果集。</span><span class="sxs-lookup"><span data-stu-id="c2720-163">The following attributes, which are set by calling [SQLSetConnectAttr](sqlsetconnectattr.md), determine the result set returned by **SQLBrowseConnect**.</span></span>  
  
|<span data-ttu-id="c2720-164">屬性</span><span class="sxs-lookup"><span data-stu-id="c2720-164">Attribute</span></span>|<span data-ttu-id="c2720-165">描述</span><span class="sxs-lookup"><span data-stu-id="c2720-165">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="c2720-166">SQL_COPT_SS_BROWSE_CONNECT</span><span class="sxs-lookup"><span data-stu-id="c2720-166">SQL_COPT_SS_BROWSE_CONNECT</span></span>|<span data-ttu-id="c2720-167">如果設定為 SQL_MORE_INFO_YES， **SQLBrowseConnect**會傳回伺服器屬性的擴充字串。</span><span class="sxs-lookup"><span data-stu-id="c2720-167">If it is set to SQL_MORE_INFO_YES, **SQLBrowseConnect** returns an extended string of server properties.</span></span><br /><br /> <span data-ttu-id="c2720-168">下列是**SQLBrowseConnect**所傳回之擴充字串的範例： ServerName\InstanceName;叢集：否;版本：8.00.131</span><span class="sxs-lookup"><span data-stu-id="c2720-168">The following is an example of an extended string returned by **SQLBrowseConnect**:ServerName\InstanceName;Clustered:No;Version:8.00.131</span></span><br /><br /> <span data-ttu-id="c2720-169">在這個字串中，分號是用來區隔伺服器相關資訊的不同部分，</span><span class="sxs-lookup"><span data-stu-id="c2720-169">In this string, semi-colons separate various pieces of information about the server.</span></span> <span data-ttu-id="c2720-170">逗號則是用來區隔不同的伺服器執行個體。</span><span class="sxs-lookup"><span data-stu-id="c2720-170">Use commas to separate different server instances.</span></span>|  
|<span data-ttu-id="c2720-171">SQL_COPT_SS_BROWSE_SERVER</span><span class="sxs-lookup"><span data-stu-id="c2720-171">SQL_COPT_SS_BROWSE_SERVER</span></span>|<span data-ttu-id="c2720-172">如果指定伺服器名稱， **SQLBrowseConnect**會傳回指定之伺服器的資訊。</span><span class="sxs-lookup"><span data-stu-id="c2720-172">If a server name is specified, **SQLBrowseConnect** will return information for the server specified.</span></span> <span data-ttu-id="c2720-173">如果 SQL_COPT_SS_BROWSE_SERVER 設定為 Null， **SQLBrowseConnect**會傳回網域中所有伺服器的資訊。</span><span class="sxs-lookup"><span data-stu-id="c2720-173">If SQL_COPT_SS_BROWSE_SERVER is set to NULL, **SQLBrowseConnect** returns information for all servers in the domain.</span></span><br /><br /> <span data-ttu-id="c2720-174">由於網路問題， **SQLBrowseConnect**可能不會收到所有伺服器的及時回應。</span><span class="sxs-lookup"><span data-stu-id="c2720-174">Due to network issues, **SQLBrowseConnect** might not receive a timely response from all servers.</span></span> <span data-ttu-id="c2720-175">因此，每個要求所傳回的伺服器清單可能各不相同。</span><span class="sxs-lookup"><span data-stu-id="c2720-175">Therefore, the list of servers returned can vary for each request.</span></span>|  
|<span data-ttu-id="c2720-176">SQL_COPT_SS_BROWSE_CACHE_DATA</span><span class="sxs-lookup"><span data-stu-id="c2720-176">SQL_COPT_SS_BROWSE_CACHE_DATA</span></span>|<span data-ttu-id="c2720-177">當 SQL_COPT_SS_BROWSE_CACHE_DATA 屬性是設定為 SQL_CACHE_DATA_YES 時，您可以在緩衝區長度不足以容納結果時，以片段的方式提取資料。</span><span class="sxs-lookup"><span data-stu-id="c2720-177">When the SQL_COPT_SS_BROWSE_CACHE_DATA attribute is set to SQL_CACHE_DATA_YES, you can fetch data in chunks when the buffer length is not large enough to hold the result.</span></span> <span data-ttu-id="c2720-178">這個長度是在 SQLBrowseConnect 的 BufferLength 引數中指定。</span><span class="sxs-lookup"><span data-stu-id="c2720-178">This length is specified in the BufferLength argument to SQLBrowseConnect.</span></span><br /><br /> <span data-ttu-id="c2720-179">當有更多資料可用時，會傳回 SQL_NEED_DATA。</span><span class="sxs-lookup"><span data-stu-id="c2720-179">SQL_NEED_DATA is returned when more data is available.</span></span> <span data-ttu-id="c2720-180">當沒有其他要擷取的資料時，會傳回 SQL_SUCCESS。</span><span class="sxs-lookup"><span data-stu-id="c2720-180">SQL_SUCCESS is returned when there is no more data to retrieve.</span></span><br /><br /> <span data-ttu-id="c2720-181">預設為 SQL_CACHE_DATA_NO。</span><span class="sxs-lookup"><span data-stu-id="c2720-181">The default is SQL_CACHE_DATA_NO.</span></span>|  
  
## <a name="sqlbrowseconnect-support-for-high-availability-disaster-recovery"></a><span data-ttu-id="c2720-182">高可用性/災害復原的 SQLBrowseConnect 支援</span><span class="sxs-lookup"><span data-stu-id="c2720-182">SQLBrowseConnect Support for High Availability, Disaster Recovery</span></span>  
 <span data-ttu-id="c2720-183">如需使用**SQLBrowseConnect**連線到叢集的詳細資訊 [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] ，請參閱[高可用性和嚴重損壞修復 SQL Server Native Client 支援](../native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md)。</span><span class="sxs-lookup"><span data-stu-id="c2720-183">For more information on using **SQLBrowseConnect** to connect to an [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] cluster, see [SQL Server Native Client Support for High Availability, Disaster Recovery](../native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md).</span></span>  
  
## <a name="sqlbrowseconnect-support-for-service-principal-names-spns"></a><span data-ttu-id="c2720-184">服務主要名稱 (SPN) 的 SQLBrowseConnect 支援</span><span class="sxs-lookup"><span data-stu-id="c2720-184">SQLBrowseConnect Support for Service Principal Names (SPNs)</span></span>  
 <span data-ttu-id="c2720-185">開啟連接時，[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 會將 SQL_COPT_SS_MUTUALLY_AUTHENTICATED 和 SQL_COPT_SS_INTEGRATED_AUTHENTICATION_METHOD 設定為開啟連接所使用的驗證方法。</span><span class="sxs-lookup"><span data-stu-id="c2720-185">When a connection is opened, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client sets SQL_COPT_SS_MUTUALLY_AUTHENTICATED and SQL_COPT_SS_INTEGRATED_AUTHENTICATION_METHOD to the authentication method used to open the connection.</span></span>  
  
 <span data-ttu-id="c2720-186">如需 Spn 的詳細資訊，請參閱[&#40;ODBC&#41;的用戶端連接中 &#40;spn&#41; 的服務主體名稱](../native-client/odbc/service-principal-names-spns-in-client-connections-odbc.md)。</span><span class="sxs-lookup"><span data-stu-id="c2720-186">For more information about SPNs, see [Service Principal Names &#40;SPNs&#41; in Client Connections &#40;ODBC&#41;](../native-client/odbc/service-principal-names-spns-in-client-connections-odbc.md).</span></span>  
  
## <a name="change-history"></a><span data-ttu-id="c2720-187">變更記錄</span><span class="sxs-lookup"><span data-stu-id="c2720-187">Change History</span></span>  
  
|<span data-ttu-id="c2720-188">更新的內容</span><span class="sxs-lookup"><span data-stu-id="c2720-188">Updated content</span></span>|  
|---------------------|  
|<span data-ttu-id="c2720-189">已記載 SQL_COPT_SS_BROWSE_CACHE_DATA。</span><span class="sxs-lookup"><span data-stu-id="c2720-189">Documented SQL_COPT_SS_BROWSE_CACHE_DATA.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="c2720-190">另請參閱</span><span class="sxs-lookup"><span data-stu-id="c2720-190">See Also</span></span>  
 <span data-ttu-id="c2720-191">[SQLBrowseConnect 函式](https://go.microsoft.com/fwlink/?LinkId=59329) </span><span class="sxs-lookup"><span data-stu-id="c2720-191">[SQLBrowseConnect Function](https://go.microsoft.com/fwlink/?LinkId=59329) </span></span>  
 [<span data-ttu-id="c2720-192">ODBC API 實作詳細資料</span><span class="sxs-lookup"><span data-stu-id="c2720-192">ODBC API Implementation Details</span></span>](odbc-api-implementation-details.md)  
  
  
