---
title: 定序與 Unicode 支援 | Microsoft 文件
ms.custom: ''
ms.date: 10/18/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- binary collations [SQL Server]
- expression-level collations [SQL Server]
- Windows collations [SQL Server]
- globalization [SQL Server], about globalization
- supplementary character support
- code pages [SQL Server], about code pages
- collations [SQL Server], about collations
- Unicode [SQL Server], collations
- database-level collations [SQL Server]
- reading order
- column-level collations
- locales [SQL Server], about locales
- locales [SQL Server]
- code pages [SQL Server]
- SQL Server collations
- server-level collations [SQL Server]
ms.assetid: 92d34f48-fa2b-47c5-89d3-a4c39b0f39eb
author: stevestein
ms.author: sstein
ms.openlocfilehash: a9a7c6c48229aa827aaed178e5ed4448c20431b9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87606907"
---
# <a name="collation-and-unicode-support"></a><span data-ttu-id="edd93-102">Collation and Unicode Support</span><span class="sxs-lookup"><span data-stu-id="edd93-102">Collation and Unicode Support</span></span>
  <span data-ttu-id="edd93-103">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 中的定序會提供資料的排序規則、大小寫和區分腔調字屬性。</span><span class="sxs-lookup"><span data-stu-id="edd93-103">Collations in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] provide sorting rules, case, and accent sensitivity properties for your data.</span></span> <span data-ttu-id="edd93-104">與字元資料類型 (例如 `char` 和 `varchar`) 搭配使用的定序會指示字碼頁，以及可針對該資料類型表示的對應字元。</span><span class="sxs-lookup"><span data-stu-id="edd93-104">Collations that are used with character data types such as `char` and `varchar` dictate the code page and corresponding characters that can be represented for that data type.</span></span> <span data-ttu-id="edd93-105">不論您是安裝 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]的新執行個體、還原資料庫備份，還是將伺服器連接至用戶端資料庫，請務必了解您即將使用之資料的地區設定需求、排序次序和區分大小寫與腔調字。</span><span class="sxs-lookup"><span data-stu-id="edd93-105">Whether you are installing a new instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], restoring a database backup, or connecting server to client databases, it is important that you understand the locale requirements, sorting order, and case and accent sensitivity of the data that you will be working with.</span></span> <span data-ttu-id="edd93-106">若要列出您的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]執行個體所提供的定序，請參閱 [sys。fn_helpcollations &#40;Transact-SQL&#41;](/sql/relational-databases/system-functions/sys-fn-helpcollations-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="edd93-106">To list the collations available on your instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], see [sys.fn_helpcollations &#40;Transact-SQL&#41;](/sql/relational-databases/system-functions/sys-fn-helpcollations-transact-sql).</span></span>  
  
 <span data-ttu-id="edd93-107">當您針對伺服器、資料庫、資料行或運算式選取定序時，就是將某些特性指派給資料，而這些特性會影響資料庫中許多作業的結果。</span><span class="sxs-lookup"><span data-stu-id="edd93-107">When you select a collation for your server, database, column, or expression, you are assigning certain characteristics to your data that will affect the results of many operations in the database.</span></span> <span data-ttu-id="edd93-108">例如，當您使用 ORDER BY 來建構查詢時，結果集的排序次序可能會相依於套用至資料庫的定序或在查詢運算式層級指定於 COLLATE 子句中的定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-108">For example, when you construct a query by using ORDER BY, the sort order of your result set might depend on the collation that is applied to the database or dictated in a COLLATE clause at the expression level of the query.</span></span>  
  
 <span data-ttu-id="edd93-109">為了有效運用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]中的定序支援，您必須了解本主題中定義的詞彙，以及它們與資料特性的關聯。</span><span class="sxs-lookup"><span data-stu-id="edd93-109">To best use collation support in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], you must understand the terms that are defined in this topic, and how they relate to the characteristics of your data.</span></span>  
  
  
###  <a name="collation"></a><a name="Collation_Defn"></a> <span data-ttu-id="edd93-110">定序</span><span class="sxs-lookup"><span data-stu-id="edd93-110">Collation</span></span>  
 <span data-ttu-id="edd93-111">定序指定位元模式，代表資料集的每一個字元。</span><span class="sxs-lookup"><span data-stu-id="edd93-111">A collation specifies the bit patterns that represent each character in a data set.</span></span> <span data-ttu-id="edd93-112">定序也可以決定排序和比較資料的規則。</span><span class="sxs-lookup"><span data-stu-id="edd93-112">Collations also determine the rules that sort and compare data.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="edd93-113">支援在單一資料庫中儲存具備不同定序的物件。</span><span class="sxs-lookup"><span data-stu-id="edd93-113">supports storing objects that have different collations in a single database.</span></span> <span data-ttu-id="edd93-114">對於非 Unicode 資料行，定序設定則指定資料的字碼頁以及可代表的字元。</span><span class="sxs-lookup"><span data-stu-id="edd93-114">For non-Unicode columns, the collation setting specifies the code page for the data and which characters can be represented.</span></span> <span data-ttu-id="edd93-115">在非 Unicode 資料行之間移動的資料必須從來源字碼頁轉換成目的地字碼頁。</span><span class="sxs-lookup"><span data-stu-id="edd93-115">Data that is moved between non-Unicode columns must be converted from the source code page to the destination code page.</span></span>  
  
 <span data-ttu-id="edd93-116">當[!INCLUDE[tsql](../../includes/tsql-md.md)] 陳述式在各有不同定序設定的不同資料庫內容中執行時，陳述式的結果可能不同。</span><span class="sxs-lookup"><span data-stu-id="edd93-116">[!INCLUDE[tsql](../../includes/tsql-md.md)] statement results can vary when the statement is run in the context of different databases that have different collation settings.</span></span> <span data-ttu-id="edd93-117">如果可能的話，請針對組織使用標準化定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-117">If it is possible, use a standardized collation for your organization.</span></span> <span data-ttu-id="edd93-118">這樣您就不需要在每一個字元或 Unicode 運算式中明確指定定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-118">This way, you do not have to explicitly specify the collation in every character or Unicode expression.</span></span> <span data-ttu-id="edd93-119">如果您必須使用有不同定序和字碼頁設定的物件，則在編寫查詢程式碼時，必須考量定序優先順序的規則。</span><span class="sxs-lookup"><span data-stu-id="edd93-119">If you must work with objects that have different collation and code page settings, code your queries to consider the rules of collation precedence.</span></span> <span data-ttu-id="edd93-120">如需詳細資訊，請參閱 [定序優先順序 (Transact-SQL)](/sql/t-sql/statements/collation-precedence-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="edd93-120">For more information, see [Collation Precedence (Transact-SQL)](/sql/t-sql/statements/collation-precedence-transact-sql).</span></span>  
  
 <span data-ttu-id="edd93-121">與定序相關聯的選項是區分大小寫、區分腔調字、區分假名和區分全半形。</span><span class="sxs-lookup"><span data-stu-id="edd93-121">The options associated with a collation are case sensitivity, accent sensitivity, Kana-sensitivity, width sensitivity.</span></span> <span data-ttu-id="edd93-122">這些選項的指定方式是將它們附加至定序名稱。</span><span class="sxs-lookup"><span data-stu-id="edd93-122">These options are specified by appending them to the collation name.</span></span> <span data-ttu-id="edd93-123">例如，此定序 `Japanese_Bushu_Kakusu_100_CS_AS_KS_WS` 區分大小寫、區分腔調字、區分假名和區分全半形。</span><span class="sxs-lookup"><span data-stu-id="edd93-123">For example, this collation `Japanese_Bushu_Kakusu_100_CS_AS_KS_WS` is case-sensitive, accent-sensitive, Kana-sensitive, and width-sensitive.</span></span> <span data-ttu-id="edd93-124">下表描述與這些選項相關聯的行為。</span><span class="sxs-lookup"><span data-stu-id="edd93-124">The following table describes the behavior associated with these options.</span></span>  
  
|<span data-ttu-id="edd93-125">選項</span><span class="sxs-lookup"><span data-stu-id="edd93-125">Option</span></span>|<span data-ttu-id="edd93-126">描述</span><span class="sxs-lookup"><span data-stu-id="edd93-126">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="edd93-127">區分大小寫 (_CS)</span><span class="sxs-lookup"><span data-stu-id="edd93-127">Case-sensitive (_CS)</span></span>|<span data-ttu-id="edd93-128">區分大寫和小寫字母。</span><span class="sxs-lookup"><span data-stu-id="edd93-128">Distinguishes between uppercase and lowercase letters.</span></span> <span data-ttu-id="edd93-129">如果選取此選項，小寫字母會排序在大寫字母的前面。</span><span class="sxs-lookup"><span data-stu-id="edd93-129">If selected, lowercase letters sort ahead of their uppercase versions.</span></span> <span data-ttu-id="edd93-130">如果未選取此選項，則定序不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="edd93-130">If this option is not selected, the collation will be case-insensitive.</span></span> <span data-ttu-id="edd93-131">也就是說，在排序用途上，SQL Server 會將大寫和小寫字母視為相同。</span><span class="sxs-lookup"><span data-stu-id="edd93-131">That is, SQL Server considers the uppercase and lowercase versions of letters to be identical for sorting purposes.</span></span> <span data-ttu-id="edd93-132">指定 _CI，就可以明確地選取不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="edd93-132">You can explicitly select case insensitivity by specifying _CI.</span></span>|  
|<span data-ttu-id="edd93-133">區分腔調字 (_AS)</span><span class="sxs-lookup"><span data-stu-id="edd93-133">Accent-sensitive (_AS)</span></span>|<span data-ttu-id="edd93-134">區分有腔調和無腔調的字元。</span><span class="sxs-lookup"><span data-stu-id="edd93-134">Distinguishes between accented and unaccented characters.</span></span> <span data-ttu-id="edd93-135">例如，' a ' 不等於 ' &#x1EA5; '。</span><span class="sxs-lookup"><span data-stu-id="edd93-135">For example, 'a' is not equal to '&#x1EA5;'.</span></span> <span data-ttu-id="edd93-136">如果未選取此選項，則定序不區分腔調字。</span><span class="sxs-lookup"><span data-stu-id="edd93-136">If this option is not selected, the collation will be accent-insensitive.</span></span> <span data-ttu-id="edd93-137">也就是說，在排序用途上，SQL Server 會將有腔調和無腔調字母視為相同。</span><span class="sxs-lookup"><span data-stu-id="edd93-137">That is, SQL Server considers the accented and unaccented versions of letters to be identical for sorting purposes.</span></span> <span data-ttu-id="edd93-138">指定 _AI，就可以明確地選取不區分腔調字。</span><span class="sxs-lookup"><span data-stu-id="edd93-138">You can explicitly select accent insensitivity by specifying _AI.</span></span>|  
|<span data-ttu-id="edd93-139">區分假名 (_KS)</span><span class="sxs-lookup"><span data-stu-id="edd93-139">Kana-sensitive (_KS)</span></span>|<span data-ttu-id="edd93-140">區分兩種類型的日文假名字元：平假名與片假名。</span><span class="sxs-lookup"><span data-stu-id="edd93-140">Distinguishes between the two types of Japanese kana characters: Hiragana and Katakana.</span></span> <span data-ttu-id="edd93-141">如果未選取此選項，定序就不會區分假名。</span><span class="sxs-lookup"><span data-stu-id="edd93-141">If this option is not selected, the collation is Kana-insensitive.</span></span> <span data-ttu-id="edd93-142">也就是說，在排序用途上，SQL Server 會將平假名和片假名視為相同。</span><span class="sxs-lookup"><span data-stu-id="edd93-142">That is, SQL Server considers Hiragana and Katakana characters to be equal for sorting purposes.</span></span> <span data-ttu-id="edd93-143">省略此選項，是指定不區分假名的唯一方法。</span><span class="sxs-lookup"><span data-stu-id="edd93-143">Omitting this option is the only method of specifying Kana-insensitivity.</span></span>|  
|<span data-ttu-id="edd93-144">區分全半形 (_WS)</span><span class="sxs-lookup"><span data-stu-id="edd93-144">Width-sensitive (_WS)</span></span>|<span data-ttu-id="edd93-145">區分全形與半形字元。</span><span class="sxs-lookup"><span data-stu-id="edd93-145">Distinguishes between full-width and half-width characters.</span></span> <span data-ttu-id="edd93-146">如果未選取此選項，在排序用途上，SQL Server 會將相同字元的全形和半形表示法視為相同。</span><span class="sxs-lookup"><span data-stu-id="edd93-146">If this option is not selected, SQL Server considers the full-width and half-width representation of the same character to be identical for sorting purposes.</span></span> <span data-ttu-id="edd93-147">省略此選項，是指定不區分全形與半形的唯一方法。</span><span class="sxs-lookup"><span data-stu-id="edd93-147">Omitting this option is the only method of specifying width-insensitivity.</span></span>|  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="edd93-148">支援下列定序集：</span><span class="sxs-lookup"><span data-stu-id="edd93-148">supports the following collation sets:</span></span>  
  
 <span data-ttu-id="edd93-149">Windows 定序</span><span class="sxs-lookup"><span data-stu-id="edd93-149">Windows collations</span></span>  
 <span data-ttu-id="edd93-150">Windows 定序會定義規則，以便依據相關聯的 Windows 系統地區設定儲存字元資料。</span><span class="sxs-lookup"><span data-stu-id="edd93-150">Windows collations define rules for storing character data that are based on an associated Windows system locale.</span></span> <span data-ttu-id="edd93-151">如果是 Windows 定序，非 Unicode 資料的比較是使用與 Unicode 資料相同的演算法來實作。</span><span class="sxs-lookup"><span data-stu-id="edd93-151">For a Windows collation, comparison of non-Unicode data is implemented by using the same algorithm as Unicode data.</span></span> <span data-ttu-id="edd93-152">基本 Windows 定序規則會指定套用字典排序時使用的字母或語言，以及用來儲存非 Unicode 字元資料的字碼頁。</span><span class="sxs-lookup"><span data-stu-id="edd93-152">The base Windows collation rules specify which alphabet or language is used when dictionary sorting is applied, and the code page that is used to store non-Unicode character data.</span></span> <span data-ttu-id="edd93-153">Unicode 和非 Unicode 排序都與特定 Windows 版本中的字串比較相容。</span><span class="sxs-lookup"><span data-stu-id="edd93-153">Both Unicode and non-Unicode sorting are compatible with string comparisons in a particular version of Windows.</span></span> <span data-ttu-id="edd93-154">如此可讓 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 中的各種資料類型取得一致性，同時讓開發人員能夠使用與 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 相同的規則，在應用程式中排序字串。</span><span class="sxs-lookup"><span data-stu-id="edd93-154">This provides consistency across data types within [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], and it also lets developers sort strings in their applications by using the same rules that are used by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="edd93-155">如需詳細資訊，請參閱 [Windows 定序名稱 &#40;Transact-SQL&#41;](/sql/t-sql/statements/windows-collation-name-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="edd93-155">For more information, see [Windows Collation Name &#40;Transact-SQL&#41;](/sql/t-sql/statements/windows-collation-name-transact-sql).</span></span>  
  
 <span data-ttu-id="edd93-156">二進位定序</span><span class="sxs-lookup"><span data-stu-id="edd93-156">Binary collations</span></span>  
 <span data-ttu-id="edd93-157">二進位定序依據地區設定和資料類型所定義的字碼值順序來排序資料。</span><span class="sxs-lookup"><span data-stu-id="edd93-157">Binary collations sort data based on the sequence of coded values that are defined by the locale and data type.</span></span> <span data-ttu-id="edd93-158">它們會區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="edd93-158">They are case sensitive.</span></span> <span data-ttu-id="edd93-159">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 中的二進位定序會定義要使用的地區設定和 ANSI 字碼頁。</span><span class="sxs-lookup"><span data-stu-id="edd93-159">A binary collation in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] defines the locale and the ANSI code page that will be used.</span></span> <span data-ttu-id="edd93-160">這會強制使用二進位排序次序。</span><span class="sxs-lookup"><span data-stu-id="edd93-160">This enforces a binary sort order.</span></span> <span data-ttu-id="edd93-161">因為它們相對而言較為簡單，所以二進位定序可提升應用程式效能。</span><span class="sxs-lookup"><span data-stu-id="edd93-161">Because they are relatively simple, binary collations help improve application performance.</span></span> <span data-ttu-id="edd93-162">如果是非 Unicode 資料類型，資料比較是依據 ANSI 字碼頁中所定義的字碼元素。</span><span class="sxs-lookup"><span data-stu-id="edd93-162">For non-Unicode data types, data comparisons are based on the code points that are defined in the ANSI code page.</span></span> <span data-ttu-id="edd93-163">如果是 Unicode 資料類型，資料比較則是依據 Unicode 字碼指標。</span><span class="sxs-lookup"><span data-stu-id="edd93-163">For Unicode data types, data comparisons are based on the Unicode code points.</span></span> <span data-ttu-id="edd93-164">如果是 Unicode 資料類型的二進位定序，在資料排序時不會考量地區設定。</span><span class="sxs-lookup"><span data-stu-id="edd93-164">For binary collations on Unicode data types, the locale is not considered in data sorts.</span></span> <span data-ttu-id="edd93-165">例如，Latin_1_General_BIN 和 Japanese_BIN 用於 Unicode 資料時會產生相同的排序結果。</span><span class="sxs-lookup"><span data-stu-id="edd93-165">For example, Latin_1_General_BIN and Japanese_BIN yield identical sorting results when they are used on Unicode data.</span></span>  
  
 <span data-ttu-id="edd93-166">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 中有兩種二進位定序：較舊的 `BIN` 定序和較新的 `BIN2` 定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-166">There are two types of binary collations in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]; the older `BIN` collations and the newer `BIN2` collations.</span></span> <span data-ttu-id="edd93-167">在 `BIN2` 定序中，所有字元都是根據其字碼指標排序。</span><span class="sxs-lookup"><span data-stu-id="edd93-167">In a `BIN2` collation all characters are sorted according to their code points.</span></span> <span data-ttu-id="edd93-168">在 `BIN` 定序中，只有第一個字元是根據字碼指標排序，剩餘字元則是根據其位元組值排序。</span><span class="sxs-lookup"><span data-stu-id="edd93-168">In a `BIN` collation only the first character is sorted according to the code point, and remaining characters are sorted according to their byte values.</span></span> <span data-ttu-id="edd93-169">(因為 Intel 平台是 Little Endian 架構，所以 Unicode 字碼字元一律以位元組交換的方式儲存)。</span><span class="sxs-lookup"><span data-stu-id="edd93-169">(Because the Intel platform is a little endian architecture, Unicode code characters are always stored byte-swapped.)</span></span>  
  
 <span data-ttu-id="edd93-170">SQL Server 定序</span><span class="sxs-lookup"><span data-stu-id="edd93-170">SQL Server collations</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="edd93-171">定序 (SQL_\*) 會提供與 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]舊版之間的排序次序相容性。</span><span class="sxs-lookup"><span data-stu-id="edd93-171">collations (SQL_\*) provide sort order compatibility with earlier versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="edd93-172">非 Unicode 資料的字典排序規則與 Windows 作業系統提供的任何排序常式不相容。</span><span class="sxs-lookup"><span data-stu-id="edd93-172">The dictionary sorting rules for non-Unicode data are incompatible with any sorting routine that is provided by Windows operating systems.</span></span> <span data-ttu-id="edd93-173">不過，Unicode 資料的排序與 Windows 排序規則的特定版本相容。</span><span class="sxs-lookup"><span data-stu-id="edd93-173">However, sorting Unicode data is compatible with a particular version of Windows sorting rules.</span></span> <span data-ttu-id="edd93-174">因為 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 定序對非 Unicode 和 Unicode 資料使用不同的比較規則，所以您會看到相同資料的比較有不同的結果，這取決於基礎資料類型而定。</span><span class="sxs-lookup"><span data-stu-id="edd93-174">Because [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] collations use different comparison rules for non-Unicode and Unicode data, you will see different results for comparisons of the same data, depending on the underlying data type.</span></span> <span data-ttu-id="edd93-175">如需詳細資訊，請參閱 [SQL Server 定序名稱 &#40;Transact-SQL&#41;](/sql/t-sql/statements/sql-server-collation-name-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="edd93-175">For more information, see [SQL Server Collation Name &#40;Transact-SQL&#41;](/sql/t-sql/statements/sql-server-collation-name-transact-sql).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="edd93-176">當您升級 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的英文執行個體時，可基於與 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 現有的執行個體相容而指定 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 定序 (SQL_\*)。</span><span class="sxs-lookup"><span data-stu-id="edd93-176">When you upgrade an English-language instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] collations (SQL_\*) can be specified for compatibility with existing instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="edd93-177">因為 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體的預設定序是在安裝期間定義，所以當下列條件成立時，請一定要小心指定定序設定：</span><span class="sxs-lookup"><span data-stu-id="edd93-177">Because the default collation for an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is defined during setup, make sure that you specify collation settings carefully when the following are true:</span></span>  
> 
>  -   <span data-ttu-id="edd93-178">應用程式的程式碼視先前的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 定序行為而定。</span><span class="sxs-lookup"><span data-stu-id="edd93-178">Your application code depends on the behavior of previous [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] collations.</span></span>  
> -   <span data-ttu-id="edd93-179">您必須儲存反映多國語言的字元資料。</span><span class="sxs-lookup"><span data-stu-id="edd93-179">You must store character data that reflects multiple languages.</span></span>  
  
 <span data-ttu-id="edd93-180">您可以在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]執行個體的下列層級設定定序：</span><span class="sxs-lookup"><span data-stu-id="edd93-180">Setting collations are supported at the following levels of an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]:</span></span>  
  
 <span data-ttu-id="edd93-181">伺服器層級定序</span><span class="sxs-lookup"><span data-stu-id="edd93-181">Server-level collations</span></span>  
 <span data-ttu-id="edd93-182">預設伺服器定序是在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安裝期間設定，因此也會成為系統資料庫和所有使用者資料庫的預設定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-182">The default server collation is set during [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] setup, and also becomes the default collation of the system databases and all user databases.</span></span> <span data-ttu-id="edd93-183">請注意，您無法在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安裝期間選取僅限 Unicode 定序，因為系統不支援將它們當做伺服器層級定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-183">Note that Unicode-only collations cannot be selected during [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] setup because they are not supported as server-level collations.</span></span>  
  
 <span data-ttu-id="edd93-184">將定序指派給伺服器之後，除非匯出所有資料庫物件和資料，並重建 `master` 資料庫，然後匯入所有資料庫物件和資料，否則無法變更此定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-184">After a collation has been assigned to the server, you cannot change the collation except by exporting all database objects and data, rebuilding the `master` database, and importing all database objects and data.</span></span> <span data-ttu-id="edd93-185">若不變更 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]執行個體的預設定序，您可以在建立新資料庫或資料庫資料行時，指定想要的定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-185">Instead of changing the default collation of an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], you can specify the desired collation at the time that you create a new database or database column.</span></span>  
  
 <span data-ttu-id="edd93-186">資料庫層級定序</span><span class="sxs-lookup"><span data-stu-id="edd93-186">Database-level collations</span></span>  
 <span data-ttu-id="edd93-187">建立或修改資料庫時，您可以使用 CREATE DATABASE 或 ALTER DATABASE 陳述式的 COLLATE 子句來指定預設資料庫定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-187">When a database is created or modified, you can use the COLLATE clause of the CREATE DATABASE or ALTER DATABASE statement to specify the default database collation.</span></span> <span data-ttu-id="edd93-188">如果未指定定序，則會將伺服器定序指派給資料庫。</span><span class="sxs-lookup"><span data-stu-id="edd93-188">If no collation is specified, the database is assigned the server collation.</span></span>  
  
 <span data-ttu-id="edd93-189">除非變更伺服器的定序，否則無法變更系統資料庫的定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-189">You cannot change the collation of system databases except by changing the collation for the server.</span></span>  
  
 <span data-ttu-id="edd93-190">資料庫定序是用於資料庫中的所有中繼資料，而且是資料庫中使用之所有字串資料行、暫存物件、變數名稱和任何其他字串的預設值。</span><span class="sxs-lookup"><span data-stu-id="edd93-190">The database collation is used for all metadata in the database, and is the default for all string columns, temporary objects, variable names, and any other strings used in the database.</span></span> <span data-ttu-id="edd93-191">請注意，如果變更使用者資料庫的定序，則在資料庫中的查詢存取暫存資料表時，可能會發生定序衝突。</span><span class="sxs-lookup"><span data-stu-id="edd93-191">When you change the collation of a user database, there can be collation conflicts when queries in the database access temporary tables.</span></span> <span data-ttu-id="edd93-192">暫存資料表一律儲存在 `tempdb` 系統資料庫中，以使用執行個體的定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-192">Temporary tables are always stored in the `tempdb` system database, which will use the collation for the instance.</span></span> <span data-ttu-id="edd93-193">如果定序導致評估字元資料發生衝突，則比較使用者資料庫與 `tempdb` 間之字元資料的查詢可能會失敗。</span><span class="sxs-lookup"><span data-stu-id="edd93-193">Queries that compare character data between the user database and `tempdb` may fail if the collations cause a conflict in evaluating the character data.</span></span> <span data-ttu-id="edd93-194">您可以在查詢中指定 COLLATE 子句以解決此問題。</span><span class="sxs-lookup"><span data-stu-id="edd93-194">You can resolve this by specifying the COLLATE clause in the query.</span></span> <span data-ttu-id="edd93-195">如需詳細資訊，請參閱 [COLLATE &#40;Transact-SQL&#41;](/sql/t-sql/statements/collations)。</span><span class="sxs-lookup"><span data-stu-id="edd93-195">For more information, see [COLLATE &#40;Transact-SQL&#41;](/sql/t-sql/statements/collations).</span></span>  
  
 <span data-ttu-id="edd93-196">資料行層級定序</span><span class="sxs-lookup"><span data-stu-id="edd93-196">Column-level collations</span></span>  
 <span data-ttu-id="edd93-197">建立或改變資料表時，可以使用 COLLATE 子句來指定每個字元字串資料行的定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-197">When you create or alter a table, you can specify collations for each character-string column by using the COLLATE clause.</span></span> <span data-ttu-id="edd93-198">若未指定任何定序，就會將資料庫的預設定序指派給此資料行。</span><span class="sxs-lookup"><span data-stu-id="edd93-198">If no collation is specified, the column is assigned the default collation of the database.</span></span>  
  
 <span data-ttu-id="edd93-199">運算式層級定序</span><span class="sxs-lookup"><span data-stu-id="edd93-199">Expression-level collations</span></span>  
 <span data-ttu-id="edd93-200">運算式層級定序是在執行陳述式時設定的，而且它們會影響傳回結果集的方式。</span><span class="sxs-lookup"><span data-stu-id="edd93-200">Expression-level collations are set when a statement is run, and they affect the way a result set is returned.</span></span> <span data-ttu-id="edd93-201">這樣可讓 ORDER BY 將結果排序成地區設定特定的結果。</span><span class="sxs-lookup"><span data-stu-id="edd93-201">This enables ORDER BY sort results to be locale-specific.</span></span> <span data-ttu-id="edd93-202">使用類似下面的 COLLATE 子句來實作運算式層級定序：</span><span class="sxs-lookup"><span data-stu-id="edd93-202">Use a COLLATE clause such as the following to implement expression-level collations:</span></span>  
  
```  
SELECT name FROM customer ORDER BY name COLLATE Latin1_General_CS_AI;  
```  
  
  
###  <a name="locale"></a><a name="Locale_Defn"></a> <span data-ttu-id="edd93-203">地區設定</span><span class="sxs-lookup"><span data-stu-id="edd93-203">Locale</span></span>  
 <span data-ttu-id="edd93-204">地區設定是一組與某個地點或文化特性相關聯的資訊。</span><span class="sxs-lookup"><span data-stu-id="edd93-204">A locale is a set of information that is associated with a location or a culture.</span></span> <span data-ttu-id="edd93-205">這項資訊包括口語的名稱和識別碼、用來撰寫該語言的指令碼及文化習慣。</span><span class="sxs-lookup"><span data-stu-id="edd93-205">This can include the name and identifier of the spoken language, the script that is used to write the language, and cultural conventions.</span></span> <span data-ttu-id="edd93-206">定序可與一個或多個地區設定產生關聯。</span><span class="sxs-lookup"><span data-stu-id="edd93-206">Collations can be associated with one or more locales.</span></span> <span data-ttu-id="edd93-207">如需詳細資訊，請參閱 [Microsoft 指派的地區設定識別碼](https://msdn.microsoft.com/goglobal/bb964664.aspx)。</span><span class="sxs-lookup"><span data-stu-id="edd93-207">For more information, see [Locale IDs Assigned by Microsoft](https://msdn.microsoft.com/goglobal/bb964664.aspx).</span></span>  
  
  
###  <a name="code-page"></a><a name="Code_Page_Defn"></a><span data-ttu-id="edd93-208">字碼頁</span><span class="sxs-lookup"><span data-stu-id="edd93-208">Code Page</span></span>  
 <span data-ttu-id="edd93-209">字碼頁是給定的指令碼的已排序字元集，其中每一個字元與數字索引或字碼指標值相關聯。</span><span class="sxs-lookup"><span data-stu-id="edd93-209">A code page is an ordered set of characters of a given script in which a numeric index, or code point value, is associated with each character.</span></span> <span data-ttu-id="edd93-210">Windows 字碼頁一般稱為 *「字元集」* (Character set) 或 *charset*。</span><span class="sxs-lookup"><span data-stu-id="edd93-210">A Windows code page is typically referred to as a *character set* or *charset*.</span></span> <span data-ttu-id="edd93-211">字碼頁是用來提供不同 Windows 系統地區設定所使用的字元集和鍵盤配置的支援。</span><span class="sxs-lookup"><span data-stu-id="edd93-211">Code pages are used to provide support for the character sets and keyboard layouts that are used by different Windows system locales.</span></span>  
  
  
###  <a name="sort-order"></a><a name="Sort_Order_Defn"></a><span data-ttu-id="edd93-212">排序次序</span><span class="sxs-lookup"><span data-stu-id="edd93-212">Sort Order</span></span>  
 <span data-ttu-id="edd93-213">排序次序會指定如何排序資料值。</span><span class="sxs-lookup"><span data-stu-id="edd93-213">Sort order specifies how data values are sorted.</span></span> <span data-ttu-id="edd93-214">這會影響資料比較的結果。</span><span class="sxs-lookup"><span data-stu-id="edd93-214">This affects the results of data comparison.</span></span> <span data-ttu-id="edd93-215">資料是使用定序來排序，而且可以使用索引來最佳化。</span><span class="sxs-lookup"><span data-stu-id="edd93-215">Data is sorted by using collations, and it can be optimized by using indexes.</span></span>  
  
  
##  <a name="unicode-support"></a><a name="Unicode_Defn"></a><span data-ttu-id="edd93-216">Unicode 支援</span><span class="sxs-lookup"><span data-stu-id="edd93-216">Unicode Support</span></span>  
 <span data-ttu-id="edd93-217">Unicode 是將字碼指標對應到字元的標準用法。</span><span class="sxs-lookup"><span data-stu-id="edd93-217">Unicode is a standard for mapping code points to characters.</span></span> <span data-ttu-id="edd93-218">由於 Unicode 主要設計為涵蓋世界上所有語言的字元，因此不需要使用不同的字碼頁來處理不同的字元集。</span><span class="sxs-lookup"><span data-stu-id="edd93-218">Because it is designed to cover all the characters of all the languages of the world, there is no need for different code pages to handle different sets of characters.</span></span> <span data-ttu-id="edd93-219">如果您儲存能夠反映多種語言的字元資料，一定要使用 Unicode 資料類型 (`nchar`、`nvarchar` 及 `ntext`) 而不要使用非 Unicode 資料類型 (`char`、`varchar` 及 `text`)。</span><span class="sxs-lookup"><span data-stu-id="edd93-219">If you store character data that reflects multiple languages, always use Unicode data types (`nchar`, `nvarchar`, and `ntext`) instead of the non-Unicode data types (`char`, `varchar`, and `text`).</span></span>  
  
 <span data-ttu-id="edd93-220">重要限制會與非 Unicode 資料類型相關聯。</span><span class="sxs-lookup"><span data-stu-id="edd93-220">Significant limitations are associated with non-Unicode data types.</span></span> <span data-ttu-id="edd93-221">這是因為非 Unicode 電腦受限於使用單一字碼頁。</span><span class="sxs-lookup"><span data-stu-id="edd93-221">This is because a non-Unicode computer will be limited to use of a single code page.</span></span> <span data-ttu-id="edd93-222">透過使用 Unicode，您可能會發現效能獲得明顯改善，因為所需要的字碼頁轉換減少。</span><span class="sxs-lookup"><span data-stu-id="edd93-222">You might experience performance gain by using Unicode because fewer code-page conversions are required.</span></span> <span data-ttu-id="edd93-223">您必須在資料庫、資料行或運算式層級個別選取 Unicode 定序，因為伺服器層級不支援這些定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-223">Unicode collations must be selected individually at the database, column or expression level because they are not supported at the server level.</span></span>  
  
 <span data-ttu-id="edd93-224">用戶端所使用的字碼頁是由作業系統設定決定。</span><span class="sxs-lookup"><span data-stu-id="edd93-224">The code pages that a client uses are determined by the operating system settings.</span></span> <span data-ttu-id="edd93-225">若要在 Windows XP 作業系統上設定用戶端字碼頁，請使用 [控制台] 中的 **[地區設定]** 。</span><span class="sxs-lookup"><span data-stu-id="edd93-225">To set client code pages on the Windows operating system, use **Regional Settings** in Control Panel.</span></span>  
  
 <span data-ttu-id="edd93-226">當您將資料從伺服器移至用戶端時，舊版用戶端驅動程式可能無法辨識您的伺服器定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-226">When you move data from a server to a client, your server collation might not be recognized by older client drivers.</span></span> <span data-ttu-id="edd93-227">這種問題可能會發生在您將資料從 Unicode 伺服器移至非 Unicode 用戶端時。</span><span class="sxs-lookup"><span data-stu-id="edd93-227">This can occur when you move data from a Unicode server to a non-Unicode client.</span></span> <span data-ttu-id="edd93-228">此時，最佳選項可能就是升級用戶端作業系統，以便更新基礎系統定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-228">Your best option might be to upgrade the client operating system so that the underlying system collations are updated.</span></span> <span data-ttu-id="edd93-229">如果用戶端已經安裝資料庫用戶端軟體，就可以考慮將服務更新套用至資料庫用戶端軟體。</span><span class="sxs-lookup"><span data-stu-id="edd93-229">If the client has database client software installed, you might consider applying a service update to the database client software.</span></span>  
  
 <span data-ttu-id="edd93-230">此外，您也可以嘗試針對伺服器上的資料使用不同的定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-230">You can also try to use a different collation for the data on the server.</span></span> <span data-ttu-id="edd93-231">您可以選擇將會對應至用戶端字碼頁的定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-231">Choose a collation that will map to a code page on the client.</span></span>  
  
 <span data-ttu-id="edd93-232">若要使用 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)]中提供的 UTF-16 定序，您可以選取其中一個補充字元 `_SC` 定序 (僅限 Windows 定序) 來改善部分 Unicode 字元的搜尋和排序。</span><span class="sxs-lookup"><span data-stu-id="edd93-232">To use the UTF-16 collations available in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)], you can select one of the supplementary characters `_SC` collations (Windows collations only) to improve searching and sorting of some Unicode characters.</span></span>  
  
 <span data-ttu-id="edd93-233">若要評估與使用 Unicode 或非 Unicode 資料類型有關的議題，請測試自己的狀況，在您的環境中衡量效能差異。</span><span class="sxs-lookup"><span data-stu-id="edd93-233">To evaluate issues that are related to using Unicode or non-Unicode data types, test your scenario to measure performance differences in your environment.</span></span> <span data-ttu-id="edd93-234">建議您將組織內系統上使用的定序標準化，並盡量部署 Unicode 伺服器和用戶端。</span><span class="sxs-lookup"><span data-stu-id="edd93-234">It is a good practice to standardize the collation that is used on systems across your organization, and deploy Unicode servers and clients wherever possible.</span></span>  
  
 <span data-ttu-id="edd93-235">在許多情況下， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 將與其他伺服器或用戶端互動，而且您的組織可能會在應用程式與伺服器執行個體之間使用多重資料存取標準。</span><span class="sxs-lookup"><span data-stu-id="edd93-235">In many situations, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] will interact with other servers or clients, and your organization might use multiple data access standards between applications and server instances.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="edd93-236">用戶端是兩種主要類型中的其中一種：</span><span class="sxs-lookup"><span data-stu-id="edd93-236">clients are one of two main types:</span></span>  
  
-   <span data-ttu-id="edd93-237">**Unicode 用戶端** ，使用 OLE DB 和開放式資料庫連接 (ODBC) 3.7 版或更新版本。</span><span class="sxs-lookup"><span data-stu-id="edd93-237">**Unicode clients** that use OLE DB and Open Database Connectivity (ODBC) version 3.7 or a later version.</span></span>  
  
-   <span data-ttu-id="edd93-238">**非 Unicode 用戶端** ，使用 DB-Library 和 ODBC 3.6 版或更早版本。</span><span class="sxs-lookup"><span data-stu-id="edd93-238">**Non-Unicode clients** that use DB-Library and ODBC version 3.6 or an earlier version.</span></span>  
  
 <span data-ttu-id="edd93-239">下表將提供搭配 Unicode 和非 Unicode 伺服器的各種組合來使用多國語言資料的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="edd93-239">The following table provides information about using multilingual data with various combinations of Unicode and non-Unicode servers.</span></span>  
  
|<span data-ttu-id="edd93-240">伺服器</span><span class="sxs-lookup"><span data-stu-id="edd93-240">Server</span></span>|<span data-ttu-id="edd93-241">Client</span><span class="sxs-lookup"><span data-stu-id="edd93-241">Client</span></span>|<span data-ttu-id="edd93-242">好處或限制</span><span class="sxs-lookup"><span data-stu-id="edd93-242">Benefits or Limitations</span></span>|  
|------------|------------|-----------------------------|  
|<span data-ttu-id="edd93-243">Unicode</span><span class="sxs-lookup"><span data-stu-id="edd93-243">Unicode</span></span>|<span data-ttu-id="edd93-244">Unicode</span><span class="sxs-lookup"><span data-stu-id="edd93-244">Unicode</span></span>|<span data-ttu-id="edd93-245">由於 Unicode 資料將在整個系統中使用，所以這個狀況可提供最佳效能，並防止所擷取的資料遭到損毀。</span><span class="sxs-lookup"><span data-stu-id="edd93-245">Because Unicode data will be used throughout the system, this scenario provides the best performance and protection from corruption of retrieved data.</span></span> <span data-ttu-id="edd93-246">這是 ActiveX Data Objects (ADO)、OLE DB 和 ODBC 3.7 版或更新版本的情況。</span><span class="sxs-lookup"><span data-stu-id="edd93-246">This is the situation with ActiveX Data Objects (ADO), OLE DB, and ODBC version 3.7 or a later version.</span></span>|  
|<span data-ttu-id="edd93-247">Unicode</span><span class="sxs-lookup"><span data-stu-id="edd93-247">Unicode</span></span>|<span data-ttu-id="edd93-248">非 Unicode</span><span class="sxs-lookup"><span data-stu-id="edd93-248">Non-Unicode</span></span>|<span data-ttu-id="edd93-249">在此狀況中，特別是執行新版作業系統的伺服器與執行舊版 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]或在舊版作業系統上執行的用戶端之間存在連接，當您將資料移至用戶端電腦時，可能會有一些限制或錯誤。</span><span class="sxs-lookup"><span data-stu-id="edd93-249">In this scenario, especially with connections between a server that is running a newer operating system and a client that is running an older version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], or on an older operating system, there can be limitations or errors when you move data to a client computer.</span></span> <span data-ttu-id="edd93-250">伺服器上的 Unicode 資料將嘗試對應至非 Unicode 用戶端上的對應字碼頁，以便轉換資料。</span><span class="sxs-lookup"><span data-stu-id="edd93-250">Unicode data on the server will try to map to a corresponding code page on the non-Unicode client to convert the data.</span></span>|  
|<span data-ttu-id="edd93-251">非 Unicode</span><span class="sxs-lookup"><span data-stu-id="edd93-251">Non-Unicode</span></span>|<span data-ttu-id="edd93-252">Unicode</span><span class="sxs-lookup"><span data-stu-id="edd93-252">Unicode</span></span>|<span data-ttu-id="edd93-253">這不是使用多國語言資料的理想組態。</span><span class="sxs-lookup"><span data-stu-id="edd93-253">This is not an ideal configuration for using multilingual data.</span></span> <span data-ttu-id="edd93-254">您無法將 Unicode 資料寫入非 Unicode 伺服器。</span><span class="sxs-lookup"><span data-stu-id="edd93-254">You cannot write Unicode data to the non-Unicode server.</span></span> <span data-ttu-id="edd93-255">當資料傳送到在此伺服器的字碼頁以外的伺服器時，就可能發生問題。</span><span class="sxs-lookup"><span data-stu-id="edd93-255">Problems are likely to occur when data is sent to servers that are outside the server's code page.</span></span>|  
|<span data-ttu-id="edd93-256">非 Unicode</span><span class="sxs-lookup"><span data-stu-id="edd93-256">Non-Unicode</span></span>|<span data-ttu-id="edd93-257">非 Unicode</span><span class="sxs-lookup"><span data-stu-id="edd93-257">Non-Unicode</span></span>|<span data-ttu-id="edd93-258">這是多國語言資料的限制狀況。</span><span class="sxs-lookup"><span data-stu-id="edd93-258">This is a very limiting scenario for multilingual data.</span></span> <span data-ttu-id="edd93-259">您只能使用單一字碼頁。</span><span class="sxs-lookup"><span data-stu-id="edd93-259">You can use only a single code page.</span></span>|  
  
  
##  <a name="supplementary-characters"></a><a name="Supplementary_Characters"></a><span data-ttu-id="edd93-260">增補字元</span><span class="sxs-lookup"><span data-stu-id="edd93-260">Supplementary Characters</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="edd93-261">提供資料類型（例如 `nchar` 和） `nvarchar` 以儲存 Unicode 資料。</span><span class="sxs-lookup"><span data-stu-id="edd93-261">provides data types such as `nchar` and `nvarchar` to store Unicode data.</span></span> <span data-ttu-id="edd93-262">這些資料類型會使用稱為 *UTF-16*的格式來編碼文字。</span><span class="sxs-lookup"><span data-stu-id="edd93-262">These data types encode text in a format called *UTF-16*.</span></span> <span data-ttu-id="edd93-263">Unicode Consortium 會為每個字元配置唯一的字碼指標，其值介於 0x0000 到 0x10FFFF 的範圍。</span><span class="sxs-lookup"><span data-stu-id="edd93-263">The Unicode Consortium allocates each character a unique codepoint, which is a value in the range 0x0000 to 0x10FFFF.</span></span> <span data-ttu-id="edd93-264">最常用的字元具有可在記憶體和磁碟上納入 16 位元單字的字碼指標值，但是字碼指標值大於 0xFFFF 的字元則需要兩個連續的 16 位元單字。</span><span class="sxs-lookup"><span data-stu-id="edd93-264">The most frequently used characters have codepoint values that will fit into a 16-bit word in memory and on disk, but characters with codepoint values larger than 0xFFFF require two consecutive 16-bit words.</span></span> <span data-ttu-id="edd93-265">這些字元稱為 *「增補字元」*(Supplementary Character)，而這兩個連續的 16 位元單字則稱為 *「Surrogate 字組」*(Surrogate Pair)。</span><span class="sxs-lookup"><span data-stu-id="edd93-265">These characters are called *supplementary characters*, and the two consecutive 16-bit words are called *surrogate pairs*.</span></span>  
  
 <span data-ttu-id="edd93-266">如果您使用增補字元：</span><span class="sxs-lookup"><span data-stu-id="edd93-266">If you use supplementary characters:</span></span>  
  
-   <span data-ttu-id="edd93-267">增補字元可用於 90 (含) 以上定序版本的排序及比較作業。</span><span class="sxs-lookup"><span data-stu-id="edd93-267">Supplementary characters can be used in ordering and comparison operations in collation versions 90 or greater.</span></span>  
  
-   <span data-ttu-id="edd93-268">所有 _100 層級定序都支援含有增補字元的語言排序。</span><span class="sxs-lookup"><span data-stu-id="edd93-268">All _100 level collations support linguistic sorting with supplementary characters.</span></span>  
  
-   <span data-ttu-id="edd93-269">不支援在中繼資料內使用增補字元，例如資料庫物件的名稱。</span><span class="sxs-lookup"><span data-stu-id="edd93-269">Supplementary characters are not supported for use in metadata, such as in names of database objects.</span></span>  
  
-   <span data-ttu-id="edd93-270">[!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] 中導入之全新系列的增補字元 (SC) 定序可搭配 `nchar`、`nvarchar` 和 `sql_variant` 資料類型使用。</span><span class="sxs-lookup"><span data-stu-id="edd93-270">Introduced in [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], a new family of supplementary character (SC) collations can be used with the data types `nchar`, `nvarchar` and `sql_variant`.</span></span> <span data-ttu-id="edd93-271">例如： `Latin1_General_100_CI_AS_SC`或 `Japanese_Bushu_Kakusu_100_CI_AS_SC`(如果使用日文定序的話)。</span><span class="sxs-lookup"><span data-stu-id="edd93-271">For example: `Latin1_General_100_CI_AS_SC`, or if using a Japanese collation, `Japanese_Bushu_Kakusu_100_CI_AS_SC`.</span></span>  
  
     <span data-ttu-id="edd93-272">SC 旗標可套用至：</span><span class="sxs-lookup"><span data-stu-id="edd93-272">The SC flag can be applied to:</span></span>  
  
    -   <span data-ttu-id="edd93-273">90 版本的 Windows 定序</span><span class="sxs-lookup"><span data-stu-id="edd93-273">Version 90 Windows collations</span></span>  
  
    -   <span data-ttu-id="edd93-274">100 版本的 Windows 定序</span><span class="sxs-lookup"><span data-stu-id="edd93-274">Version 100 Windows collations</span></span>  
  
     <span data-ttu-id="edd93-275">SC 旗標無法套用至：</span><span class="sxs-lookup"><span data-stu-id="edd93-275">The SC flag cannot be applied to:</span></span>  
  
    -   <span data-ttu-id="edd93-276">80 版本的非版本控制 Windows 定序</span><span class="sxs-lookup"><span data-stu-id="edd93-276">Version 80 non-versioned Windows collations</span></span>  
  
    -   <span data-ttu-id="edd93-277">BIN 或 BIN2 二進位定序</span><span class="sxs-lookup"><span data-stu-id="edd93-277">The BIN or BIN2 binary collations</span></span>  
  
    -   <span data-ttu-id="edd93-278">SQL\* 定序</span><span class="sxs-lookup"><span data-stu-id="edd93-278">The SQL\* collations</span></span>  
  
 <span data-ttu-id="edd93-279">下表將比較當某些字串函數和字串運算子使用增補字元搭配或不搭配 SC 定序時，這些函數和運算子的行為。</span><span class="sxs-lookup"><span data-stu-id="edd93-279">The following table compares the behavior of some string functions and string operators when they use supplementary characters with and without a SC collation.</span></span>  
  
|<span data-ttu-id="edd93-280">字串函數或運算子</span><span class="sxs-lookup"><span data-stu-id="edd93-280">String Function or Operator</span></span>|<span data-ttu-id="edd93-281">搭配 SC 定序</span><span class="sxs-lookup"><span data-stu-id="edd93-281">With an SC Collation</span></span>|<span data-ttu-id="edd93-282">不搭配 SC 定序</span><span class="sxs-lookup"><span data-stu-id="edd93-282">Without an SC Collation</span></span>|  
|---------------------------------|--------------------------|-----------------------------|  
|[<span data-ttu-id="edd93-283">CHARINDEX</span><span class="sxs-lookup"><span data-stu-id="edd93-283">CHARINDEX</span></span>](/sql/t-sql/functions/charindex-transact-sql)<br /><br /> [<span data-ttu-id="edd93-284">LEN</span><span class="sxs-lookup"><span data-stu-id="edd93-284">LEN</span></span>](/sql/t-sql/functions/len-transact-sql)<br /><br /> [<span data-ttu-id="edd93-285">PATINDEX</span><span class="sxs-lookup"><span data-stu-id="edd93-285">PATINDEX</span></span>](/sql/t-sql/functions/patindex-transact-sql)|<span data-ttu-id="edd93-286">將 UTF-16 Surrogate 字組視為單一字碼指標。</span><span class="sxs-lookup"><span data-stu-id="edd93-286">The UTF-16 surrogate pair is counted as a single codepoint.</span></span>|<span data-ttu-id="edd93-287">將 UTF-16 Surrogate 字組視為兩個字碼指標。</span><span class="sxs-lookup"><span data-stu-id="edd93-287">The UTF-16 surrogate pair is counted as two codepoints.</span></span>|  
|[<span data-ttu-id="edd93-288">LEFT</span><span class="sxs-lookup"><span data-stu-id="edd93-288">LEFT</span></span>](/sql/t-sql/functions/left-transact-sql)<br /><br /> [<span data-ttu-id="edd93-289">REPLACE</span><span class="sxs-lookup"><span data-stu-id="edd93-289">REPLACE</span></span>](/sql/t-sql/functions/replace-transact-sql)<br /><br /> [<span data-ttu-id="edd93-290">REVERSE</span><span class="sxs-lookup"><span data-stu-id="edd93-290">REVERSE</span></span>](/sql/t-sql/functions/reverse-transact-sql)<br /><br /> [<span data-ttu-id="edd93-291">RIGHT</span><span class="sxs-lookup"><span data-stu-id="edd93-291">RIGHT</span></span>](/sql/t-sql/functions/right-transact-sql)<br /><br /> [<span data-ttu-id="edd93-292">SUBSTRING</span><span class="sxs-lookup"><span data-stu-id="edd93-292">SUBSTRING</span></span>](/sql/t-sql/functions/substring-transact-sql)<br /><br /> [<span data-ttu-id="edd93-293">STUFF</span><span class="sxs-lookup"><span data-stu-id="edd93-293">STUFF</span></span>](/sql/t-sql/functions/stuff-transact-sql)|<span data-ttu-id="edd93-294">這些函數會將每個 Surrogate 字組視為單一字碼指標，並且如預期方式運作。</span><span class="sxs-lookup"><span data-stu-id="edd93-294">These functions treat each surrogate pair as a single codepoint and work as expected.</span></span>|<span data-ttu-id="edd93-295">這些函數可能會將 Surrogate 字組拆開，造成無法預期的結果。</span><span class="sxs-lookup"><span data-stu-id="edd93-295">These functions may split any surrogate pairs and lead to unexpected results.</span></span>|  
|[<span data-ttu-id="edd93-296">NCHAR</span><span class="sxs-lookup"><span data-stu-id="edd93-296">NCHAR</span></span>](/sql/t-sql/functions/nchar-transact-sql)|<span data-ttu-id="edd93-297">傳回對應至指定之 Unicode 字碼指標值 (在 0 到 0x10FFFF 的範圍內) 的字元。</span><span class="sxs-lookup"><span data-stu-id="edd93-297">Returns the character corresponding to the specified Unicode codepoint value in the range 0 to 0x10FFFF.</span></span> <span data-ttu-id="edd93-298">如果指定的值位於 0 到 0xFFFF 的範圍內，就會傳回單一字元。</span><span class="sxs-lookup"><span data-stu-id="edd93-298">If the value specified lies in the range 0 through 0xFFFF, one character is returned.</span></span> <span data-ttu-id="edd93-299">若為更高的值，則傳回對應的 Surrogate。</span><span class="sxs-lookup"><span data-stu-id="edd93-299">For higher values, the corresponding surrogate is returned.</span></span>|<span data-ttu-id="edd93-300">高於 0xFFFF 的值會傳回 NULL 而非對應的 Surrogate。</span><span class="sxs-lookup"><span data-stu-id="edd93-300">A value higher than 0xFFFF returns NULL instead of the corresponding surrogate.</span></span>|  
|[<span data-ttu-id="edd93-301">UNICODE</span><span class="sxs-lookup"><span data-stu-id="edd93-301">UNICODE</span></span>](/sql/t-sql/functions/unicode-transact-sql)|<span data-ttu-id="edd93-302">傳回 UTF-16 字碼指標 (在 0 到 0x10FFFF 的範圍內)。</span><span class="sxs-lookup"><span data-stu-id="edd93-302">Returns a UTF-16 codepoint in the range 0 through 0x10FFFF.</span></span>|<span data-ttu-id="edd93-303">傳回 UCS-2 字碼指標 (在 0 到 0xFFFF 的範圍內)。</span><span class="sxs-lookup"><span data-stu-id="edd93-303">Returns a UCS-2 codepoint in the range 0 through 0xFFFF.</span></span>|  
|[<span data-ttu-id="edd93-304">符合單一萬用字元</span><span class="sxs-lookup"><span data-stu-id="edd93-304">Match One Character Wildcard</span></span>](/sql/t-sql/language-elements/wildcard-match-one-character-transact-sql)<br /><br /> [<span data-ttu-id="edd93-305">萬用字元 - 不相符的字元</span><span class="sxs-lookup"><span data-stu-id="edd93-305">Wildcard - Character(s) Not to Match</span></span>](/sql/t-sql/language-elements/wildcard-character-s-not-to-match-transact-sql)|<span data-ttu-id="edd93-306">增補字元支援所有萬用字元作業。</span><span class="sxs-lookup"><span data-stu-id="edd93-306">Supplementary characters are supported for all wildcard operations.</span></span>|<span data-ttu-id="edd93-307">增補字元不支援這些萬用字元作業，</span><span class="sxs-lookup"><span data-stu-id="edd93-307">Supplementary characters are not supported for these wildcard operations.</span></span> <span data-ttu-id="edd93-308">但支援其他萬用字元運算子。</span><span class="sxs-lookup"><span data-stu-id="edd93-308">Other wildcard operators are supported.</span></span>|  
  
  
##  <a name="gb18030-support"></a><a name="GB18030"></a><span data-ttu-id="edd93-309">GB18030 支援</span><span class="sxs-lookup"><span data-stu-id="edd93-309">GB18030 Support</span></span>  
 <span data-ttu-id="edd93-310">GB18030 是一種獨立標準，可供中華人民共和國進行中文字元的編碼。</span><span class="sxs-lookup"><span data-stu-id="edd93-310">GB18030 is a separate standard used in the People's Republic of China for encoding Chinese characters.</span></span> <span data-ttu-id="edd93-311">在 GB18030 中，字元的長度可以是 1、2 或 4 個位元組。</span><span class="sxs-lookup"><span data-stu-id="edd93-311">In GB18030, characters can be 1, 2, or 4 bytes in length.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="edd93-312">可在 GB18030 編碼的字元從用戶端應用程式進入伺服器時加以辨識，並在轉換後以原生模式將其儲存為 Unicode 字元，藉以支援這種編碼的字元。</span><span class="sxs-lookup"><span data-stu-id="edd93-312">provides support for GB18030-encoded characters by recognizing them when they enter the server from a client-side application and converting and storing them natively as Unicode characters.</span></span> <span data-ttu-id="edd93-313">當 GB18030 編碼的字元儲存在伺服器中後，任何後續作業都會將其視為 Unicode 字元。</span><span class="sxs-lookup"><span data-stu-id="edd93-313">After they are stored in the server, they are treated as Unicode characters in any subsequent operations.</span></span> <span data-ttu-id="edd93-314">您可以使用任何中文定序，最好是使用最新的 100 版本。</span><span class="sxs-lookup"><span data-stu-id="edd93-314">You can use any Chinese collation, preferably the latest 100 version.</span></span> <span data-ttu-id="edd93-315">所有 _100 層級定序都支援含有 GB18030 字元的語言排序。</span><span class="sxs-lookup"><span data-stu-id="edd93-315">All _100 level collations support linguistic sorting with GB18030 characters.</span></span> <span data-ttu-id="edd93-316">如果資料包含增補字元 (Surrogate 字組)，您就可以使用 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] 所提供的 SC 定序來改善搜尋和排序。</span><span class="sxs-lookup"><span data-stu-id="edd93-316">If the data includes supplementary characters (surrogate pairs), you can use the SC collations available in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] to improve searching and sorting.</span></span>  
  
  
##  <a name="complex-script-support"></a><a name="Complex_script"></a><span data-ttu-id="edd93-317">複雜字集支援</span><span class="sxs-lookup"><span data-stu-id="edd93-317">Complex Script Support</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="edd93-318">可以支援輸入、儲存、變更和顯示複雜字集。</span><span class="sxs-lookup"><span data-stu-id="edd93-318">can support inputting, storing, changing, and displaying complex scripts.</span></span> <span data-ttu-id="edd93-319">複雜字集包括下列各項：</span><span class="sxs-lookup"><span data-stu-id="edd93-319">Complex scripts include the following:</span></span>  
  
-   <span data-ttu-id="edd93-320">包括由右至左和由左至右兩種文字之組合的字集，如阿拉伯文和英文文字的組合。</span><span class="sxs-lookup"><span data-stu-id="edd93-320">Scripts that include the combination of both right-to-left and left-to-right text, such as a combination of Arabic and English text.</span></span>  
  
-   <span data-ttu-id="edd93-321">字元的形狀會隨著位置或是否結合其他字元而不同的字集，例如，阿拉伯文、印度文和泰文字元。</span><span class="sxs-lookup"><span data-stu-id="edd93-321">Scripts whose characters change shape depending on their position, or when combined with other characters, such as Arabic, Indic, and Thai characters.</span></span>  
  
-   <span data-ttu-id="edd93-322">泰文之類的語言，因為單字之間不中斷，所以需要用內部字典來辨識單字。</span><span class="sxs-lookup"><span data-stu-id="edd93-322">Languages such as Thai that require internal dictionaries to recognize words because there are no breaks between them.</span></span>  
  
 <span data-ttu-id="edd93-323">與 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 互動的資料庫應用程式必須使用支援複雜字集的控制項。</span><span class="sxs-lookup"><span data-stu-id="edd93-323">Database applications that interact with [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] must use controls that support complex scripts.</span></span> <span data-ttu-id="edd93-324">Managed 程式碼中所建立的標準 Windows Form 控制項具有複雜字集的功能。</span><span class="sxs-lookup"><span data-stu-id="edd93-324">Standard Windows form controls that are created in managed code are complex script-enabled.</span></span>  
  
  
##  <a name="related-tasks"></a><a name="Related_Tasks"></a> <span data-ttu-id="edd93-325">相關工作</span><span class="sxs-lookup"><span data-stu-id="edd93-325">Related Tasks</span></span>  
  
|<span data-ttu-id="edd93-326">Task</span><span class="sxs-lookup"><span data-stu-id="edd93-326">Task</span></span>|<span data-ttu-id="edd93-327">主題</span><span class="sxs-lookup"><span data-stu-id="edd93-327">Topic</span></span>|  
|----------|-----------|  
|<span data-ttu-id="edd93-328">描述如何設定或變更 SQL Server 執行個體的定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-328">Describes how to set or change the collation of the instance of SQL Server.</span></span>|[<span data-ttu-id="edd93-329">設定或變更伺服器定序</span><span class="sxs-lookup"><span data-stu-id="edd93-329">Set or Change the Server Collation</span></span>](set-or-change-the-server-collation.md)|  
|<span data-ttu-id="edd93-330">描述如何設定或變更使用者資料庫的定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-330">Describes how to set or change the collation of a user database.</span></span>|[<span data-ttu-id="edd93-331">設定或變更資料庫定序</span><span class="sxs-lookup"><span data-stu-id="edd93-331">Set or Change the Database Collation</span></span>](set-or-change-the-database-collation.md)|  
|<span data-ttu-id="edd93-332">描述如何設定或變更資料庫中資料行的定序。</span><span class="sxs-lookup"><span data-stu-id="edd93-332">Describes how to set or change the collation of a column in the database.</span></span>|[<span data-ttu-id="edd93-333">設定或變更資料行定序</span><span class="sxs-lookup"><span data-stu-id="edd93-333">Set or Change the Column Collation</span></span>](set-or-change-the-column-collation.md)|  
|<span data-ttu-id="edd93-334">描述如何傳回伺服器、資料庫或資料行層級的定序資訊。</span><span class="sxs-lookup"><span data-stu-id="edd93-334">Describes how to return collation information at the server, database, or column level.</span></span>|[<span data-ttu-id="edd93-335">檢視定序資訊</span><span class="sxs-lookup"><span data-stu-id="edd93-335">View Collation Information</span></span>](view-collation-information.md)|  
|<span data-ttu-id="edd93-336">描述如何撰寫 Transact-SQL 陳述式，讓它們可以從某種語言移植至另一種語言，或更輕鬆地支援多種語言。</span><span class="sxs-lookup"><span data-stu-id="edd93-336">Describes how to write Transact-SQL statements that will make them more portable from one language to another, or support multiple languages more easily.</span></span>|[<span data-ttu-id="edd93-337">撰寫國際通用的 Transact-SQL 陳述式</span><span class="sxs-lookup"><span data-stu-id="edd93-337">Write International Transact-SQL Statements</span></span>](write-international-transact-sql-statements.md)|  
|<span data-ttu-id="edd93-338">描述如何變更錯誤訊息的語言，以及日期、時間和貨幣資料之使用和顯示方式的喜好設定。</span><span class="sxs-lookup"><span data-stu-id="edd93-338">Describes how to change the language of error messages and preferences for how date, time, and currency data are used and displayed.</span></span>|[<span data-ttu-id="edd93-339">設定工作階段語言</span><span class="sxs-lookup"><span data-stu-id="edd93-339">Set a Session Language</span></span>](set-a-session-language.md)|  
  
  
##  <a name="related-content"></a><a name="Related_Content"></a> <span data-ttu-id="edd93-340">相關內容</span><span class="sxs-lookup"><span data-stu-id="edd93-340">Related Content</span></span>  
 [<span data-ttu-id="edd93-341">SQL Server 最佳作法定序變更</span><span class="sxs-lookup"><span data-stu-id="edd93-341">SQL Server Best Practices Collation Change</span></span>](https://go.microsoft.com/fwlink/?LinkId=113891)  
  
 [<span data-ttu-id="edd93-342">＜SQL Server 最佳作法：移轉至 Unicode＞</span><span class="sxs-lookup"><span data-stu-id="edd93-342">"SQL Server Best Practices Migration to Unicode"</span></span>](https://go.microsoft.com/fwlink/?LinkId=113890)  
  
 [<span data-ttu-id="edd93-343">Unicode Consortium 網站</span><span class="sxs-lookup"><span data-stu-id="edd93-343">Unicode Consortium Web site</span></span>](https://go.microsoft.com/fwlink/?LinkId=48619)  
  
## <a name="see-also"></a><span data-ttu-id="edd93-344">另請參閱</span><span class="sxs-lookup"><span data-stu-id="edd93-344">See Also</span></span>  
 <span data-ttu-id="edd93-345">[自主資料庫定序](../databases/contained-database-collations.md) </span><span class="sxs-lookup"><span data-stu-id="edd93-345">[Contained Database Collations](../databases/contained-database-collations.md) </span></span>  
 <span data-ttu-id="edd93-346">[選擇建立全文檢索索引時的語言](../search/choose-a-language-when-creating-a-full-text-index.md) </span><span class="sxs-lookup"><span data-stu-id="edd93-346">[Choose a Language When Creating a Full-Text Index](../search/choose-a-language-when-creating-a-full-text-index.md) </span></span>  
 <span data-ttu-id="edd93-347">[sys.fn_helpcollations (Transact-SQL)](https://msdn.microsoft.com/library/ms187963(SQL.130).aspx)</span><span class="sxs-lookup"><span data-stu-id="edd93-347">[sys.fn_helpcollations (Transact-SQL)](https://msdn.microsoft.com/library/ms187963(SQL.130).aspx)</span></span>  
  
  
