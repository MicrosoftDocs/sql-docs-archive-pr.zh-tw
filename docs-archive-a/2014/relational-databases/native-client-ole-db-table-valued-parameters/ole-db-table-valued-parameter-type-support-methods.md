---
title: OLE DB 資料表值參數類型支援 (方法) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (OLE DB), API support (methods)
ms.assetid: e3c2a450-8fd4-44cb-93d8-affe1b65c68e
author: rothja
ms.author: jroth
ms.openlocfilehash: 8c7ca5946228ea05708984fb89ebc603061d983d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87594029"
---
# <a name="ole-db-table-valued-parameter-type-support-methods"></a><span data-ttu-id="f666a-102">OLE DB 資料表值參數類型支援 (方法)</span><span class="sxs-lookup"><span data-stu-id="f666a-102">OLE DB Table-Valued Parameter Type Support (Methods)</span></span>
  <span data-ttu-id="f666a-103">下列標準 OLE DB 方法支援資料表值參數：</span><span class="sxs-lookup"><span data-stu-id="f666a-103">The following standard OLE DB methods support table-valued parameters:</span></span>  
  
|<span data-ttu-id="f666a-104">方法</span><span class="sxs-lookup"><span data-stu-id="f666a-104">Method</span></span>|<span data-ttu-id="f666a-105">資料表值參數支援</span><span class="sxs-lookup"><span data-stu-id="f666a-105">Table-valued parameter support</span></span>|  
|------------|-------------------------------------|  
|<span data-ttu-id="f666a-106">ITableDefinitionWithConstraints::CreateTableWithConstraints</span><span class="sxs-lookup"><span data-stu-id="f666a-106">ITableDefinitionWithConstraints::CreateTableWithConstraints</span></span>|<span data-ttu-id="f666a-107">當您知道資料表值參數的類型資訊，而且想要根據類型資訊來具現化資料表值參數資料列集物件時使用。</span><span class="sxs-lookup"><span data-stu-id="f666a-107">Used when you know type information of table-valued parameter, and want to instantiate a table-valued parameter rowset object based on the type-information.</span></span><br /><br /> <span data-ttu-id="f666a-108">如需詳細資訊，請參閱[資料表值參數資料列集建立](table-valued-parameter-rowset-creation.md)中的「靜態情節」。</span><span class="sxs-lookup"><span data-stu-id="f666a-108">For more information, see "Static Scenario" in [Table-Valued Parameter Rowset Creation](table-valued-parameter-rowset-creation.md).</span></span>|  
|<span data-ttu-id="f666a-109">IOpenRowset::OpenRowset</span><span class="sxs-lookup"><span data-stu-id="f666a-109">IOpenRowset::OpenRowset</span></span>|<span data-ttu-id="f666a-110">當您不知道資料表值參數的類型資訊，而且想要根據從伺服器擷取的中繼資料資訊來具現化資料表值參數資料列集物件時使用。</span><span class="sxs-lookup"><span data-stu-id="f666a-110">Used when you do not know the type information of a table-valued parameter, and want to instantiate a table-valued parameter rowset object based on metadata information retrieved from the server.</span></span><br /><br /> <span data-ttu-id="f666a-111">如需詳細資訊，請參閱[資料表值參數資料列集建立](table-valued-parameter-rowset-creation.md)中的「動態情節」。</span><span class="sxs-lookup"><span data-stu-id="f666a-111">For more information, see "Dynamic Scenario" in [Table-Valued Parameter Rowset Creation](table-valued-parameter-rowset-creation.md).</span></span>|  
|<span data-ttu-id="f666a-112">ISSCommandWithParameters::SetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="f666a-112">ISSCommandWithParameters::SetParameterInfo</span></span>|<span data-ttu-id="f666a-113">若要指定資料表值參數命令參數，取用者會在 DBPARAMBINDINFO 結構的 *pwszName* 成員中將此參數的類型指定為 "table" 或 "DBTYPE_TABLE"。</span><span class="sxs-lookup"><span data-stu-id="f666a-113">To specify a table-valued parameter command parameter, the consumer specifies the type of the parameter as "table" or "DBTYPE_TABLE" in the *pwszName* member of DBPARAMBINDINFO structure.</span></span> <span data-ttu-id="f666a-114">*ulParamSize* 設定為 ~0。</span><span class="sxs-lookup"><span data-stu-id="f666a-114">The *ulParamSize* is set to ~0.</span></span> <span data-ttu-id="f666a-115">如需詳細資訊，請參閱[執行包含資料表值參數的命令](executing-commands-containing-table-valued-parameters.md)中的「資料表值參數規格」。</span><span class="sxs-lookup"><span data-stu-id="f666a-115">For more information, see "Table-Valued Parameter Specification" in [Executing Commands Containing Table-Valued Parameters](executing-commands-containing-table-valued-parameters.md).</span></span>|  
|<span data-ttu-id="f666a-116">ISSCommandWithParameters::SetParameterProperties</span><span class="sxs-lookup"><span data-stu-id="f666a-116">ISSCommandWithParameters::SetParameterProperties</span></span>|<span data-ttu-id="f666a-117">會設定資料表值參數所特有的屬性，例如結構描述名稱、類型名稱、資料行順序和預設資料行。</span><span class="sxs-lookup"><span data-stu-id="f666a-117">Sets properties specific to table-valued parameters, such as schema name, type name, column order, and default columns.</span></span><br /><br /> <span data-ttu-id="f666a-118">取用者會在 SSPARAMPROPS 結構的 *iOrdinal* 中指定參數的序數。</span><span class="sxs-lookup"><span data-stu-id="f666a-118">The consumer specifies the ordinal of the parameter in the *iOrdinal* of the SSPARAMPROPS structure.</span></span> <span data-ttu-id="f666a-119">所要求的屬性集為 DBPROPSET_SQLSERVERPARAMETER。</span><span class="sxs-lookup"><span data-stu-id="f666a-119">The property set requested is DBPROPSET_SQLSERVERPARAMETER.</span></span>|  
|<span data-ttu-id="f666a-120">ISSCommandWithParameters::GetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="f666a-120">ISSCommandWithParameters::GetParameterInfo</span></span>|<span data-ttu-id="f666a-121">取得指定之命令的所有參數類型。</span><span class="sxs-lookup"><span data-stu-id="f666a-121">Gets the types of all the parameters to a specified command.</span></span><br /><br /> <span data-ttu-id="f666a-122">如果是資料表值參數，DBPARAMINFO 結構中的 *wType* 欄位將會具有 DBTYPE_TABLE 類型。</span><span class="sxs-lookup"><span data-stu-id="f666a-122">For table-valued parameters, the *wType* field in DBPARAMINFO structure will have type DBTYPE_TABLE.</span></span> <span data-ttu-id="f666a-123">*ulParamSize* 欄位將會設定為 ~0，表示長度未知。</span><span class="sxs-lookup"><span data-stu-id="f666a-123">The *ulParamSize* field will be set to ~0 to indicate unknown length.</span></span>|  
|<span data-ttu-id="f666a-124">ISSCommandWithParameters::GetParameterProperties</span><span class="sxs-lookup"><span data-stu-id="f666a-124">ISSCommandWithParameters::GetParameterProperties</span></span>|<span data-ttu-id="f666a-125">取得 DBTYPE_TABLE 類型之參數的其他類型資訊。</span><span class="sxs-lookup"><span data-stu-id="f666a-125">Gets additional type information for parameters of the DBTYPE_TABLE type.</span></span><br /><br /> <span data-ttu-id="f666a-126">取用者會在 SSPARAMPROPS 結構的 *iOrdinal* 成員中指定參數的序數。</span><span class="sxs-lookup"><span data-stu-id="f666a-126">The consumer specifies the ordinal of the parameter in the *iOrdinal* member of the SSPARAMPROPS structure.</span></span> <span data-ttu-id="f666a-127">取用者可以在 DBPROPSET_SQLSERVERPARAMETER 屬性集中要求列在 ISSCommandWithParameters::SetParameterProperties 底下的任何屬性。</span><span class="sxs-lookup"><span data-stu-id="f666a-127">The consumer can request any of the properties in the DBPROPSET_SQLSERVERPARAMETER property set that are listed under ISSCommandWithParameters::SetParameterProperties.</span></span><br /><br /> <span data-ttu-id="f666a-128">因為取用者不知道資料表值參數類型，所以提供者必須將 SSPROP_PARAM_TYPE_TYPENAME、SSPROP_PARAM_TYPE_SCHEMANAME 和 SSPROP_PARAM_TYPE_CATALOGNAME 設定為正確的值。</span><span class="sxs-lookup"><span data-stu-id="f666a-128">Because the consumer does not know the table-valued parameter type, the provider must set the SSPROP_PARAM_TYPE_TYPENAME, SSPROP_PARAM_TYPE_SCHEMANAME, and SSPROP_PARAM_TYPE_CATALOGNAME to their correct values.</span></span> <span data-ttu-id="f666a-129">其餘的 SSPROP_PARAM_TABLE_DEFAULT_COLUMNS 和 SSPROP_PARAM_TABLE_COLUMN_SORT_ORDER 屬性將會有預設值。</span><span class="sxs-lookup"><span data-stu-id="f666a-129">The remaining properties, SSPROP_PARAM_TABLE_DEFAULT_COLUMNS and SSPROP_PARAM_TABLE_COLUMN_SORT_ORDER, will have their default values.</span></span> <span data-ttu-id="f666a-130">當取用者已經探索出資料表值參數類型名稱時，它會使用 IOpenRowset::OpenRowset 來建立這個資料表值參數的執行個體，並指定資料表值參數類型的名稱。</span><span class="sxs-lookup"><span data-stu-id="f666a-130">After the consumer has discovered the table-valued parameter type name, it uses IOpenRowset::OpenRowset to create an instance of this table-valued parameter, specifying the name of table-valued parameter type.</span></span> <span data-ttu-id="f666a-131">如需詳細資訊，請參閱[資料表值參數類型探索](../../database-engine/dev-guide/table-valued-parameter-type-discovery.md)。</span><span class="sxs-lookup"><span data-stu-id="f666a-131">For more information, see [Table-Valued Parameter Type Discovery](../../database-engine/dev-guide/table-valued-parameter-type-discovery.md).</span></span>|  
|<span data-ttu-id="f666a-132">IRowsetInfo::GetProperties</span><span class="sxs-lookup"><span data-stu-id="f666a-132">IRowsetInfo::GetProperties</span></span>|<span data-ttu-id="f666a-133">取得資料表值參數資料列集屬性。</span><span class="sxs-lookup"><span data-stu-id="f666a-133">Gets table-valued parameter rowset properties.</span></span> <span data-ttu-id="f666a-134">取用者可以使用這些屬性，以最佳方式設定繫結。</span><span class="sxs-lookup"><span data-stu-id="f666a-134">The consumer can use these properties to optimally set up bindings.</span></span>|  
|<span data-ttu-id="f666a-135">IColumnsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="f666a-135">IColumnsRowset::GetColumnsRowset</span></span>|<span data-ttu-id="f666a-136">擷取有關 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資料表的中繼資料資訊。</span><span class="sxs-lookup"><span data-stu-id="f666a-136">Retrieves metadata information about a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="f666a-137">如果是資料表值參數，這個相同介面會提供有關每一個資料行的詳細中繼資料資訊，如下所示：</span><span class="sxs-lookup"><span data-stu-id="f666a-137">For table-valued parameters, this same interface provides detailed metadata information about each column, such as the following:</span></span><br /><br /> <span data-ttu-id="f666a-138">-DBCOLUMN_FLAGS 表示透過 DBCOLUMNFLAGS_ISNullABLE 位的 null 屬性。</span><span class="sxs-lookup"><span data-stu-id="f666a-138">-   DBCOLUMN_FLAGS indicates nullability through the DBCOLUMNFLAGS_ISNULLABLE bit.</span></span><br /><span data-ttu-id="f666a-139">-DBCOLUMN_ISUNIQUE 指出資料行是否為識別欄位。</span><span class="sxs-lookup"><span data-stu-id="f666a-139">-   DBCOLUMN_ISUNIQUE indicates whether the column is an identity column.</span></span><br /><span data-ttu-id="f666a-140">-DBCOLUMN_COMPUTEMODE 指出是否計算資料行。</span><span class="sxs-lookup"><span data-stu-id="f666a-140">-   DBCOLUMN_COMPUTEMODE indicates whether the column is computed.</span></span>|  
|<span data-ttu-id="f666a-141">IAccessor::CreateAccessor</span><span class="sxs-lookup"><span data-stu-id="f666a-141">IAccessor::CreateAccessor</span></span>|<span data-ttu-id="f666a-142">若要將資料表值參數資料列集物件繫結到命令參數，當您建立存取子時，請將它的 *wType* 成員設定為 DBTYPE_TABLE。</span><span class="sxs-lookup"><span data-stu-id="f666a-142">To bind a table-valued parameter rowset object to a command parameter, you create an accessor with its *wType* member set to DBTYPE_TABLE.</span></span> <span data-ttu-id="f666a-143">DBOBJECT 結構將會包含 IID_IRowset 或是 *iid* 成員中任何其他有效的資料列集物件介面。</span><span class="sxs-lookup"><span data-stu-id="f666a-143">The DBOBJECT structure will contain IID_IRowset or any other valid rowset object interface in the *iid* member.</span></span> <span data-ttu-id="f666a-144">其餘欄位的處理方式類似於 DBTYPE_IUNKNOWN。</span><span class="sxs-lookup"><span data-stu-id="f666a-144">The rest of the fields are treated similarly to DBTYPE_IUNKNOWN.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="f666a-145">另請參閱</span><span class="sxs-lookup"><span data-stu-id="f666a-145">See Also</span></span>  
 <span data-ttu-id="f666a-146">[OLE DB 資料表值參數類型支援](ole-db-table-valued-parameter-type-support.md) </span><span class="sxs-lookup"><span data-stu-id="f666a-146">[OLE DB Table-Valued Parameter Type Support](ole-db-table-valued-parameter-type-support.md) </span></span>  
 <span data-ttu-id="f666a-147">[資料表值參數資料列集建立](table-valued-parameter-rowset-creation.md) </span><span class="sxs-lookup"><span data-stu-id="f666a-147">[Table-Valued Parameter Rowset Creation](table-valued-parameter-rowset-creation.md) </span></span>  
 [<span data-ttu-id="f666a-148">使用資料表值參數 &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="f666a-148">Use Table-Valued Parameters &#40;OLE DB&#41;</span></span>](table-valued-parameters-ole-db.md)  
  
  
