---
title: 參數和資料列集中繼資料 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: reference
helpviewer_keywords:
- metadata [OLE DB]
ms.assetid: 31b318a4-20e7-4db0-b367-eb9938859029
author: rothja
ms.author: jroth
ms.openlocfilehash: f3bddb4d83a8904b3def70853fe1e6614dd48d9c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87698140"
---
# <a name="parameter-and-rowset-metadata"></a><span data-ttu-id="145a5-102">參數和資料列集中繼資料</span><span class="sxs-lookup"><span data-stu-id="145a5-102">Parameter and Rowset Metadata</span></span>
  <span data-ttu-id="145a5-103">本主題提供有關下列與 OLE DB 日期和時間增強功能相關之類型和類型成員的資訊。</span><span class="sxs-lookup"><span data-stu-id="145a5-103">This topic provides information about the following type and type members, related to the OLE DB date and time enhancements.</span></span>  
  
-   <span data-ttu-id="145a5-104">DBBINDING 結構</span><span class="sxs-lookup"><span data-stu-id="145a5-104">DBBINDING structure</span></span>  
  
-   `ICommandWithParameters::GetParameterInfo`  
  
-   `ICommandWithParameters::SetParameterInfo`  
  
-   `IColumnsRowset::GetColumnsRowset`  
  
-   `IColumnsInfo::GetColumnInfo`  
  
## <a name="icommandwithparametersgetparameterinfo"></a><span data-ttu-id="145a5-105">ICommandWithParameters::GetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="145a5-105">ICommandWithParameters::GetParameterInfo</span></span>  
 <span data-ttu-id="145a5-106">下列資訊會以 DBPARAMINFO 結構透過 *prgParamInfo* 傳回：</span><span class="sxs-lookup"><span data-stu-id="145a5-106">The following information is returned in the DBPARAMINFO structure through *prgParamInfo*:</span></span>  
  
|<span data-ttu-id="145a5-107">參數類型</span><span class="sxs-lookup"><span data-stu-id="145a5-107">Parameter Type</span></span>|<span data-ttu-id="145a5-108">*wType*</span><span class="sxs-lookup"><span data-stu-id="145a5-108">*wType*</span></span>|<span data-ttu-id="145a5-109">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="145a5-109">*ulParamSize*</span></span>|<span data-ttu-id="145a5-110">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="145a5-110">*bPrecision*</span></span>|<span data-ttu-id="145a5-111">*bScale*</span><span class="sxs-lookup"><span data-stu-id="145a5-111">*bScale*</span></span>|<span data-ttu-id="145a5-112">*dwFlags*</span><span class="sxs-lookup"><span data-stu-id="145a5-112">*dwFlags*</span></span><br /><br /> <span data-ttu-id="145a5-113">DBPARAMFLAGS_SS_ISVARIABLESCALE</span><span class="sxs-lookup"><span data-stu-id="145a5-113">DBPARAMFLAGS_SS_ISVARIABLESCALE</span></span>|  
|--------------------|-------------|-------------------|------------------|--------------|-----------------------------------------------------|  
|<span data-ttu-id="145a5-114">date</span><span class="sxs-lookup"><span data-stu-id="145a5-114">date</span></span>|<span data-ttu-id="145a5-115">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="145a5-115">DBTYPE_DBDATE</span></span>|<span data-ttu-id="145a5-116">6</span><span class="sxs-lookup"><span data-stu-id="145a5-116">6</span></span>|<span data-ttu-id="145a5-117">10</span><span class="sxs-lookup"><span data-stu-id="145a5-117">10</span></span>|<span data-ttu-id="145a5-118">0</span><span class="sxs-lookup"><span data-stu-id="145a5-118">0</span></span>|<span data-ttu-id="145a5-119">清除</span><span class="sxs-lookup"><span data-stu-id="145a5-119">Clear</span></span>|  
|<span data-ttu-id="145a5-120">time</span><span class="sxs-lookup"><span data-stu-id="145a5-120">time</span></span>|<span data-ttu-id="145a5-121">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="145a5-121">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="145a5-122">10</span><span class="sxs-lookup"><span data-stu-id="145a5-122">10</span></span>|<span data-ttu-id="145a5-123">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="145a5-123">8, 10..16</span></span>|<span data-ttu-id="145a5-124">0..7</span><span class="sxs-lookup"><span data-stu-id="145a5-124">0..7</span></span>|<span data-ttu-id="145a5-125">設定</span><span class="sxs-lookup"><span data-stu-id="145a5-125">Set</span></span>|  
|<span data-ttu-id="145a5-126">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="145a5-126">smalldatetime</span></span>|<span data-ttu-id="145a5-127">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="145a5-127">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="145a5-128">16</span><span class="sxs-lookup"><span data-stu-id="145a5-128">16</span></span>|<span data-ttu-id="145a5-129">16</span><span class="sxs-lookup"><span data-stu-id="145a5-129">16</span></span>|<span data-ttu-id="145a5-130">0</span><span class="sxs-lookup"><span data-stu-id="145a5-130">0</span></span>|<span data-ttu-id="145a5-131">清除</span><span class="sxs-lookup"><span data-stu-id="145a5-131">Clear</span></span>|  
|<span data-ttu-id="145a5-132">Datetime</span><span class="sxs-lookup"><span data-stu-id="145a5-132">datetime</span></span>|<span data-ttu-id="145a5-133">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="145a5-133">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="145a5-134">16</span><span class="sxs-lookup"><span data-stu-id="145a5-134">16</span></span>|<span data-ttu-id="145a5-135">23</span><span class="sxs-lookup"><span data-stu-id="145a5-135">23</span></span>|<span data-ttu-id="145a5-136">3</span><span class="sxs-lookup"><span data-stu-id="145a5-136">3</span></span>|<span data-ttu-id="145a5-137">清除</span><span class="sxs-lookup"><span data-stu-id="145a5-137">Clear</span></span>|  
|<span data-ttu-id="145a5-138">datetime2</span><span class="sxs-lookup"><span data-stu-id="145a5-138">datetime2</span></span>|<span data-ttu-id="145a5-139">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="145a5-139">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="145a5-140">16</span><span class="sxs-lookup"><span data-stu-id="145a5-140">16</span></span>|<span data-ttu-id="145a5-141">19，21. 27</span><span class="sxs-lookup"><span data-stu-id="145a5-141">19,21..27</span></span>|<span data-ttu-id="145a5-142">0..7</span><span class="sxs-lookup"><span data-stu-id="145a5-142">0..7</span></span>|<span data-ttu-id="145a5-143">設定</span><span class="sxs-lookup"><span data-stu-id="145a5-143">Set</span></span>|  
|<span data-ttu-id="145a5-144">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="145a5-144">datetimeoffset</span></span>|<span data-ttu-id="145a5-145">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="145a5-145">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="145a5-146">20</span><span class="sxs-lookup"><span data-stu-id="145a5-146">20</span></span>|<span data-ttu-id="145a5-147">26，28. 34</span><span class="sxs-lookup"><span data-stu-id="145a5-147">26,28..34</span></span>|<span data-ttu-id="145a5-148">0..7</span><span class="sxs-lookup"><span data-stu-id="145a5-148">0..7</span></span>|<span data-ttu-id="145a5-149">設定</span><span class="sxs-lookup"><span data-stu-id="145a5-149">Set</span></span>|  
  
 <span data-ttu-id="145a5-150">請注意，在某些情況下值的範圍並不是連續的。</span><span class="sxs-lookup"><span data-stu-id="145a5-150">Notice that in some cases value ranges are not continuous.</span></span> <span data-ttu-id="145a5-151">這是當小數有效位數大於零時增加的小數點所導致。</span><span class="sxs-lookup"><span data-stu-id="145a5-151">This is due to the addition of a decimal point when fractional precision is greater than zero.</span></span>  
  
 <span data-ttu-id="145a5-152">只有連接到 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (或更新版本) 伺服器時，DBPARAMFLAGS_SS_ISVARIABLESCALE 才有效。</span><span class="sxs-lookup"><span data-stu-id="145a5-152">DBPARAMFLAGS_SS_ISVARIABLESCALE is only valid when connected to a [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later) server.</span></span> <span data-ttu-id="145a5-153">連接到下層伺服器時，永遠不會設定 DBPARAMFLAGS_SS_ISVARIABLESCALE。</span><span class="sxs-lookup"><span data-stu-id="145a5-153">DBPARAMFLAGS_SS_ISVARIABLESCALE is never set when connected to down-level servers.</span></span>  
  
## <a name="icommandwithparameterssetparameterinfo-and-implied-parameter-types"></a><span data-ttu-id="145a5-154">ICommandWithParameters::SetParameterInfo 和隱含參數類型</span><span class="sxs-lookup"><span data-stu-id="145a5-154">ICommandWithParameters::SetParameterInfo and Implied Parameter Types</span></span>  
 <span data-ttu-id="145a5-155">以 DBPARAMBINDINFO 結構所提供的資訊必須與下列相符：</span><span class="sxs-lookup"><span data-stu-id="145a5-155">The information provided in the DBPARAMBINDINFO structure must conform to the following:</span></span>  
  
|<span data-ttu-id="145a5-156">*pwszDataSourceType*</span><span class="sxs-lookup"><span data-stu-id="145a5-156">*pwszDataSourceType*</span></span><br /><br /> <span data-ttu-id="145a5-157">(提供者特定)</span><span class="sxs-lookup"><span data-stu-id="145a5-157">(provider specific)</span></span>|<span data-ttu-id="145a5-158">*pwszDataSourceType*</span><span class="sxs-lookup"><span data-stu-id="145a5-158">*pwszDataSourceType*</span></span><br /><br /> <span data-ttu-id="145a5-159">(OLE DB 一般)</span><span class="sxs-lookup"><span data-stu-id="145a5-159">(OLE DB generic)</span></span>|<span data-ttu-id="145a5-160">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="145a5-160">*ulParamSize*</span></span>|<span data-ttu-id="145a5-161">*bScale*</span><span class="sxs-lookup"><span data-stu-id="145a5-161">*bScale*</span></span>|  
|----------------------------------------------------|-------------------------------------------------|-------------------|--------------|  
||<span data-ttu-id="145a5-162">DBTYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="145a5-162">DBTYPE_DATE</span></span>|<span data-ttu-id="145a5-163">6</span><span class="sxs-lookup"><span data-stu-id="145a5-163">6</span></span>|<span data-ttu-id="145a5-164">忽略</span><span class="sxs-lookup"><span data-stu-id="145a5-164">Ignored</span></span>|  
|<span data-ttu-id="145a5-165">date</span><span class="sxs-lookup"><span data-stu-id="145a5-165">date</span></span>|<span data-ttu-id="145a5-166">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="145a5-166">DBTYPE_DBDATE</span></span>|<span data-ttu-id="145a5-167">6</span><span class="sxs-lookup"><span data-stu-id="145a5-167">6</span></span>|<span data-ttu-id="145a5-168">忽略</span><span class="sxs-lookup"><span data-stu-id="145a5-168">Ignored</span></span>|  
||<span data-ttu-id="145a5-169">DBTYPE_DBTIME</span><span class="sxs-lookup"><span data-stu-id="145a5-169">DBTYPE_DBTIME</span></span>|<span data-ttu-id="145a5-170">10</span><span class="sxs-lookup"><span data-stu-id="145a5-170">10</span></span>|<span data-ttu-id="145a5-171">忽略</span><span class="sxs-lookup"><span data-stu-id="145a5-171">Ignored</span></span>|  
|<span data-ttu-id="145a5-172">time</span><span class="sxs-lookup"><span data-stu-id="145a5-172">time</span></span>|<span data-ttu-id="145a5-173">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="145a5-173">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="145a5-174">10</span><span class="sxs-lookup"><span data-stu-id="145a5-174">10</span></span>|<span data-ttu-id="145a5-175">0..7</span><span class="sxs-lookup"><span data-stu-id="145a5-175">0..7</span></span>|  
|<span data-ttu-id="145a5-176">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="145a5-176">smalldatetime</span></span>||<span data-ttu-id="145a5-177">16</span><span class="sxs-lookup"><span data-stu-id="145a5-177">16</span></span>|<span data-ttu-id="145a5-178">忽略</span><span class="sxs-lookup"><span data-stu-id="145a5-178">Ignored</span></span>|  
|<span data-ttu-id="145a5-179">Datetime</span><span class="sxs-lookup"><span data-stu-id="145a5-179">datetime</span></span>||<span data-ttu-id="145a5-180">16</span><span class="sxs-lookup"><span data-stu-id="145a5-180">16</span></span>|<span data-ttu-id="145a5-181">忽略</span><span class="sxs-lookup"><span data-stu-id="145a5-181">Ignored</span></span>|  
|<span data-ttu-id="145a5-182">datetime2 或 DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="145a5-182">datetime2 or DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="145a5-183">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="145a5-183">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="145a5-184">16</span><span class="sxs-lookup"><span data-stu-id="145a5-184">16</span></span>|<span data-ttu-id="145a5-185">0..7</span><span class="sxs-lookup"><span data-stu-id="145a5-185">0..7</span></span>|  
|<span data-ttu-id="145a5-186">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="145a5-186">datetimeoffset</span></span>|<span data-ttu-id="145a5-187">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="145a5-187">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="145a5-188">20</span><span class="sxs-lookup"><span data-stu-id="145a5-188">20</span></span>|<span data-ttu-id="145a5-189">0..7</span><span class="sxs-lookup"><span data-stu-id="145a5-189">0..7</span></span>|  
  
 <span data-ttu-id="145a5-190">已忽略 *bPrecision* 參數。</span><span class="sxs-lookup"><span data-stu-id="145a5-190">The *bPrecision* parameter is ignored.</span></span>  
  
 <span data-ttu-id="145a5-191">當傳送資料到伺服器時，"DBPARAMFLAGS_SS_ISVARIABLESCALE" 會被忽略。</span><span class="sxs-lookup"><span data-stu-id="145a5-191">"DBPARAMFLAGS_SS_ISVARIABLESCALE" is ignored when sending data to the server.</span></span> <span data-ttu-id="145a5-192">應用程式可以使用提供者特定的類型名稱 "`datetime`" 和 "`smalldatetime`" 來強制使用舊版的表格式資料流 (TDS) 類型。</span><span class="sxs-lookup"><span data-stu-id="145a5-192">Applications can force the use of legacy tabular-data stream (TDS) types by using the provider-specific type names "`datetime`" and "`smalldatetime`".</span></span> <span data-ttu-id="145a5-193">當連接到 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (或更新版本的) 伺服器時， `datetime2` 將會使用 "" 格式，而且當類型名稱為 " `datetime2` " 或 "DBTYPE_DBTIMESTAMP" 時，會發生隱含的伺服器轉換（如有必要）。</span><span class="sxs-lookup"><span data-stu-id="145a5-193">When connected to [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later) servers, "`datetime2`" format will be used and an implicit server conversion will occur, if necessary, when the type name is "`datetime2`" or "DBTYPE_DBTIMESTAMP".</span></span> <span data-ttu-id="145a5-194">*bScale*如果使用提供者特定的類型名稱 " `datetime` " 或 ""，則會忽略 bScale `smalldatetime` 。</span><span class="sxs-lookup"><span data-stu-id="145a5-194">*bScale* is ignored if the provider specific type names "`datetime`" or "`smalldatetime`" are used.</span></span> <span data-ttu-id="145a5-195">否則，html5 應用程式必須確定已正確設定*bScale* 。</span><span class="sxs-lookup"><span data-stu-id="145a5-195">Otherwise, appications must ensure that *bScale* is set correctly.</span></span> <span data-ttu-id="145a5-196">從 MDAC 升級的應用程式以及 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 使用 "DBTYPE_DBTIMESTAMP" 的 Native Client，如果未正確設定*bScale* ，將會失敗。</span><span class="sxs-lookup"><span data-stu-id="145a5-196">Applications upgraded from MDAC and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client from [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] that use "DBTYPE_DBTIMESTAMP" will fail if they do not set *bScale* correctly.</span></span> <span data-ttu-id="145a5-197">連接到 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 之前版本的伺服器執行個體時，*bScale* 值如果不是 0 或 3 且具有 "DBTYPE_DBTIMESTAMP"，便是錯誤且會傳回 E_FAIL。</span><span class="sxs-lookup"><span data-stu-id="145a5-197">When connected to server instances earlier than [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], a *bScale* value other than 0 or 3 with "DBTYPE_DBTIMESTAMP" is an error and E_FAIL will be returned.</span></span>  
  
 <span data-ttu-id="145a5-198">未呼叫 ICommandWithParameters：： SetParameterInfo 時，提供者會依照 IAccessor：： CreateAccessor 中的指定，從系結類型推斷伺服器類型，如下所示：</span><span class="sxs-lookup"><span data-stu-id="145a5-198">When ICommandWithParameters::SetParameterInfo is not called, the provider imples the server type from the binding type as specified in IAccessor::CreateAccessor as follows:</span></span>  
  
|<span data-ttu-id="145a5-199">繫結類型</span><span class="sxs-lookup"><span data-stu-id="145a5-199">Binding Type</span></span>|<span data-ttu-id="145a5-200">*pwszDataSourceType*</span><span class="sxs-lookup"><span data-stu-id="145a5-200">*pwszDataSourceType*</span></span><br /><br /> <span data-ttu-id="145a5-201">(提供者特定)</span><span class="sxs-lookup"><span data-stu-id="145a5-201">(provider specific)</span></span>|  
|------------------|----------------------------------------------------|  
|<span data-ttu-id="145a5-202">DBTYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="145a5-202">DBTYPE_DATE</span></span>|<span data-ttu-id="145a5-203">datetime2(0)</span><span class="sxs-lookup"><span data-stu-id="145a5-203">datetime2(0)</span></span>|  
|<span data-ttu-id="145a5-204">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="145a5-204">DBTYPE_DBDATE</span></span>|<span data-ttu-id="145a5-205">date</span><span class="sxs-lookup"><span data-stu-id="145a5-205">date</span></span>|  
|<span data-ttu-id="145a5-206">DBTYPE_DBTIME</span><span class="sxs-lookup"><span data-stu-id="145a5-206">DBTYPE_DBTIME</span></span>|<span data-ttu-id="145a5-207">time(0)</span><span class="sxs-lookup"><span data-stu-id="145a5-207">time(0)</span></span>|  
|<span data-ttu-id="145a5-208">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="145a5-208">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="145a5-209">time(7)</span><span class="sxs-lookup"><span data-stu-id="145a5-209">time(7)</span></span>|  
|<span data-ttu-id="145a5-210">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="145a5-210">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="145a5-211">datetime2(7)</span><span class="sxs-lookup"><span data-stu-id="145a5-211">datetime2(7)</span></span>|  
|<span data-ttu-id="145a5-212">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="145a5-212">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="145a5-213">datetimeoffset(7)</span><span class="sxs-lookup"><span data-stu-id="145a5-213">datetimeoffset(7)</span></span>|  
  
## <a name="icolumnsrowsetgetcolumnsrowset"></a><span data-ttu-id="145a5-214">IColumnsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="145a5-214">IColumnsRowset::GetColumnsRowset</span></span>  
 <span data-ttu-id="145a5-215">`IColumnsRowset::GetColumnsRowset` 傳回下列資料行：</span><span class="sxs-lookup"><span data-stu-id="145a5-215">`IColumnsRowset::GetColumnsRowset` returns the following columns:</span></span>  
  
|<span data-ttu-id="145a5-216">資料行類型</span><span class="sxs-lookup"><span data-stu-id="145a5-216">Column Type</span></span>|<span data-ttu-id="145a5-217">DBCOLUMN_TYPE</span><span class="sxs-lookup"><span data-stu-id="145a5-217">DBCOLUMN_TYPE</span></span>|<span data-ttu-id="145a5-218">DBCOLUM_COLUMNSIZE</span><span class="sxs-lookup"><span data-stu-id="145a5-218">DBCOLUM_COLUMNSIZE</span></span>|<span data-ttu-id="145a5-219">DBCOLUMN_PRECISION</span><span class="sxs-lookup"><span data-stu-id="145a5-219">DBCOLUMN_PRECISION</span></span>|<span data-ttu-id="145a5-220">DBCOLUMN_SCALE、DBCOLUMN_DATETIMEPRECISION</span><span class="sxs-lookup"><span data-stu-id="145a5-220">DBCOLUMN_SCALE, DBCOLUMN_DATETIMEPRECISION</span></span>|<span data-ttu-id="145a5-221">DBCOLUMN_FLAGS, DBCOLUMNFLAGS_SS_ISVARIABLESCALE</span><span class="sxs-lookup"><span data-stu-id="145a5-221">DBCOLUMN_FLAGS, DBCOLUMNFLAGS_SS_ISVARIABLESCALE</span></span>|  
|-----------------|--------------------|-------------------------|-------------------------|--------------------------------------------------|---------------------------------------------------------|  
|<span data-ttu-id="145a5-222">date</span><span class="sxs-lookup"><span data-stu-id="145a5-222">date</span></span>|<span data-ttu-id="145a5-223">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="145a5-223">DBTYPE_DBDATE</span></span>|<span data-ttu-id="145a5-224">6</span><span class="sxs-lookup"><span data-stu-id="145a5-224">6</span></span>|<span data-ttu-id="145a5-225">10</span><span class="sxs-lookup"><span data-stu-id="145a5-225">10</span></span>|<span data-ttu-id="145a5-226">0</span><span class="sxs-lookup"><span data-stu-id="145a5-226">0</span></span>|<span data-ttu-id="145a5-227">清除</span><span class="sxs-lookup"><span data-stu-id="145a5-227">Clear</span></span>|  
|<span data-ttu-id="145a5-228">time</span><span class="sxs-lookup"><span data-stu-id="145a5-228">time</span></span>|<span data-ttu-id="145a5-229">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="145a5-229">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="145a5-230">10</span><span class="sxs-lookup"><span data-stu-id="145a5-230">10</span></span>|<span data-ttu-id="145a5-231">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="145a5-231">8, 10..16</span></span>|<span data-ttu-id="145a5-232">0..7</span><span class="sxs-lookup"><span data-stu-id="145a5-232">0..7</span></span>|<span data-ttu-id="145a5-233">設定</span><span class="sxs-lookup"><span data-stu-id="145a5-233">Set</span></span>|  
|<span data-ttu-id="145a5-234">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="145a5-234">smalldatetime</span></span>|<span data-ttu-id="145a5-235">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="145a5-235">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="145a5-236">16</span><span class="sxs-lookup"><span data-stu-id="145a5-236">16</span></span>|<span data-ttu-id="145a5-237">16</span><span class="sxs-lookup"><span data-stu-id="145a5-237">16</span></span>|<span data-ttu-id="145a5-238">0</span><span class="sxs-lookup"><span data-stu-id="145a5-238">0</span></span>|<span data-ttu-id="145a5-239">清除</span><span class="sxs-lookup"><span data-stu-id="145a5-239">Clear</span></span>|  
|<span data-ttu-id="145a5-240">Datetime</span><span class="sxs-lookup"><span data-stu-id="145a5-240">datetime</span></span>|<span data-ttu-id="145a5-241">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="145a5-241">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="145a5-242">16</span><span class="sxs-lookup"><span data-stu-id="145a5-242">16</span></span>|<span data-ttu-id="145a5-243">23</span><span class="sxs-lookup"><span data-stu-id="145a5-243">23</span></span>|<span data-ttu-id="145a5-244">3</span><span class="sxs-lookup"><span data-stu-id="145a5-244">3</span></span>|<span data-ttu-id="145a5-245">清除</span><span class="sxs-lookup"><span data-stu-id="145a5-245">Clear</span></span>|  
|<span data-ttu-id="145a5-246">datetime2</span><span class="sxs-lookup"><span data-stu-id="145a5-246">datetime2</span></span>|<span data-ttu-id="145a5-247">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="145a5-247">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="145a5-248">16</span><span class="sxs-lookup"><span data-stu-id="145a5-248">16</span></span>|<span data-ttu-id="145a5-249">19, 21..27</span><span class="sxs-lookup"><span data-stu-id="145a5-249">19, 21..27</span></span>|<span data-ttu-id="145a5-250">0..7</span><span class="sxs-lookup"><span data-stu-id="145a5-250">0..7</span></span>|<span data-ttu-id="145a5-251">設定</span><span class="sxs-lookup"><span data-stu-id="145a5-251">Set</span></span>|  
|<span data-ttu-id="145a5-252">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="145a5-252">datetimeoffset</span></span>|<span data-ttu-id="145a5-253">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="145a5-253">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="145a5-254">20</span><span class="sxs-lookup"><span data-stu-id="145a5-254">20</span></span>|<span data-ttu-id="145a5-255">26, 28..34</span><span class="sxs-lookup"><span data-stu-id="145a5-255">26, 28..34</span></span>|<span data-ttu-id="145a5-256">0..7</span><span class="sxs-lookup"><span data-stu-id="145a5-256">0..7</span></span>|<span data-ttu-id="145a5-257">設定</span><span class="sxs-lookup"><span data-stu-id="145a5-257">Set</span></span>|  
  
 <span data-ttu-id="145a5-258">在 DBCOLUMN_FLAGS 中，DBCOLUMNFLAGS_ISFIXEDLENGTH 對 date/time 類型永遠為 true，而且下列旗標永遠為 false：</span><span class="sxs-lookup"><span data-stu-id="145a5-258">In DBCOLUMN_FLAGS, DBCOLUMNFLAGS_ISFIXEDLENGTH is always true for date/time types and the following flags are always false:</span></span>  
  
-   <span data-ttu-id="145a5-259">DBCOLUMNFLAGS_CACHEDEFERRED</span><span class="sxs-lookup"><span data-stu-id="145a5-259">DBCOLUMNFLAGS_CACHEDEFERRED</span></span>  
  
-   <span data-ttu-id="145a5-260">DBCOLUMNFLAGS_ISBOOKMARK</span><span class="sxs-lookup"><span data-stu-id="145a5-260">DBCOLUMNFLAGS_ISBOOKMARK</span></span>  
  
-   <span data-ttu-id="145a5-261">DBCOLUMNFLAGS_ISCHAPTER</span><span class="sxs-lookup"><span data-stu-id="145a5-261">DBCOLUMNFLAGS_ISCHAPTER</span></span>  
  
-   <span data-ttu-id="145a5-262">DBCOLUMNFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="145a5-262">DBCOLUMNFLAGS_ISLONG</span></span>  
  
-   <span data-ttu-id="145a5-263">DBCOLUMNFLAGS_ISROWID</span><span class="sxs-lookup"><span data-stu-id="145a5-263">DBCOLUMNFLAGS_ISROWID</span></span>  
  
-   <span data-ttu-id="145a5-264">DBCOLUMNFLAGS_ISROWVER</span><span class="sxs-lookup"><span data-stu-id="145a5-264">DBCOLUMNFLAGS_ISROWVER</span></span>  
  
-   <span data-ttu-id="145a5-265">DBCOLUMNFLAGS_MAYDEFER</span><span class="sxs-lookup"><span data-stu-id="145a5-265">DBCOLUMNFLAGS_MAYDEFER</span></span>  
  
 <span data-ttu-id="145a5-266">剩餘的旗標 (DBCOLUMNFLAGS_ISNULLABLE、DBCOLUMNFLAGS_MAYBENULL、DBCOLUMNFLAGS_WRITE 和 DBCOLUMNFLAGS_WRITEUNKNOWN) 可以根據資料行的定義方式以及實際的查詢來設定。</span><span class="sxs-lookup"><span data-stu-id="145a5-266">The remaining flags (DBCOLUMNFLAGS_ISNULLABLE, DBCOLUMNFLAGS_MAYBENULL, DBCOLUMNFLAGS_WRITE, and DBCOLUMNFLAGS_WRITEUNKNOWN) can be set, depending on how the column is defined and the actual query.</span></span>  
  
 <span data-ttu-id="145a5-267">在 DBCOLUMN_FLAGS 中會提供新旗標 DBCOLUMNFLAGS_SS_ISVARIABLESCALE，以允許應用程式判斷資料行的伺服器類型，其中 DBCOLUMN_TYPE 是 DBTYPE_DBTIMESTAMP。</span><span class="sxs-lookup"><span data-stu-id="145a5-267">A new flag DBCOLUMNFLAGS_SS_ISVARIABLESCALE is provided in DBCOLUMN_FLAGS to allow an application to determine the server type of columns, where DBCOLUMN_TYPE is DBTYPE_DBTIMESTAMP.</span></span> <span data-ttu-id="145a5-268">DBCOLUMN_SCALE 或 DBCOLUMN_DATETIMEPRECISION 也必須用來識別伺服器類型。</span><span class="sxs-lookup"><span data-stu-id="145a5-268">DBCOLUMN_SCALE or DBCOLUMN_DATETIMEPRECISION must also be used to identify the server type.</span></span>  
  
 <span data-ttu-id="145a5-269">只有連接到 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (或更新版本) 伺服器時，DBCOLUMNFLAGS_SS_ISVARIABLESCALE 才有效。</span><span class="sxs-lookup"><span data-stu-id="145a5-269">DBCOLUMNFLAGS_SS_ISVARIABLESCALE is only valid when connected to a [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later) server.</span></span> <span data-ttu-id="145a5-270">連接到下層伺服器時，不會定義 DBCOLUMNFLAGS_SS_ISVARIABLESCALE。</span><span class="sxs-lookup"><span data-stu-id="145a5-270">DBCOLUMNFLAGS_SS_ISVARIABLESCALE is undefined when connected to down-level servers.</span></span>  
  
## <a name="icolumnsinfogetcolumninfo"></a><span data-ttu-id="145a5-271">IColumnsInfo::GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="145a5-271">IColumnsInfo::GetColumnInfo</span></span>  
 <span data-ttu-id="145a5-272">DBCOLUMNINFO 結構會傳回下列資訊：</span><span class="sxs-lookup"><span data-stu-id="145a5-272">DBCOLUMNINFO structure returns the following information:</span></span>  
  
|<span data-ttu-id="145a5-273">參數類型</span><span class="sxs-lookup"><span data-stu-id="145a5-273">Parameter Type</span></span>|<span data-ttu-id="145a5-274">*wType*</span><span class="sxs-lookup"><span data-stu-id="145a5-274">*wType*</span></span>|<span data-ttu-id="145a5-275">*ulColumnSize*</span><span class="sxs-lookup"><span data-stu-id="145a5-275">*ulColumnSize*</span></span>|<span data-ttu-id="145a5-276">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="145a5-276">*bPrecision*</span></span>|<span data-ttu-id="145a5-277">*bScale*</span><span class="sxs-lookup"><span data-stu-id="145a5-277">*bScale*</span></span>|<span data-ttu-id="145a5-278">*dwFlags*</span><span class="sxs-lookup"><span data-stu-id="145a5-278">*dwFlags*</span></span><br /><br /> <span data-ttu-id="145a5-279">DBPARAMFLAGS_SS_ISVARIABLESCALE</span><span class="sxs-lookup"><span data-stu-id="145a5-279">DBPARAMFLAGS_SS_ISVARIABLESCALE</span></span>|  
|--------------------|-------------|--------------------|------------------|--------------|-----------------------------------------------------|  
|<span data-ttu-id="145a5-280">date</span><span class="sxs-lookup"><span data-stu-id="145a5-280">date</span></span>|<span data-ttu-id="145a5-281">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="145a5-281">DBTYPE_DBDATE</span></span>|<span data-ttu-id="145a5-282">6</span><span class="sxs-lookup"><span data-stu-id="145a5-282">6</span></span>|<span data-ttu-id="145a5-283">10</span><span class="sxs-lookup"><span data-stu-id="145a5-283">10</span></span>|<span data-ttu-id="145a5-284">0</span><span class="sxs-lookup"><span data-stu-id="145a5-284">0</span></span>|<span data-ttu-id="145a5-285">清除</span><span class="sxs-lookup"><span data-stu-id="145a5-285">Clear</span></span>|  
|<span data-ttu-id="145a5-286">time(1..7)</span><span class="sxs-lookup"><span data-stu-id="145a5-286">time(1..7)</span></span>|<span data-ttu-id="145a5-287">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="145a5-287">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="145a5-288">10</span><span class="sxs-lookup"><span data-stu-id="145a5-288">10</span></span>|<span data-ttu-id="145a5-289">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="145a5-289">8, 10..16</span></span>|<span data-ttu-id="145a5-290">0..7</span><span class="sxs-lookup"><span data-stu-id="145a5-290">0..7</span></span>|<span data-ttu-id="145a5-291">設定</span><span class="sxs-lookup"><span data-stu-id="145a5-291">Set</span></span>|  
|<span data-ttu-id="145a5-292">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="145a5-292">smalldatetime</span></span>|<span data-ttu-id="145a5-293">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="145a5-293">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="145a5-294">16</span><span class="sxs-lookup"><span data-stu-id="145a5-294">16</span></span>|<span data-ttu-id="145a5-295">16</span><span class="sxs-lookup"><span data-stu-id="145a5-295">16</span></span>|<span data-ttu-id="145a5-296">0</span><span class="sxs-lookup"><span data-stu-id="145a5-296">0</span></span>|<span data-ttu-id="145a5-297">清除</span><span class="sxs-lookup"><span data-stu-id="145a5-297">Clear</span></span>|  
|<span data-ttu-id="145a5-298">Datetime</span><span class="sxs-lookup"><span data-stu-id="145a5-298">datetime</span></span>|<span data-ttu-id="145a5-299">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="145a5-299">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="145a5-300">16</span><span class="sxs-lookup"><span data-stu-id="145a5-300">16</span></span>|<span data-ttu-id="145a5-301">23</span><span class="sxs-lookup"><span data-stu-id="145a5-301">23</span></span>|<span data-ttu-id="145a5-302">3</span><span class="sxs-lookup"><span data-stu-id="145a5-302">3</span></span>|<span data-ttu-id="145a5-303">清除</span><span class="sxs-lookup"><span data-stu-id="145a5-303">Clear</span></span>|  
|<span data-ttu-id="145a5-304">datetime2</span><span class="sxs-lookup"><span data-stu-id="145a5-304">datetime2</span></span>|<span data-ttu-id="145a5-305">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="145a5-305">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="145a5-306">16</span><span class="sxs-lookup"><span data-stu-id="145a5-306">16</span></span>|<span data-ttu-id="145a5-307">19, 21..27</span><span class="sxs-lookup"><span data-stu-id="145a5-307">19, 21..27</span></span>|<span data-ttu-id="145a5-308">0..7</span><span class="sxs-lookup"><span data-stu-id="145a5-308">0..7</span></span>|<span data-ttu-id="145a5-309">設定</span><span class="sxs-lookup"><span data-stu-id="145a5-309">Set</span></span>|  
|<span data-ttu-id="145a5-310">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="145a5-310">datetimeoffset</span></span>|<span data-ttu-id="145a5-311">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="145a5-311">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="145a5-312">20</span><span class="sxs-lookup"><span data-stu-id="145a5-312">20</span></span>|<span data-ttu-id="145a5-313">26, 28..34</span><span class="sxs-lookup"><span data-stu-id="145a5-313">26, 28..34</span></span>|<span data-ttu-id="145a5-314">0..7</span><span class="sxs-lookup"><span data-stu-id="145a5-314">0..7</span></span>|<span data-ttu-id="145a5-315">設定</span><span class="sxs-lookup"><span data-stu-id="145a5-315">Set</span></span>|  
  
 <span data-ttu-id="145a5-316">在 *dwFlags* 中，DBCOLUMNFLAGS_ISFIXEDLENGTH 對 date/time 類型永遠為 true，而且下列旗標永遠為 false：</span><span class="sxs-lookup"><span data-stu-id="145a5-316">In *dwFlags*, DBCOLUMNFLAGS_ISFIXEDLENGTH is always true for date/time types and the following flags are always false:</span></span>  
  
-   <span data-ttu-id="145a5-317">DBCOLUMNFLAGS_CACHEDEFERRED</span><span class="sxs-lookup"><span data-stu-id="145a5-317">DBCOLUMNFLAGS_CACHEDEFERRED</span></span>  
  
-   <span data-ttu-id="145a5-318">DBCOLUMNFLAGS_ISBOOKMARK</span><span class="sxs-lookup"><span data-stu-id="145a5-318">DBCOLUMNFLAGS_ISBOOKMARK</span></span>  
  
-   <span data-ttu-id="145a5-319">DBCOLUMNFLAGS_ISCHAPTER</span><span class="sxs-lookup"><span data-stu-id="145a5-319">DBCOLUMNFLAGS_ISCHAPTER</span></span>  
  
-   <span data-ttu-id="145a5-320">DBCOLUMNFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="145a5-320">DBCOLUMNFLAGS_ISLONG</span></span>  
  
-   <span data-ttu-id="145a5-321">DBCOLUMNFLAGS_ISROWID</span><span class="sxs-lookup"><span data-stu-id="145a5-321">DBCOLUMNFLAGS_ISROWID</span></span>  
  
-   <span data-ttu-id="145a5-322">DBCOLUMNFLAGS_ISROWVER, MAYDEFER</span><span class="sxs-lookup"><span data-stu-id="145a5-322">DBCOLUMNFLAGS_ISROWVER, MAYDEFER</span></span>  
  
 <span data-ttu-id="145a5-323">可以設定剩餘的旗標 (DBCOLUMNFLAGS_ISNULLABLE、DBCOLUMNFLAGS_MAYBENULL、DBCOLUMNFLAGS_WRITE 和 DBCOLUMNFLAGS_WRITEUNKNOWN)。</span><span class="sxs-lookup"><span data-stu-id="145a5-323">The remaining flags (DBCOLUMNFLAGS_ISNULLABLE, DBCOLUMNFLAGS_MAYBENULL, DBCOLUMNFLAGS_WRITE, and DBCOLUMNFLAGS_WRITEUNKNOWN) can be set.</span></span>  
  
 <span data-ttu-id="145a5-324">在 *dwFlags* 中會提供新旗標 DBCOLUMNFLAGS_SS_ISVARIABLESCALE，以允許應用程式判斷資料行的伺服器類型，其中 *wType* 是 DBTYPE_DBTIMESTAMP。</span><span class="sxs-lookup"><span data-stu-id="145a5-324">A new flag DBCOLUMNFLAGS_SS_ISVARIABLESCALE is provided in *dwFlags* to allow an application to determine the server type of columns, where *wType* is DBTYPE_DBTIMESTAMP.</span></span> <span data-ttu-id="145a5-325">*bScale* 也必須用來識別伺服器類型。</span><span class="sxs-lookup"><span data-stu-id="145a5-325">*bScale* must also be used to identify the server type.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="145a5-326">另請參閱</span><span class="sxs-lookup"><span data-stu-id="145a5-326">See Also</span></span>  
 [<span data-ttu-id="145a5-327">中繼資料 &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="145a5-327">Metadata &#40;OLE DB&#41;</span></span>](../../database-engine/dev-guide/metadata-ole-db.md)  
  
  
