---
title: 將應用程式更新為從 MDAC SQL Server Native Client |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- MDAC [SQL Server]
- SQLNCLI, vs. MDAC
- SQL Server Native Client, vs. MDAC
- data access [SQL Server Native Client], vs. MDAC
- SQL Server Native Client, updating applications
ms.assetid: 2860efdd-c59a-4deb-8a0e-5124a8f4e6dd
author: rothja
ms.author: jroth
ms.openlocfilehash: 804f4340f3ca9a381f28507e0516d5f2e7d913a6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87706398"
---
# <a name="updating-an-application-to-sql-server-native-client-from-mdac"></a><span data-ttu-id="1e83c-102">從 MDAC 將應用程式更新至 SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="1e83c-102">Updating an Application to SQL Server Native Client from MDAC</span></span>
  <span data-ttu-id="1e83c-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 與 Microsoft Data Access Components 之間有一些差異 (MDAC；從 Windows Vista 開始，資料存取元件現在稱為 Windows Data Access Components 或 Windows DAC)。</span><span class="sxs-lookup"><span data-stu-id="1e83c-103">There are a number of differences between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and Microsoft Data Access Components (MDAC; starting with Windows Vista, the data access components are now called Windows Data Access Components, or Windows DAC).</span></span> <span data-ttu-id="1e83c-104">雖然兩者都提供 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 資料庫的原生資料存取權，但是 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 是專為公開 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 的新功能而設計，同時還保留了與舊版的回溯相容性。</span><span class="sxs-lookup"><span data-stu-id="1e83c-104">Although both provide native data access to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] databases, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client has been specifically designed to expose the new features of [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], while at the same time maintaining backward compatibility with earlier versions.</span></span>  
  
 <span data-ttu-id="1e83c-105">本主題的資訊可幫助您更新 MDAC (或 Windows DAC) 應用程式，使其保持為 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 中隨附的最新 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] Native Client 版本。</span><span class="sxs-lookup"><span data-stu-id="1e83c-105">The information in this topic helps update your MDAC (or Windows DAC) application to be current with the version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client that was included in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="1e83c-106">若要協助您將此應用程式與隨附的 Native Client 版本做為最新 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] ，請參閱[從 SQL Server 2005 Native Client 更新應用程式](updating-an-application-from-sql-server-2005-native-client.md)。</span><span class="sxs-lookup"><span data-stu-id="1e83c-106">To help you make this application be current with the version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client that shipped in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)], see [Updating an Application from SQL Server 2005 Native Client](updating-an-application-from-sql-server-2005-native-client.md).</span></span>  
  
 <span data-ttu-id="1e83c-107">此外，雖然 MDAC 包含了使用 OLE DB、ODBC 和 ActiveX Data Objects (ADO) 的元件，但是 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 只會實作 OLE DB 和 ODBC (雖然 ADO 可以存取 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 的功能)。</span><span class="sxs-lookup"><span data-stu-id="1e83c-107">In addition, although MDAC contains components for using OLE DB, ODBC, and ActiveX Data Objects (ADO), [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client only implements OLE DB and ODBC (although ADO can access the functionality of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client).</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="1e83c-108">Native Client 和 MDAC 還有下列其他方面的差異：</span><span class="sxs-lookup"><span data-stu-id="1e83c-108">Native Client and MDAC differ in the other following areas:</span></span>  
  
-   <span data-ttu-id="1e83c-109">使用 ADO 存取 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 提供者的使用者與存取 SQL OLE DB 提供者相較之下，可能會找到比較少的篩選功能。</span><span class="sxs-lookup"><span data-stu-id="1e83c-109">Users who use ADO to access a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client provider may find less filtering functionality than when they accessed a SQL OLE DB provider.</span></span>  
  
-   <span data-ttu-id="1e83c-110">如果 ADO 應用程式使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 並嘗試更新計算資料行，將會報告錯誤。</span><span class="sxs-lookup"><span data-stu-id="1e83c-110">If an ADO application uses [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and attempts to update a computed column, an error will be reported.</span></span> <span data-ttu-id="1e83c-111">在使用 MDAC 時，已接受更新但是被忽略。</span><span class="sxs-lookup"><span data-stu-id="1e83c-111">With MDAC the update was accepted but ignored.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="1e83c-112">Native Client 是單一獨立的動態連結程式庫 (DLL) 檔案。</span><span class="sxs-lookup"><span data-stu-id="1e83c-112">Native Client is a single self-contained dynamic link library (DLL) file.</span></span> <span data-ttu-id="1e83c-113">公開的介面已保留為最少量，這樣不但可便於散發，同時也可限制安全性風險。</span><span class="sxs-lookup"><span data-stu-id="1e83c-113">The publicly exposed interfaces have been kept to a minimum, both to ease distribution, as well as to limit security exposure.</span></span>  
  
-   <span data-ttu-id="1e83c-114">只支援 OLE DB 和 ODBC 介面。</span><span class="sxs-lookup"><span data-stu-id="1e83c-114">Only OLE DB and ODBC interfaces are supported.</span></span>  
  
-   <span data-ttu-id="1e83c-115">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者和 ODBC 驅動程式的名稱與搭配 MDAC 使用的名稱不同。</span><span class="sxs-lookup"><span data-stu-id="1e83c-115">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider and ODBC driver names are different from those used with MDAC.</span></span>  
  
-   <span data-ttu-id="1e83c-116">當使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 時，可以使用 MDAC 元件提供的使用者可存取功能。</span><span class="sxs-lookup"><span data-stu-id="1e83c-116">User-accessible functionality supplied by MDAC components is available when using [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="1e83c-117">這包括但不限於以下項目：連接共用、ADO 支援和用戶端資料指標支援。</span><span class="sxs-lookup"><span data-stu-id="1e83c-117">This includes, but is not limited to, the following: connection pooling, ADO support, and client cursor support.</span></span> <span data-ttu-id="1e83c-118">當使用這些功能的任何一項時，[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 只會提供資料庫連接。</span><span class="sxs-lookup"><span data-stu-id="1e83c-118">When any of these features are used, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supplies only database connectivity.</span></span> <span data-ttu-id="1e83c-119">MDAC 會提供類似追蹤、管理控制項和效能計數器的功能。</span><span class="sxs-lookup"><span data-stu-id="1e83c-119">MDAC provides functionality such as tracing, management controls, and performance counters.</span></span>  
  
-   <span data-ttu-id="1e83c-120">應用程式可以搭配 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 使用 OLE DB 核心服務，但是如果使用 OLE DB 資料指標引擎，它們應該使用資料類型相容性選項來避免可能發生的任何問題，因為資料指標引擎並不知道新的 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 資料類型。</span><span class="sxs-lookup"><span data-stu-id="1e83c-120">Applications can use OLE DB core services with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, but if using the OLE DB cursor engine, they should use the data type compatibility option to avoid any potential problems that might arise because the cursor engine has no knowledge of the new [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] data types.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="1e83c-121">Native Client 支援存取舊版 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 資料庫。</span><span class="sxs-lookup"><span data-stu-id="1e83c-121">Native Client supports access to previous [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] databases.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="1e83c-122">Native Client 不包含 XML 整合。</span><span class="sxs-lookup"><span data-stu-id="1e83c-122">Native Client does not contain XML integration.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="1e83c-123">Native Client 支援 SELECT .。。FOR XML 查詢，但不支援任何其他 XML 功能。</span><span class="sxs-lookup"><span data-stu-id="1e83c-123">Native Client supports SELECT ... FOR XML queries, but does not support any other XML functionality.</span></span> <span data-ttu-id="1e83c-124">但是，[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 確實可支援 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 中導入的 `xml` 資料類型。</span><span class="sxs-lookup"><span data-stu-id="1e83c-124">However, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does support the `xml` data type introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="1e83c-125">Native Client 支援只利用連接字串屬性來設定用戶端網路程式庫。</span><span class="sxs-lookup"><span data-stu-id="1e83c-125">Native Client supports configuring client-side network libraries using only connection string attributes.</span></span> <span data-ttu-id="1e83c-126">如果您需要更完整的網路程式庫組態，您必須使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 組態管理員。</span><span class="sxs-lookup"><span data-stu-id="1e83c-126">If you need more complete network library configuration, you must use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="1e83c-127">Native Client 與 odbcbcp.dll 不相容。</span><span class="sxs-lookup"><span data-stu-id="1e83c-127">Native Client is not compatible with odbcbcp.dll.</span></span> <span data-ttu-id="1e83c-128">使用 ODBC 和**bcp** api 的應用程式都必須重建，才能與 sqlncli11 連結，以便使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client。</span><span class="sxs-lookup"><span data-stu-id="1e83c-128">Applications that use both ODBC and **bcp** APIs must be rebuilt to link with sqlncli11.lib in order to use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
-   <span data-ttu-id="1e83c-129">Microsoft OLE DB provider for ODBC (MSDASQL) 不支援 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client。</span><span class="sxs-lookup"><span data-stu-id="1e83c-129">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client is not supported from the Microsoft OLE DB provider for ODBC (MSDASQL).</span></span> <span data-ttu-id="1e83c-130">如果您要使用 MDAC SQLODBC 驅動程式搭配 MSDASQL 或使用 MDAC SQLODBC 驅動程式搭配 ADO，請在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 中使用 OLE DB。</span><span class="sxs-lookup"><span data-stu-id="1e83c-130">If you are using the MDAC SQLODBC driver with MSDASQL or MDAC SQLODBC driver with ADO, use OLE DB in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client..</span></span>  
  
-   <span data-ttu-id="1e83c-131">MDAC 連接字串允許 Trusted_Connection 關鍵字的布林值 (`true`) **Trusted_Connection** 。</span><span class="sxs-lookup"><span data-stu-id="1e83c-131">MDAC connection strings allow a Boolean value (`true`) for the **Trusted_Connection** keyword.</span></span> <span data-ttu-id="1e83c-132">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client 連接字串必須使用 `yes` 或**否**。</span><span class="sxs-lookup"><span data-stu-id="1e83c-132">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client connection string must use `yes` or **no**.</span></span>  
  
-   <span data-ttu-id="1e83c-133">警告和錯誤發生了些微的變更。</span><span class="sxs-lookup"><span data-stu-id="1e83c-133">Minor changes have occurred to warnings and errors.</span></span> <span data-ttu-id="1e83c-134">伺服器傳回的警告和錯誤現在保持與傳遞給 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 時相同的嚴重性。</span><span class="sxs-lookup"><span data-stu-id="1e83c-134">Warnings and errors returned by the server now retain the same severity when passed to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="1e83c-135">如果您依賴特定警告和錯誤的截獲，您應該確定您已經徹底測試過您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="1e83c-135">You should ensure you have thoroughly tested your application if you depend on trapping particular warnings and errors.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="1e83c-136">Native Client 的錯誤檢查要比 MDAC 嚴格，這表示未嚴謹符合 ODBC 和 OLE DB 規格的某些應用程式可能會有不同的行為。</span><span class="sxs-lookup"><span data-stu-id="1e83c-136">Native Client has stricter error checking than MDAC, which means that some applications that do not conform strictly to the ODBC and OLE DB specifications may behave differently.</span></span> <span data-ttu-id="1e83c-137">例如，SQLOLEDB 提供者並未強制執行結果參數的參數名稱必須以 ' ' 開頭的規則 \@ ，但 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者會執行此操作。</span><span class="sxs-lookup"><span data-stu-id="1e83c-137">For example, the SQLOLEDB provider did not enforce the rule that parameter names must start with '\@' for result parameters, but the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider does.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="1e83c-138">Native Client 對於失敗連接方面的行為與 MDAC 不同。</span><span class="sxs-lookup"><span data-stu-id="1e83c-138">Native Client behaves differently from MDAC in regards to failed connections.</span></span> <span data-ttu-id="1e83c-139">例如，MDAC 會針對失敗的連接傳回快取屬性值，而 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 會報告錯誤給呼叫的應用程式。</span><span class="sxs-lookup"><span data-stu-id="1e83c-139">For example, MDAC returns cached property values for a connection that has failed, whereas [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client reports an error to the calling application.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="1e83c-140">Native Client 不會產生 Visual Studio Analyzer 事件，而是產生 Windows 追蹤事件。</span><span class="sxs-lookup"><span data-stu-id="1e83c-140">Native Client does not generate Visual Studio Analyzer events, but instead generates Windows tracing events.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="1e83c-141">Native Client 不能搭配 Perfmon 一起使用。</span><span class="sxs-lookup"><span data-stu-id="1e83c-141">Native Client cannot be used with perfmon.</span></span> <span data-ttu-id="1e83c-142">Perfmon 是一種 Windows 工具，它只能搭配使用 Windows 隨附之 MDAC SQLODBC 驅動程式的 DSN 一起使用。</span><span class="sxs-lookup"><span data-stu-id="1e83c-142">Perfmon is a Windows tool that can only be used with DSNs that use the MDAC SQLODBC driver included with Windows.</span></span>  
  
-   <span data-ttu-id="1e83c-143">當 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 連接到 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 和更新版本時，伺服器錯誤 16947 會以 SQL_ERROR 的形式傳回。</span><span class="sxs-lookup"><span data-stu-id="1e83c-143">When [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client is connected to [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions, server error 16947 is returned as a SQL_ERROR.</span></span> <span data-ttu-id="1e83c-144">當定點更新或刪除無法更新或刪除資料列時，就會發生這個錯誤。</span><span class="sxs-lookup"><span data-stu-id="1e83c-144">This error occurs when a positioned update or delete fails to update or delete a row.</span></span> <span data-ttu-id="1e83c-145">使用 MDAC 時，如果連接到任何 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 版本，伺服器錯誤 16947 會以警告 (SQL_SUCCESS_WITH_INFO) 的形式傳回。</span><span class="sxs-lookup"><span data-stu-id="1e83c-145">With MDAC when connecting to any version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], server error 16947 is returned as a warning (SQL_SUCCESS_WITH_INFO).</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="1e83c-146">Native Client 會執行**IDBDataSourceAdmin**介面，這是先前未執行的選擇性 OLE DB 介面，但只會實作為此選擇性介面的**CreateDataSource**方法。</span><span class="sxs-lookup"><span data-stu-id="1e83c-146">Native Client implements the **IDBDataSourceAdmin** interface, which is an optional OLE DB interface that was not previously implemented, but only the **CreateDataSource** method of this optional interface is implemented.</span></span> [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]  
  
-   <span data-ttu-id="1e83c-147">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者會在 TABLES 和 TABLE_INFO 結構描述資料列集中傳回同義字，而且 TABLE_TYPE 會設定為 SYNONYM。</span><span class="sxs-lookup"><span data-stu-id="1e83c-147">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns synonyms in the TABLES and TABLE_INFO schema rowsets, with TABLE_TYPE set to SYNONYM.</span></span>  
  
-   <span data-ttu-id="1e83c-148">資料類型 `varchar(max)` 、、 `nvarchar(max)` `varbinary(max)` 、 `xml` 、 `udt` 或其他大型物件類型的傳回值，不能傳回到早于的用戶端版本 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="1e83c-148">Return values of data type `varchar(max)`, `nvarchar(max)`, `varbinary(max)`, `xml`, `udt`, or other large object types can not be returned to client versions earlier than [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="1e83c-149">如果您想要使用這些類型當做傳回值，則必須使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client。</span><span class="sxs-lookup"><span data-stu-id="1e83c-149">If you wish to use these types as return values, you must use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
-   <span data-ttu-id="1e83c-150">MDAC 允許在手動和隱含交易的開頭執行以下陳述式，但是 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 則不允許。</span><span class="sxs-lookup"><span data-stu-id="1e83c-150">MDAC allows the following statements to be executed at the start of manual and implicit transactions, but [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not.</span></span> <span data-ttu-id="1e83c-151">它們必須在自動認可模式中執行。</span><span class="sxs-lookup"><span data-stu-id="1e83c-151">They must be executed in autocommit mode.</span></span>  
  
    -   <span data-ttu-id="1e83c-152">所有全文檢索作業 (索引和目錄 DDL)</span><span class="sxs-lookup"><span data-stu-id="1e83c-152">All full-text operations (index and catalog DDL)</span></span>  
  
    -   <span data-ttu-id="1e83c-153">所有資料庫作業 (建立資料庫、改變資料庫、卸除資料庫)</span><span class="sxs-lookup"><span data-stu-id="1e83c-153">All database operations (create database, alter database, drop database)</span></span>  
  
    -   <span data-ttu-id="1e83c-154">重新設定</span><span class="sxs-lookup"><span data-stu-id="1e83c-154">Reconfigure</span></span>  
  
    -   <span data-ttu-id="1e83c-155">Shutdown</span><span class="sxs-lookup"><span data-stu-id="1e83c-155">Shutdown</span></span>  
  
    -   <span data-ttu-id="1e83c-156">終止</span><span class="sxs-lookup"><span data-stu-id="1e83c-156">Kill</span></span>  
  
    -   <span data-ttu-id="1e83c-157">Backup</span><span class="sxs-lookup"><span data-stu-id="1e83c-157">Backup</span></span>  
  
-   <span data-ttu-id="1e83c-158">當 MDAC 應用程式連接到 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 時，[!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 中導入的資料類型將會以 [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] 相容的資料類型形式出現，如下表所示。</span><span class="sxs-lookup"><span data-stu-id="1e83c-158">When MDAC applications connect to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the data types introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] will appear as [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)]-compatible data types as shown in the following table.</span></span>  
  
    |<span data-ttu-id="1e83c-159">SQL Server 2005 類型</span><span class="sxs-lookup"><span data-stu-id="1e83c-159">SQL Server 2005 type</span></span>|<span data-ttu-id="1e83c-160">SQL Server 2000 類型</span><span class="sxs-lookup"><span data-stu-id="1e83c-160">SQL Server 2000 type</span></span>|  
    |--------------------------|--------------------------|  
    |`varchar(max)`|`text`|  
    |`nvarchar(max)`|`ntext`|  
    |`varbinary(max)`|`image`|  
    |`udt`|`varbinary`|  
    |`xml`|`ntext`|  
  
     <span data-ttu-id="1e83c-161">此類型對應會影響資料行中繼資料傳回的值。</span><span class="sxs-lookup"><span data-stu-id="1e83c-161">This type mapping affects the values returned for column metadata.</span></span> <span data-ttu-id="1e83c-162">例如，資料 `text` 行的大小上限為2147483647，但 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] NATIVE client ODBC 會將資料行的大小上限報告 `varchar(max)` 為 SQL_SS_LENGTH_UNLIMITED，而 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] native client OLE DB 會根據平臺，將資料行的大小上限報告 `varchar(max)` 為2147483647或-1。</span><span class="sxs-lookup"><span data-stu-id="1e83c-162">For example, a `text` column has a maximum size of 2,147,483,647, but [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC reports the maximum size of `varchar(max)` columns as SQL_SS_LENGTH_UNLIMITED, and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB reports the maximum size of `varchar(max)` columns as 2,147,483,647 or -1, depending on platform.</span></span>  
  
-   <span data-ttu-id="1e83c-163">基於回溯相容性的理由，[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 允許模稜兩可的連接字串 (例如，某些關鍵字可能會指定一次以上，而且可能會允許衝突的關鍵字，好讓解決方法以位置或優先順序為根據)。</span><span class="sxs-lookup"><span data-stu-id="1e83c-163">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client allows ambiguity in connection strings (for example, some keywords may be specified more than once, and conflicting keywords may be allowed with resolution based on position or precedence) for reasons of backward compatibility.</span></span> <span data-ttu-id="1e83c-164">未來的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 版本可能不允許模稜兩可的連接字串。</span><span class="sxs-lookup"><span data-stu-id="1e83c-164">Future releases of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client might not allow ambiguity in connection strings.</span></span> <span data-ttu-id="1e83c-165">當修改應用程式，以便使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 來移除對於模稜兩可之連接字串的任何相依性時，這就是很好的作法。</span><span class="sxs-lookup"><span data-stu-id="1e83c-165">It is good practice when modifying applications to use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to eliminate any dependency on connection string ambiguity.</span></span>  
  
-   <span data-ttu-id="1e83c-166">如果您使用 ODBC 或 OLE DB 呼叫來開始交易，[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 與 MDAC 之間會有行為上的差異；使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 時會立即開始交易，但是使用 MDAC 時會在初次存取資料庫之後開始交易。</span><span class="sxs-lookup"><span data-stu-id="1e83c-166">If you use an ODBC or OLE DB call to start transactions, there is a difference in behavior between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and MDAC; transactions will begin immediately with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, but transactions will begin after the first database access using MDAC.</span></span> <span data-ttu-id="1e83c-167">這可能會影響預存程式和批次的行為，因為在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] \@ \@ 批次或預存程式完成執行之後，需要 TRANCOUNT 是相同的，就像批次或預存程式啟動時一樣。</span><span class="sxs-lookup"><span data-stu-id="1e83c-167">This can affect the behavior of stored procedures and batches because [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] requires \@\@TRANCOUNT to be the same after a batch or stored procedure finishes execution as it was when the batch or stored procedure started.</span></span>  
  
-   <span data-ttu-id="1e83c-168">使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 時，ITransactionLocal：： BeginTransaction 會立即啟動交易。</span><span class="sxs-lookup"><span data-stu-id="1e83c-168">With [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, ITransactionLocal::BeginTransaction will cause a transaction to be started immediately.</span></span> <span data-ttu-id="1e83c-169">當使用 MDAC 時，交易會延遲到應用程式執行陳述式之後才開始，這需要交易處於隱含交易模式中。</span><span class="sxs-lookup"><span data-stu-id="1e83c-169">With MDAC the transaction start was delayed until the application executed a statement which required a transaction in implicit transaction mode.</span></span> <span data-ttu-id="1e83c-170">如需詳細資訊，請參閱[SET IMPLICIT_TRANSACTIONS &#40;transact-sql&#41;](/sql/t-sql/statements/set-implicit-transactions-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="1e83c-170">For more information, see [SET IMPLICIT_TRANSACTIONS &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-implicit-transactions-transact-sql).</span></span>  
  
-   <span data-ttu-id="1e83c-171">當您使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 驅動程式搭配 system.string 來存取 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 公開新的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 特定資料類型或功能的伺服器電腦時，可能會遇到錯誤。</span><span class="sxs-lookup"><span data-stu-id="1e83c-171">You might encounter errors when using [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client driver with System.Data.Odbc to access a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] server computer that exposes new, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-specific data types or features.</span></span> <span data-ttu-id="1e83c-172">System.string 提供一般的 ODBC 執行，並隨後不會公開廠商特有的功能或延伸模組。</span><span class="sxs-lookup"><span data-stu-id="1e83c-172">System.Data.Odbc provides a generic ODBC implementation and subsequently does not expose vendor specific functionality or extensions.</span></span> <span data-ttu-id="1e83c-173"> ([!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 驅動程式已更新為原本就支援最新 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 功能。 ) 若要解決這個問題，您可以還原為 MDAC，或遷移至 SqlClient。</span><span class="sxs-lookup"><span data-stu-id="1e83c-173">(The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client driver is updated to natively support the latest [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] features.) To workaround this issue, you can either revert to MDAC, or migrate to System.Data.SqlClient.</span></span>  
  
 <span data-ttu-id="1e83c-174">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 和 MDAC 都可使用資料列版本設定來支援讀取認可的交易隔離，但是只有 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 可支援快照集交易隔離 </span><span class="sxs-lookup"><span data-stu-id="1e83c-174">Both [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and MDAC support read committed transaction isolation using row versioning, but only [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supports snapshot transaction isolation.</span></span> <span data-ttu-id="1e83c-175">(在程式設計的詞彙中，使用資料列版本設定的讀取認可交易隔離與讀取認可的交易相同)。</span><span class="sxs-lookup"><span data-stu-id="1e83c-175">(In programming terms, read committed transaction isolation using row versioning is the same as read-committed transaction.).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1e83c-176">另請參閱</span><span class="sxs-lookup"><span data-stu-id="1e83c-176">See Also</span></span>  
 [<span data-ttu-id="1e83c-177">使用 SQL Server Native Client 建置應用程式</span><span class="sxs-lookup"><span data-stu-id="1e83c-177">Building Applications with SQL Server Native Client</span></span>](building-applications-with-sql-server-native-client.md)  
  
  
