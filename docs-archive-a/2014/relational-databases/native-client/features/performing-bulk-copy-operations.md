---
title: 執行大量複製作業 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- bulk copy [SQL Server Native Client]
- data access [SQL Server Native Client], bulk copy operations
- SQL Server Native Client, bulk copy operations
- SQLNCLI, bulk copy operations
ms.assetid: 50d8456b-e6a1-4b25-bc7e-56946ed654a7
author: rothja
ms.author: jroth
ms.openlocfilehash: 51a4cd3ebd4cb2e16baa75a268bf307a549a694b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87592670"
---
# <a name="performing-bulk-copy-operations"></a><span data-ttu-id="1402b-102">執行大量複製作業</span><span class="sxs-lookup"><span data-stu-id="1402b-102">Performing Bulk Copy Operations</span></span>
  <span data-ttu-id="1402b-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 大量複製功能支援將大量資料傳送進出 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 資料表或檢視。</span><span class="sxs-lookup"><span data-stu-id="1402b-103">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy feature supports the transfer of large amounts of data into or out of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table or view.</span></span> <span data-ttu-id="1402b-104">資料也可以藉由指定 SELECT 陳述式而向外傳送。</span><span class="sxs-lookup"><span data-stu-id="1402b-104">Data can also be transferred out by specifying a SELECT statement.</span></span> <span data-ttu-id="1402b-105">您可在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 和作業系統資料檔 (例如 ASCII 檔) 之間移動。</span><span class="sxs-lookup"><span data-stu-id="1402b-105">The data can be moved between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and an operating-system data file, such as an ASCII file.</span></span> <span data-ttu-id="1402b-106">資料檔可能具有不同的格式；您可將格式定義為以格式檔來大量複製。</span><span class="sxs-lookup"><span data-stu-id="1402b-106">The data file can have different formats; the format is defined to bulk copy in a format file.</span></span> <span data-ttu-id="1402b-107">或者，也可以使用大量複製函數和方法，將資料載入程式變數，然後傳送到 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="1402b-107">Optionally, data can be loaded into program variables and transferred to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] using bulk copy functions and methods.</span></span>  
  
 <span data-ttu-id="1402b-108">如需示範此功能的範例應用程式，請參閱[使用 IRowsetFastLoad 大量複製資料 &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md)。</span><span class="sxs-lookup"><span data-stu-id="1402b-108">For a sample application that demonstrates this feature, see [Bulk Copy Data Using IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md).</span></span>  
  
 <span data-ttu-id="1402b-109">應用程式通常會以下列其中一種方式使用大量複製：</span><span class="sxs-lookup"><span data-stu-id="1402b-109">An application typically uses bulk copy in one of the following ways:</span></span>  
  
-   <span data-ttu-id="1402b-110">從資料表、檢視或 Transact-SQL 陳述式的結果集大量複製到資料檔，其中資料會以與資料表或檢視相同的格式儲存。</span><span class="sxs-lookup"><span data-stu-id="1402b-110">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in the same format as the table or view.</span></span>  
  
     <span data-ttu-id="1402b-111">這稱為原生模式的資料檔案。</span><span class="sxs-lookup"><span data-stu-id="1402b-111">This is called a native-mode data file.</span></span>  
  
-   <span data-ttu-id="1402b-112">從資料表、檢視或 Transact-SQL 陳述式的結果集大量複製到資料檔，其中儲存資料的格式會與資料表或檢視不同。</span><span class="sxs-lookup"><span data-stu-id="1402b-112">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in a format other than the one of the table or view.</span></span>  
  
     <span data-ttu-id="1402b-113">在此情況下，會在每一個資料行儲存到資料檔中時，為其建立另一個定義特性 (資料類型、位置、長度、結束字元等) 的格式檔案。</span><span class="sxs-lookup"><span data-stu-id="1402b-113">In this case, a separate format file is created that defines the characteristics (data type, position, length, terminator, and so on) of each column as it is stored in the data file.</span></span> <span data-ttu-id="1402b-114">如果所有的資料行都轉換成字元格式，則產生的檔案稱為字元模式資料檔。</span><span class="sxs-lookup"><span data-stu-id="1402b-114">If all columns are converted to character format, the resulting file is called a character-mode data file.</span></span>  
  
-   <span data-ttu-id="1402b-115">從資料檔大量複製到資料表或檢視。</span><span class="sxs-lookup"><span data-stu-id="1402b-115">Bulk copy from a data file into a table or view.</span></span>  
  
     <span data-ttu-id="1402b-116">如有需要，可使用格式檔來判斷資料檔的配置。</span><span class="sxs-lookup"><span data-stu-id="1402b-116">If needed, a format file is used to determine the layout of the data file.</span></span>  
  
-   <span data-ttu-id="1402b-117">將資料載入程式變數，然後使用可在資料行中一次複製大量資料的大量複製函數，將資料匯入資料表或檢視。</span><span class="sxs-lookup"><span data-stu-id="1402b-117">Load data into program variables, then import the data into a table or view using the bulk copy functions for bulk copying in a row at a time.</span></span>  
  
 <span data-ttu-id="1402b-118">大量複製函數所使用的資料檔不必由其他的大量複製程式建立。</span><span class="sxs-lookup"><span data-stu-id="1402b-118">Data files used by bulk copy functions do not have to be created by another bulk copy program.</span></span> <span data-ttu-id="1402b-119">任何其他的系統都可以根據大量複製定義產生資料檔和格式檔；之後可以將這些檔案搭配 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 大量複製程式使用，以將資料匯入至 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="1402b-119">Any other system can generate a data file and format file according to bulk copy definitions; these files can then be used with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy program to import data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="1402b-120">例如，您可以從試算表將資料匯出至 Tab 鍵分隔檔案、建立描述 Tab 鍵分隔檔案的格式檔，然後使用大量複製程式將資料快速匯入至 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="1402b-120">For example, you could export data from a spreadsheet in a tab-delimited file, build a format file describing the tab-delimited file, and then use a bulk copy program to quickly import the data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="1402b-121">大量複製所產生的資料檔也可以匯入至其他應用程式。</span><span class="sxs-lookup"><span data-stu-id="1402b-121">Data files generated by bulk copy can also be imported into other applications.</span></span> <span data-ttu-id="1402b-122">例如，您可以使用大量複製函數，將資料從資料表或檢視匯出至 Tab 鍵分隔檔案，然後再將該檔案載入至試算表。</span><span class="sxs-lookup"><span data-stu-id="1402b-122">For example, you could use bulk copy functions to export data from a table or view into a tab-delimited file that could then be loaded into a spreadsheet.</span></span>  
  
 <span data-ttu-id="1402b-123">程式設計人員在撰寫使用大量複製函數的應用程式時，應該遵照大量複製良好效能的一般規則。</span><span class="sxs-lookup"><span data-stu-id="1402b-123">Programmers coding applications to use the bulk copy functions should follow the general rules for good bulk copy performance.</span></span> <span data-ttu-id="1402b-124">如需有關 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 中大量複製作業支援的詳細資訊，請參閱[資料的大量匯入及匯出 &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="1402b-124">For more information about support for bulk copy operations in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md).</span></span>  
  
## <a name="limitations-and-restrictions"></a><span data-ttu-id="1402b-125">限制事項</span><span class="sxs-lookup"><span data-stu-id="1402b-125">Limitations and Restrictions</span></span>  
 <span data-ttu-id="1402b-126">CLR 使用者定義型別 (UDT) 必須繫結為二進位資料。</span><span class="sxs-lookup"><span data-stu-id="1402b-126">A CLR user-defined type (UDT) must be bound as binary data.</span></span> <span data-ttu-id="1402b-127">即使格式檔指定 SQLCHAR 做為目標 UDT 資料行的資料類型，BCP 公用程式也會將該資料視為二進位。</span><span class="sxs-lookup"><span data-stu-id="1402b-127">Even if a format file specifies SQLCHAR as the data type for a target UDT column, The BCP utility will treat the data as binary.</span></span>  
  
 <span data-ttu-id="1402b-128">請勿將 SET FMTONLY OFF 用於大量複製作業。</span><span class="sxs-lookup"><span data-stu-id="1402b-128">Do not use SET FMTONLY OFF with bulk copy operations.</span></span> <span data-ttu-id="1402b-129">SET FMTONLY OFF 可能會導致大量複製作業失敗或提供未預期的結果。</span><span class="sxs-lookup"><span data-stu-id="1402b-129">SET FMTONLY OFF may cause your bulk copy operation to fail or give unexpected results.</span></span>  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="1402b-130">SQL Server Native Client OLE DB 提供者</span><span class="sxs-lookup"><span data-stu-id="1402b-130">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="1402b-131">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB 提供者會針對使用資料庫執行大量複製作業的兩個方法進行實施 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="1402b-131">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements two methods for performing bulk copy operations with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="1402b-132">第一個方法涉及使用 [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) 介面進行以記憶體為基礎的大量複製作業；第二個方法則涉及使用 [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) 介面進行以檔案為基礎的大量複製作業。</span><span class="sxs-lookup"><span data-stu-id="1402b-132">The first method involves using the [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) interface for memory-based bulk copy operations; and the second involves using the [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) interface for file-based bulk copy operations.</span></span>  
  
### <a name="using-memory-based-bulk-copy-operations"></a><span data-ttu-id="1402b-133">使用以記憶體為基礎的大量複製作業</span><span class="sxs-lookup"><span data-stu-id="1402b-133">Using Memory Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="1402b-134">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB 提供者會執行**IRowsetFastLoad**介面，以公開對以 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 記憶體為基礎之大量複製作業的支援。</span><span class="sxs-lookup"><span data-stu-id="1402b-134">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IRowsetFastLoad** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] memory-based bulk copy operations.</span></span> <span data-ttu-id="1402b-135">**IRowsetFastLoad** 介面會實作 [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) 和 [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md) 方法。</span><span class="sxs-lookup"><span data-stu-id="1402b-135">The **IRowsetFastLoad** interface implements the [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) and [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md) methods.</span></span>  
  
#### <a name="enabling-a-session-for-irowsetfastload"></a><span data-ttu-id="1402b-136">針對 IRowsetFastLoad 啟用工作階段</span><span class="sxs-lookup"><span data-stu-id="1402b-136">Enabling a Session for IRowsetFastLoad</span></span>  
 <span data-ttu-id="1402b-137">取用者會將其大量複製的需求通知 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者，方法是將 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者特定的資料來源屬性 SSPROP_ENABLEFASTLOAD 設定為 VARIANT_TRUE。</span><span class="sxs-lookup"><span data-stu-id="1402b-137">The consumer notifies the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider of its need for bulk copy by setting the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider-specific data source property SSPROP_ENABLEFASTLOAD to VARIANT_TRUE.</span></span> <span data-ttu-id="1402b-138">在資料來源上設定該屬性後，取用者會建立 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者工作階段。</span><span class="sxs-lookup"><span data-stu-id="1402b-138">With the property set on the data source, the consumer creates a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session.</span></span> <span data-ttu-id="1402b-139">新的工作階段可以讓取用者存取 **IRowsetFastLoad** 介面。</span><span class="sxs-lookup"><span data-stu-id="1402b-139">The new session allows consumer access to the **IRowsetFastLoad** interface.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="1402b-140">如果使用 **IDataInitialize** 介面來初始化資料來源，則必須在 **IOpenRowset::OpenRowset** 方法的 *rgPropertySets* 參數中設定 SSPROP_IRowsetFastLoad 屬性，否則對 **OpenRowset** 方法的呼叫將傳回 E_NOINTERFACE。</span><span class="sxs-lookup"><span data-stu-id="1402b-140">If the **IDataInitialize** interface is used for initializing the data source, then it is necessary to set the SSPROP_IRowsetFastLoad property in the *rgPropertySets* parameter of the **IOpenRowset::OpenRowset** method; otherwise, the call to the **OpenRowset** method will return E_NOINTERFACE.</span></span>  
  
 <span data-ttu-id="1402b-141">針對大量複製而啟用工作階段，會限制 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者對該工作階段上介面的支援。</span><span class="sxs-lookup"><span data-stu-id="1402b-141">Enabling a session for bulk copy constrains the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider support for interfaces on the session.</span></span> <span data-ttu-id="1402b-142">啟用大量複製功能的工作階段只會公開下列介面：</span><span class="sxs-lookup"><span data-stu-id="1402b-142">A bulk copy-enabled session exposes only the following interfaces:</span></span>  
  
-   <span data-ttu-id="1402b-143">**IDBSchemaRowset**</span><span class="sxs-lookup"><span data-stu-id="1402b-143">**IDBSchemaRowset**</span></span>  
  
-   <span data-ttu-id="1402b-144">**IGetDataSource**</span><span class="sxs-lookup"><span data-stu-id="1402b-144">**IGetDataSource**</span></span>  
  
-   <span data-ttu-id="1402b-145">**IOpenRowset**</span><span class="sxs-lookup"><span data-stu-id="1402b-145">**IOpenRowset**</span></span>  
  
-   <span data-ttu-id="1402b-146">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="1402b-146">**ISupportErrorInfo**</span></span>  
  
-   <span data-ttu-id="1402b-147">**ITransactionJoin**</span><span class="sxs-lookup"><span data-stu-id="1402b-147">**ITransactionJoin**</span></span>  
  
 <span data-ttu-id="1402b-148">若要停止建立啟用大量複製功能的資料列集，並導致 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者工作階段還原為標準處理，請將 SSPROP_ENABLEFASTLOAD 重設為 VARIANT_FALSE。</span><span class="sxs-lookup"><span data-stu-id="1402b-148">To disable the creation of bulk copy-enabled rowsets and cause the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session to revert to standard processing, reset SSPROP_ENABLEFASTLOAD to VARIANT_FALSE.</span></span>  
  
#### <a name="irowsetfastload-rowsets"></a><span data-ttu-id="1402b-149">IRowsetFastLoad Rowsets</span><span class="sxs-lookup"><span data-stu-id="1402b-149">IRowsetFastLoad Rowsets</span></span>  
 <span data-ttu-id="1402b-150"> Native Client OLE DB 提供者大量複製資料列集是唯寫的，但會公開介面讓取用者得以判斷  資料表的結構。</span><span class="sxs-lookup"><span data-stu-id="1402b-150">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk copy rowsets are write-only, but they expose interfaces that allow the consumer to determine the structure of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="1402b-151">下列介面會公開於啟用大量複製功能的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者資料列集：</span><span class="sxs-lookup"><span data-stu-id="1402b-151">The following interfaces are exposed on a bulk copy-enabled [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider rowset:</span></span>  
  
-   <span data-ttu-id="1402b-152">**IAccessor**</span><span class="sxs-lookup"><span data-stu-id="1402b-152">**IAccessor**</span></span>  
  
-   <span data-ttu-id="1402b-153">**IColumnsInfo**</span><span class="sxs-lookup"><span data-stu-id="1402b-153">**IColumnsInfo**</span></span>  
  
-   <span data-ttu-id="1402b-154">**IColumnsRowset**</span><span class="sxs-lookup"><span data-stu-id="1402b-154">**IColumnsRowset**</span></span>  
  
-   <span data-ttu-id="1402b-155">**IConvertType**</span><span class="sxs-lookup"><span data-stu-id="1402b-155">**IConvertType**</span></span>  
  
-   <span data-ttu-id="1402b-156">**IRowsetFastLoad**</span><span class="sxs-lookup"><span data-stu-id="1402b-156">**IRowsetFastLoad**</span></span>  
  
-   <span data-ttu-id="1402b-157">**IRowsetInfo**</span><span class="sxs-lookup"><span data-stu-id="1402b-157">**IRowsetInfo**</span></span>  
  
-   <span data-ttu-id="1402b-158">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="1402b-158">**ISupportErrorInfo**</span></span>  
  
 <span data-ttu-id="1402b-159">提供者特定的屬性 SSPROP_FASTLOADOPTIONS、SSPROP_FASTLOADKEEPNULLS 和 SSPROP_FASTLOADKEEPIDENTITY 可控制 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者大量複製資料列集的行為。</span><span class="sxs-lookup"><span data-stu-id="1402b-159">The provider-specific properties SSPROP_FASTLOADOPTIONS, SSPROP_FASTLOADKEEPNULLS, and SSPROP_FASTLOADKEEPIDENTITY control behaviors of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk-copy rowset.</span></span> <span data-ttu-id="1402b-160">屬性是在_rgPropertySets_**IOpenRowset**參數成員的*rgProperties*成員中指定。</span><span class="sxs-lookup"><span data-stu-id="1402b-160">The properties are specified in the *rgProperties* member of an _rgPropertySets_**IOpenRowset**parameter member.</span></span>  
  
|<span data-ttu-id="1402b-161">屬性識別碼</span><span class="sxs-lookup"><span data-stu-id="1402b-161">Property ID</span></span>|<span data-ttu-id="1402b-162">描述</span><span class="sxs-lookup"><span data-stu-id="1402b-162">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="1402b-163">SSPROP_FASTLOADKEEPIDENTITY</span><span class="sxs-lookup"><span data-stu-id="1402b-163">SSPROP_FASTLOADKEEPIDENTITY</span></span>|<span data-ttu-id="1402b-164">資料行：否</span><span class="sxs-lookup"><span data-stu-id="1402b-164">Column: No</span></span><br /><br /> <span data-ttu-id="1402b-165">R/W︰讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="1402b-165">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="1402b-166">輸入：VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="1402b-166">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="1402b-167">預設值：VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="1402b-167">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="1402b-168">描述：維護取用者所提供的識別值。</span><span class="sxs-lookup"><span data-stu-id="1402b-168">Description: Maintains identity values supplied by the consumer.</span></span><br /><br /> <span data-ttu-id="1402b-169">VARIANT_FALSE：[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 資料表中識別資料行的值是由 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 產生。</span><span class="sxs-lookup"><span data-stu-id="1402b-169">VARIANT_FALSE: Values for an identity column in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table are generated by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="1402b-170">Native Client OLE DB 提供者會忽略為資料行所系結的任何值 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="1402b-170">Any value bound for the column is ignored by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span><br /><br /> <span data-ttu-id="1402b-171">VARIANT_TRUE：取用者會繫結為 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 識別資料行提供值的存取子。</span><span class="sxs-lookup"><span data-stu-id="1402b-171">VARIANT_TRUE: The consumer binds an accessor providing a value for a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] identity column.</span></span> <span data-ttu-id="1402b-172">在接受 NULL 的資料行上不提供識別屬性，所以取用者會在每個 **IRowsetFastLoad::Insert** 呼叫上提供唯一值。</span><span class="sxs-lookup"><span data-stu-id="1402b-172">The identity property is not available on columns accepting NULL, so the consumer provides a unique value on each **IRowsetFastLoad::Insert** call.</span></span>|  
|<span data-ttu-id="1402b-173">SSPROP_FASTLOADKEEPNULLS</span><span class="sxs-lookup"><span data-stu-id="1402b-173">SSPROP_FASTLOADKEEPNULLS</span></span>|<span data-ttu-id="1402b-174">資料行：否</span><span class="sxs-lookup"><span data-stu-id="1402b-174">Column: No</span></span><br /><br /> <span data-ttu-id="1402b-175">R/W︰讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="1402b-175">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="1402b-176">輸入：VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="1402b-176">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="1402b-177">預設值：VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="1402b-177">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="1402b-178">描述：針對具有 DEFAULT 條件約束的資料行維護 NULL。</span><span class="sxs-lookup"><span data-stu-id="1402b-178">Description: Maintains NULL for columns with a DEFAULT constraint.</span></span> <span data-ttu-id="1402b-179">只對接受 NULL 且套用 DEFAULT 條件約束的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 資料行造成影響。</span><span class="sxs-lookup"><span data-stu-id="1402b-179">Affects only [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] columns that accept NULL and have a DEFAULT constraint applied.</span></span><br /><br /> <span data-ttu-id="1402b-180">VARIANT_FALSE：當 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者取用者插入的資料列包含資料行要用的 NULL 時，[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 會插入資料行的預設值。</span><span class="sxs-lookup"><span data-stu-id="1402b-180">VARIANT_FALSE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts the default value for the column when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span><br /><br /> <span data-ttu-id="1402b-181">VARIANT_TRUE：當 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者取用者插入的資料列包含資料行要用的 NULL 時，[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 會插入 NULL 做為資料行值。</span><span class="sxs-lookup"><span data-stu-id="1402b-181">VARIANT_TRUE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts NULL for the column value when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span>|  
|<span data-ttu-id="1402b-182">SSPROP_FASTLOADOPTIONS</span><span class="sxs-lookup"><span data-stu-id="1402b-182">SSPROP_FASTLOADOPTIONS</span></span>|<span data-ttu-id="1402b-183">資料行：否</span><span class="sxs-lookup"><span data-stu-id="1402b-183">Column: No</span></span><br /><br /> <span data-ttu-id="1402b-184">R/W︰讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="1402b-184">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="1402b-185">輸入：VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="1402b-185">Type: VT_BSTR</span></span><br /><br /> <span data-ttu-id="1402b-186">預設值：無</span><span class="sxs-lookup"><span data-stu-id="1402b-186">Default: none</span></span><br /><br /> <span data-ttu-id="1402b-187">描述：這個屬性與 **bcp** 公用程式的 **-h** "*hint*[,...*n*]" 選項相同。</span><span class="sxs-lookup"><span data-stu-id="1402b-187">Description: This property is the same as the **-h** "*hint*[,...*n*]" option of the **bcp** utility.</span></span> <span data-ttu-id="1402b-188">將資料大量複製到資料表時，可使用下列字串做為選項。</span><span class="sxs-lookup"><span data-stu-id="1402b-188">The following string(s) can be used as option(s) in the bulk copying of data into a table.</span></span><br /><br /> <span data-ttu-id="1402b-189">**ORDER**(*column*[**ASC** &#124; **DESC**][,...*n*]):資料檔案中資料的排序次序。</span><span class="sxs-lookup"><span data-stu-id="1402b-189">**ORDER**(*column*[**ASC** &#124; **DESC**][,...*n*]): Sort order of data in the data file.</span></span> <span data-ttu-id="1402b-190">如果載入的資料檔是依照資料表的叢集索引來排序，將可增進大量複製的效能。</span><span class="sxs-lookup"><span data-stu-id="1402b-190">Bulk copy performance is improved if the data file being loaded is sorted according to the clustered index on the table.</span></span><br /><br /> <span data-ttu-id="1402b-191">**ROWS_PER_BATCH** = *bb*：每一批資料的資料列數目 (如 *bb*)。</span><span class="sxs-lookup"><span data-stu-id="1402b-191">**ROWS_PER_BATCH** = *bb*: Number of rows of data per batch (as *bb*).</span></span> <span data-ttu-id="1402b-192">伺服器根據 *bb*值，將大量載入最佳化。</span><span class="sxs-lookup"><span data-stu-id="1402b-192">The server optimizes the bulk load according to the value *bb*.</span></span> <span data-ttu-id="1402b-193">根據預設，**ROWS_PER_BATCH** 是未知的。</span><span class="sxs-lookup"><span data-stu-id="1402b-193">By default, **ROWS_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="1402b-194">**KILOBYTES_PER_BATCH** = *cc*：每一批資料的 KB 數目 (如 cc)。</span><span class="sxs-lookup"><span data-stu-id="1402b-194">**KILOBYTES_PER_BATCH** = *cc*: Number of kilobytes (KB) of data per batch (as cc).</span></span> <span data-ttu-id="1402b-195">根據預設，**KILOBYTES_PER_BATCH** 是未知的。</span><span class="sxs-lookup"><span data-stu-id="1402b-195">By default, **KILOBYTES_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="1402b-196">**TABLOCK**：在大量複製作業期間必須使用資料表層級鎖定。</span><span class="sxs-lookup"><span data-stu-id="1402b-196">**TABLOCK**: A table-level lock is acquired for the duration of the bulk copy operation.</span></span> <span data-ttu-id="1402b-197">這個選項會大幅提升效能，因為只在大量複製作業期間保留鎖定，會減少競爭資料表鎖定的情況。</span><span class="sxs-lookup"><span data-stu-id="1402b-197">This option significantly improves performance because holding a lock only for the duration of the bulk copy operation reduces lock contention on the table.</span></span> <span data-ttu-id="1402b-198">如果資料表沒有索引，且指定了 **TABLOCK**，多個用戶端便可以同時載入這份資料表。</span><span class="sxs-lookup"><span data-stu-id="1402b-198">A table can be loaded by multiple clients concurrently if the table has no indexes and **TABLOCK** is specified.</span></span> <span data-ttu-id="1402b-199">根據預設，鎖定行為由資料表選項 **table lock on bulk load** (大量載入時鎖定資料表) 來決定。</span><span class="sxs-lookup"><span data-stu-id="1402b-199">By default, the locking behavior is determined by the table option **table lock on bulk load**.</span></span><br /><br /> <span data-ttu-id="1402b-200">**CHECK_CONSTRAINTS**：在大量複製作業期間會檢查 *table_name* 上的任何條件約束。</span><span class="sxs-lookup"><span data-stu-id="1402b-200">**CHECK_CONSTRAINTS**: Any constraints on *table_name* are checked during the bulk copy operation.</span></span> <span data-ttu-id="1402b-201">依預設，會忽略條件約束。</span><span class="sxs-lookup"><span data-stu-id="1402b-201">By default, constraints are ignored.</span></span><br /><br /> <span data-ttu-id="1402b-202">**FIRE_TRIGGER**：[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 會將資料列版本設定用於觸發程序，並將資料列版本儲存在 **tempdb** 的版本存放區內。</span><span class="sxs-lookup"><span data-stu-id="1402b-202">**FIRE_TRIGGER**: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] uses row versioning for triggers and stores the row versions in the version store in **tempdb**.</span></span> <span data-ttu-id="1402b-203">因此，即使啟用了觸發程序，也可以使用記錄最佳化。</span><span class="sxs-lookup"><span data-stu-id="1402b-203">Therefore, bulk logging optimizations are available even when triggers are enabled.</span></span> <span data-ttu-id="1402b-204">在觸發程序啟用的情況下，您可能需要先擴充 **tempdb** 的大小，然後才能大量匯入具有大量資料列的批次。</span><span class="sxs-lookup"><span data-stu-id="1402b-204">Before bulk importing a batch with a large number of rows with triggers enabled, you may need to expand the size of **tempdb**.</span></span>|  
  
### <a name="using-file-based-bulk-copy-operations"></a><span data-ttu-id="1402b-205">使用以檔案為基礎的大量複製作業</span><span class="sxs-lookup"><span data-stu-id="1402b-205">Using File Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="1402b-206">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB 提供者會執行**IBCPSession**介面，以公開對以檔案為 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 基礎之大量複製作業的支援。</span><span class="sxs-lookup"><span data-stu-id="1402b-206">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IBCPSession** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] file-based bulk copy operations.</span></span> <span data-ttu-id="1402b-207">**IBCPSession** 介面會實作 [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md)、[IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md)、[IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md)、[IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md)[IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md)、[IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md)、[IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md) 和 [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md) 方法。</span><span class="sxs-lookup"><span data-stu-id="1402b-207">The **IBCPSession** interface implements the [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md), [IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md), [IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md), [IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md), [IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md), [IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md), [IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md), and [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md)methods.</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="1402b-208">SQL Server Native Client ODBC 驅動程式</span><span class="sxs-lookup"><span data-stu-id="1402b-208">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="1402b-209">對於屬於舊版 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ODBC 驅動程式的大量複製作業，[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC 驅動程式仍維持相同的支援。</span><span class="sxs-lookup"><span data-stu-id="1402b-209">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver maintains the same support for bulk copy operations that were part of previous versions of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ODBC driver.</span></span> <span data-ttu-id="1402b-210">如需有關使用 Native Client ODBC 驅動程式進行大量複製作業的詳細資訊 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ，請參閱[&#40;ODBC&#41;執行大量複製作業](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md)。</span><span class="sxs-lookup"><span data-stu-id="1402b-210">For information about bulk copy operations using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, see [Performing Bulk Copy Operations &#40;ODBC&#41;](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1402b-211">另請參閱</span><span class="sxs-lookup"><span data-stu-id="1402b-211">See Also</span></span>  
 <span data-ttu-id="1402b-212">[SQL Server Native Client 功能](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="1402b-212">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 <span data-ttu-id="1402b-213">[資料來源屬性 &#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="1402b-213">[Data Source Properties &#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span></span>  
 <span data-ttu-id="1402b-214">[資料的大量匯入及匯出 &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="1402b-214">[Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span></span>  
 <span data-ttu-id="1402b-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="1402b-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span></span>  
 <span data-ttu-id="1402b-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="1402b-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span></span>  
 <span data-ttu-id="1402b-217">[最佳化大量匯入效能](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span><span class="sxs-lookup"><span data-stu-id="1402b-217">[Optimizing Bulk Import Performance](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span></span>  
  
  
