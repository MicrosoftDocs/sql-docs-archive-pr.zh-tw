---
title: 日期和時間改善 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
ms.assetid: 9b1d0d9d-1f6e-4399-8f61-e23f9a486a7a
author: rothja
ms.author: jroth
ms.openlocfilehash: 94f3fb5c00c15912840c494d3a6f6b0b05ea7257
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87698092"
---
# <a name="date-and-time-improvements"></a><span data-ttu-id="f06b5-102">日期和時間改善</span><span class="sxs-lookup"><span data-stu-id="f06b5-102">Date and Time Improvements</span></span>
  <span data-ttu-id="f06b5-103">本主題描述 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 對 [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] 中所加入日期和時間資料類型的支援。</span><span class="sxs-lookup"><span data-stu-id="f06b5-103">This topic describes the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client support for the date and time data types that were added in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span></span>  
  
 <span data-ttu-id="f06b5-104">如需日期/時間改善的詳細資訊，請參閱[日期和時間改進 &#40;OLE DB&#41;](../../native-client-ole-db-date-time/date-and-time-improvements-ole-db.md)和[&#40;ODBC&#41;的日期和時間改善](../../native-client-odbc-date-time/date-and-time-improvements-odbc.md)。</span><span class="sxs-lookup"><span data-stu-id="f06b5-104">For more information about date/time improvements, see [Date and Time Improvements &#40;OLE DB&#41;](../../native-client-ole-db-date-time/date-and-time-improvements-ole-db.md) and [Date and Time Improvements &#40;ODBC&#41;](../../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span></span>  
  
 <span data-ttu-id="f06b5-105">如需示範這項功能之範例應用程式的詳細資訊，請參閱 [SQL Server 資料程式設計範例](https://msftdpprodsamples.codeplex.com/)。</span><span class="sxs-lookup"><span data-stu-id="f06b5-105">For information about sample applications that demonstrate this feature, see [SQL Server Data Programming Samples](https://msftdpprodsamples.codeplex.com/).</span></span>  
  
## <a name="usage"></a><span data-ttu-id="f06b5-106">使用量</span><span class="sxs-lookup"><span data-stu-id="f06b5-106">Usage</span></span>  
 <span data-ttu-id="f06b5-107">下列章節描述使用新日期和時間類型的各種方式。</span><span class="sxs-lookup"><span data-stu-id="f06b5-107">The following sections describe various ways of using the new date and time types.</span></span>  
  
### <a name="use-date-as-a-distinct-data-type"></a><span data-ttu-id="f06b5-108">將 Date 當做不同的資料類型使用</span><span class="sxs-lookup"><span data-stu-id="f06b5-108">Use Date as a Distinct Data Type</span></span>  
 <span data-ttu-id="f06b5-109">從 [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] 開始，對於日期/時間類型的增強支援讓使用 SQL_TYPE_DATE ODBC 類型 (適用於 ODBC 2.0 應用程式的 SQL_DATE) 和 DBTYPE_DBDATE OLE DB 類型更有效率。</span><span class="sxs-lookup"><span data-stu-id="f06b5-109">Beginning with [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)], enhanced support for date/time types makes it more efficient to use the SQL_TYPE_DATE ODBC type (SQL_DATE for ODBC 2.0 applications) and the DBTYPE_DBDATE OLE DB type.</span></span>  
  
### <a name="use-time-as-a-distinct-data-type"></a><span data-ttu-id="f06b5-110">將 Time 當做不同的資料類型使用</span><span class="sxs-lookup"><span data-stu-id="f06b5-110">Use Time as a Distinct Data Type</span></span>  
 <span data-ttu-id="f06b5-111">OLE DB 已經有只包含時間的資料類型 DBTYPE_DBTIME，其精確度為 1 秒。</span><span class="sxs-lookup"><span data-stu-id="f06b5-111">OLE DB already has a data type that just contains the time, DBTYPE_DBTIME, which has a precision of 1 second.</span></span> <span data-ttu-id="f06b5-112">在 ODBC 中，對等的類型為 SQL_TYPE_TIME (適用於 ODBC 2.0 應用程式的 SQL_TIME)。</span><span class="sxs-lookup"><span data-stu-id="f06b5-112">In ODBC, the equivalent type is SQL_TYPE_TIME (SQL_TIME for ODBC 2.0 applications).</span></span>  
  
 <span data-ttu-id="f06b5-113">新 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 時間資料類型的小數秒精確度為 100 奈秒。</span><span class="sxs-lookup"><span data-stu-id="f06b5-113">The new [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] time data type has fractional seconds accurate to 100 nanoseconds.</span></span> <span data-ttu-id="f06b5-114">這需要 Native Client 中的新類型 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ： DBTYPE_DBTIME2 (OLE DB) 和 SQL_SS_TIME2 (ODBC) 。</span><span class="sxs-lookup"><span data-stu-id="f06b5-114">This requires new types in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client: DBTYPE_DBTIME2 (OLE DB) and SQL_SS_TIME2 (ODBC).</span></span> <span data-ttu-id="f06b5-115">為使用不含小數秒的時間而撰寫的現有應用程式可以使用 time(0) 資料行。</span><span class="sxs-lookup"><span data-stu-id="f06b5-115">Existing applications written to use times with no fractional seconds can use time(0) columns.</span></span> <span data-ttu-id="f06b5-116">除非應用程式依賴中繼資料中所傳回的類型，否則現有的 OLE DB DBTYPE_TIME 和 ODBC SQL_TYPE_TIME 類型及其對應的結構應該正常運作。</span><span class="sxs-lookup"><span data-stu-id="f06b5-116">The existing OLE DB DBTYPE_TIME and ODBC SQL_TYPE_TIME types and their corresponding structs should work correctly, unless the applications rely on the type returned in metadata.</span></span>  
  
### <a name="use-time-as-a-distinct-data-type-with-extended-fractional-seconds-precision"></a><span data-ttu-id="f06b5-117">使用包含擴充小數秒精確度的 Time 做為不同的資料類型</span><span class="sxs-lookup"><span data-stu-id="f06b5-117">Use Time as a Distinct Data Type with Extended Fractional Seconds Precision</span></span>  
 <span data-ttu-id="f06b5-118">有些應用程式 (例如，處理序控制項和製造應用程式) 必須能夠處理精確度高達 100 奈秒的時間資料。</span><span class="sxs-lookup"><span data-stu-id="f06b5-118">Some applications, such as process control and manufacturing applications, require the ability to handle time data with a precision of up to 100 nanoseconds.</span></span> <span data-ttu-id="f06b5-119">基於此目的的新類型為 DBTYPE_DBTIME2 (OLE DB) 和 SQL_SS_TIME2 (ODBC)。</span><span class="sxs-lookup"><span data-stu-id="f06b5-119">New types for this purpose are DBTYPE_DBTIME2 (OLE DB) and SQL_SS_TIME2 (ODBC).</span></span>  
  
### <a name="use-datetime-with-extended-fractional-seconds-precision"></a><span data-ttu-id="f06b5-120">使用包含擴充小數秒精確度的 Datetime</span><span class="sxs-lookup"><span data-stu-id="f06b5-120">Use Datetime with Extended Fractional Seconds Precision</span></span>  
 <span data-ttu-id="f06b5-121">OLE DB 已經定義一個精確度高達 1 奈秒的類型。</span><span class="sxs-lookup"><span data-stu-id="f06b5-121">OLE DB already defines a type with a precision of up to 1 nanosecond.</span></span> <span data-ttu-id="f06b5-122">不過，此類型已由現有的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 應用程式所使用，而且此類應用程式的精確度應該只有一秒的 1/300。</span><span class="sxs-lookup"><span data-stu-id="f06b5-122">However, this type is already used by existing [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] applications and such applications have an expectation of only 1/300 of a second precision.</span></span> <span data-ttu-id="f06b5-123">新的 `datetime2(3)` 類型與現有的日期時間類型不直接相容。</span><span class="sxs-lookup"><span data-stu-id="f06b5-123">The new `datetime2(3)` type is not directly compatible with the existing datetime type.</span></span> <span data-ttu-id="f06b5-124">如果這有影響應用程式行為的風險，應用程式必須使用新的 DBCOLUMN 旗標來判斷實際的伺服器類型。</span><span class="sxs-lookup"><span data-stu-id="f06b5-124">If there is a risk that this will affect application behavior, applications must use a new DBCOLUMN flag to determine the actual server type.</span></span>  
  
 <span data-ttu-id="f06b5-125">ODBC 也已經定義一個精確度高達 1 奈秒的類型。</span><span class="sxs-lookup"><span data-stu-id="f06b5-125">ODBC also defines a type with a precision of up to 1 nanosecond.</span></span> <span data-ttu-id="f06b5-126">不過，此類型已由現有的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 應用程式所使用，而且此類應用程式的精確度應該只有 3 毫秒。</span><span class="sxs-lookup"><span data-stu-id="f06b5-126">However, this type is already used by existing [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] applications and such applications expect only 3 millisecond precision.</span></span> <span data-ttu-id="f06b5-127">新的 `datetime2(3)` 類型與現有的 `datetime` 類型不直接相容。</span><span class="sxs-lookup"><span data-stu-id="f06b5-127">The new `datetime2(3)` type is not  directly compatible with the existing `datetime` type.</span></span> <span data-ttu-id="f06b5-128">`datetime2(3)` 的精確度為 1 毫秒，而 `datetime` 的精確度為一秒的 1/300。</span><span class="sxs-lookup"><span data-stu-id="f06b5-128">`datetime2(3)` has a precision of one millisecond, and `datetime` has a precision of 1/300 of a second.</span></span> <span data-ttu-id="f06b5-129">在 ODBC 中，應用程式可以判斷正搭配描述項欄位 SQL_DESC_TYPE_NAME 使用的伺服器類型。</span><span class="sxs-lookup"><span data-stu-id="f06b5-129">In ODBC, applications can determine which server type is in use with the descriptor field SQL_DESC_TYPE_NAME.</span></span> <span data-ttu-id="f06b5-130">因此，現有的類型 SQL_TYPE_TIMESTAMP (適用於 ODBC 2.0 應用程式的 SQL_TIMESTAMP) 可同時用於兩種類型。</span><span class="sxs-lookup"><span data-stu-id="f06b5-130">Therefore, the existing type SQL_TYPE_TIMESTAMP (SQL_TIMESTAMP for ODBC 2.0 applications) can be used for both types.</span></span>  
  
### <a name="use-datetime-with-extended-fractional-seconds-precision-and-timezone"></a><span data-ttu-id="f06b5-131">使用包含擴充小數秒精確度和時區的 Datetime</span><span class="sxs-lookup"><span data-stu-id="f06b5-131">Use Datetime with Extended Fractional Seconds Precision and Timezone</span></span>  
 <span data-ttu-id="f06b5-132">某些應用程式需要包含時區資訊的日期時間值。</span><span class="sxs-lookup"><span data-stu-id="f06b5-132">Some applications require datetime values with timezone information.</span></span> <span data-ttu-id="f06b5-133">這受到新 DBTYPE_DBTIMESTAMPOFFSET (OLE DB) 和 SQL_SS_TIMESTAMPOFFSET (ODBC) 類型的支援。</span><span class="sxs-lookup"><span data-stu-id="f06b5-133">This is supported by the new DBTYPE_DBTIMESTAMPOFFSET (OLE DB) and SQL_SS_TIMESTAMPOFFSET (ODBC) types.</span></span>  
  
### <a name="use-datetimedatetimedatetimeoffset-data-with-client-side-conversions-consistent-with-existing-conversions"></a><span data-ttu-id="f06b5-134">搭配與現有轉換一致的用戶端轉換使用 Date/Time/Datetime/Datetimeoffset 資料</span><span class="sxs-lookup"><span data-stu-id="f06b5-134">Use Date/Time/Datetime/Datetimeoffset Data with Client-Side Conversions Consistent with Existing Conversions</span></span>  
 <span data-ttu-id="f06b5-135">ODBC 標準描述現有日期、時間和時間戳記類型之間的轉換如何運作。</span><span class="sxs-lookup"><span data-stu-id="f06b5-135">The ODBC standard describes how conversions between existing date, time, and timestamp types work.</span></span> <span data-ttu-id="f06b5-136">這些類型會以一致的方式擴充，以包含 [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] 中所推出之所有日期和時間類型之間的轉換。</span><span class="sxs-lookup"><span data-stu-id="f06b5-136">These are extended in a consistent manner to include conversions between all date and time types introduced in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f06b5-137">另請參閱</span><span class="sxs-lookup"><span data-stu-id="f06b5-137">See Also</span></span>  
 [<span data-ttu-id="f06b5-138">SQL Server Native Client 功能</span><span class="sxs-lookup"><span data-stu-id="f06b5-138">SQL Server Native Client Features</span></span>](sql-server-native-client-features.md)  
  
