---
title: 分析 ODBC 驅動程式效能 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- profiling ODBC driver performance data [SQL Server Native Client]
- performance [ODBC]
- application statistics [ODBC]
- time statistics [ODBC]
- ODBC, performance data
- SQL Server Native Client ODBC driver, profiling performance data
- SQLPERF data structure
- statistical information [ODBC]
ms.assetid: 8f44e194-d556-4119-a759-4c9dec7ecead
author: rothja
ms.author: jroth
ms.openlocfilehash: 91373d22b845dd0abb1263b7fa367b4bf3bff42e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87593355"
---
# <a name="profiling-odbc-driver-performance"></a><span data-ttu-id="ba63d-102">分析 ODBC 驅動程式效能</span><span class="sxs-lookup"><span data-stu-id="ba63d-102">Profiling ODBC Driver Performance</span></span>
  <span data-ttu-id="ba63d-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC 驅動程式可以分析兩種類型的效能資料：</span><span class="sxs-lookup"><span data-stu-id="ba63d-103">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver can profile two types of performance data:</span></span>  
  
-   <span data-ttu-id="ba63d-104">長時間執行的查詢。</span><span class="sxs-lookup"><span data-stu-id="ba63d-104">Long-running queries.</span></span>  
  
     <span data-ttu-id="ba63d-105">驅動程式可以將指定時間內，沒有從伺服器取得回應的任何查詢寫入記錄檔中。</span><span class="sxs-lookup"><span data-stu-id="ba63d-105">The driver can write to a log file any query that does not get a response from the server within a specified amount of time.</span></span> <span data-ttu-id="ba63d-106">接著，應用程式的程式設計師或資料庫管理員可以研究每個記錄的 SQL 陳述式來決定改善其效能的方式。</span><span class="sxs-lookup"><span data-stu-id="ba63d-106">Application programmers or database administrators can then research each logged SQL statement to determine how they can improve its performance.</span></span>  
  
-   <span data-ttu-id="ba63d-107">驅動程式效能資料。</span><span class="sxs-lookup"><span data-stu-id="ba63d-107">Driver-performance data.</span></span>  
  
     <span data-ttu-id="ba63d-108">驅動程式可以記錄效能統計資料，然後將其寫入檔案中，或透過名稱為 SQLPERF 的驅動程式專屬資料結構，提供給應用程式。</span><span class="sxs-lookup"><span data-stu-id="ba63d-108">The driver can record performance statistics and either write them to a file or make them available to an application through a driver-specific data structure named SQLPERF.</span></span> <span data-ttu-id="ba63d-109">包含效能統計資料的檔案是一個以 Tab 分隔的檔案，可以利用支援以 Tab 分隔之檔案的任何試算表 (例如，Microsoft Excel) 輕鬆進行分析。</span><span class="sxs-lookup"><span data-stu-id="ba63d-109">The file containing the performance statistics is a tab-delimited file that can be easily analyzed with any spreadsheet that supports tab-delimited files, such as Microsoft Excel.</span></span>  
  
 <span data-ttu-id="ba63d-110">每種分析類型都可以透過下列方式開啟：</span><span class="sxs-lookup"><span data-stu-id="ba63d-110">Either type of profiling can be turned on by:</span></span>  
  
-   <span data-ttu-id="ba63d-111">連接至指定記錄的資料來源。</span><span class="sxs-lookup"><span data-stu-id="ba63d-111">Connecting to a data source that specifies logging.</span></span>  
  
-   <span data-ttu-id="ba63d-112">呼叫[SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md)來設定控制分析的驅動程式特定屬性。</span><span class="sxs-lookup"><span data-stu-id="ba63d-112">Calling [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to set driver-specific attributes that control profiling.</span></span>  
  
 <span data-ttu-id="ba63d-113">每個應用程式處理序都可以取得自己的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC 驅動程式複本，而且分析通用於驅動程式複本和應用程式處理序的組合。</span><span class="sxs-lookup"><span data-stu-id="ba63d-113">Each application process gets its own copy of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, and profiling is global to the combination of a driver copy and an application process.</span></span> <span data-ttu-id="ba63d-114">當應用程式中的任何項目開啟分析時，分析會記錄來自該應用程式的驅動程式中，所有作用中連接的資訊。</span><span class="sxs-lookup"><span data-stu-id="ba63d-114">When anything in the application turns on profiling, profiling records information for all connections active in the driver from that application.</span></span> <span data-ttu-id="ba63d-115">甚至是沒有特別針對分析呼叫的連接也包含在內。</span><span class="sxs-lookup"><span data-stu-id="ba63d-115">Even connections that did not specifically call for profiling are included.</span></span>  
  
 <span data-ttu-id="ba63d-116">驅動程式開啟分析記錄 (效能資料或長時間執行的查詢記錄) 後，如果應用程式釋放它在驅動程式中開啟的所有環境控制代碼，它不會關閉記錄，直到 ODBC 驅動程式管理員卸載該驅動程式為止。</span><span class="sxs-lookup"><span data-stu-id="ba63d-116">After the driver has opened a profiling log (either the performance data or long-running query log), it does not close the log until the driver is unloaded by the ODBC Driver Manager, when an application frees all the environment handles it opened in the driver.</span></span> <span data-ttu-id="ba63d-117">如果應用程式開啟一個新的環境控制代碼，就會載入驅動程式的新複本。</span><span class="sxs-lookup"><span data-stu-id="ba63d-117">If the application opens a new environment handle, a new copy of the driver is loaded.</span></span> <span data-ttu-id="ba63d-118">如果應用程式接著連接到指定相同記錄檔的資料來源，或將驅動程式專屬屬性設定為記錄到相同的檔案，驅動程式就會覆寫舊的記錄。</span><span class="sxs-lookup"><span data-stu-id="ba63d-118">If the application then either connects to a data source that specifies the same log file or sets the driver-specific attributes to log to the same file, the driver overwrites the old log.</span></span>  
  
 <span data-ttu-id="ba63d-119">如果應用程式開始記錄檔的分析，而且有另一個應用程式嘗試開始相同記錄檔的分析，則第二個應用程式無法記錄任何分析資料。</span><span class="sxs-lookup"><span data-stu-id="ba63d-119">If an application starts profiling to a log file and a second application attempts to start profiling to the same log file, the second application is not able to log any profiling data.</span></span> <span data-ttu-id="ba63d-120">如果第二個應用程式在第一個應用程式卸載其驅動程式後開始分析，第二個應用程式會覆寫來自第一個應用程式的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="ba63d-120">If the second application starts profiling after the first application has unloaded its driver, the second application overwrites the log file from the first application.</span></span>  
  
 <span data-ttu-id="ba63d-121">如果應用程式連接到已啟用分析的資料來源，則如果應用程式呼叫**SQLSetConnectOption**來開始記錄，驅動程式會傳回 SQL_ERROR。</span><span class="sxs-lookup"><span data-stu-id="ba63d-121">If an application connects to a data source that has profiling enabled, the driver returns SQL_ERROR if the application calls **SQLSetConnectOption** to start logging.</span></span> <span data-ttu-id="ba63d-122">呼叫**SQLGetDiagRec**之後，會傳回下列內容：</span><span class="sxs-lookup"><span data-stu-id="ba63d-122">A call to **SQLGetDiagRec** then returns the following:</span></span>  
  
```  
SQLState: 01000, pfNative = 0  
ErrorMsg: [Microsoft][SQL Server Native Client]  
   An error has occurred during the attempt to access  
   the log file, logging disabled.  
```  
  
 <span data-ttu-id="ba63d-123">當環境控制代碼關閉時，驅動程式會停止蒐集效能資料。</span><span class="sxs-lookup"><span data-stu-id="ba63d-123">The driver stops gathering performance data when an environment handle is closed.</span></span> <span data-ttu-id="ba63d-124">如果 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 應用程式有多個連接，而且每個連接都有自己的環境控制代碼，當任何相關聯的環境控制代碼關閉時，驅動程式將會停止蒐集效能資料。</span><span class="sxs-lookup"><span data-stu-id="ba63d-124">If an [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client application has multiple connections, each with its own environment handle, then the driver will stop gathering performance data when any of the associated environment handles are closed.</span></span>  
  
 <span data-ttu-id="ba63d-125">驅動程式的效能資料可以儲存在 SQLPERF 資料結構中，也可以記錄到以 Tab 分隔的檔案中。</span><span class="sxs-lookup"><span data-stu-id="ba63d-125">The driver's performance data can either be stored in the SQLPERF data structure or logged in a tab-delimited file.</span></span> <span data-ttu-id="ba63d-126">此資料包括下列類別的統計資料：</span><span class="sxs-lookup"><span data-stu-id="ba63d-126">The data includes the following categories of statistics:</span></span>  
  
-   <span data-ttu-id="ba63d-127">應用程式設定檔</span><span class="sxs-lookup"><span data-stu-id="ba63d-127">Application profile</span></span>  
  
-   <span data-ttu-id="ba63d-128">Connection</span><span class="sxs-lookup"><span data-stu-id="ba63d-128">Connection</span></span>  
  
-   <span data-ttu-id="ba63d-129">網路</span><span class="sxs-lookup"><span data-stu-id="ba63d-129">Network</span></span>  
  
-   <span data-ttu-id="ba63d-130">Time</span><span class="sxs-lookup"><span data-stu-id="ba63d-130">Time</span></span>  
  
 <span data-ttu-id="ba63d-131">在下表中，SQLPERF 資料結構內的欄位描述也會套用到效能記錄檔中記錄的統計資料。</span><span class="sxs-lookup"><span data-stu-id="ba63d-131">In the following table, the descriptions of the fields in the SQLPERF data structure also apply to the statistics recorded in the performance log file.</span></span>  
  
### <a name="application-profile-statistics"></a><span data-ttu-id="ba63d-132">應用程式設定檔統計資料</span><span class="sxs-lookup"><span data-stu-id="ba63d-132">Application Profile Statistics</span></span>  
  
|<span data-ttu-id="ba63d-133">SQLPERF 欄位</span><span class="sxs-lookup"><span data-stu-id="ba63d-133">SQLPERF field</span></span>|<span data-ttu-id="ba63d-134">描述</span><span class="sxs-lookup"><span data-stu-id="ba63d-134">Description</span></span>|  
|-------------------|-----------------|  
|<span data-ttu-id="ba63d-135">TimerResolution</span><span class="sxs-lookup"><span data-stu-id="ba63d-135">TimerResolution</span></span>|<span data-ttu-id="ba63d-136">伺服器時間的最小解析 (以毫秒為單位)。</span><span class="sxs-lookup"><span data-stu-id="ba63d-136">Minimum resolution of the server's clock time in milliseconds.</span></span> <span data-ttu-id="ba63d-137">這通常會報告為 0 (零)，而且只有在報告的數字很大時，才考慮使用。</span><span class="sxs-lookup"><span data-stu-id="ba63d-137">This is usually reported as 0 (zero) and should only be considered if the number reported is large.</span></span> <span data-ttu-id="ba63d-138">如果伺服器時間的最小解析大於某些以計時器為基礎之統計資料的可能間隔，這些統計資料可能會擴大。</span><span class="sxs-lookup"><span data-stu-id="ba63d-138">If the minimum resolution of the server clock is larger than the likely interval for some of the timer-based statistics, those statistics could be inflated.</span></span>|  
|<span data-ttu-id="ba63d-139">SQLidu</span><span class="sxs-lookup"><span data-stu-id="ba63d-139">SQLidu</span></span>|<span data-ttu-id="ba63d-140">SQL_PERF_START 之後的 INSERT、DELETE 或 UPDATE 陳述式數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-140">Number of INSERT, DELETE, or UPDATE statements after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="ba63d-141">SQLiduRows</span><span class="sxs-lookup"><span data-stu-id="ba63d-141">SQLiduRows</span></span>|<span data-ttu-id="ba63d-142">SQL_PERF_START 之後的 INSERT、DELETE 或 UPDATE 陳述式數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-142">Number of INSERT, DELETE, or UPDATE statements after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="ba63d-143">SQLSelects</span><span class="sxs-lookup"><span data-stu-id="ba63d-143">SQLSelects</span></span>|<span data-ttu-id="ba63d-144">在 SQL_PERF_START 之後處理的 SELECT 陳述式數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-144">Number of SELECT statements processed after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="ba63d-145">SQLSelectRows</span><span class="sxs-lookup"><span data-stu-id="ba63d-145">SQLSelectRows</span></span>|<span data-ttu-id="ba63d-146">在 SQL_PERF_START 之後選取的資料列數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-146">Number of rows selected after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="ba63d-147">異動</span><span class="sxs-lookup"><span data-stu-id="ba63d-147">Transactions</span></span>|<span data-ttu-id="ba63d-148">SQL_PERF_START 之後的使用者交易數目，包括回復。</span><span class="sxs-lookup"><span data-stu-id="ba63d-148">Number of user transactions after SQL_PERF_START, including rollbacks.</span></span> <span data-ttu-id="ba63d-149">當 ODBC 應用程式使用 SQL_AUTOCOMMIT_ON 執行時，會將每個命令視為交易。</span><span class="sxs-lookup"><span data-stu-id="ba63d-149">When an ODBC application is running with SQL_AUTOCOMMIT_ON, each command is considered a transaction.</span></span>|  
|<span data-ttu-id="ba63d-150">SQLPrepares</span><span class="sxs-lookup"><span data-stu-id="ba63d-150">SQLPrepares</span></span>|<span data-ttu-id="ba63d-151">SQL_PERF_START 之後的[SQLPrepare 函數](https://go.microsoft.com/fwlink/?LinkId=59360)調用數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-151">Number of [SQLPrepare Function](https://go.microsoft.com/fwlink/?LinkId=59360) calls after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="ba63d-152">ExecDirects</span><span class="sxs-lookup"><span data-stu-id="ba63d-152">ExecDirects</span></span>|<span data-ttu-id="ba63d-153">SQL_PERF_START 之後的**SQLExecDirect**呼叫數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-153">Number of **SQLExecDirect** calls after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="ba63d-154">SQLExecutes</span><span class="sxs-lookup"><span data-stu-id="ba63d-154">SQLExecutes</span></span>|<span data-ttu-id="ba63d-155">SQL_PERF_START 之後的**SQLExecute**呼叫數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-155">Number of **SQLExecute** calls after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="ba63d-156">CursorOpens</span><span class="sxs-lookup"><span data-stu-id="ba63d-156">CursorOpens</span></span>|<span data-ttu-id="ba63d-157">驅動程式在 SQL_PERF_START 之後已經開啟伺服器資料指標的次數。</span><span class="sxs-lookup"><span data-stu-id="ba63d-157">Number of times the driver has opened a server cursor after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="ba63d-158">CursorSize</span><span class="sxs-lookup"><span data-stu-id="ba63d-158">CursorSize</span></span>|<span data-ttu-id="ba63d-159">在 SQL_PERF_START 之後，資料指標開啟之結果集中的資料列數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-159">Number of rows in the result sets opened by cursors after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="ba63d-160">CursorUsed</span><span class="sxs-lookup"><span data-stu-id="ba63d-160">CursorUsed</span></span>|<span data-ttu-id="ba63d-161">在 SQL_PERF_START 之後，透過驅動程式從資料指標實際擷取的資料列數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-161">Number of rows actually retrieved through the driver from cursors after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="ba63d-162">PercentCursorUsed</span><span class="sxs-lookup"><span data-stu-id="ba63d-162">PercentCursorUsed</span></span>|<span data-ttu-id="ba63d-163">等於 CursorUsed/CursorSize。</span><span class="sxs-lookup"><span data-stu-id="ba63d-163">Equals CursorUsed/CursorSize.</span></span> <span data-ttu-id="ba63d-164">例如，如果應用程式使驅動程式開啟伺服器資料指標來執行 "SELECT COUNT(\*) FROM Authors"，SELECT 陳述式的結果集中將有 23 個資料列。</span><span class="sxs-lookup"><span data-stu-id="ba63d-164">For example, if an application causes the driver to open a server cursor to do "SELECT COUNT(\*) FROM Authors," 23 rows will be in the result set for the SELECT statement.</span></span> <span data-ttu-id="ba63d-165">接著，如果應用程式只提取其中三個資料列，CursorUsed/CursorSize 為 3/23，因此 PercentCursorUsed 為 13.043478。</span><span class="sxs-lookup"><span data-stu-id="ba63d-165">If the application then fetches only three of these rows, CursorUsed/CursorSize is 3/23, so PercentCursorUsed is 13.043478.</span></span>|  
|<span data-ttu-id="ba63d-166">AvgFetchTime</span><span class="sxs-lookup"><span data-stu-id="ba63d-166">AvgFetchTime</span></span>|<span data-ttu-id="ba63d-167">等於 SQLFetchTime/SQLFetchCount。</span><span class="sxs-lookup"><span data-stu-id="ba63d-167">Equals SQLFetchTime/SQLFetchCount.</span></span>|  
|<span data-ttu-id="ba63d-168">AvgCursorSize</span><span class="sxs-lookup"><span data-stu-id="ba63d-168">AvgCursorSize</span></span>|<span data-ttu-id="ba63d-169">等於 CursorSize/CursorOpens。</span><span class="sxs-lookup"><span data-stu-id="ba63d-169">Equals CursorSize/CursorOpens.</span></span>|  
|<span data-ttu-id="ba63d-170">AvgCursorUsed</span><span class="sxs-lookup"><span data-stu-id="ba63d-170">AvgCursorUsed</span></span>|<span data-ttu-id="ba63d-171">等於 CursorUsed/CursorOpens。</span><span class="sxs-lookup"><span data-stu-id="ba63d-171">Equals CursorUsed/CursorOpens.</span></span>|  
|<span data-ttu-id="ba63d-172">SQLFetchTime</span><span class="sxs-lookup"><span data-stu-id="ba63d-172">SQLFetchTime</span></span>|<span data-ttu-id="ba63d-173">根據伺服器資料指標完成提取所需的累計時間。</span><span class="sxs-lookup"><span data-stu-id="ba63d-173">Cumulative amount of time it took fetches against server cursors to complete.</span></span>|  
|<span data-ttu-id="ba63d-174">SQLFetchCount</span><span class="sxs-lookup"><span data-stu-id="ba63d-174">SQLFetchCount</span></span>|<span data-ttu-id="ba63d-175">在 SQL_PERF_START 之後，根據伺服器資料指標完成的提取數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-175">Number of fetches done against server cursors after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="ba63d-176">CurrentStmtCount</span><span class="sxs-lookup"><span data-stu-id="ba63d-176">CurrentStmtCount</span></span>|<span data-ttu-id="ba63d-177">目前在驅動程式中開啟的所有連接上開啟的陳述式控制代碼數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-177">Number of statement handles currently open on all connections open in the driver.</span></span>|  
|<span data-ttu-id="ba63d-178">MaxOpenStmt</span><span class="sxs-lookup"><span data-stu-id="ba63d-178">MaxOpenStmt</span></span>|<span data-ttu-id="ba63d-179">在 SQL_PERF_START 之後，同時開啟之陳述式控制代碼的最大數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-179">Maximum number of concurrently opened statement handles after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="ba63d-180">SumOpenStmt</span><span class="sxs-lookup"><span data-stu-id="ba63d-180">SumOpenStmt</span></span>|<span data-ttu-id="ba63d-181">在 SQL_PERF_START 之後，已經開啟之陳述式控制代碼的數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-181">Number of statement handles that have been opened after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="ba63d-182">**連接統計資料**</span><span class="sxs-lookup"><span data-stu-id="ba63d-182">**Connection Statistics:**</span></span>||  
|<span data-ttu-id="ba63d-183">CurrentConnectionCount</span><span class="sxs-lookup"><span data-stu-id="ba63d-183">CurrentConnectionCount</span></span>|<span data-ttu-id="ba63d-184">應用程式已經在伺服器上開啟之作用中連接控制代碼的目前數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-184">Current number of active connection handles the application has open to the server.</span></span>|  
|<span data-ttu-id="ba63d-185">MaxConnectionsOpened</span><span class="sxs-lookup"><span data-stu-id="ba63d-185">MaxConnectionsOpened</span></span>|<span data-ttu-id="ba63d-186">在 SQL_PERF_START 之後開啟之並行連接控制代碼的最大數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-186">Maximum number of concurrent connection handles opened after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="ba63d-187">SumConnectionsOpened</span><span class="sxs-lookup"><span data-stu-id="ba63d-187">SumConnectionsOpened</span></span>|<span data-ttu-id="ba63d-188">在 SQL_PERF_START 之後，已經開啟之連接控制代碼的數目總和。</span><span class="sxs-lookup"><span data-stu-id="ba63d-188">Sum of the number of connection handles that have been opened after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="ba63d-189">SumConnectionTime</span><span class="sxs-lookup"><span data-stu-id="ba63d-189">SumConnectionTime</span></span>|<span data-ttu-id="ba63d-190">在 SQL_PERF_START 之後，已經開啟之所有連接的時間總和。</span><span class="sxs-lookup"><span data-stu-id="ba63d-190">Sum of the amount of time that all of the connections have been opened after SQL_PERF_START.</span></span> <span data-ttu-id="ba63d-191">例如，如果應用程式開啟 10 個連接，而且每個連接維持 5 秒鐘，則 SumConnectionTime 為 50 秒。</span><span class="sxs-lookup"><span data-stu-id="ba63d-191">For example, if an application opened 10 connections and maintained each connection for 5 seconds, then SumConnectionTime would be 50 seconds.</span></span>|  
|<span data-ttu-id="ba63d-192">AvgTimeOpened</span><span class="sxs-lookup"><span data-stu-id="ba63d-192">AvgTimeOpened</span></span>|<span data-ttu-id="ba63d-193">等於 SumConnectionsOpened/SumConnectionTime。</span><span class="sxs-lookup"><span data-stu-id="ba63d-193">Equals SumConnectionsOpened/ SumConnectionTime.</span></span>|  
|<span data-ttu-id="ba63d-194">**網路統計資料：**</span><span class="sxs-lookup"><span data-stu-id="ba63d-194">**Network Statistics:**</span></span>||  
|<span data-ttu-id="ba63d-195">ServerRndTrips</span><span class="sxs-lookup"><span data-stu-id="ba63d-195">ServerRndTrips</span></span>|<span data-ttu-id="ba63d-196">驅動程式將命令傳送到伺服器並得到回覆的次數。</span><span class="sxs-lookup"><span data-stu-id="ba63d-196">The number of times the driver sent commands to the server and got a reply back.</span></span>|  
|<span data-ttu-id="ba63d-197">BuffersSent</span><span class="sxs-lookup"><span data-stu-id="ba63d-197">BuffersSent</span></span>|<span data-ttu-id="ba63d-198">SQL_PERF_START 之後，驅動程式傳送到 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的表格式資料流 (TDS) 封包數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-198">Number of Tabular Data Stream (TDS) packets sent to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] by the driver after SQL_PERF_START.</span></span> <span data-ttu-id="ba63d-199">大型命令可以佔用多個緩衝區，因此，如果將大型命令傳送到伺服器，而且填滿六個封包，ServerRndTrips 會以 1 遞增，而 BuffersSent 則會以 6 遞增。</span><span class="sxs-lookup"><span data-stu-id="ba63d-199">Large commands can take multiple buffers, so if a large command is sent to the server and it fills six packets, ServerRndTrips is incremented by one and BuffersSent is incremented by six.</span></span>|  
|<span data-ttu-id="ba63d-200">BuffersRec</span><span class="sxs-lookup"><span data-stu-id="ba63d-200">BuffersRec</span></span>|<span data-ttu-id="ba63d-201">應用程式使用驅動程式啟動後，從 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 之驅動程式接收的 TDS 封包數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-201">Number of TDS packets received by the driver from [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] after the application started using the driver.</span></span>|  
|<span data-ttu-id="ba63d-202">BytesSent</span><span class="sxs-lookup"><span data-stu-id="ba63d-202">BytesSent</span></span>|<span data-ttu-id="ba63d-203">應用程式使用驅動程式啟動後，以 TDS 封包將資料傳送到 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的位元組數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-203">Number of bytes of data sent to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] in TDS packets after the application started using the driver.</span></span>|  
|<span data-ttu-id="ba63d-204">BytesRec</span><span class="sxs-lookup"><span data-stu-id="ba63d-204">BytesRec</span></span>|<span data-ttu-id="ba63d-205">應用程式使用驅動程式啟動後，從 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 之驅動程式接收的 TDS 封包資料位元組數目。</span><span class="sxs-lookup"><span data-stu-id="ba63d-205">Number of bytes of data in TDS packets received by the driver from [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] after the application started using the driver.</span></span>|  
  
### <a name="time-statistics"></a><span data-ttu-id="ba63d-206">時間統計資料</span><span class="sxs-lookup"><span data-stu-id="ba63d-206">Time Statistics</span></span>  
  
|<span data-ttu-id="ba63d-207">SQLPERF 欄位</span><span class="sxs-lookup"><span data-stu-id="ba63d-207">SQLPERF Field</span></span>|<span data-ttu-id="ba63d-208">描述</span><span class="sxs-lookup"><span data-stu-id="ba63d-208">Description</span></span>|  
|-------------------|-----------------|  
|<span data-ttu-id="ba63d-209">msExecutionTime</span><span class="sxs-lookup"><span data-stu-id="ba63d-209">msExecutionTime</span></span>|<span data-ttu-id="ba63d-210">驅動程式在 SQL_PERF_START 之後，花在處理上的累計時間，包括花在等待伺服器回覆的時間。</span><span class="sxs-lookup"><span data-stu-id="ba63d-210">Cumulative amount of time the driver spent processing after SQL_PERF_START, including the time spent waiting for replies from the server.</span></span>|  
|<span data-ttu-id="ba63d-211">msNetworkServerTime</span><span class="sxs-lookup"><span data-stu-id="ba63d-211">msNetworkServerTime</span></span>|<span data-ttu-id="ba63d-212">驅動程式花在等待伺服器回覆的累計時間。</span><span class="sxs-lookup"><span data-stu-id="ba63d-212">Cumulative amount of time the driver spent waiting for replies from the server.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="ba63d-213">另請參閱</span><span class="sxs-lookup"><span data-stu-id="ba63d-213">See Also</span></span>  
 <span data-ttu-id="ba63d-214">[SQL Server Native Client &#40;ODBC&#41;](sql-server-native-client-odbc.md) </span><span class="sxs-lookup"><span data-stu-id="ba63d-214">[SQL Server Native Client &#40;ODBC&#41;](sql-server-native-client-odbc.md) </span></span>  
 [<span data-ttu-id="ba63d-215">分析 ODBC 驅動程式效能的使用說明主題 &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="ba63d-215">Profiling ODBC Driver Performance How-to Topics &#40;ODBC&#41;</span></span>](../../native-client-odbc-how-to/profiling-odbc-driver-performance-odbc.md)  
  
  
