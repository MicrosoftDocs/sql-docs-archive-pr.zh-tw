---
title: 大型 CLR 使用者定義型別 (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- large CLR user-defined types [OLE DB]
ms.assetid: 4bf12058-0534-42ca-a5ba-b1c23b24d90f
author: rothja
ms.author: jroth
ms.openlocfilehash: 62384b2be5fda767ba306c0e9321fd27b8239f10
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87698071"
---
# <a name="large-clr-user-defined-types-ole-db"></a><span data-ttu-id="1e209-102">大型 CLR 使用者定義型別 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="1e209-102">Large CLR User-Defined Types (OLE DB)</span></span>
  <span data-ttu-id="1e209-103">本主題討論 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 中 OLE DB 的變更，以支援大型 Common Language Runtime (CLR) 使用者定義型別 (UDT)。</span><span class="sxs-lookup"><span data-stu-id="1e209-103">This topic discusses the changes to OLE DB in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to support large common language runtime (CLR) user-defined types (UDTs).</span></span>  
  
 <span data-ttu-id="1e209-104">如需 Native Client 中大型 CLR Udt 支援的詳細資訊 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ，請參閱[大型 Clr 使用者定義類型](../../clr-integration-database-objects-user-defined-types/clr-user-defined-types.md)。</span><span class="sxs-lookup"><span data-stu-id="1e209-104">For more information about support for large CLR UDTs in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [Large CLR User-Defined Types](../../clr-integration-database-objects-user-defined-types/clr-user-defined-types.md).</span></span> <span data-ttu-id="1e209-105">如需範例，請參閱[使用大型 CLR UDT &#40;OLE DB&#41;](../../native-client-ole-db-how-to/use-large-clr-udts-ole-db.md)。</span><span class="sxs-lookup"><span data-stu-id="1e209-105">For a sample, see [Use Large CLR UDTs &#40;OLE DB&#41;](../../native-client-ole-db-how-to/use-large-clr-udts-ole-db.md).</span></span>  
  
## <a name="data-format"></a><span data-ttu-id="1e209-106">資料格式</span><span class="sxs-lookup"><span data-stu-id="1e209-106">Data Format</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="1e209-107">Native Client 使用 ~0 來代表大型物件 (LOB) 類型的無限制大小的值長度。</span><span class="sxs-lookup"><span data-stu-id="1e209-107">Native Client uses ~0 to represent the length of values that are of unlimited size for large object (LOB) types.</span></span> <span data-ttu-id="1e209-108">~0 也代表大於 8,000 個位元組的 CLR UDT 大小。</span><span class="sxs-lookup"><span data-stu-id="1e209-108">~0 also represents the size of CLR UDTs that are larger than 8,000 bytes.</span></span>  
  
 <span data-ttu-id="1e209-109">下表顯示參數和資料列集內的資料類型對應：</span><span class="sxs-lookup"><span data-stu-id="1e209-109">The following table shows data type mapping in parameters and rowsets:</span></span>  
  
|<span data-ttu-id="1e209-110">SQL Server 資料類型</span><span class="sxs-lookup"><span data-stu-id="1e209-110">SQL Server data type</span></span>|<span data-ttu-id="1e209-111">OLE DB 資料類型</span><span class="sxs-lookup"><span data-stu-id="1e209-111">OLE DB data type</span></span>|<span data-ttu-id="1e209-112">記憶體配置</span><span class="sxs-lookup"><span data-stu-id="1e209-112">Memory layout</span></span>|<span data-ttu-id="1e209-113">值</span><span class="sxs-lookup"><span data-stu-id="1e209-113">Value</span></span>|  
|--------------------------|----------------------|-------------------|-----------|  
|<span data-ttu-id="1e209-114">CLR UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-114">CLR UDT</span></span>|<span data-ttu-id="1e209-115">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-115">DBTYPE_UDT</span></span>|<span data-ttu-id="1e209-116">BYTE[](位元組陣列\)</span><span class="sxs-lookup"><span data-stu-id="1e209-116">BYTE[](byte array\)</span></span>|<span data-ttu-id="1e209-117">132 (oledb.h)</span><span class="sxs-lookup"><span data-stu-id="1e209-117">132 (oledb.h)</span></span>|  
  
 <span data-ttu-id="1e209-118">UDT 值會表示為位元組陣列。</span><span class="sxs-lookup"><span data-stu-id="1e209-118">UDT values are represented as byte arrays.</span></span> <span data-ttu-id="1e209-119">支援與十六進位字串之間的來回轉換。</span><span class="sxs-lookup"><span data-stu-id="1e209-119">Conversions to and from hex strings are supported.</span></span> <span data-ttu-id="1e209-120">常值會表示為具有 "0x" 前置詞的十六進位字串。</span><span class="sxs-lookup"><span data-stu-id="1e209-120">Literal values are represented as hex strings with a prefix of "0x".</span></span> <span data-ttu-id="1e209-121">十六進位字串是基底 16 的二進位資料文字表示法。</span><span class="sxs-lookup"><span data-stu-id="1e209-121">A hex string is the textual representation of binary data in base 16.</span></span> <span data-ttu-id="1e209-122">從伺服器類型 `varbinary(10)` 轉換成 DBTYPE_STR 即為此類範例，這項作業會得出 20 個字元的十六進位表示，其中每一組字元都代表單一位元組。</span><span class="sxs-lookup"><span data-stu-id="1e209-122">A example is a conversion from server type `varbinary(10)` to DBTYPE_STR, which results in hexadecimal representation of 20 characters where every pair of characters represents a single byte.</span></span>  
  
## <a name="parameter-properties"></a><span data-ttu-id="1e209-123">參數屬性</span><span class="sxs-lookup"><span data-stu-id="1e209-123">Parameter Properties</span></span>  
 <span data-ttu-id="1e209-124">DBPROPSET_SQLSERVERPARAMETER 屬性集會透過 OLE DB 支援 UDT。</span><span class="sxs-lookup"><span data-stu-id="1e209-124">The DBPROPSET_SQLSERVERPARAMETER property set supports UDTs through OLE DB.</span></span> <span data-ttu-id="1e209-125">如需詳細資訊，請參閱[使用使用者定義型別](../features/using-user-defined-types.md)。</span><span class="sxs-lookup"><span data-stu-id="1e209-125">For more information, see [Using User-Defined Types](../features/using-user-defined-types.md).</span></span>  
  
## <a name="column-properties"></a><span data-ttu-id="1e209-126">資料行屬性</span><span class="sxs-lookup"><span data-stu-id="1e209-126">Column Properties</span></span>  
 <span data-ttu-id="1e209-127">DBPROPSET_SQLSERVERCOLUMN 屬性集會透過 OLE DB 支援資料表的建立。</span><span class="sxs-lookup"><span data-stu-id="1e209-127">The DBPROPSET_SQLSERVERCOLUMN property set supports the creation of tables through OLE DB.</span></span> <span data-ttu-id="1e209-128">如需詳細資訊，請參閱[使用使用者定義型別](../features/using-user-defined-types.md)。</span><span class="sxs-lookup"><span data-stu-id="1e209-128">For more information, see [Using User-Defined Types](../features/using-user-defined-types.md).</span></span>  
  
## <a name="data-type-mapping-in-itabledefinitioncreatetable"></a><span data-ttu-id="1e209-129">ITableDefinition::CreateTable 中的資料類型對應</span><span class="sxs-lookup"><span data-stu-id="1e209-129">Data Type Mapping in ITableDefinition::CreateTable</span></span>  
 <span data-ttu-id="1e209-130">當需要 UDT 資料行時，下列資訊會用於 `DBCOLUMNDESC` ITableDefinition：： CreateTable 所使用的結構中：</span><span class="sxs-lookup"><span data-stu-id="1e209-130">The following information is used in `DBCOLUMNDESC` structures used by ITableDefinition::CreateTable when UDT columns are required:</span></span>  
  
|<span data-ttu-id="1e209-131">OLE DB 資料類型 (*wType*)</span><span class="sxs-lookup"><span data-stu-id="1e209-131">OLE DB data type (*wType*)</span></span>|<span data-ttu-id="1e209-132">*pwszTypeName*</span><span class="sxs-lookup"><span data-stu-id="1e209-132">*pwszTypeName*</span></span>|<span data-ttu-id="1e209-133">SQL Server 資料類型</span><span class="sxs-lookup"><span data-stu-id="1e209-133">SQL Server data type</span></span>|<span data-ttu-id="1e209-134">*rgPropertySets*</span><span class="sxs-lookup"><span data-stu-id="1e209-134">*rgPropertySets*</span></span>|  
|----------------------------------|--------------------|--------------------------|----------------------|  
|<span data-ttu-id="1e209-135">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-135">DBTYPE_UDT</span></span>|<span data-ttu-id="1e209-136">忽略</span><span class="sxs-lookup"><span data-stu-id="1e209-136">Ignored</span></span>|<span data-ttu-id="1e209-137">UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-137">UDT</span></span>|<span data-ttu-id="1e209-138">必須包含 DBPROPSET_SQLSERVERCOLUMN 屬性集。</span><span class="sxs-lookup"><span data-stu-id="1e209-138">Must include a DBPROPSET_SQLSERVERCOLUMN property set.</span></span>|  
  
## <a name="icommandwithparametersgetparameterinfo"></a><span data-ttu-id="1e209-139">ICommandWithParameters::GetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="1e209-139">ICommandWithParameters::GetParameterInfo</span></span>  
 <span data-ttu-id="1e209-140">透過 **prgParamInfo** 以 DBPARAMINFO 結構所傳回的資訊如下：</span><span class="sxs-lookup"><span data-stu-id="1e209-140">Information returned in the DBPARAMINFO structure through **prgParamInfo** is as follows:</span></span>  
  
|<span data-ttu-id="1e209-141">參數類型</span><span class="sxs-lookup"><span data-stu-id="1e209-141">Parameter type</span></span>|<span data-ttu-id="1e209-142">*wType*</span><span class="sxs-lookup"><span data-stu-id="1e209-142">*wType*</span></span>|<span data-ttu-id="1e209-143">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="1e209-143">*ulParamSize*</span></span>|<span data-ttu-id="1e209-144">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="1e209-144">*bPrecision*</span></span>|<span data-ttu-id="1e209-145">*bScale*</span><span class="sxs-lookup"><span data-stu-id="1e209-145">*bScale*</span></span>|<span data-ttu-id="1e209-146">*dwFlags* DBPARAMFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="1e209-146">*dwFlags* DBPARAMFLAGS_ISLONG</span></span>|  
|--------------------|-------------|-------------------|------------------|--------------|------------------------------------|  
|<span data-ttu-id="1e209-147">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-147">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1e209-148">(長度小於或等於 8,000 個位元組)</span><span class="sxs-lookup"><span data-stu-id="1e209-148">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="1e209-149">"DBTYPE_UDT"</span><span class="sxs-lookup"><span data-stu-id="1e209-149">"DBTYPE_UDT"</span></span>|<span data-ttu-id="1e209-150">*n*</span><span class="sxs-lookup"><span data-stu-id="1e209-150">*n*</span></span>|<span data-ttu-id="1e209-151">未定義</span><span class="sxs-lookup"><span data-stu-id="1e209-151">undefined</span></span>|<span data-ttu-id="1e209-152">未定義</span><span class="sxs-lookup"><span data-stu-id="1e209-152">undefined</span></span>|<span data-ttu-id="1e209-153">clear</span><span class="sxs-lookup"><span data-stu-id="1e209-153">clear</span></span>|  
|<span data-ttu-id="1e209-154">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-154">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1e209-155">(長度大於 8,000 個位元組)</span><span class="sxs-lookup"><span data-stu-id="1e209-155">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="1e209-156">"DBTYPE_UDT"</span><span class="sxs-lookup"><span data-stu-id="1e209-156">"DBTYPE_UDT"</span></span>|<span data-ttu-id="1e209-157">~0</span><span class="sxs-lookup"><span data-stu-id="1e209-157">~0</span></span>|<span data-ttu-id="1e209-158">未定義</span><span class="sxs-lookup"><span data-stu-id="1e209-158">undefined</span></span>|<span data-ttu-id="1e209-159">未定義</span><span class="sxs-lookup"><span data-stu-id="1e209-159">undefined</span></span>|<span data-ttu-id="1e209-160">set</span><span class="sxs-lookup"><span data-stu-id="1e209-160">set</span></span>|  
  
## <a name="icommandwithparameterssetparameterinfo"></a><span data-ttu-id="1e209-161">ICommandWithParameters::SetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="1e209-161">ICommandWithParameters::SetParameterInfo</span></span>  
 <span data-ttu-id="1e209-162">以 DBPARAMBINDINFO 結構所提供的資訊必須與下列相符：</span><span class="sxs-lookup"><span data-stu-id="1e209-162">The information provided in the DBPARAMBINDINFO structure must conform to the following:</span></span>  
  
|<span data-ttu-id="1e209-163">參數類型</span><span class="sxs-lookup"><span data-stu-id="1e209-163">Parameter type</span></span>|<span data-ttu-id="1e209-164">*pwszDataSourceType*</span><span class="sxs-lookup"><span data-stu-id="1e209-164">*pwszDataSourceType*</span></span>|<span data-ttu-id="1e209-165">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="1e209-165">*ulParamSize*</span></span>|<span data-ttu-id="1e209-166">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="1e209-166">*bPrecision*</span></span>|<span data-ttu-id="1e209-167">*bScale*</span><span class="sxs-lookup"><span data-stu-id="1e209-167">*bScale*</span></span>|<span data-ttu-id="1e209-168">*dwFlags* DBPARAMFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="1e209-168">*dwFlags* DBPARAMFLAGS_ISLONG</span></span>|  
|--------------------|--------------------------|-------------------|------------------|--------------|------------------------------------|  
|<span data-ttu-id="1e209-169">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-169">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1e209-170">(長度小於或等於 8,000 個位元組)</span><span class="sxs-lookup"><span data-stu-id="1e209-170">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="1e209-171">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-171">DBTYPE_UDT</span></span>|<span data-ttu-id="1e209-172">*n*</span><span class="sxs-lookup"><span data-stu-id="1e209-172">*n*</span></span>|<span data-ttu-id="1e209-173">忽略</span><span class="sxs-lookup"><span data-stu-id="1e209-173">ignored</span></span>|<span data-ttu-id="1e209-174">忽略</span><span class="sxs-lookup"><span data-stu-id="1e209-174">ignored</span></span>|<span data-ttu-id="1e209-175">如果要使用 DBTYPE_IUNKNOWN 傳遞此參數，則必須設定。</span><span class="sxs-lookup"><span data-stu-id="1e209-175">Must be set if the parameter is to be passed using DBTYPE_IUNKNOWN.</span></span>|  
|<span data-ttu-id="1e209-176">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-176">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1e209-177">(長度大於 8,000 個位元組)</span><span class="sxs-lookup"><span data-stu-id="1e209-177">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="1e209-178">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-178">DBTYPE_UDT</span></span>|<span data-ttu-id="1e209-179">~0</span><span class="sxs-lookup"><span data-stu-id="1e209-179">~0</span></span>|<span data-ttu-id="1e209-180">忽略</span><span class="sxs-lookup"><span data-stu-id="1e209-180">ignored</span></span>|<span data-ttu-id="1e209-181">忽略</span><span class="sxs-lookup"><span data-stu-id="1e209-181">ignored</span></span>|<span data-ttu-id="1e209-182">忽略</span><span class="sxs-lookup"><span data-stu-id="1e209-182">ignored</span></span>|  
  
## <a name="isscommandwithparameters"></a><span data-ttu-id="1e209-183">ISSCommandWithParameters</span><span class="sxs-lookup"><span data-stu-id="1e209-183">ISSCommandWithParameters</span></span>  
 <span data-ttu-id="1e209-184">應用程式會使用 **ISSCommandWithParameters** 來取得並設定定義於 Parameter Properties 區段中的參數屬性。</span><span class="sxs-lookup"><span data-stu-id="1e209-184">Applications use **ISSCommandWithParameters** to get and set the parameter properties defined in the Parameter Properties section.</span></span>  
  
## <a name="icolumnsrowsetgetcolumnsrowset"></a><span data-ttu-id="1e209-185">IColumnsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="1e209-185">IColumnsRowset::GetColumnsRowset</span></span>  
 <span data-ttu-id="1e209-186">傳回的資料行如下：</span><span class="sxs-lookup"><span data-stu-id="1e209-186">Columns returned are as follows:</span></span>  
  
|<span data-ttu-id="1e209-187">資料行類型</span><span class="sxs-lookup"><span data-stu-id="1e209-187">Column type</span></span>|<span data-ttu-id="1e209-188">DBCOLUMN_TYPE</span><span class="sxs-lookup"><span data-stu-id="1e209-188">DBCOLUMN_TYPE</span></span>|<span data-ttu-id="1e209-189">DBCOLUMN_COLUMNSIZE</span><span class="sxs-lookup"><span data-stu-id="1e209-189">DBCOLUMN_COLUMNSIZE</span></span>|<span data-ttu-id="1e209-190">DBCOLUMN_PRECISION</span><span class="sxs-lookup"><span data-stu-id="1e209-190">DBCOLUMN_PRECISION</span></span>|<span data-ttu-id="1e209-191">DBCOLUMN_SCALE</span><span class="sxs-lookup"><span data-stu-id="1e209-191">DBCOLUMN_SCALE</span></span>|<span data-ttu-id="1e209-192">DBCOLUMN_FLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="1e209-192">DBCOLUMN_FLAGS_ISLONG</span></span>|<span data-ttu-id="1e209-193">DBCOLUMNS_ISSEARCHABLE</span><span class="sxs-lookup"><span data-stu-id="1e209-193">DBCOLUMNS_ISSEARCHABLE</span></span>|<span data-ttu-id="1e209-194">DBCOLUMN_OCTETLENGTH</span><span class="sxs-lookup"><span data-stu-id="1e209-194">DBCOLUMN_OCTETLENGTH</span></span>|  
|-----------------|--------------------|--------------------------|-------------------------|---------------------|-----------------------------|-----------------------------|---------------------------|  
|<span data-ttu-id="1e209-195">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-195">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1e209-196">(長度小於或等於 8,000 個位元組)</span><span class="sxs-lookup"><span data-stu-id="1e209-196">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="1e209-197">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-197">DBTYPE_UDT</span></span>|<span data-ttu-id="1e209-198">*n*</span><span class="sxs-lookup"><span data-stu-id="1e209-198">*n*</span></span>|<span data-ttu-id="1e209-199">NULL</span><span class="sxs-lookup"><span data-stu-id="1e209-199">NULL</span></span>|<span data-ttu-id="1e209-200">NULL</span><span class="sxs-lookup"><span data-stu-id="1e209-200">NULL</span></span>|<span data-ttu-id="1e209-201">清除</span><span class="sxs-lookup"><span data-stu-id="1e209-201">Clear</span></span>|<span data-ttu-id="1e209-202">DB_ALL_EXCEPT_LIKE</span><span class="sxs-lookup"><span data-stu-id="1e209-202">DB_ALL_EXCEPT_LIKE</span></span>|<span data-ttu-id="1e209-203">n</span><span class="sxs-lookup"><span data-stu-id="1e209-203">n</span></span>|  
|<span data-ttu-id="1e209-204">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-204">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1e209-205">(長度大於 8,000 個位元組)</span><span class="sxs-lookup"><span data-stu-id="1e209-205">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="1e209-206">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-206">DBTYPE_UDT</span></span>|<span data-ttu-id="1e209-207">~0</span><span class="sxs-lookup"><span data-stu-id="1e209-207">~0</span></span>|<span data-ttu-id="1e209-208">NULL</span><span class="sxs-lookup"><span data-stu-id="1e209-208">NULL</span></span>|<span data-ttu-id="1e209-209">NULL</span><span class="sxs-lookup"><span data-stu-id="1e209-209">NULL</span></span>|<span data-ttu-id="1e209-210">設定</span><span class="sxs-lookup"><span data-stu-id="1e209-210">Set</span></span>|<span data-ttu-id="1e209-211">DB_ALL_EXCEPT_LIKE</span><span class="sxs-lookup"><span data-stu-id="1e209-211">DB_ALL_EXCEPT_LIKE</span></span>|<span data-ttu-id="1e209-212">0</span><span class="sxs-lookup"><span data-stu-id="1e209-212">0</span></span>|  
  
 <span data-ttu-id="1e209-213">下列資料行也會針對 UDT 而定義：</span><span class="sxs-lookup"><span data-stu-id="1e209-213">The following columns are also defined for UDTs:</span></span>  
  
|<span data-ttu-id="1e209-214">資料行識別碼</span><span class="sxs-lookup"><span data-stu-id="1e209-214">Column Identifier</span></span>|<span data-ttu-id="1e209-215">類型</span><span class="sxs-lookup"><span data-stu-id="1e209-215">Type</span></span>|<span data-ttu-id="1e209-216">描述</span><span class="sxs-lookup"><span data-stu-id="1e209-216">Description</span></span>|  
|-----------------------|----------|-----------------|  
|<span data-ttu-id="1e209-217">DBCOLUMN_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="1e209-217">DBCOLUMN_UDT_CATALOGNAME</span></span>|<span data-ttu-id="1e209-218">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="1e209-218">DBTYPE_WSTR</span></span>|<span data-ttu-id="1e209-219">對於 UDT 資料行而言，此為定義 UDT 之目錄的名稱。</span><span class="sxs-lookup"><span data-stu-id="1e209-219">For UDT columns, the name of the catalog where the UDT is defined.</span></span>|  
|<span data-ttu-id="1e209-220">DBCOLUMN_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="1e209-220">DBCOLUMN_UDT_SCHEMANAME</span></span>|<span data-ttu-id="1e209-221">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="1e209-221">DBTYPE_WSTR</span></span>|<span data-ttu-id="1e209-222">對於 UDT 資料行而言，此為定義 UDT 之結構描述的名稱。</span><span class="sxs-lookup"><span data-stu-id="1e209-222">For UDT columns, the name of the schema where the UDT is defined.</span></span>|  
|<span data-ttu-id="1e209-223">DBCOLUMN_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="1e209-223">DBCOLUMN_UDT_NAME</span></span>|<span data-ttu-id="1e209-224">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="1e209-224">DBTYPE_WSTR</span></span>|<span data-ttu-id="1e209-225">對於 UDT 資料行而言，此為 UDT 的單一部分名稱。</span><span class="sxs-lookup"><span data-stu-id="1e209-225">For UDT columns, the single part name of the UDT.</span></span>|  
|<span data-ttu-id="1e209-226">DBCOLUMN_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="1e209-226">DBCOLUMN_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="1e209-227">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="1e209-227">DBTYPE_WSTR</span></span>|<span data-ttu-id="1e209-228">對於 UDT 資料行而言，此為 UDT 的完整類型名稱。</span><span class="sxs-lookup"><span data-stu-id="1e209-228">For UDT columns, the full type name of the UDT.</span></span> <span data-ttu-id="1e209-229">組件類型的完整名稱可以讓您使用 Type.GetType 方法來具現化該類型的物件。</span><span class="sxs-lookup"><span data-stu-id="1e209-229">The fully-qualified name of the assembly type lets you instantiate an object of that type using Type.GetType method.</span></span>|  
  
## <a name="icolumnsinfogetcolumninfo"></a><span data-ttu-id="1e209-230">IColumnsInfo::GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="1e209-230">IColumnsInfo::GetColumnInfo</span></span>  
 <span data-ttu-id="1e209-231">以 DBCOLUMNINFO 結構所傳回的資訊如下：</span><span class="sxs-lookup"><span data-stu-id="1e209-231">The information returned in the DBCOLUMNINFO structure is as follows:</span></span>  
  
|<span data-ttu-id="1e209-232">參數類型</span><span class="sxs-lookup"><span data-stu-id="1e209-232">Parameter type</span></span>|<span data-ttu-id="1e209-233">*wType*</span><span class="sxs-lookup"><span data-stu-id="1e209-233">*wType*</span></span>|<span data-ttu-id="1e209-234">*ulColumnSize*</span><span class="sxs-lookup"><span data-stu-id="1e209-234">*ulColumnSize*</span></span>|<span data-ttu-id="1e209-235">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="1e209-235">*bPrecision*</span></span>|<span data-ttu-id="1e209-236">*bScale*</span><span class="sxs-lookup"><span data-stu-id="1e209-236">*bScale*</span></span>|<span data-ttu-id="1e209-237">*dwFlags*</span><span class="sxs-lookup"><span data-stu-id="1e209-237">*dwFlags*</span></span><br /><br /> <span data-ttu-id="1e209-238">DBCOLUMNFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="1e209-238">DBCOLUMNFLAGS_ISLONG</span></span>|  
|--------------------|-------------|--------------------|------------------|--------------|-----------------------------------------|  
|<span data-ttu-id="1e209-239">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-239">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1e209-240">(長度小於或等於 8,000 個位元組)</span><span class="sxs-lookup"><span data-stu-id="1e209-240">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="1e209-241">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-241">DBTYPE_UDT</span></span>|<span data-ttu-id="1e209-242">*n*</span><span class="sxs-lookup"><span data-stu-id="1e209-242">*n*</span></span>|<span data-ttu-id="1e209-243">~0</span><span class="sxs-lookup"><span data-stu-id="1e209-243">~0</span></span>|<span data-ttu-id="1e209-244">~0</span><span class="sxs-lookup"><span data-stu-id="1e209-244">~0</span></span>|<span data-ttu-id="1e209-245">清除</span><span class="sxs-lookup"><span data-stu-id="1e209-245">Clear</span></span>|  
|<span data-ttu-id="1e209-246">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-246">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1e209-247">(長度大於 8,000 個位元組)</span><span class="sxs-lookup"><span data-stu-id="1e209-247">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="1e209-248">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-248">DBTYPE_UDT</span></span>|<span data-ttu-id="1e209-249">~0</span><span class="sxs-lookup"><span data-stu-id="1e209-249">~0</span></span>|<span data-ttu-id="1e209-250">~0</span><span class="sxs-lookup"><span data-stu-id="1e209-250">~0</span></span>|<span data-ttu-id="1e209-251">~0</span><span class="sxs-lookup"><span data-stu-id="1e209-251">~0</span></span>|<span data-ttu-id="1e209-252">設定</span><span class="sxs-lookup"><span data-stu-id="1e209-252">Set</span></span>|  
  
## <a name="columns-rowset-schema-rowsets"></a><span data-ttu-id="1e209-253">COLUMNS 資料列集 (結構描述資料列集)</span><span class="sxs-lookup"><span data-stu-id="1e209-253">COLUMNS Rowset (Schema Rowsets)</span></span>  
 <span data-ttu-id="1e209-254">下列資料行值是針對 UDT 類型所傳回：</span><span class="sxs-lookup"><span data-stu-id="1e209-254">The following column values are returned for UDT types:</span></span>  
  
|<span data-ttu-id="1e209-255">資料行類型</span><span class="sxs-lookup"><span data-stu-id="1e209-255">Column type</span></span>|<span data-ttu-id="1e209-256">DATA_TYPE</span><span class="sxs-lookup"><span data-stu-id="1e209-256">DATA_TYPE</span></span>|<span data-ttu-id="1e209-257">COLUMN_FLAGS、DBCOLUMFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="1e209-257">COLUMN_FLAGS, DBCOLUMFLAGS_ISLONG</span></span>|<span data-ttu-id="1e209-258">CHARACTER_OCTET_LENGTH</span><span class="sxs-lookup"><span data-stu-id="1e209-258">CHARACTER_OCTET_LENGTH</span></span>|  
|-----------------|----------------|-----------------------------------------|------------------------------|  
|<span data-ttu-id="1e209-259">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-259">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1e209-260">(長度小於或等於 8,000 個位元組)</span><span class="sxs-lookup"><span data-stu-id="1e209-260">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="1e209-261">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-261">DBTYPE_UDT</span></span>|<span data-ttu-id="1e209-262">清除</span><span class="sxs-lookup"><span data-stu-id="1e209-262">Clear</span></span>|<span data-ttu-id="1e209-263">*n*</span><span class="sxs-lookup"><span data-stu-id="1e209-263">*n*</span></span>|  
|<span data-ttu-id="1e209-264">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-264">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1e209-265">(長度大於 8,000 個位元組)</span><span class="sxs-lookup"><span data-stu-id="1e209-265">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="1e209-266">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-266">DBTYPE_UDT</span></span>|<span data-ttu-id="1e209-267">設定</span><span class="sxs-lookup"><span data-stu-id="1e209-267">Set</span></span>|<span data-ttu-id="1e209-268">0</span><span class="sxs-lookup"><span data-stu-id="1e209-268">0</span></span>|  
  
 <span data-ttu-id="1e209-269">下列其他資料行也會針對 UDT 而定義：</span><span class="sxs-lookup"><span data-stu-id="1e209-269">The following additional columns are defined for UDTs:</span></span>  
  
|<span data-ttu-id="1e209-270">資料行識別碼</span><span class="sxs-lookup"><span data-stu-id="1e209-270">Column identifier</span></span>|<span data-ttu-id="1e209-271">類型</span><span class="sxs-lookup"><span data-stu-id="1e209-271">Type</span></span>|<span data-ttu-id="1e209-272">描述</span><span class="sxs-lookup"><span data-stu-id="1e209-272">Description</span></span>|  
|-----------------------|----------|-----------------|  
|<span data-ttu-id="1e209-273">SS_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="1e209-273">SS_UDT_CATALOGNAME</span></span>|<span data-ttu-id="1e209-274">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="1e209-274">DBTYPE_WSTR</span></span>|<span data-ttu-id="1e209-275">對於 UDT 資料行而言，此為定義 UDT 之目錄的名稱。</span><span class="sxs-lookup"><span data-stu-id="1e209-275">For UDT columns, the name of the catalog where the UDT is defined.</span></span>|  
|<span data-ttu-id="1e209-276">SS_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="1e209-276">SS_UDT_SCHEMANAME</span></span>|<span data-ttu-id="1e209-277">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="1e209-277">DBTYPE_WSTR</span></span>|<span data-ttu-id="1e209-278">對於 UDT 資料行而言，此為定義 UDT 之結構描述的名稱。</span><span class="sxs-lookup"><span data-stu-id="1e209-278">For UDT columns, the name of the schema where the UDT is defined.</span></span>|  
|<span data-ttu-id="1e209-279">SS_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="1e209-279">SS_UDT_NAME</span></span>|<span data-ttu-id="1e209-280">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="1e209-280">DBTYPE_WSTR</span></span>|<span data-ttu-id="1e209-281">對於 UDT 資料行而言，此為 UDT 的單一部分名稱。</span><span class="sxs-lookup"><span data-stu-id="1e209-281">For UDT columns, the single part name of the UDT.</span></span>|  
|<span data-ttu-id="1e209-282">SS_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="1e209-282">SS_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="1e209-283">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="1e209-283">DBTYPE_WSTR</span></span>|<span data-ttu-id="1e209-284">對於 UDT 資料行而言，此為 UDT 的完整類型名稱。</span><span class="sxs-lookup"><span data-stu-id="1e209-284">For UDT columns, this is the full type name of the UDT.</span></span> <span data-ttu-id="1e209-285">組件類型的完整名稱可以讓您使用 Type.GetType 方法來具現化該類型的物件。</span><span class="sxs-lookup"><span data-stu-id="1e209-285">The fully-qualified name of the assembly type lets you instantiate an object of that type using Type.GetType method.</span></span>|  
  
 <span data-ttu-id="1e209-286">有關 PROCEDURE_PARAMETERS 資料列集方面，DATA_TYPE 會包含與 COLUMNS 結構描述資料列集相同的值，而 TYPE_NAME 則會包含 UDT。</span><span class="sxs-lookup"><span data-stu-id="1e209-286">Regarding the PROCEDURE_PARAMETERS rowset, DATA_TYPE contains the same values as the COLUMNS schema rowset and TYPE_NAME contains UDT.</span></span> <span data-ttu-id="1e209-287">也會定義相同的其他資料行。</span><span class="sxs-lookup"><span data-stu-id="1e209-287">The same additional columns are also defined.</span></span>  
  
 <span data-ttu-id="1e209-288">使用者定義型別不會出現在 PROVIDER_TYPES 結構描述資料列集中。</span><span class="sxs-lookup"><span data-stu-id="1e209-288">User-defined types will not appear in the PROVIDER_TYPES schema rowset.</span></span>  
  
## <a name="bindings-and-conversions"></a><span data-ttu-id="1e209-289">繫結和轉換</span><span class="sxs-lookup"><span data-stu-id="1e209-289">Bindings and Conversions</span></span>  
  
|<span data-ttu-id="1e209-290">繫結資料類型</span><span class="sxs-lookup"><span data-stu-id="1e209-290">Binding data tpe</span></span>|<span data-ttu-id="1e209-291">UDT 到伺服器</span><span class="sxs-lookup"><span data-stu-id="1e209-291">UDT to server</span></span>|<span data-ttu-id="1e209-292">非 UDT 到伺服器</span><span class="sxs-lookup"><span data-stu-id="1e209-292">Non-UDT to server</span></span>|<span data-ttu-id="1e209-293">從伺服器中的 UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-293">UDT from server</span></span>|<span data-ttu-id="1e209-294">從伺服器中的非 UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-294">Non-UDT from server</span></span>|  
|----------------------|-------------------|------------------------|---------------------|--------------------------|  
|<span data-ttu-id="1e209-295">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-295">DBTYPE_UDT</span></span>|<span data-ttu-id="1e209-296">支援 (5)</span><span class="sxs-lookup"><span data-stu-id="1e209-296">Supported (5)</span></span>|<span data-ttu-id="1e209-297">錯誤 (1)</span><span class="sxs-lookup"><span data-stu-id="1e209-297">Error (1)</span></span>|<span data-ttu-id="1e209-298">支援 (5)</span><span class="sxs-lookup"><span data-stu-id="1e209-298">Supported (5)</span></span>|<span data-ttu-id="1e209-299">錯誤 (4)</span><span class="sxs-lookup"><span data-stu-id="1e209-299">Error (4)</span></span>|  
|<span data-ttu-id="1e209-300">DBTYPE_BYTES</span><span class="sxs-lookup"><span data-stu-id="1e209-300">DBTYPE_BYTES</span></span>|<span data-ttu-id="1e209-301">支援 (5)</span><span class="sxs-lookup"><span data-stu-id="1e209-301">Supported (5)</span></span>|<span data-ttu-id="1e209-302">N/A</span><span class="sxs-lookup"><span data-stu-id="1e209-302">N/A</span></span>|<span data-ttu-id="1e209-303">支援 (5)</span><span class="sxs-lookup"><span data-stu-id="1e209-303">Supported (5)</span></span>|<span data-ttu-id="1e209-304">N/A</span><span class="sxs-lookup"><span data-stu-id="1e209-304">N/A</span></span>|  
|<span data-ttu-id="1e209-305">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="1e209-305">DBTYPE_WSTR</span></span>|<span data-ttu-id="1e209-306">支援 (2)、(5)</span><span class="sxs-lookup"><span data-stu-id="1e209-306">Supported (2), (5)</span></span>|<span data-ttu-id="1e209-307">N/A</span><span class="sxs-lookup"><span data-stu-id="1e209-307">N/A</span></span>|<span data-ttu-id="1e209-308">支援 (3)、(5)、(6)</span><span class="sxs-lookup"><span data-stu-id="1e209-308">Supported (3), (5), (6)</span></span>|<span data-ttu-id="1e209-309">N/A</span><span class="sxs-lookup"><span data-stu-id="1e209-309">N/A</span></span>|  
|<span data-ttu-id="1e209-310">DBTYPE_BSTR</span><span class="sxs-lookup"><span data-stu-id="1e209-310">DBTYPE_BSTR</span></span>|<span data-ttu-id="1e209-311">支援 (2)、(5)</span><span class="sxs-lookup"><span data-stu-id="1e209-311">Supported (2), (5)</span></span>|<span data-ttu-id="1e209-312">N/A</span><span class="sxs-lookup"><span data-stu-id="1e209-312">N/A</span></span>|<span data-ttu-id="1e209-313">支援 (3)、(5)</span><span class="sxs-lookup"><span data-stu-id="1e209-313">Supported (3), (5)</span></span>|<span data-ttu-id="1e209-314">N/A</span><span class="sxs-lookup"><span data-stu-id="1e209-314">N/A</span></span>|  
|<span data-ttu-id="1e209-315">DBTYPE_STR</span><span class="sxs-lookup"><span data-stu-id="1e209-315">DBTYPE_STR</span></span>|<span data-ttu-id="1e209-316">支援 (2)、(5)</span><span class="sxs-lookup"><span data-stu-id="1e209-316">Supported (2), (5)</span></span>|<span data-ttu-id="1e209-317">N/A</span><span class="sxs-lookup"><span data-stu-id="1e209-317">N/A</span></span>|<span data-ttu-id="1e209-318">支援 (3)、(5)</span><span class="sxs-lookup"><span data-stu-id="1e209-318">Supported (3), (5)</span></span>|<span data-ttu-id="1e209-319">N/A</span><span class="sxs-lookup"><span data-stu-id="1e209-319">N/A</span></span>|  
|<span data-ttu-id="1e209-320">DBTYPE_IUNKNOWN</span><span class="sxs-lookup"><span data-stu-id="1e209-320">DBTYPE_IUNKNOWN</span></span>|<span data-ttu-id="1e209-321">支援 (6)</span><span class="sxs-lookup"><span data-stu-id="1e209-321">Supported (6)</span></span>|<span data-ttu-id="1e209-322">N/A</span><span class="sxs-lookup"><span data-stu-id="1e209-322">N/A</span></span>|<span data-ttu-id="1e209-323">支援 (6)</span><span class="sxs-lookup"><span data-stu-id="1e209-323">Supported (6)</span></span>|<span data-ttu-id="1e209-324">N/A</span><span class="sxs-lookup"><span data-stu-id="1e209-324">N/A</span></span>|  
|<span data-ttu-id="1e209-325">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span><span class="sxs-lookup"><span data-stu-id="1e209-325">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span></span>|<span data-ttu-id="1e209-326">支援 (5)</span><span class="sxs-lookup"><span data-stu-id="1e209-326">Supported  (5)</span></span>|<span data-ttu-id="1e209-327">N/A</span><span class="sxs-lookup"><span data-stu-id="1e209-327">N/A</span></span>|<span data-ttu-id="1e209-328">支援 (3)、(5)</span><span class="sxs-lookup"><span data-stu-id="1e209-328">Supported (3), (5)</span></span>|<span data-ttu-id="1e209-329">N/A</span><span class="sxs-lookup"><span data-stu-id="1e209-329">N/A</span></span>|  
|<span data-ttu-id="1e209-330">DBTYPE_VARIANT (VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="1e209-330">DBTYPE_VARIANT (VT_BSTR)</span></span>|<span data-ttu-id="1e209-331">支援 (2)、(5)</span><span class="sxs-lookup"><span data-stu-id="1e209-331">Supported (2), (5)</span></span>|<span data-ttu-id="1e209-332">N/A</span><span class="sxs-lookup"><span data-stu-id="1e209-332">N/A</span></span>|<span data-ttu-id="1e209-333">N/A</span><span class="sxs-lookup"><span data-stu-id="1e209-333">N/A</span></span>|<span data-ttu-id="1e209-334">N/A</span><span class="sxs-lookup"><span data-stu-id="1e209-334">N/A</span></span>|  
  
### <a name="key-to-symbols"></a><span data-ttu-id="1e209-335">符號的索引鍵</span><span class="sxs-lookup"><span data-stu-id="1e209-335">Key to Symbols</span></span>  
  
|<span data-ttu-id="1e209-336">符號</span><span class="sxs-lookup"><span data-stu-id="1e209-336">Symbol</span></span>|<span data-ttu-id="1e209-337">意義</span><span class="sxs-lookup"><span data-stu-id="1e209-337">Meaning</span></span>|  
|------------|-------------|  
|<span data-ttu-id="1e209-338">1</span><span class="sxs-lookup"><span data-stu-id="1e209-338">1</span></span>|<span data-ttu-id="1e209-339">如果使用 **ICommandWithParameters::SetParameterInfo** 指定 DBTYPE_UDT 以外的伺服器類型，而且存取子類型為 DBTYPE_UDT，則當陳述式執行時會發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="1e209-339">If a server type other than DBTYPE_UDT is specified with **ICommandWithParameters::SetParameterInfo** and the accessor type is DBTYPE_UDT, an error occurs when the statement is executed.</span></span>  <span data-ttu-id="1e209-340">此錯誤將是 DB_E_ERRORSOCCURRED，而參數狀態將是 DBSTATUS_E_BADACCESSOR。</span><span class="sxs-lookup"><span data-stu-id="1e209-340">The error will be DB_E_ERRORSOCCURRED and the parameter status will be DBSTATUS_E_BADACCESSOR.</span></span><br /><br /> <span data-ttu-id="1e209-341">針對不是 UDT 的伺服器參數指定 UDT 類型的參數是一項錯誤。</span><span class="sxs-lookup"><span data-stu-id="1e209-341">It is an error to specify a parameter of type UDT for a server parameter that is not a UDT.</span></span>|  
|<span data-ttu-id="1e209-342">2</span><span class="sxs-lookup"><span data-stu-id="1e209-342">2</span></span>|<span data-ttu-id="1e209-343">資料會從十六進位字串轉換成二進位資料。</span><span class="sxs-lookup"><span data-stu-id="1e209-343">Data is converted from hex string to binary data.</span></span>|  
|<span data-ttu-id="1e209-344">3</span><span class="sxs-lookup"><span data-stu-id="1e209-344">3</span></span>|<span data-ttu-id="1e209-345">資料會從二進位資料轉換成十六進位字串。</span><span class="sxs-lookup"><span data-stu-id="1e209-345">Data is converted from binary data to hex string.</span></span>|  
|<span data-ttu-id="1e209-346">4</span><span class="sxs-lookup"><span data-stu-id="1e209-346">4</span></span>|<span data-ttu-id="1e209-347">在使用 **CreateAccessor** 或 **GetNextRows** 時可能會發生驗證。</span><span class="sxs-lookup"><span data-stu-id="1e209-347">Validation can happen when using **CreateAccessor** or **GetNextRows**.</span></span> <span data-ttu-id="1e209-348">錯誤是 DB_E_ERRORSOCCURRED。</span><span class="sxs-lookup"><span data-stu-id="1e209-348">The error is DB_E_ERRORSOCCURRED.</span></span> <span data-ttu-id="1e209-349">繫結狀態設定為 DBBINDSTATUS_UNSUPPORTEDCONVERSION。</span><span class="sxs-lookup"><span data-stu-id="1e209-349">Binding status is set to DBBINDSTATUS_UNSUPPORTEDCONVERSION.</span></span>|  
|<span data-ttu-id="1e209-350">5</span><span class="sxs-lookup"><span data-stu-id="1e209-350">5</span></span>|<span data-ttu-id="1e209-351">可能會使用 BY_REF。</span><span class="sxs-lookup"><span data-stu-id="1e209-351">BY_REF may be used.</span></span>|  
|<span data-ttu-id="1e209-352">6</span><span class="sxs-lookup"><span data-stu-id="1e209-352">6</span></span>|<span data-ttu-id="1e209-353">UDT 參數可以在 DBBINDING 中繫結為 DBTYPE_IUNKNOWN。</span><span class="sxs-lookup"><span data-stu-id="1e209-353">UDT parameters can be bound as DBTYPE_IUNKNOWN in the DBBINDING.</span></span> <span data-ttu-id="1e209-354">繫結至 DBTYPE_IUNKNOWN 表示應用程式想要使用 ISequentialStream 介面將資料處理為資料流。</span><span class="sxs-lookup"><span data-stu-id="1e209-354">Binding to DBTYPE_IUNKNOWN indicates that the application wants to process the data as a stream using the ISequentialStream interface.</span></span> <span data-ttu-id="1e209-355">當取用者在系結中將*wType*指定為類型 DBTYPE_IUNKNOWN，而預存程式的對應資料行或輸出參數為 UDT 時，SQL Server Native Client 會傳回 ISequentialStream。</span><span class="sxs-lookup"><span data-stu-id="1e209-355">When a consumer specifies *wType* in a binding as type DBTYPE_IUNKNOWN, and the corresponding column or output parameter of the stored procedure is a UDT, SQL Server Native Client will return ISequentialStream.</span></span> <span data-ttu-id="1e209-356">對於輸入參數，SQL Server Native Client 將會查詢 ISequentialStream 介面的。</span><span class="sxs-lookup"><span data-stu-id="1e209-356">For an input parameter, SQL Server Native Client will query for the for the ISequentialStream interface.</span></span><br /><br /> <span data-ttu-id="1e209-357">在大型 UDT 的情況下，您可以選擇不要在使用 DBTYPE_IUNKNOWN 繫結時繫結 UDT 資料的長度。</span><span class="sxs-lookup"><span data-stu-id="1e209-357">You can choose to not bind the length of UDT data while using DBTYPE_IUNKNOWN binding, in the case of large UDTs.</span></span> <span data-ttu-id="1e209-358">不過，小型 UDT 則必須繫結長度。</span><span class="sxs-lookup"><span data-stu-id="1e209-358">However, the length must be bound for small UDTs.</span></span> <span data-ttu-id="1e209-359">如果下列其中一項或多項成立，則 DBTYPE_UDT 參數可以指定為大型 UDT：</span><span class="sxs-lookup"><span data-stu-id="1e209-359">A DBTYPE_UDT parameter can be specified as a large UDT if one or more of the following is true:</span></span><br /><br /> <span data-ttu-id="1e209-360">-   *ulParamParamSize*為 ~ 0。</span><span class="sxs-lookup"><span data-stu-id="1e209-360">-   *ulParamParamSize* is ~0.</span></span><br /><span data-ttu-id="1e209-361">-DBPARAMFLAGS_ISLONG 是在 DBPARAMBINDINFO 結構中設定。</span><span class="sxs-lookup"><span data-stu-id="1e209-361">-   DBPARAMFLAGS_ISLONG is set in the DBPARAMBINDINFO struct.</span></span><br /><br /> <span data-ttu-id="1e209-362">對於資料列資料而言，DBTYPE_IUNKNOWN 繫結只適用於大型 UDT。</span><span class="sxs-lookup"><span data-stu-id="1e209-362">For row data, DBTYPE_IUNKNOWN binding is only allowed for large UDTs.</span></span> <span data-ttu-id="1e209-363">您可以使用資料列集或命令物件之 IColumnsInfo 介面上的 IColumnsInfo::GetColumnInfo 方法，來查明資料行是否為大型 UDT 型別。</span><span class="sxs-lookup"><span data-stu-id="1e209-363">You can find out whether a column is a large UDT type by using the IColumnsInfo::GetColumnInfo method on a Rowset or Command object's IColumnsInfo interface.</span></span> <span data-ttu-id="1e209-364">如果下列其中一項或多項成立，則 DBTYPE_UDT 資料行會是大型 UDT 資料行：</span><span class="sxs-lookup"><span data-stu-id="1e209-364">A DBTYPE_UDT column is a large UDT column if one or more of the following is true:</span></span><br /><br /> <span data-ttu-id="1e209-365">-在 DBCOLUMNINFO 結構的*dwFlags*成員上設定 DBCOLUMNFLAGS_ISLONG 旗標</span><span class="sxs-lookup"><span data-stu-id="1e209-365">-   DBCOLUMNFLAGS_ISLONG flag is set on *dwFlags* member of DBCOLUMNINFO structure</span></span><br /><span data-ttu-id="1e209-366">-   DBCOLUMNINFO 的*ulColumnSize*成員為 ~ 0。</span><span class="sxs-lookup"><span data-stu-id="1e209-366">-   *ulColumnSize* member of DBCOLUMNINFO is ~0.</span></span>|  
  
 <span data-ttu-id="1e209-367">DBTYPE_NULL 和 DBTYPE_EMPTY 可以針對輸入參數而繫結，但是不能針對輸出參數或結果而繫結。</span><span class="sxs-lookup"><span data-stu-id="1e209-367">DBTYPE_NULL and DBTYPE_EMPTY can be bound for input parameters, but not for output parameters or results.</span></span> <span data-ttu-id="1e209-368">當針對輸入參數來繫結時，狀態必須針對 DBTYPE_NULL 設定為 DBSTATUS_S_ISNULL，或針對 DBTYPE_EMPTY 設定為 DBSTATUS_S_DEFAULT。</span><span class="sxs-lookup"><span data-stu-id="1e209-368">When bound for input parameters, the status must be set to DBSTATUS_S_ISNULL for DBTYPE_NULL or DBSTATUS_S_DEFAULT for DBTYPE_EMPTY.</span></span> <span data-ttu-id="1e209-369">DBTYPE_BYREF 不適用於 DBTYPE_NULL 或 DBTYPE_EMPTY。</span><span class="sxs-lookup"><span data-stu-id="1e209-369">DBTYPE_BYREF cannot be used with DBTYPE_NULL or DBTYPE_EMPTY.</span></span>  
  
 <span data-ttu-id="1e209-370">DBTYPE_UDT 也可以轉換成 DBTYPE_EMPTY 或 DBTYPE_NULL。</span><span class="sxs-lookup"><span data-stu-id="1e209-370">DBTYPE_UDT can also be converted to DBTYPE_EMPTY and DBTYPE_NULL.</span></span> <span data-ttu-id="1e209-371">不過，DBTYPE_NULL 和 DBTYPE_EMPTY 不能轉換成 DBTYPE_UDT。</span><span class="sxs-lookup"><span data-stu-id="1e209-371">However, DBTYPE_NULL and DBTYPE_EMPTY cannot be converted to DBTYPE_UDT.</span></span> <span data-ttu-id="1e209-372">這與 DBTYPE_BYTES 一致。</span><span class="sxs-lookup"><span data-stu-id="1e209-372">This is consistent with DBTYPE_BYTES.</span></span> <span data-ttu-id="1e209-373">**ISSCommandWithParameters** 可用來將 UDT 當作參數處理。</span><span class="sxs-lookup"><span data-stu-id="1e209-373">**ISSCommandWithParameters** is used to process UDTs as parameters.</span></span>  
  
 <span data-ttu-id="1e209-374">OLE DB 核心服務 (**IDataConvert**) 提供的資料轉換不適用於 DBTYPE_UDT。</span><span class="sxs-lookup"><span data-stu-id="1e209-374">Data conversions supplied by OLE DB core services (**IDataConvert**) are not applicable to DBTYPE_UDT.</span></span>  
  
 <span data-ttu-id="1e209-375">不支援其他任何繫結。</span><span class="sxs-lookup"><span data-stu-id="1e209-375">No other bindings are supported.</span></span>  
  
## <a name="comparability-for-irowsetfind"></a><span data-ttu-id="1e209-376">IRowsetFind 的相容性</span><span class="sxs-lookup"><span data-stu-id="1e209-376">Comparability for IRowsetFind</span></span>  
 <span data-ttu-id="1e209-377">對於 UDT 類型而言，只支援下列比較：</span><span class="sxs-lookup"><span data-stu-id="1e209-377">For UDT types, only the following comparisons are supported:</span></span>  
  
-   <span data-ttu-id="1e209-378">EQ</span><span class="sxs-lookup"><span data-stu-id="1e209-378">EQ</span></span>  
  
-   <span data-ttu-id="1e209-379">NE</span><span class="sxs-lookup"><span data-stu-id="1e209-379">NE</span></span>  
  
-   <span data-ttu-id="1e209-380">IGNORE</span><span class="sxs-lookup"><span data-stu-id="1e209-380">IGNORE</span></span>  
  
 <span data-ttu-id="1e209-381">如果嘗試其他任何比較，就會傳回 DB_E_BADCOMPAREOP。</span><span class="sxs-lookup"><span data-stu-id="1e209-381">If any other comparison is attempted DB_E_BADCOMPAREOP is returned.</span></span>  
  
## <a name="bcp-support-for-udts"></a><span data-ttu-id="1e209-382">UDT 的 BCP 支援</span><span class="sxs-lookup"><span data-stu-id="1e209-382">BCP Support for UDTs</span></span>  
 <span data-ttu-id="1e209-383">UDT 值只能當做字元或二進位值來匯入及匯出。</span><span class="sxs-lookup"><span data-stu-id="1e209-383">UDT values can be imported and exported only as character or binary values.</span></span>  
  
## <a name="down-level-client-behavior-for-udts"></a><span data-ttu-id="1e209-384">UDT 的下層用戶端行為</span><span class="sxs-lookup"><span data-stu-id="1e209-384">Down-level Client Behavior for UDTs</span></span>  
 <span data-ttu-id="1e209-385">UDT 受限於與下層用戶端對應的類型，如下所示：</span><span class="sxs-lookup"><span data-stu-id="1e209-385">UDTs are subject to type mapping with down-level clients, as follows:</span></span>  
  
|<span data-ttu-id="1e209-386">用戶端版本</span><span class="sxs-lookup"><span data-stu-id="1e209-386">Client version</span></span>|<span data-ttu-id="1e209-387">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-387">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1e209-388">(長度小於或等於 8,000 個位元組)</span><span class="sxs-lookup"><span data-stu-id="1e209-388">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="1e209-389">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-389">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1e209-390">(長度大於 8,000 個位元組)</span><span class="sxs-lookup"><span data-stu-id="1e209-390">(length greater than 8,000 bytes)</span></span>|  
|--------------------|------------------------------------------------------------------|---------------------------------------------------------|  
|<span data-ttu-id="1e209-391">SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="1e209-391">SQL Server 2005</span></span>|<span data-ttu-id="1e209-392">UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-392">UDT</span></span>|<span data-ttu-id="1e209-393">varbinary(max)</span><span class="sxs-lookup"><span data-stu-id="1e209-393">varbinary(max)</span></span>|  
|<span data-ttu-id="1e209-394">SQL Server 2008 及更新版本</span><span class="sxs-lookup"><span data-stu-id="1e209-394">SQL Server 2008 and later</span></span>|<span data-ttu-id="1e209-395">UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-395">UDT</span></span>|<span data-ttu-id="1e209-396">UDT</span><span class="sxs-lookup"><span data-stu-id="1e209-396">UDT</span></span>|  
  
 <span data-ttu-id="1e209-397">當 `DataTypeCompatibility` (SSPROP_INIT_DATATYPECOMPATIBILITY) 設定為 "80" 時，大型 UDT 類型會以針對下層用戶端顯示的方式向用戶端顯示。</span><span class="sxs-lookup"><span data-stu-id="1e209-397">When `DataTypeCompatibility` (SSPROP_INIT_DATATYPECOMPATIBILITY) is set to "80", large UDT types appear to clients in the same way that they appear for down-level clients.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1e209-398">另請參閱</span><span class="sxs-lookup"><span data-stu-id="1e209-398">See Also</span></span>  
 [<span data-ttu-id="1e209-399">大型 CLR 使用者定義型別</span><span class="sxs-lookup"><span data-stu-id="1e209-399">Large CLR User-Defined Types</span></span>](../features/large-clr-user-defined-types.md)  
  
  
