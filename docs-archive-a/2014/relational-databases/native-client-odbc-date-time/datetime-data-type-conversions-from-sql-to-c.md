---
title: 從 SQL 轉換為 C |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- conversions [ODBC], SQL to C
ms.assetid: 059431e2-a65c-4587-ba4a-9929a1611e96
author: rothja
ms.author: jroth
ms.openlocfilehash: 0cc1fe6049824217a12a291b7006599a4a3a7319
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87598332"
---
# <a name="conversions-from-sql-to-c"></a><span data-ttu-id="c19ac-102">從 SQL 轉換成 C</span><span class="sxs-lookup"><span data-stu-id="c19ac-102">Conversions from SQL to C</span></span>
  <span data-ttu-id="c19ac-103">下表將列出當您從 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 日期/時間類型轉換成 C 類型時應該考量的問題。</span><span class="sxs-lookup"><span data-stu-id="c19ac-103">The following table lists issues to consider when you convert from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] date/time types to C types.</span></span>  
  
## <a name="conversions"></a><span data-ttu-id="c19ac-104">轉換</span><span class="sxs-lookup"><span data-stu-id="c19ac-104">Conversions</span></span>  
  
||||||||||  
|-|-|-|-|-|-|-|-|-|  
||<span data-ttu-id="c19ac-105">SQL_C_DATE</span><span class="sxs-lookup"><span data-stu-id="c19ac-105">SQL_C_DATE</span></span>|<span data-ttu-id="c19ac-106">SQL_C_TIME</span><span class="sxs-lookup"><span data-stu-id="c19ac-106">SQL_C_TIME</span></span>|<span data-ttu-id="c19ac-107">SQL_C_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="c19ac-107">SQL_C_TIMESTAMP</span></span>|<span data-ttu-id="c19ac-108">SQL_C_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="c19ac-108">SQL_C_SS_TIME2</span></span>|<span data-ttu-id="c19ac-109">SQL_C_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="c19ac-109">SQL_C_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="c19ac-110">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="c19ac-110">SQL_C_BINARY</span></span>|<span data-ttu-id="c19ac-111">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="c19ac-111">SQL_C_CHAR</span></span>|<span data-ttu-id="c19ac-112">SQL_C_WCHAR</span><span class="sxs-lookup"><span data-stu-id="c19ac-112">SQL_C_WCHAR</span></span>|  
|<span data-ttu-id="c19ac-113">SQL_CHAR</span><span class="sxs-lookup"><span data-stu-id="c19ac-113">SQL_CHAR</span></span>|<span data-ttu-id="c19ac-114">2、3、4、5</span><span class="sxs-lookup"><span data-stu-id="c19ac-114">2,3,4,5</span></span>|<span data-ttu-id="c19ac-115">2、3、6、7、8</span><span class="sxs-lookup"><span data-stu-id="c19ac-115">2,3,6,7,8</span></span>|<span data-ttu-id="c19ac-116">2，3，9，10，11</span><span class="sxs-lookup"><span data-stu-id="c19ac-116">2,3,9,10,11</span></span>|<span data-ttu-id="c19ac-117">2、3、6、7</span><span class="sxs-lookup"><span data-stu-id="c19ac-117">2,3,6,7</span></span>|<span data-ttu-id="c19ac-118">2，3，9，10，11</span><span class="sxs-lookup"><span data-stu-id="c19ac-118">2,3,9,10,11</span></span>|<span data-ttu-id="c19ac-119">1</span><span class="sxs-lookup"><span data-stu-id="c19ac-119">1</span></span>|<span data-ttu-id="c19ac-120">1</span><span class="sxs-lookup"><span data-stu-id="c19ac-120">1</span></span>|<span data-ttu-id="c19ac-121">1</span><span class="sxs-lookup"><span data-stu-id="c19ac-121">1</span></span>|  
|<span data-ttu-id="c19ac-122">SQL_WCHAR</span><span class="sxs-lookup"><span data-stu-id="c19ac-122">SQL_WCHAR</span></span>|<span data-ttu-id="c19ac-123">2、3、4、5</span><span class="sxs-lookup"><span data-stu-id="c19ac-123">2,3,4,5</span></span>|<span data-ttu-id="c19ac-124">2、3、6、7、8</span><span class="sxs-lookup"><span data-stu-id="c19ac-124">2,3,6,7,8</span></span>|<span data-ttu-id="c19ac-125">2，3，9，10，11</span><span class="sxs-lookup"><span data-stu-id="c19ac-125">2,3,9,10,11</span></span>|<span data-ttu-id="c19ac-126">2、3、6、7</span><span class="sxs-lookup"><span data-stu-id="c19ac-126">2,3,6,7</span></span>|<span data-ttu-id="c19ac-127">2，3，9，10，11</span><span class="sxs-lookup"><span data-stu-id="c19ac-127">2,3,9,10,11</span></span>|<span data-ttu-id="c19ac-128">1</span><span class="sxs-lookup"><span data-stu-id="c19ac-128">1</span></span>|<span data-ttu-id="c19ac-129">1</span><span class="sxs-lookup"><span data-stu-id="c19ac-129">1</span></span>|<span data-ttu-id="c19ac-130">1</span><span class="sxs-lookup"><span data-stu-id="c19ac-130">1</span></span>|  
|<span data-ttu-id="c19ac-131">SQL_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="c19ac-131">SQL_TYPE_DATE</span></span>|<span data-ttu-id="c19ac-132">確定</span><span class="sxs-lookup"><span data-stu-id="c19ac-132">OK</span></span>|<span data-ttu-id="c19ac-133">12</span><span class="sxs-lookup"><span data-stu-id="c19ac-133">12</span></span>|<span data-ttu-id="c19ac-134">13</span><span class="sxs-lookup"><span data-stu-id="c19ac-134">13</span></span>|<span data-ttu-id="c19ac-135">12</span><span class="sxs-lookup"><span data-stu-id="c19ac-135">12</span></span>|<span data-ttu-id="c19ac-136">13，23</span><span class="sxs-lookup"><span data-stu-id="c19ac-136">13,23</span></span>|<span data-ttu-id="c19ac-137">14</span><span class="sxs-lookup"><span data-stu-id="c19ac-137">14</span></span>|<span data-ttu-id="c19ac-138">16</span><span class="sxs-lookup"><span data-stu-id="c19ac-138">16</span></span>|<span data-ttu-id="c19ac-139">16</span><span class="sxs-lookup"><span data-stu-id="c19ac-139">16</span></span>|  
|<span data-ttu-id="c19ac-140">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="c19ac-140">SQL_SS_TIME2</span></span>|<span data-ttu-id="c19ac-141">12</span><span class="sxs-lookup"><span data-stu-id="c19ac-141">12</span></span>|<span data-ttu-id="c19ac-142">8</span><span class="sxs-lookup"><span data-stu-id="c19ac-142">8</span></span>|<span data-ttu-id="c19ac-143">15</span><span class="sxs-lookup"><span data-stu-id="c19ac-143">15</span></span>|<span data-ttu-id="c19ac-144">確定</span><span class="sxs-lookup"><span data-stu-id="c19ac-144">OK</span></span>|<span data-ttu-id="c19ac-145">10、23</span><span class="sxs-lookup"><span data-stu-id="c19ac-145">10,23</span></span>|<span data-ttu-id="c19ac-146">17</span><span class="sxs-lookup"><span data-stu-id="c19ac-146">17</span></span>|<span data-ttu-id="c19ac-147">16</span><span class="sxs-lookup"><span data-stu-id="c19ac-147">16</span></span>|<span data-ttu-id="c19ac-148">16</span><span class="sxs-lookup"><span data-stu-id="c19ac-148">16</span></span>|  
|<span data-ttu-id="c19ac-149">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="c19ac-149">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="c19ac-150">18</span><span class="sxs-lookup"><span data-stu-id="c19ac-150">18</span></span>|<span data-ttu-id="c19ac-151">7、8</span><span class="sxs-lookup"><span data-stu-id="c19ac-151">7,8</span></span>|<span data-ttu-id="c19ac-152">確定</span><span class="sxs-lookup"><span data-stu-id="c19ac-152">OK</span></span>|<span data-ttu-id="c19ac-153">7</span><span class="sxs-lookup"><span data-stu-id="c19ac-153">7</span></span>|<span data-ttu-id="c19ac-154">23</span><span class="sxs-lookup"><span data-stu-id="c19ac-154">23</span></span>|<span data-ttu-id="c19ac-155">19</span><span class="sxs-lookup"><span data-stu-id="c19ac-155">19</span></span>|<span data-ttu-id="c19ac-156">16</span><span class="sxs-lookup"><span data-stu-id="c19ac-156">16</span></span>|<span data-ttu-id="c19ac-157">16</span><span class="sxs-lookup"><span data-stu-id="c19ac-157">16</span></span>|  
|<span data-ttu-id="c19ac-158">SQL_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="c19ac-158">SQL_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="c19ac-159">18，22</span><span class="sxs-lookup"><span data-stu-id="c19ac-159">18,22</span></span>|<span data-ttu-id="c19ac-160">7、8、20</span><span class="sxs-lookup"><span data-stu-id="c19ac-160">7,8,20</span></span>|<span data-ttu-id="c19ac-161">20</span><span class="sxs-lookup"><span data-stu-id="c19ac-161">20</span></span>|<span data-ttu-id="c19ac-162">7、20</span><span class="sxs-lookup"><span data-stu-id="c19ac-162">7,20</span></span>|<span data-ttu-id="c19ac-163">確定</span><span class="sxs-lookup"><span data-stu-id="c19ac-163">OK</span></span>|<span data-ttu-id="c19ac-164">21</span><span class="sxs-lookup"><span data-stu-id="c19ac-164">21</span></span>|<span data-ttu-id="c19ac-165">16</span><span class="sxs-lookup"><span data-stu-id="c19ac-165">16</span></span>|<span data-ttu-id="c19ac-166">16</span><span class="sxs-lookup"><span data-stu-id="c19ac-166">16</span></span>|  
  
## <a name="key-to-symbols"></a><span data-ttu-id="c19ac-167">符號的索引鍵</span><span class="sxs-lookup"><span data-stu-id="c19ac-167">Key to Symbols</span></span>  
  
|<span data-ttu-id="c19ac-168">符號</span><span class="sxs-lookup"><span data-stu-id="c19ac-168">Symbol</span></span>|<span data-ttu-id="c19ac-169">意義</span><span class="sxs-lookup"><span data-stu-id="c19ac-169">Meaning</span></span>|  
|------------|-------------|  
|<span data-ttu-id="c19ac-170">確定</span><span class="sxs-lookup"><span data-stu-id="c19ac-170">OK</span></span>|<span data-ttu-id="c19ac-171">沒有轉換問題。</span><span class="sxs-lookup"><span data-stu-id="c19ac-171">No conversion issues.</span></span>|  
|<span data-ttu-id="c19ac-172">1</span><span class="sxs-lookup"><span data-stu-id="c19ac-172">1</span></span>|<span data-ttu-id="c19ac-173">適用 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 之前的規則。</span><span class="sxs-lookup"><span data-stu-id="c19ac-173">Rules prior to [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] apply.</span></span>|  
|<span data-ttu-id="c19ac-174">2</span><span class="sxs-lookup"><span data-stu-id="c19ac-174">2</span></span>|<span data-ttu-id="c19ac-175">忽略開頭和尾端空白。</span><span class="sxs-lookup"><span data-stu-id="c19ac-175">Leading and trailing spaces are ignored.</span></span>|  
|<span data-ttu-id="c19ac-176">3</span><span class="sxs-lookup"><span data-stu-id="c19ac-176">3</span></span>|<span data-ttu-id="c19ac-177">字串會剖析成日期、時間、時區或時區時差，而且小數秒數最多允許 9 位數。</span><span class="sxs-lookup"><span data-stu-id="c19ac-177">The string is parsed into a date, time, timezone, or timezoneoffset, and allows up to 9 digits for fractional seconds.</span></span> <span data-ttu-id="c19ac-178">如果剖析了時區時差，時間就會轉換成用戶端時區。</span><span class="sxs-lookup"><span data-stu-id="c19ac-178">If a timezoneoffset is parsed, the time is converted to the client timezone.</span></span> <span data-ttu-id="c19ac-179">如果在此轉換期間發生錯誤，就會產生含有 SQLSTATE 22018 和訊息「日期時間欄位溢位」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="c19ac-179">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22018 and the message "Datetime field overflow".</span></span>|  
|<span data-ttu-id="c19ac-180">4</span><span class="sxs-lookup"><span data-stu-id="c19ac-180">4</span></span>|<span data-ttu-id="c19ac-181">如果此值不是有效的日期、時間戳記或時間戳記時差值，就會產生含有 SQLSTATE 22018 和訊息「轉換規格的字元值無效」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="c19ac-181">If the value is not a valid date, timestamp, or timestampoffset value, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span>|  
|<span data-ttu-id="c19ac-182">5</span><span class="sxs-lookup"><span data-stu-id="c19ac-182">5</span></span>|<span data-ttu-id="c19ac-183">如果時間不是零，就會產生含有 SQLSTATE 01S07 和訊息「小數位數截斷」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="c19ac-183">If the time is non-zero, a diagnostic record is generated with SQLSTATE 01S07 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="c19ac-184">6</span><span class="sxs-lookup"><span data-stu-id="c19ac-184">6</span></span>|<span data-ttu-id="c19ac-185">如果此值不是有效的時間、時間戳記或時間戳記時差值，就會產生含有 SQLSTATE 22018 和訊息「轉換規格的字元值無效」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="c19ac-185">If the value is not a valid time, timestamp, or timestampoffset value, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span>|  
|<span data-ttu-id="c19ac-186">7</span><span class="sxs-lookup"><span data-stu-id="c19ac-186">7</span></span>|<span data-ttu-id="c19ac-187">忽略日期元件。</span><span class="sxs-lookup"><span data-stu-id="c19ac-187">The date component is ignored.</span></span>|  
|<span data-ttu-id="c19ac-188">8</span><span class="sxs-lookup"><span data-stu-id="c19ac-188">8</span></span>|<span data-ttu-id="c19ac-189">如果小數秒數不是零，就會產生含有 SQLSTATE 01S07 和訊息「小數位數截斷」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="c19ac-189">If the fractional seconds are non-zero, a diagnostic record is generated with SQLSTATE 01S07 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="c19ac-190">9</span><span class="sxs-lookup"><span data-stu-id="c19ac-190">9</span></span>|<span data-ttu-id="c19ac-191">如果此值不是有效的日期、時間、時間戳記或時間戳記時差值，就會產生含有 SQLSTATE 22018 和訊息「轉換規格的字元值無效」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="c19ac-191">If the value is not a valid date, time, timestamp, or timestampoffset value, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span>|  
|<span data-ttu-id="c19ac-192">10</span><span class="sxs-lookup"><span data-stu-id="c19ac-192">10</span></span>|<span data-ttu-id="c19ac-193">如果此值是有效的時間，日期元件就會設定為目前的用戶端日期。</span><span class="sxs-lookup"><span data-stu-id="c19ac-193">If the value is a valid time, the date component is set to current client date.</span></span>|  
|<span data-ttu-id="c19ac-194">11</span><span class="sxs-lookup"><span data-stu-id="c19ac-194">11</span></span>|<span data-ttu-id="c19ac-195">如果此值是有效的日期，時間就會設定為零。</span><span class="sxs-lookup"><span data-stu-id="c19ac-195">If the value is a valid date, the time is set to zero.</span></span>|  
|<span data-ttu-id="c19ac-196">12</span><span class="sxs-lookup"><span data-stu-id="c19ac-196">12</span></span>|<span data-ttu-id="c19ac-197">產生含有 SQLSTATE 07006 和訊息「限制的資料類型屬性違規」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="c19ac-197">A diagnostic record is generated with SQLSTATE 07006 and the message "Restricted data type attribute violation".</span></span>|  
|<span data-ttu-id="c19ac-198">13</span><span class="sxs-lookup"><span data-stu-id="c19ac-198">13</span></span>|<span data-ttu-id="c19ac-199">時間會設定為零。</span><span class="sxs-lookup"><span data-stu-id="c19ac-199">The time is set to zero.</span></span>|  
|<span data-ttu-id="c19ac-200">14</span><span class="sxs-lookup"><span data-stu-id="c19ac-200">14</span></span>|<span data-ttu-id="c19ac-201">如果緩衝區不夠大，無法容納 SQL_DATE_STRUCT，就會產生含有 SQLSTATE 22003 和訊息「數值超出範圍」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="c19ac-201">If the buffer is not large enough to accommodate a SQL_DATE_STRUCT, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="c19ac-202">15</span><span class="sxs-lookup"><span data-stu-id="c19ac-202">15</span></span>|<span data-ttu-id="c19ac-203">日期會設定為目前的用戶端日期。</span><span class="sxs-lookup"><span data-stu-id="c19ac-203">The date is set to the current client date.</span></span>|  
|<span data-ttu-id="c19ac-204">16</span><span class="sxs-lookup"><span data-stu-id="c19ac-204">16</span></span>|<span data-ttu-id="c19ac-205">如果緩衝區不夠大，無法容納轉換的字串，只能容納小數秒數，就會發生截斷，而且會產生含有 SQLSTATE 01004 和訊息「字串資料，右邊已截斷」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="c19ac-205">If the buffer is not large enough to accommodate the converted string value but only fractional seconds, truncation occurs and a diagnostic record is generated with SQLSTATE 01004 and the message "String data, right truncated".</span></span> <span data-ttu-id="c19ac-206">如果緩衝區不夠大，無法在不截斷日期、時間或時差元件的情況下容納字串值，就會產生含有 SQLSTATE 22003 和訊息「數值超出範圍」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="c19ac-206">If the buffer is not large enough to accommodate the string value without truncation of date, time, or offset components, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span> <span data-ttu-id="c19ac-207">請注意，若為日期和時間戳記時差，不可能會出現 SQLSTATE 01004，因為已轉換字串最右邊的部分不會包含小數秒數。</span><span class="sxs-lookup"><span data-stu-id="c19ac-207">Note that for date and timestampoffset, SQLSTATE 01004 is not possible because the rightmost part of the converted string does not contain fractional seconds.</span></span> <span data-ttu-id="c19ac-208">因此，任何截斷都會導致資料遺失。</span><span class="sxs-lookup"><span data-stu-id="c19ac-208">Therefore, any truncation causes data loss.</span></span>|  
|<span data-ttu-id="c19ac-209">17</span><span class="sxs-lookup"><span data-stu-id="c19ac-209">17</span></span>|<span data-ttu-id="c19ac-210">如果緩衝區不夠大，無法容納 SQL_SS_TIME2_STRUCT，就會產生含有 SQLSTATE 22003 和訊息「數值超出範圍」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="c19ac-210">If the buffer is not large enough to accommodate a SQL_SS_TIME2_STRUCT, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="c19ac-211">18</span><span class="sxs-lookup"><span data-stu-id="c19ac-211">18</span></span>|<span data-ttu-id="c19ac-212">如果時間不是零，就會產生含有 SQLSTATE 01S07 和訊息「小數位數截斷」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="c19ac-212">If the time is non-zero, a diagnostic record is generated with SQLSTATE 01S07 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="c19ac-213">19</span><span class="sxs-lookup"><span data-stu-id="c19ac-213">19</span></span>|<span data-ttu-id="c19ac-214">如果伺服器類型為 datetime 或 smalldatetime，則此值會對應至 TDS 電傳格式，而且將為 4 位元組值 (若為 smalldatetime) 和 8 位元組值 (若為 datetime)。</span><span class="sxs-lookup"><span data-stu-id="c19ac-214">If the server type is datetime or smalldatetime, the value corresponds to the TDS wire format and will be a 4-byte value for smalldatetime and an 8-byte value for datetime.</span></span><br /><br /> <span data-ttu-id="c19ac-215">如果伺服器類型是 datetime2，此值就會傳回成 SQL_TIMESTAMP_STRUCT。</span><span class="sxs-lookup"><span data-stu-id="c19ac-215">If the server type is datetime2, the value is returned as a SQL_TIMESTAMP_STRUCT.</span></span> <span data-ttu-id="c19ac-216">如果緩衝區不夠大，無法容納傳回的值，就會產生含有 SQLSTATE 22003 和訊息「數值超出範圍」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="c19ac-216">If the buffer is not large enough to accommodate the returned value, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="c19ac-217">20</span><span class="sxs-lookup"><span data-stu-id="c19ac-217">20</span></span>|<span data-ttu-id="c19ac-218">時間會轉換成用戶端時區。</span><span class="sxs-lookup"><span data-stu-id="c19ac-218">The time is converted to the client timezone.</span></span> <span data-ttu-id="c19ac-219">如果進行這項轉換期間發生錯誤，就會產生含有 SQLSTATE 22008 和訊息「日期時間欄位溢位」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="c19ac-219">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span>|  
|<span data-ttu-id="c19ac-220">21</span><span class="sxs-lookup"><span data-stu-id="c19ac-220">21</span></span>|<span data-ttu-id="c19ac-221">如果緩衝區夠大，足以容納 SQL_SS_TIMESTAMPOFFSET_STRUCT，此值就會傳回成 SQL_SS_TIMESTAMPOFFSET_STRUCT。</span><span class="sxs-lookup"><span data-stu-id="c19ac-221">If the buffer is large enough to accommodate a SQL_SS_TIMESTAMPOFFSET_STRUCT, the value is returned as a SQL_SS_TIMESTAMPOFFSET_STRUCT.</span></span> <span data-ttu-id="c19ac-222">否則，系統會產生含有 SQLSTATE 22003 和訊息「數值超出範圍」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="c19ac-222">Otherwise, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="c19ac-223">22</span><span class="sxs-lookup"><span data-stu-id="c19ac-223">22</span></span>|<span data-ttu-id="c19ac-224">在擷取日期之前，此值會轉換成用戶端時區。</span><span class="sxs-lookup"><span data-stu-id="c19ac-224">The value is converted to the client timezone before the date is extracted.</span></span> <span data-ttu-id="c19ac-225">這樣做會在其他含有時間戳記時差類型的轉換中提供一致性。</span><span class="sxs-lookup"><span data-stu-id="c19ac-225">This provides consistency with other conversions with timestampoffset types.</span></span> <span data-ttu-id="c19ac-226">如果進行這項轉換期間發生錯誤，就會產生含有 SQLSTATE 22008 和訊息「日期時間欄位溢位」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="c19ac-226">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span> <span data-ttu-id="c19ac-227">這可能會產生與簡單截斷所取得之值不同的日期。</span><span class="sxs-lookup"><span data-stu-id="c19ac-227">This might result in a date that differs from the value obtained by simple truncation.</span></span>|  
  
 <span data-ttu-id="c19ac-228">本主題中的表格描述傳回用戶端之類型與繫結中之類型之間的轉換。</span><span class="sxs-lookup"><span data-stu-id="c19ac-228">The table in this topic describes conversions between the type returned to the client and the type in the binding.</span></span> <span data-ttu-id="c19ac-229">針對輸出參數，如果 SQLBindParameter 中指定的伺服器類型與伺服器上的實際類型不符，則伺服器將會執行隱含轉換，而且傳回用戶端的類型將會與透過 SQLBindParameter 指定的類型相符。</span><span class="sxs-lookup"><span data-stu-id="c19ac-229">For output parameters, if the server type specified in SQLBindParameter does not match the actual type on the server, an implicit conversion will be performed by the server and the type returned to the client will match the type specified through SQLBindParameter.</span></span> <span data-ttu-id="c19ac-230">當伺服器的轉換規則與上表中所列的不同時，這可能會導致未預期的轉換結果。</span><span class="sxs-lookup"><span data-stu-id="c19ac-230">This can lead to unexpected conversion results when the server's conversion rules are different from those listed in the preceding table.</span></span> <span data-ttu-id="c19ac-231">例如，必須提供預設日期時，[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 會使用 1900-1-1 而非目前的日期。</span><span class="sxs-lookup"><span data-stu-id="c19ac-231">For example, when a default date must be provided, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] uses 1900-1-1, rather than the current date.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c19ac-232">另請參閱</span><span class="sxs-lookup"><span data-stu-id="c19ac-232">See Also</span></span>  
 [<span data-ttu-id="c19ac-233">ODBC&#41;&#40;的日期和時間改善</span><span class="sxs-lookup"><span data-stu-id="c19ac-233">Date and Time Improvements &#40;ODBC&#41;</span></span>](date-and-time-improvements-odbc.md)  
  
  
