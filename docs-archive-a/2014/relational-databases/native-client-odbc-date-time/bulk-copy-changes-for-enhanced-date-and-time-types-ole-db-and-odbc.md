---
title: 增強型日期和時間類型的大量複製變更 (OLE DB 和 ODBC) |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- ODBC, bulk copy operations
- bulk copy [ODBC], changes for date/time improvements
ms.assetid: c29e0f5e-9b3c-42b3-9856-755f4510832f
author: rothja
ms.author: jroth
ms.openlocfilehash: cbb9a03a5ef7a85be279d5b3a210fa24af61622f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87595944"
---
# <a name="bulk-copy-changes-for-enhanced-date-and-time-types-ole-db-and-odbc"></a><span data-ttu-id="0ffc4-102">增強型日期和時間類型的大量複製變更 (OLE DB 和 ODBC)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-102">Bulk Copy Changes for Enhanced Date and Time Types (OLE DB and ODBC)</span></span>
  <span data-ttu-id="0ffc4-103">本主題描述可支援大量複製功能的日期/時間增強功能。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-103">This topic describes the date/time enhancements to support bulk copy functionality.</span></span> <span data-ttu-id="0ffc4-104">本主題中的資訊同時適用於 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 中的 OLE DB 和 ODBC。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-104">The information in this topic is valid for both OLE DB and ODBC in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
## <a name="format-files"></a><span data-ttu-id="0ffc4-105">格式檔案</span><span class="sxs-lookup"><span data-stu-id="0ffc4-105">Format Files</span></span>  
 <span data-ttu-id="0ffc4-106">以互動方式建立格式檔案時，下表描述用於指定日期/時間類型與對應主檔資料類型名稱的輸入。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-106">When building format files interactively, the following table describes the input used to specify date/time types and the corresponding host-file data type names.</span></span>  
  
|<span data-ttu-id="0ffc4-107">檔案儲存類型</span><span class="sxs-lookup"><span data-stu-id="0ffc4-107">File storage type</span></span>|<span data-ttu-id="0ffc4-108">主檔案資料類型</span><span class="sxs-lookup"><span data-stu-id="0ffc4-108">Host file data type</span></span>|<span data-ttu-id="0ffc4-109">提示的回應：「輸入欄位的檔案儲存類型 <field_name> [ \<default> ]： "</span><span class="sxs-lookup"><span data-stu-id="0ffc4-109">Response to the prompt: "Enter the file storage type of field <field_name> [\<default>]:"</span></span>|  
|-----------------------|-------------------------|-----------------------------------------------------------------------------------------------------|  
|<span data-ttu-id="0ffc4-110">Datetime</span><span class="sxs-lookup"><span data-stu-id="0ffc4-110">Datetime</span></span>|<span data-ttu-id="0ffc4-111">SQLDATETIME</span><span class="sxs-lookup"><span data-stu-id="0ffc4-111">SQLDATETIME</span></span>|<span data-ttu-id="0ffc4-112">d</span><span class="sxs-lookup"><span data-stu-id="0ffc4-112">d</span></span>|  
|<span data-ttu-id="0ffc4-113">Smalldatetime</span><span class="sxs-lookup"><span data-stu-id="0ffc4-113">Smalldatetime</span></span>|<span data-ttu-id="0ffc4-114">SQLDATETIM4</span><span class="sxs-lookup"><span data-stu-id="0ffc4-114">SQLDATETIM4</span></span>|<span data-ttu-id="0ffc4-115">D</span><span class="sxs-lookup"><span data-stu-id="0ffc4-115">D</span></span>|  
|<span data-ttu-id="0ffc4-116">Date</span><span class="sxs-lookup"><span data-stu-id="0ffc4-116">Date</span></span>|<span data-ttu-id="0ffc4-117">SQLDATE</span><span class="sxs-lookup"><span data-stu-id="0ffc4-117">SQLDATE</span></span>|<span data-ttu-id="0ffc4-118">de</span><span class="sxs-lookup"><span data-stu-id="0ffc4-118">de</span></span>|  
|<span data-ttu-id="0ffc4-119">Time</span><span class="sxs-lookup"><span data-stu-id="0ffc4-119">Time</span></span>|<span data-ttu-id="0ffc4-120">SQLTIME</span><span class="sxs-lookup"><span data-stu-id="0ffc4-120">SQLTIME</span></span>|<span data-ttu-id="0ffc4-121">te</span><span class="sxs-lookup"><span data-stu-id="0ffc4-121">te</span></span>|  
|<span data-ttu-id="0ffc4-122">Datetime2</span><span class="sxs-lookup"><span data-stu-id="0ffc4-122">Datetime2</span></span>|<span data-ttu-id="0ffc4-123">SQLDATETIME2</span><span class="sxs-lookup"><span data-stu-id="0ffc4-123">SQLDATETIME2</span></span>|<span data-ttu-id="0ffc4-124">d2</span><span class="sxs-lookup"><span data-stu-id="0ffc4-124">d2</span></span>|  
|<span data-ttu-id="0ffc4-125">Datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="0ffc4-125">Datetimeoffset</span></span>|<span data-ttu-id="0ffc4-126">SQLDATETIMEOFFSET</span><span class="sxs-lookup"><span data-stu-id="0ffc4-126">SQLDATETIMEOFFSET</span></span>|<span data-ttu-id="0ffc4-127">do</span><span class="sxs-lookup"><span data-stu-id="0ffc4-127">do</span></span>|  
  
 <span data-ttu-id="0ffc4-128">XML 格式檔案 XSD 將具備下列加入項目：</span><span class="sxs-lookup"><span data-stu-id="0ffc4-128">The XML format file XSD will have the following additions:</span></span>  
  
```  
<xs:complexType name="SQLDATETIME2">  
    <xs:complexContent>  
        <xs:extension base="bl:Fixed"/>  
    </xs:complexContent>  
</xs:complexType>  
<xs:complexType name="SQLDATETIMEOFFSET">  
    <xs:complexContent>  
        <xs:extension base="bl:Fixed"/>  
    </xs:complexContent>  
</xs:complexType>  
<xs:complexType name="SQLDATE">  
    <xs:complexContent>  
        <xs:extension base="bl:Fixed"/>  
    </xs:complexContent>  
</xs:complexType>  
<xs:complexType name="SQLTIME">  
    <xs:complexContent>  
        <xs:extension base="bl:Fixed"/>  
    </xs:complexContent>  
</xs:complexType>  
```  
  
## <a name="character-data-files"></a><span data-ttu-id="0ffc4-129">字元資料類型</span><span class="sxs-lookup"><span data-stu-id="0ffc4-129">Character Data Files</span></span>  
 <span data-ttu-id="0ffc4-130">在字元資料檔中，日期和時間值會以 odbc[日期和時間改善的資料類型支援](data-type-support-for-odbc-date-and-time-improvements.md)的「資料格式：字串和常值」一節中所述的方式表示，或是 OLE DB 的[OLE DB 日期和時間改善的資料類型支援](../native-client-ole-db-date-time/data-type-support-for-ole-db-date-and-time-improvements.md)。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-130">In character data files, date and time values are represented as described in the "Data Formats: Strings and Literals" section of [Data Type Support for ODBC Date and Time Improvements](data-type-support-for-odbc-date-and-time-improvements.md) for ODBC, or of [Data Type Support for OLE DB Date and Time Improvements](../native-client-ole-db-date-time/data-type-support-for-ole-db-date-and-time-improvements.md) for OLE DB.</span></span>  
  
 <span data-ttu-id="0ffc4-131">在原生資料檔中，四個新類型的日期和時間值會表示為其 TDS 標記法，其小數位數為 7 (，因為這是所支援的最大值 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ，而且 bcp 資料檔不會儲存這些資料行的小數位數) 。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-131">In native data fles, date and time values for the four new types are represented as their TDS representations with a scale of 7 (because this is the maximum supported by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and bcp data files do not store the scale of these columns).</span></span> <span data-ttu-id="0ffc4-132">現有 `datetime` 和類型的儲存 `smalldatetime` 或其表格式資料流程 (TDS) 標記法並不會變更。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-132">There is no change to the storage of the existing `datetime` and `smalldatetime` type or their tabular data stream (TDS) representations.</span></span>  
  
 <span data-ttu-id="0ffc4-133">對於 OLE DB，不同儲存類型的儲存大小如下所示：</span><span class="sxs-lookup"><span data-stu-id="0ffc4-133">The storage sizes for the different storage types are as follows for OLE DB:</span></span>  
  
|<span data-ttu-id="0ffc4-134">檔案儲存類型</span><span class="sxs-lookup"><span data-stu-id="0ffc4-134">File storage type</span></span>|<span data-ttu-id="0ffc4-135">儲存體大小 (以位元組為單位)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-135">Storage size in bytes</span></span>|  
|-----------------------|---------------------------|  
|<span data-ttu-id="0ffc4-136">Datetime</span><span class="sxs-lookup"><span data-stu-id="0ffc4-136">datetime</span></span>|<span data-ttu-id="0ffc4-137">8</span><span class="sxs-lookup"><span data-stu-id="0ffc4-137">8</span></span>|  
|<span data-ttu-id="0ffc4-138">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="0ffc4-138">smalldatetime</span></span>|<span data-ttu-id="0ffc4-139">4</span><span class="sxs-lookup"><span data-stu-id="0ffc4-139">4</span></span>|  
|<span data-ttu-id="0ffc4-140">date</span><span class="sxs-lookup"><span data-stu-id="0ffc4-140">date</span></span>|<span data-ttu-id="0ffc4-141">3</span><span class="sxs-lookup"><span data-stu-id="0ffc4-141">3</span></span>|  
|<span data-ttu-id="0ffc4-142">time</span><span class="sxs-lookup"><span data-stu-id="0ffc4-142">time</span></span>|<span data-ttu-id="0ffc4-143">6</span><span class="sxs-lookup"><span data-stu-id="0ffc4-143">6</span></span>|  
|<span data-ttu-id="0ffc4-144">datetime2</span><span class="sxs-lookup"><span data-stu-id="0ffc4-144">datetime2</span></span>|<span data-ttu-id="0ffc4-145">9</span><span class="sxs-lookup"><span data-stu-id="0ffc4-145">9</span></span>|  
|<span data-ttu-id="0ffc4-146">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="0ffc4-146">datetimeoffset</span></span>|<span data-ttu-id="0ffc4-147">11</span><span class="sxs-lookup"><span data-stu-id="0ffc4-147">11</span></span>|  
  
 <span data-ttu-id="0ffc4-148">ODBC 的大小如下所示。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-148">The sizes are as follows for ODBC.</span></span> <span data-ttu-id="0ffc4-149">請注意，以任何格式或資料檔儲存有效位數是沒有必要的，因為 BCP.exe 永遠會從伺服器擷取有效位數。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-149">Note that it is not necessary to store precision in either format or data files, because BCP.exe will always retrieve precision from the server.</span></span>  
  
|<span data-ttu-id="0ffc4-150">檔案儲存類型</span><span class="sxs-lookup"><span data-stu-id="0ffc4-150">File storage type</span></span>|<span data-ttu-id="0ffc4-151">儲存體大小 (以位元組為單位)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-151">Storage size in bytes</span></span>|<span data-ttu-id="0ffc4-152">儲存體格式</span><span class="sxs-lookup"><span data-stu-id="0ffc4-152">Storage format</span></span>|  
|-----------------------|---------------------------|--------------------|  
|<span data-ttu-id="0ffc4-153">datetime (d)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-153">datetime (d)</span></span>|<span data-ttu-id="0ffc4-154">8</span><span class="sxs-lookup"><span data-stu-id="0ffc4-154">8</span></span>|<span data-ttu-id="0ffc4-155">表格式資料流 (TDS)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-155">TDS</span></span>|  
|<span data-ttu-id="0ffc4-156">smalldatetime (D)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-156">smalldatetime (D)</span></span>|<span data-ttu-id="0ffc4-157">4</span><span class="sxs-lookup"><span data-stu-id="0ffc4-157">4</span></span>|<span data-ttu-id="0ffc4-158">表格式資料流 (TDS)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-158">TDS</span></span>|  
|<span data-ttu-id="0ffc4-159">date (de)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-159">date (de)</span></span>|<span data-ttu-id="0ffc4-160">3</span><span class="sxs-lookup"><span data-stu-id="0ffc4-160">3</span></span>|<span data-ttu-id="0ffc4-161">表格式資料流 (TDS)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-161">TDS</span></span>|  
|<span data-ttu-id="0ffc4-162">time (te)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-162">time (te)</span></span>|<span data-ttu-id="0ffc4-163">6</span><span class="sxs-lookup"><span data-stu-id="0ffc4-163">6</span></span>|<span data-ttu-id="0ffc4-164">表格式資料流 (TDS)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-164">TDS</span></span>|  
|<span data-ttu-id="0ffc4-165">datetime2 (d2)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-165">datetime2 (d2)</span></span>|<span data-ttu-id="0ffc4-166">9</span><span class="sxs-lookup"><span data-stu-id="0ffc4-166">9</span></span>|<span data-ttu-id="0ffc4-167">表格式資料流 (TDS)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-167">TDS</span></span>|  
|<span data-ttu-id="0ffc4-168">datetimeoffset (do)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-168">datetimeoffset (do)</span></span>|<span data-ttu-id="0ffc4-169">11</span><span class="sxs-lookup"><span data-stu-id="0ffc4-169">11</span></span>|<span data-ttu-id="0ffc4-170">表格式資料流 (TDS)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-170">TDS</span></span>|  
  
## <a name="bcp-types-in-sqlnclih"></a><span data-ttu-id="0ffc4-171">sqlncli.h 中的 BCP 類型</span><span class="sxs-lookup"><span data-stu-id="0ffc4-171">BCP Types in sqlncli.h</span></span>  
 <span data-ttu-id="0ffc4-172">下列類型是在 sqlncli.h 中定義的，可與 ODBC 的 BCP API 延伸模組搭配使用。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-172">The following types are defined in sqlncli.h to be used with the BCP API extensions to ODBC.</span></span> <span data-ttu-id="0ffc4-173">這些類型會利用 OLE DB 中 IBCPSession::BCPColFmt 的 *eUserDataType* 參數來傳遞。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-173">These types are passed with the *eUserDataType* parameter of IBCPSession::BCPColFmt in OLE DB.</span></span>  
  
|<span data-ttu-id="0ffc4-174">檔案儲存類型</span><span class="sxs-lookup"><span data-stu-id="0ffc4-174">File storage type</span></span>|<span data-ttu-id="0ffc4-175">主檔案資料類型</span><span class="sxs-lookup"><span data-stu-id="0ffc4-175">Host file data type</span></span>|<span data-ttu-id="0ffc4-176">輸入 sqlncli 以搭配 IBCPSession：： BCPColFmt 使用</span><span class="sxs-lookup"><span data-stu-id="0ffc4-176">Type in sqlncli.h for use with IBCPSession::BCPColFmt</span></span>|<span data-ttu-id="0ffc4-177">值</span><span class="sxs-lookup"><span data-stu-id="0ffc4-177">Value</span></span>|  
|-----------------------|-------------------------|-----------------------------------------------------------|-----------|  
|<span data-ttu-id="0ffc4-178">Datetime</span><span class="sxs-lookup"><span data-stu-id="0ffc4-178">Datetime</span></span>|<span data-ttu-id="0ffc4-179">SQLDATETIME</span><span class="sxs-lookup"><span data-stu-id="0ffc4-179">SQLDATETIME</span></span>|<span data-ttu-id="0ffc4-180">BCP_TYPE_SQLDATETIME</span><span class="sxs-lookup"><span data-stu-id="0ffc4-180">BCP_TYPE_SQLDATETIME</span></span>|<span data-ttu-id="0ffc4-181">0x3d</span><span class="sxs-lookup"><span data-stu-id="0ffc4-181">0x3d</span></span>|  
|<span data-ttu-id="0ffc4-182">Smalldatetime</span><span class="sxs-lookup"><span data-stu-id="0ffc4-182">Smalldatetime</span></span>|<span data-ttu-id="0ffc4-183">SQLDATETIM4</span><span class="sxs-lookup"><span data-stu-id="0ffc4-183">SQLDATETIM4</span></span>|<span data-ttu-id="0ffc4-184">BCP_TYPE_SQLDATETIME4</span><span class="sxs-lookup"><span data-stu-id="0ffc4-184">BCP_TYPE_SQLDATETIME4</span></span>|<span data-ttu-id="0ffc4-185">0x3a</span><span class="sxs-lookup"><span data-stu-id="0ffc4-185">0x3a</span></span>|  
|<span data-ttu-id="0ffc4-186">Date</span><span class="sxs-lookup"><span data-stu-id="0ffc4-186">Date</span></span>|<span data-ttu-id="0ffc4-187">SQLDATE</span><span class="sxs-lookup"><span data-stu-id="0ffc4-187">SQLDATE</span></span>|<span data-ttu-id="0ffc4-188">BCP_TYPE_SQLDATE</span><span class="sxs-lookup"><span data-stu-id="0ffc4-188">BCP_TYPE_SQLDATE</span></span>|<span data-ttu-id="0ffc4-189">0x28</span><span class="sxs-lookup"><span data-stu-id="0ffc4-189">0x28</span></span>|  
|<span data-ttu-id="0ffc4-190">Time</span><span class="sxs-lookup"><span data-stu-id="0ffc4-190">Time</span></span>|<span data-ttu-id="0ffc4-191">SQLTIME</span><span class="sxs-lookup"><span data-stu-id="0ffc4-191">SQLTIME</span></span>|<span data-ttu-id="0ffc4-192">BCP_TYPE_SQLTIME</span><span class="sxs-lookup"><span data-stu-id="0ffc4-192">BCP_TYPE_SQLTIME</span></span>|<span data-ttu-id="0ffc4-193">0x29</span><span class="sxs-lookup"><span data-stu-id="0ffc4-193">0x29</span></span>|  
|<span data-ttu-id="0ffc4-194">Datetime2</span><span class="sxs-lookup"><span data-stu-id="0ffc4-194">Datetime2</span></span>|<span data-ttu-id="0ffc4-195">SQLDATETIME2</span><span class="sxs-lookup"><span data-stu-id="0ffc4-195">SQLDATETIME2</span></span>|<span data-ttu-id="0ffc4-196">BCP_TYPE_SQLDATETIME2</span><span class="sxs-lookup"><span data-stu-id="0ffc4-196">BCP_TYPE_SQLDATETIME2</span></span>|<span data-ttu-id="0ffc4-197">0x2a</span><span class="sxs-lookup"><span data-stu-id="0ffc4-197">0x2a</span></span>|  
|<span data-ttu-id="0ffc4-198">Datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="0ffc4-198">Datetimeoffset</span></span>|<span data-ttu-id="0ffc4-199">SQLDATETIMEOFFSET</span><span class="sxs-lookup"><span data-stu-id="0ffc4-199">SQLDATETIMEOFFSET</span></span>|<span data-ttu-id="0ffc4-200">BCP_TYPE_SQLDATETIMEOFFSET</span><span class="sxs-lookup"><span data-stu-id="0ffc4-200">BCP_TYPE_SQLDATETIMEOFFSET</span></span>|<span data-ttu-id="0ffc4-201">0x2b</span><span class="sxs-lookup"><span data-stu-id="0ffc4-201">0x2b</span></span>|  
  
## <a name="bcp-data-type-conversions"></a><span data-ttu-id="0ffc4-202">BCP 資料類型轉換</span><span class="sxs-lookup"><span data-stu-id="0ffc4-202">BCP Data Type Conversions</span></span>  
 <span data-ttu-id="0ffc4-203">下表提供轉換資訊。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-203">The following tables provide conversion information.</span></span>  
  
 <span data-ttu-id="0ffc4-204">**OLE DB 注意**：下列轉換是由 IBCPSession 所執行。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-204">**OLE DB Note** The following conversions are performed by IBCPSession.</span></span> <span data-ttu-id="0ffc4-205">IRowsetFastLoad 會使用如[從用戶端到伺服器執行的轉換](../native-client-ole-db-date-time/conversions-performed-from-client-to-server.md)中所定義的 OLE DB 轉換。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-205">IRowsetFastLoad uses OLE DB conversions as defined in [Conversions Performed from Client to Server](../native-client-ole-db-date-time/conversions-performed-from-client-to-server.md).</span></span> <span data-ttu-id="0ffc4-206">請注意，datetime 值會捨入為一秒的 1/300，而 smalldatetime 值在執行以下所描述的用戶端轉換之後，會將其秒數設定為零。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-206">Note that datetime values are rounded to 1/300th of a second and smalldatetime values have seconds set to zero after client conversions described below have been performed.</span></span> <span data-ttu-id="0ffc4-207">Datetime 捨入會透過小時和分鐘 (但非日期) 傳播。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-207">Datetime rounding propagates through hours and minutes, but not the date.</span></span>  
  
|<span data-ttu-id="0ffc4-208">目標 --></span><span class="sxs-lookup"><span data-stu-id="0ffc4-208">To --></span></span><br /><br /> <span data-ttu-id="0ffc4-209">寄件者</span><span class="sxs-lookup"><span data-stu-id="0ffc4-209">From</span></span>|<span data-ttu-id="0ffc4-210">date</span><span class="sxs-lookup"><span data-stu-id="0ffc4-210">date</span></span>|<span data-ttu-id="0ffc4-211">time</span><span class="sxs-lookup"><span data-stu-id="0ffc4-211">time</span></span>|<span data-ttu-id="0ffc4-212">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="0ffc4-212">smalldatetime</span></span>|<span data-ttu-id="0ffc4-213">Datetime</span><span class="sxs-lookup"><span data-stu-id="0ffc4-213">datetime</span></span>|<span data-ttu-id="0ffc4-214">datetime2</span><span class="sxs-lookup"><span data-stu-id="0ffc4-214">datetime2</span></span>|<span data-ttu-id="0ffc4-215">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="0ffc4-215">datetimeoffset</span></span>|<span data-ttu-id="0ffc4-216">char</span><span class="sxs-lookup"><span data-stu-id="0ffc4-216">char</span></span>|<span data-ttu-id="0ffc4-217">wchar</span><span class="sxs-lookup"><span data-stu-id="0ffc4-217">wchar</span></span>|  
|------------------------|----------|----------|-------------------|--------------|---------------|--------------------|----------|-----------|  
|<span data-ttu-id="0ffc4-218">Date</span><span class="sxs-lookup"><span data-stu-id="0ffc4-218">Date</span></span>|<span data-ttu-id="0ffc4-219">1</span><span class="sxs-lookup"><span data-stu-id="0ffc4-219">1</span></span>|-|<span data-ttu-id="0ffc4-220">1,6</span><span class="sxs-lookup"><span data-stu-id="0ffc4-220">1,6</span></span>|<span data-ttu-id="0ffc4-221">1,6</span><span class="sxs-lookup"><span data-stu-id="0ffc4-221">1,6</span></span>|<span data-ttu-id="0ffc4-222">1,6</span><span class="sxs-lookup"><span data-stu-id="0ffc4-222">1,6</span></span>|<span data-ttu-id="0ffc4-223">1,5,6</span><span class="sxs-lookup"><span data-stu-id="0ffc4-223">1,5,6</span></span>|<span data-ttu-id="0ffc4-224">1,3</span><span class="sxs-lookup"><span data-stu-id="0ffc4-224">1,3</span></span>|<span data-ttu-id="0ffc4-225">1,3</span><span class="sxs-lookup"><span data-stu-id="0ffc4-225">1,3</span></span>|  
|<span data-ttu-id="0ffc4-226">Time</span><span class="sxs-lookup"><span data-stu-id="0ffc4-226">Time</span></span>|<span data-ttu-id="0ffc4-227">N/A</span><span class="sxs-lookup"><span data-stu-id="0ffc4-227">N/A</span></span>|<span data-ttu-id="0ffc4-228">1,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-228">1,10</span></span>|<span data-ttu-id="0ffc4-229">1,7,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-229">1,7,10</span></span>|<span data-ttu-id="0ffc4-230">1,7,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-230">1,7,10</span></span>|<span data-ttu-id="0ffc4-231">1,7,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-231">1,7,10</span></span>|<span data-ttu-id="0ffc4-232">1,5,7,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-232">1,5,7,10</span></span>|<span data-ttu-id="0ffc4-233">1,3</span><span class="sxs-lookup"><span data-stu-id="0ffc4-233">1,3</span></span>|<span data-ttu-id="0ffc4-234">1,3</span><span class="sxs-lookup"><span data-stu-id="0ffc4-234">1,3</span></span>|  
|<span data-ttu-id="0ffc4-235">Smalldatetime</span><span class="sxs-lookup"><span data-stu-id="0ffc4-235">Smalldatetime</span></span>|<span data-ttu-id="0ffc4-236">1,2</span><span class="sxs-lookup"><span data-stu-id="0ffc4-236">1,2</span></span>|<span data-ttu-id="0ffc4-237">1,4,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-237">1,4,10</span></span>|<span data-ttu-id="0ffc4-238">1</span><span class="sxs-lookup"><span data-stu-id="0ffc4-238">1</span></span>|<span data-ttu-id="0ffc4-239">1</span><span class="sxs-lookup"><span data-stu-id="0ffc4-239">1</span></span>|<span data-ttu-id="0ffc4-240">1,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-240">1,10</span></span>|<span data-ttu-id="0ffc4-241">1,5,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-241">1,5,10</span></span>|<span data-ttu-id="0ffc4-242">1,11</span><span class="sxs-lookup"><span data-stu-id="0ffc4-242">1,11</span></span>|<span data-ttu-id="0ffc4-243">1,11</span><span class="sxs-lookup"><span data-stu-id="0ffc4-243">1,11</span></span>|  
|<span data-ttu-id="0ffc4-244">Datetime</span><span class="sxs-lookup"><span data-stu-id="0ffc4-244">Datetime</span></span>|<span data-ttu-id="0ffc4-245">1,2</span><span class="sxs-lookup"><span data-stu-id="0ffc4-245">1,2</span></span>|<span data-ttu-id="0ffc4-246">1,4,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-246">1,4,10</span></span>|<span data-ttu-id="0ffc4-247">1,12</span><span class="sxs-lookup"><span data-stu-id="0ffc4-247">1,12</span></span>|<span data-ttu-id="0ffc4-248">1</span><span class="sxs-lookup"><span data-stu-id="0ffc4-248">1</span></span>|<span data-ttu-id="0ffc4-249">1,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-249">1,10</span></span>|<span data-ttu-id="0ffc4-250">1,5,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-250">1,5,10</span></span>|<span data-ttu-id="0ffc4-251">1,11</span><span class="sxs-lookup"><span data-stu-id="0ffc4-251">1,11</span></span>|<span data-ttu-id="0ffc4-252">1,11</span><span class="sxs-lookup"><span data-stu-id="0ffc4-252">1,11</span></span>|  
|<span data-ttu-id="0ffc4-253">Datetime2</span><span class="sxs-lookup"><span data-stu-id="0ffc4-253">Datetime2</span></span>|<span data-ttu-id="0ffc4-254">1,2</span><span class="sxs-lookup"><span data-stu-id="0ffc4-254">1,2</span></span>|<span data-ttu-id="0ffc4-255">1,4,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-255">1,4,10</span></span>|<span data-ttu-id="0ffc4-256">1,10 (ODBC)1,12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-256">1,10 (ODBC)1,12 (OLE DB)</span></span>|<span data-ttu-id="0ffc4-257">1,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-257">1,10</span></span>|<span data-ttu-id="0ffc4-258">1,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-258">1,10</span></span>|<span data-ttu-id="0ffc4-259">1,5,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-259">1,5,10</span></span>|<span data-ttu-id="0ffc4-260">1,3</span><span class="sxs-lookup"><span data-stu-id="0ffc4-260">1,3</span></span>|<span data-ttu-id="0ffc4-261">1,3</span><span class="sxs-lookup"><span data-stu-id="0ffc4-261">1,3</span></span>|  
|<span data-ttu-id="0ffc4-262">Datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="0ffc4-262">Datetimeoffset</span></span>|<span data-ttu-id="0ffc4-263">1,2,8</span><span class="sxs-lookup"><span data-stu-id="0ffc4-263">1,2,8</span></span>|<span data-ttu-id="0ffc4-264">1,4,8,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-264">1,4,8,10</span></span>|<span data-ttu-id="0ffc4-265">1,8,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-265">1,8,10</span></span>|<span data-ttu-id="0ffc4-266">1,8,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-266">1,8,10</span></span>|<span data-ttu-id="0ffc4-267">1,8,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-267">1,8,10</span></span>|<span data-ttu-id="0ffc4-268">1,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-268">1,10</span></span>|<span data-ttu-id="0ffc4-269">1,3</span><span class="sxs-lookup"><span data-stu-id="0ffc4-269">1,3</span></span>|<span data-ttu-id="0ffc4-270">1,3</span><span class="sxs-lookup"><span data-stu-id="0ffc4-270">1,3</span></span>|  
|<span data-ttu-id="0ffc4-271">Char/wchar (date)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-271">Char/wchar (date)</span></span>|<span data-ttu-id="0ffc4-272">9</span><span class="sxs-lookup"><span data-stu-id="0ffc4-272">9</span></span>|-|<span data-ttu-id="0ffc4-273">9,6 (ODBC)9,6,12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-273">9,6 (ODBC)9,6,12 (OLE DB)</span></span>|<span data-ttu-id="0ffc4-274">9,6 (ODBC)9,6,12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-274">9,6 (ODBC)9,6,12 (OLE DB)</span></span>|<span data-ttu-id="0ffc4-275">9,6</span><span class="sxs-lookup"><span data-stu-id="0ffc4-275">9,6</span></span>|<span data-ttu-id="0ffc4-276">9,5,6</span><span class="sxs-lookup"><span data-stu-id="0ffc4-276">9,5,6</span></span>|<span data-ttu-id="0ffc4-277">N/A</span><span class="sxs-lookup"><span data-stu-id="0ffc4-277">N/A</span></span>|<span data-ttu-id="0ffc4-278">N/A</span><span class="sxs-lookup"><span data-stu-id="0ffc4-278">N/A</span></span>|  
|<span data-ttu-id="0ffc4-279">Char/wchar (time)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-279">Char/wchar (time)</span></span>|-|<span data-ttu-id="0ffc4-280">9,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-280">9,10</span></span>|<span data-ttu-id="0ffc4-281">9,7,10 (ODBC)9,7,10,12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-281">9,7,10 (ODBC)9,7,10,12 (OLE DB)</span></span>|<span data-ttu-id="0ffc4-282">9,7,10 (ODBC)9,7,10, 12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-282">9,7,10 (ODBC)9,7,10, 12 (OLE DB)</span></span>|<span data-ttu-id="0ffc4-283">9,7,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-283">9,7,10</span></span>|<span data-ttu-id="0ffc4-284">9,5,7,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-284">9,5,7,10</span></span>|<span data-ttu-id="0ffc4-285">N/A</span><span class="sxs-lookup"><span data-stu-id="0ffc4-285">N/A</span></span>|<span data-ttu-id="0ffc4-286">N/A</span><span class="sxs-lookup"><span data-stu-id="0ffc4-286">N/A</span></span>|  
|<span data-ttu-id="0ffc4-287">Char/wchar (datetime)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-287">Char/wchar (datetime)</span></span>|<span data-ttu-id="0ffc4-288">9,2</span><span class="sxs-lookup"><span data-stu-id="0ffc4-288">9,2</span></span>|<span data-ttu-id="0ffc4-289">9,4,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-289">9,4,10</span></span>|<span data-ttu-id="0ffc4-290">9,10 (ODBC)9,10,12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-290">9,10 (ODBC)9,10,12 (OLE DB)</span></span>|<span data-ttu-id="0ffc4-291">9,10 (ODBC)9,10,12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-291">9,10 (ODBC)9,10,12 (OLE DB)</span></span>|<span data-ttu-id="0ffc4-292">9,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-292">9,10</span></span>|<span data-ttu-id="0ffc4-293">9,5,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-293">9,5,10</span></span>|<span data-ttu-id="0ffc4-294">N/A</span><span class="sxs-lookup"><span data-stu-id="0ffc4-294">N/A</span></span>|<span data-ttu-id="0ffc4-295">N/A</span><span class="sxs-lookup"><span data-stu-id="0ffc4-295">N/A</span></span>|  
|<span data-ttu-id="0ffc4-296">Char/wchar (datetimeoffset)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-296">Char/wchar (datetimeoffset)</span></span>|<span data-ttu-id="0ffc4-297">9,2,8</span><span class="sxs-lookup"><span data-stu-id="0ffc4-297">9,2,8</span></span>|<span data-ttu-id="0ffc4-298">9,4,8,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-298">9,4,8,10</span></span>|<span data-ttu-id="0ffc4-299">9,8,10 (ODBC)9,8,10,12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-299">9,8,10 (ODBC)9,8,10,12 (OLE DB)</span></span>|<span data-ttu-id="0ffc4-300">9,8,10 (ODBC)9,8,10,12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="0ffc4-300">9,8,10 (ODBC)9,8,10,12 (OLE DB)</span></span>|<span data-ttu-id="0ffc4-301">9,8,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-301">9,8,10</span></span>|<span data-ttu-id="0ffc4-302">9,10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-302">9,10</span></span>|<span data-ttu-id="0ffc4-303">N/A</span><span class="sxs-lookup"><span data-stu-id="0ffc4-303">N/A</span></span>|<span data-ttu-id="0ffc4-304">N/A</span><span class="sxs-lookup"><span data-stu-id="0ffc4-304">N/A</span></span>|  
  
#### <a name="key-to-symbols"></a><span data-ttu-id="0ffc4-305">符號的索引鍵</span><span class="sxs-lookup"><span data-stu-id="0ffc4-305">Key to Symbols</span></span>  
  
|<span data-ttu-id="0ffc4-306">符號</span><span class="sxs-lookup"><span data-stu-id="0ffc4-306">Symbol</span></span>|<span data-ttu-id="0ffc4-307">意義</span><span class="sxs-lookup"><span data-stu-id="0ffc4-307">Meaning</span></span>|  
|------------|-------------|  
|-|<span data-ttu-id="0ffc4-308">不支援轉換。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-308">No conversion is supported.</span></span><br /><br /> <span data-ttu-id="0ffc4-309">系統會產生含有 SQLSTATE 07006 和訊息「限制的資料類型屬性違規」的 ODBC 診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-309">An ODBC diagnostic record is generated with SQLSTATE 07006 and the message "Restricted data type attribute violation".</span></span>|  
|<span data-ttu-id="0ffc4-310">1</span><span class="sxs-lookup"><span data-stu-id="0ffc4-310">1</span></span>|<span data-ttu-id="0ffc4-311">如果提供的資料無效，就會產生含有 SQLSTATE 22007 和訊息「無效的 datetime 格式」的 ODBC 診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-311">If the data supplied is not valid, an ODBC  diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span> <span data-ttu-id="0ffc4-312">對於 datetimeoffset 值，即使沒有要求轉換為 UTC，此時間部分在轉換到 UTC 之後仍然必須在範圍內。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-312">For datetimeoffset values, the time portion must be within range after conversion to UTC, even if no conversion to UTC is requested.</span></span> <span data-ttu-id="0ffc4-313">這是因為 TDS 和伺服器永遠會以 UTC 的 datetimeoffset 值，正規化時間。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-313">This is because TDS and the server always normalize the time in datetimeoffset values for UTC.</span></span> <span data-ttu-id="0ffc4-314">因此，用戶端必須確認時間元件在轉換為 UTC 之後，仍然位於支援的範圍內。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-314">So the client must check that time components are within the range supported after conversion to UTC.</span></span>|  
|<span data-ttu-id="0ffc4-315">2</span><span class="sxs-lookup"><span data-stu-id="0ffc4-315">2</span></span>|<span data-ttu-id="0ffc4-316">忽略時間元件。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-316">The time component is ignored.</span></span>|  
|<span data-ttu-id="0ffc4-317">3</span><span class="sxs-lookup"><span data-stu-id="0ffc4-317">3</span></span>|<span data-ttu-id="0ffc4-318">若為 ODBC，如果截斷時發生資料遺失，就會產生含有 SQLSTATE 22001 和訊息「字串資料，右邊已截斷」的診斷記錄， (小數位數) 從目的地資料行的大小決定，取決於下表。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-318">For ODBC, If truncation with data loss occurs, a diagnostic record is generated with SQLSTATE 22001 and message 'String data, right truncated' The number of fractional seconds digits (the scale) is determined from the destination column's size according to the following table.</span></span> <span data-ttu-id="0ffc4-319">對於大於資料表中範圍的資料行大小，就會隱含小數位數 7。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-319">For column sizes larger than the range in the table, a scale of 7 is implied.</span></span> <span data-ttu-id="0ffc4-320">此轉換應該最多允許九個小數秒位數，也就是 ODBC 所允許的最大值。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-320">This conversion should allow for up to nine fractional second digits, the maximum allowed by ODBC.</span></span><br /><br /> <span data-ttu-id="0ffc4-321">**類型：** DBTIME2</span><span class="sxs-lookup"><span data-stu-id="0ffc4-321">**Type:** DBTIME2</span></span><br /><br /> <span data-ttu-id="0ffc4-322">**隱含的小數位數 0：** 8</span><span class="sxs-lookup"><span data-stu-id="0ffc4-322">**Implied scale 0** 8</span></span><br /><br /> <span data-ttu-id="0ffc4-323">**隱含的小數值 1. 7** 10，16</span><span class="sxs-lookup"><span data-stu-id="0ffc4-323">**Implied scale 1..7** 10,16</span></span><br /><br /> <br /><br /> <span data-ttu-id="0ffc4-324">**類型：** DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="0ffc4-324">**Type:** DBTIMESTAMP</span></span><br /><br /> <span data-ttu-id="0ffc4-325">**隱含的小數位數 0：** 19</span><span class="sxs-lookup"><span data-stu-id="0ffc4-325">**Implied scale 0:** 19</span></span><br /><br /> <span data-ttu-id="0ffc4-326">**隱含的小數值 1 .. 7：** 21. 27</span><span class="sxs-lookup"><span data-stu-id="0ffc4-326">**Implied scale 1..7:** 21..27</span></span><br /><br /> <br /><br /> <span data-ttu-id="0ffc4-327">**類型：** DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="0ffc4-327">**Type:** DBTIMESTAMPOFFSET</span></span><br /><br /> <span data-ttu-id="0ffc4-328">**隱含的小數位數 0：** 26</span><span class="sxs-lookup"><span data-stu-id="0ffc4-328">**Implied scale 0:** 26</span></span><br /><br /> <span data-ttu-id="0ffc4-329">**隱含的小數值 1 .. 7：** 28. 34</span><span class="sxs-lookup"><span data-stu-id="0ffc4-329">**Implied scale 1..7:** 28..34</span></span><br /><br /> <span data-ttu-id="0ffc4-330">對於 OLE DB，如果截斷時發生資料損失，則會發佈錯誤。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-330">For OLE DB, if truncation with data loss occurs, an error is posted.</span></span> <span data-ttu-id="0ffc4-331">對於 datetime2，小數秒的位數 (小數位數) 會根據下表，從目的地資料行的大小決定。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-331">For datetime2, the number of fractional seconds digits (the scale) is determined from the destination column's size according to the following table.</span></span> <span data-ttu-id="0ffc4-332">對於大於資料表中範圍的資料行大小，就會隱含小數位數 9。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-332">For column sizes larger than the range in the table a scale of 9 is implied.</span></span> <span data-ttu-id="0ffc4-333">此轉換應該最多允許九個小數秒位數，也就是 OLE DB 所允許的最大值。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-333">This conversion should allow for up to nine fractional second digits, the maximum allowed by OLE DB.</span></span><br /><br /> <span data-ttu-id="0ffc4-334">**類型：** DBTIME2</span><span class="sxs-lookup"><span data-stu-id="0ffc4-334">**Type:** DBTIME2</span></span><br /><br /> <span data-ttu-id="0ffc4-335">**隱含的小數位數 0：** 8</span><span class="sxs-lookup"><span data-stu-id="0ffc4-335">**Implied scale 0** 8</span></span><br /><br /> <span data-ttu-id="0ffc4-336">**隱含的小數位數 1..9：** 1..9</span><span class="sxs-lookup"><span data-stu-id="0ffc4-336">**Implied scale 1..9** 1..9</span></span><br /><br /> <br /><br /> <span data-ttu-id="0ffc4-337">**類型：** DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="0ffc4-337">**Type:** DBTIMESTAMP</span></span><br /><br /> <span data-ttu-id="0ffc4-338">**隱含的小數位數 0：** 19</span><span class="sxs-lookup"><span data-stu-id="0ffc4-338">**Implied scale 0:** 19</span></span><br /><br /> <span data-ttu-id="0ffc4-339">**隱含的小數位數 1..9：** 21..29</span><span class="sxs-lookup"><span data-stu-id="0ffc4-339">**Implied scale 1..9:** 21..29</span></span><br /><br /> <br /><br /> <span data-ttu-id="0ffc4-340">**類型：** DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="0ffc4-340">**Type:** DBTIMESTAMPOFFSET</span></span><br /><br /> <span data-ttu-id="0ffc4-341">**隱含的小數位數 0：** 26</span><span class="sxs-lookup"><span data-stu-id="0ffc4-341">**Implied scale 0:** 26</span></span><br /><br /> <span data-ttu-id="0ffc4-342">**隱含的小數位數 1..9：** 28..36</span><span class="sxs-lookup"><span data-stu-id="0ffc4-342">**Implied scale 1..9:** 28..36</span></span>|  
|<span data-ttu-id="0ffc4-343">4</span><span class="sxs-lookup"><span data-stu-id="0ffc4-343">4</span></span>|<span data-ttu-id="0ffc4-344">忽略日期元件。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-344">The date component is ignored.</span></span>|  
|<span data-ttu-id="0ffc4-345">5</span><span class="sxs-lookup"><span data-stu-id="0ffc4-345">5</span></span>|<span data-ttu-id="0ffc4-346">時區會設定為 UTC (例如，00:00)。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-346">The timezone is set to UTC (for example, 00:00).</span></span>|  
|<span data-ttu-id="0ffc4-347">6</span><span class="sxs-lookup"><span data-stu-id="0ffc4-347">6</span></span>|<span data-ttu-id="0ffc4-348">時間會設定為零。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-348">The time is set to zero.</span></span>|  
|<span data-ttu-id="0ffc4-349">7</span><span class="sxs-lookup"><span data-stu-id="0ffc4-349">7</span></span>|<span data-ttu-id="0ffc4-350">日期會設定為 1900-01-01。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-350">The date is set to 1900-01-01.</span></span>|  
|<span data-ttu-id="0ffc4-351">8</span><span class="sxs-lookup"><span data-stu-id="0ffc4-351">8</span></span>|<span data-ttu-id="0ffc4-352">忽略時區位移。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-352">The timezone offset is ignored.</span></span>|  
|<span data-ttu-id="0ffc4-353">9</span><span class="sxs-lookup"><span data-stu-id="0ffc4-353">9</span></span>|<span data-ttu-id="0ffc4-354">根據出現的第一個標點符號字元以及剩餘的元件是否存在，字串會經過剖析，並轉換為 date、datetime、datetimeoffset 或 time 值。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-354">The string is parsed and converted to a date, datetime, datetimeoffset, or time value, depending on the first punctuation character encountered and presence of remaining components.</span></span> <span data-ttu-id="0ffc4-355">接著，在此程序針對來源類型探索本主題結尾之資料表中的規則之後，此字串會轉換為目標類型。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-355">The string is then converted to the target type, following the rules in the table at the end of this topic for the source type discovered by this process.</span></span> <span data-ttu-id="0ffc4-356">如果剖析提供的資料時一定會發生錯誤，或如果任何元件部分超出允許的範圍之外，或如果沒有從常值類型轉換為目標類型，就會發佈錯誤 (OLE DB)，會產生包含 SQLSTATE 22018 和訊息「轉換規格的字元值無效」的 ODBC 診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-356">If the data supplied cannot be parsed without error, or if any component part is outside the range allowed, or if there is no conversion from the literal type to target type, an error is posted (OLE DB) or an ODBC diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span> <span data-ttu-id="0ffc4-357">對於 datetime 和 smalldatetime 參數，如果年份超出這些類型支援的範圍，就會發佈錯誤 (OLE DB)，或產生含有 SQLSATE 22007 和訊息「無效的 datetime 格式」的 ODBC 診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-357">For datetime and smalldatetime parameters, if the year is outside the range these types support, an error is posted (OLE DB) or an ODBC diagnostic record is generated with SQLSATE 22007 and the message "Invalid datetime format".</span></span><br /><br /> <span data-ttu-id="0ffc4-358">對於 datetimeoffset，即使沒有要求轉換為 UTC，此值在轉換到 UTC 之後仍然必須在範圍內。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-358">For datetimeoffset, the value must be within range after conversion to UTC, even if no conversion to UTC is requested.</span></span> <span data-ttu-id="0ffc4-359">這是因為 TDS 和伺服器永遠會以 UTC 的 datetimeoffset 值，將時間正規化，因此用戶端必須在轉換成 UTC 之後，確認時間元件位於支援的範圍內。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-359">This is because TDS and the server always normalize the time in datetimeoffset values for UTC, so the client must verify that time components are within the range supported after conversion to UTC.</span></span> <span data-ttu-id="0ffc4-360">如果此值不在支援的 UTC 範圍內，就會發佈錯誤 (OLE DB)，或產生含有 SQLSTATE 22007 和訊息「無效的 datetime 格式」的 ODBC 診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-360">If the value is not within the supported UTC range, an error is posted (OLE DB), or an ODBC diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span>|  
|<span data-ttu-id="0ffc4-361">10</span><span class="sxs-lookup"><span data-stu-id="0ffc4-361">10</span></span>|<span data-ttu-id="0ffc4-362">如果在從用戶端轉換為伺服器時發生資料遺失的截斷，就會發佈錯誤 (OLE DB)，或產生包含 SQLSTATE 22008 以及「日期時間欄位溢位」訊息的 ODBC 診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-362">If truncation with data loss occurs on a client to server conversion, an error is posted (OLE DB) or an ODBC diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span> <span data-ttu-id="0ffc4-363">如果此值落在伺服器使用之 UTC 範圍所代表的範圍外，也可能發生這個錯誤。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-363">This error also occurs if the value falls outside the range that can be represented by the UTC range used by the server.</span></span> <span data-ttu-id="0ffc4-364">如果在從伺服器轉換為用戶端時發生秒或小數秒的截斷，只會有一個警告。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-364">If seconds or fractional seconds truncation occurs in a server to client conversion, there is only a warning.</span></span>|  
|<span data-ttu-id="0ffc4-365">11</span><span class="sxs-lookup"><span data-stu-id="0ffc4-365">11</span></span>|<span data-ttu-id="0ffc4-366">如果截斷時發生資料損失，則會產生診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-366">If truncation with data loss occurs, a diagnostic record is generated.</span></span><br /><br /> <span data-ttu-id="0ffc4-367">在伺服器轉換為用戶端時，這是一個警告 (ODBC SQLSTATE S1000)。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-367">On a server-to-client conversion, this is a warning (ODBC SQLSTATE S1000).</span></span><br /><br /> <span data-ttu-id="0ffc4-368">在用戶端轉換為伺服器時，這是一個錯誤 (ODBC SQLSTATE 22001)。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-368">On a client-to-server conversion, this is an error (ODBC SQLSTATE 22001).</span></span>|  
|<span data-ttu-id="0ffc4-369">12</span><span class="sxs-lookup"><span data-stu-id="0ffc4-369">12</span></span>|<span data-ttu-id="0ffc4-370">秒數會設定為零，而小數秒會遭到捨棄。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-370">Seconds are set to zero and fractional seconds are discarded.</span></span> <span data-ttu-id="0ffc4-371">不可能發生截斷錯誤。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-371">No truncation error is possible.</span></span>|  
|<span data-ttu-id="0ffc4-372">N/A</span><span class="sxs-lookup"><span data-stu-id="0ffc4-372">N/A</span></span>|<span data-ttu-id="0ffc4-373">系統會維持現有 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 和舊有的行為。</span><span class="sxs-lookup"><span data-stu-id="0ffc4-373">Existing [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and earlier behavior is maintained.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="0ffc4-374">另請參閱</span><span class="sxs-lookup"><span data-stu-id="0ffc4-374">See Also</span></span>  
 <span data-ttu-id="0ffc4-375">[ODBC&#41;&#40;的日期和時間改善](date-and-time-improvements-odbc.md) </span><span class="sxs-lookup"><span data-stu-id="0ffc4-375">[Date and Time Improvements &#40;ODBC&#41;](date-and-time-improvements-odbc.md) </span></span>  
 [<span data-ttu-id="0ffc4-376">日期和時間改善 &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="0ffc4-376">Date and Time Improvements &#40;OLE DB&#41;</span></span>](../native-client-ole-db-date-time/date-and-time-improvements-ole-db.md)  
  
  
