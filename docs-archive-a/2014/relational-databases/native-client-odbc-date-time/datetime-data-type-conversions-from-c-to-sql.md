---
title: 從 C 轉換成 SQL |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- conversions [ODBC], C to SQL
ms.assetid: 7ac098db-9147-4883-8da9-a58ab24a0d31
author: rothja
ms.author: jroth
ms.openlocfilehash: 2ec8856b9c516ff3693da2ebf1077289d414e589
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87598335"
---
# <a name="conversions-from-c-to-sql"></a><span data-ttu-id="69cf3-102">從 C 轉換成 SQL</span><span class="sxs-lookup"><span data-stu-id="69cf3-102">Conversions from C to SQL</span></span>
  <span data-ttu-id="69cf3-103">本主題列出當您從 C 類型轉換成 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 日期/時間類型時所要考慮的問題。</span><span class="sxs-lookup"><span data-stu-id="69cf3-103">This topic lists issues to consider when you convert from C types to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] date/time types.</span></span>  
  
 <span data-ttu-id="69cf3-104">下表描述的轉換會套用到用戶端上進行的轉換。</span><span class="sxs-lookup"><span data-stu-id="69cf3-104">The conversions described in the following table apply to conversions made on the client.</span></span> <span data-ttu-id="69cf3-105">如果用戶端針對參數所指定的小數秒有效位數與伺服器上所定義的小數秒有效位數不同，用戶端轉換可能會成功，但是在呼叫 `SQLExecute` 或 `SQLExecuteDirect` 時，伺服器將會傳回錯誤。</span><span class="sxs-lookup"><span data-stu-id="69cf3-105">In cases where the client specifies fractional second precision for a parameter that differs from that defined on the server, the client conversion might succeed but the server will return an error when `SQLExecute` or `SQLExecuteDirect` is called.</span></span> <span data-ttu-id="69cf3-106">特別是，ODBC 會將任何截斷的小數秒視為錯誤，而 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 行為將會捨去，例如，當您從 `datetime2(6)` 轉換成 `datetime2(2)` 時，會發生捨去。</span><span class="sxs-lookup"><span data-stu-id="69cf3-106">In particular, ODBC treats any truncation of fractional seconds as an error, whereas the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] behavior is to round; for example, rounding occurs when you go from `datetime2(6)` to `datetime2(2)`.</span></span> <span data-ttu-id="69cf3-107">Datetime 資料行值會捨去為一秒的 1/300，而 smalldatetime 資料行的秒數會由伺服器設定為零。</span><span class="sxs-lookup"><span data-stu-id="69cf3-107">Datetime column values are rounded to 1/300th of a second and smalldatetime columns have seconds set to zero by the server.</span></span>  
  
|||||||||  
|-|-|-|-|-|-|-|-|  
||<span data-ttu-id="69cf3-108">SQL_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="69cf3-108">SQL_TYPE_DATE</span></span>|<span data-ttu-id="69cf3-109">SQL_TYPE_TIME</span><span class="sxs-lookup"><span data-stu-id="69cf3-109">SQL_TYPE_TIME</span></span>|<span data-ttu-id="69cf3-110">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="69cf3-110">SQL_SS_TIME2</span></span>|<span data-ttu-id="69cf3-111">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="69cf3-111">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="69cf3-112">SQL_SS_TIMSTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="69cf3-112">SQL_SS_TIMSTAMPOFFSET</span></span>|<span data-ttu-id="69cf3-113">SQL_CHAR</span><span class="sxs-lookup"><span data-stu-id="69cf3-113">SQL_CHAR</span></span>|<span data-ttu-id="69cf3-114">SQL_WCHAR</span><span class="sxs-lookup"><span data-stu-id="69cf3-114">SQL_WCHAR</span></span>|  
|<span data-ttu-id="69cf3-115">SQL_C_DATE</span><span class="sxs-lookup"><span data-stu-id="69cf3-115">SQL_C_DATE</span></span>|<span data-ttu-id="69cf3-116">1</span><span class="sxs-lookup"><span data-stu-id="69cf3-116">1</span></span>|-|-|<span data-ttu-id="69cf3-117">1,6</span><span class="sxs-lookup"><span data-stu-id="69cf3-117">1,6</span></span>|<span data-ttu-id="69cf3-118">1,5,6</span><span class="sxs-lookup"><span data-stu-id="69cf3-118">1,5,6</span></span>|<span data-ttu-id="69cf3-119">1,13</span><span class="sxs-lookup"><span data-stu-id="69cf3-119">1,13</span></span>|<span data-ttu-id="69cf3-120">1,13</span><span class="sxs-lookup"><span data-stu-id="69cf3-120">1,13</span></span>|  
|<span data-ttu-id="69cf3-121">SQL_C_TIME</span><span class="sxs-lookup"><span data-stu-id="69cf3-121">SQL_C_TIME</span></span>|-|<span data-ttu-id="69cf3-122">1</span><span class="sxs-lookup"><span data-stu-id="69cf3-122">1</span></span>|<span data-ttu-id="69cf3-123">1</span><span class="sxs-lookup"><span data-stu-id="69cf3-123">1</span></span>|<span data-ttu-id="69cf3-124">1,7</span><span class="sxs-lookup"><span data-stu-id="69cf3-124">1,7</span></span>|<span data-ttu-id="69cf3-125">1、5、7</span><span class="sxs-lookup"><span data-stu-id="69cf3-125">1,5,7</span></span>|<span data-ttu-id="69cf3-126">1,13</span><span class="sxs-lookup"><span data-stu-id="69cf3-126">1,13</span></span>|<span data-ttu-id="69cf3-127">1,13</span><span class="sxs-lookup"><span data-stu-id="69cf3-127">1,13</span></span>|  
|<span data-ttu-id="69cf3-128">SQL_C_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="69cf3-128">SQL_C_SS_TIME2</span></span>|-|<span data-ttu-id="69cf3-129">1,3</span><span class="sxs-lookup"><span data-stu-id="69cf3-129">1,3</span></span>|<span data-ttu-id="69cf3-130">1,10</span><span class="sxs-lookup"><span data-stu-id="69cf3-130">1,10</span></span>|<span data-ttu-id="69cf3-131">1,7</span><span class="sxs-lookup"><span data-stu-id="69cf3-131">1,7</span></span>|<span data-ttu-id="69cf3-132">1、5、7</span><span class="sxs-lookup"><span data-stu-id="69cf3-132">1,5,7</span></span>|<span data-ttu-id="69cf3-133">1,13</span><span class="sxs-lookup"><span data-stu-id="69cf3-133">1,13</span></span>|<span data-ttu-id="69cf3-134">1,13</span><span class="sxs-lookup"><span data-stu-id="69cf3-134">1,13</span></span>|  
|<span data-ttu-id="69cf3-135">SQL_C_BINARY(SQL_SS_TIME2_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="69cf3-135">SQL_C_BINARY(SQL_SS_TIME2_STRUCT)</span></span>|<span data-ttu-id="69cf3-136">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-136">N/A</span></span>|<span data-ttu-id="69cf3-137">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-137">N/A</span></span>|<span data-ttu-id="69cf3-138">1,10,11</span><span class="sxs-lookup"><span data-stu-id="69cf3-138">1,10,11</span></span>|<span data-ttu-id="69cf3-139">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-139">N/A</span></span>|<span data-ttu-id="69cf3-140">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-140">N/A</span></span>|<span data-ttu-id="69cf3-141">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-141">N/A</span></span>|<span data-ttu-id="69cf3-142">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-142">N/A</span></span>|  
|<span data-ttu-id="69cf3-143">SQL_C_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="69cf3-143">SQL_C_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="69cf3-144">1,2</span><span class="sxs-lookup"><span data-stu-id="69cf3-144">1,2</span></span>|<span data-ttu-id="69cf3-145">1,3,4</span><span class="sxs-lookup"><span data-stu-id="69cf3-145">1,3,4</span></span>|<span data-ttu-id="69cf3-146">1,4,10</span><span class="sxs-lookup"><span data-stu-id="69cf3-146">1,4,10</span></span>|<span data-ttu-id="69cf3-147">1,10</span><span class="sxs-lookup"><span data-stu-id="69cf3-147">1,10</span></span>|<span data-ttu-id="69cf3-148">1,5,10</span><span class="sxs-lookup"><span data-stu-id="69cf3-148">1,5,10</span></span>|<span data-ttu-id="69cf3-149">1,13</span><span class="sxs-lookup"><span data-stu-id="69cf3-149">1,13</span></span>|<span data-ttu-id="69cf3-150">1,13</span><span class="sxs-lookup"><span data-stu-id="69cf3-150">1,13</span></span>|  
|<span data-ttu-id="69cf3-151">SQL_C_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="69cf3-151">SQL_C_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="69cf3-152">1,2,8</span><span class="sxs-lookup"><span data-stu-id="69cf3-152">1,2,8</span></span>|<span data-ttu-id="69cf3-153">1,3,4,8</span><span class="sxs-lookup"><span data-stu-id="69cf3-153">1,3,4,8</span></span>|<span data-ttu-id="69cf3-154">1,4,8,10</span><span class="sxs-lookup"><span data-stu-id="69cf3-154">1,4,8,10</span></span>|<span data-ttu-id="69cf3-155">1,8,10</span><span class="sxs-lookup"><span data-stu-id="69cf3-155">1,8,10</span></span>|<span data-ttu-id="69cf3-156">1,10</span><span class="sxs-lookup"><span data-stu-id="69cf3-156">1,10</span></span>|<span data-ttu-id="69cf3-157">1,13</span><span class="sxs-lookup"><span data-stu-id="69cf3-157">1,13</span></span>|<span data-ttu-id="69cf3-158">1,13</span><span class="sxs-lookup"><span data-stu-id="69cf3-158">1,13</span></span>|  
|<span data-ttu-id="69cf3-159">SQL_C_BINARY(SQL_SS_TIMESTAMPOFFSET_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="69cf3-159">SQL_C_BINARY(SQL_SS_TIMESTAMPOFFSET_STRUCT)</span></span>|<span data-ttu-id="69cf3-160">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-160">N/A</span></span>|<span data-ttu-id="69cf3-161">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-161">N/A</span></span>|<span data-ttu-id="69cf3-162">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-162">N/A</span></span>|<span data-ttu-id="69cf3-163">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-163">N/A</span></span>|<span data-ttu-id="69cf3-164">1,10,11</span><span class="sxs-lookup"><span data-stu-id="69cf3-164">1,10,11</span></span>|<span data-ttu-id="69cf3-165">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-165">N/A</span></span>|<span data-ttu-id="69cf3-166">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-166">N/A</span></span>|  
|<span data-ttu-id="69cf3-167">SQL_C_CHAR/SQL_WCHAR (date)</span><span class="sxs-lookup"><span data-stu-id="69cf3-167">SQL_C_CHAR/SQL_WCHAR (date)</span></span>|<span data-ttu-id="69cf3-168">9</span><span class="sxs-lookup"><span data-stu-id="69cf3-168">9</span></span>|<span data-ttu-id="69cf3-169">9</span><span class="sxs-lookup"><span data-stu-id="69cf3-169">9</span></span>|<span data-ttu-id="69cf3-170">9</span><span class="sxs-lookup"><span data-stu-id="69cf3-170">9</span></span>|<span data-ttu-id="69cf3-171">9,6</span><span class="sxs-lookup"><span data-stu-id="69cf3-171">9,6</span></span>|<span data-ttu-id="69cf3-172">9,5,6</span><span class="sxs-lookup"><span data-stu-id="69cf3-172">9,5,6</span></span>|<span data-ttu-id="69cf3-173">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-173">N/A</span></span>|<span data-ttu-id="69cf3-174">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-174">N/A</span></span>|  
|<span data-ttu-id="69cf3-175">SQL_C_CHAR/SQL_WCHAR (time2)</span><span class="sxs-lookup"><span data-stu-id="69cf3-175">SQL_C_CHAR/SQL_WCHAR (time2)</span></span>|<span data-ttu-id="69cf3-176">9</span><span class="sxs-lookup"><span data-stu-id="69cf3-176">9</span></span>|<span data-ttu-id="69cf3-177">9，3</span><span class="sxs-lookup"><span data-stu-id="69cf3-177">9,3</span></span>|<span data-ttu-id="69cf3-178">9,10</span><span class="sxs-lookup"><span data-stu-id="69cf3-178">9,10</span></span>|<span data-ttu-id="69cf3-179">9,7,10</span><span class="sxs-lookup"><span data-stu-id="69cf3-179">9,7,10</span></span>|<span data-ttu-id="69cf3-180">9,5,7,10</span><span class="sxs-lookup"><span data-stu-id="69cf3-180">9,5,7,10</span></span>|<span data-ttu-id="69cf3-181">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-181">N/A</span></span>|<span data-ttu-id="69cf3-182">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-182">N/A</span></span>|  
|<span data-ttu-id="69cf3-183">SQL_C_CHAR/SQL_WCHAR (datetime)</span><span class="sxs-lookup"><span data-stu-id="69cf3-183">SQL_C_CHAR/SQL_WCHAR (datetime)</span></span>|<span data-ttu-id="69cf3-184">9,2</span><span class="sxs-lookup"><span data-stu-id="69cf3-184">9,2</span></span>|<span data-ttu-id="69cf3-185">9，3，4</span><span class="sxs-lookup"><span data-stu-id="69cf3-185">9,3,4</span></span>|<span data-ttu-id="69cf3-186">9,4,10</span><span class="sxs-lookup"><span data-stu-id="69cf3-186">9,4,10</span></span>|<span data-ttu-id="69cf3-187">9,10</span><span class="sxs-lookup"><span data-stu-id="69cf3-187">9,10</span></span>|<span data-ttu-id="69cf3-188">9,5,10</span><span class="sxs-lookup"><span data-stu-id="69cf3-188">9,5,10</span></span>|<span data-ttu-id="69cf3-189">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-189">N/A</span></span>|<span data-ttu-id="69cf3-190">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-190">N/A</span></span>|  
|<span data-ttu-id="69cf3-191">SQL_C_CHAR/SQL_WCHAR (datetimeoffset)</span><span class="sxs-lookup"><span data-stu-id="69cf3-191">SQL_C_CHAR/SQL_WCHAR (datetimeoffset)</span></span>|<span data-ttu-id="69cf3-192">9,2,8</span><span class="sxs-lookup"><span data-stu-id="69cf3-192">9,2,8</span></span>|<span data-ttu-id="69cf3-193">9，3，4，8</span><span class="sxs-lookup"><span data-stu-id="69cf3-193">9,3,4,8</span></span>|<span data-ttu-id="69cf3-194">9,4,8,10</span><span class="sxs-lookup"><span data-stu-id="69cf3-194">9,4,8,10</span></span>|<span data-ttu-id="69cf3-195">9,8,10</span><span class="sxs-lookup"><span data-stu-id="69cf3-195">9,8,10</span></span>|<span data-ttu-id="69cf3-196">9,10</span><span class="sxs-lookup"><span data-stu-id="69cf3-196">9,10</span></span>|<span data-ttu-id="69cf3-197">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-197">N/A</span></span>|<span data-ttu-id="69cf3-198">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-198">N/A</span></span>|  
|<span data-ttu-id="69cf3-199">SQL_C_BINARY(SQL_DATE_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="69cf3-199">SQL_C_BINARY(SQL_DATE_STRUCT)</span></span>|<span data-ttu-id="69cf3-200">1,11</span><span class="sxs-lookup"><span data-stu-id="69cf3-200">1,11</span></span>|<span data-ttu-id="69cf3-201">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-201">N/A</span></span>|<span data-ttu-id="69cf3-202">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-202">N/A</span></span>|<span data-ttu-id="69cf3-203">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-203">N/A</span></span>|<span data-ttu-id="69cf3-204">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-204">N/A</span></span>|<span data-ttu-id="69cf3-205">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-205">N/A</span></span>|<span data-ttu-id="69cf3-206">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-206">N/A</span></span>|  
|<span data-ttu-id="69cf3-207">SQL_C_BINARY(SQL_TIME_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="69cf3-207">SQL_C_BINARY(SQL_TIME_STRUCT)</span></span>|<span data-ttu-id="69cf3-208">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-208">N/A</span></span>|<span data-ttu-id="69cf3-209">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-209">N/A</span></span>|<span data-ttu-id="69cf3-210">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-210">N/A</span></span>|<span data-ttu-id="69cf3-211">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-211">N/A</span></span>|<span data-ttu-id="69cf3-212">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-212">N/A</span></span>|<span data-ttu-id="69cf3-213">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-213">N/A</span></span>|<span data-ttu-id="69cf3-214">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-214">N/A</span></span>|  
|<span data-ttu-id="69cf3-215">SQL_C_BINARY(SQL_TIMESTAMP_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="69cf3-215">SQL_C_BINARY(SQL_TIMESTAMP_STRUCT)</span></span>|<span data-ttu-id="69cf3-216">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-216">N/A</span></span>|<span data-ttu-id="69cf3-217">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-217">N/A</span></span>|<span data-ttu-id="69cf3-218">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-218">N/A</span></span>|<span data-ttu-id="69cf3-219">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-219">N/A</span></span>|<span data-ttu-id="69cf3-220">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-220">N/A</span></span>|<span data-ttu-id="69cf3-221">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-221">N/A</span></span>|<span data-ttu-id="69cf3-222">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-222">N/A</span></span>|  
  
## <a name="key-to-symbols"></a><span data-ttu-id="69cf3-223">符號的索引鍵</span><span class="sxs-lookup"><span data-stu-id="69cf3-223">Key to Symbols</span></span>  
  
|<span data-ttu-id="69cf3-224">符號</span><span class="sxs-lookup"><span data-stu-id="69cf3-224">Symbol</span></span>|<span data-ttu-id="69cf3-225">意義</span><span class="sxs-lookup"><span data-stu-id="69cf3-225">Meaning</span></span>|  
|------------|-------------|  
|-|<span data-ttu-id="69cf3-226">不支援轉換。</span><span class="sxs-lookup"><span data-stu-id="69cf3-226">No conversion is supported.</span></span> <span data-ttu-id="69cf3-227">產生含有 SQLSTATE 07006 和訊息「限制的資料類型屬性違規」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="69cf3-227">A diagnostic record is generated with SQLSTATE 07006 and the message "Restricted data type attribute violation".</span></span>|  
|<span data-ttu-id="69cf3-228">1</span><span class="sxs-lookup"><span data-stu-id="69cf3-228">1</span></span>|<span data-ttu-id="69cf3-229">如果提供的資料無效，就會產生含有 SQLSTATE 22007 和訊息「無效的 datetime 格式」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="69cf3-229">If the data supplied is not valid, a diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span>|  
|<span data-ttu-id="69cf3-230">2</span><span class="sxs-lookup"><span data-stu-id="69cf3-230">2</span></span>|<span data-ttu-id="69cf3-231">時間欄位必須為零，否則會產生含有 SQLSTATE 22008 和訊息「小數截略」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="69cf3-231">Time fields must be zero or a diagnostic record is generated with SQLSTATE 22008 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="69cf3-232">3</span><span class="sxs-lookup"><span data-stu-id="69cf3-232">3</span></span>|<span data-ttu-id="69cf3-233">小數秒數必須為零，否則會產生含有 SQLSTATE 22008 和訊息「小數截略」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="69cf3-233">Fractional seconds must be zero or a diagnostic record is generated with SQLSTATE 22008 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="69cf3-234">4</span><span class="sxs-lookup"><span data-stu-id="69cf3-234">4</span></span>|<span data-ttu-id="69cf3-235">忽略日期元件。</span><span class="sxs-lookup"><span data-stu-id="69cf3-235">The date component is ignored.</span></span>|  
|<span data-ttu-id="69cf3-236">5</span><span class="sxs-lookup"><span data-stu-id="69cf3-236">5</span></span>|<span data-ttu-id="69cf3-237">時區會設定為用戶端的時區設定。</span><span class="sxs-lookup"><span data-stu-id="69cf3-237">The timezone is set to the client's timezone setting.</span></span>|  
|<span data-ttu-id="69cf3-238">6</span><span class="sxs-lookup"><span data-stu-id="69cf3-238">6</span></span>|<span data-ttu-id="69cf3-239">時間會設定為零。</span><span class="sxs-lookup"><span data-stu-id="69cf3-239">The time is set to zero.</span></span>|  
|<span data-ttu-id="69cf3-240">7</span><span class="sxs-lookup"><span data-stu-id="69cf3-240">7</span></span>|<span data-ttu-id="69cf3-241">日期會設定為目前的日期。</span><span class="sxs-lookup"><span data-stu-id="69cf3-241">The date is set to the current date.</span></span>|  
|<span data-ttu-id="69cf3-242">8</span><span class="sxs-lookup"><span data-stu-id="69cf3-242">8</span></span>|<span data-ttu-id="69cf3-243">時間會從用戶端的時區轉換成 UTC。</span><span class="sxs-lookup"><span data-stu-id="69cf3-243">The time is converted from the client's timezone to UTC.</span></span> <span data-ttu-id="69cf3-244">如果進行這項轉換期間發生錯誤，就會產生含有 SQLSTATE 22008 和訊息「日期時間欄位溢位」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="69cf3-244">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span>|  
|<span data-ttu-id="69cf3-245">9</span><span class="sxs-lookup"><span data-stu-id="69cf3-245">9</span></span>|<span data-ttu-id="69cf3-246">根據出現的第一個標點符號字元以及剩餘的元件是否存在，字串會經過剖析，並轉換為 date、datetime、datetimeoffset 或 time 值。</span><span class="sxs-lookup"><span data-stu-id="69cf3-246">The string is parsed and converted to a date, datetime, datetimeoffset, or time value, depending on the first punctuation character encountered and the presence of remaining components.</span></span> <span data-ttu-id="69cf3-247">接著，在此程序探索來源類型之先前資料表中的規則之後，此字串會轉換為目標類型。</span><span class="sxs-lookup"><span data-stu-id="69cf3-247">The string is then converted to the target type, following the rules in the preceding table for the source type discovered by this process.</span></span> <span data-ttu-id="69cf3-248">如果在剖析資料時偵測到錯誤，就會產生含有 SQLSTATE 22018 和訊息「轉換規格的字元值無效」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="69cf3-248">If an error is detected while parsing the data, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span> <span data-ttu-id="69cf3-249">對於 datetime 和 smalldatetime 參數，如果年份超出這些類型支援的範圍，就會產生含有 SQLSTATE 22007 和訊息「無效的 datetime 格式」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="69cf3-249">For datetime and smalldatetime parameters, if the year is outside the range supported by these types, a diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span><br /><br /> <span data-ttu-id="69cf3-250">對於 datetimeoffset，即使沒有要求轉換為 UTC，此值在轉換到 UTC 之後仍然必須在範圍內。</span><span class="sxs-lookup"><span data-stu-id="69cf3-250">For datetimeoffset, the value must be within range after conversion to UTC, even if no conversion to UTC is requested.</span></span> <span data-ttu-id="69cf3-251">這是因為 TDS 和伺服器永遠會以 UTC 的 datetimeoffset 值，將時間正規化，因此用戶端必須在轉換成 UTC 之後，確認時間元件位於支援的範圍內。</span><span class="sxs-lookup"><span data-stu-id="69cf3-251">This is because TDS and the server always normalize the time in datetimeoffset values for UTC, so the client must verify that time components are within the range supported after conversion to UTC.</span></span> <span data-ttu-id="69cf3-252">如果此值不在支援的 UTC 範圍內，就會產生含有 SQLSTATE 22007 和訊息「無效的 datetime 格式」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="69cf3-252">If the value is not within the supported UTC range, a diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span>|  
|<span data-ttu-id="69cf3-253">10</span><span class="sxs-lookup"><span data-stu-id="69cf3-253">10</span></span>|<span data-ttu-id="69cf3-254">如果截斷時發生資料遺失，就會產生含有 SQLSTATE 22008 和訊息「無效的時間格式」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="69cf3-254">If truncation with data loss occurs, a diagnostic record is generated with SQLSTATE 22008 and the message "Invalid time format".</span></span> <span data-ttu-id="69cf3-255">如果此值落在伺服器使用之 UTC 範圍所代表的範圍外，也可能發生這個錯誤。</span><span class="sxs-lookup"><span data-stu-id="69cf3-255">This error also occurs if the value falls outside the range that can be represented by the UTC range used by the server.</span></span>|  
|<span data-ttu-id="69cf3-256">11</span><span class="sxs-lookup"><span data-stu-id="69cf3-256">11</span></span>|<span data-ttu-id="69cf3-257">如果資料的位元組長度不等於 SQL 類型所要求的結構大小，就會產生含有 SQLSTATE 22003 和訊息「數值超出範圍」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="69cf3-257">If the byte length of the data does not equal the size of the struct required by the SQL type, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="69cf3-258">12</span><span class="sxs-lookup"><span data-stu-id="69cf3-258">12</span></span>|<span data-ttu-id="69cf3-259">如果資料的位元組長度為 4 或 8，資料會以原始的 TDS smalldatetime 或 datetime 格式，傳送到伺服器。</span><span class="sxs-lookup"><span data-stu-id="69cf3-259">If the byte length of the data is 4 or 8, the data is sent to the server in raw TDS smalldatetime or datetime format.</span></span> <span data-ttu-id="69cf3-260">如果資料的位元組長度完全符合 SQL_TIMESTAMP_STRUCT 的大小，資料就會轉換成適用於 datetime2 的 TDS 格式。</span><span class="sxs-lookup"><span data-stu-id="69cf3-260">If the byte length of the data exactly matches the size of SQL_TIMESTAMP_STRUCT, the data is converted to the TDS format for datetime2.</span></span>|  
|<span data-ttu-id="69cf3-261">13</span><span class="sxs-lookup"><span data-stu-id="69cf3-261">13</span></span>|<span data-ttu-id="69cf3-262">如果截斷時發生資料遺失，就會產生含有 SQLSTATE 22001 和訊息「字串資料，右邊已截斷」的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="69cf3-262">If truncation with data loss occurs, a diagnostic record is generated with SQLSTATE 22001 and the message "String data, right truncated".</span></span><br /><br /> <span data-ttu-id="69cf3-263">根據下列各項，從目的地資料行的大小決定小數秒數 (位數) ：</span><span class="sxs-lookup"><span data-stu-id="69cf3-263">The number of fractional seconds digits (the scale) is determined from the destination column's size according to the following:</span></span><br /><br /> <span data-ttu-id="69cf3-264">**類型：** SQL_C_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="69cf3-264">**Type:** SQL_C_TYPE_TIMESTAMP</span></span><br /><br /> <span data-ttu-id="69cf3-265">隱含的小數位數</span><span class="sxs-lookup"><span data-stu-id="69cf3-265">Implied Scale</span></span><br /><br /> <span data-ttu-id="69cf3-266">0</span><span class="sxs-lookup"><span data-stu-id="69cf3-266">0</span></span><br /><br /> <span data-ttu-id="69cf3-267">19</span><span class="sxs-lookup"><span data-stu-id="69cf3-267">19</span></span><br /><br /> <span data-ttu-id="69cf3-268">隱含的小數位數</span><span class="sxs-lookup"><span data-stu-id="69cf3-268">Implied Scale</span></span><br /><br /> <span data-ttu-id="69cf3-269">1. 9</span><span class="sxs-lookup"><span data-stu-id="69cf3-269">1..9</span></span><br /><br /> <span data-ttu-id="69cf3-270">21..29</span><span class="sxs-lookup"><span data-stu-id="69cf3-270">21..29</span></span><br /><br /> <span data-ttu-id="69cf3-271">不過對於 SQL_C_TYPE_TIMESTAMP，如果可以用三位數代表小數秒而不會造成資料遺失，而且資料行大小為 23 以上，則會產生完整的三位數小數秒。</span><span class="sxs-lookup"><span data-stu-id="69cf3-271">However, for SQL_C_TYPE_TIMESTAMP, if the fractional seconds can be represented with three digits without data loss and the column size is 23 or larger, then exactly three fractional seconds' digits are generated.</span></span> <span data-ttu-id="69cf3-272">此行為可確保使用舊版 ODBC 驅動程式所開發之應用程式的回溯相容性。</span><span class="sxs-lookup"><span data-stu-id="69cf3-272">This behavior ensures backwards compatibility for applications developed using older ODBC drivers.</span></span><br /><br /> <span data-ttu-id="69cf3-273">對於大於資料表中範圍的資料行大小，會隱含小數位數 9。</span><span class="sxs-lookup"><span data-stu-id="69cf3-273">For column sizes larger than the range in the table, a scale of 9 is implied.</span></span> <span data-ttu-id="69cf3-274">此轉換應該最多允許九個小數秒位數，也就是 ODBC 所允許的最大值。</span><span class="sxs-lookup"><span data-stu-id="69cf3-274">This conversion should allow for up to nine fractional seconds digits, the maximum allowed by ODBC.</span></span><br /><br /> <span data-ttu-id="69cf3-275">資料行大小為零暗示 ODBC 中變數長度字元類型的大小無限制 (除非 SQL_C_TYPE_TIMESTAMP 套用 3 位數規則，否則為 9 位數)。</span><span class="sxs-lookup"><span data-stu-id="69cf3-275">A column size of zero implies unlimited size for variable length character types in ODBC (9 digits, unless the 3-digit rule for SQL_C_TYPE_TIMESTAMP applies).</span></span> <span data-ttu-id="69cf3-276">利用固定的長度字元類型將資料行大小指定為零是錯誤。</span><span class="sxs-lookup"><span data-stu-id="69cf3-276">Specifying a column size of zero with a fixed length character type is an error.</span></span>|  
|<span data-ttu-id="69cf3-277">N/A</span><span class="sxs-lookup"><span data-stu-id="69cf3-277">N/A</span></span>|<span data-ttu-id="69cf3-278">系統會維持現有 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 和舊有的行為。</span><span class="sxs-lookup"><span data-stu-id="69cf3-278">Existing [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and earlier behavior is maintained.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="69cf3-279">另請參閱</span><span class="sxs-lookup"><span data-stu-id="69cf3-279">See Also</span></span>  
 [<span data-ttu-id="69cf3-280">ODBC&#41;&#40;的日期和時間改善</span><span class="sxs-lookup"><span data-stu-id="69cf3-280">Date and Time Improvements &#40;ODBC&#41;</span></span>](date-and-time-improvements-odbc.md)  
  
  
