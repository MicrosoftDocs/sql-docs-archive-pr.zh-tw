---
title: 使用記憶體最佳化資料表的需求 | Microsoft 文件
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: in-memory-oltp
ms.topic: conceptual
ms.assetid: 47d9a7e8-c597-4b95-a58a-dcf66df8e572
author: CarlRabeler
ms.author: carlrab
ms.openlocfilehash: ecb9d388fd0e1362bb8844e874cd89162912e93e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87707557"
---
# <a name="requirements-for-using-memory-optimized-tables"></a><span data-ttu-id="83a69-102">使用記憶體最佳化資料表的需求</span><span class="sxs-lookup"><span data-stu-id="83a69-102">Requirements for Using Memory-Optimized Tables</span></span>
  <span data-ttu-id="83a69-103">除了[安裝 SQL Server 2014 的硬體和軟體需求](../../sql-server/install/hardware-and-software-requirements-for-installing-sql-server.md)以外，以下是使用記憶體內部 OLTP 的需求：</span><span class="sxs-lookup"><span data-stu-id="83a69-103">In addition to the [Hardware and Software Requirements for Installing SQL Server 2014](../../sql-server/install/hardware-and-software-requirements-for-installing-sql-server.md), the following are requirements to use In-Memory OLTP:</span></span>  
  
-   <span data-ttu-id="83a69-104">[!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]64 位元 Enterprise、Developer 或 Evaluation Edition。</span><span class="sxs-lookup"><span data-stu-id="83a69-104">64-bit Enterprise, Developer, or Evaluation edition of [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)].</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="83a69-105">需要足夠的記憶體，以容納記憶體最佳化的資料表和索引中的資料。</span><span class="sxs-lookup"><span data-stu-id="83a69-105">needs enough memory to hold the data in memory-optimized tables and indexes.</span></span> <span data-ttu-id="83a69-106">為了說明資料列版本，您應該提供記憶體最佳化的資料表和索引預期大小兩倍的記憶體數量。</span><span class="sxs-lookup"><span data-stu-id="83a69-106">To account for row versions, you should provide an amount of memory that is two times the expected size of memory-optimized tables and indexes.</span></span> <span data-ttu-id="83a69-107">但是所需的實際記憶體數目將取決於您的工作負載。</span><span class="sxs-lookup"><span data-stu-id="83a69-107">But the actual amount of memory needed will depend on your workload.</span></span> <span data-ttu-id="83a69-108">您應該監視記憶體使用量並視需要進行調整。</span><span class="sxs-lookup"><span data-stu-id="83a69-108">You should monitor your memory usage and make adjustments as needed.</span></span> <span data-ttu-id="83a69-109">記憶體最佳化資料表的資料大小不得超過集區所允許的百分比。</span><span class="sxs-lookup"><span data-stu-id="83a69-109">The size of data in memory-optimized tables must not exceed the allowed percentage of the pool.</span></span> <span data-ttu-id="83a69-110">若要探索記憶體優化資料表的大小，請參閱[sys.databases &#40;transact-sql&#41;的 dm_db_xtp_table_memory_stats ](/sql/relational-databases/system-dynamic-management-views/sys-dm-db-xtp-table-memory-stats-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="83a69-110">To discover the size of a memory-optimized table, see [sys.dm_db_xtp_table_memory_stats &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-db-xtp-table-memory-stats-transact-sql).</span></span>  
  
     <span data-ttu-id="83a69-111">如果資料庫中有以磁碟為基礎的資料表，您需要提供足夠的記憶體，讓緩衝集區和查詢能夠在這些資料表上進行處理。</span><span class="sxs-lookup"><span data-stu-id="83a69-111">If you have disk-based tables in the database, you need to provide enough memory for the buffer pool and query processing on those tables.</span></span>  
  
     <span data-ttu-id="83a69-112">請務必了解記憶體中 OLTP 應用程式需要多少記憶體。</span><span class="sxs-lookup"><span data-stu-id="83a69-112">It is important to know how much memory your In-Memory OLTP application will require.</span></span> <span data-ttu-id="83a69-113">如需詳細資訊，請參閱 [估計記憶體最佳化資料表的記憶體需求](memory-optimized-tables.md) 。</span><span class="sxs-lookup"><span data-stu-id="83a69-113">See [Estimate Memory Requirements for Memory-Optimized Tables](memory-optimized-tables.md) for more information.</span></span>  
  
-   <span data-ttu-id="83a69-114">釋放持久的記憶體最佳化資料表大小的兩倍磁碟空間。</span><span class="sxs-lookup"><span data-stu-id="83a69-114">Free disk space for that is two times the size of your durable memory-optimized tables.</span></span>  
  
-   <span data-ttu-id="83a69-115">處理器需要支援指令 **cmpxchg16b** 以使用記憶體內部 OLTP。</span><span class="sxs-lookup"><span data-stu-id="83a69-115">A processor needs to support the instruction **cmpxchg16b** to use In-Memory OLTP.</span></span> <span data-ttu-id="83a69-116">所有新型 64 位元處理器都支援 **cmpxchg16b**。</span><span class="sxs-lookup"><span data-stu-id="83a69-116">All modern 64-bit processors support **cmpxchg16b**.</span></span>  
  
     <span data-ttu-id="83a69-117">如果您使用 VM 主機應用程式，並 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 顯示較舊處理器造成的錯誤，請查看應用程式是否有允許**cmpxchg16b**的設定選項。</span><span class="sxs-lookup"><span data-stu-id="83a69-117">If you are using a VM host application and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] displays an error caused by an older processor, see if the application has a configuration option to allow **cmpxchg16b**.</span></span> <span data-ttu-id="83a69-118">如果沒有，您可以使用 Hyper-V，它可以支援 **cmpxchg16b** ，而不需要修改組態選項。</span><span class="sxs-lookup"><span data-stu-id="83a69-118">If not, you could use Hyper-V, which supports **cmpxchg16b** without needing to modify a configuration option.</span></span>  
  
-   <span data-ttu-id="83a69-119">若要安裝記憶體中 OLTP，請在您安裝 **時選取** [Database Engine Services] [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="83a69-119">To install In-Memory OLTP, select **Database Engine Services** when you install [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)].</span></span>  
  
     <span data-ttu-id="83a69-120">若要安裝報表產生 ([判斷是否應將資料表或預存程式移植到記憶體內部 oltp](determining-if-a-table-or-stored-procedure-should-be-ported-to-in-memory-oltp.md)) ，並 [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] (透過物件總管) 來管理記憶體內部 oltp [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] ，請選取 [**管理工具-基本**] 或 [**管理工具-** 在安裝時進行 Advanced] [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="83a69-120">To install report generation ([Determining if a Table or Stored Procedure Should Be Ported to In-Memory OLTP](determining-if-a-table-or-stored-procedure-should-be-ported-to-in-memory-oltp.md)) and [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] (to manage In-Memory OLTP via [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] Object Explorer), select **Management Tools-Basic** or **Management Tools-Advanced** when you install [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)].</span></span>  
  
## <a name="important-notes-on-using-hek_2"></a><span data-ttu-id="83a69-121">使用 [!INCLUDE[hek_2](../../../includes/hek-2-md.md)]的重要注意事項</span><span class="sxs-lookup"><span data-stu-id="83a69-121">Important Notes on Using [!INCLUDE[hek_2](../../../includes/hek-2-md.md)]</span></span>  
  
-   <span data-ttu-id="83a69-122">資料庫中所有持久資料表的記憶體中大小總計不應該超過 250 GB。</span><span class="sxs-lookup"><span data-stu-id="83a69-122">The total in-memory size of all durable tables in a database should not exceed 250 GB.</span></span> <span data-ttu-id="83a69-123">如需詳細資訊，請參閱[記憶體優化資料表的持久性](durability-for-memory-optimized-tables.md)。</span><span class="sxs-lookup"><span data-stu-id="83a69-123">For more information, see [Durability for Memory-Optimized Tables](durability-for-memory-optimized-tables.md).</span></span>  
  
-   <span data-ttu-id="83a69-124">這個 [!INCLUDE[hek_2](../../../includes/hek-2-md.md)] 版本的目標是在含有 2 或 4 個通訊端且少於 60 個核心的系統上可以最佳化方式執行。</span><span class="sxs-lookup"><span data-stu-id="83a69-124">This release of [!INCLUDE[hek_2](../../../includes/hek-2-md.md)] is targeted to perform optimally on systems with 2 or 4 sockets and fewer than 60 cores.</span></span>  
  
-   <span data-ttu-id="83a69-125">檢查點檔案無法手動刪除。</span><span class="sxs-lookup"><span data-stu-id="83a69-125">Checkpoint files must not be manually deleted.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="83a69-126">會對不需要的檢查點檔案自動執行記憶體回收。</span><span class="sxs-lookup"><span data-stu-id="83a69-126">automatically performs garbage collection on unneeded checkpoint files.</span></span> <span data-ttu-id="83a69-127">如需詳細資訊，請參閱在[記憶體優化資料表的持久性](durability-for-memory-optimized-tables.md)中合併資料和差異檔案的討論。</span><span class="sxs-lookup"><span data-stu-id="83a69-127">For more information, see the discussion on merging data and delta files in [Durability for Memory-Optimized Tables](durability-for-memory-optimized-tables.md).</span></span>  
  
-   <span data-ttu-id="83a69-128">在此第一版記憶體中 OLTP (在 [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]裡) 中，移除記憶體最佳化檔案群組唯一的方式就是卸除資料庫。</span><span class="sxs-lookup"><span data-stu-id="83a69-128">In this first release of In-Memory OLTP (in [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]), the only way to remove a memory-optimized filegroup is to drop the database.</span></span>  
  
-   <span data-ttu-id="83a69-129">如果您在嘗試刪除大批資料列時，有並行的插入或更新工作負載會影響您正嘗試刪除的資料列範圍，則刪除作業可能會失敗。</span><span class="sxs-lookup"><span data-stu-id="83a69-129">If you attempt to delete a large batch of rows while there is a concurrent insert or update workload affecting the range of rows you are trying to delete, the delete will likely fail.</span></span> <span data-ttu-id="83a69-130">解決方法是先停止插入或更新工作負載，然後執行刪除。</span><span class="sxs-lookup"><span data-stu-id="83a69-130">The workaround is to stop the insert or update workload before doing the delete.</span></span> <span data-ttu-id="83a69-131">或者，您也可以將交易設定為較小的交易，這樣做比較不容易受到並行工作負載所中斷。</span><span class="sxs-lookup"><span data-stu-id="83a69-131">Alternatively, you could configure the transaction into smaller transactions, which would be less likely to be disrupted by a concurrent workload.</span></span> <span data-ttu-id="83a69-132">如同記憶體最佳化資料表上的所有寫入作業，使用重試邏輯 ([Guidelines for Retry Logic for Transactions on Memory-Optimized Tables](../../database-engine/guidelines-for-retry-logic-for-transactions-on-memory-optimized-tables.md))。</span><span class="sxs-lookup"><span data-stu-id="83a69-132">As with all write operations on memory-optimized tables, use retry logic ([Guidelines for Retry Logic for Transactions on Memory-Optimized Tables](../../database-engine/guidelines-for-retry-logic-for-transactions-on-memory-optimized-tables.md)).</span></span>  
  
-   <span data-ttu-id="83a69-133">如果您建立一個或多個具有記憶體最佳化資料表的資料庫，就應該針對 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體啟用立即檔案初始化 (將 SE_MANAGE_VOLUME_NAME 使用者權限授與 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 服務啟動帳戶)。</span><span class="sxs-lookup"><span data-stu-id="83a69-133">If you create one or more databases with memory-optimized tables, you should enable Instant File Initialization (grant the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service startup account the SE_MANAGE_VOLUME_NAME user right) for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="83a69-134">如果沒有立即檔案初始化，記憶體最佳化儲存體檔案 (資料和差異檔案) 將會在建立時初始化，而這樣可能會對工作負載的效能造成負面影響。</span><span class="sxs-lookup"><span data-stu-id="83a69-134">Without Instant File Initialization, memory-optimized storage files (data and delta files) will be initialized upon creation, which can have negative impact on the performance of your workload.</span></span> <span data-ttu-id="83a69-135">如需有關立即檔案初始化的詳細資訊，請參閱 [資料庫檔案初始化](../databases/database-instant-file-initialization.md)。</span><span class="sxs-lookup"><span data-stu-id="83a69-135">For more information about Instant File Initialization, see [Database File Initialization](../databases/database-instant-file-initialization.md).</span></span> <span data-ttu-id="83a69-136">如需有關如何啟用立即檔案初始化的詳細資訊，請參閱 [如何及為何啟用立即檔案初始化](https://blogs.msdn.com/b/sql_pfe_blog/archive/2009/12/23/how-and-why-to-enable-instant-file-initialization.aspx)。</span><span class="sxs-lookup"><span data-stu-id="83a69-136">For information on how to enable Instant File Initialization, see [How and Why to Enable Instant File Initialization](https://blogs.msdn.com/b/sql_pfe_blog/archive/2009/12/23/how-and-why-to-enable-instant-file-initialization.aspx).</span></span>  
  
## <a name="did-this-article-help-you-were-listening"></a><span data-ttu-id="83a69-137">這篇文章對您有幫助嗎？</span><span class="sxs-lookup"><span data-stu-id="83a69-137">Did this Article Help You?</span></span> <span data-ttu-id="83a69-138">我們正在接聽</span><span class="sxs-lookup"><span data-stu-id="83a69-138">We're Listening</span></span>  
 <span data-ttu-id="83a69-139">您要尋找哪些資訊？找到了嗎？</span><span class="sxs-lookup"><span data-stu-id="83a69-139">What information are you looking for, and did you find it?</span></span> <span data-ttu-id="83a69-140">我們正在聆聽您的意見反應以改善內容。</span><span class="sxs-lookup"><span data-stu-id="83a69-140">We're listening to your feedback to improve the content.</span></span> <span data-ttu-id="83a69-141">請將您的意見提交至 [sqlfeedback@microsoft.com](mailto:sqlfeedback@microsoft.com?subject=Your%20feedback%20about%20the%20Requirements%20for%20Using%20Memory-Optimized%20Tables%20page) 。</span><span class="sxs-lookup"><span data-stu-id="83a69-141">Please submit your comments to [sqlfeedback@microsoft.com](mailto:sqlfeedback@microsoft.com?subject=Your%20feedback%20about%20the%20Requirements%20for%20Using%20Memory-Optimized%20Tables%20page).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="83a69-142">另請參閱</span><span class="sxs-lookup"><span data-stu-id="83a69-142">See Also</span></span>  
 [<span data-ttu-id="83a69-143">記憶體內部 OLTP &#40;記憶體內部最佳化&#41;</span><span class="sxs-lookup"><span data-stu-id="83a69-143">In-Memory OLTP &#40;In-Memory Optimization&#41;</span></span>](in-memory-oltp-in-memory-optimization.md)  
  
  
