---
title: 資料指標 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- results [SQL Server], cursors
- Transact-SQL cursors, about cursors
- cursors [SQL Server]
- data access [SQL Server], cursors
- result sets [SQL Server], cursors
- requesting cursors
- cursors [SQL Server], about cursors
ms.assetid: e668b40c-bd4d-4415-850d-20fc4872ee72
author: rothja
ms.author: jroth
ms.openlocfilehash: 055482a8cf64527f58ed983b449121a99960f566
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87606886"
---
# <a name="cursors"></a><span data-ttu-id="03eb8-102">資料指標</span><span class="sxs-lookup"><span data-stu-id="03eb8-102">Cursors</span></span>
  <span data-ttu-id="03eb8-103">關聯式資料庫中的作業會針對完整的資料列集運作。</span><span class="sxs-lookup"><span data-stu-id="03eb8-103">Operations in a relational database act on a complete set of rows.</span></span> <span data-ttu-id="03eb8-104">例如，由 SELECT 陳述式所傳回的資料列集包括所有滿足陳述式 WHERE 子句之條件的資料列。</span><span class="sxs-lookup"><span data-stu-id="03eb8-104">For example, the set of rows returned by a SELECT statement consists of all the rows that satisfy the conditions in the WHERE clause of the statement.</span></span> <span data-ttu-id="03eb8-105">由陳述式傳回的完整資料列稱為結果集。</span><span class="sxs-lookup"><span data-stu-id="03eb8-105">This complete set of rows returned by the statement is known as the result set.</span></span> <span data-ttu-id="03eb8-106">應用程式 (尤其是互動式線上應用程式) 不一定能夠以一個單位有效地運用整個結果集。</span><span class="sxs-lookup"><span data-stu-id="03eb8-106">Applications, especially interactive online applications, cannot always work effectively with the entire result set as a unit.</span></span> <span data-ttu-id="03eb8-107">這些應用程式需要一個機制，一次運用一個資料列或小型資料列區塊。</span><span class="sxs-lookup"><span data-stu-id="03eb8-107">These applications need a mechanism to work with one row or a small block of rows at a time.</span></span> <span data-ttu-id="03eb8-108">資料指標就是一種結果集的擴充，提供此種機制。</span><span class="sxs-lookup"><span data-stu-id="03eb8-108">Cursors are an extension to result sets that provide that mechanism.</span></span>  
  
 <span data-ttu-id="03eb8-109">資料指標擴充結果處理的方式是：</span><span class="sxs-lookup"><span data-stu-id="03eb8-109">Cursors extend result processing by:</span></span>  
  
-   <span data-ttu-id="03eb8-110">允許定位於結果集中的特定資料列。</span><span class="sxs-lookup"><span data-stu-id="03eb8-110">Allowing positioning at specific rows of the result set.</span></span>  
  
-   <span data-ttu-id="03eb8-111">從結果集的目前位置，擷取一個資料列或資料列區塊。</span><span class="sxs-lookup"><span data-stu-id="03eb8-111">Retrieving one row or block of rows from the current position in the result set.</span></span>  
  
-   <span data-ttu-id="03eb8-112">支援結果集目前位置上資料列的資料修改。</span><span class="sxs-lookup"><span data-stu-id="03eb8-112">Supporting data modifications to the rows at the current position in the result set.</span></span>  
  
-   <span data-ttu-id="03eb8-113">支援以不同可見性層級來檢視其他使用者對結果集所呈現的資料庫資料所作的變更。</span><span class="sxs-lookup"><span data-stu-id="03eb8-113">Supporting different levels of visibility to changes made by other users to the database data that is presented in the result set.</span></span>  
  
-   <span data-ttu-id="03eb8-114">讓指令碼、預存程序和觸發程序中的 [!INCLUDE[tsql](../includes/tsql-md.md)] 陳述式能夠存取結果集中的資料。</span><span class="sxs-lookup"><span data-stu-id="03eb8-114">Providing [!INCLUDE[tsql](../includes/tsql-md.md)] statements in scripts, stored procedures, and triggers access to the data in a result set.</span></span>  
  
## <a name="concepts"></a><span data-ttu-id="03eb8-115">概念</span><span class="sxs-lookup"><span data-stu-id="03eb8-115">Concepts</span></span>  
 <span data-ttu-id="03eb8-116">實作資料指標</span><span class="sxs-lookup"><span data-stu-id="03eb8-116">Cursor Implementations</span></span>  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="03eb8-117">支援三個資料指標實作。</span><span class="sxs-lookup"><span data-stu-id="03eb8-117">supports three cursor implementations.</span></span>  
  
 <span data-ttu-id="03eb8-118">Transact-SQL 資料指標</span><span class="sxs-lookup"><span data-stu-id="03eb8-118">Transact-SQL cursors</span></span>  
 <span data-ttu-id="03eb8-119">根據 DECLARE CURSOR 語法，主要用於 [!INCLUDE[tsql](../includes/tsql-md.md)] 指令碼、預存程序和觸發程序。</span><span class="sxs-lookup"><span data-stu-id="03eb8-119">Are based on the DECLARE CURSOR syntax and are used mainly in [!INCLUDE[tsql](../includes/tsql-md.md)] scripts, stored procedures, and triggers.</span></span> [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="03eb8-120">資料指標會在伺服器上實作，而且由用戶端傳送給伺服器的 [!INCLUDE[tsql](../includes/tsql-md.md)] 陳述式所管理。</span><span class="sxs-lookup"><span data-stu-id="03eb8-120">cursors are implemented on the server and are managed by [!INCLUDE[tsql](../includes/tsql-md.md)] statements sent from the client to the server.</span></span> <span data-ttu-id="03eb8-121">資料指標也可存在批次、預存程序或觸發程序內。</span><span class="sxs-lookup"><span data-stu-id="03eb8-121">They may also be contained in batches, stored procedures, or triggers.</span></span>  
  
 <span data-ttu-id="03eb8-122">應用程式開發介面 (Application Programming Interface，API) 伺服端資料指標</span><span class="sxs-lookup"><span data-stu-id="03eb8-122">Application programming interface (API) server cursors</span></span>  
 <span data-ttu-id="03eb8-123">可支援 OLE DB、ODBC 的 API 資料指標函數。</span><span class="sxs-lookup"><span data-stu-id="03eb8-123">Support the API cursor functions in OLE DB and ODBC.</span></span> <span data-ttu-id="03eb8-124">API 伺服端資料指標實作在伺服端上。</span><span class="sxs-lookup"><span data-stu-id="03eb8-124">API server cursors are implemented on the server.</span></span> <span data-ttu-id="03eb8-125">每次用戶端應用程式呼叫 API 資料指標函數時， [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client OLE DB 提供者或 ODBC 驅動程式都會將要求傳遞至伺服器，以依照 API 伺服端資料指標執行。</span><span class="sxs-lookup"><span data-stu-id="03eb8-125">Each time a client application calls an API cursor function, the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client OLE DB provider or ODBC driver transmits the request to the server for action against the API server cursor.</span></span>  
  
 <span data-ttu-id="03eb8-126">用戶端資料指標</span><span class="sxs-lookup"><span data-stu-id="03eb8-126">Client cursors</span></span>  
 <span data-ttu-id="03eb8-127">是由 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client ODBC 驅動程式以及實作 ADO API 的 DLL 在內部實作。</span><span class="sxs-lookup"><span data-stu-id="03eb8-127">Are implemented internally by the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client ODBC driver and by the DLL that implements the ADO API.</span></span> <span data-ttu-id="03eb8-128">用戶端資料指標是透過快取用戶端上的整個結果集資料列來實作。</span><span class="sxs-lookup"><span data-stu-id="03eb8-128">Client cursors are implemented by caching all the result set rows on the client.</span></span> <span data-ttu-id="03eb8-129">每次用戶端應用程式呼叫 API 資料指標函數時， [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client ODBC 驅動程式或 ADO DLL 都會在用戶端上快取的結果集資料列上執行資料指標作業。</span><span class="sxs-lookup"><span data-stu-id="03eb8-129">Each time a client application calls an API cursor function, the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client ODBC driver or the ADO DLL performs the cursor operation on the result set rows cached on the client.</span></span>  
  
 <span data-ttu-id="03eb8-130">資料指標的類型</span><span class="sxs-lookup"><span data-stu-id="03eb8-130">Type of Cursors</span></span>  
 <span data-ttu-id="03eb8-131">順向</span><span class="sxs-lookup"><span data-stu-id="03eb8-131">Forward-only</span></span>  
 <span data-ttu-id="03eb8-132">順向資料指標不支援捲動；僅支援從資料指標開頭到結尾循序提取資料列。</span><span class="sxs-lookup"><span data-stu-id="03eb8-132">A forward-only cursor does not support scrolling; it supports only fetching the rows serially from the start to the end of the cursor.</span></span> <span data-ttu-id="03eb8-133">提取資料列之前，不會從資料庫擷取那些資料列。</span><span class="sxs-lookup"><span data-stu-id="03eb8-133">The rows are not retrieved from the database until they are fetched.</span></span> <span data-ttu-id="03eb8-134">從資料指標提取資料列時，可看見目前使用者執行或其他使用者認可的所有 INSERT、UPDATE 和 DELETE 陳述式的作用對結果集資料列所產生的影響。</span><span class="sxs-lookup"><span data-stu-id="03eb8-134">The effects of all INSERT, UPDATE, and DELETE statements made by the current user or committed by other users that affect rows in the result set are visible as the rows are fetched from the cursor.</span></span>  
  
 <span data-ttu-id="03eb8-135">因為無法逆向捲動資料指標，提取資料列之後對資料庫中資料列所進行的大部分變更，都無法經由資料指標看見。</span><span class="sxs-lookup"><span data-stu-id="03eb8-135">Because the cursor cannot be scrolled backward, most changes made to rows in the database after the row was fetched are not visible through the cursor.</span></span> <span data-ttu-id="03eb8-136">如果已修改用來判斷結果集之資料列位置的值 (例如更新叢集索引所涵蓋的資料行)，就可以經由資料指標看到修改的值。</span><span class="sxs-lookup"><span data-stu-id="03eb8-136">In cases where a value used to determine the location of the row within the result set is modified, such as updating a column covered by a clustered index, the modified value is visible through the cursor.</span></span>  
  
 <span data-ttu-id="03eb8-137">雖然資料庫 API 資料指標模型會將順向資料指標視為不同的資料指標類型，但是 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 並不會。</span><span class="sxs-lookup"><span data-stu-id="03eb8-137">Although the database API cursor models consider a forward-only cursor to be a distinct type of cursor, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] does not.</span></span> [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="03eb8-138">會將順向和捲動視為可以套用至靜態、索引鍵集驅動和動態資料指標的選項。</span><span class="sxs-lookup"><span data-stu-id="03eb8-138">considers both forward-only and scroll as options that can be applied to static, keyset-driven, and dynamic cursors.</span></span> [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="03eb8-139">資料指標支援順向、靜態、索引鍵集驅動和動態資料指標。</span><span class="sxs-lookup"><span data-stu-id="03eb8-139">cursors support forward-only static, keyset-driven, and dynamic cursors.</span></span> <span data-ttu-id="03eb8-140">資料庫 API 資料指標模式會假設靜態、索引鍵集驅動和動態資料指標一律可以捲動。</span><span class="sxs-lookup"><span data-stu-id="03eb8-140">The database API cursor models assume that static, keyset-driven, and dynamic cursors are always scrollable.</span></span> <span data-ttu-id="03eb8-141">當資料庫 API 資料指標屬性 (Attribute 或 Property) 設為順向時， [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 會將此資料指標實作為順向動態資料指標。</span><span class="sxs-lookup"><span data-stu-id="03eb8-141">When a database API cursor attribute or property is set to forward-only, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] implements this as a forward-only dynamic cursor.</span></span>  
  
 <span data-ttu-id="03eb8-142">靜態</span><span class="sxs-lookup"><span data-stu-id="03eb8-142">Static</span></span>  
 <span data-ttu-id="03eb8-143">資料指標開啟時，靜態資料指標的完整結果集會內建於 **tempdb** 。</span><span class="sxs-lookup"><span data-stu-id="03eb8-143">The complete result set of a static cursor is built in **tempdb** when the cursor is opened.</span></span> <span data-ttu-id="03eb8-144">資料指標開啟的同時，靜態資料指標會將結果集的原貌展現出來。</span><span class="sxs-lookup"><span data-stu-id="03eb8-144">A static cursor always displays the result set as it was when the cursor was opened.</span></span> <span data-ttu-id="03eb8-145">靜態資料指標可以偵測少量的變更或是沒有變更，但是在捲動時所耗用的資源相當少。</span><span class="sxs-lookup"><span data-stu-id="03eb8-145">Static cursors detect few or no changes, but consume relatively few resources while scrolling.</span></span>  
  
 <span data-ttu-id="03eb8-146">即使資料庫中的變更影響結果集的成員資格，或構成結果集的資料列之資料行數值有所變動時，此類資料指標並不會反映出其中的變更。</span><span class="sxs-lookup"><span data-stu-id="03eb8-146">The cursor does not reflect any changes made in the database that affect either the membership of the result set or changes to the values in the columns of the rows that make up the result set.</span></span> <span data-ttu-id="03eb8-147">靜態資料指標並不會將資料指標開啟後插入資料庫的新資料列顯示出來，即使資料列符合資料指標 SELECT 陳述式的搜尋條件。</span><span class="sxs-lookup"><span data-stu-id="03eb8-147">A static cursor does not display new rows inserted in the database after the cursor was opened, even if they match the search conditions of the cursor SELECT statement.</span></span> <span data-ttu-id="03eb8-148">如果構成結果集的資料列被其他使用者更新，新資料值不會顯示在靜態資料指標上。</span><span class="sxs-lookup"><span data-stu-id="03eb8-148">If rows making up the result set are updated by other users, the new data values are not displayed in the static cursor.</span></span> <span data-ttu-id="03eb8-149">靜態資料指標會顯示資料指標開啟後從資料庫刪除的資料列。</span><span class="sxs-lookup"><span data-stu-id="03eb8-149">The static cursor displays rows deleted from the database after the cursor was opened.</span></span> <span data-ttu-id="03eb8-150">總結以上，靜態資料指標中並不會反映出 UPDATE、INSERT 或 DELETE 作業帶來的變動 (除非資料指標經過關閉後重新開啟)，即使是使用同一連接開啟資料指標後的修改也不顯示。</span><span class="sxs-lookup"><span data-stu-id="03eb8-150">No UPDATE, INSERT, or DELETE operations are reflected in a static cursor (unless the cursor is closed and reopened), not even modifications made using the same connection that opened the cursor.</span></span>  
  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="03eb8-151">靜態資料指標永遠是唯讀的。</span><span class="sxs-lookup"><span data-stu-id="03eb8-151">static cursors are always read-only.</span></span>  
  
 <span data-ttu-id="03eb8-152">因為靜態資料指標的結果集是儲存在 **tempdb**中的工作資料表，所以結果集中的資料列大小不可超過 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 資料表的資料列大小的上限。</span><span class="sxs-lookup"><span data-stu-id="03eb8-152">Because the result set of a static cursor is stored in a work table in **tempdb**, the size of the rows in the result set cannot exceed the maximum row size for a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] table.</span></span>  
  
 [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="03eb8-153">對靜態資料指標不太能區分。</span><span class="sxs-lookup"><span data-stu-id="03eb8-153">uses the term insensitive for static cursors.</span></span> <span data-ttu-id="03eb8-154">部分資料庫 API 會將它們識別為快照集資料指標。</span><span class="sxs-lookup"><span data-stu-id="03eb8-154">Some database APIs identify them as snapshot cursors.</span></span>  
  
 <span data-ttu-id="03eb8-155">索引鍵集</span><span class="sxs-lookup"><span data-stu-id="03eb8-155">Keyset</span></span>  
 <span data-ttu-id="03eb8-156">開啟資料指標時，索引鍵集驅動資料指標中的成員資格和資料列順序是固定的。</span><span class="sxs-lookup"><span data-stu-id="03eb8-156">The membership and order of rows in a keyset-driven cursor are fixed when the cursor is opened.</span></span> <span data-ttu-id="03eb8-157">索引鍵集驅動資料指標是由一組唯一的識別碼、索引鍵 (稱為索引鍵集) 所控制。</span><span class="sxs-lookup"><span data-stu-id="03eb8-157">Keyset-driven cursors are controlled by a set of unique identifiers, keys, known as the keyset.</span></span> <span data-ttu-id="03eb8-158">索引鍵是從結果集中唯一識別資料列的一組資料行建立的。</span><span class="sxs-lookup"><span data-stu-id="03eb8-158">The keys are built from a set of columns that uniquely identify the rows in the result set.</span></span> <span data-ttu-id="03eb8-159">索引鍵集是一組取自所有資料列的索引鍵值，這些資料列會在開啟資料指標時對 SELECT 陳述式加以限定。</span><span class="sxs-lookup"><span data-stu-id="03eb8-159">The keyset is the set of the key values from all the rows that qualified for the SELECT statement at the time the cursor was opened.</span></span> <span data-ttu-id="03eb8-160">開啟資料指標時，會在 **tempdb** 中建立索引鍵集驅動資料指標的索引鍵集。</span><span class="sxs-lookup"><span data-stu-id="03eb8-160">The keyset for a keyset-driven cursor is built in **tempdb** when the cursor is opened.</span></span>  
  
 <span data-ttu-id="03eb8-161">動態</span><span class="sxs-lookup"><span data-stu-id="03eb8-161">Dynamic</span></span>  
 <span data-ttu-id="03eb8-162">動態資料指標是靜態資料指標的相反。</span><span class="sxs-lookup"><span data-stu-id="03eb8-162">Dynamic cursors are the opposite of static cursors.</span></span> <span data-ttu-id="03eb8-163">捲動資料指標時，動態資料指標會反映其結果集中資料列的所有變更。</span><span class="sxs-lookup"><span data-stu-id="03eb8-163">Dynamic cursors reflect all changes made to the rows in their result set when scrolling through the cursor.</span></span> <span data-ttu-id="03eb8-164">每回擷取時結果集之中資料列的資料值、順序和成員均會變動。</span><span class="sxs-lookup"><span data-stu-id="03eb8-164">The data values, order, and membership of the rows in the result set can change on each fetch.</span></span> <span data-ttu-id="03eb8-165">您可以透過資料指標看到所有使用者執行的全部 UPDATE、INSERT 和 DELETE 陳述式作業。</span><span class="sxs-lookup"><span data-stu-id="03eb8-165">All UPDATE, INSERT, and DELETE statements made by all users are visible through the cursor.</span></span> <span data-ttu-id="03eb8-166">若是藉由使用 API 函數 (如： **SQLSetPos** 或 [!INCLUDE[tsql](../includes/tsql-md.md)] WHERE CURRENT OF 子句) 的資料指標來進行更新，您會馬上看到更新。</span><span class="sxs-lookup"><span data-stu-id="03eb8-166">Updates are visible immediately if they are made through the cursor using either an API function such as **SQLSetPos** or the [!INCLUDE[tsql](../includes/tsql-md.md)] WHERE CURRENT OF clause.</span></span> <span data-ttu-id="03eb8-167">至於資料指標外的更新必須經過認可後才看得見，除非資料指標交易隔離等級設定為讀取未認可。</span><span class="sxs-lookup"><span data-stu-id="03eb8-167">Updates made outside the cursor are not visible until they are committed, unless the cursor transaction isolation level is set to read uncommitted.</span></span> <span data-ttu-id="03eb8-168">動態資料指標計劃一律不會使用空間索引。</span><span class="sxs-lookup"><span data-stu-id="03eb8-168">Dynamic cursor plans never use spatial indexes.</span></span>  
  
## <a name="requesting-a-cursor"></a><span data-ttu-id="03eb8-169">要求資料指標</span><span class="sxs-lookup"><span data-stu-id="03eb8-169">Requesting a Cursor</span></span>  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="03eb8-170">支援兩種要求資料指標的方法：</span><span class="sxs-lookup"><span data-stu-id="03eb8-170">supports two methods for requesting a cursor:</span></span>  
  
-   [!INCLUDE[tsql](../includes/tsql-md.md)]  
  
     <span data-ttu-id="03eb8-171">[!INCLUDE[tsql](../includes/tsql-md.md)] 語言支援使用 ISO 以後版本的資料指標語法。</span><span class="sxs-lookup"><span data-stu-id="03eb8-171">The [!INCLUDE[tsql](../includes/tsql-md.md)] language supports a syntax for using cursors modeled after the ISO cursor syntax.</span></span>  
  
-   <span data-ttu-id="03eb8-172">資料庫應用程式開發介面 (API) 資料指標函數</span><span class="sxs-lookup"><span data-stu-id="03eb8-172">Database application programming interface (API) cursor functions</span></span>  
  
     [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="03eb8-173">支援以下資料庫 API 的資料指標功能：</span><span class="sxs-lookup"><span data-stu-id="03eb8-173">supports the cursor functionality of these database APIs:</span></span>  
  
    -   <span data-ttu-id="03eb8-174">ADO ([!INCLUDE[msCoName](../includes/msconame-md.md)] ActiveX 資料物件)</span><span class="sxs-lookup"><span data-stu-id="03eb8-174">ADO ([!INCLUDE[msCoName](../includes/msconame-md.md)] ActiveX Data Object)</span></span>  
  
    -   <span data-ttu-id="03eb8-175">OLE DB</span><span class="sxs-lookup"><span data-stu-id="03eb8-175">OLE DB</span></span>  
  
    -   <span data-ttu-id="03eb8-176">ODBC (開放式資料庫連接)</span><span class="sxs-lookup"><span data-stu-id="03eb8-176">ODBC (Open Database Connectivity)</span></span>  
  
 <span data-ttu-id="03eb8-177">應用程式不應將兩種要求資料指標的方法混合。</span><span class="sxs-lookup"><span data-stu-id="03eb8-177">An application should never mix these two methods of requesting a cursor.</span></span> <span data-ttu-id="03eb8-178">使用 API 指定資料指標行為的應用程式也不應執行 [!INCLUDE[tsql](../includes/tsql-md.md)] DECLARE CURSOR 陳述式來要求 [!INCLUDE[tsql](../includes/tsql-md.md)] 資料指標。</span><span class="sxs-lookup"><span data-stu-id="03eb8-178">An application that has used the API to specify cursor behaviors should not then execute a [!INCLUDE[tsql](../includes/tsql-md.md)] DECLARE CURSOR statement to also request a [!INCLUDE[tsql](../includes/tsql-md.md)] cursor.</span></span> <span data-ttu-id="03eb8-179">如果應用程式已將所有 API 資料指標屬性設回其預設值，只應執行 DECLARE CURSOR。</span><span class="sxs-lookup"><span data-stu-id="03eb8-179">An application should only execute DECLARE CURSOR if it has set all the API cursor attributes back to their defaults.</span></span>  
  
 <span data-ttu-id="03eb8-180">如果沒有要求 [!INCLUDE[tsql](../includes/tsql-md.md)] 或 API 資料指標， [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 預設會傳回完整的結果集 (亦即預設結果集) 給應用程式。</span><span class="sxs-lookup"><span data-stu-id="03eb8-180">If neither a [!INCLUDE[tsql](../includes/tsql-md.md)] nor API cursor has been requested, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] defaults to returning a complete result set, known as a default result set, to the application.</span></span>  
  
## <a name="cursor-process"></a><span data-ttu-id="03eb8-181">資料指標處理過程</span><span class="sxs-lookup"><span data-stu-id="03eb8-181">Cursor Process</span></span>  
 [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="03eb8-182">資料指標和 API 資料指標具有不同的語法，但是下列一般處理過程適用於所有的 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 資料指標：</span><span class="sxs-lookup"><span data-stu-id="03eb8-182">cursors and API cursors have different syntax, but the following general process is used with all [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cursors:</span></span>  
  
1.  <span data-ttu-id="03eb8-183">使資料指標與 [!INCLUDE[tsql](../includes/tsql-md.md)] 陳述式的結果集建立關聯，並定義資料指標的特性，例如可否更新資料指標中的資料列。</span><span class="sxs-lookup"><span data-stu-id="03eb8-183">Associate a cursor with the result set of a [!INCLUDE[tsql](../includes/tsql-md.md)] statement, and define characteristics of the cursor, such as whether the rows in the cursor can be updated.</span></span>  
  
2.  <span data-ttu-id="03eb8-184">執行 [!INCLUDE[tsql](../includes/tsql-md.md)] 陳述式，以填入資料指標。</span><span class="sxs-lookup"><span data-stu-id="03eb8-184">Execute the [!INCLUDE[tsql](../includes/tsql-md.md)] statement to populate the cursor.</span></span>  
  
3.  <span data-ttu-id="03eb8-185">擷取資料指標中您要檢視的資料列。</span><span class="sxs-lookup"><span data-stu-id="03eb8-185">Retrieve the rows in the cursor you want to see.</span></span> <span data-ttu-id="03eb8-186">從資料指標擷取一個資料列或資料列區塊的作業稱為擷取 (Fetch)。</span><span class="sxs-lookup"><span data-stu-id="03eb8-186">The operation to retrieve one row or one block of rows from a cursor is called a fetch.</span></span> <span data-ttu-id="03eb8-187">以順向 (Forward) 或逆向 (Backward) 擷取資料列的一系列擷取作業，稱為捲動 (Scroll)。</span><span class="sxs-lookup"><span data-stu-id="03eb8-187">Performing a series of fetches to retrieve rows in either a forward or backward direction is called scrolling.</span></span>  
  
4.  <span data-ttu-id="03eb8-188">選擇性地在資料指標目前位置上的資料列執行修改作業 (更新或刪除)。</span><span class="sxs-lookup"><span data-stu-id="03eb8-188">Optionally, perform modification operations (update or delete) on the row at the current position in the cursor.</span></span>  
  
5.  <span data-ttu-id="03eb8-189">關閉資料指標。</span><span class="sxs-lookup"><span data-stu-id="03eb8-189">Close the cursor.</span></span>  
  
## <a name="related-content"></a><span data-ttu-id="03eb8-190">相關內容</span><span class="sxs-lookup"><span data-stu-id="03eb8-190">Related Content</span></span>  
 <span data-ttu-id="03eb8-191">[資料指標行為](native-client-odbc-cursors/cursor-behaviors.md) [如何實作資料指標](native-client-odbc-cursors/implementation/how-cursors-are-implemented.md)</span><span class="sxs-lookup"><span data-stu-id="03eb8-191">[Cursor Behaviors](native-client-odbc-cursors/cursor-behaviors.md) [How Cursors Are Implemented](native-client-odbc-cursors/implementation/how-cursors-are-implemented.md)</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="03eb8-192">另請參閱</span><span class="sxs-lookup"><span data-stu-id="03eb8-192">See Also</span></span>  
 <span data-ttu-id="03eb8-193">[DECLARE CURSOR &#40;Transact-sql&#41;](/sql/t-sql/language-elements/declare-cursor-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="03eb8-193">[DECLARE CURSOR &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/declare-cursor-transact-sql) </span></span>  
 <span data-ttu-id="03eb8-194">[資料指標 &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/cursors-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="03eb8-194">[Cursors &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/cursors-transact-sql) </span></span>  
 <span data-ttu-id="03eb8-195">[&#40;Transact-sql&#41;的資料指標函數](/sql/t-sql/functions/cursor-functions-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="03eb8-195">[Cursor Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/cursor-functions-transact-sql) </span></span>  
 [<span data-ttu-id="03eb8-196">資料指標預存程序 &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="03eb8-196">Cursor Stored Procedures &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/cursor-stored-procedures-transact-sql)  
  
  
