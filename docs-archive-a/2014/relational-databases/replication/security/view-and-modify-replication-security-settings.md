---
title: 檢視及修改複寫安全性設定 | Microsoft 文件
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- modifying replication security settings
- replication [SQL Server], security
- security [SQL Server replication], viewing settings
- viewing replication security settings
- security [SQL Server replication], modifying settings
ms.assetid: 67d79532-1482-4de1-ac9f-4a23d162c85e
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 8da4a6e8093c6f04e06b68448660e4096e9e5c22
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87606752"
---
# <a name="view-and-modify-replication-security-settings"></a><span data-ttu-id="55bee-102">檢視及修改複寫安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-102">View and Modify Replication Security Settings</span></span>
  <span data-ttu-id="55bee-103">本主題描述如何使用 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] 、 [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]或 Replication Management Objects (RMO)，在 [!INCLUDE[tsql](../../../includes/tsql-md.md)]中檢視及修改複寫安全性設定。</span><span class="sxs-lookup"><span data-stu-id="55bee-103">This topic describes how to view and modify replication security settings in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="55bee-104">例如，您可能要將「記錄讀取器代理程式」到「發行者」的連接從 SQL Server 驗證變更為 Windows 整合式驗證，或者在 Windows 帳戶密碼變更後，可能需要變更用來執行代理程式作業的認證。</span><span class="sxs-lookup"><span data-stu-id="55bee-104">For example, you might want to change the connection of the Log Reader Agent to the Publisher from SQL Server Authentication to Windows Integrated Authentication, or you might need to change the credentials used to run an agent job when the Windows account password has changed.</span></span> <span data-ttu-id="55bee-105">如需有關各代理程式需要的權限資訊，請參閱＜ [複寫代理程式安全性模型](replication-agent-security-model.md)＞。</span><span class="sxs-lookup"><span data-stu-id="55bee-105">For information about the permissions required by each agent, see [Replication Agent Security Model](replication-agent-security-model.md).</span></span>  
  
 <span data-ttu-id="55bee-106">**本主題內容**</span><span class="sxs-lookup"><span data-stu-id="55bee-106">**In This Topic**</span></span>  
  
-   <span data-ttu-id="55bee-107">**開始之前：**</span><span class="sxs-lookup"><span data-stu-id="55bee-107">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="55bee-108">限制事項</span><span class="sxs-lookup"><span data-stu-id="55bee-108">Limitations and Restrictions</span></span>](#Restrictions)  
  
     [<span data-ttu-id="55bee-109">安全性</span><span class="sxs-lookup"><span data-stu-id="55bee-109">Security</span></span>](#Security)  
  
-   <span data-ttu-id="55bee-110">**若要檢視及修改複寫安全性設定，請使用：**</span><span class="sxs-lookup"><span data-stu-id="55bee-110">**To view and modify replication security settings, using:**</span></span>  
  
     [<span data-ttu-id="55bee-111">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="55bee-111">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="55bee-112">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="55bee-112">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="55bee-113">Replication Management Objects (RMO)</span><span class="sxs-lookup"><span data-stu-id="55bee-113">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
-   <span data-ttu-id="55bee-114">**後續操作：** [修改複寫安全性設定之後](#FollowUp)</span><span class="sxs-lookup"><span data-stu-id="55bee-114">**Follow Up:**  [After you modify replication security settings](#FollowUp)</span></span>  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="55bee-115">開始之前</span><span class="sxs-lookup"><span data-stu-id="55bee-115">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="55bee-116">限制事項</span><span class="sxs-lookup"><span data-stu-id="55bee-116">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="55bee-117">您所使用的預存程序，將取決於代理程式的類型和伺服器連接的類型而定。</span><span class="sxs-lookup"><span data-stu-id="55bee-117">The stored procedures that you use will depend on the type of agent and the type of server connection.</span></span>  
  
-   <span data-ttu-id="55bee-118">您所使用的 RMO 類別和屬性，將取決於代理程式的類型和伺服器連接的類型而定。</span><span class="sxs-lookup"><span data-stu-id="55bee-118">The RMO classes and properties you use depend on the type of agent and the type of server connection.</span></span>  
  
###  <a name="security"></a><a name="Security"></a> <span data-ttu-id="55bee-119">Security</span><span class="sxs-lookup"><span data-stu-id="55bee-119">Security</span></span>  
 <span data-ttu-id="55bee-120">基於安全性理由，密碼的實際值在複寫預存程序所傳回的結果集中會有遮罩。</span><span class="sxs-lookup"><span data-stu-id="55bee-120">For security reasons, the actual values of passwords are masked in result sets returned by replication stored procedures.</span></span>  
  
####  <a name="permissions"></a><a name="Permissions"></a> <span data-ttu-id="55bee-121">權限</span><span class="sxs-lookup"><span data-stu-id="55bee-121">Permissions</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="55bee-122">使用 SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="55bee-122">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="55bee-123">檢視並修改下列對話方塊中的安全性設定：</span><span class="sxs-lookup"><span data-stu-id="55bee-123">View and modify security settings in the following dialog boxes:</span></span>  
  
1.  <span data-ttu-id="55bee-124">**[更新複寫密碼]** 對話方塊，可從 **的** [複寫] [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]資料夾開啟。</span><span class="sxs-lookup"><span data-stu-id="55bee-124">The **Update Replication Passwords** dialog box, which is available from the **Replication** folder of [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="55bee-125">如果變更複寫拓撲中伺服器上 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 帳戶或 Windows 帳戶的密碼，請使用此對話方塊，而非更新使用該帳戶之每個代理程式的密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-125">If you change the password for a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] account or Windows account on a server in a replication topology, use this dialog box rather than updating the password for each agent that uses the account.</span></span> <span data-ttu-id="55bee-126">如果多個伺服器上的代理程式使用同一個帳戶，則必須連接到每個伺服器並變更密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-126">If agents on more than one server use the same account, you must connect to each server and change the password.</span></span> <span data-ttu-id="55bee-127">密碼在複寫使用密碼的所有位置更新。</span><span class="sxs-lookup"><span data-stu-id="55bee-127">The password is updated in all of the places that replication uses the password.</span></span> <span data-ttu-id="55bee-128">而並不會在其他位置更新，例如連結的伺服器。</span><span class="sxs-lookup"><span data-stu-id="55bee-128">The password is not updated in other places, such as linked servers.</span></span>  
  
2.  <span data-ttu-id="55bee-129">[發行集屬性 - \<Publication>] 對話方塊的 [代理程式安全性] 頁面。</span><span class="sxs-lookup"><span data-stu-id="55bee-129">The **Agent Security** page of the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="55bee-130">如需有關存取這個對話方塊的詳細資訊，請參閱＜ [View and Modify Publication Properties](../publish/view-and-modify-publication-properties.md)＞。</span><span class="sxs-lookup"><span data-stu-id="55bee-130">For more information about accessing this dialog box, see [View and Modify Publication Properties](../publish/view-and-modify-publication-properties.md).</span></span>  
  
3.  <span data-ttu-id="55bee-131">[訂閱屬性 - \<Subscription>] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="55bee-131">The **Subscription Properties - \<Subscription>** dialog box.</span></span> <span data-ttu-id="55bee-132">如需有關存取這個對話方塊的詳細資訊，請參閱＜ [View and Modify Push Subscription Properties](../view-and-modify-push-subscription-properties.md) ＞與＜ [View and Modify Pull Subscription Properties](../view-and-modify-pull-subscription-properties.md)＞。</span><span class="sxs-lookup"><span data-stu-id="55bee-132">For more information about accessing this dialog box, see [View and Modify Push Subscription Properties](../view-and-modify-push-subscription-properties.md) and [View and Modify Pull Subscription Properties](../view-and-modify-pull-subscription-properties.md).</span></span>  
  
4.  <span data-ttu-id="55bee-133">[散發者屬性 - \<Distributor>] 和 [散發資料庫屬性 - \<Database>] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="55bee-133">The **Distributor Properties - \<Distributor>** and **Distribution Database Properties - \<Database>** dialog boxes.</span></span> <span data-ttu-id="55bee-134">如需存取這些對話方塊的詳細資訊，請參閱＜ [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md)＞。</span><span class="sxs-lookup"><span data-stu-id="55bee-134">For more information about accessing these dialog boxes, see [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
5.  <span data-ttu-id="55bee-135">[發行者屬性 - \<Publisher>] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="55bee-135">The **Publisher Properties - \<Publisher>** dialog box.</span></span> <span data-ttu-id="55bee-136">如需存取此對話方塊的詳細資訊，請參閱＜ [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md)＞。</span><span class="sxs-lookup"><span data-stu-id="55bee-136">For more information about accessing this dialog box, [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
#### <a name="to-change-the-password-for-an-account-used-by-one-or-more-agents"></a><span data-ttu-id="55bee-137">若要變更一個或多個代理程式使用的帳戶之密碼</span><span class="sxs-lookup"><span data-stu-id="55bee-137">To change the password for an account used by one or more agents</span></span>  
  
1.  <span data-ttu-id="55bee-138">如果該帳戶是 SQL Server 帳戶，則此對話方塊要變更 SQL Server 帳戶的密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-138">If the account is a SQL Server account, this dialog box will also change the password for the SQL Server account.</span></span> <span data-ttu-id="55bee-139">如果該帳戶是 Windows 帳戶，則應先變更 Windows 中的密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-139">If the account is a Windows account, change the password in Windows first.</span></span> <span data-ttu-id="55bee-140">如需詳細資訊，請參閱 Windows 文件集。</span><span class="sxs-lookup"><span data-stu-id="55bee-140">For more information, see the Windows documentation.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="55bee-141">在變更複寫密碼之後，必須停止並重新啟動使用該代理程式變更生效前所用密碼的每一個代理程式。</span><span class="sxs-lookup"><span data-stu-id="55bee-141">After changing a replication password, you must stop and restart each agent that uses the password before the change takes effect for that agent.</span></span>  
  
2.  <span data-ttu-id="55bee-142">連接到 [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]中的伺服器，然後展開伺服器節點。</span><span class="sxs-lookup"><span data-stu-id="55bee-142">Connect to the server in [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
3.  <span data-ttu-id="55bee-143">以滑鼠右鍵按一下 **[複寫]** 資料夾，然後按一下 **[更新複寫密碼]** 。</span><span class="sxs-lookup"><span data-stu-id="55bee-143">Right-click the **Replication** folder, and then click **Update Replication Passwords**.</span></span>  
  
4.  <span data-ttu-id="55bee-144">在 **[更新複寫密碼]** 對話方塊中，指定帳戶與新密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-144">In the **Update Replication Passwords** dialog box, specify the account and the new password.</span></span>  
  
5.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-security-settings-for-the-snapshot-agent"></a><span data-ttu-id="55bee-145">變更快照集代理程式的安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-145">To change security settings for the Snapshot Agent</span></span>  
  
1.  <span data-ttu-id="55bee-146">在 [發行集屬性 - \<Publication>] 對話方塊的 [代理程式安全性] 頁面上，按一下 [快照集代理程式] 文字方塊旁的 [安全性設定] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="55bee-146">On the **Agent Security** page of the **Publication Properties - \<Publication>** dialog box, click the **Security Settings** button next to the **Snapshot Agent** text box.</span></span>  
  
2.  <span data-ttu-id="55bee-147">在 **[快照集代理程式安全性]** 對話方塊中，指定代理程式執行時所使用的帳戶：</span><span class="sxs-lookup"><span data-stu-id="55bee-147">In the **Snapshot Agent Security** dialog box, specify the account under which the agent should run:</span></span>  
  
    -   <span data-ttu-id="55bee-148">在 **[代理程式帳戶]** 文字方塊中輸入新的 Windows 帳戶。</span><span class="sxs-lookup"><span data-stu-id="55bee-148">Enter a new Windows account in the **Agent account** text box.</span></span>  
  
    -   <span data-ttu-id="55bee-149">在 **[密碼]** 和 **[確認密碼]** 文字方塊中輸入新的增強式密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-149">Enter a new strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
3.  <span data-ttu-id="55bee-150">指定代理程式要從散發者連接到發行者的內容。</span><span class="sxs-lookup"><span data-stu-id="55bee-150">Specify the context under which the agent should connect from the Distributor to the Publisher.</span></span> <span data-ttu-id="55bee-151">若您選取 **[使用下列的 SQL Server 登入]** ，必須同時指定登入：</span><span class="sxs-lookup"><span data-stu-id="55bee-151">If you select **Using the following SQL Server login**, you must also specify the login:</span></span>  
  
    -   <span data-ttu-id="55bee-152">在 **[登入]** 文字方塊中輸入登入。</span><span class="sxs-lookup"><span data-stu-id="55bee-152">Enter a login in the **Login** text box</span></span>  
  
    -   <span data-ttu-id="55bee-153">在 **[密碼]** 和 **[確認密碼]** 文字方塊中輸入新的增強式密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-153">Enter a new strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="55bee-154">若發行者是 Oracle 發行者，則會在 [散發者屬性 - \<Distributor>] 對話方塊中指定連線內容。</span><span class="sxs-lookup"><span data-stu-id="55bee-154">If the Publisher is an Oracle Publisher, the connection context is specified in the **Distributor Properties - \<Distributor>** dialog box.</span></span> <span data-ttu-id="55bee-155">請參閱下面用於變更內容的程序。</span><span class="sxs-lookup"><span data-stu-id="55bee-155">See below for the procedure to change the context.</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-security-settings-for-the-log-reader-agent"></a><span data-ttu-id="55bee-156">變更記錄讀取器代理程式的安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-156">To change security settings for the Log Reader Agent</span></span>  
  
1.  <span data-ttu-id="55bee-157">在 [發行集屬性 - \<Publication>] 對話方塊的 [代理程式安全性] 頁面上，按一下 [記錄讀取器代理程式] 文字方塊旁的 [安全性設定] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="55bee-157">On the **Agent Security** page of the **Publication Properties - \<Publication>** dialog box, click the **Security Settings** button next to the **Log Reader Agent** text box.</span></span>  
  
2.  <span data-ttu-id="55bee-158">在 **[記錄讀取器代理程式安全性]** 對話方塊中，指定代理程式執行時所使用的帳戶：</span><span class="sxs-lookup"><span data-stu-id="55bee-158">In the **Log Reader Agent Security** dialog box, specify the account under which the agent should run:</span></span>  
  
    -   <span data-ttu-id="55bee-159">在 **[代理程式帳戶]** 文字方塊中輸入新的 Windows 帳戶。</span><span class="sxs-lookup"><span data-stu-id="55bee-159">Enter a new Windows account in the **Agent account** text box</span></span>  
  
    -   <span data-ttu-id="55bee-160">在 **[密碼]** 和 **[確認密碼]** 文字方塊中輸入新的增強式密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-160">Enter a new strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
3.  <span data-ttu-id="55bee-161">指定代理程式要從散發者連接到發行者的內容。</span><span class="sxs-lookup"><span data-stu-id="55bee-161">Specify the context under which the agent should connect from the Distributor to the Publisher.</span></span> <span data-ttu-id="55bee-162">若您選取 **[使用下列的 SQL Server 登入]** ，必須同時指定登入：</span><span class="sxs-lookup"><span data-stu-id="55bee-162">If you select **Using the following SQL Server login**, you must also specify the login:</span></span>  
  
    -   <span data-ttu-id="55bee-163">在 **[登入]** 文字方塊中輸入登入。</span><span class="sxs-lookup"><span data-stu-id="55bee-163">Enter a login in the **Login** text box</span></span>  
  
    -   <span data-ttu-id="55bee-164">在 **[密碼]** 和 **[確認密碼]** 文字方塊中輸入新的增強式密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-164">Enter a new strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="55bee-165">若發行者是 Oracle 發行者，則會在 [散發者屬性 - \<Distributor>] 對話方塊中指定連線內容。</span><span class="sxs-lookup"><span data-stu-id="55bee-165">If the Publisher is an Oracle Publisher, the connection context is specified in the **Distributor Properties - \<Distributor>** dialog box.</span></span> <span data-ttu-id="55bee-166">使用下一個程序變更內容。</span><span class="sxs-lookup"><span data-stu-id="55bee-166">Change the context using the next procedure.</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
    > [!NOTE]  
    >  <span data-ttu-id="55bee-167">每個已發行的資料庫都有一個「記錄讀取器代理程式」。</span><span class="sxs-lookup"><span data-stu-id="55bee-167">There is one Log Reader Agent for each published database.</span></span> <span data-ttu-id="55bee-168">在一個發行集上變更代理程式的安全性設定會影響該發行集資料庫中所有發行集的設定。</span><span class="sxs-lookup"><span data-stu-id="55bee-168">Changing the security settings for the agent on one publication affects the settings for all publications in the publication database.</span></span>  
  
#### <a name="to-change-the-context-under-which-the-snapshot-agent-and-log-reader-agent-for-an-oracle-publication-make-connections-to-the-publisher"></a><span data-ttu-id="55bee-169">若要變更 Oracle 發行集的快照集代理程式與記錄讀取器代理程式連接到發行者所使用的內容</span><span class="sxs-lookup"><span data-stu-id="55bee-169">To change the context under which the Snapshot Agent and Log Reader Agent for an Oracle publication make connections to the Publisher</span></span>  
  
1.  <span data-ttu-id="55bee-170">在 [散發者屬性 - \<Distributor>] 對話方塊的 [發行者] 頁面上，按一下發行者旁的屬性按鈕 ( **...** )。</span><span class="sxs-lookup"><span data-stu-id="55bee-170">On the **Publishers** page of the **Distributor Properties - \<Distributor>** dialog box, click the properties button (**...**) next to a Publisher.</span></span>  
  
2.  <span data-ttu-id="55bee-171">在 **[代理程式至發行者的連接]** 區段，指定您設定的複寫管理使用者結構描述所使用之登入與密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-171">In the **Agent Connection to the Publisher** section, specify the login and password used by the replication administrative user schema you configured.</span></span> <span data-ttu-id="55bee-172">如需詳細資訊，請參閱[設定 Oracle 發行者](../non-sql/configure-an-oracle-publisher.md)。</span><span class="sxs-lookup"><span data-stu-id="55bee-172">For more information, see [Configure an Oracle Publisher](../non-sql/configure-an-oracle-publisher.md).</span></span>  
  
3.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-security-settings-for-the-distribution-agent-for-a-push-subscription"></a><span data-ttu-id="55bee-173">變更發送訂閱之散發代理程式的安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-173">To change security settings for the Distribution Agent for a push subscription</span></span>  
  
1.  <span data-ttu-id="55bee-174">在發行者端的 [訂閱屬性 - \<Subscription>] 對話方塊中，可進行下列變更：</span><span class="sxs-lookup"><span data-stu-id="55bee-174">In the **Subscription Properties - \<Subscription>** dialog box at the Publisher, you can make the following changes:</span></span>  
  
    -   <span data-ttu-id="55bee-175">若要變更散發代理程式執行和連接到散發者時所使用的帳戶，請按一下 [代理程式處理帳戶] 資料列，然後按一下資料列中的屬性 ( **...** ) 按鈕。</span><span class="sxs-lookup"><span data-stu-id="55bee-175">To change the account under which the Distribution Agent runs and makes connections to the Distributor, click the **Agent process account** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="55bee-176">在 **[散發代理程式安全性]** 對話方塊中指定帳戶和密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-176">Specify an account and password in the **Distribution Agent Security** dialog box.</span></span>  
  
    -   <span data-ttu-id="55bee-177">若要變更散發代理程式連接到訂閱者所使用的內容，請按一下 [訂閱者連接] 資料列，然後按一下資料列中的屬性 ( **...** ) 按鈕。</span><span class="sxs-lookup"><span data-stu-id="55bee-177">To change the context under which the Distribution Agent connects to the Subscriber, click the **Subscriber Connection** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="55bee-178">在 **[輸入連接資訊]** 對話方塊中指定內容。</span><span class="sxs-lookup"><span data-stu-id="55bee-178">Specify the context in the **Enter Connection Information** dialog box.</span></span>  
  
         <span data-ttu-id="55bee-179">若您使用佇列更新訂閱，佇列讀取器代理程式亦使用此處指定的內容，連接到訂閱者。</span><span class="sxs-lookup"><span data-stu-id="55bee-179">If you use queued updating subscriptions, the Queue Reader Agent also uses the context specified here for connections to the Subscriber.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-security-settings-for-the-distribution-agent-for-a-pull-subscription"></a><span data-ttu-id="55bee-180">變更提取訂閱之散發代理程式的安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-180">To change security settings for the Distribution Agent for a pull subscription</span></span>  
  
1.  <span data-ttu-id="55bee-181">在訂閱者端的 [訂閱屬性 - \<Subscription>] 對話方塊中，可進行下列變更：</span><span class="sxs-lookup"><span data-stu-id="55bee-181">In the **Subscription Properties - \<Subscription>** dialog box at the Subscriber, you can make the following changes:</span></span>  
  
    -   <span data-ttu-id="55bee-182">若要變更散發代理程式執行和連接到訂閱者時所使用的帳戶，請按一下 [代理程式處理帳戶] 資料列，然後按一下資料列中的屬性 ( **...** ) 按鈕。</span><span class="sxs-lookup"><span data-stu-id="55bee-182">To change the account under which the Distribution Agent runs and makes connections to the Subscriber, click the **Agent process account** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="55bee-183">在 **[散發代理程式安全性]** 對話方塊中指定帳戶和密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-183">Specify an account and password in the **Distribution Agent Security** dialog box.</span></span>  
  
         <span data-ttu-id="55bee-184">若您使用佇列更新訂閱，佇列讀取器代理程式亦使用此處指定的內容，連接到訂閱者。</span><span class="sxs-lookup"><span data-stu-id="55bee-184">If you use queued updating subscriptions, the Queue Reader Agent also uses the context specified here for connections to the Subscriber.</span></span>  
  
    -   <span data-ttu-id="55bee-185">若要變更散發代理程式連接到散發者所使用的內容，請按一下 [散發者連接] 資料列，然後按一下資料列中的屬性 ( **...** ) 按鈕。</span><span class="sxs-lookup"><span data-stu-id="55bee-185">To change the context under which the Distribution Agent connects to the Distributor, click the **Distributor Connection** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="55bee-186">在 **[輸入連接資訊]** 對話方塊中指定內容。</span><span class="sxs-lookup"><span data-stu-id="55bee-186">Specify the context in the **Enter Connection Information** dialog box.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-security-settings-for-the-merge-agent-for-a-push-subscription"></a><span data-ttu-id="55bee-187">變更發送訂閱之合併代理程式的安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-187">To change security settings for the Merge Agent for a push subscription</span></span>  
  
1.  <span data-ttu-id="55bee-188">在發行者端的 [訂閱屬性 - \<Subscription>] 對話方塊中，可進行下列變更：</span><span class="sxs-lookup"><span data-stu-id="55bee-188">In the **Subscription Properties - \<Subscription>** dialog box at the Publisher, you can make the following changes:</span></span>  
  
    -   <span data-ttu-id="55bee-189">若要變更合併代理程式執行和連接到發行者與散發者時所使用的帳戶，請按一下 [代理程式處理帳戶] 資料列，然後按一下資料列中的屬性 ( **...** ) 按鈕。</span><span class="sxs-lookup"><span data-stu-id="55bee-189">To change the account under which the Merge Agent runs and makes connections to the Publisher and Distributor, click the **Agent process account** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="55bee-190">在 **[合併代理程式安全性]** 對話方塊中指定帳戶和密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-190">Specify an account and password in the **Merge Agent Security** dialog box.</span></span>  
  
    -   <span data-ttu-id="55bee-191">若要變更合併代理程式連接到訂閱者所使用的內容，請按一下 [訂閱者連接] 資料列，然後按一下資料列中的屬性 ( **...** ) 按鈕。</span><span class="sxs-lookup"><span data-stu-id="55bee-191">To change the context under which the Merge Agent connects to the Subscriber, click the **Subscriber Connection** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="55bee-192">在 **[輸入連接資訊]** 對話方塊中指定內容。</span><span class="sxs-lookup"><span data-stu-id="55bee-192">Specify the context in the **Enter Connection Information** dialog box.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-security-settings-for-the-merge-agent-for-a-pull-subscription"></a><span data-ttu-id="55bee-193">變更提取訂閱之合併代理程式的安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-193">To change security settings for the Merge Agent for a pull subscription</span></span>  
  
1.  <span data-ttu-id="55bee-194">在訂閱者端的 [訂閱屬性 - \<Subscription>] 對話方塊中，可進行下列變更：</span><span class="sxs-lookup"><span data-stu-id="55bee-194">In the **Subscription Properties - \<Subscription>** dialog box at the Subscriber, you can make the following changes:</span></span>  
  
    -   <span data-ttu-id="55bee-195">若要變更合併代理程式執行和連接到訂閱者時所使用的帳戶，請按一下 [代理程式處理帳戶] 資料列，然後按一下資料列中的屬性 ( **...** ) 按鈕。</span><span class="sxs-lookup"><span data-stu-id="55bee-195">To change the account under which the Merge Agent runs and makes connections to the Subscriber, click the **Agent process account** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="55bee-196">在 **[合併代理程式安全性]** 對話方塊中指定帳戶和密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-196">Specify an account and password in the **Merge Agent Security** dialog box.</span></span>  
  
    -   <span data-ttu-id="55bee-197">若要變更合併代理程式連接到發行者與散發者所使用的內容，請按一下 [發行者連接] 資料列，然後按一下資料列中的屬性 ( **...** ) 按鈕。</span><span class="sxs-lookup"><span data-stu-id="55bee-197">To change the context under which the Merge Agent connects to the Publisher and Distributor, click the **Publisher Connection** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="55bee-198">在 **[輸入連接資訊]** 對話方塊中指定內容。</span><span class="sxs-lookup"><span data-stu-id="55bee-198">Specify the context in the **Enter Connection Information** dialog box.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-the-account-under-which-the-queue-reader-agent-runs"></a><span data-ttu-id="55bee-199">若要變更佇列讀取器代理程式執行時所使用的帳戶</span><span class="sxs-lookup"><span data-stu-id="55bee-199">To change the account under which the Queue Reader Agent runs</span></span>  
  
1.  <span data-ttu-id="55bee-200">在 [散發者屬性 - \<Distributor>] 對話方塊的 [一般] 頁面上，按一下散發資料庫的屬性按鈕 ( **...** )。</span><span class="sxs-lookup"><span data-stu-id="55bee-200">On the **General** page of the **Distributor Properties - \<Distributor>** dialog box, click the properties (**...**) button next to the distribution database.</span></span>  
  
2.  <span data-ttu-id="55bee-201">在 [散發資料庫屬性 - \<Database>] 對話方塊中，按一下 [代理程式處理帳戶] 文字方塊旁的 [安全性設定] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="55bee-201">In the **Distribution Database Properties - \<Database>** dialog box, click the **Security Settings** button next to the **Agent process account** text box.</span></span>  
  
3.  <span data-ttu-id="55bee-202">在 **[佇列讀取器代理程式安全性]** 對話方塊中，指定代理程式執行和連接到「散發者」時所使用的帳戶：</span><span class="sxs-lookup"><span data-stu-id="55bee-202">In the **Queue Reader Agent Security** dialog box, specify the account under which the agent runs and makes connections to the Distributor:</span></span>  
  
    -   <span data-ttu-id="55bee-203">在 **[處理帳戶]** 文字方塊中輸入新的 Windows 帳戶。</span><span class="sxs-lookup"><span data-stu-id="55bee-203">Enter a new Windows account in the **Process account** text box</span></span>  
  
    -   <span data-ttu-id="55bee-204">在 **[密碼]** 和 **[確認密碼]** 文字方塊中輸入新的增強式密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-204">Enter a new strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
    > [!NOTE]  
    >  <span data-ttu-id="55bee-205">每個散發資料庫都會有一個佇列讀取器代理程式。</span><span class="sxs-lookup"><span data-stu-id="55bee-205">There is one Queue Reader Agent for each distribution database.</span></span> <span data-ttu-id="55bee-206">變更此代理程式的安全性設定時，會影響使用此散發資料庫之所有發行者上的所有發行集設定。</span><span class="sxs-lookup"><span data-stu-id="55bee-206">Changing the security settings for the agent affects the settings for all publications at all Publishers that use this distribution database.</span></span>  
  
#### <a name="to-change-the-context-under-which-the-queue-reader-agent-makes-connections-to-the-publisher"></a><span data-ttu-id="55bee-207">若要變更佇列讀取器代理程式連接到發行者所使用的內容</span><span class="sxs-lookup"><span data-stu-id="55bee-207">To change the context under which the Queue Reader Agent makes connections to the Publisher</span></span>  
  
1.  <span data-ttu-id="55bee-208">在 [散發者屬性 - \<Distributor>] 對話方塊的 [發行者] 頁面上，按一下發行者旁的屬性按鈕 ( **...** )。</span><span class="sxs-lookup"><span data-stu-id="55bee-208">On the **Publishers** page of the **Distributor Properties - \<Distributor>** dialog box, click the properties button (**...**) next to the Publisher.</span></span>  
  
2.  <span data-ttu-id="55bee-209">在 **[代理程式至發行者的連接 ]** 區段，指定 **[代理程式連接模式]** 選項中 **[模擬代理程式處理帳戶]** 或 **[SQL Server 驗證]** 的值。</span><span class="sxs-lookup"><span data-stu-id="55bee-209">In the **Agent Connection to the Publisher** section, specify a value of **Impersonate the agent process account** or **SQL Server Authentication** for the **Agent Connection Mode** option.</span></span> <span data-ttu-id="55bee-210">如果指定 **[SQL Server 驗證]** ，還要輸入 **[登入]** 與 **[密碼]** 的值。</span><span class="sxs-lookup"><span data-stu-id="55bee-210">If you specify **SQL Server Authentication**, also enter values for **Login** and **Password**.</span></span>  
  
3.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
    > [!NOTE]  
    >  <span data-ttu-id="55bee-211">每個散發資料庫都會有一個佇列讀取器代理程式。</span><span class="sxs-lookup"><span data-stu-id="55bee-211">There is one Queue Reader Agent for each distribution database.</span></span> <span data-ttu-id="55bee-212">變更此代理程式的安全性設定時，會影響使用此散發資料庫之所有發行者上的所有發行集設定。</span><span class="sxs-lookup"><span data-stu-id="55bee-212">Changing the security settings for the agent affects the settings for all publications at all Publishers that use this distribution database.</span></span>  
  
#### <a name="to-change-the-context-under-which-the-queue-reader-agent-makes-connections-to-the-subscriber"></a><span data-ttu-id="55bee-213">若要變更佇列讀取器代理程式連接到訂閱者所使用的內容</span><span class="sxs-lookup"><span data-stu-id="55bee-213">To change the context under which the Queue Reader Agent makes connections to the Subscriber</span></span>  
  
-   <span data-ttu-id="55bee-214">「佇列讀取器代理程式」使用與「散發代理程式」相同的連接內容進行訂閱。</span><span class="sxs-lookup"><span data-stu-id="55bee-214">The Queue Reader Agent uses the same connection context as the Distribution Agent for the subscription.</span></span> <span data-ttu-id="55bee-215">如需詳細資訊，請參閱「散發代理程式」的上述程序。</span><span class="sxs-lookup"><span data-stu-id="55bee-215">For more information, see the procedures above for the Distribution Agent.</span></span>  
  
#### <a name="to-change-security-settings-for-an-immediate-updating-pull-subscription"></a><span data-ttu-id="55bee-216">若要變更立即更新提取訂閱的安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-216">To change security settings for an immediate updating pull subscription</span></span>  
  
1.  <span data-ttu-id="55bee-217">在訂閱者**端的 \<Subscription> [訂閱屬性-** ] 對話方塊中，按一下 [**發行者連接**] 資料列，然後按一下資料列中的屬性 (**...**) ] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="55bee-217">In the **Subscription Properties - \<Subscription>** dialog box at the Subscriber, click the **Publisher Connection** row, and then click the properties (**...**) button in the row.</span></span>  
  
2.  <span data-ttu-id="55bee-218">在 **[輸入連接資訊]** 對話方塊中，選取下列其中一個選項：</span><span class="sxs-lookup"><span data-stu-id="55bee-218">In the **Enter Connection Information** dialog box, select one of the following options:</span></span>  
  
    -   <span data-ttu-id="55bee-219">**[使用連結伺服器或遠端伺服器的登入]** 。</span><span class="sxs-lookup"><span data-stu-id="55bee-219">**Use a login from a linked or remote server**.</span></span> <span data-ttu-id="55bee-220">若您已透過 [sp_addserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addserver-transact-sql)、[sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql)、[!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] 或其他方法定義遠端伺服器或訂閱者與發行者之間連結的伺服器，請選取此選項。</span><span class="sxs-lookup"><span data-stu-id="55bee-220">Select this option if you have defined a remote server or linked server between the Subscriber and the Publisher using [sp_addserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addserver-transact-sql), [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql), [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], or another method.</span></span>  
  
    -   <span data-ttu-id="55bee-221">**[利用下列登入和密碼來使用 SQL Server 驗證]** 。</span><span class="sxs-lookup"><span data-stu-id="55bee-221">**Use SQL Server Authentication with the following login and password**.</span></span> <span data-ttu-id="55bee-222">若您已透過尚未定義遠端伺服器或訂閱者與發行者之間連結的伺服器，請選取此選項。</span><span class="sxs-lookup"><span data-stu-id="55bee-222">Select this option if you have not defined a remote server or linked server between the Subscriber and the Publisher.</span></span> <span data-ttu-id="55bee-223">複寫將為您建立連結的伺服器。</span><span class="sxs-lookup"><span data-stu-id="55bee-223">Replication will create a linked server for you.</span></span> <span data-ttu-id="55bee-224">您必須指定已存在於發行者的帳戶。</span><span class="sxs-lookup"><span data-stu-id="55bee-224">The account you specify must already exist at the Publisher.</span></span>  
  
3.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
> [!NOTE]  
>  <span data-ttu-id="55bee-225">此程序會變更複寫觸發程序在「訂閱者」端發生變更時，用來從「訂閱者」連接到「發行者」的方法。</span><span class="sxs-lookup"><span data-stu-id="55bee-225">This procedure changes the method that replication triggers use to connect from the Subscriber to the Publisher when changes are made at the Subscriber.</span></span> <span data-ttu-id="55bee-226">您也可以變更立即更新訂閱之與「散發代理程式」相關的設定。</span><span class="sxs-lookup"><span data-stu-id="55bee-226">You can also change settings associated with the Distribution Agent for an immediate updating subscription.</span></span> <span data-ttu-id="55bee-227">如需詳細資訊，請參閱本主題前文中的程序。</span><span class="sxs-lookup"><span data-stu-id="55bee-227">For more information, see the procedures earlier in this topic.</span></span>  
>   
>  <span data-ttu-id="55bee-228">此程序僅適用於提取訂閱。</span><span class="sxs-lookup"><span data-stu-id="55bee-228">This procedure applies only to pull subscriptions.</span></span> <span data-ttu-id="55bee-229">對於發送訂閱，請使用 [sp_link_publication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) 預存程序。</span><span class="sxs-lookup"><span data-stu-id="55bee-229">For push subscriptions, use the stored procedure [sp_link_publication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql).</span></span>  
  
#### <a name="to-change-the-password-for-the-administrative-connection-from-the-publisher-to-the-distributor"></a><span data-ttu-id="55bee-230">變更從發行者到散發者之管理連接的密碼</span><span class="sxs-lookup"><span data-stu-id="55bee-230">To change the password for the administrative connection from the Publisher to the Distributor</span></span>  
  
1.  <span data-ttu-id="55bee-231">在 [散發者屬性 - \<Distributor>] 對話方塊的 [發行者] 頁面上，在 [密碼] 與 [確認密碼] 文字方塊中輸入強式密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-231">On the **Publishers** page of the **Distributor Properties - \<Distributor>** dialog box, enter a strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
3.  <span data-ttu-id="55bee-232">在 [發行者屬性 - \<Publisher>] 對話方塊的 [一般] 頁面上，於 [密碼] 與 [確認密碼] 文字方塊中輸入強式密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-232">On the **General** page of the **Publisher Properties - \<Publisher>** dialog box, enter a strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="55bee-233">使用 Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="55bee-233">Using Transact-SQL</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="55bee-234">在下列所有的程序中，會在可能的情況下，於執行階段提示使用者輸入安全性認證。</span><span class="sxs-lookup"><span data-stu-id="55bee-234">In all of the following procedures, when possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="55bee-235">如果您將認證儲存在指令碼檔案中，必須保護該檔案免於未經授權的存取。</span><span class="sxs-lookup"><span data-stu-id="55bee-235">If you store credentials in a script file, you must secure the file to prevent unauthorized access.</span></span>  
  
#### <a name="to-change-all-instances-of-a-stored-password-at-a-replication-server"></a><span data-ttu-id="55bee-236">變更複寫伺服器上儲存的所有密碼執行個體</span><span class="sxs-lookup"><span data-stu-id="55bee-236">To change all instances of a stored password at a replication server</span></span>  
  
1.  <span data-ttu-id="55bee-237">在 master 資料庫複寫拓撲中的伺服器上，執行 [sp_changereplicationserverpasswords](/sql/relational-databases/system-stored-procedures/sp-changereplicationserverpasswords-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="55bee-237">At a server in a replication topology on the master database, execute [sp_changereplicationserverpasswords](/sql/relational-databases/system-stored-procedures/sp-changereplicationserverpasswords-transact-sql).</span></span> <span data-ttu-id="55bee-238">指定 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 要變更其密碼的 Windows 帳戶或登入， \*\* \@ **以及帳戶的新密碼或** \@ 密碼\*\*登入。</span><span class="sxs-lookup"><span data-stu-id="55bee-238">Specify the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows account or [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login whose password is being changed for **\@login** and new password for the account or login for **\@password**.</span></span> <span data-ttu-id="55bee-239">這樣會變更當連接到拓撲中的其他伺服器時，由此伺服器上的所有代理程式所使用的每一個密碼執行個體。</span><span class="sxs-lookup"><span data-stu-id="55bee-239">This changes every instance of the password used by all agents on the server when connecting to other servers in the topology.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="55bee-240">若只要變更拓撲中特定伺服器連接的登入和密碼 (例如「散發者」或「訂閱者」) ，請為\*\* \@ 伺服器\*\*指定此伺服器的名稱。</span><span class="sxs-lookup"><span data-stu-id="55bee-240">To only change the login and password for a connection to a particular server in the topology (such as the Distributor or Subscriber), specify this server's name for **\@server**.</span></span>  
  
2.  <span data-ttu-id="55bee-241">在必須更新密碼的複寫拓撲中，於每一部伺服器上重複步驟 1。</span><span class="sxs-lookup"><span data-stu-id="55bee-241">Repeat step 1 at every server in the replication topology where the password must be updated.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="55bee-242">在變更複寫密碼之後，必須停止並重新啟動使用該代理程式變更生效前所用密碼的每一個代理程式。</span><span class="sxs-lookup"><span data-stu-id="55bee-242">After changing a replication password, you must stop and restart each agent that uses the password before the change takes effect for that agent.</span></span>  
  
#### <a name="to-change-security-settings-for-the-snapshot-agent"></a><span data-ttu-id="55bee-243">變更快照集代理程式的安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-243">To change security settings for the Snapshot Agent</span></span>  
  
1.  <span data-ttu-id="55bee-244">在發行者上，執行[sp_helppublication_snapshot](/sql/relational-databases/system-stored-procedures/sp-helppublication-snapshot-transact-sql)，並指定\*\* \@ 發行\*\*集。</span><span class="sxs-lookup"><span data-stu-id="55bee-244">At the Publisher, execute [sp_helppublication_snapshot](/sql/relational-databases/system-stored-procedures/sp-helppublication-snapshot-transact-sql), specifying **\@publication**.</span></span> <span data-ttu-id="55bee-245">這樣會傳回快照集代理程式目前的安全性設定。</span><span class="sxs-lookup"><span data-stu-id="55bee-245">This returns the current security settings for the Snapshot Agent.</span></span>  
  
2.  <span data-ttu-id="55bee-246">在發行者上，執行[sp_changepublication_snapshot](/sql/relational-databases/system-stored-procedures/sp-changepublication-snapshot-transact-sql)，指定\*\* \@ 發行\*\*集，以及下列一或多個要變更的安全性設定：</span><span class="sxs-lookup"><span data-stu-id="55bee-246">At the Publisher, execute [sp_changepublication_snapshot](/sql/relational-databases/system-stored-procedures/sp-changepublication-snapshot-transact-sql), specifying **\@publication** and one or more of the following security settings to change:</span></span>  
  
    -   <span data-ttu-id="55bee-247">若要變更代理程式執行時所用的 Windows 帳戶，或只是此帳戶的密碼，請指定\*\* \@ job_login**和** \@ job_password\*\*。</span><span class="sxs-lookup"><span data-stu-id="55bee-247">To change the Windows account under which the agent runs or just password for this account, specify **\@job_login** and **\@job_password**.</span></span>  
  
    -   <span data-ttu-id="55bee-248">若要變更連接到發行者時所使用的安全性模式，請為\*\* \@ publisher_security_mode**指定**1**或**0\*\*的值。</span><span class="sxs-lookup"><span data-stu-id="55bee-248">To change the security mode used when connecting to the Publisher, specify a value of **1** or **0** for **\@publisher_security_mode**.</span></span>  
  
    -   <span data-ttu-id="55bee-249">當您將連接到發行者時所使用的安全性模式從**1**變更為**0**時，或在變更 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 用於此連接的登入時，請指定\*\* \@ publisher_login**和** \@ publisher_password\*\*。</span><span class="sxs-lookup"><span data-stu-id="55bee-249">When changing the security mode used when connecting to the Publisher from **1** to **0** or when changing a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login used for this connection, specify **\@publisher_login** and **\@publisher_password**.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="55bee-250">當利用遠端散發者來設定發行者時，提供給所有參數的值 (包括 *job_login* 和 *job_password*) 都會以純文字的方式傳給散發者。</span><span class="sxs-lookup"><span data-stu-id="55bee-250">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="55bee-251">您應該先加密「發行者」及其遠端「散發者」之間的連接，再執行這個預存程序。</span><span class="sxs-lookup"><span data-stu-id="55bee-251">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="55bee-252">如需詳細資訊，請參閱[啟用 Database Engine 的加密連接 &#40;SQL Server 組態管理員&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)。</span><span class="sxs-lookup"><span data-stu-id="55bee-252">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-change-security-settings-for-the-log-reader-agent"></a><span data-ttu-id="55bee-253">變更記錄讀取器代理程式的安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-253">To change security settings for the Log Reader Agent</span></span>  
  
1.  <span data-ttu-id="55bee-254">在發行者上，執行[sp_helplogreader_agent](/sql/relational-databases/system-stored-procedures/sp-helplogreader-agent-transact-sql)，並指定\*\* \@ Publisher\*\*。</span><span class="sxs-lookup"><span data-stu-id="55bee-254">At the Publisher, execute [sp_helplogreader_agent](/sql/relational-databases/system-stored-procedures/sp-helplogreader-agent-transact-sql), specifying **\@publisher**.</span></span> <span data-ttu-id="55bee-255">這樣會傳回記錄讀取器代理程式目前的安全性設定。</span><span class="sxs-lookup"><span data-stu-id="55bee-255">This returns the current security settings for the Log Reader Agent.</span></span>  
  
2.  <span data-ttu-id="55bee-256">在發行者上，執行[sp_changelogreader_agent](/sql/relational-databases/system-stored-procedures/sp-changelogreader-agent-transact-sql)，指定\*\* \@ 發行\*\*集，以及下列一或多個要變更的安全性設定：</span><span class="sxs-lookup"><span data-stu-id="55bee-256">At the Publisher, execute [sp_changelogreader_agent](/sql/relational-databases/system-stored-procedures/sp-changelogreader-agent-transact-sql), specifying **\@publication** and one or more of the following security settings to change:</span></span>  
  
    -   <span data-ttu-id="55bee-257">若要變更代理程式執行時所用的 Windows 帳戶，或只是此帳戶的密碼，請指定\*\* \@ job_login**和** \@ job_password\*\*。</span><span class="sxs-lookup"><span data-stu-id="55bee-257">To change the Windows account under which the agent runs or just password for this account, specify **\@job_login** and **\@job_password**.</span></span>  
  
    -   <span data-ttu-id="55bee-258">若要變更連接到發行者時所使用的安全性模式，請為\*\* \@ publisher_security_mode**指定**1**或**0\*\*的值。</span><span class="sxs-lookup"><span data-stu-id="55bee-258">To change the security mode used when connecting to the Publisher, specify a value of **1** or **0** for **\@publisher_security_mode**.</span></span>  
  
    -   <span data-ttu-id="55bee-259">當您將連接到發行者時所使用的安全性模式從**1**變更為**0**時，或在變更 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 用於此連接的登入時，請指定\*\* \@ publisher_login**和** \@ publisher_password\*\*。</span><span class="sxs-lookup"><span data-stu-id="55bee-259">When changing the security mode used when connecting to the Publisher from **1** to **0** or when changing a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login used for this connection, specify **\@publisher_login** and **\@publisher_password**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="55bee-260">變更代理程式的登入或密碼之後，您必須先停止並重新啟動代理程式，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="55bee-260">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="55bee-261">當利用遠端散發者來設定發行者時，提供給所有參數的值 (包括 *job_login* 和 *job_password*) 都會以純文字的方式傳給散發者。</span><span class="sxs-lookup"><span data-stu-id="55bee-261">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="55bee-262">您應該先加密「發行者」及其遠端「散發者」之間的連接，再執行這個預存程序。</span><span class="sxs-lookup"><span data-stu-id="55bee-262">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="55bee-263">如需詳細資訊，請參閱[啟用 Database Engine 的加密連接 &#40;SQL Server 組態管理員&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)。</span><span class="sxs-lookup"><span data-stu-id="55bee-263">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-change-security-settings-for-the-distribution-agent-for-a-push-subscription"></a><span data-ttu-id="55bee-264">變更發送訂閱之散發代理程式的安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-264">To change security settings for the Distribution Agent for a push subscription</span></span>  
  
1.  <span data-ttu-id="55bee-265">在發行集資料庫的發行者上，執行[sp_helpsubscription](/sql/relational-databases/system-stored-procedures/sp-helpsubscription-transact-sql)，並指定\*\* \@ 發行**集和** \@ 訂閱者\*\*。</span><span class="sxs-lookup"><span data-stu-id="55bee-265">At the Publisher on the publication database, execute [sp_helpsubscription](/sql/relational-databases/system-stored-procedures/sp-helpsubscription-transact-sql), specifying **\@publication** and **\@subscriber**.</span></span> <span data-ttu-id="55bee-266">這樣會傳回訂閱屬性，包括在散發者上執行之散發代理程式的安全性設定。</span><span class="sxs-lookup"><span data-stu-id="55bee-266">This returns subscription properties, including security settings for the Distribution Agent running at the Distributor.</span></span>  
  
2.  <span data-ttu-id="55bee-267">在發行集資料庫的發行者上，執行[sp_changesubscription](/sql/relational-databases/system-stored-procedures/sp-changesubscription-transact-sql)、指定\*\* \@ 發行**集、 \*\* \@ 訂閱者**、 \*\* \@ subscriber_db**、發行項的**所有**值、 \*\* \@ 屬性**的安全性屬性名稱，以及\*\* \@ value\*\*的屬性新值。 \*\* \@ \*\*</span><span class="sxs-lookup"><span data-stu-id="55bee-267">At the Publisher on the publication database, execute [sp_changesubscription](/sql/relational-databases/system-stored-procedures/sp-changesubscription-transact-sql), specifying **\@publication**, **\@subscriber**, **\@subscriber_db**, a value of **all** for **\@article**, the name of the security property for **\@property**, and the new value of the property for **\@value**.</span></span>  
  
3.  <span data-ttu-id="55bee-268">針對以下變更的每一個安全性屬性重複步驟 2：</span><span class="sxs-lookup"><span data-stu-id="55bee-268">Repeat step 2 for each of the following security properties being changed:</span></span>  
  
    -   <span data-ttu-id="55bee-269">若要變更代理程式執行時所使用的 Windows 帳戶，或只是此帳戶的密碼，請為 [ \*\* \@ 屬性**] 指定 [ **distrib_job_password** ] 的值，並為 [ \*\* \@ 值**] 指定新的 [密碼]。</span><span class="sxs-lookup"><span data-stu-id="55bee-269">To change the Windows account under which the agent runs or just the password for this account, specify a value of **distrib_job_password** for **\@property** and a new password for **\@value**.</span></span> <span data-ttu-id="55bee-270">變更帳戶本身時，請重複步驟2，針對 [ \*\* \@ 屬性**] 指定 [ **distrib_job_login** ] 的值，然後針對 [ \*\* \@ 值**] 輸入新的 Windows 帳戶。</span><span class="sxs-lookup"><span data-stu-id="55bee-270">When changing the account itself, repeat step 2 specifying a value of **distrib_job_login** for **\@property** and the new Windows account for **\@value**.</span></span>  
  
    -   <span data-ttu-id="55bee-271">若要變更連接到訂閱者時所使用的安全性模式，請針對 [ \*\* \@ 屬性**] 指定 [ **subscriber_security_mode** ] 的值，並為 [ **1** ] ([Windows 整合式驗證]) 或**0\*\* (SQL Server 驗證]) [ \*\* \@ 值\*\*]。</span><span class="sxs-lookup"><span data-stu-id="55bee-271">To change the security mode used when connecting to the Subscriber, specify a value of **subscriber_security_mode** for **\@property** and a value of **1** (Windows Integrated Authentication) or **0** (SQL Server Authentication) for **\@value**.</span></span>  
  
    -   <span data-ttu-id="55bee-272">將訂閱者安全性模式變更為 SQL Server 驗證，或變更 SQL Server Authentication 的登入資訊時，請為 [ \*\* \@ 屬性**] 指定 [ **subscriber_password** ] 的值，並針對 [ \*\* \@ 值**] 指定新的密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-272">When changing the Subscriber security mode to SQL Server Authentication, or if changing login information for SQL Server Authentication, specify a value of **subscriber_password** for **\@property** and the new password for **\@value**.</span></span> <span data-ttu-id="55bee-273">重複步驟2，針對 [ \*\* \@ 屬性**] 指定**subscriber_login**的值，並為 [ \*\* \@ 值**] 指定新的登入。</span><span class="sxs-lookup"><span data-stu-id="55bee-273">Repeat step 2, specifying a value of **subscriber_login** for **\@property** and the new login for **\@value**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="55bee-274">變更代理程式的登入或密碼之後，您必須先停止並重新啟動代理程式，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="55bee-274">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="55bee-275">當利用遠端散發者來設定發行者時，提供給所有屬性的值 (包括 **distrib_job_login** 和 **distrib_job_password**) 都會以純文字的方式傳給散發者。</span><span class="sxs-lookup"><span data-stu-id="55bee-275">When configuring a Publisher with a remote Distributor, the values supplied for all properties, including **distrib_job_login** and **distrib_job_password**, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="55bee-276">您應該先加密「發行者」及其遠端「散發者」之間的連接，再執行這個預存程序。</span><span class="sxs-lookup"><span data-stu-id="55bee-276">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="55bee-277">如需詳細資訊，請參閱[啟用 Database Engine 的加密連接 &#40;SQL Server 組態管理員&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)。</span><span class="sxs-lookup"><span data-stu-id="55bee-277">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-change-security-settings-for-the-distribution-agent-for-a-pull-subscription"></a><span data-ttu-id="55bee-278">變更提取訂閱之散發代理程式的安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-278">To change security settings for the Distribution Agent for a pull subscription</span></span>  
  
1.  <span data-ttu-id="55bee-279">在訂閱者上，執行[sp_helppullsubscription](/sql/relational-databases/system-stored-procedures/sp-helppullsubscription-transact-sql)，並指定\*\* \@ 發行\*\*集。</span><span class="sxs-lookup"><span data-stu-id="55bee-279">At the Subscriber, execute [sp_helppullsubscription](/sql/relational-databases/system-stored-procedures/sp-helppullsubscription-transact-sql), specifying **\@publication**.</span></span> <span data-ttu-id="55bee-280">這樣會傳回訂閱屬性，包括在訂閱者上執行之散發代理程式的安全性設定。</span><span class="sxs-lookup"><span data-stu-id="55bee-280">This returns subscription properties, including security settings for the Distribution Agent running at the Subscriber.</span></span>  
  
2.  <span data-ttu-id="55bee-281">在訂閱資料庫的訂閱者上，執行[sp_change_subscription_properties](/sql/relational-databases/system-stored-procedures/sp-change-subscription-properties-transact-sql)、指定\*\* \@ 發行者**、 \*\* \@ publisher_db**、 \*\* \@ 發行**集、 \*\* \@ 屬性**的安全性屬性名稱，以及\*\* \@ value\*\*的屬性新值。</span><span class="sxs-lookup"><span data-stu-id="55bee-281">At the Subscriber on the subscription database, execute [sp_change_subscription_properties](/sql/relational-databases/system-stored-procedures/sp-change-subscription-properties-transact-sql), specifying **\@publisher**, **\@publisher_db**, **\@publication**, the name of the security property for **\@property**, and the new value of the property for **\@value**.</span></span>  
  
3.  <span data-ttu-id="55bee-282">針對以下變更的每一個安全性屬性重複步驟 2：</span><span class="sxs-lookup"><span data-stu-id="55bee-282">Repeat step 2 for each of the following security properties being changed:</span></span>  
  
    -   <span data-ttu-id="55bee-283">若要變更代理程式執行時所使用的 Windows 帳戶，或只是此帳戶的密碼，請為 [ \*\* \@ 屬性**] 指定 [ **distrib_job_password** ] 的值，並為 [ \*\* \@ 值**] 指定新的 [密碼]。</span><span class="sxs-lookup"><span data-stu-id="55bee-283">To change the Windows account under which the agent runs or just the password for this account, specify a value of **distrib_job_password** for **\@property** and a new password for **\@value**.</span></span> <span data-ttu-id="55bee-284">變更帳戶本身時，請重複步驟2，針對 [ \*\* \@ 屬性**] 指定 [ **distrib_job_login** ] 的值，然後針對 [ \*\* \@ 值**] 輸入新的 Windows 帳戶。</span><span class="sxs-lookup"><span data-stu-id="55bee-284">When changing the account itself, repeat step 2 specifying a value of **distrib_job_login** for **\@property** and the new Windows account for **\@value**.</span></span>  
  
    -   <span data-ttu-id="55bee-285">若要變更連接到散發者時所使用的安全性模式，請針對 [ \*\* \@ 屬性**] 指定 [ **distributor_security_mode** ] 的值，並為 [ **1** ] ([Windows 整合式驗證]) 或**0\*\* (SQL Server 驗證]) [ \*\* \@ 值\*\*]。</span><span class="sxs-lookup"><span data-stu-id="55bee-285">To change the security mode used when connecting to the Distributor, specify a value of **distributor_security_mode** for **\@property** and a value of **1** (Windows Integrated Authentication) or **0** (SQL Server Authentication) for **\@value**.</span></span>  
  
    -   <span data-ttu-id="55bee-286">將散發者的安全性模式變更為 SQL Server 驗證，或是變更 SQL Server 驗證的登入資訊時，請為 [ \*\* \@ 屬性**] 指定 [ **distributor_password** ]，並針對 [ \*\* \@ 值**] 指定新的密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-286">When changing the Distributor security mode to SQL Server Authentication or if changing login information for SQL Server Authentication, specify a value of **distributor_password** for **\@property** and the new password for **\@value**.</span></span> <span data-ttu-id="55bee-287">重複步驟2，針對 [ \*\* \@ 屬性**] 指定**distributor_login**的值，並為 [ \*\* \@ 值**] 指定新的登入。</span><span class="sxs-lookup"><span data-stu-id="55bee-287">Repeat step 2, specifying a value of **distributor_login** for **\@property** and the new login for **\@value**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="55bee-288">變更代理程式的登入或密碼之後，您必須先停止並重新啟動代理程式，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="55bee-288">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span>  
  
#### <a name="to-change-security-settings-for-the-merge-agent-for-a-push-subscription"></a><span data-ttu-id="55bee-289">變更發送訂閱之合併代理程式的安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-289">To change security settings for the Merge Agent for a push subscription</span></span>  
  
1.  <span data-ttu-id="55bee-290">在發行集資料庫的發行者上，執行[sp_helpmergesubscription](/sql/relational-databases/system-stored-procedures/sp-helpmergesubscription-transact-sql)，並指定\*\* \@ 發行**集、 \*\* \@ 訂閱者**和\*\* \@ subscriber_db\*\*。</span><span class="sxs-lookup"><span data-stu-id="55bee-290">At the Publisher on the publication database, execute [sp_helpmergesubscription](/sql/relational-databases/system-stored-procedures/sp-helpmergesubscription-transact-sql), specifying **\@publication**, **\@subscriber**, and **\@subscriber_db**.</span></span> <span data-ttu-id="55bee-291">這樣會傳回訂閱屬性，包括在散發者上執行之合併代理程式的安全性設定。</span><span class="sxs-lookup"><span data-stu-id="55bee-291">This returns subscription properties, including security settings for the Merge Agent running at the Distributor.</span></span>  
  
2.  <span data-ttu-id="55bee-292">在發行集資料庫的發行者上，執行[sp_changemergesubscription](/sql/relational-databases/system-stored-procedures/sp-changemergesubscription-transact-sql)、指定\*\* \@ 發行**集、 \*\* \@ 訂閱者**、 \*\* \@ subscriber_db**、 \*\* \@ 屬性**的安全性屬性名稱，以及\*\* \@ value\*\*的屬性新值。</span><span class="sxs-lookup"><span data-stu-id="55bee-292">At the Publisher on the publication database, execute [sp_changemergesubscription](/sql/relational-databases/system-stored-procedures/sp-changemergesubscription-transact-sql), specifying **\@publication**, **\@subscriber**, **\@subscriber_db**, the name of the security property for **\@property**, and the new value of the property for **\@value**.</span></span>  
  
3.  <span data-ttu-id="55bee-293">針對以下變更的每一個安全性屬性重複步驟 2：</span><span class="sxs-lookup"><span data-stu-id="55bee-293">Repeat step 2 for each of the following security properties being changed:</span></span>  
  
    -   <span data-ttu-id="55bee-294">若要變更代理程式執行時所使用的 Windows 帳戶，或只是此帳戶的密碼，請針對 [ \*\* \@ 屬性**] 指定 [ **merge_job_password** ] 的值，並針對 [ \*\* \@ 值**] 指定新的 [密碼]。</span><span class="sxs-lookup"><span data-stu-id="55bee-294">To change the Windows account under which the agent runs, or just the password for this account, specify a value of **merge_job_password** for **\@property** and a new password for **\@value**.</span></span> <span data-ttu-id="55bee-295">變更帳戶本身時，請重複步驟2，針對 [ \*\* \@ 屬性**] 指定 [ **merge_job_login** ] 的值，然後針對 [ \*\* \@ 值**] 輸入新的 Windows 帳戶。</span><span class="sxs-lookup"><span data-stu-id="55bee-295">When changing the account itself, repeat step 2 specifying a value of **merge_job_login** for **\@property** and the new Windows account for **\@value**.</span></span>  
  
    -   <span data-ttu-id="55bee-296">若要變更連接到訂閱者時所使用的安全性模式，請針對 [ \*\* \@ 屬性**] 指定 [ **subscriber_security_mode** ] 的值，並為 [ **1** ] ([Windows 整合式驗證]) 或**0\*\* (SQL Server 驗證]) [ \*\* \@ 值\*\*]。</span><span class="sxs-lookup"><span data-stu-id="55bee-296">To change the security mode used when connecting to the Subscriber, specify a value of **subscriber_security_mode** for **\@property** and a value of **1** (Windows Integrated Authentication) or **0** (SQL Server Authentication) for **\@value**.</span></span>  
  
    -   <span data-ttu-id="55bee-297">將訂閱者安全性模式變更為 SQL Server 驗證，或變更 SQL Server Authentication 的登入資訊時，請為 [ \*\* \@ 屬性**] 指定 [ **subscriber_password** ] 的值，並針對 [ \*\* \@ 值**] 指定新的密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-297">When changing the Subscriber security mode to SQL Server Authentication, or if changing login information for SQL Server Authentication, specify a value of **subscriber_password** for **\@property** and the new password for **\@value**.</span></span> <span data-ttu-id="55bee-298">重複步驟2，針對 [ \*\* \@ 屬性**] 指定**subscriber_login**的值，並為 [ \*\* \@ 值**] 指定新的登入。</span><span class="sxs-lookup"><span data-stu-id="55bee-298">Repeat step 2, specifying a value of **subscriber_login** for **\@property** and the new login for **\@value**.</span></span>  
  
    -   <span data-ttu-id="55bee-299">若要變更連接到發行者時所使用的安全性模式，請為 [ \*\* \@ 屬性**] 指定 [ **publisher_security_mode** ] 的值，並為 [ **1** ] ([Windows 整合式驗證]) 或**0\*\* (SQL Server 驗證) ] \*\* \@ 值\*\*。</span><span class="sxs-lookup"><span data-stu-id="55bee-299">To change the security mode used when connecting to the Publisher, specify a value of **publisher_security_mode** for **\@property** and a value of **1** (Windows Integrated Authentication) or **0** (SQL Server Authentication) for **\@value**.</span></span>  
  
    -   <span data-ttu-id="55bee-300">將發行者安全性模式變更為 SQL Server 驗證，或變更 SQL Server Authentication 的登入資訊時，請為 [ \*\* \@ 屬性**] 指定 [ **publisher_password** ] 的值，並針對 [ \*\* \@ 值**] 指定新的密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-300">When changing the Publisher security mode to SQL Server Authentication, or if changing login information for SQL Server Authentication, specify a value of **publisher_password** for **\@property** and the new password for **\@value**.</span></span> <span data-ttu-id="55bee-301">重複步驟2，針對 [ \*\* \@ 屬性**] 指定**publisher_login**的值，並為 [ \*\* \@ 值**] 指定新的登入。</span><span class="sxs-lookup"><span data-stu-id="55bee-301">Repeat step 2, specifying a value of **publisher_login** for **\@property** and the new login for **\@value**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="55bee-302">變更代理程式的登入或密碼之後，您必須先停止並重新啟動代理程式，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="55bee-302">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="55bee-303">當利用遠端散發者來設定發行者時，提供給所有屬性的值 (包括 **merge_job_login** 和 **merge_job_password**) 都會以純文字的方式傳給散發者。</span><span class="sxs-lookup"><span data-stu-id="55bee-303">When configuring a Publisher with a remote Distributor, the values supplied for all properties, including **merge_job_login** and **merge_job_password**, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="55bee-304">您應該先加密「發行者」及其遠端「散發者」之間的連接，再執行這個預存程序。</span><span class="sxs-lookup"><span data-stu-id="55bee-304">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="55bee-305">如需詳細資訊，請參閱[啟用 Database Engine 的加密連接 &#40;SQL Server 組態管理員&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)。</span><span class="sxs-lookup"><span data-stu-id="55bee-305">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-change-security-settings-for-the-merge-agent-for-a-pull-subscription"></a><span data-ttu-id="55bee-306">變更提取訂閱之合併代理程式的安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-306">To change security settings for the Merge Agent for a pull subscription</span></span>  
  
1.  <span data-ttu-id="55bee-307">在訂閱者上，執行[sp_helpmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-helpmergepullsubscription-transact-sql)，並指定\*\* \@ 發行\*\*集。</span><span class="sxs-lookup"><span data-stu-id="55bee-307">At the Subscriber, execute [sp_helpmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-helpmergepullsubscription-transact-sql), specifying **\@publication**.</span></span> <span data-ttu-id="55bee-308">這樣會傳回訂閱屬性，包括在訂閱者上執行之合併代理程式的安全性設定。</span><span class="sxs-lookup"><span data-stu-id="55bee-308">This returns subscription properties, including security settings for the Merge Agent running at the Subscriber.</span></span>  
  
2.  <span data-ttu-id="55bee-309">在訂閱資料庫的訂閱者上，執行[sp_change_subscription_properties](/sql/relational-databases/system-stored-procedures/sp-change-subscription-properties-transact-sql)、指定\*\* \@ 發行者**、 \*\* \@ publisher_db**、 \*\* \@ 發行**集、 \*\* \@ 屬性**的安全性屬性名稱，以及\*\* \@ value\*\*的屬性新值。</span><span class="sxs-lookup"><span data-stu-id="55bee-309">At the Subscriber on the subscription database, execute [sp_change_subscription_properties](/sql/relational-databases/system-stored-procedures/sp-change-subscription-properties-transact-sql), specifying **\@publisher**, **\@publisher_db**, **\@publication**, the name of the security property for **\@property**, and the new value of the property for **\@value**.</span></span>  
  
3.  <span data-ttu-id="55bee-310">針對以下變更的每一個安全性屬性重複步驟 2：</span><span class="sxs-lookup"><span data-stu-id="55bee-310">Repeat step 2 for each of the following security properties being changed:</span></span>  
  
    -   <span data-ttu-id="55bee-311">若要變更代理程式執行時所使用的 Windows 帳戶，或只是此帳戶的密碼，請針對 [ \*\* \@ 屬性**] 和 [新密碼] 指定值的 [ **merge_job_password** \*\* \@ ]。**</span><span class="sxs-lookup"><span data-stu-id="55bee-311">To change the Windows account under which the agent runs or just the password for this account, specify a value of **merge_job_password** for **\@property** and new password for **\@value**.</span></span> <span data-ttu-id="55bee-312">變更帳戶本身時，請重複步驟2，針對 [ \*\* \@ 屬性**] 指定 [ **merge_job_login** ] 的值，然後針對 [ \*\* \@ 值**] 輸入新的 Windows 帳戶。</span><span class="sxs-lookup"><span data-stu-id="55bee-312">When changing the account itself, repeat Step 2 specifying a value of **merge_job_login** for **\@property** and the new Windows account for **\@value**.</span></span>  
  
    -   <span data-ttu-id="55bee-313">若要變更連接到散發者時所使用的安全性模式，請針對 [ \*\* \@ 屬性**] 指定 [ **distributor_security_mode** ] 的值，並為 [ **1** ] ([Windows 整合式驗證]) 或**0\*\* (SQL Server 驗證]) [ \*\* \@ 值\*\*]。</span><span class="sxs-lookup"><span data-stu-id="55bee-313">To change the security mode used when connecting to the Distributor, specify a value of **distributor_security_mode** for **\@property** and a value of **1** (Windows Integrated Authentication) or **0** (SQL Server Authentication) for **\@value**.</span></span>  
  
    -   <span data-ttu-id="55bee-314">將散發者的安全性模式變更為 SQL Server 驗證，或是變更 SQL Server 驗證的登入資訊時，請為 [ \*\* \@ 屬性**] 指定 [ **distributor_password** ]，並針對 [ \*\* \@ 值**] 指定新的密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-314">When changing the Distributor security mode to SQL Server Authentication or if changing login information for SQL Server Authentication, specify a value of **distributor_password** for **\@property** and the new password for **\@value**.</span></span> <span data-ttu-id="55bee-315">重複步驟2，針對 [ \*\* \@ 屬性**] 指定**distributor_login**的值，並為 [ \*\* \@ 值**] 指定新的登入。</span><span class="sxs-lookup"><span data-stu-id="55bee-315">Repeat step 2, specifying a value of **distributor_login** for **\@property** and the new login for **\@value**.</span></span>  
  
    -   <span data-ttu-id="55bee-316">若要變更連接到發行者時所使用的安全性模式，請為 [ \*\* \@ 屬性**] 指定 [ **publisher_security_mode** ] 的值，並為 [ **1** ] ([Windows 整合式驗證]) 或**0\*\* (SQL Server 驗證) ] \*\* \@ 值\*\*。</span><span class="sxs-lookup"><span data-stu-id="55bee-316">To change the security mode used when connecting to the Publisher, specify a value of **publisher_security_mode** for **\@property** and a value of **1** (Windows Integrated Authentication) or **0** (SQL Server Authentication) for **\@value**.</span></span>  
  
    -   <span data-ttu-id="55bee-317">將發行者安全性模式變更為 SQL Server 驗證，或是變更 SQL Server 驗證的登入資訊時，請為 [ \*\* \@ 屬性**] 指定 [ **publisher_password** ] 的值，並為 [ \*\* \@ 值**] 指定新的密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-317">When changing the Publisher security mode to SQL Server Authentication or if changing login information for SQL Server Authentication, specify a value of **publisher_password** for **\@property** and the new password for **\@value**.</span></span> <span data-ttu-id="55bee-318">重複步驟2，針對 [ \*\* \@ 屬性**] 指定**publisher_login**的值，並為 [ \*\* \@ 值**] 指定新的登入。</span><span class="sxs-lookup"><span data-stu-id="55bee-318">Repeat step 2, specifying a value of **publisher_login** for **\@property** and the new login for **\@value**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="55bee-319">變更代理程式的登入或密碼之後，您必須先停止並重新啟動代理程式，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="55bee-319">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span>  
  
#### <a name="to-change-security-settings-for-the-snapshot-agent-to-generate-a-filtered-snapshot-for-a-subscriber"></a><span data-ttu-id="55bee-320">變更快照集代理程式的安全性設定，為訂閱者產生篩選過的快照集</span><span class="sxs-lookup"><span data-stu-id="55bee-320">To change security settings for the Snapshot Agent to generate a filtered snapshot for a Subscriber</span></span>  
  
1.  <span data-ttu-id="55bee-321">在發行者上，執行[sp_helpdynamicsnapshot_job](/sql/relational-databases/system-stored-procedures/sp-helpdynamicsnapshot-job-transact-sql)，並指定\*\* \@ 發行\*\*集。</span><span class="sxs-lookup"><span data-stu-id="55bee-321">At the Publisher, execute [sp_helpdynamicsnapshot_job](/sql/relational-databases/system-stored-procedures/sp-helpdynamicsnapshot-job-transact-sql), specifying **\@publication**.</span></span> <span data-ttu-id="55bee-322">在結果集中，注意訂閱者要變更之資料分割的 **job_name** 值。</span><span class="sxs-lookup"><span data-stu-id="55bee-322">In the result set, note the value of **job_name** for the Subscriber's partition to change.</span></span>  
  
2.  <span data-ttu-id="55bee-323">在發行者上，執行[sp_changedynamicsnapshot_job](/sql/relational-databases/system-stored-procedures/sp-changedynamicsnapshot-job-transact-sql)，指定\*\* \@ 發行**集、針對** \@ dynamic_snapshot_jobname**從步驟1取得的值，以及針對** \@ job_login**和** \@ job_password**用於執行代理程式之 Windows 帳戶的新密碼** \@ job_password\*\*或登入和密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-323">At the Publisher, execute [sp_changedynamicsnapshot_job](/sql/relational-databases/system-stored-procedures/sp-changedynamicsnapshot-job-transact-sql), specifying **\@publication**, the value obtained from step 1 for **\@dynamic_snapshot_jobname**, and a new password for **\@job_password** or login and password for the Windows account under which the agent runs for **\@job_login** and **\@job_password**.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="55bee-324">當利用遠端散發者來設定發行者時，提供給所有參數的值 (包括 *job_login* 和 *job_password*) 都會以純文字的方式傳給散發者。</span><span class="sxs-lookup"><span data-stu-id="55bee-324">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="55bee-325">您應該先加密「發行者」及其遠端「散發者」之間的連接，再執行這個預存程序。</span><span class="sxs-lookup"><span data-stu-id="55bee-325">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="55bee-326">如需詳細資訊，請參閱[啟用 Database Engine 的加密連接 &#40;SQL Server 組態管理員&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)。</span><span class="sxs-lookup"><span data-stu-id="55bee-326">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-change-security-settings-for-the-queue-reader-agent"></a><span data-ttu-id="55bee-327">變更佇列讀取器代理程式的安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-327">To change security settings for the Queue Reader Agent</span></span>  
  
1.  <span data-ttu-id="55bee-328">在散發者上，執行 [sp_helpqreader_agent](/sql/relational-databases/system-stored-procedures/sp-helpqreader-agent-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="55bee-328">At the Distributor, execute [sp_helpqreader_agent](/sql/relational-databases/system-stored-procedures/sp-helpqreader-agent-transact-sql).</span></span> <span data-ttu-id="55bee-329">這樣會傳回佇列讀取器代理程式執行時所用的目前 Windows 帳戶。</span><span class="sxs-lookup"><span data-stu-id="55bee-329">This returns the current Windows account under which the Queue Reader Agent runs.</span></span>  
  
    -   <span data-ttu-id="55bee-330">在散發者上，執行[sp_changeqreader_agent](/sql/relational-databases/system-stored-procedures/sp-changeqreader-agent-transact-sql)，並指定\*\* \@ Job_login**和** \@ job_passwsord\*\*的 Windows 帳戶設定。</span><span class="sxs-lookup"><span data-stu-id="55bee-330">At the Distributor, execute [sp_changeqreader_agent](/sql/relational-databases/system-stored-procedures/sp-changeqreader-agent-transact-sql), specifying the Windows account settings for **\@job_login** and **\@job_passwsord**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="55bee-331">變更代理程式的登入或密碼之後，您必須先停止並重新啟動代理程式，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="55bee-331">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span> <span data-ttu-id="55bee-332">每個散發資料庫都會有一個佇列讀取器代理程式。</span><span class="sxs-lookup"><span data-stu-id="55bee-332">There is one Queue Reader Agent for each distribution database.</span></span> <span data-ttu-id="55bee-333">變更此代理程式的安全性設定時，會影響使用此散發資料庫之所有發行者上的所有發行集設定。</span><span class="sxs-lookup"><span data-stu-id="55bee-333">Changing the security settings for the agent affects the settings for all publications at all Publishers that use this distribution database.</span></span>  
  
2.  <span data-ttu-id="55bee-334">佇列讀取器代理程式會使用與訂閱之散發代理程式相同的連接內容連接到訂閱者。</span><span class="sxs-lookup"><span data-stu-id="55bee-334">The Queue Reader Agent makes connections to the Subscriber using the same connection context as the Distribution Agent for the subscription.</span></span>  
  
#### <a name="to-change-security-mode-used-by-an-immediate-updating-subscriber-when-connecting-to-the-publisher"></a><span data-ttu-id="55bee-335">變更立即更新訂閱者連接到發行者時所用的安全性模式</span><span class="sxs-lookup"><span data-stu-id="55bee-335">To change security mode used by an immediate updating Subscriber when connecting to the Publisher</span></span>  
  
1.  <span data-ttu-id="55bee-336">在訂閱資料庫的訂閱者上，執行 [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="55bee-336">At the Subscriber on the subscription database, execute [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql).</span></span> <span data-ttu-id="55bee-337">指定\*\* \@ 發行者**、**發行集、 \@ \*\* \*\* \@ publisher_db**的發行集資料庫名稱，以及** \@ security_mode\*\*的下列其中一個值：</span><span class="sxs-lookup"><span data-stu-id="55bee-337">Specify **\@publisher**, **\@publication**, the name of the publication database for **\@publisher_db**, and one of the following values for **\@security_mode**:</span></span>  
  
    -   <span data-ttu-id="55bee-338">**0** - 在發行者上進行更新時使用「SQL Server 驗證」。</span><span class="sxs-lookup"><span data-stu-id="55bee-338">**0** to use SQL Server Authentication when making updates at the Publisher.</span></span> <span data-ttu-id="55bee-339">此選項要求您在發行者上指定\*\* \@ 登**入和** \@ 密碼\*\*的有效登入。</span><span class="sxs-lookup"><span data-stu-id="55bee-339">This option requires you to specify a valid login at the Publisher for **\@login** and **\@password**.</span></span>  
  
    -   <span data-ttu-id="55bee-340">**1** - 在連接到發行者時，使用在訂閱者上進行變更之使用者的安全性內容。</span><span class="sxs-lookup"><span data-stu-id="55bee-340">**1** to use the security context of the user making changes at the Subscriber when connecting to the Publisher.</span></span> <span data-ttu-id="55bee-341">如需與此安全性模式有關的限制，請參閱 [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) 。</span><span class="sxs-lookup"><span data-stu-id="55bee-341">See [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) for restrictions related to this security mode.</span></span>  
  
    -   <span data-ttu-id="55bee-342">**2** - 使用透過 [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) 所建立之現有使用者定義的連結伺服器登入。</span><span class="sxs-lookup"><span data-stu-id="55bee-342">**2** to use an existing, user-defined linked server login created using [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span></span>  
  
#### <a name="to-change-the-password-for-a-remote-distributor"></a><span data-ttu-id="55bee-343">變更遠端散發者的密碼</span><span class="sxs-lookup"><span data-stu-id="55bee-343">To change the password for a remote Distributor</span></span>  
  
1.  <span data-ttu-id="55bee-344">在散發資料庫的「散發者」端，執行[sp_changedistributor_password](/sql/relational-databases/system-stored-procedures/sp-changedistributor-password-transact-sql)，為\*\* \@ 密碼\*\*指定此登入的新密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-344">At the Distributor on the distribution database, execute [sp_changedistributor_password](/sql/relational-databases/system-stored-procedures/sp-changedistributor-password-transact-sql), specifying the new password for this login for **\@password**.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="55bee-345">請勿直接變更 **distributor_admin** 的密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-345">Do not change the password for **distributor_admin** directly.</span></span>  
  
2.  <span data-ttu-id="55bee-346">在每個使用此遠端散發者的發行者上，執行[sp_changedistributor_password](/sql/relational-databases/system-stored-procedures/sp-changedistributor-password-transact-sql)，並為\*\* \@ 密碼\*\*指定步驟1中的密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-346">At every Publisher that uses this remote Distributor, execute [sp_changedistributor_password](/sql/relational-databases/system-stored-procedures/sp-changedistributor-password-transact-sql), specifying the password from step 1 for **\@password**.</span></span>  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="55bee-347">使用 Replication Management Objects (RMO)</span><span class="sxs-lookup"><span data-stu-id="55bee-347">Using Replication Management Objects (RMO)</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="55bee-348">可能的話，會在執行階段提示使用者輸入安全性認證。</span><span class="sxs-lookup"><span data-stu-id="55bee-348">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="55bee-349">如果您必須儲存認證，請使用 [Windows .NET Framework 提供的](https://go.microsoft.com/fwlink/?LinkId=34733) 密碼編譯服務 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="55bee-349">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows .NET Framework.</span></span>  
  
#### <a name="to-change-all-instances-of-a-password-stored-on-a-replication-server"></a><span data-ttu-id="55bee-350">變更複寫伺服器上儲存的所有密碼執行個體</span><span class="sxs-lookup"><span data-stu-id="55bee-350">To change all instances of a password stored on a replication server</span></span>  
  
1.  <span data-ttu-id="55bee-351">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 類別建立與複寫伺服器的連接。</span><span class="sxs-lookup"><span data-stu-id="55bee-351">Create a connection to the replication server by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="55bee-352">使用步驟 1 中的連接建立 <xref:Microsoft.SqlServer.Replication.ReplicationServer> 類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="55bee-352">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationServer> class by using the connection from step 1.</span></span>  
  
3.  <span data-ttu-id="55bee-353">呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationServer.ChangeReplicationServerPasswords%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="55bee-353">Call the <xref:Microsoft.SqlServer.Replication.ReplicationServer.ChangeReplicationServerPasswords%2A> method.</span></span> <span data-ttu-id="55bee-354">指定下列參數：</span><span class="sxs-lookup"><span data-stu-id="55bee-354">Specify the following parameters:</span></span>  
  
    -   <span data-ttu-id="55bee-355">*security_mode* - <xref:Microsoft.SqlServer.Replication.ReplicationSecurityMode> 值，可指定變更所有密碼執行個體所針對的驗證類型。</span><span class="sxs-lookup"><span data-stu-id="55bee-355">*security_mode* - a <xref:Microsoft.SqlServer.Replication.ReplicationSecurityMode> value that specifies the type of authentication for which all instances of the password are being changed.</span></span>  
  
    -   <span data-ttu-id="55bee-356">*login* - 變更所有密碼執行個體所針對的登入。</span><span class="sxs-lookup"><span data-stu-id="55bee-356">*login* - the login for which all instances of the password are being changed.</span></span>  
  
    -   <span data-ttu-id="55bee-357">*password* - 新的密碼值。</span><span class="sxs-lookup"><span data-stu-id="55bee-357">*password* - the new password value.</span></span>  
  
        > [!IMPORTANT]  
        >  <span data-ttu-id="55bee-358">可能的話，會在執行階段提示使用者輸入安全性認證。</span><span class="sxs-lookup"><span data-stu-id="55bee-358">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="55bee-359">如果您必須儲存認證，請使用 Windows .NET Framework 提供的 [密碼編譯服務](https://go.microsoft.com/fwlink/?LinkId=34733) 。</span><span class="sxs-lookup"><span data-stu-id="55bee-359">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the Windows .NET Framework.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="55bee-360">只有 `sysadmin` 固定伺服器角色的成員，才能呼叫這個方法。</span><span class="sxs-lookup"><span data-stu-id="55bee-360">Only a member of the `sysadmin` fixed server role can call this method.</span></span>  
  
4.  <span data-ttu-id="55bee-361">在必須更新密碼的複寫拓撲中，於每一部伺服器上重複步驟 1-3。</span><span class="sxs-lookup"><span data-stu-id="55bee-361">Repeat steps 1-3 at every server in the replication topology where the password must be updated.</span></span>  
  
#### <a name="to-change-security-settings-for-the-distribution-agent-for-a-push-subscription-to-a-transactional-publication"></a><span data-ttu-id="55bee-362">針對交易式發行集的發送訂閱變更散發代理程式的安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-362">To change security settings for the Distribution Agent for a push subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="55bee-363">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 類別建立與發行者的連接。</span><span class="sxs-lookup"><span data-stu-id="55bee-363">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="55bee-364">建立 <xref:Microsoft.SqlServer.Replication.TransSubscription> 類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="55bee-364">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransSubscription> class.</span></span>  
  
3.  <span data-ttu-id="55bee-365">針對訂閱設定 <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>、 <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>、 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>和 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A> 屬性，並針對 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 屬性設定步驟 1 中的連接。</span><span class="sxs-lookup"><span data-stu-id="55bee-365">Set the <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, and <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A> properties for the subscription, and set the connection from step 1 for the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property.</span></span>  
  
4.  <span data-ttu-id="55bee-366">呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法以取得物件的屬性。</span><span class="sxs-lookup"><span data-stu-id="55bee-366">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="55bee-367">如果此方法傳回 `false`，則表示步驟 3 中的訂閱屬性定義不正確，或者此訂閱不存在。</span><span class="sxs-lookup"><span data-stu-id="55bee-367">If this method returns `false`, either the subscription properties in step 3 were defined incorrectly or the subscription does not exist.</span></span>  
  
5.  <span data-ttu-id="55bee-368">在 <xref:Microsoft.SqlServer.Replication.TransSubscription>的執行個體上設定以下其中一個或多個安全性屬性：</span><span class="sxs-lookup"><span data-stu-id="55bee-368">Set one or more of the following security properties on the instance of <xref:Microsoft.SqlServer.Replication.TransSubscription>:</span></span>  
  
    -   <span data-ttu-id="55bee-369">若要變更代理程式執行所使用之 Windows 帳戶的認證，請設定 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> 的 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> 和 <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>欄位。</span><span class="sxs-lookup"><span data-stu-id="55bee-369">To change the credentials for the Windows account under which the agent runs, set the <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>.</span></span>  
  
    -   <span data-ttu-id="55bee-370">若要指定「Windows 整合式驗證」當做代理程式連接到訂閱者時所使用的驗證類型，請將 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 屬性的 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> 欄位設定為 `true`。</span><span class="sxs-lookup"><span data-stu-id="55bee-370">To specify Windows Integrated Authentication as the type of authentication that the agent uses when it connects to the Subscriber, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> property to `true`.</span></span>  
  
    -   <span data-ttu-id="55bee-371">若要指定 SQL Server Authentication 當做代理程式連接到訂閱者時所使用的驗證類型，請將 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 屬性的欄位設定 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> 為 `false` ，並針對和欄位指定訂閱者登入 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> 認證 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> 。</span><span class="sxs-lookup"><span data-stu-id="55bee-371">To specify SQL Server Authentication as the type of authentication that the agent uses when it connects to the Subscriber, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> property to `false`, and specify the Subscriber login credentials for the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> fields.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="55bee-372">與散發者的代理程式連接一律使用 <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>指定的 Windows 認證來建立。</span><span class="sxs-lookup"><span data-stu-id="55bee-372">The agent connection to the Distributor is always made using the Windows credentials specified by <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>.</span></span> <span data-ttu-id="55bee-373">透過 Windows 驗證進行遠端連接時，也會使用這個帳戶。</span><span class="sxs-lookup"><span data-stu-id="55bee-373">This account is also used to make remote connections using Windows Authentication.</span></span>  
  
6.  <span data-ttu-id="55bee-374">(選擇性) 如果您已針對 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> 指定 `true` 的值，請呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> 方法來認可伺服器上的變更。</span><span class="sxs-lookup"><span data-stu-id="55bee-374">(Optional) If you specified a value of `true` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>, call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method to commit changes on the server.</span></span> <span data-ttu-id="55bee-375">如果您已針對 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> 指定 `false` 的值 (預設值)，則會立即將變更傳送到伺服器。</span><span class="sxs-lookup"><span data-stu-id="55bee-375">If you specified a value of `false` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> (the default), changes are sent to the server immediately.</span></span>  
  
#### <a name="to-change-security-settings-for-the-distribution-agent-for-a-pull-subscription-to-a-transactional-publication"></a><span data-ttu-id="55bee-376">針對交易式發行集的提取訂閱變更散發代理程式的安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-376">To change security settings for the Distribution Agent for a pull subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="55bee-377">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 類別建立與「訂閱者」的連接。</span><span class="sxs-lookup"><span data-stu-id="55bee-377">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="55bee-378">建立 <xref:Microsoft.SqlServer.Replication.TransPullSubscription> 類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="55bee-378">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPullSubscription> class.</span></span>  
  
3.  <span data-ttu-id="55bee-379">針對訂閱設定 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>、 <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>、 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>和 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A> 屬性，並針對 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 屬性設定步驟 1 中的連接。</span><span class="sxs-lookup"><span data-stu-id="55bee-379">Set the <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, and <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A> properties for the subscription, and set the connection from step 1 for the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property.</span></span>  
  
4.  <span data-ttu-id="55bee-380">呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法以取得物件的屬性。</span><span class="sxs-lookup"><span data-stu-id="55bee-380">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="55bee-381">如果此方法傳回 `false`，則表示步驟 3 中的訂閱屬性定義不正確，或者此訂閱不存在。</span><span class="sxs-lookup"><span data-stu-id="55bee-381">If this method returns `false`, either the subscription properties in step 3 were defined incorrectly or the subscription does not exist.</span></span>  
  
5.  <span data-ttu-id="55bee-382">在 <xref:Microsoft.SqlServer.Replication.TransPullSubscription>的執行個體上設定以下其中一個或多個安全性屬性：</span><span class="sxs-lookup"><span data-stu-id="55bee-382">Set one or more of the following security properties on the instance of <xref:Microsoft.SqlServer.Replication.TransPullSubscription>:</span></span>  
  
    -   <span data-ttu-id="55bee-383">若要變更代理程式執行所使用之 Windows 帳戶的認證，請設定 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> 的 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> 和 <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>欄位。</span><span class="sxs-lookup"><span data-stu-id="55bee-383">To change the credentials for the Windows account under which the agent runs, set the <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> fields of <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.</span></span>  
  
    -   <span data-ttu-id="55bee-384">若要指定「Windows 整合式驗證」當做代理程式連接到散發者時所使用的驗證類型，請將 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 屬性的 <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> 欄位設定為 `true`。</span><span class="sxs-lookup"><span data-stu-id="55bee-384">To specify Windows Integrated Authentication as the type of authentication that the agent uses when it connects to the Distributor, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> property to `true`.</span></span>  
  
    -   <span data-ttu-id="55bee-385">若要指定 SQL Server Authentication 當做代理程式連接到散發者時所使用的驗證類型，請將 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 屬性的欄位設定 <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> 為 `false` ，並針對和欄位指定散發者登入 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> 認證 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> 。</span><span class="sxs-lookup"><span data-stu-id="55bee-385">To specify SQL Server Authentication as the type of authentication that the agent uses when it connects to the Distributor, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> property to `false`, and specify the Distributor login credentials for the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> fields.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="55bee-386">與訂閱者的代理程式連接一律使用 <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>指定的 Windows 認證來建立。</span><span class="sxs-lookup"><span data-stu-id="55bee-386">The agent connection to the Subscriber is always made using the Windows credentials specified by <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.</span></span> <span data-ttu-id="55bee-387">透過 Windows 驗證進行遠端連接時，也會使用這個帳戶。</span><span class="sxs-lookup"><span data-stu-id="55bee-387">This account is also used to make remote connections using Windows Authentication.</span></span>  
  
6.  <span data-ttu-id="55bee-388">(選擇性) 如果您已針對 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> 指定 `true` 的值，請呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> 方法來認可伺服器上的變更。</span><span class="sxs-lookup"><span data-stu-id="55bee-388">(Optional) If you specified a value of `true` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>, call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method to commit changes on the server.</span></span> <span data-ttu-id="55bee-389">如果您已針對 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> 指定 `false` 的值 (預設值)，則會立即將變更傳送到伺服器。</span><span class="sxs-lookup"><span data-stu-id="55bee-389">If you specified a value of `false` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> (the default), changes are sent to the server immediately.</span></span>  
  
#### <a name="to-change-security-settings-for-the-merge-agent-for-a-pull-subscription-to-a-merge-publication"></a><span data-ttu-id="55bee-390">針對合併式發行集的提取訂閱變更合併代理程式的安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-390">To change security settings for the Merge Agent for a pull subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="55bee-391">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 類別建立與「訂閱者」的連接。</span><span class="sxs-lookup"><span data-stu-id="55bee-391">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="55bee-392">建立 <xref:Microsoft.SqlServer.Replication.MergePullSubscription> 類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="55bee-392">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePullSubscription> class.</span></span>  
  
3.  <span data-ttu-id="55bee-393">針對訂閱設定 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>、 <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>、 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>和 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A> 屬性，並針對 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 屬性設定步驟 1 中的連接。</span><span class="sxs-lookup"><span data-stu-id="55bee-393">Set the <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, and <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A> properties for the subscription, and set the connection from step 1 for the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property.</span></span>  
  
4.  <span data-ttu-id="55bee-394">呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法以取得物件的屬性。</span><span class="sxs-lookup"><span data-stu-id="55bee-394">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="55bee-395">如果此方法傳回 `false`，則表示步驟 3 中的訂閱屬性定義不正確，或者此訂閱不存在。</span><span class="sxs-lookup"><span data-stu-id="55bee-395">If this method returns `false`, either the subscription properties in step 3 were defined incorrectly or the subscription does not exist.</span></span>  
  
5.  <span data-ttu-id="55bee-396">在 <xref:Microsoft.SqlServer.Replication.MergePullSubscription>的執行個體上設定以下其中一個或多個安全性屬性：</span><span class="sxs-lookup"><span data-stu-id="55bee-396">Set one or more of the following security properties on the instance of <xref:Microsoft.SqlServer.Replication.MergePullSubscription>:</span></span>  
  
    -   <span data-ttu-id="55bee-397">若要變更代理程式執行所使用之 Windows 帳戶的認證，請設定 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> 的 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> 和 <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>欄位。</span><span class="sxs-lookup"><span data-stu-id="55bee-397">To change the credentials for the Windows account under which the agent runs, set the <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> fields of <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.</span></span>  
  
    -   <span data-ttu-id="55bee-398">若要指定「Windows 整合式驗證」當做代理程式連接到散發者時所使用的驗證類型，請將 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 屬性的 <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> 欄位設定為 `true`。</span><span class="sxs-lookup"><span data-stu-id="55bee-398">To specify Windows Integrated Authentication as the type of authentication that the agent uses when it connects to the Distributor, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> property to `true`.</span></span>  
  
    -   <span data-ttu-id="55bee-399">若要指定 SQL Server Authentication 當做代理程式連接到散發者時所使用的驗證類型，請將 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 屬性的欄位設定 <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> 為 `false` ，並針對和欄位指定散發者登入 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> 認證 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> 。</span><span class="sxs-lookup"><span data-stu-id="55bee-399">To specify SQL Server Authentication as the type of authentication that the agent uses when it connects to the Distributor, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> property to `false`, and specify the Distributor login credentials for the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> fields.</span></span>  
  
    -   <span data-ttu-id="55bee-400">若要指定「Windows 整合式驗證」當做代理程式連接到發行者時所使用的驗證類型，請將 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 屬性的 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> 欄位設定為 `true`。</span><span class="sxs-lookup"><span data-stu-id="55bee-400">To specify Windows Integrated Authentication as the type of authentication that the agent uses when it connects to the Publisher, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> property to `true`.</span></span>  
  
    -   <span data-ttu-id="55bee-401">若要指定 SQL Server Authentication 當做代理程式連接到發行者時所使用的驗證類型，請將屬性的 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 欄位設定 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> 為 `false` ，並針對和欄位指定發行者登入認證 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> 。</span><span class="sxs-lookup"><span data-stu-id="55bee-401">To specify SQL Server Authentication as the type of authentication that the agent uses when it connects to the Publisher, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> property to `false`, and specify the Publisher login credentials for the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> fields.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="55bee-402">與訂閱者的代理程式連接一律使用 <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>指定的 Windows 認證來建立。</span><span class="sxs-lookup"><span data-stu-id="55bee-402">The agent connection to the Subscriber is always made using the Windows credentials specified by <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.</span></span> <span data-ttu-id="55bee-403">透過 Windows 驗證進行遠端連接時，也會使用這個帳戶。</span><span class="sxs-lookup"><span data-stu-id="55bee-403">This account is also used to make remote connections using Windows Authentication.</span></span>  
  
6.  <span data-ttu-id="55bee-404">(選擇性) 如果您已針對 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> 指定 `true` 的值，請呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> 方法來認可伺服器上的變更。</span><span class="sxs-lookup"><span data-stu-id="55bee-404">(Optional) If you specified a value of `true` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>, call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method to commit changes on the server.</span></span> <span data-ttu-id="55bee-405">如果您已針對 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> 指定 `false` 的值 (預設值)，則會立即將變更傳送到伺服器。</span><span class="sxs-lookup"><span data-stu-id="55bee-405">If you specified a value of `false` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> (the default), changes are sent to the server immediately.</span></span>  
  
#### <a name="to-change-security-settings-for-the-merge-agent-for-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="55bee-406">針對合併式發行集的發送訂閱變更合併代理程式的安全性設定</span><span class="sxs-lookup"><span data-stu-id="55bee-406">To change security settings for the Merge Agent for a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="55bee-407">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 類別建立與發行者的連接。</span><span class="sxs-lookup"><span data-stu-id="55bee-407">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="55bee-408">建立 <xref:Microsoft.SqlServer.Replication.MergeSubscription> 類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="55bee-408">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeSubscription> class.</span></span>  
  
3.  <span data-ttu-id="55bee-409">針對訂閱設定 <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>、 <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>、 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>和 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A> 屬性，並針對 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 屬性設定步驟 1 中的連接。</span><span class="sxs-lookup"><span data-stu-id="55bee-409">Set the <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, and <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A> properties for the subscription, and set the connection from step 1 for the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property.</span></span>  
  
4.  <span data-ttu-id="55bee-410">呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法以取得物件的屬性。</span><span class="sxs-lookup"><span data-stu-id="55bee-410">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="55bee-411">如果此方法傳回 `false`，則表示步驟 3 中的訂閱屬性定義不正確，或者此訂閱不存在。</span><span class="sxs-lookup"><span data-stu-id="55bee-411">If this method returns `false`, either the subscription properties in step 3 were defined incorrectly or the subscription does not exist.</span></span>  
  
5.  <span data-ttu-id="55bee-412">在 <xref:Microsoft.SqlServer.Replication.MergeSubscription>的執行個體上設定以下其中一個或多個安全性屬性：</span><span class="sxs-lookup"><span data-stu-id="55bee-412">Set one or more of the following security properties on the instance of <xref:Microsoft.SqlServer.Replication.MergeSubscription>:</span></span>  
  
    -   <span data-ttu-id="55bee-413">若要變更代理程式執行所使用之 Windows 帳戶的認證，請設定 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> 的 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> 和 <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>欄位。</span><span class="sxs-lookup"><span data-stu-id="55bee-413">To change the credentials for the Windows account under which the agent runs, set the <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> fields of <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.</span></span>  
  
    -   <span data-ttu-id="55bee-414">若要指定「Windows 整合式驗證」當做代理程式連接到訂閱者時所使用的驗證類型，請將 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 屬性的 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> 欄位設定為 `true`。</span><span class="sxs-lookup"><span data-stu-id="55bee-414">To specify Windows Integrated Authentication as the type of authentication that the agent uses when it connects to the Subscriber, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> property to `true`.</span></span>  
  
    -   <span data-ttu-id="55bee-415">若要指定 SQL Server Authentication 當做代理程式連接到訂閱者時所使用的驗證類型，請將 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 屬性的欄位設定 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> 為 `false` ，並針對和欄位指定訂閱者登入 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> 認證 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> 。</span><span class="sxs-lookup"><span data-stu-id="55bee-415">To specify SQL Server Authentication as the type of authentication that the agent uses when it connects to the Subscriber, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> property to `false`, and specify the Subscriber login credentials for the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> fields.</span></span>  
  
    -   <span data-ttu-id="55bee-416">若要指定「Windows 整合式驗證」當做代理程式連接到發行者時所使用的驗證類型，請將 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 屬性的 <xref:Microsoft.SqlServer.Replication.MergeSubscription.PublisherSecurity%2A> 欄位設定為 `true`。</span><span class="sxs-lookup"><span data-stu-id="55bee-416">To specify Windows Integrated Authentication as the type of authentication that the agent uses when it connects to the Publisher, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.MergeSubscription.PublisherSecurity%2A> property to `true`.</span></span>  
  
    -   <span data-ttu-id="55bee-417">若要指定 SQL Server Authentication 當做代理程式連接到發行者時所使用的驗證類型，請將屬性的 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 欄位設定 <xref:Microsoft.SqlServer.Replication.MergeSubscription.PublisherSecurity%2A> 為 `false` ，並針對和欄位指定發行者登入認證 <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext.SqlStandardLogin%2A> <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext.SqlStandardPassword%2A> 。</span><span class="sxs-lookup"><span data-stu-id="55bee-417">To specify SQL Server Authentication as the type of authentication that the agent uses when it connects to the Publisher, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.MergeSubscription.PublisherSecurity%2A> property to `false`, and specify the Publisher login credentials for the <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext.SqlStandardPassword%2A> fields.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="55bee-418">與散發者的代理程式連接一律使用 <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>指定的 Windows 認證來建立。</span><span class="sxs-lookup"><span data-stu-id="55bee-418">The agent connection to the Distributor is always made using the Windows credentials specified by <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>.</span></span> <span data-ttu-id="55bee-419">透過 Windows 驗證進行遠端連接時，也會使用這個帳戶。</span><span class="sxs-lookup"><span data-stu-id="55bee-419">This account is also used to make remote connections using Windows Authentication.</span></span>  
  
6.  <span data-ttu-id="55bee-420">(選擇性) 如果您已針對 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> 指定 `true` 的值，請呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> 方法來認可伺服器上的變更。</span><span class="sxs-lookup"><span data-stu-id="55bee-420">(Optional) If you specified a value of `true` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>, call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method to commit changes on the server.</span></span> <span data-ttu-id="55bee-421">如果您已針對 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> 指定 `false` 的值 (預設值)，則會立即將變更傳送到伺服器。</span><span class="sxs-lookup"><span data-stu-id="55bee-421">If you specified a value of `false` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> (the default), changes are sent to the server immediately.</span></span>  
  
#### <a name="to-change-the-login-information-used-by-an-immediate-updating-subscriber-when-it-connects-to-the-transactional-publisher"></a><span data-ttu-id="55bee-422">變更立即更新訂閱者連接到交易式發行者時所用的登入資訊</span><span class="sxs-lookup"><span data-stu-id="55bee-422">To change the login information used by an immediate updating Subscriber when it connects to the transactional publisher</span></span>  
  
1.  <span data-ttu-id="55bee-423">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 類別建立與「訂閱者」的連接。</span><span class="sxs-lookup"><span data-stu-id="55bee-423">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="55bee-424">為訂閱資料庫建立 <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> 類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="55bee-424">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> class for the subscription database.</span></span> <span data-ttu-id="55bee-425">指定 <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.Name%2A> 並針對 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 指定步驟 1 中的 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>。</span><span class="sxs-lookup"><span data-stu-id="55bee-425">Specify <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.Name%2A> and the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="55bee-426">呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法以取得物件的屬性。</span><span class="sxs-lookup"><span data-stu-id="55bee-426">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="55bee-427">如果此方法傳回 `false`，則表示步驟 2 中的資料庫屬性定義不正確，或者此訂閱資料庫不存在。</span><span class="sxs-lookup"><span data-stu-id="55bee-427">If this method returns `false`, either the database properties in step 2 were defined incorrectly or the subscription database does not exist.</span></span>  
  
4.  <span data-ttu-id="55bee-428">呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LinkPublicationForUpdateableSubscription%2A> 方法，傳遞以下參數：</span><span class="sxs-lookup"><span data-stu-id="55bee-428">Call the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LinkPublicationForUpdateableSubscription%2A> method, passing the following parameters:</span></span>  
  
    -   <span data-ttu-id="55bee-429">*Publisher* - 發行者的名稱。</span><span class="sxs-lookup"><span data-stu-id="55bee-429">*Publisher* - the name of the Publisher.</span></span>  
  
    -   <span data-ttu-id="55bee-430">*PublisherDB* - 發行集資料庫的名稱。</span><span class="sxs-lookup"><span data-stu-id="55bee-430">*PublisherDB* - the name of the publication database.</span></span>  
  
    -   <span data-ttu-id="55bee-431">*Publication* - 立即更新訂閱者訂閱的發行集名稱。</span><span class="sxs-lookup"><span data-stu-id="55bee-431">*Publication* - the name of the publication to which the immediate updating Subscriber is subscribed.</span></span>  
  
    -   <span data-ttu-id="55bee-432">*Distributor* - 散發者的名稱。</span><span class="sxs-lookup"><span data-stu-id="55bee-432">*Distributor* - the name of the Distributor.</span></span>  
  
    -   <span data-ttu-id="55bee-433">*PublisherSecurity* - A <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext> 物件，可在連接到發行者和連接的登入認證時，指定立即更新訂閱者所使用之安全性模式的類型。</span><span class="sxs-lookup"><span data-stu-id="55bee-433">*PublisherSecurity* - A <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext> object that specifies the type of security mode used by the immediate updating Subscriber when connecting to the Publisher and login credentials for the connection.</span></span>  
  
###  <a name="example-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="55bee-434">範例 (RMO)</span><span class="sxs-lookup"><span data-stu-id="55bee-434">Example (RMO)</span></span>  
 <span data-ttu-id="55bee-435">這個範例會檢查提供的登入值，並針對提供的 Windows 登入或 SQL Server 登入 (在伺服器上由複寫儲存) 變更其所有密碼。</span><span class="sxs-lookup"><span data-stu-id="55bee-435">This example checks the supplied login value and changes all passwords for the supplied Windows login or SQL Server login stored by replication on the server.</span></span>  
  
 [!code-csharp[HowTo#rmo_ChangeServerPasswords](../../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_changeserverpasswords)]  
  
 [!code-vb[HowTo#rmo_vb_ChangeServerPasswords](../../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_changeserverpasswords)]  
  
##  <a name="follow-up-after-you-modify-replication-security-settings"></a><a name="FollowUp"></a> <span data-ttu-id="55bee-436">後續操作：修改複寫安全性設定之後</span><span class="sxs-lookup"><span data-stu-id="55bee-436">Follow Up: After you modify replication security settings</span></span>  
 <span data-ttu-id="55bee-437">變更代理程式的登入或密碼之後，您必須先停止並重新啟動代理程式，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="55bee-437">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="55bee-438">另請參閱</span><span class="sxs-lookup"><span data-stu-id="55bee-438">See Also</span></span>  
 <span data-ttu-id="55bee-439">[Replication Management Objects Concepts](../concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="55bee-439">[Replication Management Objects Concepts](../concepts/replication-management-objects-concepts.md) </span></span>  
 <span data-ttu-id="55bee-440">[升級複寫指令碼 &#40;複寫 Transact-SQL 程式設計&#41;](../administration/upgrade-replication-scripts-replication-transact-sql-programming.md) </span><span class="sxs-lookup"><span data-stu-id="55bee-440">[Upgrade Replication Scripts &#40;Replication Transact-SQL Programming&#41;](../administration/upgrade-replication-scripts-replication-transact-sql-programming.md) </span></span>  
 <span data-ttu-id="55bee-441">[管理複寫的登入與密碼](identity-and-access-control-replication.md#manage-logins-and-passwords-in-replication) </span><span class="sxs-lookup"><span data-stu-id="55bee-441">[Manage Logins and Passwords in Replication](identity-and-access-control-replication.md#manage-logins-and-passwords-in-replication) </span></span>  
 <span data-ttu-id="55bee-442">[複寫代理程式安全性模型](replication-agent-security-model.md) </span><span class="sxs-lookup"><span data-stu-id="55bee-442">[Replication Agent Security Model](replication-agent-security-model.md) </span></span>  
 <span data-ttu-id="55bee-443">[Replication Security Best Practices](replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="55bee-443">[Replication Security Best Practices](replication-security-best-practices.md) </span></span>  
 <span data-ttu-id="55bee-444">[SQL Server 複寫安全性](view-and-modify-replication-security-settings.md) </span><span class="sxs-lookup"><span data-stu-id="55bee-444">[SQL Server Replication Security](view-and-modify-replication-security-settings.md) </span></span>  
 [<span data-ttu-id="55bee-445">Replication System Stored Procedures Concepts</span><span class="sxs-lookup"><span data-stu-id="55bee-445">Replication System Stored Procedures Concepts</span></span>](../concepts/replication-system-stored-procedures-concepts.md)  
  
  
