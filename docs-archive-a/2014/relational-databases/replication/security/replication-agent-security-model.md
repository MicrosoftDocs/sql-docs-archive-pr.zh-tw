---
title: 複寫代理程式安全性模型 | Microsoft Docs
ms.custom: ''
ms.date: 10/07/2015
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- Snapshot Agent, security
- agents [SQL Server replication], security
- Distribution Agent, security
- logins [SQL Server replication], permissions for agents
- security [SQL Server replication], agent security model
- Log Reader Agent, security
- Queue Reader Agent, security
- Merge Agent, security
- replication [SQL Server], agents and profiles
ms.assetid: 6d09fc8d-843a-4a7a-9812-f093d99d8192
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: da597bf97422f5a0960062b385bc0b67338edfe1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87584385"
---
# <a name="replication-agent-security-model"></a><span data-ttu-id="0db61-102">複寫代理程式安全性模型</span><span class="sxs-lookup"><span data-stu-id="0db61-102">Replication Agent Security Model</span></span>
  <span data-ttu-id="0db61-103">複寫代理程式安全性模型可允許針對複寫代理程式執行和建立連線時所使用的帳戶，進行更細微的控制：針對每個代理程式，可以指定不同的帳戶。</span><span class="sxs-lookup"><span data-stu-id="0db61-103">The replication agent security model allows for fine-grained control over the accounts under which replication agents run and make connections: A different account can be specified for each agent.</span></span> <span data-ttu-id="0db61-104">如需如何指定帳戶的詳細資訊，請參閱[管理複寫的登入與密碼](identity-and-access-control-replication.md#manage-logins-and-passwords-in-replication)。</span><span class="sxs-lookup"><span data-stu-id="0db61-104">For more information about how to specify accounts, see [Manage Logins and Passwords in Replication](identity-and-access-control-replication.md#manage-logins-and-passwords-in-replication).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="0db61-105">當 **系統管理員 (sysadmin)** 固定伺服器角色的成員設定複寫時，複寫代理程式可以設定為模擬 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent 帳戶。</span><span class="sxs-lookup"><span data-stu-id="0db61-105">When a member of the **sysadmin** fixed server role configures replication, replication agents can be configured to impersonate the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent account.</span></span> <span data-ttu-id="0db61-106">完成這項作業的方法，就是不指定複寫代理程式的登入和密碼；不過，我們不建議此方式。</span><span class="sxs-lookup"><span data-stu-id="0db61-106">This is done by not specifying a login and password for a replication agent; however, we do not recommend this approach.</span></span> <span data-ttu-id="0db61-107">反之，就安全性最佳做法而言，我們建議您為每個具有最小權限的代理程式指定帳戶；本主題稍後的＜代理程式所需的權限＞一節會描述最小權限。</span><span class="sxs-lookup"><span data-stu-id="0db61-107">Instead, as a security best practice, we recommend that you specify an account for each agent that has the minimum permissions that are described in the section "Permissions That Are Required by Agents" later in this topic.</span></span>  
  
 <span data-ttu-id="0db61-108">跟所有可執行檔一樣，複寫代理程式也是在 Windows 帳戶的內容下執行。</span><span class="sxs-lookup"><span data-stu-id="0db61-108">Replication agents, like all executables, run under the context of a Windows account.</span></span> <span data-ttu-id="0db61-109">代理程式會利用此帳戶來建立「Windows 整合式安全性」連接。</span><span class="sxs-lookup"><span data-stu-id="0db61-109">The agents make Windows Integrated Security connections by using this account.</span></span> <span data-ttu-id="0db61-110">執行代理程式所使用的帳戶取決於代理程式的啟動方式：</span><span class="sxs-lookup"><span data-stu-id="0db61-110">The account under which the agent runs depends on how the agent is started:</span></span>  
  
-   <span data-ttu-id="0db61-111">從 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent 作業啟動代理程式 (預設值)：使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent 作業來啟動複寫代理程式時，代理程式會在您設定複寫時指定的帳戶內容下執行。</span><span class="sxs-lookup"><span data-stu-id="0db61-111">Starting the agent from a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent job, the default: When a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent job is used to start a replication agent, the agent runs under the context of an account that you specify when you configure replication.</span></span> <span data-ttu-id="0db61-112">如需有關 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent 和複寫的詳細資訊，請參閱本主題稍後的＜SQL Server Agent 下的代理程式安全性＞一節。</span><span class="sxs-lookup"><span data-stu-id="0db61-112">For more information about [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent and replication, see the section "Agent Security under SQL Server Agent" later in this topic.</span></span> <span data-ttu-id="0db61-113">如需用來執行 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent 之帳戶所需權限的資訊，請參閱[設定 SQL Server Agent](../../../ssms/agent/configure-sql-server-agent.md)。</span><span class="sxs-lookup"><span data-stu-id="0db61-113">For information about the permissions that are required for the account under which [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent runs, see [Configure SQL Server Agent](../../../ssms/agent/configure-sql-server-agent.md).</span></span>  
  
-   <span data-ttu-id="0db61-114">從 MS-DOS 命令列直接或透過指令碼啟動代理程式：代理程式會在於命令列執行代理程式之使用者的帳戶內容下執行。</span><span class="sxs-lookup"><span data-stu-id="0db61-114">Starting the agent from an MS-DOS command line, either directly or through a script: The agent runs under the context of the account of the user that is running the agent at the command line.</span></span>  
  
-   <span data-ttu-id="0db61-115">從使用 Replication Management Objects (RMO) 或 ActiveX 控制項的應用程式啟動代理程式：代理程式會在呼叫 RMO 或 ActiveX 控制項之應用程式的內容下執行。</span><span class="sxs-lookup"><span data-stu-id="0db61-115">Starting the agent from an application that uses Replication Management Objects (RMO) or an ActiveX control: The agent runs under the context of the application that is calling RMO or the ActiveX control.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="0db61-116">ActiveX 控制項已被取代。</span><span class="sxs-lookup"><span data-stu-id="0db61-116">ActiveX controls are deprecated.</span></span>  
  
 <span data-ttu-id="0db61-117">我們建議您在 Windows 整合式安全性的內容下建立連接。</span><span class="sxs-lookup"><span data-stu-id="0db61-117">We recommend that connections be made under the context of Windows Integrated Security.</span></span> <span data-ttu-id="0db61-118">為了回溯相容性，您也可以使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安全性。</span><span class="sxs-lookup"><span data-stu-id="0db61-118">For backward compatibility, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Security can also be used.</span></span> <span data-ttu-id="0db61-119">如需最佳作法的相關資訊，請參閱 [Replication Security Best Practices](replication-security-best-practices.md)。</span><span class="sxs-lookup"><span data-stu-id="0db61-119">For more information about best practices, see [Replication Security Best Practices](replication-security-best-practices.md).</span></span>  
  
## <a name="permissions-that-are-required-by-agents"></a><span data-ttu-id="0db61-120">代理程式所需的權限</span><span class="sxs-lookup"><span data-stu-id="0db61-120">Permissions That Are Required by Agents</span></span>  
 <span data-ttu-id="0db61-121">執行代理程式和建立連接所使用的帳戶需要多種權限。</span><span class="sxs-lookup"><span data-stu-id="0db61-121">The accounts under which agents run and make connections require a variety of permissions.</span></span> <span data-ttu-id="0db61-122">下表描述這些權限。</span><span class="sxs-lookup"><span data-stu-id="0db61-122">These permissions are described in the following table.</span></span> <span data-ttu-id="0db61-123">我們建議每個代理程式均應使用不同的 Windows 帳戶執行，且帳戶應僅被授與所需權限。</span><span class="sxs-lookup"><span data-stu-id="0db61-123">We recommend that each agent run under a different Windows account and the account should be granted only the required permissions.</span></span> <span data-ttu-id="0db61-124">如需與多個代理程式相關之發行集存取清單 (PAL) 的資訊，請參閱[保護發行者](secure-the-publisher.md)。</span><span class="sxs-lookup"><span data-stu-id="0db61-124">For information about the publication access list (PAL), which is relevant for a number of agents, see [Secure the Publisher](secure-the-publisher.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="0db61-125">某些 Windows 作業系統中的「使用者帳戶控制」(UAC) 可以防止以管理員權限存取快照集共用。</span><span class="sxs-lookup"><span data-stu-id="0db61-125">User Account Control (UAC) in some Windows operating systems can prevent administrative access to the snapshot share.</span></span> <span data-ttu-id="0db61-126">因此，您必須針對快照集代理程式、散發代理程式和合併代理程式所使用的 Windows 帳戶，明確地授與快照集共用權限。</span><span class="sxs-lookup"><span data-stu-id="0db61-126">You must therefore explicitly grant snapshot share permissions to the Windows accounts that are used by the Snapshot Agent, Distribution Agent, and Merge Agent.</span></span> <span data-ttu-id="0db61-127">即使 Windows 帳戶是管理員群組的成員，也必須這麼做。</span><span class="sxs-lookup"><span data-stu-id="0db61-127">You must do this even if the Windows accounts are members of the Administrators group.</span></span> <span data-ttu-id="0db61-128">如需詳細資訊，請參閱[保護快照集資料夾](secure-the-snapshot-folder.md)。</span><span class="sxs-lookup"><span data-stu-id="0db61-128">For more information, see [Secure the Snapshot Folder](secure-the-snapshot-folder.md).</span></span>  
  
|<span data-ttu-id="0db61-129">代理程式</span><span class="sxs-lookup"><span data-stu-id="0db61-129">Agent</span></span>|<span data-ttu-id="0db61-130">權限</span><span class="sxs-lookup"><span data-stu-id="0db61-130">Permissions</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="0db61-131">快照集代理程式</span><span class="sxs-lookup"><span data-stu-id="0db61-131">Snapshot Agent</span></span>|<span data-ttu-id="0db61-132">在連接到散發者時，需使用執行代理程式的 Windows 帳戶。</span><span class="sxs-lookup"><span data-stu-id="0db61-132">The Windows account under which the agent runs is used when it makes connections to the Distributor.</span></span> <span data-ttu-id="0db61-133">這個帳戶必須：</span><span class="sxs-lookup"><span data-stu-id="0db61-133">This account must:</span></span><br /><br /> <span data-ttu-id="0db61-134">-至少是散發資料庫中 **db_owner** 固定資料庫角色的成員。</span><span class="sxs-lookup"><span data-stu-id="0db61-134">-At minimum, be a member of the **db_owner** fixed database role in the distribution database.</span></span><br /><br /> <span data-ttu-id="0db61-135">-具備快照集共用的讀取、寫入及修改權限。</span><span class="sxs-lookup"><span data-stu-id="0db61-135">-Have read, write, and modify permissions on the snapshot share.</span></span><br /><br /> <br /><br /> <span data-ttu-id="0db61-136">用來連接發行者的帳戶必須至少是發行集資料庫中 **db_owner** 固定資料庫角色的成員。</span><span class="sxs-lookup"><span data-stu-id="0db61-136">The account that is used to connect to the Publisher must at minimum be a member of the **db_owner** fixed database role in the publication database.</span></span>|  
|<span data-ttu-id="0db61-137">記錄讀取器代理程式</span><span class="sxs-lookup"><span data-stu-id="0db61-137">Log Reader Agent</span></span>|<span data-ttu-id="0db61-138">在連接到散發者時，需使用執行代理程式的 Windows 帳戶。</span><span class="sxs-lookup"><span data-stu-id="0db61-138">The Windows account under which the agent runs is used when it makes connections to the Distributor.</span></span> <span data-ttu-id="0db61-139">這個帳戶必須至少是散發資料庫中 **db_owner** 固定資料庫角色的成員。</span><span class="sxs-lookup"><span data-stu-id="0db61-139">This account must at minimum be a member of the **db_owner** fixed database role in the distribution database.</span></span><br /><br /> <span data-ttu-id="0db61-140">用來連接發行者的帳戶必須至少是發行集資料庫中 **db_owner** 固定資料庫角色的成員。</span><span class="sxs-lookup"><span data-stu-id="0db61-140">The account that is used to connect to the Publisher must at minimum be a member of the **db_owner** fixed database role in the publication database.</span></span><br /><br /> <span data-ttu-id="0db61-141">當選取 [ `sync_type` *僅限複寫支援*]、[*使用備份進行初始化*] 或 [*從 lsn 初始化*] 選項時，記錄讀取器代理程式必須在執行之後執行 `sp_addsubscription` ，以便將安裝腳本寫入散發資料庫。</span><span class="sxs-lookup"><span data-stu-id="0db61-141">When selecting the `sync_type` options *replication support only*, *initialize with backup*, or *initialize from lsn*, the log reader agent must run after executing `sp_addsubscription`, so that the set-up scripts are written to the distribution database.</span></span> <span data-ttu-id="0db61-142">記錄讀取器代理程式必須在屬於 **系統管理員 (sysadmin)** 固定伺服器角色成員的 Windows 帳戶底下執行。</span><span class="sxs-lookup"><span data-stu-id="0db61-142">The log reader agent must be running under an account that is a member of the **sysadmin** fixed server role.</span></span> <span data-ttu-id="0db61-143">當此 `sync_type` 選項設定為 [*自動*] 時，不需要任何特殊的記錄讀取器代理程式動作。</span><span class="sxs-lookup"><span data-stu-id="0db61-143">When the `sync_type` option is set to *Automatic*, no special log reader agent actions are required.</span></span>|  
|<span data-ttu-id="0db61-144">發送訂閱的散發代理程式</span><span class="sxs-lookup"><span data-stu-id="0db61-144">Distribution Agent for a push subscription</span></span>|<span data-ttu-id="0db61-145">在連接到散發者時，需使用執行代理程式的 Windows 帳戶。</span><span class="sxs-lookup"><span data-stu-id="0db61-145">The Windows account under which the agent runs is used when it makes connections to the Distributor.</span></span> <span data-ttu-id="0db61-146">這個帳戶必須：</span><span class="sxs-lookup"><span data-stu-id="0db61-146">This account must:</span></span><br /><br /> <span data-ttu-id="0db61-147">-至少是散發資料庫中 **db_owner** 固定資料庫角色的成員。</span><span class="sxs-lookup"><span data-stu-id="0db61-147">-At minimum be a member of the **db_owner** fixed database role in the distribution database.</span></span><br /><br /> <span data-ttu-id="0db61-148">-為 PAL 的成員。</span><span class="sxs-lookup"><span data-stu-id="0db61-148">-Be a member of the PAL.</span></span><br /><br /> <span data-ttu-id="0db61-149">-擁有快照集共用的讀取權限。</span><span class="sxs-lookup"><span data-stu-id="0db61-149">-Have read permissions on the snapshot share.</span></span><br /><br /> <span data-ttu-id="0db61-150">-如果訂閱是針對非 SQL Server 訂閱者，訂閱者之 OLE DB 提供者的安裝目錄上，就要擁有讀取權限。</span><span class="sxs-lookup"><span data-stu-id="0db61-150">-Have read permissions on the installation directory of the OLE DB provider for the Subscriber if the subscription is for a non-SQL Server Subscriber.</span></span><br /><br /> <span data-ttu-id="0db61-151">-在複寫 LOB 資料時，散發代理程式必須擁有複寫 **C:\Program Files\Microsoft SQL Server\XX\COMfolder** 的寫入權限，其中 XX 代表執行個體識別碼。</span><span class="sxs-lookup"><span data-stu-id="0db61-151">-When replicating LOB data, the distribution agent must have write permissions on the replication **C:\Program Files\Microsoft SQL Server\XX\COMfolder** where XX represents the instanceID.</span></span><br /><br /> <br /><br /> <span data-ttu-id="0db61-152">用於連接訂閱者的帳戶必須至少為訂閱資料庫中 **db_owner** 固定資料庫角色的成員，或者，如果訂閱為非 SQL Server 訂閱者的訂閱，則應擁有相等權限。</span><span class="sxs-lookup"><span data-stu-id="0db61-152">The account that is used to connect to the Subscriber must at minimum be a member of the **db_owner** fixed database role in the subscription database, or have equivalent permissions if the subscription is for a non-SQL Server Subscriber.</span></span><br /><br /> <span data-ttu-id="0db61-153">注意：在 `-subscriptionstreams >= 2` 散發代理程式上使用時，您也必須授與 `View Server State` 訂閱者的許可權以偵測到鎖死。</span><span class="sxs-lookup"><span data-stu-id="0db61-153">Note: When using `-subscriptionstreams >= 2` on the distribution agent you must also grant the `View Server State` permission on the subscribers to detect deadlocks.</span></span>|  
|<span data-ttu-id="0db61-154">提取訂閱的散發代理程式</span><span class="sxs-lookup"><span data-stu-id="0db61-154">Distribution Agent for a pull subscription</span></span>|<span data-ttu-id="0db61-155">在連接到訂閱者時，需使用執行代理程式的 Windows 帳戶。</span><span class="sxs-lookup"><span data-stu-id="0db61-155">The Windows account under which the agent runs is used when it makes connections to the Subscriber.</span></span> <span data-ttu-id="0db61-156">這個帳戶必須至少是訂閱資料庫中 **db_owner** 固定資料庫角色的成員。</span><span class="sxs-lookup"><span data-stu-id="0db61-156">This account must at minimum be a member of the **db_owner** fixed database role in the subscription database.</span></span> <span data-ttu-id="0db61-157">用於連接散發者的帳戶必須：</span><span class="sxs-lookup"><span data-stu-id="0db61-157">The account that is used to connect to the Distributor must:</span></span><br /><br /> <span data-ttu-id="0db61-158">-為 PAL 的成員。</span><span class="sxs-lookup"><span data-stu-id="0db61-158">-Be a member of the PAL.</span></span><br /><br /> <span data-ttu-id="0db61-159">-擁有快照集共用的讀取權限。</span><span class="sxs-lookup"><span data-stu-id="0db61-159">-Have read permissions on the snapshot share.</span></span><br /><br /> <span data-ttu-id="0db61-160">-在複寫 LOB 資料時，散發代理程式必須擁有複寫 **C:\Program Files\Microsoft SQL Server\XX\COMfolder** 的寫入權限，其中 XX 代表執行個體識別碼。</span><span class="sxs-lookup"><span data-stu-id="0db61-160">-When replicating LOB data, the distribution agent must have write permissions on the replication **C:\Program Files\Microsoft SQL Server\XX\COMfolder** where XX represents the instanceID.</span></span><br /><br /> <br /><br /> <span data-ttu-id="0db61-161">注意：在 `-subscriptionstreams >= 2` 散發代理程式上使用時，您也必須授與 `View Server State` 訂閱者的許可權以偵測到鎖死。</span><span class="sxs-lookup"><span data-stu-id="0db61-161">Note: When using `-subscriptionstreams >= 2` on the distribution agent you must also grant the `View Server State` permission on the subscribers to detect deadlocks.</span></span>|  
|<span data-ttu-id="0db61-162">發送訂閱的合併代理程式</span><span class="sxs-lookup"><span data-stu-id="0db61-162">Merge Agent for a push subscription</span></span>|<span data-ttu-id="0db61-163">與發行者和散發者建立連接時，需使用代理程式執行時所用的 Windows 帳戶。</span><span class="sxs-lookup"><span data-stu-id="0db61-163">The Windows account under which the agent runs is used when it makes connections to the Publisher and Distributor.</span></span> <span data-ttu-id="0db61-164">這個帳戶必須：</span><span class="sxs-lookup"><span data-stu-id="0db61-164">This account must:</span></span><br /><br /> <span data-ttu-id="0db61-165">-至少是散發資料庫中 **db_owner** 固定資料庫角色的成員。</span><span class="sxs-lookup"><span data-stu-id="0db61-165">-At minimum be a member of the **db_owner** fixed database role in the distribution database.</span></span><br /><br /> <span data-ttu-id="0db61-166">-為 PAL 的成員。</span><span class="sxs-lookup"><span data-stu-id="0db61-166">-Be a member of the PAL.</span></span><br /><br /> <span data-ttu-id="0db61-167">-為與發行集資料庫中使用者相關聯的登入。</span><span class="sxs-lookup"><span data-stu-id="0db61-167">-Be a login that is associated with a user in the publication database.</span></span><br /><br /> <span data-ttu-id="0db61-168">-擁有快照集共用的讀取權限。</span><span class="sxs-lookup"><span data-stu-id="0db61-168">-Have read permissions on the snapshot share.</span></span><br /><br /> <br /><br /> <span data-ttu-id="0db61-169">用來連接訂閱者的帳戶必須至少是訂閱資料庫中 **db_owner** 固定資料庫角色的成員。</span><span class="sxs-lookup"><span data-stu-id="0db61-169">The account used to connect to the Subscriber must at minimum be a member of the **db_owner** fixed database role in the subscription database.</span></span>|  
|<span data-ttu-id="0db61-170">提取訂閱的合併代理程式</span><span class="sxs-lookup"><span data-stu-id="0db61-170">Merge Agent for a pull subscription</span></span>|<span data-ttu-id="0db61-171">在連接到訂閱者時，需使用執行代理程式的 Windows 帳戶。</span><span class="sxs-lookup"><span data-stu-id="0db61-171">The Windows account under which the agent runs is used when it makes connections to the Subscriber.</span></span> <span data-ttu-id="0db61-172">這個帳戶必須至少是訂閱資料庫中 **db_owner** 固定資料庫角色的成員。</span><span class="sxs-lookup"><span data-stu-id="0db61-172">This account must at minimum be a member of the **db_owner** fixed database role in the subscription database.</span></span> <span data-ttu-id="0db61-173">用於連接發行者和散發者的帳戶必須：</span><span class="sxs-lookup"><span data-stu-id="0db61-173">The account that is used to connect to the Publisher and Distributor must:</span></span><br /><br /> <span data-ttu-id="0db61-174">-為 PAL 的成員。</span><span class="sxs-lookup"><span data-stu-id="0db61-174">-Be a member of the PAL.</span></span><br /><br /> <span data-ttu-id="0db61-175">-為與發行集資料庫中使用者相關聯的登入。</span><span class="sxs-lookup"><span data-stu-id="0db61-175">-Be a login associated with a user in the publication database.</span></span><br /><br /> <span data-ttu-id="0db61-176">-為與散發資料庫中使用者相關聯的登入。</span><span class="sxs-lookup"><span data-stu-id="0db61-176">-Be a login associated with a user in the distribution database.</span></span> <span data-ttu-id="0db61-177">使用者可以是 `Guest` 使用者。</span><span class="sxs-lookup"><span data-stu-id="0db61-177">The user can be the `Guest` user.</span></span><br /><br /> <span data-ttu-id="0db61-178">-擁有快照集共用的讀取權限。</span><span class="sxs-lookup"><span data-stu-id="0db61-178">-Have read permissions on the snapshot share.</span></span>|  
|<span data-ttu-id="0db61-179">佇列讀取器代理程式</span><span class="sxs-lookup"><span data-stu-id="0db61-179">Queue Reader Agent</span></span>|<span data-ttu-id="0db61-180">在連接到散發者時，需使用執行代理程式的 Windows 帳戶。</span><span class="sxs-lookup"><span data-stu-id="0db61-180">The Windows account under which the agent runs is used when it makes connections to the Distributor.</span></span> <span data-ttu-id="0db61-181">這個帳戶必須至少是散發資料庫中 **db_owner** 固定資料庫角色的成員。</span><span class="sxs-lookup"><span data-stu-id="0db61-181">This account must at minimum be a member of the **db_owner** fixed database role in the distribution database.</span></span><br /><br /> <span data-ttu-id="0db61-182">用來連接發行者的帳戶必須至少是發行集資料庫中 **db_owner** 固定資料庫角色的成員。</span><span class="sxs-lookup"><span data-stu-id="0db61-182">The account that is used to connect to the Publisher must at minimum be a member of the **db_owner** fixed database role in the publication database.</span></span><br /><br /> <span data-ttu-id="0db61-183">用來連接訂閱者的帳戶必須至少是訂閱資料庫中 **db_owner** 固定資料庫角色的成員。</span><span class="sxs-lookup"><span data-stu-id="0db61-183">The account that is used to connect to the Subscriber must at minimum be a member of the **db_owner** fixed database role in the subscription database.</span></span>|  
  
## <a name="agent-security-under-sql-server-agent"></a><span data-ttu-id="0db61-184">SQL Server Agent 下的代理程式安全性</span><span class="sxs-lookup"><span data-stu-id="0db61-184">Agent Security Under SQL Server Agent</span></span>  
 <span data-ttu-id="0db61-185">利用 [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]、 [!INCLUDE[tsql](../../../includes/tsql-md.md)] 程序或 RMO 設定複寫時，依預設，會為每個代理程式建立 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent 作業。</span><span class="sxs-lookup"><span data-stu-id="0db61-185">When you configure replication by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)] procedures, or RMO, a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent job is created by default for each agent.</span></span> <span data-ttu-id="0db61-186">然後，代理程式將在作業步驟內容下執行，無論是連續執行、按排程執行，或者在需要時執行。</span><span class="sxs-lookup"><span data-stu-id="0db61-186">Agents then run under the context of a job step, regardless of whether they run continuously, on a schedule, or on demand.</span></span> <span data-ttu-id="0db61-187">您可以在 **中的** [作業] [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]資料夾下檢視這些作業。</span><span class="sxs-lookup"><span data-stu-id="0db61-187">You can view these jobs under the **Jobs** folder in [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="0db61-188">下表列出各個作業名稱。</span><span class="sxs-lookup"><span data-stu-id="0db61-188">The following table lists the job names.</span></span>  
  
|<span data-ttu-id="0db61-189">代理程式</span><span class="sxs-lookup"><span data-stu-id="0db61-189">Agent</span></span>|<span data-ttu-id="0db61-190">作業名稱</span><span class="sxs-lookup"><span data-stu-id="0db61-190">Job name</span></span>|  
|-----------|--------------|  
|<span data-ttu-id="0db61-191">快照集代理程式</span><span class="sxs-lookup"><span data-stu-id="0db61-191">Snapshot Agent</span></span>|**\<Publisher>-\<PublicationDatabase>-\<Publication>-\<integer>**|  
|<span data-ttu-id="0db61-192">合併式發行集分割區的快照集代理程式</span><span class="sxs-lookup"><span data-stu-id="0db61-192">Snapshot Agent for a merge publication partition</span></span>|<span data-ttu-id="0db61-193">**Dyn_\<Publisher>-\<PublicationDatabase>-\<Publication>-\<GUID>**</span><span class="sxs-lookup"><span data-stu-id="0db61-193">**Dyn_\<Publisher>-\<PublicationDatabase>-\<Publication>-\<GUID>**</span></span>|  
|<span data-ttu-id="0db61-194">記錄讀取器代理程式</span><span class="sxs-lookup"><span data-stu-id="0db61-194">Log Reader Agent</span></span>|**\<Publisher>-\<PublicationDatabase>-\<integer>**|  
|<span data-ttu-id="0db61-195">提取訂閱的合併代理程式</span><span class="sxs-lookup"><span data-stu-id="0db61-195">Merge Agent for pull subscriptions</span></span>|**\<Publisher>-\<PublicationDatabase>-\<Publication>-\<Subscriber>-\<SubscriptionDatabase>-\<integer>**|  
|<span data-ttu-id="0db61-196">發送訂閱的合併代理程式</span><span class="sxs-lookup"><span data-stu-id="0db61-196">Merge Agent for push subscriptions</span></span>|**\<Publisher>-\<PublicationDatabase>-\<Publication>-\<Subscriber>-\<integer>**|  
|<span data-ttu-id="0db61-197">發送訂閱的散發代理程式</span><span class="sxs-lookup"><span data-stu-id="0db61-197">Distribution Agent for push subscriptions</span></span>|<span data-ttu-id="0db61-198">**\<Publisher>-\<PublicationDatabase>-\<Publication>-\<Subscriber>-\<integer>** <sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="0db61-198">**\<Publisher>-\<PublicationDatabase>-\<Publication>-\<Subscriber>-\<integer>** <sup>1</sup></span></span>|  
|<span data-ttu-id="0db61-199">提取訂閱的散發代理程式</span><span class="sxs-lookup"><span data-stu-id="0db61-199">Distribution Agent for pull subscriptions</span></span>|<span data-ttu-id="0db61-200">**\<Publisher>-\<PublicationDatabase>-\<Publication>-\<Subscriber>-\<SubscriptionDatabase>-\<GUID>** <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="0db61-200">**\<Publisher>-\<PublicationDatabase>-\<Publication>-\<Subscriber>-\<SubscriptionDatabase>-\<GUID>** <sup>2</sup></span></span>|  
|<span data-ttu-id="0db61-201">發送訂閱至非 SQL Server 訂閱者的散發代理程式</span><span class="sxs-lookup"><span data-stu-id="0db61-201">Distribution Agent for push subscriptions to non-SQL Server Subscribers</span></span>|**\<Publisher>-\<PublicationDatabase>-\<Publication>-\<Subscriber>-\<integer>**|  
|<span data-ttu-id="0db61-202">佇列讀取器代理程式</span><span class="sxs-lookup"><span data-stu-id="0db61-202">Queue Reader Agent</span></span>|<span data-ttu-id="0db61-203">**[\<Distributor>].\<integer>**</span><span class="sxs-lookup"><span data-stu-id="0db61-203">**[\<Distributor>].\<integer>**</span></span>|  
  
 <span data-ttu-id="0db61-204"><sup>1</sup>對於 Oracle 發行集的發送訂閱，作業名稱是 \* \*， \<Publisher> - \<Publisher**> 而不是 **\<Publisher>-\<PublicationDatabase>** 。</span><span class="sxs-lookup"><span data-stu-id="0db61-204"><sup>1</sup> For push subscriptions to Oracle publications, the job name is \*\*\<Publisher>-\<Publisher**> instead of **\<Publisher>-\<PublicationDatabase>**.</span></span>  
  
 <span data-ttu-id="0db61-205"><sup>2</sup>對於 Oracle 發行集的提取訂閱，作業名稱是 \* \*， \<Publisher> - \<DistributionDatabase**> 而不是 **\<Publisher>-\<PublicationDatabase>** 。</span><span class="sxs-lookup"><span data-stu-id="0db61-205"><sup>2</sup> For pull subscriptions to Oracle publications, the job name is \*\*\<Publisher>-\<DistributionDatabase**> instead of **\<Publisher>-\<PublicationDatabase>**.</span></span>  
  
 <span data-ttu-id="0db61-206">在複寫設定期間，指定代理程式應在其下執行的帳戶。</span><span class="sxs-lookup"><span data-stu-id="0db61-206">When you configure replication, you specify accounts under which agents should run.</span></span> <span data-ttu-id="0db61-207">但是，所有作業步驟均在 *Proxy*安全性內容下執行，因此複寫將為您指定的代理程式帳戶在內部執行下列對應：</span><span class="sxs-lookup"><span data-stu-id="0db61-207">However, all job steps run under the security context of a *proxy*; therefore, replication performs the following mappings internally for the agent accounts that you specify:</span></span>  
  
-   <span data-ttu-id="0db61-208">先利用 [!INCLUDE[tsql](../../../includes/tsql-md.md)] [CREATE CREDENTIAL](/sql/t-sql/statements/create-credential-transact-sql) 陳述式將帳戶對應至認證。</span><span class="sxs-lookup"><span data-stu-id="0db61-208">The account is first mapped to a credential by using the [!INCLUDE[tsql](../../../includes/tsql-md.md)] [CREATE CREDENTIAL](/sql/t-sql/statements/create-credential-transact-sql) statement.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="0db61-209">Agent Proxy 使用認證來儲存 Windows 使用者帳戶的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="0db61-209">Agent proxies use credentials to store information about Windows user accounts.</span></span>  
  
-   <span data-ttu-id="0db61-210">呼叫預存程序 [sp_add_proxy](/sql/relational-databases/system-stored-procedures/sp-add-proxy-transact-sql) ，並利用認證建立 Proxy。</span><span class="sxs-lookup"><span data-stu-id="0db61-210">The [sp_add_proxy](/sql/relational-databases/system-stored-procedures/sp-add-proxy-transact-sql) stored procedure is called, and the credential is used to create a proxy..</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="0db61-211">提供此資訊的目的，是為了協助您了解，利用適當的安全性內容執行代理程式時會涉及哪些項目。</span><span class="sxs-lookup"><span data-stu-id="0db61-211">This information is provided to help you understand what is involved in running agents with the appropriate security context.</span></span> <span data-ttu-id="0db61-212">您不應該直接與已建立的認證或 Proxy 互動。</span><span class="sxs-lookup"><span data-stu-id="0db61-212">You should not have to interact directly with the credentials or proxies that have been created.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0db61-213">另請參閱</span><span class="sxs-lookup"><span data-stu-id="0db61-213">See Also</span></span>  
 <span data-ttu-id="0db61-214">[Replication Security Best Practices](replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="0db61-214">[Replication Security Best Practices](replication-security-best-practices.md) </span></span>  
 <span data-ttu-id="0db61-215">[SQL Server 複寫安全性](view-and-modify-replication-security-settings.md) </span><span class="sxs-lookup"><span data-stu-id="0db61-215">[SQL Server Replication Security](view-and-modify-replication-security-settings.md) </span></span>  
 [<span data-ttu-id="0db61-216">保護快照集資料夾</span><span class="sxs-lookup"><span data-stu-id="0db61-216">Secure the Snapshot Folder</span></span>](secure-the-snapshot-folder.md)  
  
  
