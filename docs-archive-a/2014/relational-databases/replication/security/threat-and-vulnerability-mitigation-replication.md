---
title: 威脅和弱點安全防護 (複寫) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- attacks [SQL Server replication]
- threats [SQL Server replication security]
- security [SQL Server replication], threats
- security threats [SQL Server replication]
ms.assetid: 314fe497-56d8-4192-98e9-21b87cf8db04
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c1a9c2c646f26d0cb61ae3d41ccdbd72551094d4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87704970"
---
# <a name="threat-and-vulnerability-mitigation-replication"></a><span data-ttu-id="a3e0d-102">威脅和弱點安全防護 (複寫)</span><span class="sxs-lookup"><span data-stu-id="a3e0d-102">Threat and Vulnerability Mitigation (Replication)</span></span>
  <span data-ttu-id="a3e0d-103">本主題描述可減輕複寫拓撲威脅的技術。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-103">This topic describes techniques to reduce threats to a replication topology.</span></span>  
  
## <a name="encryption"></a><span data-ttu-id="a3e0d-104">加密</span><span class="sxs-lookup"><span data-stu-id="a3e0d-104">Encryption</span></span>  
 <span data-ttu-id="a3e0d-105">加密是將資料轉換成一種無特殊金鑰便無法讀取格式的處理，這樣一來就只有預期收件者才能讀取該資料。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-105">Encryption is the process of converting data into a form that cannot be read without a special key, so that only the intended recipient can read the data.</span></span> <span data-ttu-id="a3e0d-106">複寫不會加密資料表中儲存的資料，或透過網路連接傳送的資料。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-106">Replication does not encrypt data stored in tables or sent over network connections.</span></span> <span data-ttu-id="a3e0d-107">這是設計所限，因為加密可在傳輸層使用數種技術提供，包括下列業界標準技術：虛擬私人網路 (VPN)、安全通訊端層 (SSL) 及 IP 安全性 (IPSEC)。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-107">This is by design, because encryption is available at the transport level with a number of technologies, including the following industry standard technologies: Virtual Private Networks (VPN), Secure Sockets Layer (SSL), and IP Security (IPSEC).</span></span> <span data-ttu-id="a3e0d-108">建議對複寫拓撲中電腦之間的連接使用這些加密方法中的一種。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-108">We recommend using one of these encryption methods for the connections between computers in a replication topology.</span></span> <span data-ttu-id="a3e0d-109">如需詳細資訊，請參閱[啟用 Database Engine 的加密連接 &#40;SQL Server 組態管理員&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-109">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span> <span data-ttu-id="a3e0d-110">如需有關透過網際網路使用 VPN 與 SSL 複寫資料的資訊，請參閱＜ [Securing Replication Over the Internet](securing-replication-over-the-internet.md)＞。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-110">For information about using VPN and SSL for replicating data over the Internet, see [Securing Replication Over the Internet](securing-replication-over-the-internet.md).</span></span>  
  
 <span data-ttu-id="a3e0d-111">如果使用 SSL 保護複寫拓撲中電腦之間的連接，請將每個複寫代理程式的 **-EncryptionLevel** 參數值指定為 **1** 或 **2** (建議使用 **2** 值)。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-111">If you use SSL to secure the connections between computers in a replication topology, specify a value of **1** or **2** for the **-EncryptionLevel** parameter of each replication agent (a value of **2** is recommended).</span></span> <span data-ttu-id="a3e0d-112">值 **1** 會指定使用加密，但代理程式不會確認 SSL 伺服器憑證是否由受信任簽發者簽署；值 **2** 則會指定對憑證進行確認。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-112">A value of **1** specifies that encryption is used, but the agent does not verify that the SSL server certificate is signed by a trusted issuer; a value of **2** specifies that the certificate is verified.</span></span> <span data-ttu-id="a3e0d-113">可於代理程式設定檔和命令列中指定代理程式參數。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-113">Agent parameters can be specified in agent profiles and on the command line.</span></span> <span data-ttu-id="a3e0d-114">如需詳細資訊，請參閱</span><span class="sxs-lookup"><span data-stu-id="a3e0d-114">For more information, see:</span></span>  
  
-   [<span data-ttu-id="a3e0d-115">處理複寫代理程式設定檔</span><span class="sxs-lookup"><span data-stu-id="a3e0d-115">Work with Replication Agent Profiles</span></span>](../agents/replication-agent-profiles.md)  
  
-   [<span data-ttu-id="a3e0d-116">檢視並修改複寫代理程式命令提示字元參數 &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="a3e0d-116">View and Modify Replication Agent Command Prompt Parameters &#40;SQL Server Management Studio&#41;</span></span>](../agents/view-and-modify-replication-agent-command-prompt-parameters.md)  
  
-   [<span data-ttu-id="a3e0d-117">Replication Agent Executables Concepts</span><span class="sxs-lookup"><span data-stu-id="a3e0d-117">Replication Agent Executables Concepts</span></span>](../concepts/replication-agent-executables-concepts.md)  
  
 <span data-ttu-id="a3e0d-118">針對資料庫「主要金鑰」，複寫採取下列行為來加密資料：</span><span class="sxs-lookup"><span data-stu-id="a3e0d-118">Replication has the following behavior with respect to database Master Keys, which are used to encrypt data:</span></span>  
  
-   <span data-ttu-id="a3e0d-119">如果複寫涉及的資料庫 (發行集資料庫、訂閱資料庫或散發資料庫) 中存在「主要金鑰」，則複寫會用 [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] 資料庫對稱金鑰來加密及解密該資料庫中的代理程式密碼。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-119">If a Master Key is present in a database involved in replication (a publication database, subscription database, or distribution database), replication encrypts and decrypts agent passwords in that database using a [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] database symmetric key.</span></span> <span data-ttu-id="a3e0d-120">如果使用了「主要金鑰」，則應在複寫涉及的所有資料庫中都建立「主要金鑰」。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-120">If Master Keys are used, a Master Key should be created in each database involved in replication.</span></span> <span data-ttu-id="a3e0d-121">如需建立「主要金鑰」的詳細資訊，請參閱 [CREATE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-master-key-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-121">For more information about creating Master Keys, see [CREATE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-master-key-transact-sql).</span></span>  
  
-   <span data-ttu-id="a3e0d-122">複寫不會複寫「主要金鑰」。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-122">Replication does not replicate Master Keys.</span></span> <span data-ttu-id="a3e0d-123">若要求「訂閱者」端的「主要金鑰」，則必須先用 BACKUP MASTER KEY 將主要金鑰從發行集資料庫中匯出，然後再用 RESTORE MASTER KEY 將其匯入訂閱資料庫。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-123">If you require the Master Key at the Subscriber, you must export it from the publication database using BACKUP MASTER KEY and then import it into the subscription database using RESTORE MASTER KEY.</span></span> <span data-ttu-id="a3e0d-124">如需詳細資訊，請參閱 [BACKUP MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-master-key-transact-sql) 和 [RESTORE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-master-key-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-124">For more information, see [BACKUP MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-master-key-transact-sql) and [RESTORE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-master-key-transact-sql).</span></span>  
  
-   <span data-ttu-id="a3e0d-125">如果主要金鑰是針對可附加的訂閱資料庫所定義，請使用 **@db_master_key_password** [Sp_attachsubscription &#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-attachsubscription-transact-sql)的參數來指定主要金鑰密碼。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-125">If a Master Key is defined for an attachable subscription database, specify the Master Key password using the **@db_master_key_password** parameter of [sp_attachsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-attachsubscription-transact-sql).</span></span> <span data-ttu-id="a3e0d-126">此操作可將資料庫附加到「訂閱者」。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-126">This allows the database to be attached at the Subscriber.</span></span>  
  
 <span data-ttu-id="a3e0d-127">如需加密和「主要金鑰」的詳細資訊，請參閱＜ [Encryption Hierarchy](../../security/encryption/encryption-hierarchy.md)＞。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-127">For more information about encryption and Master Keys, see [Encryption Hierarchy](../../security/encryption/encryption-hierarchy.md).</span></span>  
  
 <span data-ttu-id="a3e0d-128">複寫讓您可以發行加密的資料行資料。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-128">Replication enables you to publish encrypted column data.</span></span> <span data-ttu-id="a3e0d-129">若要在訂閱者端解密及使用此資料，於發行者端用來加密資料的金鑰也必須存在訂閱者端。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-129">To decrypt and use this data at the Subscriber, the key that was used to encrypt the data at the Publisher must also be present on the Subscriber.</span></span> <span data-ttu-id="a3e0d-130">複寫並不會提供用於傳輸加密金鑰的安全機制。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-130">Replication does not provide a secure mechanism to transport encryption keys.</span></span> <span data-ttu-id="a3e0d-131">您必須以手動方式於訂閱者端重新建立加密金鑰。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-131">You must manually re-create the encryption key at the Subscriber.</span></span> <span data-ttu-id="a3e0d-132">如需詳細資訊，請參閱[複寫加密資料行中的資料 &#40;SQL Server Management Studio&#41;](replicate-data-in-encrypted-columns-sql-server-management-studio.md)。</span><span class="sxs-lookup"><span data-stu-id="a3e0d-132">For more information, see [Replicate Data in Encrypted Columns &#40;SQL Server Management Studio&#41;](replicate-data-in-encrypted-columns-sql-server-management-studio.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a3e0d-133">另請參閱</span><span class="sxs-lookup"><span data-stu-id="a3e0d-133">See Also</span></span>  
 <span data-ttu-id="a3e0d-134">[身分識別與存取控制 &#40;複寫&#41;](identity-and-access-control-replication.md) </span><span class="sxs-lookup"><span data-stu-id="a3e0d-134">[Identity and Access Control &#40;Replication&#41;](identity-and-access-control-replication.md) </span></span>  
 [<span data-ttu-id="a3e0d-135">安全複寫部署</span><span class="sxs-lookup"><span data-stu-id="a3e0d-135">Secure Replication Deployment</span></span>](view-and-modify-replication-security-settings.md)  
  
  
