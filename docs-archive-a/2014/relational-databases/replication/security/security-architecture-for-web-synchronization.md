---
title: Web 同步處理的安全性架構 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- Web synchronization, security architecture
ms.assetid: 74eee587-d5f5-4d1a-bbae-7f4e3f27e23b
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 5feaaefb469e7ad1bdf25fe70c6cc6963e4418d6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87704994"
---
# <a name="security-architecture-for-web-synchronization"></a><span data-ttu-id="1202b-102">Web 同步處理的安全性架構</span><span class="sxs-lookup"><span data-stu-id="1202b-102">Security Architecture for Web Synchronization</span></span>
  [!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="1202b-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 可讓您精確控制 Web 同步處理安全性的設定。</span><span class="sxs-lookup"><span data-stu-id="1202b-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] enables fine-grained control over the configuration of Web synchronization security.</span></span> <span data-ttu-id="1202b-104">本主題提供一份完整清單，其中列有可併入 Web 同步處理組態中的所有元件，並提供有關元件之間所建立的連接資訊。</span><span class="sxs-lookup"><span data-stu-id="1202b-104">This topic provides a comprehensive list of all the components that can be included in a Web synchronization configuration and information about the connections that are made between components.</span></span> [!INCLUDE[ssNoteWinAuthentication](../../../includes/ssnotewinauthentication-md.md)]  
  
 <span data-ttu-id="1202b-105">下圖顯示所有可能的連接，但特定拓撲中可能不需要某些連接。</span><span class="sxs-lookup"><span data-stu-id="1202b-105">The following illustration shows all the possible connections, but some connections might not be required in a particular topology.</span></span> <span data-ttu-id="1202b-106">例如，只有在利用 FTP 傳遞快照集時，才需要連接 FTP 伺服器。</span><span class="sxs-lookup"><span data-stu-id="1202b-106">For example, a connection to an FTP server is required only if the snapshot is delivered by using FTP.</span></span>  
  
 <span data-ttu-id="1202b-107">![Web 同步處理中的元件和連線](../media/websyncarchitecture.gif "Web 同步處理中的元件和連線")</span><span class="sxs-lookup"><span data-stu-id="1202b-107">![Components and connections in Web synchronization](../media/websyncarchitecture.gif "Components and connections in Web synchronization")</span></span>  
  
 <span data-ttu-id="1202b-108">下表描述圖解中顯示的元件和連接。</span><span class="sxs-lookup"><span data-stu-id="1202b-108">The following tables describe the components and connections that are shown in the illustration.</span></span>  
  
## <a name="a-windows-user-under-which-the-merge-agent-runs"></a><span data-ttu-id="1202b-109">A.</span><span class="sxs-lookup"><span data-stu-id="1202b-109">A.</span></span> <span data-ttu-id="1202b-110">合併代理程式執行時所用的 Windows 使用者</span><span class="sxs-lookup"><span data-stu-id="1202b-110">Windows User Under Which the Merge Agent Runs</span></span>  
 <span data-ttu-id="1202b-111">同步處理期間，合併代理程式 (A) 會在訂閱者端啟動。</span><span class="sxs-lookup"><span data-stu-id="1202b-111">During synchronization, the Merge Agent (A) is started at the Subscriber.</span></span> <span data-ttu-id="1202b-112">您可以從 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent 作業步驟或從獨立的自訂應用程式啟動合併代理程式。</span><span class="sxs-lookup"><span data-stu-id="1202b-112">The Merge Agent can be started from a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent job step or from a stand-alone custom application.</span></span> <span data-ttu-id="1202b-113">如果是從 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent 作業步驟啟動合併代理程式，則合併代理程式必須在您指定之 Windows 使用者的內容下執行。</span><span class="sxs-lookup"><span data-stu-id="1202b-113">If the Merge Agent is started from a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent job step, the Merge Agent runs under the context of a Windows user that you specify.</span></span> <span data-ttu-id="1202b-114">如果您未指定 Windows 使用者，合併代理程式會在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent 之 Windows 服務帳戶的內容下執行。</span><span class="sxs-lookup"><span data-stu-id="1202b-114">If you do not specify a Windows user, the Merge Agent runs under the context of the Windows service account for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent.</span></span>  
  
|<span data-ttu-id="1202b-115">帳戶類型</span><span class="sxs-lookup"><span data-stu-id="1202b-115">Type of account</span></span>|<span data-ttu-id="1202b-116">指定帳戶的位置</span><span class="sxs-lookup"><span data-stu-id="1202b-116">Where the account is specified</span></span>|  
|---------------------|------------------------------------|  
|<span data-ttu-id="1202b-117">Windows 使用者</span><span class="sxs-lookup"><span data-stu-id="1202b-117">Windows user</span></span>|[!INCLUDE[tsql](../../../includes/tsql-md.md)]<span data-ttu-id="1202b-118">： [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)的\*\* \@ job_login**和** \@ job_password\*\*參數。</span><span class="sxs-lookup"><span data-stu-id="1202b-118">: the **\@job_login** and **\@job_password** parameters of [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql).</span></span><br /><br /> <span data-ttu-id="1202b-119">RMO (Replication Management Objects)： <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> 的 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> 和 <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="1202b-119">RMO (Replication Management Objects): the <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> properties for <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.</span></span>|  
|<span data-ttu-id="1202b-120">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent 的 Windows 服務帳戶</span><span class="sxs-lookup"><span data-stu-id="1202b-120">Windows service account for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent</span></span>|[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="1202b-121">組態管理員</span><span class="sxs-lookup"><span data-stu-id="1202b-121">Configuration Manager</span></span>|  
|<span data-ttu-id="1202b-122">獨立應用程式</span><span class="sxs-lookup"><span data-stu-id="1202b-122">Stand-alone application</span></span>|<span data-ttu-id="1202b-123">合併代理程式在執行應用程式之 Windows 使用者的內容下執行。</span><span class="sxs-lookup"><span data-stu-id="1202b-123">The Merge Agent runs under the context of the Windows user that is running the application.</span></span>|  
  
## <a name="b-connection-to-the-subscriber"></a><span data-ttu-id="1202b-124">B.</span><span class="sxs-lookup"><span data-stu-id="1202b-124">B.</span></span> <span data-ttu-id="1202b-125">連接訂閱者</span><span class="sxs-lookup"><span data-stu-id="1202b-125">Connection to the Subscriber</span></span>  
 <span data-ttu-id="1202b-126">合併代理程式利用 Windows 驗證或 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 驗證來連接訂閱者。</span><span class="sxs-lookup"><span data-stu-id="1202b-126">The Merge Agent connects to the Subscriber by using Windows Authentication or [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication.</span></span> <span data-ttu-id="1202b-127">您指定的 Windows 使用者或 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 登入，必須與特定資料庫使用者相關聯，該資料庫使用者必須是訂閱資料庫中 **dbowner** 固定資料庫角色的成員。</span><span class="sxs-lookup"><span data-stu-id="1202b-127">The Windows user or [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login that you specify must be associated with a database user that is a member of the **dbowner** fixed database role in the subscription database.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="1202b-128">從 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent 作業啟動「合併代理程式」時，一定會使用 Windows 驗證。</span><span class="sxs-lookup"><span data-stu-id="1202b-128">Windows Authentication is always used when the Merge Agent is started from a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent job.</span></span> <span data-ttu-id="1202b-129">除非已明確指定 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 驗證，否則當以程式設計方式啟動「合併代理程式」時，也會使用 Windows 驗證。</span><span class="sxs-lookup"><span data-stu-id="1202b-129">Windows Authentication is also used when the Merge Agent is started programmatically unless [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication is explicitly specified.</span></span>  
  
|<span data-ttu-id="1202b-130">驗證類型</span><span class="sxs-lookup"><span data-stu-id="1202b-130">Type of authentication</span></span>|<span data-ttu-id="1202b-131">指定驗證的位置</span><span class="sxs-lookup"><span data-stu-id="1202b-131">Where the authentication is specified</span></span>|  
|----------------------------|-------------------------------------------|  
|<span data-ttu-id="1202b-132">Windows 驗證。</span><span class="sxs-lookup"><span data-stu-id="1202b-132">Windows Authentication.</span></span>|<span data-ttu-id="1202b-133">合併代理程式會在針對合併代理程式 (A) 指定之 Windows 使用者的內容下建立連接。</span><span class="sxs-lookup"><span data-stu-id="1202b-133">The Merge Agent makes connections under the context of the Windows user that is specified for the Merge Agent (A).</span></span>|  
|<span data-ttu-id="1202b-134">只有在指定下列項目時，才會使用[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 驗證：</span><span class="sxs-lookup"><span data-stu-id="1202b-134">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication is used only if the following is specified:</span></span><br /><br /> <span data-ttu-id="1202b-135">RMO：<xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> 的 <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.SubscriberSecurityMode%2A> 值。</span><span class="sxs-lookup"><span data-stu-id="1202b-135">RMO: a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> for <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.SubscriberSecurityMode%2A>.</span></span><br /><br /> <span data-ttu-id="1202b-136">合併代理程式命令列： **SubscriberSecurityMode**的值為**0** 。</span><span class="sxs-lookup"><span data-stu-id="1202b-136">Merge Agent command line: a value of **0** for **SubscriberSecurityMode**.</span></span>|<span data-ttu-id="1202b-137">RMO： <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.SubscriberLogin%2A> 和 <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.SubscriberPassword%2A>。</span><span class="sxs-lookup"><span data-stu-id="1202b-137">RMO: <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.SubscriberLogin%2A> and <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.SubscriberPassword%2A>.</span></span><br /><br /> <span data-ttu-id="1202b-138">「合併代理程式」命令列： **-SubscriberLogin** 和 **-SubscriberLogin**。</span><span class="sxs-lookup"><span data-stu-id="1202b-138">Merge Agent command line: **-SubscriberLogin** and **-SubscriberLogin**.</span></span>|  
  
## <a name="c-connection-to-an-outgoing-proxy-server"></a><span data-ttu-id="1202b-139">C.</span><span class="sxs-lookup"><span data-stu-id="1202b-139">C.</span></span> <span data-ttu-id="1202b-140">連接外寄 Proxy 伺服器</span><span class="sxs-lookup"><span data-stu-id="1202b-140">Connection to an Outgoing Proxy Server</span></span>  
 <span data-ttu-id="1202b-141">只有在具有限制存取訂閱者內部網路的外寄 Proxy 伺服器時，才需要指定此連接的 Windows 使用者。</span><span class="sxs-lookup"><span data-stu-id="1202b-141">Specify a Windows user for this connection only if there is an outgoing proxy server that restricts access to the internal network of the Subscriber.</span></span>  
  
|<span data-ttu-id="1202b-142">驗證類型</span><span class="sxs-lookup"><span data-stu-id="1202b-142">Type of authentication</span></span>|<span data-ttu-id="1202b-143">指定驗證的位置</span><span class="sxs-lookup"><span data-stu-id="1202b-143">Where the authentication is specified</span></span>|  
|----------------------------|-------------------------------------------|  
|<span data-ttu-id="1202b-144">Windows 驗證</span><span class="sxs-lookup"><span data-stu-id="1202b-144">Windows Authentication</span></span>|<span data-ttu-id="1202b-145">RMO：具有 <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.InternetProxyLogin%2A> 的 <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.InternetProxyPassword%2A> 和 <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.InternetProxyServer%2A>。</span><span class="sxs-lookup"><span data-stu-id="1202b-145">RMO: <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.InternetProxyLogin%2A> and <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.InternetProxyPassword%2A> with <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.InternetProxyServer%2A>.</span></span><br /><br /> <span data-ttu-id="1202b-146">「合併代理程式」命令列：具有 **-InternetProxyServer** 的 **-InternetProxyLogin** 和 **-InternetProxyPassword**。</span><span class="sxs-lookup"><span data-stu-id="1202b-146">Merge Agent command line: **-InternetProxyLogin** and **-InternetProxyPassword** with **-InternetProxyServer**.</span></span>|  
  
## <a name="d-connection-to-iis"></a><span data-ttu-id="1202b-147">D.</span><span class="sxs-lookup"><span data-stu-id="1202b-147">D.</span></span> <span data-ttu-id="1202b-148">連接 IIS</span><span class="sxs-lookup"><span data-stu-id="1202b-148">Connection to IIS</span></span>  
 <span data-ttu-id="1202b-149">連接訂閱者並從訂閱資料庫擷取任何變更之後，合併代理程式會對 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Internet Information Services (IIS) 進行 HTTPS 要求，並以 XML 訊息來上傳資料變更。</span><span class="sxs-lookup"><span data-stu-id="1202b-149">After connecting to the Subscriber and extracting any changes from the subscription database, the Merge Agent makes an HTTPS request to [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Internet Information Services (IIS) and uploads data changes as an XML message.</span></span> <span data-ttu-id="1202b-150">合併代理程式必須擁有 IIS 登入權限。</span><span class="sxs-lookup"><span data-stu-id="1202b-150">The Merge Agent must have logon permissions to IIS.</span></span>  
  
|<span data-ttu-id="1202b-151">驗證類型</span><span class="sxs-lookup"><span data-stu-id="1202b-151">Type of authentication</span></span>|<span data-ttu-id="1202b-152">指定驗證的位置</span><span class="sxs-lookup"><span data-stu-id="1202b-152">Where the authentication is specified</span></span>|  
|----------------------------|-------------------------------------------|  
|<span data-ttu-id="1202b-153">如果指定下列其中一項，則會使用「基本驗證」：</span><span class="sxs-lookup"><span data-stu-id="1202b-153">Basic Authentication is used if one of the following is specified:</span></span><br /><br /> [!INCLUDE[tsql](../../../includes/tsql-md.md)]<span data-ttu-id="1202b-154">： [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)之\*\* \@ internet_security_mode**參數的值為**0\*\* 。</span><span class="sxs-lookup"><span data-stu-id="1202b-154">: a value of **0** for the **\@internet_security_mode** parameter of [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql).</span></span><br /><br /> <span data-ttu-id="1202b-155">RMO：<xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> 的 <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.InternetSecurityMode%2A> 值。</span><span class="sxs-lookup"><span data-stu-id="1202b-155">RMO: a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> for <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.InternetSecurityMode%2A>.</span></span><br /><br /> <span data-ttu-id="1202b-156">合併代理程式命令列： **-microsoft.sqlserver.replication.mergesynchronizationagent.internetsecuritymode**的值為**0** 。</span><span class="sxs-lookup"><span data-stu-id="1202b-156">Merge Agent command line: a value of **0** for **-InternetSecurityMode**.</span></span>|[!INCLUDE[tsql](../../../includes/tsql-md.md)]<span data-ttu-id="1202b-157">： [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)的\*\* \@ internet_login**和** \@ internet_password\*\*參數。</span><span class="sxs-lookup"><span data-stu-id="1202b-157">: the **\@internet_login** and **\@internet_password** parameters of [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql).</span></span><br /><br /> <span data-ttu-id="1202b-158">RMO： <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.InternetLogin%2A> 和 <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.InternetPassword%2A>。</span><span class="sxs-lookup"><span data-stu-id="1202b-158">RMO: <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.InternetLogin%2A> and <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.InternetPassword%2A>.</span></span><br /><br /> <span data-ttu-id="1202b-159">「合併代理程式」命令列： **-InternetLogin** 和 **-InternetPassword**。</span><span class="sxs-lookup"><span data-stu-id="1202b-159">Merge Agent command line: **-InternetLogin** and **-InternetPassword**.</span></span>|  
|<span data-ttu-id="1202b-160">\*如果指定下列其中一項，則會使用整合式驗證：</span><span class="sxs-lookup"><span data-stu-id="1202b-160">Integrated Authentication\* is used if one of the following is specified:</span></span><br /><br /> [!INCLUDE[tsql](../../../includes/tsql-md.md)]<span data-ttu-id="1202b-161">： [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)之\*\* \@ internet_security_mode**參數的**1\*\*值。</span><span class="sxs-lookup"><span data-stu-id="1202b-161">: a value of **1** for the **\@internet_security_mode** parameter of [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql).</span></span><br /><br /> <span data-ttu-id="1202b-162">RMO：<xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> 的 <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.InternetSecurityMode%2A> 值。</span><span class="sxs-lookup"><span data-stu-id="1202b-162">RMO: a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> for <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.InternetSecurityMode%2A>.</span></span><br /><br /> <span data-ttu-id="1202b-163">合併代理程式命令列： **-microsoft.sqlserver.replication.mergesynchronizationagent.internetsecuritymode**的**1**值。</span><span class="sxs-lookup"><span data-stu-id="1202b-163">Merge Agent command line: a value of **1** for **-InternetSecurityMode**.</span></span>|<span data-ttu-id="1202b-164">合併代理程式會在針對合併代理程式 (A) 指定之 Windows 使用者的內容下建立連接。</span><span class="sxs-lookup"><span data-stu-id="1202b-164">The Merge Agent makes connections under the context of the Windows user that is specified for the Merge Agent (A).</span></span>|  
  
 <span data-ttu-id="1202b-165">\* 只有在所有電腦都位於相同網域，或位於彼此具有信任關係的多個網域中時，才能使用整合式驗證。</span><span class="sxs-lookup"><span data-stu-id="1202b-165">\*Integrated authentication can be used only if all computers are in the same domain or are in multiple domains that have trust relationships with each other.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="1202b-166">如果使用「整合式驗證」，則需要委派。</span><span class="sxs-lookup"><span data-stu-id="1202b-166">Delegation is required if you use Integrated Authentication.</span></span> <span data-ttu-id="1202b-167">如果是從「訂閱者」到 IIS 之間的連線，建議您使用「基本驗證」和 SSL。</span><span class="sxs-lookup"><span data-stu-id="1202b-167">We recommend that you use Basic Authentication and SSL for connections from the Subscriber to IIS.</span></span>  
  
## <a name="e-connection-to-the-publisher"></a><span data-ttu-id="1202b-168">E.</span><span class="sxs-lookup"><span data-stu-id="1202b-168">E.</span></span> <span data-ttu-id="1202b-169">連接發行者</span><span class="sxs-lookup"><span data-stu-id="1202b-169">Connection to the Publisher</span></span>  
 <span data-ttu-id="1202b-170">您可以在執行 IIS 的電腦上主控 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Replication Listener 和合併式複寫重新調整器元件。</span><span class="sxs-lookup"><span data-stu-id="1202b-170">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Replication Listener and Merge Replication Reconciler components are hosted on the computer that is running IIS.</span></span> <span data-ttu-id="1202b-171">這些元件會執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="1202b-171">These components perform the following actions:</span></span>  
  
-   <span data-ttu-id="1202b-172">挑選＜D. 連接 IIS＞一節中</span><span class="sxs-lookup"><span data-stu-id="1202b-172">Pick up the HTTPS request that is described in the section "D.</span></span> <span data-ttu-id="1202b-173">描述的 HTTPS 要求。</span><span class="sxs-lookup"><span data-stu-id="1202b-173">Connection to IIS".</span></span>  
  
-   <span data-ttu-id="1202b-174">建立發行集資料庫的 SQL 連接，並將上傳的變更套用到發行集資料庫。</span><span class="sxs-lookup"><span data-stu-id="1202b-174">Make an SQL connection to the publication database and apply the uploaded changes to the publication database.</span></span>  
  
-   <span data-ttu-id="1202b-175">擷取下載的變更，並將 HTTPS 回應傳回給合併代理程式。</span><span class="sxs-lookup"><span data-stu-id="1202b-175">Extract the downloaded changes and send an HTTPS response back to the Merge Agent.</span></span>  
  
 <span data-ttu-id="1202b-176">合併式複寫重新調整器會利用 Windows 驗證或 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 驗證來連接發行者。</span><span class="sxs-lookup"><span data-stu-id="1202b-176">The Merge Replication Reconciler connects to the Publisher by using either Windows Authentication or [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication.</span></span> <span data-ttu-id="1202b-177">您指定的 Windows 使用者或 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 登入必須符合下列條件：</span><span class="sxs-lookup"><span data-stu-id="1202b-177">The Windows user or [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login that you specify must comply with the following:</span></span>  
  
-   <span data-ttu-id="1202b-178">在發行集存取清單 (PAL) 中。</span><span class="sxs-lookup"><span data-stu-id="1202b-178">Be in the publication access list (PAL).</span></span> <span data-ttu-id="1202b-179">如需詳細資訊，請參閱[保護發行者](secure-the-publisher.md)。</span><span class="sxs-lookup"><span data-stu-id="1202b-179">For more information, see [Secure the Publisher](secure-the-publisher.md).</span></span>  
  
-   <span data-ttu-id="1202b-180">與發行集資料庫中的使用者相關聯。</span><span class="sxs-lookup"><span data-stu-id="1202b-180">Be associated with a user in the publication database.</span></span>  
  
|<span data-ttu-id="1202b-181">驗證類型</span><span class="sxs-lookup"><span data-stu-id="1202b-181">Type of authentication</span></span>|<span data-ttu-id="1202b-182">指定驗證的位置</span><span class="sxs-lookup"><span data-stu-id="1202b-182">Where the authentication is specified</span></span>|  
|----------------------------|-------------------------------------------|  
|<span data-ttu-id="1202b-183">如果指定下列其中一項，則使用 Windows 驗證：</span><span class="sxs-lookup"><span data-stu-id="1202b-183">Windows Authentication is used if one of the following is specified:</span></span><br /><br /> [!INCLUDE[tsql](../../../includes/tsql-md.md)]<span data-ttu-id="1202b-184">： [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)之\*\* \@ publisher_security_mode**參數的**1\*\*值。</span><span class="sxs-lookup"><span data-stu-id="1202b-184">: a value of **1** for the **\@publisher_security_mode** parameter of [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql).</span></span><br /><br /> <span data-ttu-id="1202b-185">RMO：<xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> 的 <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.PublisherSecurityMode%2A> 值。</span><span class="sxs-lookup"><span data-stu-id="1202b-185">RMO: a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> for <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.PublisherSecurityMode%2A>.</span></span><br /><br /> <span data-ttu-id="1202b-186">合併代理程式命令列： **-PublisherSecurityMode**的**1**值。</span><span class="sxs-lookup"><span data-stu-id="1202b-186">Merge Agent command line: a value of **1** for **-PublisherSecurityMode**.</span></span>|<span data-ttu-id="1202b-187">合併代理程式會在針對 IIS 連接 (D) 指定之 Windows 使用者的內容下建立發行者連接。</span><span class="sxs-lookup"><span data-stu-id="1202b-187">The Merge Agent makes connections to the Publisher under the context of the Windows user that is specified for the connection to IIS (D).</span></span> <span data-ttu-id="1202b-188">如果發行者和 IIS 在不同的電腦上，且整合式驗證是用於連接 (D)，則必須在執行 IIS 的電腦上啟用 Kerberos 委派。</span><span class="sxs-lookup"><span data-stu-id="1202b-188">If the Publisher and IIS are on different computers and Integrated Authentication is used for the connection (D), you must enable Kerberos delegation on the computer that is running IIS.</span></span> <span data-ttu-id="1202b-189">如需詳細資訊，請參閱 Windows 文件集。</span><span class="sxs-lookup"><span data-stu-id="1202b-189">For more information, see the Windows documentation.</span></span>|  
|<span data-ttu-id="1202b-190">如果指定下列其中一項，則使用[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 驗證：</span><span class="sxs-lookup"><span data-stu-id="1202b-190">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication is used if one of the following is specified:</span></span><br /><br /> [!INCLUDE[tsql](../../../includes/tsql-md.md)]<span data-ttu-id="1202b-191">： [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)之\*\* \@ publisher_security_mode**參數的值為**0\*\* 。</span><span class="sxs-lookup"><span data-stu-id="1202b-191">: a value of **0** for the **\@publisher_security_mode** parameter of [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql).</span></span><br /><br /> <span data-ttu-id="1202b-192">RMO：<xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> 的 <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.PublisherSecurityMode%2A> 值。</span><span class="sxs-lookup"><span data-stu-id="1202b-192">RMO: a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> for <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.PublisherSecurityMode%2A>.</span></span><br /><br /> <span data-ttu-id="1202b-193">合併代理程式命令列： **-PublisherSecurityMode**的值為**0** 。</span><span class="sxs-lookup"><span data-stu-id="1202b-193">Merge Agent command line: a value of **0** for **-PublisherSecurityMode**.</span></span>|[!INCLUDE[tsql](../../../includes/tsql-md.md)]<span data-ttu-id="1202b-194">： [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)的\*\* \@ publisher_login**和** \@ publisher_password\*\*參數。</span><span class="sxs-lookup"><span data-stu-id="1202b-194">: the **\@publisher_login** and **\@publisher_password** parameters of [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql).</span></span><br /><br /> <span data-ttu-id="1202b-195">RMO： <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.PublisherLogin%2A> 和 <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.PublisherPassword%2A>。</span><span class="sxs-lookup"><span data-stu-id="1202b-195">RMO: <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.PublisherLogin%2A> and <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.PublisherPassword%2A>.</span></span><br /><br /> <span data-ttu-id="1202b-196">「合併代理程式」命令列： **-PublisherLogin** 和 **-PublisherPassword**。</span><span class="sxs-lookup"><span data-stu-id="1202b-196">Merge Agent command line: **-PublisherLogin** and **-PublisherPassword**.</span></span>|  
  
## <a name="f-connection-to-the-distributor"></a><span data-ttu-id="1202b-197">F.</span><span class="sxs-lookup"><span data-stu-id="1202b-197">F.</span></span> <span data-ttu-id="1202b-198">連接散發者</span><span class="sxs-lookup"><span data-stu-id="1202b-198">Connection to the Distributor</span></span>  
 <span data-ttu-id="1202b-199">在執行 IIS 的電腦上主控的合併式複寫重新調整器，也會建立散發者連接。</span><span class="sxs-lookup"><span data-stu-id="1202b-199">The Merge Replication Reconciler that is hosted on the computer that is running IIS also makes connections to the Distributor.</span></span> <span data-ttu-id="1202b-200">合併式複寫重新調整器會利用 Windows 驗證或 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 驗證來連接散發者。</span><span class="sxs-lookup"><span data-stu-id="1202b-200">The Merge Replication Reconciler connects to the Distributor by using either Windows Authentication or [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication.</span></span> <span data-ttu-id="1202b-201">您指定的 Windows 使用者或 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 登入必須符合下列條件：</span><span class="sxs-lookup"><span data-stu-id="1202b-201">The Windows user or [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login that you specify must comply with the following:</span></span>  
  
-   <span data-ttu-id="1202b-202">在發行集存取清單 (PAL) 中。</span><span class="sxs-lookup"><span data-stu-id="1202b-202">Be in the publication access (PAL).</span></span> <span data-ttu-id="1202b-203">如需詳細資訊，請參閱[保護發行者](secure-the-publisher.md)。</span><span class="sxs-lookup"><span data-stu-id="1202b-203">For more information, see [Secure the Publisher](secure-the-publisher.md).</span></span>  
  
-   <span data-ttu-id="1202b-204">與散發資料庫中的資料庫使用者相關聯。</span><span class="sxs-lookup"><span data-stu-id="1202b-204">Be associated with a database user in the distribution database.</span></span> <span data-ttu-id="1202b-205">使用者可以是 `Guest` 使用者。</span><span class="sxs-lookup"><span data-stu-id="1202b-205">The user can be the `Guest` user.</span></span>  
  
 <span data-ttu-id="1202b-206">快照集共用通常是在散發者上。</span><span class="sxs-lookup"><span data-stu-id="1202b-206">The snapshot share is typically on the Distributor.</span></span> <span data-ttu-id="1202b-207">如需有關快照集共用的詳細資訊，請參閱本主題後段的</span><span class="sxs-lookup"><span data-stu-id="1202b-207">For more information about snapshot shares, see the section "H.</span></span> <span data-ttu-id="1202b-208">＜H. 存取快照集共用＞一節。</span><span class="sxs-lookup"><span data-stu-id="1202b-208">Access to the snapshot share" later in this topic.</span></span>  
  
|<span data-ttu-id="1202b-209">驗證類型</span><span class="sxs-lookup"><span data-stu-id="1202b-209">Type of authentication</span></span>|<span data-ttu-id="1202b-210">指定驗證的位置</span><span class="sxs-lookup"><span data-stu-id="1202b-210">Where the authentication is specified</span></span>|  
|----------------------------|-------------------------------------------|  
|<span data-ttu-id="1202b-211">如果指定下列其中一項，則使用 Windows 驗證：</span><span class="sxs-lookup"><span data-stu-id="1202b-211">Windows Authentication is used if one of the following is specified:</span></span><br /><br /> [!INCLUDE[tsql](../../../includes/tsql-md.md)]<span data-ttu-id="1202b-212">： [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)之\*\* \@ distributor_security_mode**參數的**1\*\*值。</span><span class="sxs-lookup"><span data-stu-id="1202b-212">: a value of **1** for the **\@distributor_security_mode** parameter of [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql).</span></span><br /><br /> <span data-ttu-id="1202b-213">RMO：<xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> 的 <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.DistributorSecurityMode%2A> 值。</span><span class="sxs-lookup"><span data-stu-id="1202b-213">RMO: a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> for <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.DistributorSecurityMode%2A>.</span></span><br /><br /> <span data-ttu-id="1202b-214">合併代理程式命令列： **-DistributorSecurityMode**的**1**值。</span><span class="sxs-lookup"><span data-stu-id="1202b-214">Merge Agent command line: a value of **1** for **-DistributorSecurityMode**.</span></span>|<span data-ttu-id="1202b-215">合併代理程式會在針對 IIS 連接 (D) 指定之 Windows 使用者的內容下建立散發者連接。</span><span class="sxs-lookup"><span data-stu-id="1202b-215">The Merge Agent makes connections to the Distributor under the context of the Windows user that is specified for the connection to IIS (D).</span></span> <span data-ttu-id="1202b-216">如果散發者和 IIS 在不同的電腦上，且整合式驗證是用於連接 (D)，則必須在執行 IIS 的電腦上啟用 Kerberos 委派。</span><span class="sxs-lookup"><span data-stu-id="1202b-216">If the Distributor and IIS are on different computers and Integrated Authentication is used for the connection (D), you must enable Kerberos delegation on the computer that is running IIS.</span></span> <span data-ttu-id="1202b-217">如需詳細資訊，請參閱 Windows 文件集。</span><span class="sxs-lookup"><span data-stu-id="1202b-217">For more information, see the Windows documentation.</span></span>|  
|<span data-ttu-id="1202b-218">如果指定下列其中一項，則使用[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 驗證：</span><span class="sxs-lookup"><span data-stu-id="1202b-218">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication is used if one of the following is specified:</span></span><br /><br /> [!INCLUDE[tsql](../../../includes/tsql-md.md)]<span data-ttu-id="1202b-219">： [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)之\*\* \@ distributor_security_mode**參數的值為**0\*\* 。</span><span class="sxs-lookup"><span data-stu-id="1202b-219">: a value of **0** for the **\@distributor_security_mode** parameter of [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql).</span></span><br /><br /> <span data-ttu-id="1202b-220">RMO：<xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> 的 <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.DistributorSecurityMode%2A> 值。</span><span class="sxs-lookup"><span data-stu-id="1202b-220">RMO: a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> for <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.DistributorSecurityMode%2A>.</span></span><br /><br /> <span data-ttu-id="1202b-221">合併代理程式命令列： **-DistributorSecurityMode**的值為**0** 。</span><span class="sxs-lookup"><span data-stu-id="1202b-221">Merge Agent command line: a value of **0** for **-DistributorSecurityMode**.</span></span>|[!INCLUDE[tsql](../../../includes/tsql-md.md)]<span data-ttu-id="1202b-222">： [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)的\*\* \@ distributor_login**和** \@ distributor_password\*\*參數。</span><span class="sxs-lookup"><span data-stu-id="1202b-222">: the **\@distributor_login** and **\@distributor_password** parameters of [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql).</span></span><br /><br /> <span data-ttu-id="1202b-223">RMO： <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.DistributorLogin%2A> 和 <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.DistributorPassword%2A>。</span><span class="sxs-lookup"><span data-stu-id="1202b-223">RMO: <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.DistributorLogin%2A> and <xref:Microsoft.SqlServer.Replication.MergeSynchronizationAgent.DistributorPassword%2A></span></span><br /><br /> <span data-ttu-id="1202b-224">「合併代理程式」命令列： **-DistributorLogin** 和 **-DistributorPassword**。</span><span class="sxs-lookup"><span data-stu-id="1202b-224">Merge Agent command line: **-DistributorLogin** and **-DistributorPassword**.</span></span>|  
  
## <a name="g-connection-to-an-ftp-server"></a><span data-ttu-id="1202b-225">G.</span><span class="sxs-lookup"><span data-stu-id="1202b-225">G.</span></span> <span data-ttu-id="1202b-226">連接 FTP 伺服器</span><span class="sxs-lookup"><span data-stu-id="1202b-226">Connection to an FTP Server</span></span>  
 <span data-ttu-id="1202b-227">只有在您要將快照集檔案從 FTP 伺服器 (而不是從 UNC 位置) 下載到執行 IIS 的電腦，然後將快照集套用到訂閱者時，才需要指定此連接的 Windows 使用者。</span><span class="sxs-lookup"><span data-stu-id="1202b-227">Specify a Windows user for this connection only if you will download snapshot files from an FTP server, instead of from a UNC location, to the computer that is running IIS before you apply the snapshot to the Subscriber.</span></span> <span data-ttu-id="1202b-228">如需詳細資訊，請參閱[透過 FTP 傳送快照集](../transfer-snapshots-through-ftp.md)。</span><span class="sxs-lookup"><span data-stu-id="1202b-228">For more information, see [Transfer Snapshots Through FTP](../transfer-snapshots-through-ftp.md).</span></span>  
  
|<span data-ttu-id="1202b-229">驗證類型</span><span class="sxs-lookup"><span data-stu-id="1202b-229">Type of authentication</span></span>|<span data-ttu-id="1202b-230">指定驗證的位置</span><span class="sxs-lookup"><span data-stu-id="1202b-230">Where the authentication is specified</span></span>|  
|----------------------------|-------------------------------------------|  
|<span data-ttu-id="1202b-231">Windows 驗證</span><span class="sxs-lookup"><span data-stu-id="1202b-231">Windows Authentication</span></span>|[!INCLUDE[tsql](../../../includes/tsql-md.md)]<span data-ttu-id="1202b-232">： [sp_addmergepublication](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql)的\*\* \@ ftp_login**和** \@ ftp_password\*\*參數。</span><span class="sxs-lookup"><span data-stu-id="1202b-232">: the **\@ftp_login** and **\@ftp_password** parameters of [sp_addmergepublication](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql).</span></span><br /><br /> <span data-ttu-id="1202b-233">RMO： <xref:Microsoft.SqlServer.Replication.Publication.FtpLogin%2A> 和 <xref:Microsoft.SqlServer.Replication.Publication.FtpPassword%2A>。</span><span class="sxs-lookup"><span data-stu-id="1202b-233">RMO: <xref:Microsoft.SqlServer.Replication.Publication.FtpLogin%2A> and <xref:Microsoft.SqlServer.Replication.Publication.FtpPassword%2A>.</span></span>|  
  
## <a name="h-access-to-the-snapshot-share"></a><span data-ttu-id="1202b-234">H.</span><span class="sxs-lookup"><span data-stu-id="1202b-234">H.</span></span> <span data-ttu-id="1202b-235">存取快照集共用</span><span class="sxs-lookup"><span data-stu-id="1202b-235">Access to the Snapshot Share</span></span>  
 <span data-ttu-id="1202b-236">快照集共用是由在執行 IIS 的電腦上主控的合併式複寫重新調整器存取。</span><span class="sxs-lookup"><span data-stu-id="1202b-236">The snapshot share is accessed by the Merge Replication Reconciler that is hosted on the computer that is running IIS.</span></span>  
  
|<span data-ttu-id="1202b-237">驗證類型</span><span class="sxs-lookup"><span data-stu-id="1202b-237">Type of authentication</span></span>|<span data-ttu-id="1202b-238">指定驗證的位置</span><span class="sxs-lookup"><span data-stu-id="1202b-238">Where the authentication is specified</span></span>|  
|----------------------------|-------------------------------------------|  
|<span data-ttu-id="1202b-239">Windows 驗證</span><span class="sxs-lookup"><span data-stu-id="1202b-239">Windows Authentication</span></span>|<span data-ttu-id="1202b-240">合併代理程式會在針對 IIS 連接 (D) 指定之 Windows 使用者的內容下存取快照集共用。</span><span class="sxs-lookup"><span data-stu-id="1202b-240">The Merge Agent accesses the snapshot share under the context of the Windows user that is specified for the connection to IIS (D).</span></span> <span data-ttu-id="1202b-241">如果快照集共用和 IIS 在不同的電腦上，且整合式驗證是用於連接 (D)，則必須在執行 IIS 的電腦上啟用 Kerberos 委派。</span><span class="sxs-lookup"><span data-stu-id="1202b-241">If the snapshot share and IIS are on different computers and Integrated Authentication is used for the connection (D), you must enable Kerberos delegation on the computer that is running IIS.</span></span> <span data-ttu-id="1202b-242">如需詳細資訊，請參閱 Windows 文件集。</span><span class="sxs-lookup"><span data-stu-id="1202b-242">For more information, see the Windows documentation.</span></span>|  
  
## <a name="i-application-pool-account-for-iis"></a><span data-ttu-id="1202b-243">I.</span><span class="sxs-lookup"><span data-stu-id="1202b-243">I.</span></span> <span data-ttu-id="1202b-244">IIS 的應用程式集區帳戶</span><span class="sxs-lookup"><span data-stu-id="1202b-244">Application Pool Account for IIS</span></span>  
 <span data-ttu-id="1202b-245">此帳戶是用來啟動執行 IIS for [!INCLUDE[winxpsvr](../../../includes/winxpsvr-md.md)] 之電腦上的 W3wp.exe 處理序，或啟動 [!INCLUDE[win2kfamily](../../../includes/win2kfamily-md.md)]上的 Dllhost.exe 處理序。</span><span class="sxs-lookup"><span data-stu-id="1202b-245">This account is used to start the W3wp.exe process on the computer that is running IIS for [!INCLUDE[winxpsvr](../../../includes/winxpsvr-md.md)] or the Dllhost.exe process on [!INCLUDE[win2kfamily](../../../includes/win2kfamily-md.md)].</span></span> <span data-ttu-id="1202b-246">這些處理序主控執行 IIS 之電腦上的應用程式，例如： [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Replication Listener 和合併式複寫重新調整器。</span><span class="sxs-lookup"><span data-stu-id="1202b-246">These processes host applications on the computer that is running IIS, such as the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Replication Listener and Merge Replication Reconciler.</span></span> <span data-ttu-id="1202b-247">此帳戶應該擁有對執行 IIS 之電腦上對於下列複寫 DLL 的讀取和執行權限：</span><span class="sxs-lookup"><span data-stu-id="1202b-247">This account should have read and execute permissions on the following replication DLLs on the computer that is running IIS:</span></span>  
  
-   <span data-ttu-id="1202b-248">Replisapi</span><span class="sxs-lookup"><span data-stu-id="1202b-248">Replisapi</span></span>  
  
-   <span data-ttu-id="1202b-249">Replrec</span><span class="sxs-lookup"><span data-stu-id="1202b-249">Replrec</span></span>  
  
-   <span data-ttu-id="1202b-250">Replprov</span><span class="sxs-lookup"><span data-stu-id="1202b-250">Replprov</span></span>  
  
-   <span data-ttu-id="1202b-251">Msgprox</span><span class="sxs-lookup"><span data-stu-id="1202b-251">Msgprox</span></span>  
  
-   <span data-ttu-id="1202b-252">Xmlsub</span><span class="sxs-lookup"><span data-stu-id="1202b-252">Xmlsub</span></span>  
  
 <span data-ttu-id="1202b-253">此帳戶也應該是 IIS_WPG 群組的一部分。</span><span class="sxs-lookup"><span data-stu-id="1202b-253">The account should also be part of IIS_WPG group.</span></span> <span data-ttu-id="1202b-254">如需詳細資訊，請參閱[針對 Web 同步處理設定 IIS](../configure-iis-for-web-synchronization.md)中的＜設定 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Replication Listener 的權限＞一節。</span><span class="sxs-lookup"><span data-stu-id="1202b-254">For more information, see the section "Setting Permissions for the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Replication Listener" in [Configure IIS for Web Synchronization](../configure-iis-for-web-synchronization.md).</span></span>  
  
|<span data-ttu-id="1202b-255">帳戶類型</span><span class="sxs-lookup"><span data-stu-id="1202b-255">Type of account</span></span>|<span data-ttu-id="1202b-256">指定帳戶的位置</span><span class="sxs-lookup"><span data-stu-id="1202b-256">Where the account is specified</span></span>|  
|---------------------|------------------------------------|  
|<span data-ttu-id="1202b-257">任何擁有所需權限的 Windows 使用者。</span><span class="sxs-lookup"><span data-stu-id="1202b-257">Any Windows user that has the required permissions.</span></span>|<span data-ttu-id="1202b-258">Internet Information Services (IIS) 管理員。</span><span class="sxs-lookup"><span data-stu-id="1202b-258">Internet Information Services (IIS) Manager.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="1202b-259">另請參閱</span><span class="sxs-lookup"><span data-stu-id="1202b-259">See Also</span></span>  
 <span data-ttu-id="1202b-260">[Configure Web Synchronization](../configure-web-synchronization.md) </span><span class="sxs-lookup"><span data-stu-id="1202b-260">[Configure Web Synchronization](../configure-web-synchronization.md) </span></span>  
 [<span data-ttu-id="1202b-261">Replication Merge Agent</span><span class="sxs-lookup"><span data-stu-id="1202b-261">Replication Merge Agent</span></span>](../agents/replication-merge-agent.md)  
  
  
