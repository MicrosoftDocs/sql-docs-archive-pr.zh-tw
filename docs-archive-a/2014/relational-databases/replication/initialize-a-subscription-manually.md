---
title: 手動初始化訂閱 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- manual subscription initialization [SQL Server replication]
- subscriptions [SQL Server replication], initializing
- initializing subscriptions [SQL Server replication], without snapshots
ms.assetid: 27a1bc38-e498-4fff-8082-04b52aa4b22c
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 4eaeb50da9e4b71a08ec78614ae62ea33e3dc0d1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87585827"
---
# <a name="initialize-a-subscription-manually"></a><span data-ttu-id="013f3-102">手動初始化訂閱</span><span class="sxs-lookup"><span data-stu-id="013f3-102">Initialize a Subscription Manually</span></span>
  <span data-ttu-id="013f3-103">本主題描述如何使用 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 或 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] ，在 [!INCLUDE[tsql](../../includes/tsql-md.md)]中手動初始化訂閱。</span><span class="sxs-lookup"><span data-stu-id="013f3-103">This topic describes how to initialize a subscription manually in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../includes/tsql-md.md)].</span></span> <span data-ttu-id="013f3-104">當正常使用初始快照集來初始化訂閱時，可以不使用快照集來初始化發行集的訂閱，但前提是訂閱者上已經有結構描述和初始資料。</span><span class="sxs-lookup"><span data-stu-id="013f3-104">While the initial snapshot is normally used to initialize a subscription, subscriptions to publications can be initialized without using a snapshot, provided that the schema and initial data are already present at the subscriber.</span></span>  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="013f3-105">開始之前</span><span class="sxs-lookup"><span data-stu-id="013f3-105">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="013f3-106">限制事項</span><span class="sxs-lookup"><span data-stu-id="013f3-106">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="013f3-107">例如，若在複製資料和結構描述到訂閱者的時間，與手動初始化訂閱的時間之間，使用異動複寫發行的資料庫上有活動，則此活動所導致的變更可能不會複寫到訂閱者。</span><span class="sxs-lookup"><span data-stu-id="013f3-107">If there is activity on a database published using transactional replication between the time data and schema are copied to the Subscriber and the time at which the subscription is manually initialized, changes resulting from this activity might not be replicated to the Subscriber.</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="013f3-108">使用 SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="013f3-108">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="013f3-109">透過將結構描述 (通常是資料) 複製到訂閱資料庫的方式，手動初始化發行集的訂閱。</span><span class="sxs-lookup"><span data-stu-id="013f3-109">Initialize a subscription to a publication manually by copying the schema (and typically data) to the subscription database.</span></span> <span data-ttu-id="013f3-110">結構描述和資料應與發行集資料庫相符。</span><span class="sxs-lookup"><span data-stu-id="013f3-110">The schema and data should match the publication database.</span></span> <span data-ttu-id="013f3-111">然後在「新增訂閱精靈」的 **[初始化訂閱]** 頁面中指定訂閱不需要結構描述和資料。</span><span class="sxs-lookup"><span data-stu-id="013f3-111">Then specify that the subscription does not require schema and data on the **Initialize Subscriptions** page of the New Subscription Wizard.</span></span> <span data-ttu-id="013f3-112">如需有關存取這個精靈的詳細資訊，請參閱＜ [不使用快照集初始化交易式訂閱](initialize-a-transactional-subscription-without-a-snapshot.md) ＞與＜ [建立提取訂閱](create-a-pull-subscription.md)中手動初始化訂閱。</span><span class="sxs-lookup"><span data-stu-id="013f3-112">For more information about accessing this wizard, see [Initialize a Transactional Subscription Without a Snapshot](initialize-a-transactional-subscription-without-a-snapshot.md) and [Create a Pull Subscription](create-a-pull-subscription.md).</span></span>  
  
 <span data-ttu-id="013f3-113">您初次同步處理訂閱時，會將複寫所需的物件和中繼資料複製到訂閱資料庫。</span><span class="sxs-lookup"><span data-stu-id="013f3-113">When you synchronize the subscription for the first time, the objects and metadata required by replication are copied to the subscription database.</span></span>  
  
#### <a name="to-initialize-a-subscription-to-a-publication-manually"></a><span data-ttu-id="013f3-114">若要手動初始化發行集的訂閱</span><span class="sxs-lookup"><span data-stu-id="013f3-114">To initialize a subscription to a publication manually</span></span>  
  
1.  <span data-ttu-id="013f3-115">確定將結構描述和資料複製到訂閱資料庫。</span><span class="sxs-lookup"><span data-stu-id="013f3-115">Ensure that the schema and data are copied to the subscription database.</span></span>  
  
2.  <span data-ttu-id="013f3-116">清除「新增訂閱精靈」 **[初始化訂閱]** 頁面中的 **[初始化]** 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="013f3-116">Clear the **Initialize** check box on the **Initialize Subscriptions** page of the New Subscription Wizard.</span></span> <span data-ttu-id="013f3-117">只有複製複寫物件和中繼資料時，才需要對每個訂閱執行此操作。</span><span class="sxs-lookup"><span data-stu-id="013f3-117">Do this for each subscription that requires only replication objects and metadata to be copied.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="013f3-118">使用 Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="013f3-118">Using Transact-SQL</span></span>  
 <span data-ttu-id="013f3-119">可以使用複寫預存程序來手動初始化訂閱。</span><span class="sxs-lookup"><span data-stu-id="013f3-119">Subscriptions can be initialized manually using replication stored procedures.</span></span>  
  
#### <a name="to-manually-initialize-a-pull-subscription-to-a-transactional-publication"></a><span data-ttu-id="013f3-120">手動初始化交易式發行集的提取訂閱</span><span class="sxs-lookup"><span data-stu-id="013f3-120">To manually initialize a pull subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="013f3-121">確定訂閱資料庫上有結構描述和資料存在。</span><span class="sxs-lookup"><span data-stu-id="013f3-121">Ensure that the schema and data exist on the subscription database.</span></span> <span data-ttu-id="013f3-122">如需詳細資訊，請參閱 [不使用快照集初始化交易式訂閱](initialize-a-transactional-subscription-without-a-snapshot.md)中手動初始化訂閱。</span><span class="sxs-lookup"><span data-stu-id="013f3-122">For more information, see [Initialize a Transactional Subscription Without a Snapshot](initialize-a-transactional-subscription-without-a-snapshot.md).</span></span>  
  
2.  <span data-ttu-id="013f3-123">在發行集資料庫的「發行者」上，執行 [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="013f3-123">At the Publisher on the publication database, execute [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="013f3-124">指定 **@publication** 、 **@subscriber** 、在訂閱者上包含已發行資料的資料庫名稱、的 **@destination_db** **提取**值 **@subscription_type** ，以及僅適用于的複寫**支援**值 **@sync_type** 。</span><span class="sxs-lookup"><span data-stu-id="013f3-124">Specify **@publication**, **@subscriber**, the name of the database at the Subscriber containing the published data for **@destination_db**, a value of **pull** for **@subscription_type**, and a value of **replication support only** for **@sync_type**.</span></span> <span data-ttu-id="013f3-125">如需詳細資訊，請參閱 [建立提取訂閱](create-a-pull-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="013f3-125">For more information, see [Create a Pull Subscription](create-a-pull-subscription.md).</span></span>  
  
3.  <span data-ttu-id="013f3-126">在訂閱者上，執行 [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="013f3-126">At the Subscriber, execute [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span></span> <span data-ttu-id="013f3-127">如需更新訂閱，請參閱＜ [Create an Updatable Subscription to a Transactional Publication](publish/create-an-updatable-subscription-to-a-transactional-publication.md)＞。</span><span class="sxs-lookup"><span data-stu-id="013f3-127">For updating subscriptions, see [Create an Updatable Subscription to a Transactional Publication](publish/create-an-updatable-subscription-to-a-transactional-publication.md).</span></span>  
  
4.  <span data-ttu-id="013f3-128">在訂閱者上，執行 [sp_addpullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="013f3-128">At the Subscriber, execute [sp_addpullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql).</span></span> <span data-ttu-id="013f3-129">如需詳細資訊，請參閱 [建立提取訂閱](create-a-pull-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="013f3-129">For more information, see [Create a Pull Subscription](create-a-pull-subscription.md).</span></span>  
  
5.  <span data-ttu-id="013f3-130">啟動散發代理程式，以傳送複寫物件以及從發行者下載最新的變更。</span><span class="sxs-lookup"><span data-stu-id="013f3-130">Start the Distribution Agent to transfer replication objects and download the latest changes from the Publisher.</span></span> <span data-ttu-id="013f3-131">如需相關資訊，請參閱 [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="013f3-131">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-manually-initialize-a-push-subscription-to-a-transactional-publication"></a><span data-ttu-id="013f3-132">手動初始化交易式發行集的發送訂閱</span><span class="sxs-lookup"><span data-stu-id="013f3-132">To manually initialize a push subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="013f3-133">確定訂閱資料庫上有結構描述和資料存在。</span><span class="sxs-lookup"><span data-stu-id="013f3-133">Ensure that the schema and data exist on the subscription database.</span></span> <span data-ttu-id="013f3-134">如需詳細資訊，請參閱 [不使用快照集初始化交易式訂閱](initialize-a-transactional-subscription-without-a-snapshot.md)中手動初始化訂閱。</span><span class="sxs-lookup"><span data-stu-id="013f3-134">For more information, see [Initialize a Transactional Subscription Without a Snapshot](initialize-a-transactional-subscription-without-a-snapshot.md).</span></span>  
  
2.  <span data-ttu-id="013f3-135">在發行集資料庫的「發行者」上，執行 [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="013f3-135">At the Publisher on the publication database, execute [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="013f3-136">在訂閱者上，指定包含已發行資料的資料庫名稱 **@destination_db** 、的**push**值 **@subscription_type** ，以及**僅**適用于的複寫支援值 **@sync_type** 。</span><span class="sxs-lookup"><span data-stu-id="013f3-136">Specify the name of the database at the Subscriber containing the published data for **@destination_db**, a value of **push** for **@subscription_type**, and a value of **replication support only** for **@sync_type**.</span></span> <span data-ttu-id="013f3-137">如需更新訂閱，請參閱＜ [Create an Updatable Subscription to a Transactional Publication](publish/create-an-updatable-subscription-to-a-transactional-publication.md)＞。</span><span class="sxs-lookup"><span data-stu-id="013f3-137">For updating subscriptions, see [Create an Updatable Subscription to a Transactional Publication](publish/create-an-updatable-subscription-to-a-transactional-publication.md).</span></span>  
  
3.  <span data-ttu-id="013f3-138">在發行集資料庫的「發行者」上，執行 [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="013f3-138">At the Publisher on the publication database, execute [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql).</span></span> <span data-ttu-id="013f3-139">如需詳細資訊，請參閱 [建立發送訂閱](create-a-push-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="013f3-139">For more information, see [Create a Push Subscription](create-a-push-subscription.md).</span></span>  
  
4.  <span data-ttu-id="013f3-140">啟動散發代理程式，以傳送複寫物件以及從發行者下載最新的變更。</span><span class="sxs-lookup"><span data-stu-id="013f3-140">Start the Distribution Agent to transfer replication objects and download the latest changes from the Publisher.</span></span> <span data-ttu-id="013f3-141">如需詳細資訊，請參閱 [同步處理發送訂閱](synchronize-a-push-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="013f3-141">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
#### <a name="to-manually-initialize-a-pull-subscription-to-a-merge-publication"></a><span data-ttu-id="013f3-142">手動初始化合併式發行集的提取訂閱</span><span class="sxs-lookup"><span data-stu-id="013f3-142">To manually initialize a pull subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="013f3-143">確定訂閱資料庫上有結構描述和資料存在。</span><span class="sxs-lookup"><span data-stu-id="013f3-143">Ensure that the schema and data exist on the subscription database.</span></span> <span data-ttu-id="013f3-144">這項處理可以藉由在訂閱者上還原發行集資料庫的備份來完成。</span><span class="sxs-lookup"><span data-stu-id="013f3-144">This can be done by restoring a backup of the publication database at the Subscriber.</span></span>  
  
2.  <span data-ttu-id="013f3-145">在發行者上，執行 [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="013f3-145">At the Publisher, execute [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span></span> <span data-ttu-id="013f3-146">指定 **@publication** 、 **@subscriber** 、 **@subscriber_db** 和的**pull**值 **@subscription_type** 。</span><span class="sxs-lookup"><span data-stu-id="013f3-146">Specify **@publication**, **@subscriber**, **@subscriber_db**, and a value of **pull** for **@subscription_type**.</span></span> <span data-ttu-id="013f3-147">如此會註冊提取訂閱。</span><span class="sxs-lookup"><span data-stu-id="013f3-147">This registers the pull subscription.</span></span>  
  
3.  <span data-ttu-id="013f3-148">在包含已發行資料之資料庫的訂閱者上，執行 [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="013f3-148">At the Subscriber on the database containing the published data, execute [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span></span> <span data-ttu-id="013f3-149">針對 **@sync_type** 指定 **@sync_type**中手動初始化訂閱。</span><span class="sxs-lookup"><span data-stu-id="013f3-149">Specify a value of **none** for **@sync_type**.</span></span>  
  
4.  <span data-ttu-id="013f3-150">在訂閱者上，執行 [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="013f3-150">At the Subscriber, execute [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql).</span></span> <span data-ttu-id="013f3-151">如需詳細資訊，請參閱 [建立提取訂閱](create-a-pull-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="013f3-151">For more information, see [Create a Pull Subscription](create-a-pull-subscription.md).</span></span>  
  
5.  <span data-ttu-id="013f3-152">啟動合併代理程式，以傳送複寫物件以及從發行者下載最新的變更。</span><span class="sxs-lookup"><span data-stu-id="013f3-152">Start the Merge Agent to transfer replication objects and download the latest changes from the Publisher.</span></span> <span data-ttu-id="013f3-153">如需相關資訊，請參閱 [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="013f3-153">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-manually-initialize-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="013f3-154">手動初始化合併式發行集的發送訂閱</span><span class="sxs-lookup"><span data-stu-id="013f3-154">To manually initialize a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="013f3-155">確定訂閱資料庫上有結構描述和資料存在。</span><span class="sxs-lookup"><span data-stu-id="013f3-155">Ensure that the schema and data exist on the subscription database.</span></span> <span data-ttu-id="013f3-156">這項處理可以藉由在訂閱者上還原發行集資料庫的備份來完成。</span><span class="sxs-lookup"><span data-stu-id="013f3-156">This can be done by restoring a backup of the publication database at the Subscriber.</span></span>  
  
2.  <span data-ttu-id="013f3-157">在發行集資料庫的發行者上，執行 [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="013f3-157">At the Publisher on the publication database, execute [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span></span> <span data-ttu-id="013f3-158">在訂閱者上，指定包含已發行資料的資料庫名稱 **@subscriber_db** 、的**push**值 **@subscription_type** ，以及的**none**值 **@sync_type** 。</span><span class="sxs-lookup"><span data-stu-id="013f3-158">Specify the name of the database at the Subscriber containing the published data for **@subscriber_db**, a value of **push** for **@subscription_type**, and a value of **none** for **@sync_type**.</span></span>  
  
3.  <span data-ttu-id="013f3-159">在發行集資料庫的「發行者」上，執行 [sp_addmergepushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="013f3-159">At the Publisher on the publication database, execute [sp_addmergepushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql).</span></span> <span data-ttu-id="013f3-160">如需詳細資訊，請參閱 [建立發送訂閱](create-a-push-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="013f3-160">For more information, see [Create a Push Subscription](create-a-push-subscription.md).</span></span>  
  
4.  <span data-ttu-id="013f3-161">啟動合併代理程式，以傳送複寫物件以及從發行者下載最新的變更。</span><span class="sxs-lookup"><span data-stu-id="013f3-161">Start the Merge Agent to transfer replication objects and download the latest changes from the Publisher.</span></span> <span data-ttu-id="013f3-162">如需詳細資訊，請參閱 [同步處理發送訂閱](synchronize-a-push-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="013f3-162">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="013f3-163">另請參閱</span><span class="sxs-lookup"><span data-stu-id="013f3-163">See Also</span></span>  
 <span data-ttu-id="013f3-164">[不使用快照集初始化交易式訂閱](initialize-a-transactional-subscription-without-a-snapshot.md) </span><span class="sxs-lookup"><span data-stu-id="013f3-164">[Initialize a Transactional Subscription Without a Snapshot](initialize-a-transactional-subscription-without-a-snapshot.md) </span></span>  
 <span data-ttu-id="013f3-165">[備份及還原複寫的資料庫](administration/back-up-and-restore-replicated-databases.md) </span><span class="sxs-lookup"><span data-stu-id="013f3-165">[Back Up and Restore Replicated Databases](administration/back-up-and-restore-replicated-databases.md) </span></span>  
 [<span data-ttu-id="013f3-166">複寫安全性最佳作法</span><span class="sxs-lookup"><span data-stu-id="013f3-166">Replication Security Best Practices</span></span>](security/replication-security-best-practices.md)  
  
  
