---
title: 升級複寫指令碼 (複寫 Transact-SQL 程式設計) | Microsoft 文件
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- scripts [SQL Server replication], upgrading
- upgrading SQL Server, replicated databases
- upgrading replication applications
- replication [SQL Server], scripting
- replication [SQL Server], upgrading
- upgrading replicated databases
ms.assetid: 0b8720bd-f339-4842-bc8f-b35a46f6d3ee
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c47101c76ca2c585accd493b74f0e59c56bf009e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87593967"
---
# <a name="upgrade-replication-scripts-replication-transact-sql-programming"></a><span data-ttu-id="624ba-102">升級複寫指令碼 (複寫 Transact-SQL 程式設計)</span><span class="sxs-lookup"><span data-stu-id="624ba-102">Upgrade Replication Scripts (Replication Transact-SQL Programming)</span></span>
  [!INCLUDE[tsql](../../../includes/tsql-md.md)] <span data-ttu-id="624ba-103">指令碼檔案可以用於以程式設計的方式設定複寫拓撲。</span><span class="sxs-lookup"><span data-stu-id="624ba-103">script files can be used to programmatically configure a replication topology.</span></span> <span data-ttu-id="624ba-104">如需詳細資訊，請參閱[複寫系統預存程序概念](../concepts/replication-system-stored-procedures-concepts.md)。</span><span class="sxs-lookup"><span data-stu-id="624ba-104">For more information, see [Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="624ba-105">雖然並不一定要升級由 `sysadmin` 角色的成員所執行的指令碼，但建議您依照本主題所述修改現有的指令碼。</span><span class="sxs-lookup"><span data-stu-id="624ba-105">Although you are not required to upgrade scripts that are executed by members of the `sysadmin` role, we recommend that you modify existing scripts as described in this topic.</span></span> <span data-ttu-id="624ba-106">請根據主題＜ [Replication Agent Security Model](../security/replication-agent-security-model.md)＞的「代理程式所需的權限」一節所述，為每個複寫代理程式指定具有最小權限的帳戶。</span><span class="sxs-lookup"><span data-stu-id="624ba-106">Specify an account that has minimum permissions for each replication agent as described in the "Permissions Required By Agents" section of the topic [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
 <span data-ttu-id="624ba-107">這些安全性改進會影響現有指令碼中的下列預存程序，讓您可以明確地指定 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows 帳戶，並在這些帳戶下執行複寫代理程式工作，對權限可以有更多的控制：</span><span class="sxs-lookup"><span data-stu-id="624ba-107">These security improvements, which enable more control over permissions by allowing you to explicitly specify the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows accounts under which replication agent jobs are executed, affect the following stored procedures in existing scripts:</span></span>  
  
-   <span data-ttu-id="624ba-108">**sp_addpublication_snapshot**：</span><span class="sxs-lookup"><span data-stu-id="624ba-108">**sp_addpublication_snapshot**:</span></span>  
  
     <span data-ttu-id="624ba-109">您現在應該提供 Windows 認證做為 **@job_login** ，並 **@job_password** 在執行[sp_addpublication_snapshot &#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) ，以建立快照集代理程式在散發者端執行時所用的作業。</span><span class="sxs-lookup"><span data-stu-id="624ba-109">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) to create the job under which the Snapshot Agent runs at the Distributor.</span></span>  
  
-   <span data-ttu-id="624ba-110">**sp_addpushsubscription_agent**：</span><span class="sxs-lookup"><span data-stu-id="624ba-110">**sp_addpushsubscription_agent**:</span></span>  
  
     <span data-ttu-id="624ba-111">現在應該執行 [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) 以明確地新增作業並提供 Windows 認證 (**@job_login** 和 **@job_password**)，藉此在散發者端執行散發代理程式作業。</span><span class="sxs-lookup"><span data-stu-id="624ba-111">You should now execute [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) to explicitly add a job and supply the Windows credentials (**@job_login** and **@job_password**) under which the Distribution Agent job runs at the Distributor.</span></span> <span data-ttu-id="624ba-112">在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 之前的 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]版本中，這項作業會在建立發送訂閱時自動完成。</span><span class="sxs-lookup"><span data-stu-id="624ba-112">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a push subscription was created.</span></span>  
  
-   <span data-ttu-id="624ba-113">**sp_addmergepushsubscription_agent**：</span><span class="sxs-lookup"><span data-stu-id="624ba-113">**sp_addmergepushsubscription_agent**:</span></span>  
  
     <span data-ttu-id="624ba-114">現在應該執行 [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) 以明確地新增作業並提供 Windows 認證 (**@job_login** 和 **@job_password**)，藉此在散發者端執行合併代理程式作業。</span><span class="sxs-lookup"><span data-stu-id="624ba-114">You should now execute [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) to explicitly add a job and supply the Windows credentials (**@job_login** and **@job_password**) under which the Merge Agent job runs at the Distributor.</span></span> <span data-ttu-id="624ba-115">在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 之前的 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]版本中，這項作業會在建立發送訂閱時自動完成。</span><span class="sxs-lookup"><span data-stu-id="624ba-115">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a push subscription was created.</span></span>  
  
-   <span data-ttu-id="624ba-116">**sp_addpullsubscription_agent**：</span><span class="sxs-lookup"><span data-stu-id="624ba-116">**sp_addpullsubscription_agent**:</span></span>  
  
     <span data-ttu-id="624ba-117">您現在應該提供 Windows 認證做為 **@job_login** ，並 **@job_password** 在執行[sp_addpullsubscription_agent &#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) ，以建立在訂閱者端執行散發代理程式的作業。</span><span class="sxs-lookup"><span data-stu-id="624ba-117">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) to create the job under which the Distribution Agent runs at the Subscriber.</span></span>  
  
-   <span data-ttu-id="624ba-118">**sp_addmergepullsubscription_agent**：</span><span class="sxs-lookup"><span data-stu-id="624ba-118">**sp_addmergepullsubscription_agent**:</span></span>  
  
     <span data-ttu-id="624ba-119">您現在應該提供 Windows 認證做為 **@job_login** ，並 **@job_password** 在執行[sp_addmergepullsubscription_agent &#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) ，以建立在訂閱者端執行合併代理程式的作業。</span><span class="sxs-lookup"><span data-stu-id="624ba-119">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) to create the job under which the Merge Agent runs at the Subscriber.</span></span>  
  
-   <span data-ttu-id="624ba-120">**sp_addlogreader_agent**：</span><span class="sxs-lookup"><span data-stu-id="624ba-120">**sp_addlogreader_agent**:</span></span>  
  
     <span data-ttu-id="624ba-121">現在應該執行 [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) 以手動新增作業並提供 Windows 認證，藉此在散發者端執行記錄讀取器代理程式。</span><span class="sxs-lookup"><span data-stu-id="624ba-121">You should now execute [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) to manually add the job and supply the Windows credentials under which the Log Reader Agent runs at the Distributor.</span></span> <span data-ttu-id="624ba-122">在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 之前的 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]版本中，這項作業會在建立交易式發行集時自動完成。</span><span class="sxs-lookup"><span data-stu-id="624ba-122">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a transactional publication was created.</span></span>  
  
-   <span data-ttu-id="624ba-123">**sp_addqreader_agent**：</span><span class="sxs-lookup"><span data-stu-id="624ba-123">**sp_addqreader_agent**:</span></span>  
  
     <span data-ttu-id="624ba-124">現在應該執行 [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) 以手動新增作業並提供 Windows 認證，藉此在散發者端執行佇列讀取器代理程式。</span><span class="sxs-lookup"><span data-stu-id="624ba-124">You should now execute [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) to manually add the job and supply the Windows credentials under which the Queue Reader Agent runs at the Distributor.</span></span> <span data-ttu-id="624ba-125">在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 之前的 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]版本中，這項作業會在建立支援佇列更新的交易式發行集時自動完成。</span><span class="sxs-lookup"><span data-stu-id="624ba-125">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a transactional publication that supported queued updating was created.</span></span>  
  
 <span data-ttu-id="624ba-126">在中導入的安全性模型中 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] ，複寫代理程式一律會 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 使用和中提供的認證，透過 Windows 驗證連接到的本機實例 **@job_name** **@job_password** 。</span><span class="sxs-lookup"><span data-stu-id="624ba-126">In the security model introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], replication agents always make connections to the local instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] with Windows Authentication using the credentials supplied in **@job_name** and **@job_password**.</span></span> <span data-ttu-id="624ba-127">如需有關在執行複寫代理程式作業時所使用 Windows 帳戶之需求的資訊，請參閱＜ [Replication Agent Security Model](../security/replication-agent-security-model.md)＞。</span><span class="sxs-lookup"><span data-stu-id="624ba-127">For information about the requirements of Windows accounts used when running replication agent jobs, see [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="624ba-128">可能的話，會在執行階段提示使用者輸入安全性認證。</span><span class="sxs-lookup"><span data-stu-id="624ba-128">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="624ba-129">如果將認證儲存在指令碼檔案中，請確定該檔案本身受到安全保護。</span><span class="sxs-lookup"><span data-stu-id="624ba-129">If you store credentials in a script file, ensure that the file itself is secured.</span></span>  
  
### <a name="to-upgrade-scripts-that-configure-a-snapshot-or-transactional-publication"></a><span data-ttu-id="624ba-130">若要升級設定快照式或交易式發行集的指令碼</span><span class="sxs-lookup"><span data-stu-id="624ba-130">To upgrade scripts that configure a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="624ba-131">在現有指令碼的 [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) 之前，於發行集資料庫的發行者端執行 [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="624ba-131">In the existing script, before [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="624ba-132">指定用來執行和之記錄讀取器代理程式的 Windows 認證 **@job_name** **@job_password** 。</span><span class="sxs-lookup"><span data-stu-id="624ba-132">Specify the Windows credentials under which the Log Reader Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="624ba-133">如果代理程式 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 在連接到發行者時將使用驗證，您也必須為指定**0**的值， **@publisher_security_mode** 並針對 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 和指定登入資訊 **@publisher_login** **@publisher_password** 。</span><span class="sxs-lookup"><span data-stu-id="624ba-133">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="624ba-134">如此會建立發行集資料庫的「記錄讀取器代理程式」作業。</span><span class="sxs-lookup"><span data-stu-id="624ba-134">This creates a Log Reader Agent job for the publication database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="624ba-135">只有交易式發行集才需要這個步驟，快照式發行集不需要。</span><span class="sxs-lookup"><span data-stu-id="624ba-135">This step is only for transactional publications and is not required for snapshot publications.</span></span>  
  
2.  <span data-ttu-id="624ba-136">(選擇性) 在 [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) 之前，於散發資料庫的散發者端執行 [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="624ba-136">(Optional) Before [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) at the Distributor on the distribution database.</span></span> <span data-ttu-id="624ba-137">指定用來執行和之佇列讀取器代理程式的 Windows 認證 **@job_name** **@job_password** 。</span><span class="sxs-lookup"><span data-stu-id="624ba-137">Specify the Windows credentials under which the Queue Reader Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="624ba-138">如此會為「散發者」建立「佇列讀取器代理程式」作業。</span><span class="sxs-lookup"><span data-stu-id="624ba-138">This creates a Queue Reader Agent job for the Distributor.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="624ba-139">只有支援佇列更新訂閱者的交易式發行集才需要這個步驟。</span><span class="sxs-lookup"><span data-stu-id="624ba-139">This step is only required for transactional publications that support queued updating subscribers.</span></span>  
  
3.  <span data-ttu-id="624ba-140">(選擇性) 更新 [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) 的執行，以針對實作新複寫功能的參數設定預設以外的值。</span><span class="sxs-lookup"><span data-stu-id="624ba-140">(Optional) Update the execution of [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
4.  <span data-ttu-id="624ba-141">在 [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) 之後，於發行集資料庫的發行者端執行 [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="624ba-141">After [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="624ba-142">指定 **@publication** 和用來執行和之快照集代理程式的 Windows 認證 **@job_name** **@job_password** 。</span><span class="sxs-lookup"><span data-stu-id="624ba-142">Specify **@publication** and the Windows credentials under which the Snapshot Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="624ba-143">如果代理程式 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 在連接到發行者時將使用驗證，您也必須為指定**0**的值， **@publisher_security_mode** 並針對 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 和指定登入資訊 **@publisher_login** **@publisher_password** 。</span><span class="sxs-lookup"><span data-stu-id="624ba-143">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="624ba-144">這麼做會為發行集建立快照集代理程式作業。</span><span class="sxs-lookup"><span data-stu-id="624ba-144">This creates a Snapshot Agent job for the publication.</span></span>  
  
5.  <span data-ttu-id="624ba-145">(選擇性) 更新 [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql) 的執行，以針對實作新複寫功能的參數設定預設以外的值。</span><span class="sxs-lookup"><span data-stu-id="624ba-145">(Optional) Update the execution of [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
### <a name="to-upgrade-scripts-that-add-subscriptions-to-a-snapshot-or-transactional-publication"></a><span data-ttu-id="624ba-146">若要升級將訂閱加入至快照式或交易式發行集的指令碼</span><span class="sxs-lookup"><span data-stu-id="624ba-146">To upgrade scripts that add subscriptions to a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="624ba-147">在執行建立訂閱的預存程序之後，請務必執行建立「散發代理程式」作業的預存程序，以同步處理訂閱。</span><span class="sxs-lookup"><span data-stu-id="624ba-147">After executing the stored procedure that creates the subscription, ensure that you execute the stored procedure that creates a Distribution Agent job to synchronize the subscription.</span></span> <span data-ttu-id="624ba-148">您使用的預存程序將依照訂閱類型而定。</span><span class="sxs-lookup"><span data-stu-id="624ba-148">The stored procedure that you use will depend on the type of subscription.</span></span>  
  
    -   <span data-ttu-id="624ba-149">如果是提取訂閱，則請更新 [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) 的執行，以提供 Windows 認證，在訂閱者端執行的散發代理程式會將該認證用於 **@job_name** 和 **@job_password**。</span><span class="sxs-lookup"><span data-stu-id="624ba-149">For a pull subscription, update the execution of [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) to supply the Windows credentials under which the Distribution Agent runs at the Subscriber for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="624ba-150">此項作業會在執行 [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql)之後完成。</span><span class="sxs-lookup"><span data-stu-id="624ba-150">This is done after the execution of [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span></span> <span data-ttu-id="624ba-151">如需詳細資訊，請參閱 [建立提取訂閱](../create-a-pull-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="624ba-151">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>  
  
    -   <span data-ttu-id="624ba-152">如果是發送訂閱，請在發行者端執行 [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="624ba-152">For a push subscription, execute [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) at the Publisher.</span></span> <span data-ttu-id="624ba-153">指定 **@subscriber** 、 **@subscriber_db** 、 **@publication** 、用來在和之散發者端執行散發代理程式的 Windows 認證， **@job_name** **@job_password** 以及此代理程式作業的排程。</span><span class="sxs-lookup"><span data-stu-id="624ba-153">Specify **@subscriber**, **@subscriber_db**, **@publication**, Windows credentials under which the Distribution Agent runs at the Distributor for **@job_name** and **@job_password**, and a schedule for this agent job.</span></span> <span data-ttu-id="624ba-154">如需詳細資訊，請參閱 [Specify Synchronization Schedules](../specify-synchronization-schedules.md)。</span><span class="sxs-lookup"><span data-stu-id="624ba-154">For more information, see [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span></span> <span data-ttu-id="624ba-155">此項作業會在執行 [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)之後完成。</span><span class="sxs-lookup"><span data-stu-id="624ba-155">This is done after the execution of [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="624ba-156">如需詳細資訊，請參閱 [建立發送訂閱](../create-a-push-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="624ba-156">For more information, see [Create a Push Subscription](../create-a-push-subscription.md).</span></span>  
  
### <a name="to-upgrade-scripts-that-configure-a-merge-publication"></a><span data-ttu-id="624ba-157">若要升級設定合併式發行集的指令碼</span><span class="sxs-lookup"><span data-stu-id="624ba-157">To upgrade scripts that configure a merge publication</span></span>  
  
1.  <span data-ttu-id="624ba-158">(選擇性) 在現有的指令碼中，更新 [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql) 的執行，以針對實作新複寫功能的參數設定預設以外的值。</span><span class="sxs-lookup"><span data-stu-id="624ba-158">(Optional) In the existing script, update the execution of [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
2.  <span data-ttu-id="624ba-159">在 [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql) 之後，於發行集資料庫的發行者端執行 [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="624ba-159">After [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql), execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="624ba-160">指定 **@publication** 和用來執行和之快照集代理程式的 Windows 認證 **@job_name** **@job_password** 。</span><span class="sxs-lookup"><span data-stu-id="624ba-160">Specify **@publication** and the Windows credentials under which the Snapshot Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="624ba-161">如果代理程式 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 在連接到發行者時將使用驗證，您也必須為指定**0**的值， **@publisher_security_mode** 並針對 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 和指定登入資訊 **@publisher_login** **@publisher_password** 。</span><span class="sxs-lookup"><span data-stu-id="624ba-161">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="624ba-162">這麼做會為發行集建立快照集代理程式作業。</span><span class="sxs-lookup"><span data-stu-id="624ba-162">This creates a Snapshot Agent job for the publication.</span></span>  
  
3.  <span data-ttu-id="624ba-163">(選擇性) 更新 [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) 的執行，以針對實作新複寫功能的參數設定預設以外的值。</span><span class="sxs-lookup"><span data-stu-id="624ba-163">(Optional) Update the execution of [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
### <a name="to-upgrade-scripts-that-add-subscriptions-to-a-merge-publication"></a><span data-ttu-id="624ba-164">若要升級將訂閱加入至合併式發行集的指令碼</span><span class="sxs-lookup"><span data-stu-id="624ba-164">To upgrade scripts that add subscriptions to a merge publication</span></span>  
  
1.  <span data-ttu-id="624ba-165">在執行建立訂閱的預存程序之後，請務必執行建立「合併代理程式」作業的預存程序，以同步處理訂閱。</span><span class="sxs-lookup"><span data-stu-id="624ba-165">After executing the stored procedure that creates the subscription, ensure that you execute the stored procedure that creates a Merge Agent job to synchronize the subscription.</span></span> <span data-ttu-id="624ba-166">您使用的預存程序將依照訂閱類型而定。</span><span class="sxs-lookup"><span data-stu-id="624ba-166">The stored procedure that you use will depend on the type of subscription.</span></span>  
  
    -   <span data-ttu-id="624ba-167">如果是提取訂閱，則請更新 [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) 的執行，以提供 Windows 認證，在訂閱者端執行的合併代理程式會將該認證用於 **@job_name** 和 **@job_password**。</span><span class="sxs-lookup"><span data-stu-id="624ba-167">For a pull subscription, update the execution of [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) to supply the Windows credentials under which the Merge Agent runs at the Subscriber for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="624ba-168">此項作業會在執行 [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql)之後完成。</span><span class="sxs-lookup"><span data-stu-id="624ba-168">This is done after the execution of [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span></span> <span data-ttu-id="624ba-169">如需詳細資訊，請參閱 [建立提取訂閱](../create-a-pull-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="624ba-169">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>  
  
    -   <span data-ttu-id="624ba-170">如果是發送訂閱，請在發行者端執行 [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="624ba-170">For a push subscription, execute [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) at the Publisher.</span></span> <span data-ttu-id="624ba-171">指定 **@subscriber** 、 **@subscriber_db** 、 **@publication** 、用來執行散發者之合併代理程式的 Windows 認證，以及 **@job_name** **@job_password** 此代理程式作業的排程。</span><span class="sxs-lookup"><span data-stu-id="624ba-171">Specify **@subscriber**, **@subscriber_db**, **@publication**, the Windows credentials under which the Merge Agent at the Distributor runs for **@job_name** and **@job_password**, and a schedule for this agent job.</span></span> <span data-ttu-id="624ba-172">如需詳細資訊，請參閱 [Specify Synchronization Schedules](../specify-synchronization-schedules.md)。</span><span class="sxs-lookup"><span data-stu-id="624ba-172">For more information, see [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span></span> <span data-ttu-id="624ba-173">此項作業會在執行 [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql)之後完成。</span><span class="sxs-lookup"><span data-stu-id="624ba-173">This is done after the execution of [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span></span> <span data-ttu-id="624ba-174">如需詳細資訊，請參閱 [建立發送訂閱](../create-a-push-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="624ba-174">For more information, see [Create a Push Subscription](../create-a-push-subscription.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="624ba-175">範例</span><span class="sxs-lookup"><span data-stu-id="624ba-175">Example</span></span>  
 <span data-ttu-id="624ba-176">下列的 [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] 指令碼範例會針對 Product 資料表建立交易式發行集。</span><span class="sxs-lookup"><span data-stu-id="624ba-176">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a transactional publication for the Product table.</span></span> <span data-ttu-id="624ba-177">此發行集支援立即更新，且使用佇列更新做為容錯移轉。</span><span class="sxs-lookup"><span data-stu-id="624ba-177">This publication supports immediate updating with queued updating as failover.</span></span> <span data-ttu-id="624ba-178">為了利於閱讀，已經移除了預設的參數。</span><span class="sxs-lookup"><span data-stu-id="624ba-178">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpub80.sql#sp_createtranpub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="624ba-179">範例</span><span class="sxs-lookup"><span data-stu-id="624ba-179">Example</span></span>  
 <span data-ttu-id="624ba-180">下列是前述指令碼的升級範例 (此指令碼會建立交易式發行集)，能成功地執行於 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 和更新版本。</span><span class="sxs-lookup"><span data-stu-id="624ba-180">The following is an example of upgrading the previous script, which creates a transactional publication, to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="624ba-181">此發行集支援立即更新，且使用佇列更新做為容錯移轉。</span><span class="sxs-lookup"><span data-stu-id="624ba-181">This publication supports immediate updating with queued updating as failover.</span></span> <span data-ttu-id="624ba-182">已明確地宣告新參數的預設值。</span><span class="sxs-lookup"><span data-stu-id="624ba-182">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="624ba-183"> Windows 認證是在執行階段使用 **sqlcmd** 指令碼變數提供的。</span><span class="sxs-lookup"><span data-stu-id="624ba-183">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpublication.sql#sp_createtranpub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="624ba-184">範例</span><span class="sxs-lookup"><span data-stu-id="624ba-184">Example</span></span>  
 <span data-ttu-id="624ba-185">下列的 [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] 指令碼範例會針對 Customers 資料表建立合併式發行集。</span><span class="sxs-lookup"><span data-stu-id="624ba-185">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a merge publication for the Customers table.</span></span> <span data-ttu-id="624ba-186">為了利於閱讀，已經移除了預設的參數。</span><span class="sxs-lookup"><span data-stu-id="624ba-186">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepub80.sql#sp_createmergepub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="624ba-187">範例</span><span class="sxs-lookup"><span data-stu-id="624ba-187">Example</span></span>  
 <span data-ttu-id="624ba-188">下列是前述指令碼的升級範例 (此指令碼會建立合併式發行集)，能成功地執行於 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 和更新版本。</span><span class="sxs-lookup"><span data-stu-id="624ba-188">The following is an example of the previous script, which creates a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="624ba-189">已明確地宣告新參數的預設值。</span><span class="sxs-lookup"><span data-stu-id="624ba-189">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="624ba-190"> Windows 認證是在執行階段使用 **sqlcmd** 指令碼變數提供的。</span><span class="sxs-lookup"><span data-stu-id="624ba-190">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepublication.sql#sp_createmergepub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="624ba-191">範例</span><span class="sxs-lookup"><span data-stu-id="624ba-191">Example</span></span>  
 <span data-ttu-id="624ba-192">下列的 [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] 指令碼範例會建立交易式發行集的發送訂閱。</span><span class="sxs-lookup"><span data-stu-id="624ba-192">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a push subscription to a transactional publication.</span></span> <span data-ttu-id="624ba-193">為了利於閱讀，已經移除了預設的參數。</span><span class="sxs-lookup"><span data-stu-id="624ba-193">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpushsub80.sql#sp_createtranpushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="624ba-194">範例</span><span class="sxs-lookup"><span data-stu-id="624ba-194">Example</span></span>  
 <span data-ttu-id="624ba-195">下列是前述指令碼的升級範例 (此指令碼會建立交易式發行集的發送訂閱)，能成功地執行於 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 和更新版本。</span><span class="sxs-lookup"><span data-stu-id="624ba-195">The following is an example of the previous script, which creates a push subscription to a transactional publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="624ba-196">已明確地宣告新參數的預設值。</span><span class="sxs-lookup"><span data-stu-id="624ba-196">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="624ba-197"> Windows 認證是在執行階段使用 **sqlcmd** 指令碼變數提供的。</span><span class="sxs-lookup"><span data-stu-id="624ba-197">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpushsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpushsub.sql#sp_createtranpushsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="624ba-198">範例</span><span class="sxs-lookup"><span data-stu-id="624ba-198">Example</span></span>  
 <span data-ttu-id="624ba-199">下列的 [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] 指令碼範例會建立合併式發行集的發送訂閱。</span><span class="sxs-lookup"><span data-stu-id="624ba-199">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a push subscription to a merge publication.</span></span> <span data-ttu-id="624ba-200">為了利於閱讀，已經移除了預設的參數。</span><span class="sxs-lookup"><span data-stu-id="624ba-200">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepushsub80.sql#sp_createmergepushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="624ba-201">範例</span><span class="sxs-lookup"><span data-stu-id="624ba-201">Example</span></span>  
 <span data-ttu-id="624ba-202">下列是前述指令碼的升級範例 (此指令碼會建立合併式發行集的發送訂閱)，能成功地執行於 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 和更新版本。</span><span class="sxs-lookup"><span data-stu-id="624ba-202">The following is an example of the previous script, which creates a push subscription to a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="624ba-203">已明確地宣告新參數的預設值。</span><span class="sxs-lookup"><span data-stu-id="624ba-203">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="624ba-204"> Windows 認證是在執行階段使用 **sqlcmd** 指令碼變數提供的。</span><span class="sxs-lookup"><span data-stu-id="624ba-204">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpushsub.sql#sp_createmergepushsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="624ba-205">範例</span><span class="sxs-lookup"><span data-stu-id="624ba-205">Example</span></span>  
 <span data-ttu-id="624ba-206">下列的 [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] 指令碼範例會建立交易式發行集的提取訂閱。</span><span class="sxs-lookup"><span data-stu-id="624ba-206">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a pull subscription to a transactional publication.</span></span> <span data-ttu-id="624ba-207">為了利於閱讀，已經移除了預設的參數。</span><span class="sxs-lookup"><span data-stu-id="624ba-207">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepushsub80.sql#sp_createmergepushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="624ba-208">範例</span><span class="sxs-lookup"><span data-stu-id="624ba-208">Example</span></span>  
 <span data-ttu-id="624ba-209">下列是前述指令碼的升級範例 (此指令碼會建立交易式發行集的提取訂閱)，能成功地執行於 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 和更新版本。</span><span class="sxs-lookup"><span data-stu-id="624ba-209">The following is an example of the previous script, which creates a pull subscription to a transactional publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="624ba-210">已明確地宣告新參數的預設值。</span><span class="sxs-lookup"><span data-stu-id="624ba-210">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="624ba-211"> Windows 認證是在執行階段使用 **sqlcmd** 指令碼變數提供的。</span><span class="sxs-lookup"><span data-stu-id="624ba-211">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpullsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpullsub.sql#sp_createtranpullsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="624ba-212">範例</span><span class="sxs-lookup"><span data-stu-id="624ba-212">Example</span></span>  
 <span data-ttu-id="624ba-213">下列的 [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] 指令碼範例會建立合併式發行集的提取訂閱。</span><span class="sxs-lookup"><span data-stu-id="624ba-213">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a pull subscription to a merge publication.</span></span> <span data-ttu-id="624ba-214">為了利於閱讀，已經移除了預設的參數。</span><span class="sxs-lookup"><span data-stu-id="624ba-214">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepullsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepullsub80.sql#sp_createmergepullsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="624ba-215">範例</span><span class="sxs-lookup"><span data-stu-id="624ba-215">Example</span></span>  
 <span data-ttu-id="624ba-216">下列是前述指令碼的升級範例 (此指令碼會建立合併式發行集的提取訂閱)，能成功地執行於 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 和更新版本。</span><span class="sxs-lookup"><span data-stu-id="624ba-216">The following is an example of the previous script, which creates a pull subscription to a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="624ba-217">已明確地宣告新參數的預設值。</span><span class="sxs-lookup"><span data-stu-id="624ba-217">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="624ba-218"> Windows 認證是在執行階段使用 **sqlcmd** 指令碼變數提供的。</span><span class="sxs-lookup"><span data-stu-id="624ba-218">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepullsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpullsub.sql#sp_createmergepullsub_nwpostupgrade)]  
  
## <a name="see-also"></a><span data-ttu-id="624ba-219">另請參閱</span><span class="sxs-lookup"><span data-stu-id="624ba-219">See Also</span></span>  
 <span data-ttu-id="624ba-220">[Create a Publication](../publish/create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="624ba-220">[Create a Publication](../publish/create-a-publication.md) </span></span>  
 <span data-ttu-id="624ba-221">[Create a Push Subscription](../create-a-push-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="624ba-221">[Create a Push Subscription](../create-a-push-subscription.md) </span></span>  
 <span data-ttu-id="624ba-222">[Create a Pull Subscription](../create-a-pull-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="624ba-222">[Create a Pull Subscription](../create-a-pull-subscription.md) </span></span>  
 <span data-ttu-id="624ba-223">[檢視及修改複寫安全性設定](../security/view-and-modify-replication-security-settings.md) </span><span class="sxs-lookup"><span data-stu-id="624ba-223">[View and Modify Replication Security Settings](../security/view-and-modify-replication-security-settings.md) </span></span>  
 <span data-ttu-id="624ba-224">[MSSQL_ENG021797](../mssql-eng021797.md) </span><span class="sxs-lookup"><span data-stu-id="624ba-224">[MSSQL_ENG021797](../mssql-eng021797.md) </span></span>  
 <span data-ttu-id="624ba-225">[MSSQL_ENG021798](../mssql-eng021798.md) </span><span class="sxs-lookup"><span data-stu-id="624ba-225">[MSSQL_ENG021798](../mssql-eng021798.md) </span></span>  
 <span data-ttu-id="624ba-226">[Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="624ba-226">[Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="624ba-227">升級複寫的資料庫</span><span class="sxs-lookup"><span data-stu-id="624ba-227">Upgrade Replicated Databases</span></span>](../../../database-engine/install-windows/upgrade-replicated-databases.md)  
  
  
