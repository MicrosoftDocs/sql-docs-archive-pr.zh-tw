---
title: 以 Microsoft COM 為基礎的解析程式 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- COM-based resolvers [SQL Server replication]
- custom resolvers [SQL Server replication]
ms.assetid: a6637e4b-4e6b-40aa-bee6-39d98cc507c8
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: b446c3300b2c8a440a092084f01c55105c9be95e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87702818"
---
# <a name="microsoft-com-based-resolvers"></a><span data-ttu-id="62797-102">Microsoft COM-Based Resolvers</span><span class="sxs-lookup"><span data-stu-id="62797-102">Microsoft COM-Based Resolvers</span></span>
  <span data-ttu-id="62797-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 提供的所有以 COM 為基礎的解決器可處理更新衝突，如有需要，也可以處理插入與刪除衝突。</span><span class="sxs-lookup"><span data-stu-id="62797-103">All of the COM-based resolvers supplied with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] handle update conflicts, and where indicated, they also handle insert and delete conflicts.</span></span> <span data-ttu-id="62797-104">它們都能處理資料行追蹤，大部分還能處理資料列追蹤。</span><span class="sxs-lookup"><span data-stu-id="62797-104">They all handle column tracking; most also handle row tracking.</span></span> <span data-ttu-id="62797-105">這些及所有其他的以 COM 為基礎的解決器都宣告它們所能處理的衝突類型，而「合併代理程式」使用預設解決器來處理其他所有的衝突類型。</span><span class="sxs-lookup"><span data-stu-id="62797-105">These and all other COM-based resolvers declare the types of conflict they can handle, and the Merge Agent uses the default resolver for all other conflict types.</span></span>  
  
 <span data-ttu-id="62797-106">解決器在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]的安裝過程中安裝。</span><span class="sxs-lookup"><span data-stu-id="62797-106">The resolvers are installed during the installation process for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="62797-107">執行 **sp_enumcustomresolvers** 預存程序以檢視電腦中註冊的所有衝突解決器。</span><span class="sxs-lookup"><span data-stu-id="62797-107">Execute the **sp_enumcustomresolvers** stored procedure to view all the conflict resolvers registered on a computer.</span></span> <span data-ttu-id="62797-108">執行該程序，可顯示個別結果集中各解決器的描述和全域唯一識別碼 (GUID)。</span><span class="sxs-lookup"><span data-stu-id="62797-108">Executing the procedure displays the description and globally unique identifier (GUID) for each resolver in a separate result set.</span></span>  
  
 <span data-ttu-id="62797-109">若要指定解析程式，請參閱＜ [Specify a Merge Article Resolver](../publish/specify-a-merge-article-resolver.md)＞。</span><span class="sxs-lookup"><span data-stu-id="62797-109">To specify a resolver, see [Specify a Merge Article Resolver](../publish/specify-a-merge-article-resolver.md).</span></span>  
  
 <span data-ttu-id="62797-110">下表說明了各解決器的屬性。</span><span class="sxs-lookup"><span data-stu-id="62797-110">The following table describes the attributes of the specific resolvers.</span></span>  
  
|<span data-ttu-id="62797-111">名稱</span><span class="sxs-lookup"><span data-stu-id="62797-111">Name</span></span>|<span data-ttu-id="62797-112">必要輸入</span><span class="sxs-lookup"><span data-stu-id="62797-112">Required input</span></span>|<span data-ttu-id="62797-113">描述</span><span class="sxs-lookup"><span data-stu-id="62797-113">Description</span></span>|<span data-ttu-id="62797-114">註解</span><span class="sxs-lookup"><span data-stu-id="62797-114">Comments</span></span>|  
|----------|--------------------|-----------------|--------------|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="62797-115">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 相加衝突解決器</span><span class="sxs-lookup"><span data-stu-id="62797-115">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Additive Conflict Resolver</span></span>|<span data-ttu-id="62797-116">要加總的資料行名稱。</span><span class="sxs-lookup"><span data-stu-id="62797-116">Name of the column to be summed.</span></span> <span data-ttu-id="62797-117">它必須要有算術資料類型 (例如 **int**、 **smallint**、 **numeric**，等等)。</span><span class="sxs-lookup"><span data-stu-id="62797-117">It must have an arithmetic data type (such as **int**, **smallint**, **numeric**, and so on).</span></span>|<span data-ttu-id="62797-118">衝突成功者是由優先權值決定的。</span><span class="sxs-lookup"><span data-stu-id="62797-118">Conflict winner is determined from the priority value.</span></span> <span data-ttu-id="62797-119">指定設定為來源與目的地資料行值總和的資料行值。</span><span class="sxs-lookup"><span data-stu-id="62797-119">Specified column values are set to the sum of the source and the destination column values.</span></span> <span data-ttu-id="62797-120">如果其中有一個資料行設為 NULL，則結果資料行值即被設為另一資料行的值。</span><span class="sxs-lookup"><span data-stu-id="62797-120">If one is set to NULL, they are set to the value of the other column.</span></span>|<span data-ttu-id="62797-121">支援更新衝突，僅限資料行追蹤。</span><span class="sxs-lookup"><span data-stu-id="62797-121">Supports update conflicts, column tracking only.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="62797-122">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 平均衝突解決器</span><span class="sxs-lookup"><span data-stu-id="62797-122">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Averaging Conflict Resolver</span></span>|<span data-ttu-id="62797-123">要取平均值的資料行名稱。</span><span class="sxs-lookup"><span data-stu-id="62797-123">Name of the column to be averaged.</span></span> <span data-ttu-id="62797-124">它必須要有算術資料類型 (例如 **int**、 **smallint**、 **numeric**，等等)。</span><span class="sxs-lookup"><span data-stu-id="62797-124">It must have an arithmetic data type (such as **int**, **smallint**, **numeric**, and so on).</span></span>|<span data-ttu-id="62797-125">衝突成功者是由優先權值決定的。</span><span class="sxs-lookup"><span data-stu-id="62797-125">Conflict winner is determined from the priority value.</span></span> <span data-ttu-id="62797-126">結果資料行值設定為來源與目的地資料行值的平均值。</span><span class="sxs-lookup"><span data-stu-id="62797-126">The resulting column values are set to the average of the source and the destination column values.</span></span> <span data-ttu-id="62797-127">如果其中有一個資料行設為 NULL，則結果資料行值即被設為另一資料行的值。</span><span class="sxs-lookup"><span data-stu-id="62797-127">If one is set to NULL, they are set to the value of the other column.</span></span>|<span data-ttu-id="62797-128">支援更新衝突，僅限資料行追蹤。</span><span class="sxs-lookup"><span data-stu-id="62797-128">Supports update conflicts, column tracking only.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="62797-129">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] DATETIME (取時間較早者) 衝突解決器</span><span class="sxs-lookup"><span data-stu-id="62797-129">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] DATETIME (Earlier Wins) Conflict Resolver</span></span>|<span data-ttu-id="62797-130">要用來決定衝突成功者的資料行名稱。</span><span class="sxs-lookup"><span data-stu-id="62797-130">Name of the column to be used to determine the conflict winner.</span></span> <span data-ttu-id="62797-131">它必須具有 **datetime** 資料類型。</span><span class="sxs-lookup"><span data-stu-id="62797-131">It must have a **datetime** data type.</span></span>|<span data-ttu-id="62797-132">具有較早 **datetime** 值的資料行決定衝突成功者。</span><span class="sxs-lookup"><span data-stu-id="62797-132">Column with the earlier **datetime** value determines the conflict winner.</span></span> <span data-ttu-id="62797-133">如果其中有一個資料行設為 NULL，則含有另一資料行的資料列便是成功者。</span><span class="sxs-lookup"><span data-stu-id="62797-133">If one is set to NULL, the row containing the other is the winner.</span></span>|<span data-ttu-id="62797-134">支援更新衝突、資料列與資料行追蹤。</span><span class="sxs-lookup"><span data-stu-id="62797-134">Supports update conflicts, row, and column tracking.</span></span> <span data-ttu-id="62797-135">資料行值直接進行比較，且不會依不同時區進行調整。</span><span class="sxs-lookup"><span data-stu-id="62797-135">The column values are compared directly and an adjustment is not made for different time zones.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="62797-136">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] DATETIME (取時間較晚者) 衝突解決器</span><span class="sxs-lookup"><span data-stu-id="62797-136">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] DATETIME (Later Wins) Conflict Resolver</span></span>|<span data-ttu-id="62797-137">要用來決定衝突成功者的資料行名稱。</span><span class="sxs-lookup"><span data-stu-id="62797-137">Name of the column to be used to determine the conflict winner.</span></span> <span data-ttu-id="62797-138">它必須具有 **datetime** 資料類型。</span><span class="sxs-lookup"><span data-stu-id="62797-138">It must have **datetime** data type.</span></span>|<span data-ttu-id="62797-139">具有較晚 **datetime** 值的資料行決定衝突成功者。</span><span class="sxs-lookup"><span data-stu-id="62797-139">Column with the later **datetime** value determines the conflict winner.</span></span> <span data-ttu-id="62797-140">如果其中有一個資料行設為 NULL，則含有另一資料行的資料列便是成功者。</span><span class="sxs-lookup"><span data-stu-id="62797-140">If one is set to NULL, the row containing the other is the winner.</span></span>|<span data-ttu-id="62797-141">支援更新衝突、資料列與資料行追蹤。</span><span class="sxs-lookup"><span data-stu-id="62797-141">Supports update conflicts, row, and column tracking.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="62797-142">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 最大值衝突解決器</span><span class="sxs-lookup"><span data-stu-id="62797-142">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Maximum Conflict Resolver</span></span>|<span data-ttu-id="62797-143">要用來決定衝突成功者的資料行名稱。</span><span class="sxs-lookup"><span data-stu-id="62797-143">Name of the column to be used to determine the conflict winner.</span></span> <span data-ttu-id="62797-144">它必須要有算術資料類型 (例如 **int**、 **smallint**、 **numeric**，等等)。</span><span class="sxs-lookup"><span data-stu-id="62797-144">It must have an arithmetic data type (such as **int**, **smallint**, **numeric**, and so on).</span></span>|<span data-ttu-id="62797-145">具有較大數值的資料行決定衝突成功者。</span><span class="sxs-lookup"><span data-stu-id="62797-145">Column with the larger numeric value determines the conflict winner.</span></span> <span data-ttu-id="62797-146">如果其中有一個資料行設為 NULL，則含有另一資料行的資料列便是成功者。</span><span class="sxs-lookup"><span data-stu-id="62797-146">If one is set to NULL, the row containing the other is the winner.</span></span>|<span data-ttu-id="62797-147">支援資料列與資料行追蹤。</span><span class="sxs-lookup"><span data-stu-id="62797-147">Supports row and column tracking.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="62797-148">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 最小值衝突解決器</span><span class="sxs-lookup"><span data-stu-id="62797-148">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Minimum Conflict Resolver</span></span>|<span data-ttu-id="62797-149">要用來決定衝突成功者的資料行名稱。</span><span class="sxs-lookup"><span data-stu-id="62797-149">Name of the column to be used to determine the conflict winner.</span></span> <span data-ttu-id="62797-150">它必須要有算術資料類型 (例如 **int**、 **smallint**、 **numeric**，等等)。</span><span class="sxs-lookup"><span data-stu-id="62797-150">It must have an arithmetic data type (such as **int**, **smallint**, **numeric**, and so on).</span></span>|<span data-ttu-id="62797-151">具有較小數值的資料行決定衝突成功者。</span><span class="sxs-lookup"><span data-stu-id="62797-151">Column with the smaller numeric value determines the conflict winner.</span></span> <span data-ttu-id="62797-152">如果其中有一個資料行設為 NULL，則含有另一資料行的資料列便是成功者。</span><span class="sxs-lookup"><span data-stu-id="62797-152">If one is set to NULL, the row containing the other is the winner.</span></span>|<span data-ttu-id="62797-153">支援更新衝突，資料列和資料行的追蹤。</span><span class="sxs-lookup"><span data-stu-id="62797-153">Supports update conflicts, row and column tracking.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="62797-154">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 合併文字衝突解決器</span><span class="sxs-lookup"><span data-stu-id="62797-154">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Merge Text Conflict Resolver</span></span>|<span data-ttu-id="62797-155">文字資料行與分隔符號的名稱，例如 `@resolver_info = '[col1][===]'`。</span><span class="sxs-lookup"><span data-stu-id="62797-155">Name of the text column and delimiter, for example, `@resolver_info = '[col1][===]'`.</span></span>|<span data-ttu-id="62797-156">衝突成功者是由優先權值決定的。</span><span class="sxs-lookup"><span data-stu-id="62797-156">Conflict winner is determined from the priority value.</span></span> <span data-ttu-id="62797-157">衝突中的文字資料行設定為合併值，包含通用前置詞，後面接著「發行者」的唯一部分，然後是分隔符號，最後是「訂閱者」的唯一部分。</span><span class="sxs-lookup"><span data-stu-id="62797-157">The text columns in conflict are set to the merged value, consisting of the common prefix followed by the unique part from the Publisher, then by the delimiter, and finally by the unique part from the Subscriber.</span></span>|<span data-ttu-id="62797-158">支援更新衝突，僅限資料行追蹤。</span><span class="sxs-lookup"><span data-stu-id="62797-158">Supports update conflicts, column tracking only.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="62797-159">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Subscriber Always Wins Conflict Resolver</span><span class="sxs-lookup"><span data-stu-id="62797-159">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Subscriber Always Wins Conflict Resolver</span></span>|<span data-ttu-id="62797-160">無輸入。</span><span class="sxs-lookup"><span data-stu-id="62797-160">No inputs.</span></span>|<span data-ttu-id="62797-161">無論是來源或目的地，「訂閱者」都是成功者。</span><span class="sxs-lookup"><span data-stu-id="62797-161">Subscriber, regardless of whether it is the source or destination, is the winner.</span></span>|<span data-ttu-id="62797-162">支援所有衝突類型。</span><span class="sxs-lookup"><span data-stu-id="62797-162">Supports all conflict types.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="62797-163">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Priority Column Resolver</span><span class="sxs-lookup"><span data-stu-id="62797-163">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Priority Column Resolver</span></span>|<span data-ttu-id="62797-164">要用來決定衝突成功者的資料行名稱。</span><span class="sxs-lookup"><span data-stu-id="62797-164">Name of the column to be used to determine the conflict winner.</span></span> <span data-ttu-id="62797-165">它必須要有算術資料類型 (例如 **int**、 **smallint**、 **numeric**，等等)。</span><span class="sxs-lookup"><span data-stu-id="62797-165">It must have an arithmetic data type (such as **int**, **smallint**, **numeric**, and so on).</span></span>|<span data-ttu-id="62797-166">具有較大數值的資料行決定衝突成功者。</span><span class="sxs-lookup"><span data-stu-id="62797-166">Column with the larger numeric value determines the conflict winner.</span></span> <span data-ttu-id="62797-167">如果其中有一個資料行設為 NULL，則含有另一資料行的資料列便是成功者。</span><span class="sxs-lookup"><span data-stu-id="62797-167">If one is set to NULL, the row containing the other is the winner.</span></span>|<span data-ttu-id="62797-168">支援更新衝突，資料列和資料行的追蹤。</span><span class="sxs-lookup"><span data-stu-id="62797-168">Supports update conflicts, row and column tracking.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="62797-169">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Upload Only Conflict Resolver</span><span class="sxs-lookup"><span data-stu-id="62797-169">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Upload Only Conflict Resolver</span></span>|<span data-ttu-id="62797-170">無輸入。</span><span class="sxs-lookup"><span data-stu-id="62797-170">No inputs.</span></span>|<span data-ttu-id="62797-171">接受上傳至「發行者」的變更；變更無法下載至「訂閱者」。</span><span class="sxs-lookup"><span data-stu-id="62797-171">Changes uploaded to the Publisher are accepted; changes are not downloaded to the Subscriber.</span></span>|<span data-ttu-id="62797-172">支援所有衝突類型。</span><span class="sxs-lookup"><span data-stu-id="62797-172">Supports all conflict types.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="62797-173">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Download Only Conflict Resolver</span><span class="sxs-lookup"><span data-stu-id="62797-173">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Download Only Conflict Resolver</span></span>|<span data-ttu-id="62797-174">無輸入。</span><span class="sxs-lookup"><span data-stu-id="62797-174">No inputs.</span></span>|<span data-ttu-id="62797-175">拒絕上傳至「發行者」的變更；變更可下載至「訂閱者」。</span><span class="sxs-lookup"><span data-stu-id="62797-175">Changes uploaded to the Publisher are rejected; changes are downloaded to the Subscriber.</span></span>|<span data-ttu-id="62797-176">支援所有衝突類型。</span><span class="sxs-lookup"><span data-stu-id="62797-176">Supports all conflict types.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="62797-177">SQL Server 預存程序解析程式</span><span class="sxs-lookup"><span data-stu-id="62797-177">SQLServer Stored Procedure Resolver</span></span>|<span data-ttu-id="62797-178">解決器應呼叫預存程序的名稱來處理衝突。</span><span class="sxs-lookup"><span data-stu-id="62797-178">Name of the stored procedure the resolver should call to handle the conflict.</span></span>|<span data-ttu-id="62797-179">衝突解決方案視您在預存程序中指定的邏輯而定。</span><span class="sxs-lookup"><span data-stu-id="62797-179">Conflict resolution depends on the logic in the stored procedure you specify.</span></span>|<span data-ttu-id="62797-180">支援更新衝突。</span><span class="sxs-lookup"><span data-stu-id="62797-180">Supports update conflicts.</span></span> <span data-ttu-id="62797-181">如需詳細資訊，請參閱[針對合併發行項實作自訂衝突解析程式](../implement-a-custom-conflict-resolver-for-a-merge-article.md)</span><span class="sxs-lookup"><span data-stu-id="62797-181">For more information, see [Implement a Custom Conflict Resolver for a Merge Article](../implement-a-custom-conflict-resolver-for-a-merge-article.md)</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="62797-182">另請參閱</span><span class="sxs-lookup"><span data-stu-id="62797-182">See Also</span></span>  
 <span data-ttu-id="62797-183">[進階合併式複寫衝突偵測與解決](advanced-merge-replication-conflict-detection-and-resolution.md) </span><span class="sxs-lookup"><span data-stu-id="62797-183">[Advanced Merge Replication Conflict Detection and Resolution](advanced-merge-replication-conflict-detection-and-resolution.md) </span></span>  
 [<span data-ttu-id="62797-184">sp_enumcustomresolvers &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="62797-184">sp_enumcustomresolvers &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql)  
  
  
