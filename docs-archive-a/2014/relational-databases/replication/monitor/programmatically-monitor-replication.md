---
title: 以程式設計方式監視複寫 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- sp_replmonitorhelppublisher
- sp_replmonitorhelpmergesessiondetail
- monitoring performance [SQL Server replication], publication status
- sp_replmonitorhelpmergesession
- sp_replmonitorhelppublicationthresholds
- monitoring performance [SQL Server replication], subscription status
- monitoring performance [SQL Server replication], Transact-SQL programming
- sp_replmonitorsubscriptionpendingcmds
- sp_replmonitorchangepublicationthreshold
- transactional replication, monitoring
- sp_replmonitorhelppublication
- sp_replmonitorhelpsubscription
- monitoring performance [SQL Server replication], thresholds and warnings
- merge replication monitoring [SQL Server replication]
- snapshot replication [SQL Server], monitoring
ms.assetid: e8bf8850-8da5-4a4f-a399-64232b4e476d
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: e11f73bf9538fb5ba84f4575631489ef852802c1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87709198"
---
# <a name="programmatically-monitor-replication"></a><span data-ttu-id="607b9-102">以程式設計方式監視複寫</span><span class="sxs-lookup"><span data-stu-id="607b9-102">Programmatically Monitor Replication</span></span>
  <span data-ttu-id="607b9-103">「複寫監視器」是一個允許您監視複寫拓撲之全面健全狀況的圖形化工具。</span><span class="sxs-lookup"><span data-stu-id="607b9-103">Replication Monitor is a graphical tool that allows you to monitor a replication topology.</span></span> <span data-ttu-id="607b9-104">您可以使用 [!INCLUDE[tsql](../../../includes/tsql-md.md)] 複寫預存程序或 Replication Management Objects (RMO)，以程式設計的方式存取相同的監視資料。</span><span class="sxs-lookup"><span data-stu-id="607b9-104">You can access the same monitoring data programmatically by using [!INCLUDE[tsql](../../../includes/tsql-md.md)] replication stored procedures or replication management objects (RMO).</span></span> <span data-ttu-id="607b9-105">這些物件可用來設計下列工作：</span><span class="sxs-lookup"><span data-stu-id="607b9-105">These objects enable you to program the following tasks:</span></span>  
  
-   <span data-ttu-id="607b9-106">監視「發行者」、發行集和訂閱的狀態。</span><span class="sxs-lookup"><span data-stu-id="607b9-106">Monitor the state of Publishers, publications, and subscriptions.</span></span>  
  
-   <span data-ttu-id="607b9-107">在一個或多個「訂閱者」端監視「合併代理程式」的工作階段。</span><span class="sxs-lookup"><span data-stu-id="607b9-107">Monitor Merge Agent sessions at one or more Subscribers.</span></span>  
  
-   <span data-ttu-id="607b9-108">監視在一個或多個「訂閱者」端等候套用的交易式命令。</span><span class="sxs-lookup"><span data-stu-id="607b9-108">Monitor transactional commands waiting to be applied at one or more Subscribers.</span></span>  
  
-   <span data-ttu-id="607b9-109">定義臨界值標準，以決定發行集何時需要介入。</span><span class="sxs-lookup"><span data-stu-id="607b9-109">Define the threshold metrics that determine when a publication requires intervention.</span></span>  
  
-   <span data-ttu-id="607b9-110">監視追蹤 Token 的狀態。</span><span class="sxs-lookup"><span data-stu-id="607b9-110">Monitor the status of tracer tokens.</span></span>  
  
 <span data-ttu-id="607b9-111">**本主題內容：**</span><span class="sxs-lookup"><span data-stu-id="607b9-111">**In this topic:**</span></span>  
  
 [<span data-ttu-id="607b9-112">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="607b9-112">Transact-SQL</span></span>](#Tsql)  
  
 [<span data-ttu-id="607b9-113">Replication Management Objects (RMO)</span><span class="sxs-lookup"><span data-stu-id="607b9-113">Replication Management Objects (RMO)</span></span>](#RMO)  
  
##  <a name="transact-sql"></a><a name="Tsql"></a> <span data-ttu-id="607b9-114">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="607b9-114">Transact-SQL</span></span>  
  
#### <a name="to-monitor-publishers-publications-and-subscriptions-from-the-distributor"></a><span data-ttu-id="607b9-115">若要從散發者監視發行者、發行集和訂閱</span><span class="sxs-lookup"><span data-stu-id="607b9-115">To monitor Publishers, publications, and subscriptions from the Distributor</span></span>  
  
1.  <span data-ttu-id="607b9-116">在散發資料庫的「散發者」端，執行 [sp_replmonitorhelppublisher](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublisher-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="607b9-116">At the Distributor on the distribution database, execute [sp_replmonitorhelppublisher](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublisher-transact-sql).</span></span> <span data-ttu-id="607b9-117">這會為所有使用此「散發者」的「發行者」傳回監視資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-117">This returns monitoring information for all Publishers using this Distributor.</span></span> <span data-ttu-id="607b9-118">若要將結果集限制為單一「發行者」，請指定 **@publisher** 。</span><span class="sxs-lookup"><span data-stu-id="607b9-118">To limit the result set to a single Publisher, specify **@publisher**.</span></span>  
  
2.  <span data-ttu-id="607b9-119">在散發資料庫的「散發者」端，執行 [sp_replmonitorhelppublication](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublication-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="607b9-119">At the Distributor on the distribution database, execute [sp_replmonitorhelppublication](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublication-transact-sql).</span></span> <span data-ttu-id="607b9-120">這會為所有使用此「散發者」的發行集傳回監視資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-120">This returns monitoring information for all publications using this Distributor.</span></span> <span data-ttu-id="607b9-121">若要將結果集限制為單一「發行者」、「發行集」或「已發行」資料庫，請 **@publisher** 分別指定、 **@publication** 或 **@publisher_db** 。</span><span class="sxs-lookup"><span data-stu-id="607b9-121">To limit the result set to a single Publisher, publication, or published database, specify **@publisher**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
3.  <span data-ttu-id="607b9-122">在散發資料庫的「散發者」端，執行 [sp_replmonitorhelpsubscription](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpsubscription-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="607b9-122">At the Distributor on the distribution database, execute [sp_replmonitorhelpsubscription](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpsubscription-transact-sql).</span></span> <span data-ttu-id="607b9-123">這會為所有使用此「散發者」的訂閱傳回監視資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-123">This returns monitoring information for all subscriptions using this Distributor.</span></span> <span data-ttu-id="607b9-124">若要將結果集限制為屬於單一「發行者」、發行集或已發行資料庫的訂閱，請 **@publisher** 分別指定、 **@publication** 或 **@publisher_db** 。</span><span class="sxs-lookup"><span data-stu-id="607b9-124">To limit the result set to subscriptions belonging to a single Publisher, publication, or published database, specify **@publisher**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
#### <a name="to-monitor-transactional-commands-waiting-to-be-applied-at-the-subscriber"></a><span data-ttu-id="607b9-125">若要監視在訂閱者端等候套用的交易式命令</span><span class="sxs-lookup"><span data-stu-id="607b9-125">To monitor transactional commands waiting to be applied at the Subscriber</span></span>  
  
1.  <span data-ttu-id="607b9-126">在散發資料庫的「散發者」端，執行 [sp_replmonitorsubscriptionpendingcmds](/sql/relational-databases/system-stored-procedures/sp-replmonitorsubscriptionpendingcmds-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="607b9-126">At the Distributor on the distribution database, execute [sp_replmonitorsubscriptionpendingcmds](/sql/relational-databases/system-stored-procedures/sp-replmonitorsubscriptionpendingcmds-transact-sql).</span></span> <span data-ttu-id="607b9-127">這會為所有使用此「散發者」的訂閱傳回所有暫止命令的監視資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-127">This returns monitoring information for all commands pending for all subscriptions using this Distributor.</span></span> <span data-ttu-id="607b9-128">若要將結果集限制為屬於單一「發行者」、「訂閱者」、發行集或已發行資料庫之訂閱的暫止命令，請 **@publisher** 分別指定、 **@subscriber** 、 **@publication** 或 **@publisher_db** 。</span><span class="sxs-lookup"><span data-stu-id="607b9-128">To limit the result set to commands pending for subscriptions belonging to a single Publisher, Subscriber, publication, or published database, specify **@publisher**, **@subscriber**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
#### <a name="to-monitor-merge-changes-waiting-to-be-uploaded-or-downloaded"></a><span data-ttu-id="607b9-129">若要監視等候上傳或下載的合併變更</span><span class="sxs-lookup"><span data-stu-id="607b9-129">To monitor merge changes waiting to be uploaded or downloaded</span></span>  
  
1.  <span data-ttu-id="607b9-130">在發行集資料庫的「發行者」端，執行 [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="607b9-130">At the Publisher on the publication database, execute [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span></span> <span data-ttu-id="607b9-131">這會傳回結果集，顯示正等候複寫至「訂閱者」之變更的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-131">This returns a result set showing information on changes that are waiting to be replicated to Subscribers.</span></span> <span data-ttu-id="607b9-132">若要將結果集限制為屬於單一發行集或發行項的變更， **@publication** 請 **@article** 分別指定或。</span><span class="sxs-lookup"><span data-stu-id="607b9-132">To limit the result set to changes that belong to a single publication or article, specify **@publication** or **@article**, respectively.</span></span>  
  
2.  <span data-ttu-id="607b9-133">在訂閱資料庫的「訂閱者」端，執行 [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="607b9-133">At a Subscriber on the subscription database, execute [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span></span> <span data-ttu-id="607b9-134">這會傳回結果集，顯示正等候複寫至「發行者」之變更的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-134">This returns a result set showing information on changes that are waiting to be replicated to the Publisher.</span></span> <span data-ttu-id="607b9-135">若要將結果集限制為屬於單一發行集或發行項的變更， **@publication** 請 **@article** 分別指定或。</span><span class="sxs-lookup"><span data-stu-id="607b9-135">To limit the result set to changes that belong to a single publication or article, specify **@publication** or **@article**, respectively.</span></span>  
  
#### <a name="to-monitor-merge-agent-sessions"></a><span data-ttu-id="607b9-136">若要監視合併代理程式的工作階段</span><span class="sxs-lookup"><span data-stu-id="607b9-136">To monitor Merge Agent sessions</span></span>  
  
1.  <span data-ttu-id="607b9-137">在散發資料庫的「散發者」端，執行 [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="607b9-137">At the Distributor on the distribution database, execute [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span></span> <span data-ttu-id="607b9-138">這會針對所有使用此「散發者」的訂閱，傳回有關「合併代理程式」工作階段的監視資訊，包括 **Session_id**。</span><span class="sxs-lookup"><span data-stu-id="607b9-138">This returns monitoring information, including **Session_id**, on all Merge Agent sessions for all subscriptions using this Distributor.</span></span> <span data-ttu-id="607b9-139">您也可以藉由查詢 **MSmerge_sessions** 系統資料表來取得 [Session_id](/sql/relational-databases/system-tables/msmerge-sessions-transact-sql) 。</span><span class="sxs-lookup"><span data-stu-id="607b9-139">You can also obtain **Session_id** by querying the [MSmerge_sessions](/sql/relational-databases/system-tables/msmerge-sessions-transact-sql) system table.</span></span>  
  
2.  <span data-ttu-id="607b9-140">在散發資料庫的「散發者」端，執行 [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="607b9-140">At the Distributor on the distribution database, execute [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span></span> <span data-ttu-id="607b9-141">針對 **Session_id** 指定步驟 1 的 **@session_id**。</span><span class="sxs-lookup"><span data-stu-id="607b9-141">Specify a **Session_id** value from step 1 for **@session_id**.</span></span> <span data-ttu-id="607b9-142">這會顯示有關工作階段的詳細監視資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-142">This displays detailed monitor information about the session.</span></span>  
  
3.  <span data-ttu-id="607b9-143">針對每個感興趣的工作階段重複步驟 2。</span><span class="sxs-lookup"><span data-stu-id="607b9-143">Repeat step 2 for each session of interest.</span></span>  
  
#### <a name="to-monitor-merge-agent-sessions-for-pull-subscriptions-from-the-subscriber"></a><span data-ttu-id="607b9-144">若要從訂閱者監視提取訂閱的合併代理程式工作階段</span><span class="sxs-lookup"><span data-stu-id="607b9-144">To monitor Merge Agent sessions for pull subscriptions from the Subscriber</span></span>  
  
1.  <span data-ttu-id="607b9-145">在訂閱資料庫的「訂閱者」端，執行 [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="607b9-145">At the Subscriber on the subscription database, execute [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span></span> <span data-ttu-id="607b9-146">針對指定的訂用帳戶，指定 **@publisher** 、 **@publication** ，以及的發行集資料庫名稱 **@publisher_db** 。</span><span class="sxs-lookup"><span data-stu-id="607b9-146">For a given subscription, specify **@publisher**, **@publication**, and the name of the publication database for **@publisher_db**.</span></span> <span data-ttu-id="607b9-147">這會傳回此訂閱最後五個「合併代理程式」工作階段的監視資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-147">This returns monitoring information for the last five Merge Agent sessions for this subscription.</span></span> <span data-ttu-id="607b9-148">請注意結果集中感興趣之工作階段的 **Session_id** 值。</span><span class="sxs-lookup"><span data-stu-id="607b9-148">Note the value of **Session_id** for sessions of interest in the result set.</span></span>  
  
2.  <span data-ttu-id="607b9-149">在訂閱資料庫的「訂閱者」端，執行 [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="607b9-149">At the Subscriber on the subscription database, execute [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span></span> <span data-ttu-id="607b9-150">針對 **Session_id** 指定步驟 1 的 **@session_id**。</span><span class="sxs-lookup"><span data-stu-id="607b9-150">Specify a **Session_id** value from step 1 for **@session_id**.</span></span> <span data-ttu-id="607b9-151">這會顯示有關工作階段的詳細監視資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-151">This displays detailed monitoring information about the session.</span></span>  
  
3.  <span data-ttu-id="607b9-152">針對每個感興趣的工作階段重複步驟 2。</span><span class="sxs-lookup"><span data-stu-id="607b9-152">Repeat step 2 for each session of interest.</span></span>  
  
#### <a name="to-view-and-modify-the-monitor-threshold-metrics-for-a-publication"></a><span data-ttu-id="607b9-153">若要檢視和修改發行集的監視臨界值標準</span><span class="sxs-lookup"><span data-stu-id="607b9-153">To view and modify the monitor threshold metrics for a publication</span></span>  
  
1.  <span data-ttu-id="607b9-154">在散發資料庫的「散發者」端，執行 [sp_replmonitorhelppublicationthresholds](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublicationthresholds-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="607b9-154">At the Distributor on the distribution database, execute [sp_replmonitorhelppublicationthresholds](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublicationthresholds-transact-sql).</span></span> <span data-ttu-id="607b9-155">這會傳回為所有使用此「散發者」的發行集所設定的監視臨界值。</span><span class="sxs-lookup"><span data-stu-id="607b9-155">This returns the monitoring thresholds set for all publications using this Distributor.</span></span> <span data-ttu-id="607b9-156">若要將結果集限制為監視屬於單一「發行者」或已發行資料庫的發行集之臨界值，或 **@publisher** 分別指定、 **@publisher_db** 或 **@publication** 。</span><span class="sxs-lookup"><span data-stu-id="607b9-156">To limit the result set to monitor thresholds to publications belonging to a single Publisher or published database or to a single publication, specify **@publisher**, **@publisher_db**, or **@publication**, respectively.</span></span> <span data-ttu-id="607b9-157">請注意必須變更之任何臨界值的 **Metric_id** 值。</span><span class="sxs-lookup"><span data-stu-id="607b9-157">Note the value of **Metric_id** for any thresholds that must be changed.</span></span> <span data-ttu-id="607b9-158">如需相關資訊，請參閱 [Set Thresholds and Warnings in Replication Monitor](set-thresholds-and-warnings-in-replication-monitor.md)。</span><span class="sxs-lookup"><span data-stu-id="607b9-158">For more information, see [Set Thresholds and Warnings in Replication Monitor](set-thresholds-and-warnings-in-replication-monitor.md).</span></span>  
  
2.  <span data-ttu-id="607b9-159">在散發資料庫的「散發者」端，執行 [sp_replmonitorchangepublicationthreshold](/sql/relational-databases/system-stored-procedures/sp-replmonitorchangepublicationthreshold-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="607b9-159">At the Distributor on the distribution database, execute [sp_replmonitorchangepublicationthreshold](/sql/relational-databases/system-stored-procedures/sp-replmonitorchangepublicationthreshold-transact-sql).</span></span> <span data-ttu-id="607b9-160">視需要指定下列項目：</span><span class="sxs-lookup"><span data-stu-id="607b9-160">Specify the following as needed:</span></span>  
  
    -   <span data-ttu-id="607b9-161">針對 **Metric_id** 指定在步驟 1 中取得的 **@metric_id**。</span><span class="sxs-lookup"><span data-stu-id="607b9-161">The **Metric_id** value obtained in step 1 for **@metric_id**.</span></span>  
  
    -   <span data-ttu-id="607b9-162">監視閾值標準的新值 **@value** 。</span><span class="sxs-lookup"><span data-stu-id="607b9-162">A new value for the monitor threshold metric for **@value**.</span></span>  
  
    -   <span data-ttu-id="607b9-163">針對 **@shouldalert** ，指定 **@shouldalert** 的值以在達到此臨界值時記錄警示，或者如果不需要警示，則指定 **0** 的值。</span><span class="sxs-lookup"><span data-stu-id="607b9-163">A value of **1** for **@shouldalert** for an alert to be logged when this threshold is reached, or a value of **0** if an alert is not needed.</span></span>  
  
    -   <span data-ttu-id="607b9-164">針對 **@shouldalert** ，指定 **@mode** 的值以啟用監視臨界值標準；或指定 **2** 的值加以停用。</span><span class="sxs-lookup"><span data-stu-id="607b9-164">A value of **1** for **@mode** to enable the monitor threshold metric or a value of **2** to disable it.</span></span>  
  
##  <a name="replication-management-objects-rmo"></a><a name="RMO"></a> <span data-ttu-id="607b9-165">Replication Management Objects (RMO)</span><span class="sxs-lookup"><span data-stu-id="607b9-165">Replication Management Objects (RMO)</span></span>  
  
#### <a name="to-monitor-a-subscription-to-a-merge-publication-at-the-subscriber"></a><span data-ttu-id="607b9-166">若要監視訂閱者端合併式發行集的訂閱</span><span class="sxs-lookup"><span data-stu-id="607b9-166">To monitor a subscription to a merge publication at the Subscriber</span></span>  
  
1.  <span data-ttu-id="607b9-167">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 類別建立與「訂閱者」的連接。</span><span class="sxs-lookup"><span data-stu-id="607b9-167">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="607b9-168">建立 <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor> 類別的執行個體、設定訂閱的 <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publisher%2A>、 <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publication%2A>、 <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.PublisherDB%2A>、 <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.SubscriberDB%2A> 屬性，以及將 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 屬性設定為步驟 1 中所建立的 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 。</span><span class="sxs-lookup"><span data-stu-id="607b9-168">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor> class, and set the <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publisher%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publication%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.PublisherDB%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.SubscriberDB%2A> properties for the subscription, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
3.  <span data-ttu-id="607b9-169">呼叫下列其中一個方法，以傳回此訂閱的「合併代理程式」工作階段的相關資訊：</span><span class="sxs-lookup"><span data-stu-id="607b9-169">Call one of the following methods to return information on Merge Agent sessions for this subscription:</span></span>  
  
    -   <span data-ttu-id="607b9-170"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - 傳回 <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> 物件的陣列，最多提供最後五個「合併代理程式」工作階段的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-170"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> objects with information on up to the last five Merge Agent sessions.</span></span> <span data-ttu-id="607b9-171">請注意感興趣之任何工作階段的 <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> 值。</span><span class="sxs-lookup"><span data-stu-id="607b9-171">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="607b9-172"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - 傳回 <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> 物件，提供在經過的小時數期間 (如 *hours* 參數所指定) 所發生的「合併代理程式」工作階段的相關資訊 (最多達最後五個工作階段)。</span><span class="sxs-lookup"><span data-stu-id="607b9-172"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> objects with information on Merge Agent sessions that have occurred during the past number of hours passed in as the *hours* parameter (up to the last five sessions).</span></span> <span data-ttu-id="607b9-173">請注意感興趣之任何工作階段的 <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> 值。</span><span class="sxs-lookup"><span data-stu-id="607b9-173">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="607b9-174"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummary%2A> - 傳回 <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> 物件，提供最後一個「合併代理程式」工作階段的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-174"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummary%2A> - returns a <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> object with information on the last Merge Agent session.</span></span> <span data-ttu-id="607b9-175">請注意此工作階段的 <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> 值。</span><span class="sxs-lookup"><span data-stu-id="607b9-175">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for this session.</span></span>  
  
    -   <span data-ttu-id="607b9-176"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummaryDataSet%2A> - 傳回 <xref:System.Data.DataSet> 物件，最多提供最後五個「合併代理程式」工作階段的相關資訊 (每個資料列顯示一個工作階段)。</span><span class="sxs-lookup"><span data-stu-id="607b9-176"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummaryDataSet%2A> - returns a <xref:System.Data.DataSet> object with information on up to the last five Merge Agent sessions, one in each row.</span></span> <span data-ttu-id="607b9-177">請記下感興趣之任何工作階段的 **Session_id** 資料行值。</span><span class="sxs-lookup"><span data-stu-id="607b9-177">Note the value of the **Session_id** column for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="607b9-178"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummaryDataRow%2A> - 傳回 <xref:System.Data.DataRow> 物件，提供最後一個「合併代理程式」工作階段的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-178"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummaryDataRow%2A> - returns a <xref:System.Data.DataRow> object with information on the last Merge Agent session.</span></span> <span data-ttu-id="607b9-179">請記下此工作階段的 **Session_id** 資料行值。</span><span class="sxs-lookup"><span data-stu-id="607b9-179">Note the value of the **Session_id** column for this session.</span></span>  
  
4.  <span data-ttu-id="607b9-180">(選擇性) 呼叫 <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> ，以重新整理以 <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> 所傳遞之 *mss,* 物件的資料，或呼叫 <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> ，以重新整理以 <xref:System.Data.DataRow> 所傳遞之 *drRefresh*。</span><span class="sxs-lookup"><span data-stu-id="607b9-180">(Optional) Call <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> to refresh the data for the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> object passed as *mss,* or call <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> to refresh the data in the <xref:System.Data.DataRow> object passed as *drRefresh*.</span></span>  
  
5.  <span data-ttu-id="607b9-181">使用步驟 3 中取得的工作階段識別碼，呼叫下列其中一個方法來傳回有關特定工作階段詳細資料的資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-181">Using the session ID obtained in step 3, call one of the following methods to return information on the details of a particular session:</span></span>  
  
    -   <span data-ttu-id="607b9-182"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetails%2A>-傳回 <xref:Microsoft.SqlServer.Replication.MergeSessionDetail> 所提供*sessionID*的物件陣列。</span><span class="sxs-lookup"><span data-stu-id="607b9-182"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetails%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionDetail> objects for the supplied *sessionID*.</span></span>  
  
    -   <span data-ttu-id="607b9-183"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetailsDataSet%2A>-傳回 <xref:System.Data.DataSet> 物件，其中包含指定*sessionID*的資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-183"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetailsDataSet%2A> - returns a <xref:System.Data.DataSet> object with information for the specified *sessionID*.</span></span>  
  
#### <a name="to-monitor-replication-properties-for-all-publications-at-a-distributor"></a><span data-ttu-id="607b9-184">若要監視在散發者端所有發行集的複寫屬性</span><span class="sxs-lookup"><span data-stu-id="607b9-184">To monitor replication properties for all publications at a Distributor</span></span>  
  
1.  <span data-ttu-id="607b9-185">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 類別建立與散發者的連接。</span><span class="sxs-lookup"><span data-stu-id="607b9-185">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="607b9-186">建立 <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> 類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="607b9-186">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> class.</span></span>  
  
3.  <span data-ttu-id="607b9-187">將 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 屬性設定為在步驟 1 中建立的 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 。</span><span class="sxs-lookup"><span data-stu-id="607b9-187">Set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
4.  <span data-ttu-id="607b9-188">呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法以取得物件的屬性。</span><span class="sxs-lookup"><span data-stu-id="607b9-188">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
5.  <span data-ttu-id="607b9-189">執行下列其中一或多個方法，以針對使用此散發者的所有發行者傳回複寫資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-189">Execute one or more of the following methods to return replication information for all Publishers that use this Distributor.</span></span>  
  
    -   <span data-ttu-id="607b9-190"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumDistributionAgents%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關此「散發者」端所有「散發代理程式」的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-190"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumDistributionAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Distribution Agents at this Distributor.</span></span>  
  
    -   <span data-ttu-id="607b9-191"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumErrorRecords%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關在「散發者」端儲存之錯誤的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-191"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains information about errors stored at the Distributor.</span></span>  
  
    -   <span data-ttu-id="607b9-192"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumLogReaderAgents%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關「散發者」端所有「記錄讀取器代理程式」的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-192"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumLogReaderAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Log Reader Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="607b9-193"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMergeAgents%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關「散發者」端所有「合併代理程式」的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-193"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMergeAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Merge Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="607b9-194"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMiscellaneousAgents%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關「散發者」端所有其他複寫代理程式的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-194"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMiscellaneousAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all other replication agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="607b9-195"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關「散發者」端所有「發行者」的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-195"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Publishers at this Distributor.</span></span>  
  
    -   <span data-ttu-id="607b9-196"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers2%2A> - 傳回 <xref:System.Data.DataSet> 物件，該物件會傳回使用此「散發者」的「發行者」。</span><span class="sxs-lookup"><span data-stu-id="607b9-196"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers2%2A> - returns a <xref:System.Data.DataSet> object that returns the Publishers that use this Distributor.</span></span>  
  
    -   <span data-ttu-id="607b9-197"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgents%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關「散發者」端所有「佇列讀取器代理程式」的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-197"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Queue Reader Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="607b9-198"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessionDetails%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關所指定之「佇列讀取器代理程式」和工作階段的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-198"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Queue Reader Agent and session.</span></span>  
  
    -   <span data-ttu-id="607b9-199"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessions%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關所指定之「佇列讀取器代理程式」的工作階段資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-199"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information about the specified Queue Reader Agent.</span></span>  
  
    -   <span data-ttu-id="607b9-200"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumSnapshotAgents%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關「散發者」端所有「快照集代理程式」的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-200"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumSnapshotAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Snapshot Agents at the Distributor.</span></span>  
  
#### <a name="to-monitor-publication-properties-for-a-specific-publisher-at-the-distributor"></a><span data-ttu-id="607b9-201">若要監視在散發者端特定發行者的發行集屬性</span><span class="sxs-lookup"><span data-stu-id="607b9-201">To monitor publication properties for a specific Publisher at the Distributor</span></span>  
  
1.  <span data-ttu-id="607b9-202">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 類別建立與散發者的連接。</span><span class="sxs-lookup"><span data-stu-id="607b9-202">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="607b9-203">以下列其中一種方法取得 <xref:Microsoft.SqlServer.Replication.PublisherMonitor> 物件。</span><span class="sxs-lookup"><span data-stu-id="607b9-203">Get a <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="607b9-204">建立 <xref:Microsoft.SqlServer.Replication.PublisherMonitor> 類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="607b9-204">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor> class.</span></span> <span data-ttu-id="607b9-205">設定「發行者」的 <xref:Microsoft.SqlServer.Replication.PublisherMonitor.Name%2A> 屬性，並將 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 屬性設定為在步驟 1 中建立的 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 。</span><span class="sxs-lookup"><span data-stu-id="607b9-205">Set the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.Name%2A> property for the Publisher, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="607b9-206">呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法以取得物件的屬性。</span><span class="sxs-lookup"><span data-stu-id="607b9-206">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="607b9-207">如果此方法傳回 `false`，則表示「發行者」名稱定義不正確，或者該發行集不存在。</span><span class="sxs-lookup"><span data-stu-id="607b9-207">If this method returns `false`, either the Publisher name was defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="607b9-208">從藉由現有 <xref:Microsoft.SqlServer.Replication.PublisherMonitorCollection> 物件的 <xref:Microsoft.SqlServer.Replication.ReplicationMonitor.PublisherMonitors%2A> 屬性進行存取的 <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> 。</span><span class="sxs-lookup"><span data-stu-id="607b9-208">From the <xref:Microsoft.SqlServer.Replication.PublisherMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.ReplicationMonitor.PublisherMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> object.</span></span>  
  
3.  <span data-ttu-id="607b9-209">執行下列其中一或多個方法，針對屬於此「發行者」的所有發行集傳回複寫資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-209">Execute one or more of the following methods to return replication information for all publications that belong to this Publisher.</span></span>  
  
    -   <span data-ttu-id="607b9-210"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessionDetails%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關所指定之「散發代理程式」和工作階段的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-210"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Distribution Agent and session.</span></span>  
  
    -   <span data-ttu-id="607b9-211"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessions%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關所指定之「散發代理程式」的工作階段資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-211"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information about the specified Distribution Agent.</span></span>  
  
    -   <span data-ttu-id="607b9-212"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumErrorRecords%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關所指定錯誤的錯誤記錄資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-212"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains error record information about the specified error.</span></span>  
  
    -   <span data-ttu-id="607b9-213"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessionDetails%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含所指定之「記錄讀取器代理程式」和工作階段的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-213"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details for the specified Log Reader Agent and session.</span></span>  
  
    -   <span data-ttu-id="607b9-214"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessions%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含所指定之「記錄讀取器代理程式」的工作階段資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-214"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Log Reader Agent.</span></span>  
  
    -   <span data-ttu-id="607b9-215"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關所指定之「合併代理程式」和工作階段的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-215"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Merge Agent and session.</span></span>  
  
    -   <span data-ttu-id="607b9-216"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails2%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關所指定之「合併代理程式」和工作階段的其他詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-216"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails2%2A> - returns a <xref:System.Data.DataSet> object that contains additional details about the specified Merge Agent and session.</span></span>  
  
    -   <span data-ttu-id="607b9-217"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含所指定之「合併代理程式」的工作階段資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-217"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Merge Agent.</span></span>  
  
    -   <span data-ttu-id="607b9-218"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions2%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含所指定之「合併代理程式」的其他工作階段資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-218"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions2%2A> - returns a <xref:System.Data.DataSet> object that contains additional session information for the specified Merge Agent.</span></span>  
  
    -   <span data-ttu-id="607b9-219"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關此「散發者」端所有發行集的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-219"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications%2A> - returns a <xref:System.Data.DataSet> object that contains information about all publications at this Distributor.</span></span>  
  
    -   <span data-ttu-id="607b9-220"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications2%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關此「散發者」端所有發行集的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-220"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications2%2A> - returns a <xref:System.Data.DataSet> object that contains additional information about all publications at this Distributor.</span></span>  
  
    -   <span data-ttu-id="607b9-221"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessionDetails%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關所指定之「快照集代理程式」和工作階段的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-221"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Snapshot Agent and session.</span></span>  
  
    -   <span data-ttu-id="607b9-222"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessions%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含所指定之「快照集代理程式」的工作階段資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-222"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Snapshot Agent.</span></span>  
  
    -   <span data-ttu-id="607b9-223"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSubscriptions%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關此「散發者」端所有發行集訂閱的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-223"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSubscriptions%2A> - returns a <xref:System.Data.DataSet> object that contains information about all subscriptions to publications at this Distributor.</span></span>  
  
#### <a name="to-monitor-properties-for-a-specific-publication-at-the-distributor"></a><span data-ttu-id="607b9-224">若要監視散發者端特定發行集的屬性</span><span class="sxs-lookup"><span data-stu-id="607b9-224">To monitor properties for a specific publication at the Distributor</span></span>  
  
1.  <span data-ttu-id="607b9-225">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 類別建立與散發者的連接。</span><span class="sxs-lookup"><span data-stu-id="607b9-225">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="607b9-226">以下列其中一種方法取得 <xref:Microsoft.SqlServer.Replication.PublicationMonitor> 物件。</span><span class="sxs-lookup"><span data-stu-id="607b9-226">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="607b9-227">建立 <xref:Microsoft.SqlServer.Replication.PublicationMonitor> 類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="607b9-227">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="607b9-228">設定發行集的 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>和 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> 屬性，並將 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 屬性設定為在步驟 1 中建立的 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 。</span><span class="sxs-lookup"><span data-stu-id="607b9-228">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="607b9-229">呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法以取得物件的屬性。</span><span class="sxs-lookup"><span data-stu-id="607b9-229">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="607b9-230">如果此方法傳回 `false`，則表示發行集屬性定義不正確，或者該發行集不存在。</span><span class="sxs-lookup"><span data-stu-id="607b9-230">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="607b9-231">從藉由現有 <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> 物件的 <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> 屬性進行存取的 <xref:Microsoft.SqlServer.Replication.PublisherMonitor> 。</span><span class="sxs-lookup"><span data-stu-id="607b9-231">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="607b9-232">執行下列其中一或多個方法，傳回有關此發行集的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-232">Execute one or more of the following methods to return information about this publication.</span></span>  
  
    -   <span data-ttu-id="607b9-233"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumErrorRecords%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關所指定錯誤的錯誤記錄。</span><span class="sxs-lookup"><span data-stu-id="607b9-233"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains error records about the specified error.</span></span>  
  
    -   <span data-ttu-id="607b9-234"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumLogReaderAgent%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關此發行集之「記錄讀取器代理程式」的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-234"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumLogReaderAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Log Reader Agent for this publication.</span></span>  
  
    -   <span data-ttu-id="607b9-235"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關為此發行集所設的監視警告臨界值的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-235"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> - returns a <xref:System.Data.DataSet> object that contains information about the monitor warning thresholds set for this publication.</span></span>  
  
    -   <span data-ttu-id="607b9-236"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumQueueReaderAgent%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關此發行集所使用之「佇列讀取器代理程式」的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-236"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumQueueReaderAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Queue Reader Agent used by this publication.</span></span>  
  
    -   <span data-ttu-id="607b9-237"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSnapshotAgent%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關此發行集的「快照集代理程式」的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-237"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSnapshotAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Snapshot Agent for this publication.</span></span>  
  
    -   <span data-ttu-id="607b9-238"><xref:Microsoft.SqlServer.Replication.Publication.EnumSubscriptions%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關此發行集訂閱的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-238"><xref:Microsoft.SqlServer.Replication.Publication.EnumSubscriptions%2A> - returns a <xref:System.Data.DataSet> object that contains information about subscriptions to this publication.</span></span>  
  
    -   <span data-ttu-id="607b9-239"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSubscriptions2%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含根據提供的 <xref:Microsoft.SqlServer.Replication.SubscriptionResultOption>而定的此發行集訂閱的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-239"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSubscriptions2%2A> - returns a <xref:System.Data.DataSet> object that contains additional information about subscriptions to this publication based on the supplied <xref:Microsoft.SqlServer.Replication.SubscriptionResultOption>.</span></span>  
  
    -   <span data-ttu-id="607b9-240"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokenHistory%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含所指定之追蹤 Token 的延遲資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-240"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokenHistory%2A> - returns a <xref:System.Data.DataSet> object that contains latency information for the specified tracer token.</span></span>  
  
    -   <span data-ttu-id="607b9-241"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> - 傳回 <xref:System.Data.DataSet> 物件，其中包含有關插入至此發行集的所有追蹤 Token 的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="607b9-241"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> - returns a <xref:System.Data.DataSet> object that contains information about all tracer tokens inserted into this publication.</span></span>  
  
#### <a name="to-monitor-transactional-commands-that-are-waiting-to-be-applied-at-the-subscriber"></a><span data-ttu-id="607b9-242">若要監視在訂閱者端等候套用的交易式命令</span><span class="sxs-lookup"><span data-stu-id="607b9-242">To monitor transactional commands that are waiting to be applied at the Subscriber</span></span>  
  
1.  <span data-ttu-id="607b9-243">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 類別建立與散發者的連接。</span><span class="sxs-lookup"><span data-stu-id="607b9-243">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="607b9-244">以下列其中一種方法取得 <xref:Microsoft.SqlServer.Replication.PublicationMonitor> 物件。</span><span class="sxs-lookup"><span data-stu-id="607b9-244">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="607b9-245">建立 <xref:Microsoft.SqlServer.Replication.PublicationMonitor> 類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="607b9-245">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="607b9-246">設定發行集的 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>和 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> 屬性，並將 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 屬性設定為在步驟 1 中建立的 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 。</span><span class="sxs-lookup"><span data-stu-id="607b9-246">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="607b9-247">呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法以取得物件的屬性。</span><span class="sxs-lookup"><span data-stu-id="607b9-247">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="607b9-248">如果此方法傳回 `false`，則表示發行集屬性定義不正確，或者該發行集不存在。</span><span class="sxs-lookup"><span data-stu-id="607b9-248">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="607b9-249">從藉由現有 <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> 物件的 <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> 屬性進行存取的 <xref:Microsoft.SqlServer.Replication.PublisherMonitor> 。</span><span class="sxs-lookup"><span data-stu-id="607b9-249">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="607b9-250">執行 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.TransPendingCommandInfo%2A> 方法，傳回 <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> 物件。</span><span class="sxs-lookup"><span data-stu-id="607b9-250">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.TransPendingCommandInfo%2A> method, which returns a <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> object.</span></span>  
  
4.  <span data-ttu-id="607b9-251">使用此 <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> 物件的屬性判斷暫止命令的估計數，以及完成傳遞這些命令所需的時間長度。</span><span class="sxs-lookup"><span data-stu-id="607b9-251">Use the properties of this <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> object to determine the estimated number of pending commands and the length of time it will take to complete the delivery of these commands.</span></span>  
  
#### <a name="to-set-the-monitor-warning-thresholds-for-a-publication"></a><span data-ttu-id="607b9-252">若要設定發行集的監視器警告臨界值</span><span class="sxs-lookup"><span data-stu-id="607b9-252">To set the monitor warning thresholds for a publication</span></span>  
  
1.  <span data-ttu-id="607b9-253">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 類別建立與散發者的連接。</span><span class="sxs-lookup"><span data-stu-id="607b9-253">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="607b9-254">以下列其中一種方法取得 <xref:Microsoft.SqlServer.Replication.PublicationMonitor> 物件。</span><span class="sxs-lookup"><span data-stu-id="607b9-254">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="607b9-255">建立 <xref:Microsoft.SqlServer.Replication.PublicationMonitor> 類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="607b9-255">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="607b9-256">設定發行集的 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>和 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> 屬性，並將 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 屬性設定為在步驟 1 中建立的 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 。</span><span class="sxs-lookup"><span data-stu-id="607b9-256">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="607b9-257">呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法以取得物件的屬性。</span><span class="sxs-lookup"><span data-stu-id="607b9-257">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="607b9-258">如果此方法傳回 `false`，則表示發行集屬性定義不正確，或者該發行集不存在。</span><span class="sxs-lookup"><span data-stu-id="607b9-258">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="607b9-259">從藉由現有 <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> 物件的 <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> 屬性進行存取的 <xref:Microsoft.SqlServer.Replication.PublisherMonitor> 。</span><span class="sxs-lookup"><span data-stu-id="607b9-259">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="607b9-260">執行 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="607b9-260">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> method.</span></span> <span data-ttu-id="607b9-261">請注意在 <xref:System.Collections.ArrayList> 物件的傳回 <xref:Microsoft.SqlServer.Replication.MonitorThreshold> 中的目前臨界值設定。</span><span class="sxs-lookup"><span data-stu-id="607b9-261">Note the current threshold settings in the returned <xref:System.Collections.ArrayList> of <xref:Microsoft.SqlServer.Replication.MonitorThreshold> objects.</span></span>  
  
4.  <span data-ttu-id="607b9-262">執行 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.ChangeMonitorThreshold%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="607b9-262">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.ChangeMonitorThreshold%2A> method.</span></span> <span data-ttu-id="607b9-263">傳遞下列參數：</span><span class="sxs-lookup"><span data-stu-id="607b9-263">Pass the following parameters:</span></span>  
  
    -   <span data-ttu-id="607b9-264">*metricID* - <xref:System.Int32> 值，代表來自下列資料表的監視臨界值標準：</span><span class="sxs-lookup"><span data-stu-id="607b9-264">*metricID* - an <xref:System.Int32> value that represents the monitoring threshold metric from the following table:</span></span>  
  
        |<span data-ttu-id="607b9-265">值</span><span class="sxs-lookup"><span data-stu-id="607b9-265">Value</span></span>|<span data-ttu-id="607b9-266">描述</span><span class="sxs-lookup"><span data-stu-id="607b9-266">Description</span></span>|  
        |-----------|-----------------|  
        |<span data-ttu-id="607b9-267">1</span><span class="sxs-lookup"><span data-stu-id="607b9-267">1</span></span>|<span data-ttu-id="607b9-268">`expiration` - 監視交易式發行集的訂閱是否即將到期。</span><span class="sxs-lookup"><span data-stu-id="607b9-268">`expiration` - monitors for imminent expiration of subscriptions to transactional publications.</span></span>|  
        |<span data-ttu-id="607b9-269">2</span><span class="sxs-lookup"><span data-stu-id="607b9-269">2</span></span>|<span data-ttu-id="607b9-270">`latency` - 監視交易式發行集的訂閱效能。</span><span class="sxs-lookup"><span data-stu-id="607b9-270">`latency` - monitors for the performance of subscriptions to transactional publications.</span></span>|  
        |<span data-ttu-id="607b9-271">4</span><span class="sxs-lookup"><span data-stu-id="607b9-271">4</span></span>|<span data-ttu-id="607b9-272">`mergeexpiration` - 監視合併式發行集的訂閱是否即將到期。</span><span class="sxs-lookup"><span data-stu-id="607b9-272">`mergeexpiration` - monitors for imminent expiration of subscriptions to merge publications.</span></span>|  
        |<span data-ttu-id="607b9-273">5</span><span class="sxs-lookup"><span data-stu-id="607b9-273">5</span></span>|<span data-ttu-id="607b9-274">`mergeslowrunduration` - 監視透過低頻寬 (撥號) 連接進行合併同步處理的持續時間。</span><span class="sxs-lookup"><span data-stu-id="607b9-274">`mergeslowrunduration` - monitors the duration of merge synchronizations over low-bandwidth (dialup) connections.</span></span>|  
        |<span data-ttu-id="607b9-275">6</span><span class="sxs-lookup"><span data-stu-id="607b9-275">6</span></span>|<span data-ttu-id="607b9-276">`mergefastrunduration` - 監視透過高頻寬 (LAN) 連接進行合併同步處理的持續時間。</span><span class="sxs-lookup"><span data-stu-id="607b9-276">`mergefastrunduration` - monitors the duration of merge synchronizations over high-bandwidth (LAN) connections.</span></span>|  
        |<span data-ttu-id="607b9-277">7</span><span class="sxs-lookup"><span data-stu-id="607b9-277">7</span></span>|<span data-ttu-id="607b9-278">`mergefastrunspeed` - 監視透過高頻寬 (LAN) 連接進行合併同步處理的同步處理速率。</span><span class="sxs-lookup"><span data-stu-id="607b9-278">`mergefastrunspeed` - monitors the synchronization rate of merge synchronizations over high-bandwidth (LAN) connections.</span></span>|  
        |<span data-ttu-id="607b9-279">8</span><span class="sxs-lookup"><span data-stu-id="607b9-279">8</span></span>|<span data-ttu-id="607b9-280">`mergeslowrunspeed` - 監視透過低頻寬 (撥號) 連接進行合併同步處理的同步處理速率。</span><span class="sxs-lookup"><span data-stu-id="607b9-280">`mergeslowrunspeed` - monitors the synchronization rate of merge synchronizations over low-bandwidth (dialup) connections.</span></span>|  
  
    -   <span data-ttu-id="607b9-281">*enable* - <xref:System.Boolean> 值，代表是否已針對發行集啟用標準。</span><span class="sxs-lookup"><span data-stu-id="607b9-281">*enable* - <xref:System.Boolean> value that indicates whether the metric is enabled for the publication.</span></span>  
  
    -   <span data-ttu-id="607b9-282">*thresholdValue* - 設定臨界值的整數值。</span><span class="sxs-lookup"><span data-stu-id="607b9-282">*thresholdValue* - integer value that sets the threshold.</span></span>  
  
    -   <span data-ttu-id="607b9-283">*shouldAlert* - 代表此臨界值是否應產生警示的整數。</span><span class="sxs-lookup"><span data-stu-id="607b9-283">*shouldAlert* - integer that indicates whether this threshold should generate an alert.</span></span>  
  
  
