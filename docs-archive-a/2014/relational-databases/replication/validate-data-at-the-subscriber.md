---
title: 驗證複寫的資料 | Microsoft 文件
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- Subscribers [SQL Server replication], data validation
- replication [SQL Server], validating data
- transactional replication, validating data
- validating data
- merge replication data validation [SQL Server replication], SQL Server Management Studio
ms.assetid: 215b4c9a-0ce9-4c00-ac0b-43b54151dfa3
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 4d09750c0cb81d64f5921ae2064b2e75edb6ca96
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87584377"
---
# <a name="validate-replicated-data"></a><span data-ttu-id="fb780-102">驗證複寫的資料</span><span class="sxs-lookup"><span data-stu-id="fb780-102">Validate Replicated Data</span></span>
  <span data-ttu-id="fb780-103">本主題描述如何使用 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 、 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]或 Replication Management Objects (RMO)，在 [!INCLUDE[tsql](../../includes/tsql-md.md)]中驗證訂閱者端的資料。</span><span class="sxs-lookup"><span data-stu-id="fb780-103">This topic describes how to validate data at the Subscriber in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span>  

  <span data-ttu-id="fb780-104">交易式與合併式複寫可以讓您驗證訂閱者端的資料是否與發行者端的資料相符。</span><span class="sxs-lookup"><span data-stu-id="fb780-104">Transactional and merge replication allow you to validate that data at the Subscriber matches data at the Publisher.</span></span> <span data-ttu-id="fb780-105">可以驗證特定的訂閱或發行的所有訂閱。</span><span class="sxs-lookup"><span data-stu-id="fb780-105">Validation can be performed for specific subscriptions or for all subscriptions to a publication.</span></span> <span data-ttu-id="fb780-106">指定下列其中一種驗證類型，「散發代理程式」或「合併代理程式」將在下次執行時驗證資料：</span><span class="sxs-lookup"><span data-stu-id="fb780-106">Specify one of the following validation types and the Distribution Agent or Merge Agent will validate data the next time it runs:</span></span>  
  
-   <span data-ttu-id="fb780-107">**僅限資料列計數**。</span><span class="sxs-lookup"><span data-stu-id="fb780-107">**Row count only**.</span></span> <span data-ttu-id="fb780-108">這將會驗證「訂閱者」上的資料表與「發行者」上的資料表是否具有相同數量的資料列，但無法驗證資料列內容是否相符。</span><span class="sxs-lookup"><span data-stu-id="fb780-108">This validates whether the table at the Subscriber has the same number of rows as the table at the Publisher, but does not validate that the content of the rows matches.</span></span> <span data-ttu-id="fb780-109">資料列計數驗證提供一種輕量型驗證方法，可讓您發現資料中的問題。</span><span class="sxs-lookup"><span data-stu-id="fb780-109">Row count validation provides a lightweight approach to validation that can make you aware of issues with your data.</span></span>    
-   <span data-ttu-id="fb780-110">**資料列計數與二進位總和檢查碼。**</span><span class="sxs-lookup"><span data-stu-id="fb780-110">**Row count and binary checksum**.</span></span> <span data-ttu-id="fb780-111">除了統計「發行者」與「訂閱者」上的資料列數量之外，也會使用總和檢查碼演算法計算所有資料的總和檢查碼。</span><span class="sxs-lookup"><span data-stu-id="fb780-111">In addition to taking a count of rows at the Publisher and Subscriber, a checksum of all the data is calculated using the checksum algorithm.</span></span> <span data-ttu-id="fb780-112">如果資料列計數失敗，就不會執行總和檢查碼。</span><span class="sxs-lookup"><span data-stu-id="fb780-112">If the row count fails, the checksum is not performed.</span></span>  
  
 <span data-ttu-id="fb780-113">除驗證「訂閱者」與「發行者」上的資料是否相符外，合併代理程式還可以驗證是否為每個「訂閱者」正確分割資料。</span><span class="sxs-lookup"><span data-stu-id="fb780-113">In addition to validating that data at the Subscriber and Publisher match, merge replication provides the ability to validate that data is partitioned correctly for each Subscriber.</span></span> <span data-ttu-id="fb780-114">如需詳細資訊，請參閱[驗證合併訂閱者的資料分割資訊](validate-partition-information-for-a-merge-subscriber.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-114">For more information, see [Validate Partition Information for a Merge Subscriber](validate-partition-information-for-a-merge-subscriber.md).</span></span>  

## <a name="how-data-validation-works"></a><span data-ttu-id="fb780-115">資料驗證如何運作</span><span class="sxs-lookup"><span data-stu-id="fb780-115">How Data Validation Works</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="fb780-116">藉由計算「發行者」的資料列計數或總和檢查碼，然後將那些值與「訂閱者」所計算的資料列計數或總和檢查碼相比較，以驗證其資料。</span><span class="sxs-lookup"><span data-stu-id="fb780-116">validates data by calculating a row count or a checksum at the Publisher and then comparing those values to the row count or checksum calculated at the Subscriber.</span></span> <span data-ttu-id="fb780-117">整個發行集資料表計算一個值，整個訂閱資料表也計算一個值，但是 `text`、`ntext` 或 `image` 資料行的資料不包含在其計算中。</span><span class="sxs-lookup"><span data-stu-id="fb780-117">One value is calculated for the entire publication table and one value is calculated for the entire subscription table, but data in `text`, `ntext`, or `image` columns is not included in the calculations.</span></span>  
  
 <span data-ttu-id="fb780-118">在執行計算時，會暫時以共用鎖定來鎖定正在執行資料列計數或總和檢查碼的資料表，但此計算會迅速完成，並移除共用鎖定，通常只需要數秒鐘。</span><span class="sxs-lookup"><span data-stu-id="fb780-118">While the calculations are performed, shared locks are placed temporarily on tables for which row counts or checksums are being run, but the calculations are completed quickly and the shared locks removed, usually in a matter of seconds.</span></span>  
  
 <span data-ttu-id="fb780-119">使用二進位總和檢查碼時，資料行會逐一發生 32 位元的 Redundancy Check (CRC)，而不是資料頁中實際資料列的 CRC。</span><span class="sxs-lookup"><span data-stu-id="fb780-119">When binary checksums are used, 32-bit redundancy check (CRC) occurs on a column-by-column basis rather than a CRC on the physical row on the data page.</span></span> <span data-ttu-id="fb780-120">如此可讓具有該資料表的資料行在資料頁以任何次序排序，而仍可計算資料列的相同 CRC。</span><span class="sxs-lookup"><span data-stu-id="fb780-120">This allows the columns with the table to be in any order physically on the data page, but still compute to the same CRC for the row.</span></span> <span data-ttu-id="fb780-121">發行集具有資料列或資料行篩選時，可以使用二進位總和檢查碼驗證。</span><span class="sxs-lookup"><span data-stu-id="fb780-121">Binary checksum validation can be used when there are row or column filters on the publication.</span></span>  
  
 <span data-ttu-id="fb780-122">驗證資料是一個三部份式的處理：</span><span class="sxs-lookup"><span data-stu-id="fb780-122">Validating data is a three-part process:</span></span>  
  
1.  <span data-ttu-id="fb780-123">*「標示」* 要驗證之發行集的單個或所有訂閱。</span><span class="sxs-lookup"><span data-stu-id="fb780-123">A single subscription or all subscriptions to a publication are *marked* for validation.</span></span> <span data-ttu-id="fb780-124">在 [驗證單一訂閱] 、[驗證多個訂閱] 和 [驗證所有訂閱]  對話方塊 (位於 [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]的 [本機發行集]資料夾和 [本機訂閱]資料夾) 中標示要驗證的訂閱。</span><span class="sxs-lookup"><span data-stu-id="fb780-124">Mark subscriptions for validation in the **Validate Subscription**, **Validate Subscriptions**, and **Validate All Subscriptions** dialog boxes, which are available from the **Local Publications** folder and the **Local Subscriptions** folder in [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="fb780-125">您也可以從複寫監視器中的 **[所有訂閱]** 索引標籤、 **[訂閱監看清單]** 索引標籤和發行集節點標示訂閱。</span><span class="sxs-lookup"><span data-stu-id="fb780-125">You can also mark subscriptions from the **All Subscriptions** tab, the **Subscription Watch List** tab, and the publications node in Replication Monitor.</span></span> <span data-ttu-id="fb780-126">如需啟動複寫監視器的詳細資訊，請參閱[啟動複寫監視器](monitor/start-the-replication-monitor.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-126">For information about starting Replication Monitor, see [Start the Replication Monitor](monitor/start-the-replication-monitor.md).</span></span>  
  
2.  <span data-ttu-id="fb780-127">在下一次由「散發代理程式」(用於異動複寫) 或「合併代理程式」(用於合併式複寫) 進行同步時，將對訂閱進行驗證。</span><span class="sxs-lookup"><span data-stu-id="fb780-127">A subscription is validated the next time it is synchronized by the Distribution Agent (for transactional replication) or the Merge Agent (for merge replication).</span></span> <span data-ttu-id="fb780-128">「散發代理程式」通常連續執行，此時可立即進行驗證；「合併代理程式」通常視需要執行，此時驗證將在執行代理程式後進行。</span><span class="sxs-lookup"><span data-stu-id="fb780-128">The Distribution Agent typically runs continuously, in which case validation occurs immediately; the Merge Agent typically runs on demand, in which case validation occurs after you run the agent.</span></span>  
  
3.  <span data-ttu-id="fb780-129">檢視驗證結果：</span><span class="sxs-lookup"><span data-stu-id="fb780-129">View the validation results:</span></span>  
  
    -  <span data-ttu-id="fb780-130">在「複寫監視器」的詳細資料視窗中：用於異動複寫的 **[散發者到訂閱者記錄]** 索引標籤和用於合併式複寫的 **[同步處理記錄]** 索引標籤上。</span><span class="sxs-lookup"><span data-stu-id="fb780-130">In the detail windows in Replication Monitor: on the **Distributor to Subscriber History** tab for transactional replication and the **Synchronization History** tab for merge replication.</span></span>    
    -  <span data-ttu-id="fb780-131">在 **的** [檢視同步處理的狀態] [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)]對話方塊中。</span><span class="sxs-lookup"><span data-stu-id="fb780-131">In the **View Synchronization Status** dialog box in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)].</span></span>  
  


  
## <a name="considerations-and-restrictions"></a><span data-ttu-id="fb780-132">考量與限制</span><span class="sxs-lookup"><span data-stu-id="fb780-132">Considerations and restrictions</span></span>  
  
-   <span data-ttu-id="fb780-133">「複寫監視器」的程序僅用於發送訂閱，因為發送訂閱無法在「複寫監視器」中同步。</span><span class="sxs-lookup"><span data-stu-id="fb780-133">The procedures for Replication Monitor are for push subscriptions only because pull subscriptions cannot be synchronized in Replication Monitor.</span></span> <span data-ttu-id="fb780-134">但是，您可以標示要驗證的訂閱，並在「複寫監視器」中檢視發送訂閱的驗證結果。</span><span class="sxs-lookup"><span data-stu-id="fb780-134">However, you can mark a subscription for validation and view validation results for pull subscriptions in Replication Monitor.</span></span>    
-   <span data-ttu-id="fb780-135">驗證結果會指示驗證成功或失敗，但不會在驗證失敗時指定失敗的資料列。</span><span class="sxs-lookup"><span data-stu-id="fb780-135">The validation results indicate whether validation succeeded or failed, but do not specify which rows failed validation if a failure occurred.</span></span> <span data-ttu-id="fb780-136">若要比較「發行者」和「訂閱者」端的資料，請使用 [tablediff Utility](../../tools/tablediff-utility.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-136">To compare data at the Publisher and Subscriber, use the [tablediff Utility](../../tools/tablediff-utility.md).</span></span> <span data-ttu-id="fb780-137">如需使用這個公用程式與複寫資料的詳細資訊，請參閱[比較複寫資料表的差異 &#40;複寫程式設計&#41;](administration/compare-replicated-tables-for-differences-replication-programming.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-137">For more information about using this utility with replicated data, see [Compare Replicated Tables for Differences &#40;Replication Programming&#41;](administration/compare-replicated-tables-for-differences-replication-programming.md).</span></span>  
 
<span data-ttu-id="fb780-138">在驗證資料時，請考慮下列問題：</span><span class="sxs-lookup"><span data-stu-id="fb780-138">Take the following issues into consideration when validating data:</span></span>  
  
-   <span data-ttu-id="fb780-139">您必須在驗證資料之前停止「訂閱者」上的所有更新活動 (在進行驗證時不必停止「發行者」上的活動)。</span><span class="sxs-lookup"><span data-stu-id="fb780-139">You must stop all update activity at Subscribers before validating data (it is not necessary to stop activity at the Publisher when validation is occurring).</span></span>    
-   <span data-ttu-id="fb780-140">由於總和檢查碼與二進位總和檢查碼在驗證大型資料集時，可能需要使用大量的處理器資源，因此應該將驗證排在伺服器複寫活動最少的時間來進行。</span><span class="sxs-lookup"><span data-stu-id="fb780-140">Because checksums and binary checksums can require large amounts of processor resources when validating a large data set, you should schedule validation to occur when there is the least activity on the servers used in replication.</span></span>    
-   <span data-ttu-id="fb780-141">複寫僅驗證資料表；它無法驗證只有結構描述的發行項 (例如預存程序) 在「發行者」與「訂閱者」上是否相同。</span><span class="sxs-lookup"><span data-stu-id="fb780-141">Replication validates tables only; it does not validate whether schema only articles (such as stored procedures) are the same at the Publisher and Subscriber.</span></span>    
-   <span data-ttu-id="fb780-142">二進位總和檢查碼可以與任何已發行資料表一起使用。</span><span class="sxs-lookup"><span data-stu-id="fb780-142">Binary checksum can be used with any published table.</span></span> <span data-ttu-id="fb780-143">總和檢查碼無法驗證具有資料行篩選或其中資料行位移不同 (由於 ALTER TABLE 陳述式卸除或新增資料行) 的邏輯資料表結構的資料表。</span><span class="sxs-lookup"><span data-stu-id="fb780-143">Checksum cannot validate tables with column filters, or logical table structures where column offsets differ (due to ALTER TABLE statements that drop or add columns).</span></span>    
-   <span data-ttu-id="fb780-144">複寫驗證會使用 `checksum` 和**binary_checksum**函數。</span><span class="sxs-lookup"><span data-stu-id="fb780-144">Replication validation uses the `checksum` and **binary_checksum** functions.</span></span> <span data-ttu-id="fb780-145">如需其行為的資訊，請參閱[總和檢查碼 &#40;Transact-SQL&#41;](/sql/t-sql/functions/checksum-transact-sql) 和 [BINARY_CHECKSUM  &#40;Transact-SQL&#41;](/sql/t-sql/functions/binary-checksum-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="fb780-145">For  information about their behavior, see  [CHECKSUM &#40;Transact-SQL&#41;](/sql/t-sql/functions/checksum-transact-sql) and [BINARY_CHECKSUM  &#40;Transact-SQL&#41;](/sql/t-sql/functions/binary-checksum-transact-sql).</span></span>  
  
-   <span data-ttu-id="fb780-146">如果「訂閱者」與「發行者」端的資料類型不同，則使用二進位總和檢查碼或總和檢查碼的驗證可能會誤報失敗。</span><span class="sxs-lookup"><span data-stu-id="fb780-146">Validation by using binary checksum or checksum can incorrectly report a failure if data types are different at the Subscriber than they are at the Publisher.</span></span> <span data-ttu-id="fb780-147">如果執行下列任何一項作業，就可能發生上述情況：</span><span class="sxs-lookup"><span data-stu-id="fb780-147">This can occur if you do any one of the following:</span></span>    
    -   <span data-ttu-id="fb780-148">將結構描述選項明確地設定為對應舊版 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]的資料類型。</span><span class="sxs-lookup"><span data-stu-id="fb780-148">Explicitly set schema options to map data types for earlier versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>    
    -   <span data-ttu-id="fb780-149">將合併式發行集的發行集相容性層級設定為舊版 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]，而已發行的資料表則包含一或多個必須對應此版本的資料類型。</span><span class="sxs-lookup"><span data-stu-id="fb780-149">Set the publication compatibility level for a merge publication to an earlier version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], and published tables contain one or more data types that must be mapped for this version.</span></span>    
    -   <span data-ttu-id="fb780-150">手動初始化訂閱且在「訂閱者」端使用不同的資料類型。</span><span class="sxs-lookup"><span data-stu-id="fb780-150">Manually initialize a subscription and are using different data types at the Subscriber.</span></span>    
-   <span data-ttu-id="fb780-151">異動複寫的可轉換訂閱不支援二進位總和檢查碼與總和檢查碼驗證。</span><span class="sxs-lookup"><span data-stu-id="fb780-151">Binary checksum and checksum validations are not supported for transformable subscriptions for transactional replication.</span></span>   
-   <span data-ttu-id="fb780-152">複寫給非「[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 訂閱者」的資料不支援驗證。</span><span class="sxs-lookup"><span data-stu-id="fb780-152">Validation is not supported for data replicated to non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers.</span></span>  

## <a name="data-validation-results"></a><span data-ttu-id="fb780-153">資料驗證結果</span><span class="sxs-lookup"><span data-stu-id="fb780-153">Data Validation Results</span></span>  
 <span data-ttu-id="fb780-154">當驗證完成時，「散發代理程式」或「合併代理程式」將記錄有關成功或失敗的訊息 (複寫不會報告具體是哪些資料列失敗)。</span><span class="sxs-lookup"><span data-stu-id="fb780-154">When validation is complete, the Distribution Agent or Merge Agent logs messages regarding success or failure (replication does not report which rows failed).</span></span> <span data-ttu-id="fb780-155">可以在 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]、「複寫監視器」和複寫系統資料表中檢視這些訊息。</span><span class="sxs-lookup"><span data-stu-id="fb780-155">These messages can be viewed in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], Replication Monitor, and replication system tables.</span></span> <span data-ttu-id="fb780-156">以上列出的「如何」主題示範如何執行驗證並檢視結果。</span><span class="sxs-lookup"><span data-stu-id="fb780-156">The how-to topic listed above demonstrates how to run validation and view the results.</span></span>  
  
 <span data-ttu-id="fb780-157">若要處理驗證失敗，請考慮下列各項：</span><span class="sxs-lookup"><span data-stu-id="fb780-157">To handle validation failures, consider the following:</span></span>  
  
-   <span data-ttu-id="fb780-158">設定名稱為 **複寫: 訂閱者資料驗證失敗** 的複寫警示，以便通知您失敗的情況。</span><span class="sxs-lookup"><span data-stu-id="fb780-158">Configure the replication alert named **Replication: Subscriber has failed data validation** so that you are notified of the failure.</span></span> <span data-ttu-id="fb780-159">如需詳細資訊，請參閱 [設定預先定義的複寫警示 &#40;SQL Server Management Studio& # 41 (系統管理/設定預先定義-----SQL Server Management-Studio. md) 。</span><span class="sxs-lookup"><span data-stu-id="fb780-159">For more information, see [Configure Predefined Replication Alerts &#40;SQL Server Management Studio&#41(administration/configure-predefined-replication-alerts-sql-server-management-studio.md).</span></span>  
  
-   <span data-ttu-id="fb780-160">您的應用程式是否有驗證失敗的問題？</span><span class="sxs-lookup"><span data-stu-id="fb780-160">Is the fact that validation failed an issue for your application?</span></span> <span data-ttu-id="fb780-161">如果有驗證失敗的問題，請手動更新資料以便對其進行同步處理，或重新初始化訂閱：</span><span class="sxs-lookup"><span data-stu-id="fb780-161">If the validation failure is an issue, manually update the data so that it is synchronized, or reinitialize the subscription:</span></span>  
  
    -   <span data-ttu-id="fb780-162">可以使用 [tablediff 公用程式](../../tools/tablediff-utility.md)更新資料。</span><span class="sxs-lookup"><span data-stu-id="fb780-162">Data can be updated using the [tablediff utility](../../tools/tablediff-utility.md).</span></span> <span data-ttu-id="fb780-163">如需使用此公用程式的詳細資訊，請參閱[比較複寫資料表的差異 &#40;複寫程式設計&#41;](administration/compare-replicated-tables-for-differences-replication-programming.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-163">For more information about using this utility, see [Compare Replicated Tables for Differences &#40;Replication Programming&#41;](administration/compare-replicated-tables-for-differences-replication-programming.md).</span></span>  
  
    -   <span data-ttu-id="fb780-164">如需詳細資訊，請參閱[重新初始化訂閱](reinitialize-subscriptions.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-164">For more information about reinitializaton, see [Reinitialize Subscriptions](reinitialize-subscriptions.md).</span></span>   
 
  
## <a name="articles-in-transactional-replication"></a><span data-ttu-id="fb780-165">異動複寫中的發行項</span><span class="sxs-lookup"><span data-stu-id="fb780-165">Articles in Transactional Replication</span></span> 

### <a name="using-sql-server-management-studio"></a><span data-ttu-id="fb780-166">使用 SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="fb780-166">Using SQL Server Management Studio</span></span>  
  
  
1.  <span data-ttu-id="fb780-167">連接到 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]中的發行者，然後展開伺服器節點。</span><span class="sxs-lookup"><span data-stu-id="fb780-167">Connect to the Publisher in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>    
2.  <span data-ttu-id="fb780-168">展開 **[複寫]** 資料夾，然後展開 **[本機發行集]** 資料夾。</span><span class="sxs-lookup"><span data-stu-id="fb780-168">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>    
3.  <span data-ttu-id="fb780-169">以滑鼠右鍵按一下您要驗證訂閱的發行集，然後按一下 **[驗證訂閱]** 。</span><span class="sxs-lookup"><span data-stu-id="fb780-169">Right-click the publication for which you want to validate subscriptions, and then click **Validate Subscriptions**.</span></span>    
4.  <span data-ttu-id="fb780-170">在 **[驗證訂閱]** 對話方塊中，選取要驗證的訂閱：</span><span class="sxs-lookup"><span data-stu-id="fb780-170">In the **Validate Subscriptions** dialog box, select which subscriptions to validate:</span></span>    
    -   <span data-ttu-id="fb780-171">選取 **[驗證所有的 SQL Server 訂閱]** 。</span><span class="sxs-lookup"><span data-stu-id="fb780-171">Select **Validate all SQL Server subscriptions**.</span></span>    
    -   <span data-ttu-id="fb780-172">選取 **[驗證下列訂閱]** ，然後選取一或多個訂閱。</span><span class="sxs-lookup"><span data-stu-id="fb780-172">Select **Validate the following subscriptions**, and then select one or more subscriptions.</span></span>    
5.  <span data-ttu-id="fb780-173">若要指定要執行驗證的類型 (資料列計數，或資料列計數與總和檢查碼)，請按一下 **[驗證選項]** ，然後在 **[訂閱驗證選項]** 對話方塊中指定選項。</span><span class="sxs-lookup"><span data-stu-id="fb780-173">To specify the type of validation to perform (row count, or row count and checksum) click **Validation Options**, and then specify options in the **Subscription Validation Options** dialog box.</span></span>    
6.  [!INCLUDE[clickOK](../../includes/clickok-md.md)]  
  
7.  <span data-ttu-id="fb780-174">在複寫監視器或 **[檢視同步處理的狀態]** 對話方塊中檢視驗證結果。</span><span class="sxs-lookup"><span data-stu-id="fb780-174">View validation results in Replication Monitor or the **View Synchronization Status** dialog box.</span></span> <span data-ttu-id="fb780-175">針對每個訂閱：</span><span class="sxs-lookup"><span data-stu-id="fb780-175">For each subscription:</span></span>    
    1.  <span data-ttu-id="fb780-176">展開發行集，以滑鼠右鍵按一下訂閱，然後按一下 **[檢視同步處理的狀態]** 。</span><span class="sxs-lookup"><span data-stu-id="fb780-176">Expand the publication, right-click the subscription, and then click **View Synchronization Status**.</span></span>    
    2.  <span data-ttu-id="fb780-177">如果代理程式尚未執行，請按一下 **[檢視同步處理的狀態]** 對話方塊中的 **[啟動]** 。</span><span class="sxs-lookup"><span data-stu-id="fb780-177">If the agent is not running click **Start** in the **View Synchronization Status** dialog box.</span></span> <span data-ttu-id="fb780-178">對話方塊就會顯示關於驗證的參考用訊息。</span><span class="sxs-lookup"><span data-stu-id="fb780-178">The dialog box will display informational messages regarding validation.</span></span>  
  
     <span data-ttu-id="fb780-179">如果您未看到任何關於驗證的訊息，則代理程式已經記錄了後續訊息。</span><span class="sxs-lookup"><span data-stu-id="fb780-179">If you do not see any messages regarding validation, the agent has already logged a subsequent message.</span></span> <span data-ttu-id="fb780-180">在此情況下，請在複寫監視器中檢視驗證結果。</span><span class="sxs-lookup"><span data-stu-id="fb780-180">In this case, view the validation results in Replication Monitor.</span></span> <span data-ttu-id="fb780-181">如需詳細資訊，請參閱這個主題中＜複寫監視器＞的如何程序。</span><span class="sxs-lookup"><span data-stu-id="fb780-181">For more information, see the Replication Monitor how to procedures in this topic.</span></span>  

### <a name="using-transact-sql-t-sql"></a><span data-ttu-id="fb780-182">使用 Transact-SQL (T-SQL)</span><span class="sxs-lookup"><span data-stu-id="fb780-182">Using Transact-SQL (T-SQL)</span></span>

#### <a name="all-articles"></a><span data-ttu-id="fb780-183">所有發行項</span><span class="sxs-lookup"><span data-stu-id="fb780-183">All articles</span></span>
  
1.  <span data-ttu-id="fb780-184">在發行集資料庫的發行者端，執行 [sp_publication_validation &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-publication-validation-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="fb780-184">At the Publisher on the publication database, execute [sp_publication_validation &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-publication-validation-transact-sql).</span></span> <span data-ttu-id="fb780-185">指定\*\* \@ 發行**集，以及** \@ rowcount_only\*\*的下列其中一個值：</span><span class="sxs-lookup"><span data-stu-id="fb780-185">Specify **\@publication** and one of the following values for **\@rowcount_only**:</span></span>    
    -   <span data-ttu-id="fb780-186">**1** - 只限列數檢查 (預設值)</span><span class="sxs-lookup"><span data-stu-id="fb780-186">**1** - rowcount check only (the default)</span></span>    
    -   <span data-ttu-id="fb780-187">**2** - 列數及二進位總和檢查碼。</span><span class="sxs-lookup"><span data-stu-id="fb780-187">**2** - rowcount and binary checksum.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="fb780-188">當您執行 [sp_publication_validation &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-publication-validation-transact-sql) 時，會針對每個發行集中的發行項執行 [sp_article_validation &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-article-validation-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="fb780-188">When you execute [sp_publication_validation &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-publication-validation-transact-sql), [sp_article_validation &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-article-validation-transact-sql) is executed for each article in the publication.</span></span> <span data-ttu-id="fb780-189">若要成功地執行 [sp_publication_validation &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-publication-validation-transact-sql)，您必須有已發行基底資料表之所有資料行的 SELECT 權限。</span><span class="sxs-lookup"><span data-stu-id="fb780-189">To successfully execute [sp_publication_validation &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-publication-validation-transact-sql), you must have SELECT permissions on all columns in the published base tables.</span></span>  
  
2.  <span data-ttu-id="fb780-190">(選擇性) 針對每個訂閱啟動「散發代理程式」(如果尚未執行)。</span><span class="sxs-lookup"><span data-stu-id="fb780-190">(Optional) Start the Distribution Agent for each subscription if it is not already running.</span></span> <span data-ttu-id="fb780-191">如需相關資訊，請參閱 [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md) 以及 [Synchronize a Push Subscription](synchronize-a-push-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-191">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md) and [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>    
3.  <span data-ttu-id="fb780-192">檢查代理程式輸出，以取得驗證的結果。</span><span class="sxs-lookup"><span data-stu-id="fb780-192">Check the agent output for the result of the validation.</span></span> <span data-ttu-id="fb780-193">如需詳細資訊，請參閱[驗證複寫的資料](validate-data-at-the-subscriber.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-193">For more information, see [Validate Replicated Data](validate-data-at-the-subscriber.md).</span></span>  
  
#### <a name="single-article"></a><span data-ttu-id="fb780-194">單一發行項</span><span class="sxs-lookup"><span data-stu-id="fb780-194">Single article</span></span> 
  
1.  <span data-ttu-id="fb780-195">在發行集資料庫的發行者端，執行 [sp_article_validation &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-article-validation-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="fb780-195">At the Publisher on the publication database, execute [sp_article_validation &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-article-validation-transact-sql).</span></span> <span data-ttu-id="fb780-196">指定\*\* \@ 發行**集、發行** \@ 項的名稱，以及\*\* \*\* \@ rowcount_only\*\*的下列其中一個值：</span><span class="sxs-lookup"><span data-stu-id="fb780-196">Specify **\@publication**, the name of the article for **\@article**, and one of the following values for **\@rowcount_only**:</span></span>    
    -   <span data-ttu-id="fb780-197">**1** - 只限列數檢查 (預設值)</span><span class="sxs-lookup"><span data-stu-id="fb780-197">**1** - Rowcount check only (the default)</span></span>    
    -   <span data-ttu-id="fb780-198">**2** -資料列計數和二進位總和檢查碼。</span><span class="sxs-lookup"><span data-stu-id="fb780-198">**2** - Rowcount and binary checksum.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="fb780-199">若要成功地執行 [sp_article_validation &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-article-validation-transact-sql)，您必須有已發行基底資料表之所有資料行的 SELECT 權限。</span><span class="sxs-lookup"><span data-stu-id="fb780-199">To successfully execute [sp_article_validation &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-article-validation-transact-sql), you must have SELECT permissions on all columns in the published base table.</span></span>  
  
2.  <span data-ttu-id="fb780-200">(選擇性) 針對每個訂閱啟動「散發代理程式」(如果尚未執行)。</span><span class="sxs-lookup"><span data-stu-id="fb780-200">(Optional) Start the Distribution Agent for each subscription if it is not already running.</span></span> <span data-ttu-id="fb780-201">如需相關資訊，請參閱 [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md) 以及 [Synchronize a Push Subscription](synchronize-a-push-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-201">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md) and [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>    
3.  <span data-ttu-id="fb780-202">檢查代理程式輸出，以取得驗證的結果。</span><span class="sxs-lookup"><span data-stu-id="fb780-202">Check the agent output for the result of the validation.</span></span> <span data-ttu-id="fb780-203">如需詳細資訊，請參閱[驗證複寫的資料](validate-data-at-the-subscriber.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-203">For more information, see [Validate Replicated Data](validate-data-at-the-subscriber.md).</span></span>  
  
#### <a name="single-subscriber"></a><span data-ttu-id="fb780-204">單一訂閱者</span><span class="sxs-lookup"><span data-stu-id="fb780-204">Single subscriber</span></span>
  
1.  <span data-ttu-id="fb780-205">在發行集資料庫的發行者端，使用 [BEGIN TRANSACTION &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/begin-transaction-transact-sql) 來開啟明確交易。</span><span class="sxs-lookup"><span data-stu-id="fb780-205">At the Publisher on the publication database, open an explicit transaction using [BEGIN TRANSACTION &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/begin-transaction-transact-sql).</span></span>    
2.  <span data-ttu-id="fb780-206">在發行集資料庫的發行者端，執行 [sp_marksubscriptionvalidation &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-marksubscriptionvalidation-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="fb780-206">At the Publisher on the publication database, execute [sp_marksubscriptionvalidation &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-marksubscriptionvalidation-transact-sql).</span></span> <span data-ttu-id="fb780-207">指定\*\* \@ 發行**集、 \*\* \@ 訂閱**者的訂閱者名稱，以及\*\* \@ destination_db\*\*的訂閱資料庫名稱。</span><span class="sxs-lookup"><span data-stu-id="fb780-207">Specify the publication for **\@publication**, the name of the Subscriber for **\@subscriber**, and the name of the subscription database for **\@destination_db**.</span></span>    
3.  <span data-ttu-id="fb780-208">(選擇性) 針對每個要驗證的訂閱重複步驟 2。</span><span class="sxs-lookup"><span data-stu-id="fb780-208">(Optional) Repeat step 2 for each subscription being validated.</span></span>    
4.  <span data-ttu-id="fb780-209">在發行集資料庫的發行者端，執行 [sp_article_validation &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-article-validation-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="fb780-209">At the Publisher on the publication database, execute [sp_article_validation &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-article-validation-transact-sql).</span></span> <span data-ttu-id="fb780-210">指定\*\* \@ 發行**集、發行** \@ 項的名稱，以及\*\* \*\* \@ rowcount_only\*\*的下列其中一個值：</span><span class="sxs-lookup"><span data-stu-id="fb780-210">Specify **\@publication**, the name of the article for **\@article**, and one of the following values for **\@rowcount_only**:</span></span>    
    -   <span data-ttu-id="fb780-211">**1** - 只限列數檢查 (預設值)</span><span class="sxs-lookup"><span data-stu-id="fb780-211">**1** - Rowcount check only (the default)</span></span>    
    -   <span data-ttu-id="fb780-212">**2** -資料列計數和二進位總和檢查碼。</span><span class="sxs-lookup"><span data-stu-id="fb780-212">**2** - Rowcount and binary checksum.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="fb780-213">若要成功地執行 [sp_article_validation &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-article-validation-transact-sql)，您必須有已發行基底資料表之所有資料行的 SELECT 權限。</span><span class="sxs-lookup"><span data-stu-id="fb780-213">To successfully execute [sp_article_validation &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-article-validation-transact-sql), you must have SELECT permissions on all columns in the published base table.</span></span>  
  
5.  <span data-ttu-id="fb780-214">在發行集資料庫的發行者端，使用 [COMMIT TRANSACTION &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/commit-transaction-transact-sql) 來認可交易。</span><span class="sxs-lookup"><span data-stu-id="fb780-214">At the Publisher on the publication database, commit the transaction using [COMMIT TRANSACTION &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/commit-transaction-transact-sql).</span></span>    
6.  <span data-ttu-id="fb780-215">(選擇性) 針對每個要驗證的發行項重複步驟 1 到 5。</span><span class="sxs-lookup"><span data-stu-id="fb780-215">(Optional) Repeat steps 1 through 5 for each article being validated.</span></span>    
7.  <span data-ttu-id="fb780-216">(選擇性) 啟動「散發代理程式」(如果尚未執行)。</span><span class="sxs-lookup"><span data-stu-id="fb780-216">(Optional) Start the Distribution Agent if it is not already running.</span></span> <span data-ttu-id="fb780-217">如需相關資訊，請參閱 [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md) 以及 [Synchronize a Push Subscription](synchronize-a-push-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-217">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md) and [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>    
8.  <span data-ttu-id="fb780-218">檢查代理程式輸出，以取得驗證的結果。</span><span class="sxs-lookup"><span data-stu-id="fb780-218">Check the agent output for the result of the validation.</span></span> <span data-ttu-id="fb780-219">如需詳細資訊，請參閱 [Validate Data at the Subscriber](validate-data-at-the-subscriber.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-219">For more information, see [Validate Data at the Subscriber](validate-data-at-the-subscriber.md).</span></span>  

##  <a name="all-push-subscriptions-to-a-transactional-publication"></a><span data-ttu-id="fb780-220">交易式發行集的所有發送訂閱</span><span class="sxs-lookup"><span data-stu-id="fb780-220">All push subscriptions to a Transactional Publication</span></span> 

### <a name="using-replication-monitor"></a><span data-ttu-id="fb780-221">使用複寫監視器</span><span class="sxs-lookup"><span data-stu-id="fb780-221">Using Replication Monitor</span></span>
  
1.  <span data-ttu-id="fb780-222">在複寫監視器的左窗格中展開發行者群組，然後展開發行者。</span><span class="sxs-lookup"><span data-stu-id="fb780-222">In Replication Monitor, expand a Publisher group in the left pane, and then expand a Publisher.</span></span>    
2.  <span data-ttu-id="fb780-223">以滑鼠右鍵按一下您要驗證訂閱的發行集，然後按一下 **[驗證訂閱]**。</span><span class="sxs-lookup"><span data-stu-id="fb780-223">Right-click the publication for which you want to validate subscriptions, and then click **Validate Subscriptions**.</span></span>    
3.  <span data-ttu-id="fb780-224">在 **[驗證訂閱]** 對話方塊中，選取要驗證的訂閱：</span><span class="sxs-lookup"><span data-stu-id="fb780-224">In the **Validate Subscriptions** dialog box, select which subscriptions to validate:</span></span>    
    -   <span data-ttu-id="fb780-225">選取 **[驗證所有的 SQL Server 訂閱]**。</span><span class="sxs-lookup"><span data-stu-id="fb780-225">Select **Validate all SQL Server subscriptions**.</span></span>    
    -   <span data-ttu-id="fb780-226">選取 **[驗證下列訂閱]**，然後選取一或多個訂閱。</span><span class="sxs-lookup"><span data-stu-id="fb780-226">Select **Validate the following subscriptions**, and then select one or more subscriptions.</span></span>   
4.  <span data-ttu-id="fb780-227">若要指定要執行驗證的類型 (資料列計數，或資料列計數與總和檢查碼)，請按一下 **[驗證選項]**，然後在 **[訂閱驗證選項]** 對話方塊中指定選項。</span><span class="sxs-lookup"><span data-stu-id="fb780-227">To specify the type of validation to perform (row count, or row count and checksum) click **Validation Options**, and then specify options in the **Subscription Validation Options** dialog box.</span></span>    
5.  [!INCLUDE[clickOK](../../includes/clickok-md.md)]    
6.  <span data-ttu-id="fb780-228">按一下 **[所有訂閱]** 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="fb780-228">Click the **All Subscriptions** tab.</span></span>    
7.  <span data-ttu-id="fb780-229">檢視驗證結果。</span><span class="sxs-lookup"><span data-stu-id="fb780-229">View validation results.</span></span> <span data-ttu-id="fb780-230">針對每個發送訂閱：</span><span class="sxs-lookup"><span data-stu-id="fb780-230">For each push subscription:</span></span>   
    1.  <span data-ttu-id="fb780-231">如果代理程式未執行，請以滑鼠右鍵按一下訂閱，然後按一下 **[啟動同步處理]**。</span><span class="sxs-lookup"><span data-stu-id="fb780-231">If the agent is not running, right-click the subscription, and then click **Start Synchronizing**.</span></span>   
    2.  <span data-ttu-id="fb780-232">以滑鼠右鍵按一下訂閱，然後按一下 **[檢視詳細資料]**。</span><span class="sxs-lookup"><span data-stu-id="fb780-232">Right-click the subscription, and then click **View Details**.</span></span>    
    3.  <span data-ttu-id="fb780-233">檢視 **[所選取工作階段中的動作]** 文字區域之 **[散發者到訂閱者記錄]** 索引標籤中的資訊。</span><span class="sxs-lookup"><span data-stu-id="fb780-233">View information on the **Distributor to Subscriber History** tab in the **Actions in the selected session** text area.</span></span>  
  

## <a name="for-a-single-subscription-to-a-merge-publication"></a><span data-ttu-id="fb780-234">針對合併式發行集的單一訂閱</span><span class="sxs-lookup"><span data-stu-id="fb780-234">For a single subscription to a Merge Publication</span></span>
  
### <a name="using-sql-server-management-studio"></a><span data-ttu-id="fb780-235">使用 SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="fb780-235">Using SQL Server Management Studio</span></span>
  
1.  <span data-ttu-id="fb780-236">連接到 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]中的發行者，然後展開伺服器節點。</span><span class="sxs-lookup"><span data-stu-id="fb780-236">Connect to the Publisher in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>    
2.  <span data-ttu-id="fb780-237">展開 **[複寫]** 資料夾，然後展開 **[本機發行集]** 資料夾。</span><span class="sxs-lookup"><span data-stu-id="fb780-237">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>    
3.  <span data-ttu-id="fb780-238">展開要驗證訂閱的發行集，以滑鼠右鍵按一下訂閱，然後按一下 **[驗證單一訂閱]**。</span><span class="sxs-lookup"><span data-stu-id="fb780-238">Expand the publication for which you want to validate subscriptions, right-click the subscription, and then click **Validate Subscription**.</span></span>    
4.  <span data-ttu-id="fb780-239">在 **[驗證訂閱]** 對話方塊中，選取 **[驗證此訂閱]**。</span><span class="sxs-lookup"><span data-stu-id="fb780-239">In the **Validate Subscription** dialog box, select **Validate this subscription**.</span></span>    
5.  <span data-ttu-id="fb780-240">若要指定要執行驗證的類型 (資料列計數，或資料列計數與總和檢查碼)，請按一下 **[選項]**，然後在 **[訂閱驗證選項]** 對話方塊中指定選項。</span><span class="sxs-lookup"><span data-stu-id="fb780-240">To specify the type of validation to perform (row count, or row count and checksum) click **Options**, and then specify options in the **Subscription Validation Options** dialog box.</span></span>    
6.  [!INCLUDE[clickOK](../../includes/clickok-md.md)]    
7.  <span data-ttu-id="fb780-241">在「複寫監視器」或 **[檢視同步處理的狀態]** 對話方塊中檢視驗證結果：</span><span class="sxs-lookup"><span data-stu-id="fb780-241">View validation results in Replication Monitor or the **View Synchronization Status** dialog box:</span></span>  
    1.  <span data-ttu-id="fb780-242">展開發行集，以滑鼠右鍵按一下訂閱，然後按一下 **[檢視同步處理的狀態]**。</span><span class="sxs-lookup"><span data-stu-id="fb780-242">Expand the publication, right-click the subscription, and then click **View Synchronization Status**.</span></span>   
    2.  <span data-ttu-id="fb780-243">如果代理程式未執行，請按一下 **[檢視同步處理的狀態]** 對話方塊中的 **[啟動]** 。</span><span class="sxs-lookup"><span data-stu-id="fb780-243">If the agent is not running, click **Start** in the **View Synchronization Status** dialog box.</span></span> <span data-ttu-id="fb780-244">對話方塊就會顯示關於驗證的參考用訊息。</span><span class="sxs-lookup"><span data-stu-id="fb780-244">The dialog box will display informational messages regarding validation.</span></span>  
  
     <span data-ttu-id="fb780-245">如果您未看到任何關於驗證的訊息，則代理程式已經記錄了後續訊息。</span><span class="sxs-lookup"><span data-stu-id="fb780-245">If you do not see any messages regarding validation, the agent has already logged a subsequent message.</span></span> <span data-ttu-id="fb780-246">在此情況下，請在複寫監視器中檢視驗證結果。</span><span class="sxs-lookup"><span data-stu-id="fb780-246">In this case, view the validation results in Replication Monitor.</span></span> <span data-ttu-id="fb780-247">如需詳細資訊，請參閱這個主題中＜複寫監視器＞的如何程序。</span><span class="sxs-lookup"><span data-stu-id="fb780-247">For more information, see the Replication Monitor how to procedures in this topic.</span></span>  

### <a name="using-transact-sql-t-sql"></a><span data-ttu-id="fb780-248">使用 Transact-SQL (T-SQL)</span><span class="sxs-lookup"><span data-stu-id="fb780-248">Using Transact-SQL (T-SQL)</span></span>

1.  <span data-ttu-id="fb780-249">在發行集資料庫的發行者端，執行 [sp_validatemergesubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-validatemergesubscription-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="fb780-249">At the Publisher on the publication database, execute [sp_validatemergesubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-validatemergesubscription-transact-sql).</span></span> <span data-ttu-id="fb780-250">指定\*\* \@ 發行**集、 \*\* \@ 訂閱**者的訂閱者名稱、 \*\* \@ subscriber_db**的訂閱資料庫名稱，以及** \@ level\*\*的下列其中一個值：</span><span class="sxs-lookup"><span data-stu-id="fb780-250">Specify **\@publication**, the name of the Subscriber for **\@subscriber**, the name of the subscription database for **\@subscriber_db**, and one of the following values for **\@level**:</span></span>   
    -   <span data-ttu-id="fb780-251">**1** - 只驗證列數。</span><span class="sxs-lookup"><span data-stu-id="fb780-251">**1** - Rowcount-only validation.</span></span>    
    -   <span data-ttu-id="fb780-252">**3** - 驗證列數二進位總和檢查碼。</span><span class="sxs-lookup"><span data-stu-id="fb780-252">**3** - Rowcount binary checksum validation.</span></span>  
  
     <span data-ttu-id="fb780-253">這會標示選取的訂閱以供驗證。</span><span class="sxs-lookup"><span data-stu-id="fb780-253">This marks the selected subscription for validation.</span></span>  
  
2.  <span data-ttu-id="fb780-254">針對每項訂閱啟動合併代理程式。</span><span class="sxs-lookup"><span data-stu-id="fb780-254">Start the merge agent for each subscription.</span></span> <span data-ttu-id="fb780-255">如需相關資訊，請參閱 [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md) 以及 [Synchronize a Push Subscription](synchronize-a-push-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-255">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md) and [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>    
3.  <span data-ttu-id="fb780-256">檢查代理程式輸出，以取得驗證的結果。</span><span class="sxs-lookup"><span data-stu-id="fb780-256">Check the agent output for the result of the validation.</span></span>    
4.  <span data-ttu-id="fb780-257">針對每個要驗證的訂閱重複步驟 1 到 3。</span><span class="sxs-lookup"><span data-stu-id="fb780-257">Repeat steps 1 through 3 for each subscription being validated.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fb780-258">您也可以在執行 **Replication Merge Agent** 時藉由指定 [-Validate](agents/replication-merge-agent.md)參數，在同步處理結束時驗證合併發行集的訂閱。</span><span class="sxs-lookup"><span data-stu-id="fb780-258">A subscription to a merge publication can also be validated at the end of a synchronization by specifying the **-Validate** parameter when running the [Replication Merge Agent](agents/replication-merge-agent.md).</span></span>  

  
## <a name="for-all-subscriptions-to-a-merge-publication"></a><span data-ttu-id="fb780-259">針對合併式發行集的所有訂閱</span><span class="sxs-lookup"><span data-stu-id="fb780-259">For all subscriptions to a Merge Publication</span></span>

### <a name="using-sql-server-management-studio"></a><span data-ttu-id="fb780-260">使用 SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="fb780-260">Using SQL Server Management Studio</span></span> 
  
1.  <span data-ttu-id="fb780-261">連接到 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]中的發行者，然後展開伺服器節點。</span><span class="sxs-lookup"><span data-stu-id="fb780-261">Connect to the Publisher in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>    
2.  <span data-ttu-id="fb780-262">展開 **[複寫]** 資料夾，然後展開 **[本機發行集]** 資料夾。</span><span class="sxs-lookup"><span data-stu-id="fb780-262">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>    
3.  <span data-ttu-id="fb780-263">以滑鼠右鍵按一下您要驗證訂閱的發行集，然後按一下 **[驗證所有訂閱]**。</span><span class="sxs-lookup"><span data-stu-id="fb780-263">Right-click the publication for which you want to validate subscriptions, and then click **Validate All Subscriptions**.</span></span>    
4.  <span data-ttu-id="fb780-264">在 **[驗證所有訂閱]** 對話方塊中，指定要執行驗證的類型 (資料列計數，或資料列計數與總和檢查碼)。</span><span class="sxs-lookup"><span data-stu-id="fb780-264">In the **Validate All Subscriptions** dialog box, specify the type of validation to perform (row count, or row count and checksum).</span></span>    
5.  [!INCLUDE[clickOK](../../includes/clickok-md.md)]    
6.  <span data-ttu-id="fb780-265">在「複寫監視器」或 [ **View 同步**處理的狀態] 對話方塊中，查看驗證結果。</span><span class="sxs-lookup"><span data-stu-id="fb780-265">View validation results in Replication Monitor or the **View Synchronization Status** dialog box.</span></span> <span data-ttu-id="fb780-266">針對每個訂閱：</span><span class="sxs-lookup"><span data-stu-id="fb780-266">For each subscription:</span></span>    
    1.  <span data-ttu-id="fb780-267">展開發行集，以滑鼠右鍵按一下訂閱，然後按一下 **[檢視同步處理的狀態]**。</span><span class="sxs-lookup"><span data-stu-id="fb780-267">Expand the publication, right-click the subscription, and then click **View Synchronization Status**.</span></span>   
    2.  <span data-ttu-id="fb780-268">如果代理程式未執行，請按一下 **[檢視同步處理的狀態]** 對話方塊中的 **[啟動]** 。</span><span class="sxs-lookup"><span data-stu-id="fb780-268">If the agent is not running, click **Start** in the **View Synchronization Status** dialog box.</span></span> <span data-ttu-id="fb780-269">對話方塊就會顯示關於驗證的參考用訊息。</span><span class="sxs-lookup"><span data-stu-id="fb780-269">The dialog box will display informational messages regarding validation.</span></span>  
  
     <span data-ttu-id="fb780-270">如果您未看到任何關於驗證的訊息，則代理程式已經記錄了後續訊息。</span><span class="sxs-lookup"><span data-stu-id="fb780-270">If you do not see any messages regarding validation, the agent has already logged a subsequent message.</span></span> <span data-ttu-id="fb780-271">在此情況下，請在複寫監視器中檢視驗證結果。</span><span class="sxs-lookup"><span data-stu-id="fb780-271">In this case, view the validation results in Replication Monitor.</span></span> <span data-ttu-id="fb780-272">如需詳細資訊，請參閱這個主題中＜複寫監視器＞的如何程序。</span><span class="sxs-lookup"><span data-stu-id="fb780-272">For more information, see the Replication Monitor how to procedures in this topic.</span></span>  

### <a name="using-transact-sql-t-sql"></a><span data-ttu-id="fb780-273">使用 Transact-SQL (T-SQL)</span><span class="sxs-lookup"><span data-stu-id="fb780-273">Using Transact-SQL (T-SQL)</span></span>

1.  <span data-ttu-id="fb780-274">在發行集資料庫的發行者端，執行 [sp_validatemergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-validatemergepublication-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="fb780-274">At the Publisher on the publication database, execute [sp_validatemergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-validatemergepublication-transact-sql).</span></span> <span data-ttu-id="fb780-275">為 [ \*\* \@ 層級**] 指定 [ \*\* \@ 發行**集] 和下列其中一個值：</span><span class="sxs-lookup"><span data-stu-id="fb780-275">Specify **\@publication** and one of the following values for **\@level**:</span></span>    
    -   <span data-ttu-id="fb780-276">**1** - 只驗證列數。</span><span class="sxs-lookup"><span data-stu-id="fb780-276">**1** - Rowcount-only validation.</span></span>    
    -   <span data-ttu-id="fb780-277">**3** - 驗證列數二進位總和檢查碼。</span><span class="sxs-lookup"><span data-stu-id="fb780-277">**3** - Rowcount binary checksum validation.</span></span>  
  
     <span data-ttu-id="fb780-278">這會標示所有訂閱以供驗證。</span><span class="sxs-lookup"><span data-stu-id="fb780-278">This marks all subscriptions for validation.</span></span>  
  
2.  <span data-ttu-id="fb780-279">針對每項訂閱啟動合併代理程式。</span><span class="sxs-lookup"><span data-stu-id="fb780-279">Start the merge agent for each subscription.</span></span> <span data-ttu-id="fb780-280">如需相關資訊，請參閱 [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md) 以及 [Synchronize a Push Subscription](synchronize-a-push-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-280">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md) and [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>    
3.  <span data-ttu-id="fb780-281">檢查代理程式輸出，以取得驗證的結果。</span><span class="sxs-lookup"><span data-stu-id="fb780-281">Check the agent output for the result of the validation.</span></span> <span data-ttu-id="fb780-282">如需詳細資訊，請參閱 [Validate Data at the Subscriber](validate-data-at-the-subscriber.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-282">For more information, see [Validate Data at the Subscriber](validate-data-at-the-subscriber.md).</span></span>  


## <a name="for-a-single-push-subscription-to-a-merge-publication"></a><span data-ttu-id="fb780-283">針對合併式發行集的單一發送訂閱</span><span class="sxs-lookup"><span data-stu-id="fb780-283">For a single push subscription to a Merge Publication</span></span> 

### <a name="using-replication-monitor"></a><span data-ttu-id="fb780-284">使用複寫監視器</span><span class="sxs-lookup"><span data-stu-id="fb780-284">Using Replication Monitor</span></span>
  
1.  <span data-ttu-id="fb780-285">在複寫監視器中，展開左窗格裡的發行者群組，展開發行者，然後按一下發行集。</span><span class="sxs-lookup"><span data-stu-id="fb780-285">In Replication Monitor, expand a Publisher group in the left pane, expand a Publisher, and then click a publication.</span></span>    
2.  <span data-ttu-id="fb780-286">按一下 **[所有訂閱]** 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="fb780-286">Click the **All Subscriptions** tab.</span></span>    
3.  <span data-ttu-id="fb780-287">以滑鼠右鍵按一下您要驗證的訂閱，然後按一下 **[驗證單一訂閱]**。</span><span class="sxs-lookup"><span data-stu-id="fb780-287">Right-click the subscription you want to validate, and then click **Validate Subscription**.</span></span>    
4.  <span data-ttu-id="fb780-288">在 **[驗證訂閱]** 對話方塊中，選取 **[驗證此訂閱]**。</span><span class="sxs-lookup"><span data-stu-id="fb780-288">In the **Validate Subscription** dialog box, select **Validate this subscription**.</span></span>    
5.  <span data-ttu-id="fb780-289">若要指定要執行驗證的類型 (資料列計數，或資料列計數與總和檢查碼)，請按一下 **[選項]**，然後在 **[訂閱驗證選項]** 對話方塊中指定選項。</span><span class="sxs-lookup"><span data-stu-id="fb780-289">To specify the type of validation to perform (row count, or row count and checksum) click **Options**, and then specify options in the **Subscription Validation Options** dialog box.</span></span>    
6.  [!INCLUDE[clickOK](../../includes/clickok-md.md)]    
7.  <span data-ttu-id="fb780-290">按一下 **[所有訂閱]** 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="fb780-290">Click the **All Subscriptions** tab.</span></span>    
8.  <span data-ttu-id="fb780-291">檢視驗證結果：</span><span class="sxs-lookup"><span data-stu-id="fb780-291">View validation results:</span></span>    
    1.  <span data-ttu-id="fb780-292">如果代理程式未執行，請以滑鼠右鍵按一下訂閱，然後按一下 **[啟動同步處理]**。</span><span class="sxs-lookup"><span data-stu-id="fb780-292">If the agent is not running, right-click the subscription, and then click **Start Synchronizing**.</span></span>    
    2.  <span data-ttu-id="fb780-293">以滑鼠右鍵按一下訂閱，然後按一下 **[檢視詳細資料]**。</span><span class="sxs-lookup"><span data-stu-id="fb780-293">Right-click the subscription, and then click **View Details**.</span></span>    
    3.  <span data-ttu-id="fb780-294">在 **[同步處理記錄]** 索引標籤上的 **[所選取工作階段的最後訊息]** 測試區域中檢視資訊。</span><span class="sxs-lookup"><span data-stu-id="fb780-294">View information on the **Synchronization History** tab in the **Last message of the selected session** text area.</span></span>  
  
## <a name="for-all-push-subscriptions-to-a-merge-publication"></a><span data-ttu-id="fb780-295">針對合併式發行集的所有發送訂閱</span><span class="sxs-lookup"><span data-stu-id="fb780-295">For all push subscriptions to a Merge Publication</span></span> 

### <a name="using-replication-monitor"></a><span data-ttu-id="fb780-296">使用複寫監視器</span><span class="sxs-lookup"><span data-stu-id="fb780-296">Using Replication Monitor</span></span>
  
1.  <span data-ttu-id="fb780-297">在複寫監視器的左窗格中展開發行者群組，然後展開發行者。</span><span class="sxs-lookup"><span data-stu-id="fb780-297">In Replication Monitor, expand a Publisher group in the left pane, and then expand a Publisher.</span></span>    
2.  <span data-ttu-id="fb780-298">以滑鼠右鍵按一下您要驗證訂閱的發行集，然後按一下 **[驗證所有訂閱]**。</span><span class="sxs-lookup"><span data-stu-id="fb780-298">Right-click the publication for which you want to validate subscriptions, and then click **Validate All Subscriptions**.</span></span>    
3.  <span data-ttu-id="fb780-299">在 **[驗證所有訂閱]** 對話方塊中，指定要執行驗證的類型 (資料列計數，或資料列計數與總和檢查碼)。</span><span class="sxs-lookup"><span data-stu-id="fb780-299">In the **Validate All Subscriptions** dialog box, specify the type of validation to perform (row count, or row count and checksum).</span></span>    
4.  [!INCLUDE[clickOK](../../includes/clickok-md.md)]    
5.  <span data-ttu-id="fb780-300">按一下 **[所有訂閱]** 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="fb780-300">Click the **All Subscriptions** tab.</span></span>    
6.  <span data-ttu-id="fb780-301">檢視驗證結果。</span><span class="sxs-lookup"><span data-stu-id="fb780-301">View validation results.</span></span> <span data-ttu-id="fb780-302">針對每個發送訂閱：</span><span class="sxs-lookup"><span data-stu-id="fb780-302">For each push subscription:</span></span>    
    1.  <span data-ttu-id="fb780-303">如果代理程式未執行，請以滑鼠右鍵按一下訂閱，然後按一下 **[啟動同步處理]**。</span><span class="sxs-lookup"><span data-stu-id="fb780-303">If the agent is not running, right-click the subscription, and then click **Start Synchronizing**.</span></span>    
    2.  <span data-ttu-id="fb780-304">以滑鼠右鍵按一下訂閱，然後按一下 **[檢視詳細資料]**。</span><span class="sxs-lookup"><span data-stu-id="fb780-304">Right-click the subscription, and then click **View Details**.</span></span>    
    3.  <span data-ttu-id="fb780-305">在 **[同步處理記錄]** 索引標籤上的 **[所選取工作階段的最後訊息]** 測試區域中檢視資訊。</span><span class="sxs-lookup"><span data-stu-id="fb780-305">View information on the **Synchronization History** tab in the **Last message of the selected session** text area.</span></span>  
  
  
## <a name="validate-data-using-merge-agent-parameters"></a><span data-ttu-id="fb780-306">使用合併代理程式參數來驗證資料</span><span class="sxs-lookup"><span data-stu-id="fb780-306">Validate data using Merge Agent Parameters</span></span>
  
1.  <span data-ttu-id="fb780-307">以下列其中一種方法，從命令提示字元啟動「合併代理程式」(在「訂閱者」端的為提取訂閱，在「散發者」端的則為發送訂閱)。</span><span class="sxs-lookup"><span data-stu-id="fb780-307">Start the Merge Agent at the Subscriber (pull subscription) or at the Distributor (push subscription) from the command prompt in one of the following ways.</span></span>    
    -   <span data-ttu-id="fb780-308">針對 **-Validate** 參數，指定值 **1** (列數) 或 **3** (列數和二進位總和檢查碼)。</span><span class="sxs-lookup"><span data-stu-id="fb780-308">Specifying a value of **1** (rowcount) or **3** (rowcount and binary checksum) for the **-Validate** parameter.</span></span>   
    -   <span data-ttu-id="fb780-309">針對 **-ProfileName** 參數，指定 **rowcount validation** 或 **rowcount and checksum validation** 。</span><span class="sxs-lookup"><span data-stu-id="fb780-309">Specifying **rowcount validation** or **rowcount and checksum validation** for the **-ProfileName** parameter.</span></span>  
  
     <span data-ttu-id="fb780-310">如需相關資訊，請參閱 [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md) 或 [Synchronize a Push Subscription](synchronize-a-push-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-310">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md) or [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
## <a name="using-replication-management-objects-rmo"></a><span data-ttu-id="fb780-311">使用 Replication Management Objects (RMO)</span><span class="sxs-lookup"><span data-stu-id="fb780-311">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="fb780-312">複寫能讓您以程式設計的方式，使用 Replication Management Objects (RMO) 驗證「訂閱者」和「發行者」兩端的資料相符。</span><span class="sxs-lookup"><span data-stu-id="fb780-312">Replication enables you to use Replication Management Objects (RMO) to programmatically validate that data at the Subscriber matches data at the Publisher.</span></span> <span data-ttu-id="fb780-313">您使用的物件依照複寫拓撲的類型而定。</span><span class="sxs-lookup"><span data-stu-id="fb780-313">The objects you use depend on the type of replication topology.</span></span> <span data-ttu-id="fb780-314">異動複寫需要驗證發行集的所有訂閱。</span><span class="sxs-lookup"><span data-stu-id="fb780-314">Transactional replication requires validation of all subscriptions to a publication.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fb780-315">如需範例，請參閱本主題稍後的 [範例 (RMO)](#RMOExample)。</span><span class="sxs-lookup"><span data-stu-id="fb780-315">For an example, see [Example (RMO)](#RMOExample), later in this section.</span></span>  
  
#### <a name="to-validate-data-for-all-articles-in-a-transactional-publication"></a><span data-ttu-id="fb780-316">若要驗證交易式發行集中所有發行項的資料</span><span class="sxs-lookup"><span data-stu-id="fb780-316">To validate data for all articles in a transactional publication</span></span>  
  
1.  <span data-ttu-id="fb780-317">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 類別建立與發行者的連接。</span><span class="sxs-lookup"><span data-stu-id="fb780-317">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>    
2.  <span data-ttu-id="fb780-318">建立 <xref:Microsoft.SqlServer.Replication.TransPublication> 類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="fb780-318">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPublication> class.</span></span> <span data-ttu-id="fb780-319">設定發行集的 <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> 和 <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="fb780-319">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication.</span></span> <span data-ttu-id="fb780-320">將 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 屬性設定為在步驟 1 中建立的連接。</span><span class="sxs-lookup"><span data-stu-id="fb780-320">Set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>   
3.  <span data-ttu-id="fb780-321">呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法以取得物件的剩餘屬性。</span><span class="sxs-lookup"><span data-stu-id="fb780-321">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the remaining properties of the object.</span></span> <span data-ttu-id="fb780-322">如果此方法傳回 `false`，則表示步驟 2 中的發行集屬性定義不正確，或者該發行集不存在。</span><span class="sxs-lookup"><span data-stu-id="fb780-322">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>    
4.  <span data-ttu-id="fb780-323">呼叫 <xref:Microsoft.SqlServer.Replication.TransPublication.ValidatePublication%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="fb780-323">Call the <xref:Microsoft.SqlServer.Replication.TransPublication.ValidatePublication%2A> method.</span></span> <span data-ttu-id="fb780-324">傳遞下列項目：</span><span class="sxs-lookup"><span data-stu-id="fb780-324">Pass the following:</span></span>    
    -   <xref:Microsoft.SqlServer.Replication.ValidationOption>    
    -   <xref:Microsoft.SqlServer.Replication.ValidationMethod>    
    -   <span data-ttu-id="fb780-325">此為布林值，指出在驗證完成後是否要停止「散發代理程式」。</span><span class="sxs-lookup"><span data-stu-id="fb780-325">A Boolean that indicates whether to stop the Distribution Agent after validation is completed.</span></span>  
  
     <span data-ttu-id="fb780-326">這會標示要驗證的發行項。</span><span class="sxs-lookup"><span data-stu-id="fb780-326">This marks the articles for validation.</span></span>  
  
5.  <span data-ttu-id="fb780-327">如果尚未執行，請啟動「散發代理程式」以同步處理每個訂閱。</span><span class="sxs-lookup"><span data-stu-id="fb780-327">If not already running, start the Distribution Agent to synchronize each subscription.</span></span> <span data-ttu-id="fb780-328">如需相關資訊，請參閱 [Synchronize a Push Subscription](synchronize-a-push-subscription.md) 或 [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-328">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md) or [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span> <span data-ttu-id="fb780-329">驗證作業的結果會寫入至代理程式記錄。</span><span class="sxs-lookup"><span data-stu-id="fb780-329">The result of the validation operation is written to the agent history.</span></span> <span data-ttu-id="fb780-330">如需詳細資訊，請參閱 [Monitoring Replication](monitoring-replication.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-330">For more information, see [Monitoring Replication](monitoring-replication.md).</span></span>  
  
#### <a name="to-validate-data-in-all-subscriptions-to-a-merge-publication"></a><span data-ttu-id="fb780-331">若要驗證所有合併發行集訂閱中的資料</span><span class="sxs-lookup"><span data-stu-id="fb780-331">To validate data in all subscriptions to a merge publication</span></span>  
  
1.  <span data-ttu-id="fb780-332">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 類別建立與發行者的連接。</span><span class="sxs-lookup"><span data-stu-id="fb780-332">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>   
2.  <span data-ttu-id="fb780-333">建立 <xref:Microsoft.SqlServer.Replication.MergePublication> 類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="fb780-333">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class.</span></span> <span data-ttu-id="fb780-334">設定發行集的 <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> 和 <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="fb780-334">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication.</span></span> <span data-ttu-id="fb780-335">將 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 屬性設定為在步驟 1 中建立的連接。</span><span class="sxs-lookup"><span data-stu-id="fb780-335">Set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>   
3.  <span data-ttu-id="fb780-336">呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法以取得物件的剩餘屬性。</span><span class="sxs-lookup"><span data-stu-id="fb780-336">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the remaining properties of the object.</span></span> <span data-ttu-id="fb780-337">如果此方法傳回 `false`，則表示步驟 2 中的發行集屬性定義不正確，或者該發行集不存在。</span><span class="sxs-lookup"><span data-stu-id="fb780-337">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>    
4.  <span data-ttu-id="fb780-338">呼叫 <xref:Microsoft.SqlServer.Replication.MergePublication.ValidatePublication%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="fb780-338">Call the <xref:Microsoft.SqlServer.Replication.MergePublication.ValidatePublication%2A> method.</span></span> <span data-ttu-id="fb780-339">傳遞所要的 <xref:Microsoft.SqlServer.Replication.ValidationOption>。</span><span class="sxs-lookup"><span data-stu-id="fb780-339">Pass the desired <xref:Microsoft.SqlServer.Replication.ValidationOption>.</span></span>    
5.  <span data-ttu-id="fb780-340">為每個訂閱執行「合併代理程式」以啟動驗證，或等候下一個排程的代理程式執行。</span><span class="sxs-lookup"><span data-stu-id="fb780-340">Run the Merge Agent for each subscription to start validation, or wait for the next scheduled agent run.</span></span> <span data-ttu-id="fb780-341">如需相關資訊，請參閱 [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md) 以及 [Synchronize a Push Subscription](synchronize-a-push-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-341">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md) and [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span> <span data-ttu-id="fb780-342">驗證作業的結果會寫入至代理程式記錄，您可使用「複寫監視器」來加以檢視。</span><span class="sxs-lookup"><span data-stu-id="fb780-342">The result of the validation operation is written to the agent history, which you view by using Replication Monitor.</span></span> <span data-ttu-id="fb780-343">如需詳細資訊，請參閱 [Monitoring Replication](monitoring-replication.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-343">For more information, see [Monitoring Replication](monitoring-replication.md).</span></span>  
  
#### <a name="to-validate-data-in-a-single-subscription-to-a-merge-publication"></a><span data-ttu-id="fb780-344">若要驗證合併發行集單一訂閱中的資料</span><span class="sxs-lookup"><span data-stu-id="fb780-344">To validate data in a single subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="fb780-345">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 類別建立與發行者的連接。</span><span class="sxs-lookup"><span data-stu-id="fb780-345">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>    
2.  <span data-ttu-id="fb780-346">建立 <xref:Microsoft.SqlServer.Replication.MergePublication> 類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="fb780-346">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class.</span></span> <span data-ttu-id="fb780-347">設定發行集的 <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> 和 <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="fb780-347">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication.</span></span> <span data-ttu-id="fb780-348">將 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 屬性設定為在步驟 1 中建立的連接。</span><span class="sxs-lookup"><span data-stu-id="fb780-348">Set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>    
3.  <span data-ttu-id="fb780-349">呼叫 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法以取得物件的剩餘屬性。</span><span class="sxs-lookup"><span data-stu-id="fb780-349">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the remaining properties of the object.</span></span> <span data-ttu-id="fb780-350">如果此方法傳回 `false`，則表示步驟 2 中的發行集屬性定義不正確，或者該發行集不存在。</span><span class="sxs-lookup"><span data-stu-id="fb780-350">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>    
4.  <span data-ttu-id="fb780-351">呼叫 <xref:Microsoft.SqlServer.Replication.MergePublication.ValidateSubscription%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="fb780-351">Call the <xref:Microsoft.SqlServer.Replication.MergePublication.ValidateSubscription%2A> method.</span></span> <span data-ttu-id="fb780-352">傳遞正在進行驗證之「訂閱者」和訂閱資料庫的名稱以及所要的 <xref:Microsoft.SqlServer.Replication.ValidationOption>。</span><span class="sxs-lookup"><span data-stu-id="fb780-352">Pass the name of the Subscriber and subscription database being validated and the desired <xref:Microsoft.SqlServer.Replication.ValidationOption>.</span></span>    
5.  <span data-ttu-id="fb780-353">為訂閱執行「合併代理程式」以啟動驗證，或等候下一個排程的代理程式執行。</span><span class="sxs-lookup"><span data-stu-id="fb780-353">Run the Merge Agent for the subscription to start validation, or wait for the next scheduled agent run.</span></span> <span data-ttu-id="fb780-354">如需相關資訊，請參閱 [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md) 以及 [Synchronize a Push Subscription](synchronize-a-push-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-354">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md) and [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span> <span data-ttu-id="fb780-355">驗證作業的結果會寫入至代理程式記錄，您可使用「複寫監視器」來加以檢視。</span><span class="sxs-lookup"><span data-stu-id="fb780-355">The result of the validation operation is written to the agent history, which you view by using Replication Monitor.</span></span> <span data-ttu-id="fb780-356">如需詳細資訊，請參閱 [Monitoring Replication](monitoring-replication.md)。</span><span class="sxs-lookup"><span data-stu-id="fb780-356">For more information, see [Monitoring Replication](monitoring-replication.md).</span></span>  
  
###  <a name="example-rmo"></a><a name="RMOExample"></a> <span data-ttu-id="fb780-357">範例 (RMO)</span><span class="sxs-lookup"><span data-stu-id="fb780-357">Example (RMO)</span></span>  
 <span data-ttu-id="fb780-358">此範例會標示交易式發行集的所有訂閱，以進行列數驗證。</span><span class="sxs-lookup"><span data-stu-id="fb780-358">This example marks all subscriptions to a transactional publication for rowcount validation.</span></span>  
  
 [!code-csharp[HowTo#rmo_ValidateTranPub](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_validatetranpub)]  
  
 [!code-vb[HowTo#rmo_vb_ValidateTranPub](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_validatetranpub)]  
  
 <span data-ttu-id="fb780-359">此範例會標示合併式發行集的特定訂閱，以進行列數驗證。</span><span class="sxs-lookup"><span data-stu-id="fb780-359">This example marks a specific subscription to a merge publication for rowcount validation.</span></span>  
  
 [!code-csharp[HowTo#rmo_ValidateMergeSub](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_validatemergesub)]  
  
 [!code-vb[HowTo#rmo_vb_ValidateMergeSub](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_validatemergesub)]  
  
  
