---
title: 為非 SQL Server 訂閱者建立訂閱 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- subscriptions [SQL Server replication], non-SQL Server Subscribers
- Subscribers [SQL Server replication], non-SQL Server Subscribers
- non-SQL Server Subscribers, subscriptions
ms.assetid: 5020ee68-b988-4d57-8066-67d183e61237
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 31a7d1e52c53cb858039f1fd0ed403f255ad5ca2
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87697966"
---
# <a name="create-a-subscription-for-a-non-sql-server-subscriber"></a><span data-ttu-id="23606-102">為非 SQL Server 訂閱者建立訂閱</span><span class="sxs-lookup"><span data-stu-id="23606-102">Create a Subscription for a Non-SQL Server Subscriber</span></span>
  <span data-ttu-id="23606-103">本主題描述如何使用 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 或 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] ，在 [!INCLUDE[tsql](../../includes/tsql-md.md)]中針對非 SQL Server 訂閱者建立訂閱。</span><span class="sxs-lookup"><span data-stu-id="23606-103">This topic describes how to create a subscription for a non-SQL Server Subscriber in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../includes/tsql-md.md)].</span></span> <span data-ttu-id="23606-104">異動複寫與快照式複寫支援向非[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 訂閱者發行資料。</span><span class="sxs-lookup"><span data-stu-id="23606-104">Transactional and snapshot replication support publishing data to non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers.</span></span> <span data-ttu-id="23606-105">如需有關支援之訂閱者平台的資訊，請參閱＜ [Non-SQL Server Subscribers](non-sql/non-sql-server-subscribers.md)中針對非 SQL Server 訂閱者建立訂閱。</span><span class="sxs-lookup"><span data-stu-id="23606-105">For information about supported Subscriber platforms, see [Non-SQL Server Subscribers](non-sql/non-sql-server-subscribers.md).</span></span>  
  
 <span data-ttu-id="23606-106">**本主題內容**</span><span class="sxs-lookup"><span data-stu-id="23606-106">**In This Topic**</span></span>  
  
-   <span data-ttu-id="23606-107">**若要針對非 SQL Server 訂閱者建立訂閱，請使用：**</span><span class="sxs-lookup"><span data-stu-id="23606-107">**To create a subscription for a non-SQL Server Subscriber, using:**</span></span>  
  
     [<span data-ttu-id="23606-108">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="23606-108">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="23606-109">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="23606-109">Transact-SQL</span></span>](#TsqlProcedure)  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="23606-110">使用 SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="23606-110">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="23606-111">若要為非[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 訂閱者建立訂閱：</span><span class="sxs-lookup"><span data-stu-id="23606-111">To create a subscription for a non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscriber:</span></span>  
  
1.  <span data-ttu-id="23606-112">在「 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 散發者」上安裝並設定適當的用戶端軟體和 OLE DB 提供者。</span><span class="sxs-lookup"><span data-stu-id="23606-112">Install and configure the appropriate client software and OLE DB provider(s) on the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Distributor.</span></span> <span data-ttu-id="23606-113">如需相關資訊，請參閱 [Oracle Subscribers](non-sql/oracle-subscribers.md) 及 [IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md)。</span><span class="sxs-lookup"><span data-stu-id="23606-113">For more information, see [Oracle Subscribers](non-sql/oracle-subscribers.md) and [IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md).</span></span>  
  
2.  <span data-ttu-id="23606-114">使用「新增發行集精靈」建立發行集。</span><span class="sxs-lookup"><span data-stu-id="23606-114">Create a publication using the New Publication Wizard.</span></span> <span data-ttu-id="23606-115">如需建立發行集的詳細資訊，請參閱[建立發行集](publish/create-a-publication.md)和[從 Oracle 資料庫建立發行集](publish/create-a-publication-from-an-oracle-database.md)。</span><span class="sxs-lookup"><span data-stu-id="23606-115">For more information about creating publications, see [Create a Publication](publish/create-a-publication.md) and [Create a Publication from an Oracle Database](publish/create-a-publication-from-an-oracle-database.md).</span></span> <span data-ttu-id="23606-116">在「新增發行集精靈」中指定下列選項：</span><span class="sxs-lookup"><span data-stu-id="23606-116">Specify the following options in the New Publication Wizard:</span></span>  
  
    -   <span data-ttu-id="23606-117">在 **[發行集類型]** 頁面上，選取 **[快照集發行集]** 或 **[交易式發行集]** 。</span><span class="sxs-lookup"><span data-stu-id="23606-117">On the **Publication Type** page, select **Snapshot publication** or **Transactional publication**.</span></span>  
  
    -   <span data-ttu-id="23606-118">在 **[快照集代理程式]** 頁面上，清除 **[立即建立快照集]** 。</span><span class="sxs-lookup"><span data-stu-id="23606-118">On the **Snapshot Agent** page, clear **Create a snapshot immediately**.</span></span>  
  
         <span data-ttu-id="23606-119">為非[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 訂閱者啟用發行集後建立快照集，以確定「快照集代理程式」會產生適用於非[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 訂閱者的快照集與初始化指令碼。</span><span class="sxs-lookup"><span data-stu-id="23606-119">You create the snapshot after the publication is enabled for non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers to ensure that the Snapshot Agent generates a snapshot and initialization scripts that are suitable for non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers.</span></span>  
  
3.  <span data-ttu-id="23606-120">使用 [發行集屬性 - \<PublicationName>] 對話方塊，啟用非 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 訂閱者的發行集。</span><span class="sxs-lookup"><span data-stu-id="23606-120">Enable the publication for non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers using the **Publication Properties - \<PublicationName>** dialog box.</span></span> <span data-ttu-id="23606-121">如需有關此步驟的詳細資訊，請參閱＜ [Publication Properties, Subscription Options](publication-properties-subscription-options.md) ＞。</span><span class="sxs-lookup"><span data-stu-id="23606-121">See [Publication Properties, Subscription Options](publication-properties-subscription-options.md) for more information about this step.</span></span>  
  
4.  <span data-ttu-id="23606-122">使用「新增訂閱精靈」建立訂閱。</span><span class="sxs-lookup"><span data-stu-id="23606-122">Create a subscription using the New Subscription Wizard.</span></span> <span data-ttu-id="23606-123">本主題提供有關這個步驟的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="23606-123">This topic provides more information about this step.</span></span>  
  
5.  <span data-ttu-id="23606-124">(選擇性) 變更 **pre_creation_cmd** 發行項屬性，使資料表保留在訂閱者端。</span><span class="sxs-lookup"><span data-stu-id="23606-124">(Optional) Change the **pre_creation_cmd** article property to retain tables at the Subscriber.</span></span> <span data-ttu-id="23606-125">本主題提供有關這個步驟的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="23606-125">This topic provides more information about this step.</span></span>  
  
6.  <span data-ttu-id="23606-126">產生發行集的快照集。</span><span class="sxs-lookup"><span data-stu-id="23606-126">Generate a snapshot for the publication.</span></span> <span data-ttu-id="23606-127">本主題提供有關這個步驟的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="23606-127">This topic provides more information about this step.</span></span>  
  
7.  <span data-ttu-id="23606-128">同步處理訂閱。</span><span class="sxs-lookup"><span data-stu-id="23606-128">Synchronize the subscription.</span></span> <span data-ttu-id="23606-129">如需詳細資訊，請參閱 [同步處理發送訂閱](synchronize-a-push-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="23606-129">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
#### <a name="to-enable-a-publication-for-non-sql-server-subscribers"></a><span data-ttu-id="23606-130">為非 SQL Server 訂閱者啟用發行集</span><span class="sxs-lookup"><span data-stu-id="23606-130">To enable a publication for non-SQL Server Subscribers</span></span>  
  
1.  <span data-ttu-id="23606-131">連接到 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]中的發行者，然後展開伺服器節點。</span><span class="sxs-lookup"><span data-stu-id="23606-131">Connect to the Publisher in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="23606-132">展開 **[複寫]** 資料夾，然後展開 **[本機發行集]** 資料夾。</span><span class="sxs-lookup"><span data-stu-id="23606-132">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="23606-133">以滑鼠右鍵按一下發行集，然後再按一下 **[屬性]** 。</span><span class="sxs-lookup"><span data-stu-id="23606-133">Right-click the publication, and then click **Properties**.</span></span>  
  
4.  <span data-ttu-id="23606-134">在 **[訂閱選項]** 頁面中，為 **[允許非 SQL Server 訂閱者]** 選項選取 **[True]** 值。</span><span class="sxs-lookup"><span data-stu-id="23606-134">On the **Subscription Options** page, select a value of **True** for the option **Allow non-SQL Server Subscribers**.</span></span> <span data-ttu-id="23606-135">選取此選項會變更某些屬性，使發行集能與非[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 訂閱者相容。</span><span class="sxs-lookup"><span data-stu-id="23606-135">Selecting this option changes a number of properties so that the publication is compatible with non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="23606-136">選取 **[True]** 會將 **pre_creation_cmd** 發行項屬性值設為 'drop'。</span><span class="sxs-lookup"><span data-stu-id="23606-136">Selecting **True** sets the value of the **pre_creation_cmd** article property to 'drop'.</span></span> <span data-ttu-id="23606-137">這項設定會指定當複寫符合發行項中的資料表名稱時，應該要卸除「訂閱者」端的資料表。</span><span class="sxs-lookup"><span data-stu-id="23606-137">This setting specifies that replication should drop a table at the Subscriber if it matches the name of the table in the article.</span></span> <span data-ttu-id="23606-138">如果您在「訂閱者」端有想要保留的現有資料表，請針對每一個發行項使用 [sp_changearticle](/sql/relational-databases/system-stored-procedures/sp-changearticle-transact-sql) 預存程序，並為 **pre_creation_cmd**指定 'none' 值： `sp_changearticle @publication= 'MyPublication', @article= 'MyArticle', @property='pre_creation_cmd', @value='none'`。</span><span class="sxs-lookup"><span data-stu-id="23606-138">If you have existing tables at the Subscriber that you want to keep, use the [sp_changearticle](/sql/relational-databases/system-stored-procedures/sp-changearticle-transact-sql) stored procedure for each article; specify a value 'none' for **pre_creation_cmd**: `sp_changearticle @publication= 'MyPublication', @article= 'MyArticle', @property='pre_creation_cmd', @value='none'`.</span></span>  
  
5.  [!INCLUDE[clickOK](../../includes/clickok-md.md)] <span data-ttu-id="23606-139">將會提示您為發行集建立新快照集。</span><span class="sxs-lookup"><span data-stu-id="23606-139">You will be prompted to create a new snapshot for the publication.</span></span> <span data-ttu-id="23606-140">如果不想此時建立快照集，請稍後使用下一個「如何」程序中描述的步驟。</span><span class="sxs-lookup"><span data-stu-id="23606-140">If you do not want to create one at this time, use the steps described in the next "how to" procedure at a later time.</span></span>  
  
#### <a name="to-create-a-subscription-for-a-non-sql-server-subscriber"></a><span data-ttu-id="23606-141">為非 SQL Server 訂閱者建立訂閱</span><span class="sxs-lookup"><span data-stu-id="23606-141">To create a subscription for a non-SQL Server Subscriber</span></span>  
  
1.  <span data-ttu-id="23606-142">展開 **[複寫]** 資料夾，然後展開 **[本機發行集]** 資料夾。</span><span class="sxs-lookup"><span data-stu-id="23606-142">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
2.  <span data-ttu-id="23606-143">以滑鼠右鍵按一下適當的發行集，然後再按一下 **[新增訂閱]** 。</span><span class="sxs-lookup"><span data-stu-id="23606-143">Right-click the appropriate publication, and then click **New Subscriptions**.</span></span>  
  
3.  <span data-ttu-id="23606-144">在 **[散發代理程式位置]** 頁面中，確定已選取 **[在散發者端執行所有代理程式]** 。</span><span class="sxs-lookup"><span data-stu-id="23606-144">On the **Distribution Agent Location** page, ensure **Run all agents at the Distributor** is selected.</span></span> <span data-ttu-id="23606-145">非[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 訂閱者不支援在「訂閱者」端執行代理程式。</span><span class="sxs-lookup"><span data-stu-id="23606-145">Non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers do not support running agents at the Subscriber.</span></span>  
  
4.  <span data-ttu-id="23606-146">在 **[訂閱者]** 頁面中，按一下 **[加入訂閱者]** 然後按一下 **[加入非 SQL Server 訂閱者]** 。</span><span class="sxs-lookup"><span data-stu-id="23606-146">On the **Subscribers** page, click **Add Subscriber** and then click **Add Non-SQL Server Subscriber**.</span></span>  
  
5.  <span data-ttu-id="23606-147">在 **[加入非 SQL Server 訂閱者]** 對話方塊中，選取「訂閱者」類型。</span><span class="sxs-lookup"><span data-stu-id="23606-147">In the **Add Non-SQL Server Subscriber** dialog box, select the type of Subscriber.</span></span>  
  
6.  <span data-ttu-id="23606-148">在 **[資料來源名稱]** 中輸入值：</span><span class="sxs-lookup"><span data-stu-id="23606-148">Enter a value in **Data source name**:</span></span>  
  
    -   <span data-ttu-id="23606-149">對於 Oracle，該值是您設定的 Transparent Network Substrate (TNS) 的名稱。</span><span class="sxs-lookup"><span data-stu-id="23606-149">For Oracle, this is the transparent network substrate (TNS) name you configured.</span></span>  
  
    -   <span data-ttu-id="23606-150">對於 IBM，該值可以是任何名稱。</span><span class="sxs-lookup"><span data-stu-id="23606-150">For IBM, this can be any name.</span></span> <span data-ttu-id="23606-151">通常會指定「訂閱者」的網路位址。</span><span class="sxs-lookup"><span data-stu-id="23606-151">It is typical to specify the network address of the Subscriber.</span></span>  
  
     <span data-ttu-id="23606-152">此精靈不會驗證在此步驟中輸入的資料來源名稱和在步驟 9 中指定的認證。</span><span class="sxs-lookup"><span data-stu-id="23606-152">The data source name entered in this step and the credentials specified in step 9 are not validated by this wizard.</span></span> <span data-ttu-id="23606-153">為訂閱執行「散發代理程式」後，複寫才會使用它們。</span><span class="sxs-lookup"><span data-stu-id="23606-153">They are not used by replication until the Distribution Agent runs for the subscription.</span></span> <span data-ttu-id="23606-154">透過使用用戶端工具 (如 Oracle 的 **sqlplus** ) 連接到「訂閱者」，來確定所有值都已經過測試。</span><span class="sxs-lookup"><span data-stu-id="23606-154">Ensure that all values have been tested by connecting to the Subscriber using a client tool (such as **sqlplus** for Oracle).</span></span> <span data-ttu-id="23606-155">如需相關資訊，請參閱 [Oracle Subscribers](non-sql/oracle-subscribers.md) 及 [IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md)。</span><span class="sxs-lookup"><span data-stu-id="23606-155">For more information, see [Oracle Subscribers](non-sql/oracle-subscribers.md) and [IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md).</span></span>  
  
7.  [!INCLUDE[clickOK](../../includes/clickok-md.md)] <span data-ttu-id="23606-156">在精靈的 **[訂閱者]** 頁面中，「訂閱者」即會顯示在 **[訂閱者]** 資料行中，且在 **[訂閱資料庫]** 資料行中只能讀取 **[(預設的目的地)]** ：</span><span class="sxs-lookup"><span data-stu-id="23606-156">On the **Subscribers** page of the wizard, the Subscriber is now displayed in the **Subscriber** column with a read-only **(default destination)** in the **Subscription Database** column:</span></span>  
  
    -   <span data-ttu-id="23606-157">在 Oracle 中，伺服器最多只有一個資料庫，所以不需要指定資料庫。</span><span class="sxs-lookup"><span data-stu-id="23606-157">For Oracle, a server has at most one database, so it is not necessary to specify the database.</span></span>  
  
    -   <span data-ttu-id="23606-158">對於 IBM DB2，在 DB2 連接字串的 **初始資料目錄** 屬性中指定資料庫，可在這個處理稍後描述的 **[其他連接選項]** 欄位中輸入。</span><span class="sxs-lookup"><span data-stu-id="23606-158">For IBM DB2, the database is specified in the **Initial Catalog** property of the DB2 connection string, which can be entered in the **Additional connection options** field described later in this process.</span></span>  
  
8.  <span data-ttu-id="23606-159">在 [**散發代理程式安全性**] 頁面上，按一下 [訂閱者] 旁的 [屬性]**按鈕 (]**) ，以存取 [**散發代理程式安全性**] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="23606-159">On the **Distribution Agent Security** page, click the properties button (**...**) next to the Subscriber to access the **Distribution Agent Security** dialog box.</span></span>  
  
9. <span data-ttu-id="23606-160">在 **[散發代理程式安全性]** 對話方塊中：</span><span class="sxs-lookup"><span data-stu-id="23606-160">In the **Distribution Agent Security** dialog box:</span></span>  
  
    -   <span data-ttu-id="23606-161">在 **[處理帳戶]** 、 **[密碼]** 及 **[確認密碼]** 欄位中，輸入「散發代理程式」應執行並與「訂閱者」建立本機連接所使用的 [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows 帳戶和密碼。</span><span class="sxs-lookup"><span data-stu-id="23606-161">In the **Process account**, **Password**, and **Confirm password** fields, enter the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows account and password under which the Distribution Agent should run and make local connections to the Distributor.</span></span>  
  
         <span data-ttu-id="23606-162">帳戶要求具有以下最小權限：散發資料庫中 **db_owner** 固定資料庫角色的成員；發行集存取清單 (PAL) 的成員；快照集共用的讀取權限；以及對 OLE DB 提供者之安裝目錄的讀取權限。</span><span class="sxs-lookup"><span data-stu-id="23606-162">The account requires these minimum permissions: member of the **db_owner** fixed database role in the distribution database; member of the publication access list (PAL); read permissions on the snapshot share; and read permission on the install directory of the OLE DB provider.</span></span> <span data-ttu-id="23606-163">如需 PAL 的詳細資訊，請參閱[保護發行者](security/secure-the-publisher.md)。</span><span class="sxs-lookup"><span data-stu-id="23606-163">For more information about the PAL, see [Secure the Publisher](security/secure-the-publisher.md).</span></span>  
  
    -   <span data-ttu-id="23606-164">在 **[連接到訂閱者]** 下的 **[登入]** 、 **[密碼]** 及 **[確認密碼]** 欄位中，輸入用來連接到「訂閱者」的登入和密碼。</span><span class="sxs-lookup"><span data-stu-id="23606-164">Under **Connect to the Subscriber**, in the **Login**, **Password**, and **Confirm password** fields, enter the login and password that should be used to connect to the Subscriber.</span></span> <span data-ttu-id="23606-165">此登入必須已經設定，還必須具有在訂閱資料庫中建立物件的足夠權限。</span><span class="sxs-lookup"><span data-stu-id="23606-165">This login should already be configured and should have sufficient permissions to create objects in the subscription database.</span></span>  
  
    -   <span data-ttu-id="23606-166">在 **[其他連接選項]** 欄位中，以連接字串形式指定「訂閱者」的任何連接選項 (Oracle 不需要其他選項)。</span><span class="sxs-lookup"><span data-stu-id="23606-166">In the **Additional connection options** field, specify any connection options for the Subscriber in the form of a connection string (Oracle does not require additional options).</span></span> <span data-ttu-id="23606-167">每個選項應以分號分隔。</span><span class="sxs-lookup"><span data-stu-id="23606-167">Each option should be separated by a semi-colon.</span></span> <span data-ttu-id="23606-168">以下為 DB2 連接字串的範例 (分行符號僅為便於閱讀)：</span><span class="sxs-lookup"><span data-stu-id="23606-168">The following is an example of a DB2 connection string (line breaks are for readability):</span></span>  
  
        ```  
        Provider=DB2OLEDB;Initial Catalog=MY_SUBSCRIBER_DB;Network Transport Library=TCP;Host CCSID=1252;  
        PC Code Page=1252;Network Address=MY_SUBSCRIBER;Network Port=50000;Package Collection=MY_PKGCOL;  
        Default Schema=MY_SCHEMA;Process Binary as Character=False;Units of Work=RUW;DBMS Platform=DB2/NT;  
        Persist Security Info=False;Connection Pooling=True;  
        ```  
  
         <span data-ttu-id="23606-169">字串中的大多數選項是您設定之 DB2 伺服器的專用選項，但 **將二進位當作字元處理** 選項，應一律設定為 [False] 。</span><span class="sxs-lookup"><span data-stu-id="23606-169">Most of the options in the string are specific to the DB2 server you are configuring, but the **Process Binary as Character** option should always be set to **False**.</span></span> <span data-ttu-id="23606-170">需要為 **初始目錄** 選項指定值，以便識別訂閱資料庫。</span><span class="sxs-lookup"><span data-stu-id="23606-170">A value is required for the **Initial Catalog** option to identify the subscription database.</span></span>  
  
10. <span data-ttu-id="23606-171">在 **[同步排程]** 頁面中，從 **[代理程式排程]** 功能表中選取「散發代理程式」的排程 (排程通常為 **[連續執行]** )。</span><span class="sxs-lookup"><span data-stu-id="23606-171">On the **Synchronization Schedule** page, select a schedule for the Distribution Agent from the **Agent Schedule** menu (the schedule is typically **Run continuously**).</span></span>  
  
11. <span data-ttu-id="23606-172">在 **[初始化訂閱]** 頁面中，指定是否應初始化訂閱以及初始化的時間 (如果是的話)：</span><span class="sxs-lookup"><span data-stu-id="23606-172">On the **Initialize Subscriptions** page, specify whether the subscription should be initialized and, if so, when it should be initialized:</span></span>  
  
    -   <span data-ttu-id="23606-173">只有在已建立了所有物件，並且已將全部所需資料都新增到訂閱資料庫中之後，才能清除 **[初始化]** 。</span><span class="sxs-lookup"><span data-stu-id="23606-173">Clear **Initialize** only if you have created all objects and added all required data in the subscription database.</span></span>  
  
    -   <span data-ttu-id="23606-174">在 **[初始化時機]** 資料行的下拉式清單中選取 **[立即]** ，以便使「散發代理程式」在此精靈完成後將快照集檔案傳送至「訂閱者」。</span><span class="sxs-lookup"><span data-stu-id="23606-174">Select **Immediately** from the drop-down list in the **Initialize When** column to have the Distribution Agent transfer snapshot files to the Subscriber after this wizard is completed.</span></span> <span data-ttu-id="23606-175">選取 **[第一次同步處理時]** ，即可使代理程式在下一個執行排程傳送檔案。</span><span class="sxs-lookup"><span data-stu-id="23606-175">Select **At first synchronization** to have the agent transfer the files the next time it is scheduled to run.</span></span>  
  
12. <span data-ttu-id="23606-176">在 **[精靈動作]** 頁面中，選擇性地編寫訂閱指令碼。</span><span class="sxs-lookup"><span data-stu-id="23606-176">On the **Wizard Actions** page, optionally script the subscription.</span></span> <span data-ttu-id="23606-177">如需詳細資訊，請參閱 [Scripting Replication](scripting-replication.md)。</span><span class="sxs-lookup"><span data-stu-id="23606-177">For more information, see [Scripting Replication](scripting-replication.md).</span></span>  
  
#### <a name="to-retain-tables-at-the-subscriber"></a><span data-ttu-id="23606-178">將資料表保留在訂閱者端</span><span class="sxs-lookup"><span data-stu-id="23606-178">To retain tables at the Subscriber</span></span>  
  
-   <span data-ttu-id="23606-179">依預設，若啟用非[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 訂閱者的發行集，就會將 **pre_creation_cmd** 發行項屬性的值設定為 'drop'。</span><span class="sxs-lookup"><span data-stu-id="23606-179">By default, enabling a publication for non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers sets the value of the **pre_creation_cmd** article property to 'drop'.</span></span> <span data-ttu-id="23606-180">這項設定會指定當複寫符合發行項中的資料表名稱時，應該要卸除「訂閱者」端的資料表。</span><span class="sxs-lookup"><span data-stu-id="23606-180">This setting specifies that replication should drop a table at the Subscriber if it matches the name of the table in the article.</span></span> <span data-ttu-id="23606-181">如果您在訂閱者端有想要保留的現有資料表，請針對每一個發行項使用 [sp_changearticle](/sql/relational-databases/system-stored-procedures/sp-changearticle-transact-sql) 預存程序，並為 **pre_creation_cmd**指定 'none' 值。</span><span class="sxs-lookup"><span data-stu-id="23606-181">If you have existing tables at the Subscriber that you want to keep, use the [sp_changearticle](/sql/relational-databases/system-stored-procedures/sp-changearticle-transact-sql) stored procedure for each article; specify a value 'none' for **pre_creation_cmd**.</span></span> <span data-ttu-id="23606-182">`sp_changearticle @publication= 'MyPublication', @article= 'MyArticle', @property='pre_creation_cmd', @value='none'`.</span><span class="sxs-lookup"><span data-stu-id="23606-182">`sp_changearticle @publication= 'MyPublication', @article= 'MyArticle', @property='pre_creation_cmd', @value='none'`.</span></span>  
  
#### <a name="to-generate-a-snapshot-for-the-publication"></a><span data-ttu-id="23606-183">產生發行集的快照集</span><span class="sxs-lookup"><span data-stu-id="23606-183">To generate a snapshot for the publication</span></span>  
  
1.  <span data-ttu-id="23606-184">展開 **[複寫]** 資料夾，然後展開 **[本機發行集]** 資料夾。</span><span class="sxs-lookup"><span data-stu-id="23606-184">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
2.  <span data-ttu-id="23606-185">以滑鼠右鍵按一下發行集，然後再按一下 **[檢視快照集代理程式的狀態]** 。</span><span class="sxs-lookup"><span data-stu-id="23606-185">Right-click the publication, and then click **View Snapshot Agent Status**.</span></span>  
  
3.  <span data-ttu-id="23606-186">在 [檢視快照集代理程式的狀態 - \<Publication>] 對話方塊中，按一下 [啟動]。</span><span class="sxs-lookup"><span data-stu-id="23606-186">In the **View Snapshot Agent Status - \<Publication>** dialog box, click **Start**.</span></span>  
  
 <span data-ttu-id="23606-187">「快照集代理程式」完成產生快照集後，會顯示一個訊息，例如「[100%] 已產生了 17 個發行項的快照集」。</span><span class="sxs-lookup"><span data-stu-id="23606-187">When the Snapshot Agent finishes generating the snapshot, a message is displayed, such as "[100%] A snapshot of 17 article(s) was generated."</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="23606-188">使用 Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="23606-188">Using Transact-SQL</span></span>  
 <span data-ttu-id="23606-189">您可以使用複寫預存程序，以程式設計的方式建立非[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 訂閱者的發送訂閱。</span><span class="sxs-lookup"><span data-stu-id="23606-189">You can create push subscriptions to non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers programmatically using replication stored procedures.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="23606-190">可能的話，會在執行階段提示使用者輸入安全性認證。</span><span class="sxs-lookup"><span data-stu-id="23606-190">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="23606-191">如果您必須將認證儲存在指令碼檔案中，則必須維護這個檔案的安全性，使他人無法在未獲授權的情況下擅自存取。</span><span class="sxs-lookup"><span data-stu-id="23606-191">If you must store credentials in a script file, you must secure the file to prevent unauthorized access.</span></span>  
  
#### <a name="to-create-a-push-subscription-for-a-transactional-or-snapshot-publication-to-a-non-sql-server-subscriber"></a><span data-ttu-id="23606-192">針對非 SQL Server 訂閱者的交易式或快照式發行集建立發送訂閱</span><span class="sxs-lookup"><span data-stu-id="23606-192">To create a push subscription for a transactional or snapshot publication to a non-SQL Server Subscriber</span></span>  
  
1.  <span data-ttu-id="23606-193">同時在發行者和散發者上針對非[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 訂閱者安裝最近的 OLE DB 提供者。</span><span class="sxs-lookup"><span data-stu-id="23606-193">Install the most recent OLE DB provider for the non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscriber at both the Publisher and Distributor.</span></span> <span data-ttu-id="23606-194">如需 OLE DB 提供者的複寫需求，請參閱＜ [Non-SQL Server Subscribers](non-sql/non-sql-server-subscribers.md)＞、＜ [Oracle Subscribers](non-sql/oracle-subscribers.md)＞、＜ [IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md)＞。</span><span class="sxs-lookup"><span data-stu-id="23606-194">For the replication requirements for an OLE DB provider, see [Non-SQL Server Subscribers](non-sql/non-sql-server-subscribers.md), [Oracle Subscribers](non-sql/oracle-subscribers.md), [IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md).</span></span>  
  
2.  <span data-ttu-id="23606-195">在發行集資料庫的發行者端，藉由執行 [sp_helppublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql) 來確認發行集支援非 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 訂閱者。</span><span class="sxs-lookup"><span data-stu-id="23606-195">At the Publisher on the publication database, verify that the publication supports non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers by executing [sp_helppublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span>  
  
    -   <span data-ttu-id="23606-196">如果 `enabled_for_het_sub` 的值為 1，表示支援非 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 訂閱者。</span><span class="sxs-lookup"><span data-stu-id="23606-196">If the value of `enabled_for_het_sub` is 1, non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers are supported.</span></span>  
  
    -   <span data-ttu-id="23606-197">如果的值 `enabled_for_het_sub` 是0，請執行[Sp_changepublication &#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql)，為指定， `enabled_for_het_sub` **@property** 並 `true` 針對 **@value** 。</span><span class="sxs-lookup"><span data-stu-id="23606-197">If the value of `enabled_for_het_sub` is 0, execute [sp_changepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specifying `enabled_for_het_sub` for **@property** and `true` for **@value**.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="23606-198">在將 `enabled_for_het_sub` 變更為 `true` 之前，您必須先卸除此發行集的任何現有訂閱。</span><span class="sxs-lookup"><span data-stu-id="23606-198">Before changing `enabled_for_het_sub` to `true`, you must drop any existing subscriptions to the publication.</span></span> <span data-ttu-id="23606-199">當此發行集同時支援更新訂閱時，您無法將 `enabled_for_het_sub` 設定為 `true`。</span><span class="sxs-lookup"><span data-stu-id="23606-199">You cannot set `enabled_for_het_sub` to `true` when the publication also supports updating subscriptions.</span></span> <span data-ttu-id="23606-200">變更 `enabled_for_het_sub` 會影響其他發行集屬性。</span><span class="sxs-lookup"><span data-stu-id="23606-200">Changing `enabled_for_het_sub` will affect other publication properties.</span></span> <span data-ttu-id="23606-201">如需詳細資訊，請參閱 [Non-SQL Server Subscribers](non-sql/non-sql-server-subscribers.md)。</span><span class="sxs-lookup"><span data-stu-id="23606-201">For more information, see [Non-SQL Server Subscribers](non-sql/non-sql-server-subscribers.md).</span></span>  
  
3.  <span data-ttu-id="23606-202">在發行集資料庫的發行者端，執行 [sp_addsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="23606-202">At the Publisher on the publication database, execute [sp_addsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="23606-203">指定 **@publication** 、 **@subscriber** 、 \*\* (預設目的地) \*\*的值、的 **@destination_db** **push**值 **@subscription_type** ，以及針對 **@subscriber_type** (指定 OLE DB 提供者) 的值。</span><span class="sxs-lookup"><span data-stu-id="23606-203">Specify **@publication**, **@subscriber**, a value of **(default destination)** for **@destination_db**, a value of **push** for **@subscription_type**, and a value of 3 for **@subscriber_type** (specifies an OLE DB provider).</span></span>  
  
4.  <span data-ttu-id="23606-204">在發行集資料庫的發行者端，執行 [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="23606-204">At the Publisher on the publication database, execute [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql).</span></span> <span data-ttu-id="23606-205">指定下列項目：</span><span class="sxs-lookup"><span data-stu-id="23606-205">Specify the following:</span></span>  
  
    -   <span data-ttu-id="23606-206">**@subscriber**和 **@publication** 參數。</span><span class="sxs-lookup"><span data-stu-id="23606-206">The **@subscriber**and **@publication** parameters.</span></span>  
  
    -   <span data-ttu-id="23606-207">的\*\* (預設目的地) \*\* **@subscriber_db** 的值。</span><span class="sxs-lookup"><span data-stu-id="23606-207">A value of **(default destination)** for **@subscriber_db**,</span></span>  
  
    -   <span data-ttu-id="23606-208">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **@subscriber_provider** 、、 **@subscriber_datasrc** **@subscriber_location** 、 **@subscriber_provider_string** 和 **@subscriber_catalog** 之非資料來源的屬性。</span><span class="sxs-lookup"><span data-stu-id="23606-208">The properties of the non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data source for **@subscriber_provider**, **@subscriber_datasrc**, **@subscriber_location**, **@subscriber_provider_string**, and **@subscriber_catalog**.</span></span>  
  
    -   <span data-ttu-id="23606-209">在散發者端用 [!INCLUDE[msCoName](../../includes/msconame-md.md)] 來執行和之散發代理程式的 Windows **@job_login** 認證 **@job_password** 。</span><span class="sxs-lookup"><span data-stu-id="23606-209">The [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows credentials under which the Distribution Agent at the Distributor runs for **@job_login** and **@job_password**.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="23606-210">使用「Windows 整合式驗證」建立的連接一律使用由和指定的 Windows 認證 **@job_login** **@job_password** 。</span><span class="sxs-lookup"><span data-stu-id="23606-210">Connections made using Windows Integrated Authentication always use the Windows credentials specified by **@job_login** and **@job_password**.</span></span> <span data-ttu-id="23606-211">散發代理程式一律使用「Windows 整合式驗證」建立與散發者的本機連接。</span><span class="sxs-lookup"><span data-stu-id="23606-211">The Distribution Agent always makes the local connection to the Distributor using Windows Integrated Authentication.</span></span> <span data-ttu-id="23606-212">依預設，代理程式會使用「Windows 整合式驗證」連接到訂閱者。</span><span class="sxs-lookup"><span data-stu-id="23606-212">By default, the agent will connect to the Subscriber using Windows Integrated Authentication.</span></span>  
  
    -   <span data-ttu-id="23606-213">的值為**0** ， **@subscriber_security_mode** 且和的 OLE DB 提供者登入資訊 **@subscriber_login** **@subscriber_password** 。</span><span class="sxs-lookup"><span data-stu-id="23606-213">A value of **0** for **@subscriber_security_mode** and the OLE DB provider login information for **@subscriber_login** and **@subscriber_password**.</span></span>  
  
    -   <span data-ttu-id="23606-214">此訂閱之散發代理程式作業的排程。</span><span class="sxs-lookup"><span data-stu-id="23606-214">A schedule for the Distribution Agent job for this subscription.</span></span> <span data-ttu-id="23606-215">如需詳細資訊，請參閱 [Specify Synchronization Schedules](specify-synchronization-schedules.md)。</span><span class="sxs-lookup"><span data-stu-id="23606-215">For more information, see [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="23606-216">利用遠端「散發者」來建立「發行者」上的發送訂閱時，提供給所有參數的值 (包括 *job_login* 和 *job_password*) 都會以純文字格式傳給「散發者」。</span><span class="sxs-lookup"><span data-stu-id="23606-216">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="23606-217">您應該先加密「發行者」及其遠端「散發者」之間的連接，再執行這個預存程序。</span><span class="sxs-lookup"><span data-stu-id="23606-217">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="23606-218">如需詳細資訊，請參閱[啟用 Database Engine 的加密連接 &#40;SQL Server 組態管理員&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)。</span><span class="sxs-lookup"><span data-stu-id="23606-218">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="23606-219">另請參閱</span><span class="sxs-lookup"><span data-stu-id="23606-219">See Also</span></span>  
 <span data-ttu-id="23606-220">[IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md) </span><span class="sxs-lookup"><span data-stu-id="23606-220">[IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md) </span></span>  
 <span data-ttu-id="23606-221">[Oracle Subscribers](non-sql/oracle-subscribers.md) </span><span class="sxs-lookup"><span data-stu-id="23606-221">[Oracle Subscribers](non-sql/oracle-subscribers.md) </span></span>  
 <span data-ttu-id="23606-222">[其他非 SQL Server 訂閱者](non-sql/other-non-sql-server-subscribers.md) </span><span class="sxs-lookup"><span data-stu-id="23606-222">[Other Non-SQL Server Subscribers](non-sql/other-non-sql-server-subscribers.md) </span></span>  
 <span data-ttu-id="23606-223">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="23606-223">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="23606-224">複寫安全性最佳作法</span><span class="sxs-lookup"><span data-stu-id="23606-224">Replication Security Best Practices</span></span>](security/replication-security-best-practices.md)  
  
  
