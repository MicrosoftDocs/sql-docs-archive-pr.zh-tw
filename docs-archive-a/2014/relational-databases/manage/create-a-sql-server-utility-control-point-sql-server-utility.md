---
title: 建立 SQL Server 公用程式控制點 (SQL Server 公用程式) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: configuration
ms.topic: conceptual
f1_keywords:
- SQL12.SWB.create.ucp.progress.F1
- SQL12.SWB.create.ucp.welcome.F1
- SQL12.SWB.create.ucp.Summary.F1
- SQL12.SWB.create.ucp.validation.F1
- SQL12.SWB.create.ucp.instancename.F1
- SQL12.SWB.create.ucp.agentconfiguration.F1
helpviewer_keywords:
- Create UCP
- UCP
ms.assetid: d5335124-1625-47ce-b4ac-36078967158c
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 833c83868230c2ac05514db666bd4cab629d9588
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87592691"
---
# <a name="create-a-sql-server-utility-control-point-sql-server-utility"></a><span data-ttu-id="59b74-102">建立 SQL Server 公用程式控制點 (SQL Server 公用程式)</span><span class="sxs-lookup"><span data-stu-id="59b74-102">Create a SQL Server Utility Control Point (SQL Server Utility)</span></span>
  <span data-ttu-id="59b74-103">企業可以擁有多個 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式，每一個 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式都可以管理多個 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體和資料層應用程式。</span><span class="sxs-lookup"><span data-stu-id="59b74-103">An enterprise can have multiple [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utilities, and each [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility can manage many instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and data-tier applications.</span></span> <span data-ttu-id="59b74-104">每一個 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式都只能有一個公用程式控制點 (UCP)。</span><span class="sxs-lookup"><span data-stu-id="59b74-104">Every [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility has one and only one utility control point (UCP).</span></span> <span data-ttu-id="59b74-105">您必須針對每一個 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式建立新的 UCP。</span><span class="sxs-lookup"><span data-stu-id="59b74-105">You must create a new UCP for each [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility.</span></span> <span data-ttu-id="59b74-106">每一個 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 受管理的執行個體和每一個資料層應用程式都只是一個 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式的成員，而且是由單一 UCP 所管理。</span><span class="sxs-lookup"><span data-stu-id="59b74-106">Each managed instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and every data-tier application is a member of one and only one [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility, and is managed by a single UCP.</span></span>

 <span data-ttu-id="59b74-107">UCP 每隔 15 分鐘就會從 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 受管理的執行個體收集組態和效能資訊。</span><span class="sxs-lookup"><span data-stu-id="59b74-107">The UCP collects configuration and performance information from managed instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] every 15 minutes.</span></span> <span data-ttu-id="59b74-108">這項資訊會儲存在 UCP 的公用程式管理資料倉儲 (UMDW) 中，而 UMDW 檔案名稱為 sysutility_mdw。</span><span class="sxs-lookup"><span data-stu-id="59b74-108">This information is stored in the utility management data warehouse (UMDW) on the UCP; the UMDW file name is sysutility_mdw.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="59b74-109">效能資料會與原則相比較，有助於識別資源使用瓶頸及合併機會。</span><span class="sxs-lookup"><span data-stu-id="59b74-109">performance data is compared to policies to help identify resource use bottlenecks and consolidation opportunities.</span></span>

## <a name="before-you-begin"></a><span data-ttu-id="59b74-110">開始之前</span><span class="sxs-lookup"><span data-stu-id="59b74-110">Before You Begin</span></span>
 <span data-ttu-id="59b74-111">在建立 UCP 之前，請先檢閱下列需求和建議事項。</span><span class="sxs-lookup"><span data-stu-id="59b74-111">Before you create a UCP, review the following requirements and recommendations.</span></span>

 <span data-ttu-id="59b74-112">在這一版中，UCP 及所有 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 受管理的執行個體都必須滿足以下需求：</span><span class="sxs-lookup"><span data-stu-id="59b74-112">In this release, the UCP and all managed instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] must satisfy the following requirements:</span></span>

-   [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="59b74-113">必須是 10.50 或更高的版本。</span><span class="sxs-lookup"><span data-stu-id="59b74-113">must be version 10.50 or higher.</span></span>

-   <span data-ttu-id="59b74-114">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體類型必須是 [!INCLUDE[ssDE](../../includes/ssde-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="59b74-114">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance type must be [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span></span>

-   <span data-ttu-id="59b74-115">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式必須在單一 Windows 網域或具有雙向信任關係的多個網域上運作。</span><span class="sxs-lookup"><span data-stu-id="59b74-115">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility must operate within a single Windows domain, or across domains with two-way trust relationships.</span></span>

-   <span data-ttu-id="59b74-116">UCP 上的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 服務帳戶及 SQL Server 的所有受管理的執行個體都必須具有 Active Directory 使用者的讀取權限。</span><span class="sxs-lookup"><span data-stu-id="59b74-116">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service accounts on the UCP and all managed instances of SQL Server must have read permission to Users in Active Directory.</span></span>

 <span data-ttu-id="59b74-117">在此版本中，UCP 必須滿足下列需求：</span><span class="sxs-lookup"><span data-stu-id="59b74-117">In this release, the UCP must satisfy the following requirements:</span></span>

-   <span data-ttu-id="59b74-118">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的執行個體必須是受支援的版本。</span><span class="sxs-lookup"><span data-stu-id="59b74-118">The instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] must be a supported edition.</span></span> <span data-ttu-id="59b74-119">如需版本支援的功能清單 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ，請參閱[SQL Server 2014 版本支援的功能](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md)。</span><span class="sxs-lookup"><span data-stu-id="59b74-119">For a list of features that are supported by the editions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], see [Features Supported by the Editions of SQL Server 2014](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>

-   <span data-ttu-id="59b74-120">我們建議您使用區分大小寫的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]執行個體來主控 UCP。</span><span class="sxs-lookup"><span data-stu-id="59b74-120">We recommend that the UCP is hosted by a case-sensitive instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>

 <span data-ttu-id="59b74-121">請考慮在 UCP 電腦上採用下列容量規劃建議：</span><span class="sxs-lookup"><span data-stu-id="59b74-121">Consider the following recommendations for capacity planning on the UCP computer:</span></span>

-   <span data-ttu-id="59b74-122">在一般的案例中，UCP 上的 UMDW 資料庫 (sysutility_mdw) 所使用的磁碟空間大約是每年每個 SQL Server 受管理的執行個體 2 GB。</span><span class="sxs-lookup"><span data-stu-id="59b74-122">In a typical scenario, disk space used by the UMDW database (sysutility_mdw) on the UCP is approximately 2 GB per managed instance of SQL Server per year.</span></span> <span data-ttu-id="59b74-123">這個估計會根據受管理的執行個體所收集的資料庫和系統物件數目而有所不同。</span><span class="sxs-lookup"><span data-stu-id="59b74-123">This estimate can vary depending on the number of database and system objects collected by the managed instance.</span></span> <span data-ttu-id="59b74-124">UMDW (sysutility_mdw) 磁碟空間成長率在頭兩天最高。</span><span class="sxs-lookup"><span data-stu-id="59b74-124">The UMDW (sysutility_mdw) disk space growth rate is highest during the first two days.</span></span>

-   <span data-ttu-id="59b74-125">在一般的案例中，UCP 上的 msdb 所使用的磁碟空間大約是每個 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]受管理的執行個體 20 MB。</span><span class="sxs-lookup"><span data-stu-id="59b74-125">In a typical scenario, disk space used by msdb on the UCP is approximately 20 MB per managed instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="59b74-126">請注意，這個估計會根據資源使用量原則以及受管理的執行個體所收集的資料庫和系統物件數目而有所不同。</span><span class="sxs-lookup"><span data-stu-id="59b74-126">Note that this estimate can vary depending on the resource utilization policies and the number of database and system objects collected by the managed instance.</span></span> <span data-ttu-id="59b74-127">一般來說，當原則違規數目增加，以及動態資源的移動時間間隔增加時，磁碟空間使用量也會增加。</span><span class="sxs-lookup"><span data-stu-id="59b74-127">In general, disk space usage increases as the number of policy violations increases and the duration of the moving time window for volatile resources increases.</span></span>

-   <span data-ttu-id="59b74-128">請注意，要等到受管理的執行個體的資料保留期限過期之後，從 UCP 移除受管理的執行個體才會減少 UCP 資料庫所使用的磁碟空間。</span><span class="sxs-lookup"><span data-stu-id="59b74-128">Note that removing a managed instance from the UCP will not reduce the disk space used by UCP databases until expiration of data retention periods for the managed instance.</span></span>

 <span data-ttu-id="59b74-129">在這一版中，所有 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 受管理的執行個體都必須滿足以下需求：</span><span class="sxs-lookup"><span data-stu-id="59b74-129">In this release, all managed instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] must satisfy the following requirements:</span></span>

-   <span data-ttu-id="59b74-130">我們建議如果使用不區分大小寫的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]執行個體來主控 UCP，則 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 受管理的執行個體也應該不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="59b74-130">We recommend that if the UCP is hosted by a case-insensitive instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], then managed instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] should also be case-insensitive.</span></span>

-   <span data-ttu-id="59b74-131">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式監視不支援 FILESTREAM 資料。</span><span class="sxs-lookup"><span data-stu-id="59b74-131">FILESTREAM data are not supported for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility monitoring.</span></span>

 <span data-ttu-id="59b74-132">如需詳細資訊，請參閱[SQL Server 2014 版本所支援](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md)SQL Server 和功能的[最大容量規格](../../sql-server/maximum-capacity-specifications-for-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="59b74-132">For more information, see [Maximum Capacity Specifications for SQL Server](../../sql-server/maximum-capacity-specifications-for-sql-server.md) and [Features Supported by the Editions of SQL Server 2014](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>

### <a name="remove-previous-utility-control-points-before-installing-a-new-one"></a><span data-ttu-id="59b74-133">移除先前的公用程式控制點，然後再安裝新的公用程式控制點</span><span class="sxs-lookup"><span data-stu-id="59b74-133">Remove Previous Utility Control Points Before Installing a New One</span></span>
 <span data-ttu-id="59b74-134">如果您要在曾經設定為公用程式控制點 (UCP) 的 SQL Server 執行個體上安裝 UCP，就必須先移除所有 SQL Server 受管理的執行個體並移除該 UCP，然後再進行此作業。</span><span class="sxs-lookup"><span data-stu-id="59b74-134">If you are installing a utility control point (UCP) on an instance of SQL Server that was ever configured as a UCP, you must remove all managed instances of SQL Server and remove the UCP before doing so.</span></span> <span data-ttu-id="59b74-135">您可以透過執行 **sp_sysutility_ucp_remove** 預存程序，完成移除作業。</span><span class="sxs-lookup"><span data-stu-id="59b74-135">You do this by running the **sp_sysutility_ucp_remove** stored procedure.</span></span>

 <span data-ttu-id="59b74-136">執行此程序前，請注意下列需求：</span><span class="sxs-lookup"><span data-stu-id="59b74-136">Before you run the procedure, note the following requirements:</span></span>

-   <span data-ttu-id="59b74-137">此程序必須在成為 UCP 的電腦上執行。</span><span class="sxs-lookup"><span data-stu-id="59b74-137">This procedure must be run on a computer that is a UCP.</span></span>

-   <span data-ttu-id="59b74-138">此程序必須由擁有系統管理員 (sysadmin) 權限的使用者執行，而這些是建立 UCP 所需的相同權限。</span><span class="sxs-lookup"><span data-stu-id="59b74-138">This procedure must be run by a user with sysadmin permissions, the same permissions required to create a UCP.</span></span>

-   <span data-ttu-id="59b74-139">您必須從 UCP 中移除所有 SQL Server 受管理的執行個體。</span><span class="sxs-lookup"><span data-stu-id="59b74-139">All managed instances of SQL Server must be removed from the UCP.</span></span> <span data-ttu-id="59b74-140">請注意，UCP 就是 SQL Server 受管理的執行個體。</span><span class="sxs-lookup"><span data-stu-id="59b74-140">Note that the UCP is a managed instance of SQL Server.</span></span> <span data-ttu-id="59b74-141">如需詳細資訊，請參閱[如何：從 SQL Server 公用程式移除 SQL Server 執行個體](https://go.microsoft.com/fwlink/?LinkId=169392)。</span><span class="sxs-lookup"><span data-stu-id="59b74-141">For more information, see [How to: Remove an Instance of SQL Server from the SQL Server Utility](https://go.microsoft.com/fwlink/?LinkId=169392).</span></span>

 <span data-ttu-id="59b74-142">您可以使用這個程序，從 SQL Server 公用程式中移除 SQL Server UCP。</span><span class="sxs-lookup"><span data-stu-id="59b74-142">Use this procedure to remove a SQL Server UCP from the SQL Server Utility.</span></span> <span data-ttu-id="59b74-143">完成此作業之後，您就可以再次於 SQL Server 執行個體上建立 UCP。</span><span class="sxs-lookup"><span data-stu-id="59b74-143">After the operation is complete, a UCP can be created on the instance of SQL Server again.</span></span>

 <span data-ttu-id="59b74-144">請使用 SQL Server Management Studio 來連接至 UCP，然後執行這個指令碼：</span><span class="sxs-lookup"><span data-stu-id="59b74-144">Use SQL Server Management Studio to connect to the UCP, then run this script:</span></span>

```sql
EXEC msdb.dbo.sp_sysutility_ucp_remove;
```

> [!NOTE]
>  <span data-ttu-id="59b74-145">如果已移除 UCP 的 SQL Server 執行個體具有非公用程式資料收集組，此程序就不會卸除 sysutility_mdw 資料庫。</span><span class="sxs-lookup"><span data-stu-id="59b74-145">If the instance of SQL Server where the UCP was removed has a non-Utility data collection set, the sysutility_mdw database is not dropped by the procedure.</span></span> <span data-ttu-id="59b74-146">如果發生這種情況，您就必須先手動卸除 sysutility_mdw 資料庫，然後才能再次建立 UCP。</span><span class="sxs-lookup"><span data-stu-id="59b74-146">If this is the case, the sysutility_mdw database must be dropped manually before the UCP can be created again.</span></span>

 <span data-ttu-id="59b74-147">每一個 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 受管理的執行個體和每一個資料層應用程式都只是一個 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式的成員，而且是由單一 UCP 所管理。</span><span class="sxs-lookup"><span data-stu-id="59b74-147">Each managed instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and every data-tier application is a member of one and only one [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility, and is managed by a single UCP.</span></span> <span data-ttu-id="59b74-148">如需 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式概念的詳細資訊，請參閱 [SQL Server 公用程式的功能與工作](sql-server-utility-features-and-tasks.md)。</span><span class="sxs-lookup"><span data-stu-id="59b74-148">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility concepts, see [SQL Server Utility Features and Tasks](sql-server-utility-features-and-tasks.md).</span></span>

 <span data-ttu-id="59b74-149">UCP 是 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式的中央推理點。</span><span class="sxs-lookup"><span data-stu-id="59b74-149">A UCP is the central reasoning point of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility.</span></span> <span data-ttu-id="59b74-150">您可以使用 UCP 來檢視從 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 受管理的執行個體和 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資料層應用程式收集而來的組態與效能資訊，並執行一般容量規劃活動。</span><span class="sxs-lookup"><span data-stu-id="59b74-150">Using the UCP, you can view configuration and performance information collected from managed instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data-tier applications, and perform general capacity planning activities.</span></span> <span data-ttu-id="59b74-151">UCP 是從 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式註冊及移除 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體的啟動點。</span><span class="sxs-lookup"><span data-stu-id="59b74-151">The UCP is the launch point for enrolling and removing instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] from the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility.</span></span>

 <span data-ttu-id="59b74-152">在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式中註冊 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體後，您可以監視 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 受管理的執行個體與資料層應用程式的資源健全狀況，以確認合併機會及隔離資源瓶頸。</span><span class="sxs-lookup"><span data-stu-id="59b74-152">After enrolling instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility, you can monitor resource health for managed instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and data-tier applications to identify consolidation opportunities and isolate resource bottlenecks.</span></span> <span data-ttu-id="59b74-153">如需詳細資訊，請參閱 [監視 SQL Server 公用程式中的 SQL Server 執行個體](monitor-instances-of-sql-server-in-the-sql-server-utility.md)。</span><span class="sxs-lookup"><span data-stu-id="59b74-153">For more information, see [Monitor Instances of SQL Server in the SQL Server Utility](monitor-instances-of-sql-server-in-the-sql-server-utility.md).</span></span>

> [!IMPORTANT]
>  <span data-ttu-id="59b74-154">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式收集組與非 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式收集組會一起受到支援。</span><span class="sxs-lookup"><span data-stu-id="59b74-154">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility collection set is supported side-by-side with non- [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility collection sets.</span></span> <span data-ttu-id="59b74-155">也就是說，當 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的 Managed 執行個體為 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式的成員時，可以受到其他收集組的監視。</span><span class="sxs-lookup"><span data-stu-id="59b74-155">That is, a managed instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] can be monitored by other collection sets while it is a member of a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility.</span></span> <span data-ttu-id="59b74-156">但是請注意，受管理的執行個體上的所有收集組都會將其資料上傳到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式管理資料倉儲。</span><span class="sxs-lookup"><span data-stu-id="59b74-156">Note, however, that all collection sets on the managed instance will upload their data to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility management data warehouse.</span></span> <span data-ttu-id="59b74-157">如需詳細資訊，請參閱[在相同 SQL Server 執行個體上執行公用程式和非公用程式收集組的考量事項](run-utility-and-non-utility-collection-sets-on-same-sql-instance.md)和[設定公用程式控制點資料倉儲 &#40;SQL Server 公用程式&#41;](configure-your-utility-control-point-data-warehouse-sql-server-utility.md)。</span><span class="sxs-lookup"><span data-stu-id="59b74-157">For more information, see [Considerations for Running Utility and non-Utility Collection Sets on the Same Instance of SQL Server](run-utility-and-non-utility-collection-sets-on-same-sql-instance.md) and [Configure Your Utility Control Point Data Warehouse &#40;SQL Server Utility&#41;](configure-your-utility-control-point-data-warehouse-sql-server-utility.md).</span></span>

## <a name="wizard-steps"></a><span data-ttu-id="59b74-158">精靈步驟</span><span class="sxs-lookup"><span data-stu-id="59b74-158">Wizard Steps</span></span>
 ![](../../database-engine/media/create-ucp.gif "Create_UCP")

 <span data-ttu-id="59b74-159">下列章節提供有關建立新 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] UCP 之精靈工作流程中每一頁的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="59b74-159">The following sections provide information about each page in the wizard work flow to create a new [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] UCP.</span></span> <span data-ttu-id="59b74-160">若要啟動此精靈來建立新的 UCP，請從 SSMS 的 [檢視] 功能表中開啟 [公用程式總管] 窗格，然後按一下 [公用程式總管] 窗格上方的 [建立 UCP] 按鈕 ![](../../database-engine/media/create-ucp.gif "Create_UCP")。</span><span class="sxs-lookup"><span data-stu-id="59b74-160">To launch the wizard to create a new UCP, open the Utility Explorer pane from the View menu in SSMS, then click on the ![](../../database-engine/media/create-ucp.gif "Create_UCP") **Create UCP** button at the top of the Utility Explorer pane.</span></span>

 <span data-ttu-id="59b74-161">按一下以下清單中的連結可導覽到精靈中頁面的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="59b74-161">Click on a link in the list below to navigate to details for a page in the Wizard.</span></span>

 <span data-ttu-id="59b74-162">如需有關這項作業之 PowerShell 指令碼的詳細資訊，請參閱 [範例](#PowerShell_create_UCP)。</span><span class="sxs-lookup"><span data-stu-id="59b74-162">For more information about a PowerShell script of this operation, see the [example](#PowerShell_create_UCP).</span></span>

-   [<span data-ttu-id="59b74-163">建立 UCP 精靈簡介</span><span class="sxs-lookup"><span data-stu-id="59b74-163">Introduction to Create UCP Wizard</span></span>](#Welcome)

-   [<span data-ttu-id="59b74-164">指定執行個體</span><span class="sxs-lookup"><span data-stu-id="59b74-164">Specify Instance</span></span>](#Instance_name)

-   [<span data-ttu-id="59b74-165">連接對話方塊</span><span class="sxs-lookup"><span data-stu-id="59b74-165">Connection Dialog</span></span>](#Connection_dialog)

-   [<span data-ttu-id="59b74-166">公用程式收集組帳戶</span><span class="sxs-lookup"><span data-stu-id="59b74-166">Utility Collection Set Account</span></span>](#Agent_configuration)

-   [<span data-ttu-id="59b74-167">驗證規則</span><span class="sxs-lookup"><span data-stu-id="59b74-167">Validation Rules</span></span>](#Validation_rules)

-   [<span data-ttu-id="59b74-168">總結</span><span class="sxs-lookup"><span data-stu-id="59b74-168">Summary</span></span>](#Summary)

-   [<span data-ttu-id="59b74-169">建立公用程式控制點</span><span class="sxs-lookup"><span data-stu-id="59b74-169">Creating the Utility Control Point</span></span>](#Creating_UCP)

##  <a name="introduction-to-create-ucp-wizard"></a><a name="Welcome"></a> <span data-ttu-id="59b74-170">建立 UCP 精靈簡介</span><span class="sxs-lookup"><span data-stu-id="59b74-170">Introduction to Create UCP Wizard</span></span>
 <span data-ttu-id="59b74-171">如果您開啟公用程式總管，而且沒有連接的公用程式控制點，您必須連接到其中一個控制點或建立新的控制點。</span><span class="sxs-lookup"><span data-stu-id="59b74-171">If you open Utility Explorer and there is no connected utility control point, you must connect to one or create a new one.</span></span>

 <span data-ttu-id="59b74-172">**連線到現有的 UCP** - 如果您的部署中已經有公用程式控制點，則可按一下 [公用程式總管] 窗格上方的 [連線到公用程式] 按鈕 ![](../../database-engine/media/connect-to-utility.gif "Connect_to_Utility") 來連線。</span><span class="sxs-lookup"><span data-stu-id="59b74-172">**Connect to existing UCP** - If there is already a utility control point in your deployment, you can connect to it by clicking the ![](../../database-engine/media/connect-to-utility.gif "Connect_to_Utility")**Connect to Utility** button at the top of the Utility Explorer pane.</span></span> <span data-ttu-id="59b74-173">若要連接到現有的 UCP，您必須擁有系統管理員認證，或是具有公用程式讀取者角色成員的身分。</span><span class="sxs-lookup"><span data-stu-id="59b74-173">To connect to an existing UCP, you must have administrator credentials or be a member of the Utility Reader role.</span></span> <span data-ttu-id="59b74-174">請注意，每個 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式上只能有一個 UCP，而且您也只能夠從一個 SSMS 執行個體連接到一個 UCP。</span><span class="sxs-lookup"><span data-stu-id="59b74-174">Note that there can only be one UCP per [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility and you can only be connected to one UCP from an instance of SSMS.</span></span>

 <span data-ttu-id="59b74-175">**建立新的 UCP** - 若要建立新的公用程式控制點，請按一下 [公用程式總管] 窗格上方的 [建立 UCP] 按鈕 ![](../../database-engine/media/create-ucp.gif "Create_UCP")。</span><span class="sxs-lookup"><span data-stu-id="59b74-175">**Create a new UCP** - To create a new utility control point, click the ![](../../database-engine/media/create-ucp.gif "Create_UCP")**Create UCP** button at the top of the Utility Explorer pane.</span></span> <span data-ttu-id="59b74-176">若要建立新的 UCP，您必須指定 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體名稱，並在連接對話方塊中提供系統管理員認證。</span><span class="sxs-lookup"><span data-stu-id="59b74-176">To create a new UCP, you must specify the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance name and provide administrator credentials in the connection dialog.</span></span> <span data-ttu-id="59b74-177">請注意，每一個 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式只能有一個 UCP。</span><span class="sxs-lookup"><span data-stu-id="59b74-177">Note that there can only be one UCP per [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility.</span></span>

##  <a name="specify-instance"></a><a name="Instance_name"></a> <span data-ttu-id="59b74-178">指定執行個體</span><span class="sxs-lookup"><span data-stu-id="59b74-178">Specify Instance</span></span>
 <span data-ttu-id="59b74-179">指定有關您建立之 UCP 的下列資訊：</span><span class="sxs-lookup"><span data-stu-id="59b74-179">Specify the following information about the UCP you are creating:</span></span>

-   <span data-ttu-id="59b74-180">**執行個體名稱** - 若要從連線對話方塊選取 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的執行個體，請按一下 [連線...]。使用以下格式提供電腦名稱和 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體名稱：ComputerName\InstanceName。</span><span class="sxs-lookup"><span data-stu-id="59b74-180">**Instance Name** - To select an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] from the connection dialog, click **Connect...**. Provide the computer name and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance name in the format ComputerName\InstanceName.</span></span>

-   <span data-ttu-id="59b74-181">**公用程式名稱** - 指定將用來識別網路上 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式的名稱。</span><span class="sxs-lookup"><span data-stu-id="59b74-181">**Utility Name** - Specify a name that will be used to identify the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility on the network.</span></span>

 <span data-ttu-id="59b74-182">若要繼續進行，請按 **[下一步]** 。</span><span class="sxs-lookup"><span data-stu-id="59b74-182">To continue, click **Next**.</span></span>

##  <a name="connection-dialog"></a><a name="Connection_dialog"></a> <span data-ttu-id="59b74-183">連線對話方塊</span><span class="sxs-lookup"><span data-stu-id="59b74-183">Connection Dialog</span></span>
 <span data-ttu-id="59b74-184">在 [連接到伺服器] 對話方塊中，確認伺服器類型、電腦名稱及 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體名稱資訊。</span><span class="sxs-lookup"><span data-stu-id="59b74-184">On the Connect to Server dialog box, verify the server type, computer name, and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance name information.</span></span> <span data-ttu-id="59b74-185">如需詳細資訊，請參閱[連接到伺服器 &#40;Database Engine&#41;](../../ssms/f1-help/connect-to-server-database-engine.md)。</span><span class="sxs-lookup"><span data-stu-id="59b74-185">For more information, see [Connect to Server &#40;Database Engine&#41;](../../ssms/f1-help/connect-to-server-database-engine.md).</span></span>

> [!NOTE]
>  <span data-ttu-id="59b74-186">如果連接已加密，將會使用加密的連接。</span><span class="sxs-lookup"><span data-stu-id="59b74-186">If the connection is encrypted, the encrypted connection will be used.</span></span> <span data-ttu-id="59b74-187">如果連接未加密， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式會使用加密的連接重新連接。</span><span class="sxs-lookup"><span data-stu-id="59b74-187">If the connection is not encrypted, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility will reconnect using an encrypted connection.</span></span>

 <span data-ttu-id="59b74-188">若要繼續，請按一下 [連線...]。</span><span class="sxs-lookup"><span data-stu-id="59b74-188">To continue, click **Connect...**.</span></span>

##  <a name="utility-collection-set-account"></a><a name="Agent_configuration"></a> <span data-ttu-id="59b74-189">公用程式收集組帳戶</span><span class="sxs-lookup"><span data-stu-id="59b74-189">Utility Collection Set Account</span></span>
 <span data-ttu-id="59b74-190">指定要執行 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式收集組的 Windows 網域帳戶。</span><span class="sxs-lookup"><span data-stu-id="59b74-190">Specify a Windows domain account to run the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility collection set.</span></span> <span data-ttu-id="59b74-191">此帳戶會當做 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式收集組的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent Proxy 帳戶來使用。</span><span class="sxs-lookup"><span data-stu-id="59b74-191">This account is used as the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent proxy account for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility collection set.</span></span> <span data-ttu-id="59b74-192">另外，您也可以使用現有的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 服務帳戶。</span><span class="sxs-lookup"><span data-stu-id="59b74-192">Alternatively, you can use the existing [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account.</span></span> <span data-ttu-id="59b74-193">若要通過驗證需求，請使用下列方針來指定帳戶。</span><span class="sxs-lookup"><span data-stu-id="59b74-193">To pass validation requirements, use the following guidelines to specify the account.</span></span>

 <span data-ttu-id="59b74-194">如果您指定 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 服務帳戶選項：</span><span class="sxs-lookup"><span data-stu-id="59b74-194">If you specify the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account option:</span></span>

-   <span data-ttu-id="59b74-195">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 服務帳戶必須是非內建帳戶 (如 LocalSystem、NetworkService 或 LocalService) 的 Windows 網域帳戶。</span><span class="sxs-lookup"><span data-stu-id="59b74-195">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account must be a Windows domain account that is not a built-in account like LocalSystem, NetworkService, or LocalService.</span></span>

 <span data-ttu-id="59b74-196">若要繼續進行，請按 **[下一步]** 。</span><span class="sxs-lookup"><span data-stu-id="59b74-196">To continue, click **Next**.</span></span>

##  <a name="validation-rules"></a><a name="Validation_rules"></a> <span data-ttu-id="59b74-197">驗證規則</span><span class="sxs-lookup"><span data-stu-id="59b74-197">Validation Rules</span></span>
 <span data-ttu-id="59b74-198">在這一版的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]中，以下條件必須在即將建立 UCP 的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體上成立：</span><span class="sxs-lookup"><span data-stu-id="59b74-198">In this release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the following conditions must be true on the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] where the UCP will be created:</span></span>

|<span data-ttu-id="59b74-199">驗證規則</span><span class="sxs-lookup"><span data-stu-id="59b74-199">Validation rule</span></span>|<span data-ttu-id="59b74-200">更正措施</span><span class="sxs-lookup"><span data-stu-id="59b74-200">Corrective action</span></span>|
|---------------------|-----------------------|
|<span data-ttu-id="59b74-201">您必須在即將建立公用程式控制點的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體上擁有系統管理員權限。</span><span class="sxs-lookup"><span data-stu-id="59b74-201">You must have administrator privileges on the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] where the utility control point will be created.</span></span>|<span data-ttu-id="59b74-202">使用具有 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]執行個體上系統管理員權限的帳戶登入。</span><span class="sxs-lookup"><span data-stu-id="59b74-202">Log on with an account that has administrator privileges on the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|
|<span data-ttu-id="59b74-203">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 版本必須是 10.50 或更高的版本。</span><span class="sxs-lookup"><span data-stu-id="59b74-203">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] version must be 10.50 or higher.</span></span>|<span data-ttu-id="59b74-204">指定要主控 UCP 的另一個 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體。</span><span class="sxs-lookup"><span data-stu-id="59b74-204">Specify a different instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to host the UCP.</span></span>|
|<span data-ttu-id="59b74-205">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的執行個體必須是受支援的版本。</span><span class="sxs-lookup"><span data-stu-id="59b74-205">The instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] must be a supported edition.</span></span> <span data-ttu-id="59b74-206">如需版本支援的功能清單 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ，請參閱[SQL Server 2014 版本支援的功能](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md)。</span><span class="sxs-lookup"><span data-stu-id="59b74-206">For a list of features that are supported by the editions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], see [Features Supported by the Editions of SQL Server 2014](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>|<span data-ttu-id="59b74-207">指定要主控 UCP 的另一個 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體。</span><span class="sxs-lookup"><span data-stu-id="59b74-207">Specify a different instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to host the UCP.</span></span>|
|<span data-ttu-id="59b74-208">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的執行個體不得為使用任何其他 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] UCP 所註冊的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體。</span><span class="sxs-lookup"><span data-stu-id="59b74-208">The instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] must not be an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] enrolled with any other [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] UCP.</span></span>|<span data-ttu-id="59b74-209">請指定不同的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體以裝載 UCP，或者從 UCP (目前為 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的受管理的執行個體) 解除 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]執行個體的註冊。</span><span class="sxs-lookup"><span data-stu-id="59b74-209">Specify a different instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to host the UCP, or unenroll the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] from the UCP where it is currently a managed instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|
|<span data-ttu-id="59b74-210">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的執行個體不得主控公用程式控制點。</span><span class="sxs-lookup"><span data-stu-id="59b74-210">The instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cannot already be host to a utility control point.</span></span>|<span data-ttu-id="59b74-211">指定要主控 UCP 的另一個 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體。</span><span class="sxs-lookup"><span data-stu-id="59b74-211">Specify a different instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to host the UCP.</span></span>|
|<span data-ttu-id="59b74-212">指定的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體必須啟用 TCP/IP。</span><span class="sxs-lookup"><span data-stu-id="59b74-212">The specified instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] should have TCP/IP enabled.</span></span>|<span data-ttu-id="59b74-213">為指定的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]執行個體啟用 TCP/IP。</span><span class="sxs-lookup"><span data-stu-id="59b74-213">Enable TCP/IP for the specified instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|
|<span data-ttu-id="59b74-214">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的執行個體不得擁有名為 "sysutility_mdw" 的資料庫。</span><span class="sxs-lookup"><span data-stu-id="59b74-214">The instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cannot have a database named "sysutility_mdw."</span></span>|<span data-ttu-id="59b74-215">建立 UCP 作業將會建立名為 "sysutility_mdw" 的公用程式管理資料倉儲 (UMDW)。</span><span class="sxs-lookup"><span data-stu-id="59b74-215">The create UCP operation will create a utility management data warehouse (UMDW) named "sysutility_mdw."</span></span> <span data-ttu-id="59b74-216">此作業會要求在執行驗證規則時，該名稱不能存在於電腦上。</span><span class="sxs-lookup"><span data-stu-id="59b74-216">The operation requires that the name does not exist on the computer at the time that validation rules are run.</span></span> <span data-ttu-id="59b74-217">若要繼續，您必須移除或重新命名任何名為 "sysutility_mdw" 的資料庫。</span><span class="sxs-lookup"><span data-stu-id="59b74-217">To continue, you must remove or rename any database named "sysutility_mdw."</span></span> <span data-ttu-id="59b74-218">如需重新命名作業的詳細資訊，請參閱 [ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="59b74-218">For more information about renaming operations, see [ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql).</span></span>|
|<span data-ttu-id="59b74-219">必須停止指定之 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體上的收集組。</span><span class="sxs-lookup"><span data-stu-id="59b74-219">Collection sets on the specified instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] must be stopped.</span></span>|<span data-ttu-id="59b74-220">在指定的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]執行個體上建立 UCP 時，請停止已經存在的收集組。</span><span class="sxs-lookup"><span data-stu-id="59b74-220">Stop pre-existing collection sets while the UCP is created on the specified instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="59b74-221">如果資料收集器已停用，請啟用它，並停止任何執行中的收集組，然後針對建立 UCP 作業重新執行驗證規則。</span><span class="sxs-lookup"><span data-stu-id="59b74-221">If the data collector is disabled, enable it, stop any running collection sets, then re-run validation rules for the Create UCP operation.</span></span><br /><br /> <span data-ttu-id="59b74-222">若要啟用資料收集器：</span><span class="sxs-lookup"><span data-stu-id="59b74-222">To enable the data collector:</span></span><br /><br /> <span data-ttu-id="59b74-223">在 [物件總管] 中，展開 **[管理]** 節點。</span><span class="sxs-lookup"><span data-stu-id="59b74-223">In Object Explorer, expand the **Management** node.</span></span><br /><br /> <span data-ttu-id="59b74-224">以滑鼠右鍵按一下 **[資料收集]** ，然後按一下 **[啟用資料收集]** 。</span><span class="sxs-lookup"><span data-stu-id="59b74-224">Right-click **Data Collection**, and then click **Enable Data Collection**.</span></span><br /><br /> <span data-ttu-id="59b74-225">若要停止收集組：</span><span class="sxs-lookup"><span data-stu-id="59b74-225">To stop a collection set:</span></span><br /><br /> <span data-ttu-id="59b74-226">在 [物件總管] 中，依序展開 [管理] 節點、 **[資料收集]** 和 **[系統資料收集組]** 。</span><span class="sxs-lookup"><span data-stu-id="59b74-226">In Object Explorer, expand the Management node, expand **Data Collection**, and then expand **System Data Collection Sets**.</span></span><br /><br /> <span data-ttu-id="59b74-227">以滑鼠右鍵按一下您要停止的收集組，然後按一下 **[停止資料收集組]** 。</span><span class="sxs-lookup"><span data-stu-id="59b74-227">Right-click the collection set that you want to stop, and then click **Stop Data Collection Set**.</span></span><br /><br /> <span data-ttu-id="59b74-228">訊息方塊會顯示此動作的結果，而此收集組圖示上的紅色圓圈會指示此收集組已經停止。</span><span class="sxs-lookup"><span data-stu-id="59b74-228">A message box will display the result of this action, and a red circle on the icon for the collection set indicates that the collection set has stopped.</span></span>|
|<span data-ttu-id="59b74-229">必須在指定的執行個體上啟動 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 服務。</span><span class="sxs-lookup"><span data-stu-id="59b74-229">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service on the specified instance must be started.</span></span> <span data-ttu-id="59b74-230">如果指定的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體是 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 容錯移轉叢集執行個體，那麼必須將 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 服務設定為手動啟動。</span><span class="sxs-lookup"><span data-stu-id="59b74-230">If the specified instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] failover cluster instance, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service must be configured to start manually.</span></span> <span data-ttu-id="59b74-231">否則，必須將 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 服務設定為自動啟動。</span><span class="sxs-lookup"><span data-stu-id="59b74-231">Otherwise, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service must be configured to start automatically.</span></span>|<span data-ttu-id="59b74-232">啟動 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 服務。</span><span class="sxs-lookup"><span data-stu-id="59b74-232">Start the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service.</span></span> <span data-ttu-id="59b74-233">如果指定的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體是 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 容錯移轉叢集執行個體，那麼請將 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 服務設定為手動啟動。</span><span class="sxs-lookup"><span data-stu-id="59b74-233">If the specified instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] failover cluster instance, configure the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service to start manually.</span></span> <span data-ttu-id="59b74-234">否則，請將 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 服務設定為自動啟動。</span><span class="sxs-lookup"><span data-stu-id="59b74-234">Otherwise, configure the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service to start automatically.</span></span>|
|<span data-ttu-id="59b74-235">WMI 必須正確設定。</span><span class="sxs-lookup"><span data-stu-id="59b74-235">WMI must be configured correctly.</span></span>|<span data-ttu-id="59b74-236">若要針對 WMI 組態進行疑難排解，請參閱 [疑難排解 SQL Server 公用程式](../../database-engine/troubleshoot-the-sql-server-utility.md)。</span><span class="sxs-lookup"><span data-stu-id="59b74-236">To troubleshoot WMI configuration, see [Troubleshoot the SQL Server Utility](../../database-engine/troubleshoot-the-sql-server-utility.md).</span></span>|
|<span data-ttu-id="59b74-237">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent Proxy 帳戶不得為內建帳戶，例如 Network Service。</span><span class="sxs-lookup"><span data-stu-id="59b74-237">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent proxy account cannot be a built-in account, like Network Service.</span></span>|<span data-ttu-id="59b74-238">如果 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent Proxy 帳戶為內建帳戶 (如 Network Service)，請將此帳戶重新指派給具有系統管理員權限的 Windows 網域帳戶。</span><span class="sxs-lookup"><span data-stu-id="59b74-238">If the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent proxy account is a built-in account, like Network Service, re-assign the account to a Windows domain account that is sysadmin.</span></span>|
|<span data-ttu-id="59b74-239">如果您選取 Proxy 帳戶選項， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent Proxy 帳戶必須是有效的 Windows 網域帳戶。</span><span class="sxs-lookup"><span data-stu-id="59b74-239">If you select the proxy account option, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent proxy account must be a valid Windows domain account.</span></span>|<span data-ttu-id="59b74-240">指定有效的 Windows 網域帳戶。</span><span class="sxs-lookup"><span data-stu-id="59b74-240">Specify a valid Windows domain account.</span></span> <span data-ttu-id="59b74-241">若要確保此帳戶是有效的，請使用 Windows 網域帳戶登入指定的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體。</span><span class="sxs-lookup"><span data-stu-id="59b74-241">To ensure that the account is valid, logon to the specified instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] using the Windows domain account.</span></span>|
|<span data-ttu-id="59b74-242">如果您選取服務帳戶選項， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 服務帳戶不得為內建帳戶，例如 Network Service。</span><span class="sxs-lookup"><span data-stu-id="59b74-242">If you select the service account option, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account cannot be a built-in account, like Network Service.</span></span>|<span data-ttu-id="59b74-243">如果 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 服務帳戶為內建帳戶 (如 Network Service)，請將此帳戶重新指派給 Windows 網域帳戶。</span><span class="sxs-lookup"><span data-stu-id="59b74-243">If the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account is a built-in account, like Network Service, re-assign the account to a Windows domain account.</span></span>|
|<span data-ttu-id="59b74-244">如果您選取服務帳戶選項， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent 服務帳戶必須是有效的 Windows 網域帳戶。</span><span class="sxs-lookup"><span data-stu-id="59b74-244">If you select the service account option, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account must be a valid Windows domain account.</span></span>|<span data-ttu-id="59b74-245">指定有效的 Windows 網域帳戶。</span><span class="sxs-lookup"><span data-stu-id="59b74-245">Specify a valid Windows domain account.</span></span> <span data-ttu-id="59b74-246">若要確保此帳戶是有效的，請使用 Windows 網域帳戶登入指定的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體。</span><span class="sxs-lookup"><span data-stu-id="59b74-246">To ensure that the account is valid, logon to the specified instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] using the Windows domain account.</span></span>|

 <span data-ttu-id="59b74-247">如果驗證結果中有失敗的情況，請更正阻礙問題，然後按一下 **[重新執行驗證]** 確認電腦組態。</span><span class="sxs-lookup"><span data-stu-id="59b74-247">If there are failed conditions in the validation results, correct the blocking issues and then click **Rerun Validation** to verify the computer configuration.</span></span>

 <span data-ttu-id="59b74-248">若要儲存驗證報表，請按一下 **[儲存報表]** 然後指定檔案的位置。</span><span class="sxs-lookup"><span data-stu-id="59b74-248">To save the validation report, click **Save Report** then specify a location for the file.</span></span>

 <span data-ttu-id="59b74-249">若要繼續進行，請按 **[下一步]** 。</span><span class="sxs-lookup"><span data-stu-id="59b74-249">To continue, click **Next**.</span></span>

##  <a name="summary"></a><a name="Summary"></a> <span data-ttu-id="59b74-250">摘要</span><span class="sxs-lookup"><span data-stu-id="59b74-250">Summary</span></span>
 <span data-ttu-id="59b74-251">摘要頁面會顯示您提供之有關 UCP 的資訊：</span><span class="sxs-lookup"><span data-stu-id="59b74-251">The summary page displays the information that you provided about the UCP:</span></span>

-   <span data-ttu-id="59b74-252">主控 UCP 的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體名稱。</span><span class="sxs-lookup"><span data-stu-id="59b74-252">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance name that hosts the UCP.</span></span>

-   <span data-ttu-id="59b74-253">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式的名稱。</span><span class="sxs-lookup"><span data-stu-id="59b74-253">The name of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility.</span></span>

-   <span data-ttu-id="59b74-254">將用於執行 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式資料收集工作的帳戶名稱。</span><span class="sxs-lookup"><span data-stu-id="59b74-254">The name of the account that will be used to run jobs for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility data collection.</span></span>

 <span data-ttu-id="59b74-255">若要變更 UCP 組態設定，請按 **[上一步]** 。</span><span class="sxs-lookup"><span data-stu-id="59b74-255">To change UCP configuration settings, click **Previous**.</span></span> <span data-ttu-id="59b74-256">若要繼續進行，請按 **[下一步]** 。</span><span class="sxs-lookup"><span data-stu-id="59b74-256">To continue, click **Next**.</span></span>

##  <a name="creating-the-utility-control-point"></a><a name="Creating_UCP"></a> <span data-ttu-id="59b74-257">建立公用程式控制點</span><span class="sxs-lookup"><span data-stu-id="59b74-257">Creating the Utility Control Point</span></span>
 <span data-ttu-id="59b74-258">在建立 UCP 作業的期間，此精靈會顯示步驟並提供狀態：</span><span class="sxs-lookup"><span data-stu-id="59b74-258">During the operation to create the UCP, the wizard will display the steps and provide status:</span></span>

-   <span data-ttu-id="59b74-259">正在準備 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體以建立 UCP。</span><span class="sxs-lookup"><span data-stu-id="59b74-259">Preparing the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance for UCP creation.</span></span>

-   <span data-ttu-id="59b74-260">正在建立公用程式管理資料倉儲 (UMDW)。</span><span class="sxs-lookup"><span data-stu-id="59b74-260">Creating the utility management data warehouse (UMDW).</span></span>

-   <span data-ttu-id="59b74-261">正在初始化 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] UMDW；UMDW 檔案名稱為 sysutility_mdw。</span><span class="sxs-lookup"><span data-stu-id="59b74-261">Initializing the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] UMDW; the UMDW file name is sysutility_mdw.</span></span>

-   <span data-ttu-id="59b74-262">正在設定 UCP。</span><span class="sxs-lookup"><span data-stu-id="59b74-262">Configuring the UCP.</span></span>

-   <span data-ttu-id="59b74-263">正在設定 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式收集組。</span><span class="sxs-lookup"><span data-stu-id="59b74-263">Configuring the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility collection set.</span></span>

 <span data-ttu-id="59b74-264">若要儲存有關建立 UCP 作業的報表，請按一下 **[儲存報表]** 然後指定檔案的位置。</span><span class="sxs-lookup"><span data-stu-id="59b74-264">To save a report about the create UCP operation, click **Save Report** then specify a location for the file.</span></span>

 <span data-ttu-id="59b74-265">若要完成精靈，請按一下 **[完成]** 。</span><span class="sxs-lookup"><span data-stu-id="59b74-265">To complete the wizard, click **Finish**.</span></span>

 <span data-ttu-id="59b74-266">完成建立 UCP 精靈之後，SSMS 中的 [公用程式總管] 導覽窗格會顯示 UCP 的節點，以及其底下針對部署的資料層應用程式、受管理的執行個體和公用程式管理的節點。</span><span class="sxs-lookup"><span data-stu-id="59b74-266">After completing the Create UCP Wizard, the Utility Explorer navigation pane in SSMS displays a node for the UCP with nodes under it for Deployed Data-tier Applications, Managed Instances, and Utility Administration.</span></span> <span data-ttu-id="59b74-267">UCP 會自動變成受管理的執行個體。</span><span class="sxs-lookup"><span data-stu-id="59b74-267">The UCP automatically becomes a managed instance.</span></span>

 <span data-ttu-id="59b74-268">資料收集程序會立即開始，但是最多需要 30 分鐘的時間，資料才會第一次出現在 [公用程式總管] 內容窗格的儀表板和視點內。</span><span class="sxs-lookup"><span data-stu-id="59b74-268">The data collection process begins immediately, but it can take up to 30 minutes for data to first appear in the dashboard and viewpoints in the Utility Explorer content pane.</span></span> <span data-ttu-id="59b74-269">資料收集會持續每隔 15 分鐘進行一次。</span><span class="sxs-lookup"><span data-stu-id="59b74-269">Data collection continues once every 15 minutes.</span></span> <span data-ttu-id="59b74-270">初始資料將來自 UCP 本身。</span><span class="sxs-lookup"><span data-stu-id="59b74-270">Initial data will be from the UCP itself.</span></span> <span data-ttu-id="59b74-271">也就是說，UCP 是 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式中的第一個 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 受管理的執行個體。</span><span class="sxs-lookup"><span data-stu-id="59b74-271">That is, the UCP is the first managed instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility.</span></span>

 <span data-ttu-id="59b74-272">若要顯示儀表板，請從 SSMS 功能表按一下 **[檢視]** ，然後選取 **[公用程式總管內容]** 。</span><span class="sxs-lookup"><span data-stu-id="59b74-272">To display the dashboard, click **View** then select **Utility Explorer Content** from the SSMS menu.</span></span> <span data-ttu-id="59b74-273">若要重新整理資料，請以滑鼠右鍵按一下 [公用程式總管] 窗格中的公用程式名稱，然後選取 [重新整理]。</span><span class="sxs-lookup"><span data-stu-id="59b74-273">To refresh data, right-click the utility name in the Utility Explorer pane, then select **Refresh**.</span></span>

 <span data-ttu-id="59b74-274">如需如何在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式中註冊其他 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 執行個體的詳細資訊，請參閱[註冊 SQL Server 的執行個體 &#40;SQL Server 公用程式&#41;](enroll-an-instance-of-sql-server-sql-server-utility.md)。</span><span class="sxs-lookup"><span data-stu-id="59b74-274">For more information about how to enroll additional instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] into the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility, see [Enroll an Instance of SQL Server &#40;SQL Server Utility&#41;](enroll-an-instance-of-sql-server-sql-server-utility.md).</span></span> <span data-ttu-id="59b74-275">若要從 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 公用程式中移除當做 受管理的執行個體的 UCP，請在 **[公用程式總管]** 窗格中選取 **[受管理的執行個體]** 來填入受管理的執行個體的清單檢視，然後以滑鼠右鍵按一下 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [公用程式總管內容] **清單檢視中的** 執行個體名稱，再選取 **[將執行個體設為未受管理]** 。</span><span class="sxs-lookup"><span data-stu-id="59b74-275">To remove the UCP as a managed instance from the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Utility, select **Managed Instances** in the **Utility Explorer** pane to populate the list view of managed instances, right-click on the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance name in the **Utility Explorer Content** list view, then select **Make Instance Unmanaged**.</span></span>

##  <a name="create-a-new-utility-control-point-using-powershell"></a><a name="PowerShell_create_UCP"></a> <span data-ttu-id="59b74-276">使用 PowerShell 建立新的公用程式控制點</span><span class="sxs-lookup"><span data-stu-id="59b74-276">Create a New Utility Control Point Using PowerShell</span></span>
 <span data-ttu-id="59b74-277">使用下列範例建立新的公用程式控制點：</span><span class="sxs-lookup"><span data-stu-id="59b74-277">Use the following example to create a new utility control point:</span></span>

```powershell
$UtilityInstance = new-object -Type Microsoft.SqlServer.Management.Smo.Server "ComputerName\UCP-Name";
$SqlStoreConnection = new-object -Type Microsoft.SqlServer.Management.Sdk.Sfc.SqlStoreConnection $UtilityInstance.ConnectionContext.SqlConnectionObject;
$Utility = [Microsoft.SqlServer.Management.Utility.Utility]::CreateUtility("Utility", $SqlStoreConnection, "ProxyAccount", "ProxyAccountPassword");
```

## <a name="see-also"></a><span data-ttu-id="59b74-278">另請參閱</span><span class="sxs-lookup"><span data-stu-id="59b74-278">See Also</span></span>
 <span data-ttu-id="59b74-279">[SQL Server 公用程式功能和](sql-server-utility-features-and-tasks.md)[工作會針對 SQL Server 公用程式進行疑難排解](../../database-engine/troubleshoot-the-sql-server-utility.md)</span><span class="sxs-lookup"><span data-stu-id="59b74-279">[SQL Server Utility Features and Tasks](sql-server-utility-features-and-tasks.md) [Troubleshoot the SQL Server Utility](../../database-engine/troubleshoot-the-sql-server-utility.md)</span></span>
