---
title: 資料類型使用方式 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- ODBC data types
- ODBC data types, about ODBC data types
- SQL Server Native Client ODBC driver, result sets
- ODBC applications, result sets
- data types [ODBC]
- SQL Server Native Client ODBC driver, data types
- data types [ODBC], about data types
ms.assetid: 4f19b0d6-94ac-4a98-a121-57d38787864c
author: rothja
ms.author: jroth
ms.openlocfilehash: 8333f45fd9e3b742b3765efaee5ae7a865161bc2
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87708270"
---
# <a name="data-type-usage"></a><span data-ttu-id="ed06e-102">資料類型使用方式</span><span class="sxs-lookup"><span data-stu-id="ed06e-102">Data Type Usage</span></span>
  <span data-ttu-id="ed06e-103">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驅動程式，並 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 強加下列資料類型的使用。</span><span class="sxs-lookup"><span data-stu-id="ed06e-103">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] impose the following use of data types.</span></span>  
  
|<span data-ttu-id="ed06e-104">資料類型</span><span class="sxs-lookup"><span data-stu-id="ed06e-104">Data type</span></span>|<span data-ttu-id="ed06e-105">限制</span><span class="sxs-lookup"><span data-stu-id="ed06e-105">Limitation</span></span>|  
|---------------|----------------|  
|<span data-ttu-id="ed06e-106">日期常值</span><span class="sxs-lookup"><span data-stu-id="ed06e-106">Date literals</span></span>|<span data-ttu-id="ed06e-107">日期常值，當儲存在 SQL_TYPE_TIMESTAMP 資料行 ([!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **datetime**或**Smalldatetime**) 的資料類型時，其時間值為12：00： 00.000 A.M。</span><span class="sxs-lookup"><span data-stu-id="ed06e-107">Date literals, when stored in a SQL_TYPE_TIMESTAMP column ([!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data types of **datetime** or **smalldatetime**), have a time value of 12:00:00.000 A.M.</span></span>|  
|<span data-ttu-id="ed06e-108">**money**和**smallmoney**</span><span class="sxs-lookup"><span data-stu-id="ed06e-108">**money** and **smallmoney**</span></span>|<span data-ttu-id="ed06e-109">只有**money**和**smallmoney**資料類型的整數部分很重要。</span><span class="sxs-lookup"><span data-stu-id="ed06e-109">Only the integer parts of the **money** and **smallmoney** data types are significant.</span></span> <span data-ttu-id="ed06e-110">如果在資料類型轉換期間截斷 SQL **money**資料的小數部分， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC 驅動程式會傳回警告，而不是錯誤。</span><span class="sxs-lookup"><span data-stu-id="ed06e-110">If the decimal part of SQL **money** data is truncated during data type conversion, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver returns a warning, not an error.</span></span>|  
|<span data-ttu-id="ed06e-111">SQL_BINARY (可為 Null)</span><span class="sxs-lookup"><span data-stu-id="ed06e-111">SQL_BINARY (nullable)</span></span>|<span data-ttu-id="ed06e-112">連接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.0 版和更早版本時，如果 SQL_BINARY 資料行可為 Null，則儲存在資料來源中的資料就不會以零進行填補。</span><span class="sxs-lookup"><span data-stu-id="ed06e-112">When connected to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] version 6.0 and earlier, if a SQL_BINARY column is nullable, the data that is stored in the data source is not padded with zeroes.</span></span> <span data-ttu-id="ed06e-113">抓取這類資料行的資料時， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native CLIENT ODBC 驅動程式會在右側以零填補。</span><span class="sxs-lookup"><span data-stu-id="ed06e-113">When data from such a column is retrieved, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver pads it with zeroes on the right.</span></span> <span data-ttu-id="ed06e-114">不過，在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 所執行的作業 (例如串連) 中建立的資料就沒有此類填補。</span><span class="sxs-lookup"><span data-stu-id="ed06e-114">However, data that is created in operations performed by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], such as concatenation, does not have such padding.</span></span><br /><br /> <span data-ttu-id="ed06e-115">此外，當資料是放在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.0 或更早版本之執行個體的此類資料行中，且資料太長而無法放入資料行時，[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 就會從右側截斷資料。</span><span class="sxs-lookup"><span data-stu-id="ed06e-115">Also, when data is placed in such a column in an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.0 or earlier, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] truncates the data on the right if it is too long to fit into the column.</span></span> <span data-ttu-id="ed06e-116">**注意：** [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驅動程式支援連接至 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 和更早版本。</span><span class="sxs-lookup"><span data-stu-id="ed06e-116">**Note:**  The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does support connecting to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 and earlier.</span></span>|  
|<span data-ttu-id="ed06e-117">SQL_CHAR (截斷)</span><span class="sxs-lookup"><span data-stu-id="ed06e-117">SQL_CHAR (truncation)</span></span>|<span data-ttu-id="ed06e-118">如果是連接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.0 和更早版本的執行個體，而且資料是放在 SQL_CHAR 資料行中，則在資料太長無法放入資料行時，[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 會在未提供警告的情況下從右側截斷資料。</span><span class="sxs-lookup"><span data-stu-id="ed06e-118">When connected to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.0 and earlier, and data is placed into a SQL_CHAR column, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] truncates it on the right without warning if the data is too long to fit into the column.</span></span> <span data-ttu-id="ed06e-119">**注意：** [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驅動程式支援連接至 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 和更早版本。</span><span class="sxs-lookup"><span data-stu-id="ed06e-119">**Note:**  The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does support connecting to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 and earlier.</span></span>|  
|<span data-ttu-id="ed06e-120">SQL_CHAR (可為 Null)</span><span class="sxs-lookup"><span data-stu-id="ed06e-120">SQL_CHAR (nullable)</span></span>|<span data-ttu-id="ed06e-121">當連接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.0 和更早版本時，如果 SQL_CHAR 資料行可為 Null，則儲存在資料來源中的資料就不會以空白進行填補。</span><span class="sxs-lookup"><span data-stu-id="ed06e-121">When connected to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.0 and earlier, if a SQL_CHAR column is nullable, the data that is stored in the data source is not padded with blanks.</span></span> <span data-ttu-id="ed06e-122">抓取這類資料行的資料時， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native CLIENT ODBC 驅動程式會在右側以空白填補。</span><span class="sxs-lookup"><span data-stu-id="ed06e-122">When data from such a column is retrieved, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver pads it with blanks on the right.</span></span> <span data-ttu-id="ed06e-123">不過，在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 所執行的作業 (例如串連) 中建立的資料就沒有此類填補。</span><span class="sxs-lookup"><span data-stu-id="ed06e-123">However, data that is created in operations performed by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], such as concatenation, does not have such padding.</span></span> <span data-ttu-id="ed06e-124">**注意：** [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驅動程式支援連接至 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 和更早版本。</span><span class="sxs-lookup"><span data-stu-id="ed06e-124">**Note:**  The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does support connecting to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 and earlier.</span></span>|  
|<span data-ttu-id="ed06e-125">SQL_LONGVARBINARY、SQL_LONGVARCHAR、SQL_WLONGVARCHAR</span><span class="sxs-lookup"><span data-stu-id="ed06e-125">SQL_LONGVARBINARY, SQL_LONGVARCHAR, SQL_WLONGVARCHAR</span></span>|<span data-ttu-id="ed06e-126">當連接到實例6時，會完全支援 SQL_LONGVARBINARY、SQL_LONGVARCHAR 或 SQL_WLONGVARCHAR 資料類型 (使用 WHERE 子句) 會影響多個資料列的資料行更新 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。*x*和更新版本。</span><span class="sxs-lookup"><span data-stu-id="ed06e-126">Updates of columns with SQL_LONGVARBINARY, SQL_LONGVARCHAR, or SQL_WLONGVARCHAR data types (using a WHERE clause) that affect multiple rows are fully supported when connected to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.*x* and later.</span></span> <span data-ttu-id="ed06e-127">當連接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 4.2*x*的實例時，會出現 S1000 錯誤「部分插入/更新」。</span><span class="sxs-lookup"><span data-stu-id="ed06e-127">When connected to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 4.2*x*, an S1000 error, "Partial insert/update.</span></span> <span data-ttu-id="ed06e-128">文字或影像資料行的插入/更新未成功」。</span><span class="sxs-lookup"><span data-stu-id="ed06e-128">The insert/update of a text or image column(s) did not succeed" is returned if the update affects more than one row.</span></span> <span data-ttu-id="ed06e-129">**注意：** [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驅動程式支援連接至 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 和更早版本。</span><span class="sxs-lookup"><span data-stu-id="ed06e-129">**Note:**  The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does support connecting to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 and earlier.</span></span>|  
|<span data-ttu-id="ed06e-130">字串函數參數</span><span class="sxs-lookup"><span data-stu-id="ed06e-130">String function parameters</span></span>|<span data-ttu-id="ed06e-131">字串函數的*string_exp*參數必須是 SQL_CHAR 或 SQL_VARCHAR 的資料類型。</span><span class="sxs-lookup"><span data-stu-id="ed06e-131">*string_exp* parameters to the string functions must be of data type SQL_CHAR or SQL_VARCHAR.</span></span> <span data-ttu-id="ed06e-132">字串函數中不支援 SQL_LONG_VARCHAR 資料類型。</span><span class="sxs-lookup"><span data-stu-id="ed06e-132">SQL_LONG_VARCHAR data types are not supported in the string functions.</span></span> <span data-ttu-id="ed06e-133">*Count*參數必須小於或等於8000，因為 SQL_CHAR 和 SQL_VARCHAR 資料類型受限於8000個字元的最大長度。</span><span class="sxs-lookup"><span data-stu-id="ed06e-133">The *count* parameter must be less than or equal to 8,000 because the SQL_CHAR and SQL_VARCHAR data types are limited to a maximum length of 8,000 characters.</span></span>|  
|<span data-ttu-id="ed06e-134">時間常值</span><span class="sxs-lookup"><span data-stu-id="ed06e-134">Time literals</span></span>|<span data-ttu-id="ed06e-135">時間常值（當儲存在 SQL_TIMESTAMP 資料行中， ([!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **datetime**或**Smalldatetime**) 的資料類型時，其日期值為1900年1月1日。</span><span class="sxs-lookup"><span data-stu-id="ed06e-135">Time literals, when stored in a SQL_TIMESTAMP column ([!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data types of **datetime** or **smalldatetime**), have a date value of January 1, 1900.</span></span>|  
|<span data-ttu-id="ed06e-136">**timestamp**</span><span class="sxs-lookup"><span data-stu-id="ed06e-136">**timestamp**</span></span>|<span data-ttu-id="ed06e-137">只有 Null 值可以手動插入**timestamp**資料行。</span><span class="sxs-lookup"><span data-stu-id="ed06e-137">Only a NULL value can be manually inserted into a **timestamp** column.</span></span> <span data-ttu-id="ed06e-138">不過，由於**時間戳記**資料行是由自動更新 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ，所以會覆寫 Null 值。</span><span class="sxs-lookup"><span data-stu-id="ed06e-138">However, because **timestamp**columns are automatically updated by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], a NULL value is overwritten.</span></span>|  
|<span data-ttu-id="ed06e-139">**tinyint**</span><span class="sxs-lookup"><span data-stu-id="ed06e-139">**tinyint**</span></span>|<span data-ttu-id="ed06e-140">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **Tinyint**資料類型不帶正負號。</span><span class="sxs-lookup"><span data-stu-id="ed06e-140">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **tinyint** data type is unsigned.</span></span> <span data-ttu-id="ed06e-141">在預設的情況下， **Tinyint**資料行系結至資料類型 SQL_C_UTINYINT 的變數。</span><span class="sxs-lookup"><span data-stu-id="ed06e-141">A **tinyint** column is bound to a variable of data type SQL_C_UTINYINT by default.</span></span>|  
|<span data-ttu-id="ed06e-142">別名資料類型</span><span class="sxs-lookup"><span data-stu-id="ed06e-142">Alias data types</span></span>|<span data-ttu-id="ed06e-143">當連接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 4.2*x*的實例時，ODBC 驅動程式會將 Null 新增至未明確宣告資料行 null 屬性的資料行定義。</span><span class="sxs-lookup"><span data-stu-id="ed06e-143">When connected to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 4.2*x*, the ODBC driver adds NULL to a column definition that does not explicitly declare a column's nullability.</span></span> <span data-ttu-id="ed06e-144">因此會忽略儲存在別名資料類型定義中的 Null 屬性。</span><span class="sxs-lookup"><span data-stu-id="ed06e-144">Therefore, the nullability that is stored in the definition of an alias data type is ignored.</span></span><br /><br /> <span data-ttu-id="ed06e-145">當連接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 4.2*x*的實例時，具有具有**char**或**binary**基底資料類型且未宣告 null 屬性之別名資料類型的資料行，會建立為**Varchar**或**Varbinary**資料類型。</span><span class="sxs-lookup"><span data-stu-id="ed06e-145">When connected to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 4.2*x*, columns with an alias data type that has a base data type of **char** or **binary** and for which no nullability is declared are created as data type **varchar** or **varbinary**.</span></span> <span data-ttu-id="ed06e-146">[SQLColAttribute](../native-client-odbc-api/sqlcolattribute.md)、 [SQLColumns](../native-client-odbc-api/sqlcolumns.md)和[SQLDescribeCol](../native-client-odbc-api/sqldescribecol.md)會傳回 SQL_VARCHAR 或 SQL_VARBINARY 做為這些資料行的資料類型。</span><span class="sxs-lookup"><span data-stu-id="ed06e-146">[SQLColAttribute](../native-client-odbc-api/sqlcolattribute.md), [SQLColumns](../native-client-odbc-api/sqlcolumns.md), and [SQLDescribeCol](../native-client-odbc-api/sqldescribecol.md) return SQL_VARCHAR or SQL_VARBINARY as the data type for these columns.</span></span> <span data-ttu-id="ed06e-147">從這些資料行所擷取的資料不會進行填補。</span><span class="sxs-lookup"><span data-stu-id="ed06e-147">Data that is retrieved from these columns is not padded.</span></span> <span data-ttu-id="ed06e-148">**注意：** [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驅動程式支援連接至 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 和更早版本。</span><span class="sxs-lookup"><span data-stu-id="ed06e-148">**Note:**  The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does support connecting to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 and earlier.</span></span>|  
|<span data-ttu-id="ed06e-149">LONG 資料類型</span><span class="sxs-lookup"><span data-stu-id="ed06e-149">LONG data types</span></span>|<span data-ttu-id="ed06e-150">同時限制 SQL_LONGVARBINARY 和 SQL_LONGVARCHAR 資料類型的*資料執行中*參數。</span><span class="sxs-lookup"><span data-stu-id="ed06e-150">*data-at-execution* parameters are restricted for both the SQL_LONGVARBINARY and the SQL_LONGVARCHAR data types.</span></span>|  
|<span data-ttu-id="ed06e-151">大型值類型</span><span class="sxs-lookup"><span data-stu-id="ed06e-151">Large value types</span></span>|<span data-ttu-id="ed06e-152">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驅動程式會在接受或傳回 ODBC SQL 資料類型的 api 中，分別\*\* () \*\*、 \*\*Varbinary (max) **和**Nvarchar (max) \*\*類型，SQL_VARCHAR 和 SQL_VARBINARY SQL_WVARCHAR 的最大值。</span><span class="sxs-lookup"><span data-stu-id="ed06e-152">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver will expose **varchar(max)**, **varbinary(max)**, and **nvarchar(max)** types as SQL_VARCHAR, SQL_VARBINARY and SQL_WVARCHAR (respectively) in APIs that accept or return ODBC SQL data types.</span></span>|  
|<span data-ttu-id="ed06e-153">使用者定義型別 (UDT)</span><span class="sxs-lookup"><span data-stu-id="ed06e-153">User-defined type (UDT)</span></span>|<span data-ttu-id="ed06e-154">UDT 資料行會對應為 SQL_SS_UDT。</span><span class="sxs-lookup"><span data-stu-id="ed06e-154">UDT columns are mapped as SQL_SS_UDT.</span></span> <span data-ttu-id="ed06e-155">如果 UDT 資料行使用 UDT 的 ToString() 或 ToXMLString() 方法或是透過 CAST/CONVERT 函數而明確地對應到 SQL 陳述式中的其他類型，則結果集內的資料行類型會反映出此資料行轉換成的實際類型。</span><span class="sxs-lookup"><span data-stu-id="ed06e-155">If a UDT column is mapped explicitly to another type in the SQL statement using the ToString() or ToXMLString() methods of the UDT, or via the CAST/CONVERT functions, the type of the column in the result set will reflect the actual type to which the column was converted.</span></span><br /><br /> <span data-ttu-id="ed06e-156">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驅動程式只能以二進位形式系結至 UDT 資料行。</span><span class="sxs-lookup"><span data-stu-id="ed06e-156">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver can only bind to a UDT column as binary.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ed06e-157">只支援 SQL_SS_UDT 和 SQL_C_BINARY 資料類型之間的轉換。</span><span class="sxs-lookup"><span data-stu-id="ed06e-157">only supports conversion between the SQL_SS_UDT and SQL_C_BINARY data types.</span></span>|  
|<span data-ttu-id="ed06e-158">XML</span><span class="sxs-lookup"><span data-stu-id="ed06e-158">XML</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ed06e-159">會自動將 XML 轉換為 Unicode 文字。</span><span class="sxs-lookup"><span data-stu-id="ed06e-159">will automatically convert XML to Unicode text.</span></span> <span data-ttu-id="ed06e-160">XML 類型會對應為 SQL_SS_XML。</span><span class="sxs-lookup"><span data-stu-id="ed06e-160">The XML type is mapped as SQL_SS_XML.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="ed06e-161">另請參閱</span><span class="sxs-lookup"><span data-stu-id="ed06e-161">See Also</span></span>  
 [<span data-ttu-id="ed06e-162">&#40;ODBC&#41;處理結果</span><span class="sxs-lookup"><span data-stu-id="ed06e-162">Processing Results &#40;ODBC&#41;</span></span>](processing-results-odbc.md)  
  
  
