---
title: SQLXMLOLEDB 提供者簡介 (SQLXML 4.0) |Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: xml
ms.topic: reference
helpviewer_keywords:
- SQLXMLOLEDB Provider, properties
- adExecuteStream flag
- SQLXMLOLEDB Provider, about SQLXMLOLEDB Provider
ms.assetid: 2e3f3817-4209-4bf4-9f46-248c95bc6f1b
author: rothja
ms.author: jroth
ms.openlocfilehash: af8b37620abd0b1228c82c902f812cf0d0912dd8
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87700876"
---
# <a name="introduction-to-the-sqlxmloledb-provider-sqlxml-40"></a><span data-ttu-id="47173-102">SQLXMLOLEDB 提供者簡介 (SQLXML 4.0)</span><span class="sxs-lookup"><span data-stu-id="47173-102">Introduction to the SQLXMLOLEDB Provider (SQLXML 4.0)</span></span>
  <span data-ttu-id="47173-103">SQLXMLOLEDB 提供者是一種 OLE DB 提供者，可透過 ActiveX Data Objects (ADO) 來公開 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] SQLXML 功能。</span><span class="sxs-lookup"><span data-stu-id="47173-103">The SQLXMLOLEDB Provider is an OLE DB provider that exposes [!INCLUDE[msCoName](../../../includes/msconame-md.md)] SQLXML functionality through ActiveX Data Objects (ADO).</span></span> <span data-ttu-id="47173-104">但是，此提供者只能在 ADO 的「寫入到輸出資料流」模式中執行命令。</span><span class="sxs-lookup"><span data-stu-id="47173-104">However, the provider can execute commands only in the "write to an output stream" mode of ADO.</span></span> <span data-ttu-id="47173-105">SQLXMLOLEDB 提供者不是資料列集提供者。</span><span class="sxs-lookup"><span data-stu-id="47173-105">The SQLXMLOLEDB Provider is not a rowset provider.</span></span> <span data-ttu-id="47173-106">當您執行命令時，您必須指定 adExecuteStream 旗標，它會指示 ADO 使用您所指定的輸出資料流程。</span><span class="sxs-lookup"><span data-stu-id="47173-106">When you execute a command, you must specify the adExecuteStream flag, which directs ADO to use the output stream that you have specified.</span></span>  
  
 <span data-ttu-id="47173-107">下列範例顯示指定 adExecuteStream 旗標之 Execute 命令的語法：</span><span class="sxs-lookup"><span data-stu-id="47173-107">The following example shows the syntax for the Execute command in which the adExecuteStream flag is specified:</span></span>  
  
```  
Dim oTestCommand As New ADODB.Command  
...  
oTestCommand.Properties("Output Stream").Value = oTestStream  
oTestCommand.Execute , , adExecuteStream  
...  
```  
  
## <a name="sqlxmloledb-provider-specific-properties"></a><span data-ttu-id="47173-108">SQLXMLOLEDB 提供者特有的屬性</span><span class="sxs-lookup"><span data-stu-id="47173-108">SQLXMLOLEDB Provider-specific Properties</span></span>  
 <span data-ttu-id="47173-109">SQLXMLOLEDB 提供者會公開以下提供者特有的連接屬性。</span><span class="sxs-lookup"><span data-stu-id="47173-109">The SQLXMLOLEDB Provider exposes the following provider-specific connection property.</span></span>  
  
|<span data-ttu-id="47173-110">Connection</span><span class="sxs-lookup"><span data-stu-id="47173-110">Connection</span></span><br /><br /> <span data-ttu-id="47173-111">屬性</span><span class="sxs-lookup"><span data-stu-id="47173-111">property</span></span>|<span data-ttu-id="47173-112">預設值</span><span class="sxs-lookup"><span data-stu-id="47173-112">Default</span></span><br /><br /> <span data-ttu-id="47173-113">(如果有的話)</span><span class="sxs-lookup"><span data-stu-id="47173-113">(if any)</span></span>|<span data-ttu-id="47173-114">Description</span><span class="sxs-lookup"><span data-stu-id="47173-114">Description</span></span>|  
|-----------------------------|----------------------------|-----------------|  
|<span data-ttu-id="47173-115">資料提供者</span><span class="sxs-lookup"><span data-stu-id="47173-115">Data Provider</span></span>||<span data-ttu-id="47173-116">提供 OLE DB 提供者的 PROGID，SQLXMLOLEDB 會透過它來執行命令。</span><span class="sxs-lookup"><span data-stu-id="47173-116">Provides the PROGID of the OLE DB provider through which SQLXMLOLEDB executes the commands.</span></span> <span data-ttu-id="47173-117">從 SQLXML 4.0 和 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 開始，這個提供者就會包含在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 中；因此，這個屬性值受限為 "SQLNCLI11"。</span><span class="sxs-lookup"><span data-stu-id="47173-117">Beginning in SQLXML 4.0 and [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this provider is contained within the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client; therefore, this property value is restricted to "SQLNCLI11".</span></span> <span data-ttu-id="47173-118">如需詳細資訊，請參閱 [SQL Server Native Client 程式設計](../../native-client/sql-server-native-client-programming.md)。</span><span class="sxs-lookup"><span data-stu-id="47173-118">For more information, see [SQL Server Native Client Programming](../../native-client/sql-server-native-client-programming.md).</span></span>|  
  
 <span data-ttu-id="47173-119">SQLXMLOLEDB 提供者會公開以下提供者特有的命令屬性。</span><span class="sxs-lookup"><span data-stu-id="47173-119">The SQLXMLOLEDB Provider exposes the following provider-specific command properties.</span></span>  
  
|<span data-ttu-id="47173-120">Command</span><span class="sxs-lookup"><span data-stu-id="47173-120">Command</span></span><br /><br /> <span data-ttu-id="47173-121">屬性</span><span class="sxs-lookup"><span data-stu-id="47173-121">property</span></span>|<span data-ttu-id="47173-122">預設值</span><span class="sxs-lookup"><span data-stu-id="47173-122">Default</span></span><br /><br /> <span data-ttu-id="47173-123">(如果有的話)</span><span class="sxs-lookup"><span data-stu-id="47173-123">(if any)</span></span>|<span data-ttu-id="47173-124">Description</span><span class="sxs-lookup"><span data-stu-id="47173-124">Description</span></span>|  
|--------------------------|----------------------------|-----------------|  
|<span data-ttu-id="47173-125">基底路徑</span><span class="sxs-lookup"><span data-stu-id="47173-125">Base Path</span></span>|<span data-ttu-id="47173-126">""</span><span class="sxs-lookup"><span data-stu-id="47173-126">""</span></span>|<span data-ttu-id="47173-127">指定基底檔案路徑。</span><span class="sxs-lookup"><span data-stu-id="47173-127">Specifies the base file path.</span></span> <span data-ttu-id="47173-128">基底檔案路徑是用來指定 XML 樣式表語言 (XSL) 或對應結構描述檔案的位置。</span><span class="sxs-lookup"><span data-stu-id="47173-128">The base file path is used to specify the location of the XML Stylesheet Language (XSL) or mapping schema files.</span></span> <span data-ttu-id="47173-129">基底檔案路徑也用來解析 xsl 或對應架構屬性中已指定之 XSL 或對應架構檔案的相對路徑。</span><span class="sxs-lookup"><span data-stu-id="47173-129">The base file path is also used to resolve the relative paths of XSL or mapping schema files that have been specified in the XSL or Mapping Schema properties.</span></span><br /><br /> <span data-ttu-id="47173-130">如需使用此屬性的範例，請參閱[&#40;SQLXMLOLEDB 提供者&#41;執行 XPath 查詢](executing-xpath-queries-sqlxmloledb-provider.md)。</span><span class="sxs-lookup"><span data-stu-id="47173-130">For an example in which this property is used, see [Executing XPath Queries &#40;SQLXMLOLEDB Provider&#41;](executing-xpath-queries-sqlxmloledb-provider.md).</span></span>|  
|<span data-ttu-id="47173-131">ClientSideXML</span><span class="sxs-lookup"><span data-stu-id="47173-131">ClientSideXML</span></span>|<span data-ttu-id="47173-132">否</span><span class="sxs-lookup"><span data-stu-id="47173-132">False</span></span>|<span data-ttu-id="47173-133">如果您希望將資料列集轉換成 XML 的程序發生在用戶端而不是伺服器上，請將這個屬性設定為 True。</span><span class="sxs-lookup"><span data-stu-id="47173-133">Set this property to True if you want the process of converting the rowset to XML to occur on the client instead of on the server.</span></span> <span data-ttu-id="47173-134">如果您想要將效能負載移到中介層，這個作法會很實用。</span><span class="sxs-lookup"><span data-stu-id="47173-134">This is useful when you want to move the performance load to the middle tier.</span></span><br /><br /> <span data-ttu-id="47173-135">如需使用此屬性的範例，請參閱[&#40;SQLXMLOLEDB 提供者執行 Sql 查詢&#41;](executing-sql-queries-sqlxmloledb-provider.md)或[執行包含 SQL 查詢 &#40;SQLXMLOLEDB 提供者&#41;的範本](executing-templates-that-contain-sql-queries-sqlxmloledb-provider.md)。</span><span class="sxs-lookup"><span data-stu-id="47173-135">For an example in which this property is used, see [Executing SQL Queries &#40;SQLXMLOLEDB Provider&#41;](executing-sql-queries-sqlxmloledb-provider.md) or [Executing Templates That Contain SQL Queries &#40;SQLXMLOLEDB Provider&#41;](executing-templates-that-contain-sql-queries-sqlxmloledb-provider.md).</span></span>|  
|<span data-ttu-id="47173-136">內容類型</span><span class="sxs-lookup"><span data-stu-id="47173-136">Content Type</span></span>||<span data-ttu-id="47173-137">傳回輸出內容類型。</span><span class="sxs-lookup"><span data-stu-id="47173-137">Returns the output content type.</span></span> <span data-ttu-id="47173-138">這是 READ ONLY 屬性。</span><span class="sxs-lookup"><span data-stu-id="47173-138">This is a READ ONLY property.</span></span><br /><br /> <span data-ttu-id="47173-139">這個屬性會將有關內容類型 (如 TEXT/XML、TEXT/HTML、image/jpeg 等等) 的資訊提供給瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="47173-139">This property provides information to the browser about the content type (such as TEXT/XML, TEXT/HTML, image/jpeg, and so on).</span></span> <span data-ttu-id="47173-140">這個屬性的值會變成以 HTTP 標頭的一部分傳送至瀏覽器的**content-type**欄位，其中包含作為主體傳送之檔的 MIME 類型 (多用途網際網路郵件延伸) 。</span><span class="sxs-lookup"><span data-stu-id="47173-140">The value of this property becomes the **content-type** field that is sent to the browser as part of the HTTP header, which contains the MIME-type (Multipurpose Internet Mail Extensions) of the document being sent as the body.</span></span>|  
|<span data-ttu-id="47173-141">對應結構描述</span><span class="sxs-lookup"><span data-stu-id="47173-141">Mapping Schema</span></span>|<span data-ttu-id="47173-142">NULL</span><span class="sxs-lookup"><span data-stu-id="47173-142">NULL</span></span>|<span data-ttu-id="47173-143">如果用戶端應用程式針對對應結構描述 (XDR 或 XSD) 執行 XPath 查詢，這個屬性會用來指定對應結構描述的名稱。</span><span class="sxs-lookup"><span data-stu-id="47173-143">If a client application executes an XPath query against a mapping schema (XDR or XSD), this property is used to specify the name of the mapping schema.</span></span><br /><br /> <span data-ttu-id="47173-144">指定的路徑可以是相對路徑 (xyz/abc/MySchema.xml) 或絕對路徑 (C:\MyFolder\abc\MySchema.xml)。</span><span class="sxs-lookup"><span data-stu-id="47173-144">The path that is specified can be relative (xyz/abc/MySchema.xml) or absolute (C:\MyFolder\abc\MySchema.xml).</span></span><br /><br /> <span data-ttu-id="47173-145">如果指定相對路徑，則會使用 [基底路徑] 屬性所指定的基底路徑來解析相對路徑。</span><span class="sxs-lookup"><span data-stu-id="47173-145">If a relative path is specified, the base path that is specified by the Base Path property is used to resolve the relative path.</span></span> <span data-ttu-id="47173-146">如果未在 [基底路徑] 屬性中指定路徑，相對路徑會相對於目前的目錄。</span><span class="sxs-lookup"><span data-stu-id="47173-146">If no path has been specified in the Base Path property, the relative path is relative to the current directory.</span></span><br /><br /> <span data-ttu-id="47173-147">在指定 [對應架構] 屬性的值時，您可以指定本機目錄路徑，或 (HTTP://... ) 的 URL。如果您指定 URL，您必須將 WinHTTP 設定為透過 proxy 伺服器存取 HTTP 和 HTTPS 伺服器。</span><span class="sxs-lookup"><span data-stu-id="47173-147">In specifying a value for the Mapping Schema property, you can specify a local directory path or a URL (http://...). If you specify a URL, you must configure WinHTTP to access HTTP and HTTPS servers through a proxy server.</span></span> <span data-ttu-id="47173-148">您可以執行 Proxycfg.exe 公用程式來進行這項處理。</span><span class="sxs-lookup"><span data-stu-id="47173-148">You can do this by executing the Proxycfg.exe utility.</span></span> <span data-ttu-id="47173-149">如需詳細資訊，請參閱 MSDN Library 中的＜使用 WinHTTP Proxy 組態公用程式＞(英文)。</span><span class="sxs-lookup"><span data-stu-id="47173-149">For more information, see "Using the WinHTTP Proxy Configuration Utility" in the MSDN Library.</span></span><br /><br /> <span data-ttu-id="47173-150">如需使用此屬性的範例，請參閱[&#40;SQLXMLOLEDB 提供者&#41;執行 XPath 查詢](executing-xpath-queries-sqlxmloledb-provider.md)。</span><span class="sxs-lookup"><span data-stu-id="47173-150">For an example in which this property is used, see [Executing XPath Queries &#40;SQLXMLOLEDB Provider&#41;](executing-xpath-queries-sqlxmloledb-provider.md).</span></span>|  
|<span data-ttu-id="47173-151">命名空間</span><span class="sxs-lookup"><span data-stu-id="47173-151">namespaces</span></span>||<span data-ttu-id="47173-152">這個屬性會讓使用命名空間的 XPath 查詢得以執行。</span><span class="sxs-lookup"><span data-stu-id="47173-152">This property enables the execution of XPath queries that use namespaces.</span></span> <span data-ttu-id="47173-153">如需使用此屬性的範例，請參閱[使用命名空間執行 XPath 查詢 &#40;SQLXMLOLEDB 提供者&#41;](executing-xpath-queries-with-namespaces-sqlxmloledb-provider.md)。</span><span class="sxs-lookup"><span data-stu-id="47173-153">For an example in which this property is used, see [Executing XPath Queries with Namespaces &#40;SQLXMLOLEDB Provider&#41;](executing-xpath-queries-with-namespaces-sqlxmloledb-provider.md).</span></span>|  
|<span data-ttu-id="47173-154">ss 資料流旗標</span><span class="sxs-lookup"><span data-stu-id="47173-154">ss Stream Flags</span></span>||<span data-ttu-id="47173-155">這個屬性是用來指定特定類型的安全性限制。</span><span class="sxs-lookup"><span data-stu-id="47173-155">This property is used to specify particular types of security restrictions.</span></span> <span data-ttu-id="47173-156">例如，您可能不想允許指向檔案的 URL 參考或是指向檔案的絕對路徑 (如外部網站)。</span><span class="sxs-lookup"><span data-stu-id="47173-156">For example, you might not want to allow URL references to files or absolute paths to files (such as external sites).</span></span> <span data-ttu-id="47173-157">或者，您可能不想允許範本中有查詢存在。</span><span class="sxs-lookup"><span data-stu-id="47173-157">Or you might not want to allow queries in the templates.</span></span><br /><br /> <span data-ttu-id="47173-158">下面的值可以指派給這個屬性：</span><span class="sxs-lookup"><span data-stu-id="47173-158">The property can be assigned these values:</span></span><br /><br /> <span data-ttu-id="47173-159">1 = STREAM_FLAGS_DISALLOW_URL 2 = STREAM_FLAGS_DISALLOW_ABSOLUTE_PATH 4 = STREAM_FLAGS_DISALLOW_QUERY 8 = STREAM_FLAGS_       DONTCACHEMAPPINGSCHEMA 16 = STREAM_FLAGS_DONTCACHETEMPLATE 32 = STREAM_FLAGS_DONTCACHEXSL</span><span class="sxs-lookup"><span data-stu-id="47173-159">1 = STREAM_FLAGS_DISALLOW_URL 2 = STREAM_FLAGS_DISALLOW_ABSOLUTE_PATH 4 = STREAM_FLAGS_DISALLOW_QUERY 8 = STREAM_FLAGS_       DONTCACHEMAPPINGSCHEMA 16 = STREAM_FLAGS_DONTCACHETEMPLATE 32 = STREAM_FLAGS_DONTCACHEXSL</span></span><br /><br /> <span data-ttu-id="47173-160">下一個表格中將提供有關這些值的其他資訊。</span><span class="sxs-lookup"><span data-stu-id="47173-160">Additional information about these values is provided in the next table.</span></span>|  
|<span data-ttu-id="47173-161">xml root</span><span class="sxs-lookup"><span data-stu-id="47173-161">xml root</span></span>||<span data-ttu-id="47173-162">這個屬性是用來定義產生之 XML 的根標記。</span><span class="sxs-lookup"><span data-stu-id="47173-162">This property is used to define a root tag for the resulting XML.</span></span> <span data-ttu-id="47173-163">例如，如果您針對資料庫執行 SQL 查詢，而且產生的 XML 文件沒有單一根元素，此屬性的值可用來將單一根元素加入到文件中。</span><span class="sxs-lookup"><span data-stu-id="47173-163">For example, if you execute SQL queries against the database and the resulting XML document has no single root element, the value of the property is used to add a single root element to the document.</span></span><br /><br /> <span data-ttu-id="47173-164">如需使用此屬性的範例，請參閱[&#40;SQLXMLOLEDB 提供者&#41;執行 SQL 查詢](executing-sql-queries-sqlxmloledb-provider.md)。</span><span class="sxs-lookup"><span data-stu-id="47173-164">For an example in which this property is used, see [Executing SQL Queries &#40;SQLXMLOLEDB Provider&#41;](executing-sql-queries-sqlxmloledb-provider.md).</span></span>|  
|<span data-ttu-id="47173-165">xsl</span><span class="sxs-lookup"><span data-stu-id="47173-165">xsl</span></span>||<span data-ttu-id="47173-166">當您想要將 XSL 轉換套用到查詢所傳回的 XML 文件時，可使用這個屬性來指定 XSL 檔案名稱。</span><span class="sxs-lookup"><span data-stu-id="47173-166">This property is used to specify the XSL file name when you want to apply XSL transformation to the XML document returned by the query.</span></span><br /><br /> <span data-ttu-id="47173-167">指定的路徑可以是相對路徑 (xyz/abc/MyXSL.xsl) 或絕對路徑 (C:\MyFolder\abc\MyXSL.xsl)。</span><span class="sxs-lookup"><span data-stu-id="47173-167">The path that is specified can be relative (xyz/abc/MyXSL.xsl) or absolute (C:\MyFolder\abc\MyXSL.xsl).</span></span><br /><br /> <span data-ttu-id="47173-168">如果指定相對路徑，則會使用 [基底路徑] 屬性所指定的基底路徑來解析相對路徑。</span><span class="sxs-lookup"><span data-stu-id="47173-168">If a relative path is specified, the base path that is specified by the Base Path property is used to resolve the relative path.</span></span> <span data-ttu-id="47173-169">如果未在 [基底路徑] 屬性中指定路徑，相對路徑會相對於目前的目錄。</span><span class="sxs-lookup"><span data-stu-id="47173-169">If no path has been specified in the Base Path property, the relative path is relative to the current directory.</span></span><br /><br /> <span data-ttu-id="47173-170">如需使用此屬性的範例，請參閱 (SQLXMLOLEDB 提供者) 套用 XSL 轉換。</span><span class="sxs-lookup"><span data-stu-id="47173-170">For an example in which this property is used, see Applying an XSL Transformation (SQLXMLOLEDB Provider).</span></span>|  
  
 <span data-ttu-id="47173-171">下表包含 ss 資料流程旗標屬性值的描述。</span><span class="sxs-lookup"><span data-stu-id="47173-171">The following table contains descriptions of the ss Stream Flags property values.</span></span>  
  
|<span data-ttu-id="47173-172">屬性值</span><span class="sxs-lookup"><span data-stu-id="47173-172">Property value</span></span>|<span data-ttu-id="47173-173">Description</span><span class="sxs-lookup"><span data-stu-id="47173-173">Description</span></span>|  
|--------------------|-----------------|  
|<span data-ttu-id="47173-174">STREAM_FLAGS_DISALLOW_URL</span><span class="sxs-lookup"><span data-stu-id="47173-174">STREAM_FLAGS_DISALLOW_URL</span></span>|<span data-ttu-id="47173-175">對應結構描述或 XSL 不接受 URL。</span><span class="sxs-lookup"><span data-stu-id="47173-175">URLs are not accepted for mapping schemas or XSL.</span></span>|  
|<span data-ttu-id="47173-176">STREAM_FLAGS_DISALLOW_ABSOLTE_PATH</span><span class="sxs-lookup"><span data-stu-id="47173-176">STREAM_FLAGS_DISALLOW_ABSOLTE_PATH</span></span>|<span data-ttu-id="47173-177">針對對應結構描述或 XSL 指定的路徑必須相對於範本本身的基底路徑。</span><span class="sxs-lookup"><span data-stu-id="47173-177">A path that is specified for a mapping schema or for XSL must be relative to the base path of the template itself.</span></span>|  
|<span data-ttu-id="47173-178">STREAM_FLAGS_DISALLOW_QUERY</span><span class="sxs-lookup"><span data-stu-id="47173-178">STREAM_FLAGS_DISALLOW_QUERY</span></span>|<span data-ttu-id="47173-179">範本中不允許查詢。</span><span class="sxs-lookup"><span data-stu-id="47173-179">Queries are not allowed in a template.</span></span>|  
|<span data-ttu-id="47173-180">STREAM_FLAGS_DONTCACHEMAPPINGSCHEMA</span><span class="sxs-lookup"><span data-stu-id="47173-180">STREAM_FLAGS_DONTCACHEMAPPINGSCHEMA</span></span>|<span data-ttu-id="47173-181">不會快取對應結構描述。</span><span class="sxs-lookup"><span data-stu-id="47173-181">The mapping schema is not cached.</span></span> <span data-ttu-id="47173-182">這個屬性值在資料庫開發階段很實用，此時可更改資料庫結構描述。</span><span class="sxs-lookup"><span data-stu-id="47173-182">This property value is useful during the database development phase, when database schemas are subject to alteration.</span></span>|  
|<span data-ttu-id="47173-183">STREAM_FLAGS_DONTCACHETEMPLATE</span><span class="sxs-lookup"><span data-stu-id="47173-183">STREAM_FLAGS_DONTCACHETEMPLATE</span></span>|<span data-ttu-id="47173-184">不會快取範本。</span><span class="sxs-lookup"><span data-stu-id="47173-184">Templates are not cached.</span></span>|  
|<span data-ttu-id="47173-185">STREAM_FLAGS_DONTCACHEXSL</span><span class="sxs-lookup"><span data-stu-id="47173-185">STREAM_FLAGS_DONTCACHEXSL</span></span>|<span data-ttu-id="47173-186">不會快取 XSL。</span><span class="sxs-lookup"><span data-stu-id="47173-186">XSL is not cached.</span></span>|  
  
  
