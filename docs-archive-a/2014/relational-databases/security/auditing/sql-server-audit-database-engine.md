---
title: SQL Server Audit (Database Engine) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: security
ms.topic: conceptual
f1_keywords:
- audit
helpviewer_keywords:
- SQL Server Audit
- audits [SQL Server], SQL Server Audit
ms.assetid: 0c1fca2e-f22b-4fe8-806f-c87806664f00
author: VanMSFT
ms.author: vanto
ms.openlocfilehash: 2f4f291e5dc4aaa8a240757713cc65bd2a6a8230
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87592574"
---
# <a name="sql-server-audit-database-engine"></a><span data-ttu-id="398cb-102">SQL Server Audit (Database Engine)</span><span class="sxs-lookup"><span data-stu-id="398cb-102">SQL Server Audit (Database Engine)</span></span>
  <span data-ttu-id="398cb-103">「稽核」[!INCLUDE[ssDEnoversion](../../../includes/ssdenoversion-md.md)] 執行個體或個別資料庫會在 [!INCLUDE[ssDE](../../../includes/ssde-md.md)] 上發生追蹤及記錄事件。</span><span class="sxs-lookup"><span data-stu-id="398cb-103">*Auditing* an instance of the [!INCLUDE[ssDEnoversion](../../../includes/ssdenoversion-md.md)] or an individual database involves tracking and logging events that occur on the [!INCLUDE[ssDE](../../../includes/ssde-md.md)].</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="398cb-104">稽核可讓您建立伺服器稽核，其中可包含伺服器層級事件的伺服器稽核規格，以及資料庫層級事件的資料庫稽核規格。</span><span class="sxs-lookup"><span data-stu-id="398cb-104">audit lets you create server audits, which can contain server audit specifications for server level events, and database audit specifications for database level events.</span></span> <span data-ttu-id="398cb-105">稽核的事件可以寫入事件記錄或稽核檔案。</span><span class="sxs-lookup"><span data-stu-id="398cb-105">Audited events can be written to the event logs or to audit files.</span></span>  
  
 <span data-ttu-id="398cb-106">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]的稽核有幾個層級，需視安裝的管制或標準需求而定。</span><span class="sxs-lookup"><span data-stu-id="398cb-106">There are several levels of auditing for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], depending on government or standards requirements for your installation.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="398cb-107">Audit 提供了一些工具和程序，您必須擁有這些工具和程序，才能啟用、儲存及檢視各種伺服器和資料庫物件的稽核。</span><span class="sxs-lookup"><span data-stu-id="398cb-107">Audit provides the tools and processes you must have to enable, store, and view audits on various server and database objects.</span></span>  
  
 <span data-ttu-id="398cb-108">您可以依各個執行個體記錄伺服器稽核動作群組，然後依各個資料庫記錄資料庫稽核動作群組或資料庫稽核動作。</span><span class="sxs-lookup"><span data-stu-id="398cb-108">You can record server audit action groups per-instance, and either database audit action groups or database audit actions per database.</span></span> <span data-ttu-id="398cb-109">每次遇到可稽核的動作時，就會發生稽核事件。</span><span class="sxs-lookup"><span data-stu-id="398cb-109">The audit event will occur every time that the auditable action is encountered.</span></span>  
  
 <span data-ttu-id="398cb-110">所有 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 版本都支援伺服器層級稽核。</span><span class="sxs-lookup"><span data-stu-id="398cb-110">All editions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] support server level audits.</span></span> <span data-ttu-id="398cb-111">資料庫層級稽核則限於 Enterprise、Developer 和 Evaluation Edition。</span><span class="sxs-lookup"><span data-stu-id="398cb-111">Database level auditing is limited to Enterprise, Developer, and Evaluation editions.</span></span> <span data-ttu-id="398cb-112">如需詳細資訊，請參閱＜ [Features Supported by the Editions of SQL Server 2014](../../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md)＞。</span><span class="sxs-lookup"><span data-stu-id="398cb-112">For more information, see [Features Supported by the Editions of SQL Server 2014](../../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>  
  
## <a name="sql-server-audit-components"></a><span data-ttu-id="398cb-113">SQL Server Audit 元件</span><span class="sxs-lookup"><span data-stu-id="398cb-113">SQL Server Audit Components</span></span>  
 <span data-ttu-id="398cb-114">「稽核」  是針對特定伺服器動作或資料庫動作群組將幾個元素組合成單一封裝的動作。</span><span class="sxs-lookup"><span data-stu-id="398cb-114">An *audit* is the combination of several elements into a single package for a specific group of server actions or database actions.</span></span> <span data-ttu-id="398cb-115">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit 的元件結合起來可產生稱為稽核的輸出，就像是與圖形和資料元素結合的報表定義會產生報表一樣。</span><span class="sxs-lookup"><span data-stu-id="398cb-115">The components of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit combine to produce an output that is called an audit, just as a report definition combined with graphics and data elements produces a report.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="398cb-116">Audit 會使用「擴充事件」  來協助建立稽核。</span><span class="sxs-lookup"><span data-stu-id="398cb-116">audit uses *Extended Events* to help create an audit.</span></span> <span data-ttu-id="398cb-117">如需擴充事件的詳細資訊，請參閱 [擴充事件](../../extended-events/extended-events.md)。</span><span class="sxs-lookup"><span data-stu-id="398cb-117">For more information about Extended Events, see [Extended Events](../../extended-events/extended-events.md).</span></span>  
  
### <a name="sql-server-audit"></a><span data-ttu-id="398cb-118">SQL Server Audit</span><span class="sxs-lookup"><span data-stu-id="398cb-118">SQL Server Audit</span></span>  
 <span data-ttu-id="398cb-119">*SQL Server Audit* 物件會收集要監視之伺服器或資料庫層級動作和動作群組的單一執行個體。</span><span class="sxs-lookup"><span data-stu-id="398cb-119">The *SQL Server Audit* object collects a single instance of server or database-level actions and groups of actions to monitor.</span></span> <span data-ttu-id="398cb-120">此稽核位於 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 執行個體層級。</span><span class="sxs-lookup"><span data-stu-id="398cb-120">The audit is at the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance level.</span></span> <span data-ttu-id="398cb-121">您可以針對每個 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 執行個體設有多個稽核。</span><span class="sxs-lookup"><span data-stu-id="398cb-121">You can have multiple audits per [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance.</span></span>  
  
 <span data-ttu-id="398cb-122">當您定義稽核時，會針對結果的輸出指定位置，</span><span class="sxs-lookup"><span data-stu-id="398cb-122">When you define an audit, you specify the location for the output of the results.</span></span> <span data-ttu-id="398cb-123">這就是稽核目的地。</span><span class="sxs-lookup"><span data-stu-id="398cb-123">This is the audit destination.</span></span> <span data-ttu-id="398cb-124">此稽核會在「停用」  狀態下建立，而且不會自動稽核任何動作。</span><span class="sxs-lookup"><span data-stu-id="398cb-124">The audit is created in a *disabled* state, and does not automatically audit any actions.</span></span> <span data-ttu-id="398cb-125">在啟用稽核之後，稽核目的地會從此稽核接收資料。</span><span class="sxs-lookup"><span data-stu-id="398cb-125">After the audit is enabled, the audit destination receives data from the audit.</span></span>  
  
### <a name="server-audit-specification"></a><span data-ttu-id="398cb-126">伺服器稽核規格</span><span class="sxs-lookup"><span data-stu-id="398cb-126">Server Audit Specification</span></span>  
 <span data-ttu-id="398cb-127">*「伺服器稽核規格」* (Server Audit Specification) 物件屬於稽核。</span><span class="sxs-lookup"><span data-stu-id="398cb-127">The *Server Audit Specification* object belongs to an audit.</span></span> <span data-ttu-id="398cb-128">您可以針對每個稽核建立一個伺服器稽核規格，因為這兩者都是在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 執行個體範圍所建立。</span><span class="sxs-lookup"><span data-stu-id="398cb-128">You can create one server audit specification per audit, because both are created at the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance scope.</span></span>  
  
 <span data-ttu-id="398cb-129">伺服器稽核規格會收集由擴充的事件功能所引發的許多伺服器層級動作群組。</span><span class="sxs-lookup"><span data-stu-id="398cb-129">The server audit specification collects many server-level action groups raised by the Extended Events feature.</span></span> <span data-ttu-id="398cb-130">您可以將「稽核動作群組」  併入伺服器稽核規格中。</span><span class="sxs-lookup"><span data-stu-id="398cb-130">You can include *audit action groups* in a server audit specification.</span></span> <span data-ttu-id="398cb-131">稽核動作群組是預先定義的動作群組，這些動作是 [!INCLUDE[ssDE](../../../includes/ssde-md.md)]中發生之不可部分完成的事件。</span><span class="sxs-lookup"><span data-stu-id="398cb-131">Audit action groups are predefined groups of actions, which are atomic events occurring in the [!INCLUDE[ssDE](../../../includes/ssde-md.md)].</span></span> <span data-ttu-id="398cb-132">這些動作會傳送給稽核，然後它會在目標中記錄這些動作。</span><span class="sxs-lookup"><span data-stu-id="398cb-132">These actions are sent to the audit, which records them in the target.</span></span>  
  
 <span data-ttu-id="398cb-133">伺服器層級的稽核動作群組在 [SQL Server Audit 動作群組和動作](sql-server-audit-action-groups-and-actions.md)主題中有描述。</span><span class="sxs-lookup"><span data-stu-id="398cb-133">Server-level audit action groups are described in the topic [SQL Server Audit Action Groups and Actions](sql-server-audit-action-groups-and-actions.md).</span></span>  
  
### <a name="database-audit-specification"></a><span data-ttu-id="398cb-134">資料庫稽核規格</span><span class="sxs-lookup"><span data-stu-id="398cb-134">Database Audit Specification</span></span>  
 <span data-ttu-id="398cb-135">「資料庫稽核規格」  物件屬於 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit。</span><span class="sxs-lookup"><span data-stu-id="398cb-135">The *Database Audit Specification* object also belongs to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit.</span></span> <span data-ttu-id="398cb-136">您可以針對每個稽核的每個 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 資料庫建立一個資料庫稽核規格。</span><span class="sxs-lookup"><span data-stu-id="398cb-136">You can create one database audit specification per [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database per audit.</span></span>  
  
 <span data-ttu-id="398cb-137">資料庫稽核規格會收集由擴充的事件功能所引發的資料庫層級稽核動作。</span><span class="sxs-lookup"><span data-stu-id="398cb-137">The database audit specification collects database-level audit actions raised by the Extended Events feature.</span></span> <span data-ttu-id="398cb-138">您可以將稽核動作群組或稽核事件加入資料庫稽核規格。</span><span class="sxs-lookup"><span data-stu-id="398cb-138">You can add either audit action groups or audit events to a database audit specification.</span></span> <span data-ttu-id="398cb-139">「稽核事件」 是可由 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 引擎稽核之不可部分完成的動作。</span><span class="sxs-lookup"><span data-stu-id="398cb-139">*Audit events* are the atomic actions that can be audited by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] engine.</span></span> <span data-ttu-id="398cb-140">「稽核動作群組」 是預先定義的動作群組。</span><span class="sxs-lookup"><span data-stu-id="398cb-140">*Audit action groups* are predefined groups of actions.</span></span> <span data-ttu-id="398cb-141">這兩者都在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 資料庫範圍內。</span><span class="sxs-lookup"><span data-stu-id="398cb-141">Both are at the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database scope.</span></span> <span data-ttu-id="398cb-142">這些動作會傳送給稽核，然後它會在目標中記錄這些動作。</span><span class="sxs-lookup"><span data-stu-id="398cb-142">These actions are sent to the audit, which records them in the target.</span></span> <span data-ttu-id="398cb-143">請勿在使用者資料庫稽核規格中包含伺服器範圍的物件，例如系統檢視表。</span><span class="sxs-lookup"><span data-stu-id="398cb-143">Do not include server-scoped objects, such as the system views, in a user database audit specification.</span></span>  
  
 <span data-ttu-id="398cb-144">資料庫層級的稽核動作群組和稽核動作在 [SQL Server Audit 動作群組和動作](sql-server-audit-action-groups-and-actions.md)主題中有描述。</span><span class="sxs-lookup"><span data-stu-id="398cb-144">Database-level audit action groups and audit actions are described in the topic [SQL Server Audit Action Groups and Actions](sql-server-audit-action-groups-and-actions.md).</span></span>  
  
### <a name="target"></a><span data-ttu-id="398cb-145">目標</span><span class="sxs-lookup"><span data-stu-id="398cb-145">Target</span></span>  
 <span data-ttu-id="398cb-146">稽核的結果會傳送到目標，這可以是檔案、Windows 安全性事件記錄檔或 Windows 應用程式事件記錄檔</span><span class="sxs-lookup"><span data-stu-id="398cb-146">The results of an audit are sent to a target, which can be a file, the Windows Security event log, or the Windows Application event log.</span></span> <span data-ttu-id="398cb-147">記錄檔必須定期檢閱及封存，以確保目標有足夠的空間來寫入其他的記錄。</span><span class="sxs-lookup"><span data-stu-id="398cb-147">Logs must be reviewed and archived periodically to make sure that the target has sufficient space to write additional records.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="398cb-148">任何經過驗證的使用者都可以讀寫 Windows 應用程式事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="398cb-148">Any authenticated user can read and write to the Windows Application event log.</span></span> <span data-ttu-id="398cb-149">應用程式事件記錄檔所需的權限低於 Windows 安全性事件記錄檔，所以比起 Windows 安全性事件記錄檔是較不安全的。</span><span class="sxs-lookup"><span data-stu-id="398cb-149">The Application event log requires lower permissions than the Windows Security event log and is less secure than the Windows Security event log.</span></span>  
  
 <span data-ttu-id="398cb-150">寫入到 Windows 安全性記錄檔需要將 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 服務帳戶加入 [產生安全性稽核]  原則。</span><span class="sxs-lookup"><span data-stu-id="398cb-150">Writing to the Windows Security log requires the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service account to be added to the **Generate security audits** policy.</span></span> <span data-ttu-id="398cb-151">根據預設，本機系統、本機服務和網路服務都是此原則的一部分。</span><span class="sxs-lookup"><span data-stu-id="398cb-151">By default, the Local System, Local Service, and Network Service are part of this policy.</span></span> <span data-ttu-id="398cb-152">您可以使用安全性原則嵌入式管理單元 (secpol.msc) 來設定這項設定。</span><span class="sxs-lookup"><span data-stu-id="398cb-152">This setting can be configured by using the security policy snap-in (secpol.msc).</span></span> <span data-ttu-id="398cb-153">此外，[稽核物件存取]  安全性原則必須已啟用 [成功]  和 [失敗] 。</span><span class="sxs-lookup"><span data-stu-id="398cb-153">Additionally, the **Audit object access** security policy must be enabled for both **Success** and **Failure**.</span></span> <span data-ttu-id="398cb-154">您可以使用安全性原則嵌入式管理單元 (secpol.msc) 來設定這項設定。</span><span class="sxs-lookup"><span data-stu-id="398cb-154">This setting can be configured by using the security policy snap-in (secpol.msc).</span></span> <span data-ttu-id="398cb-155">在 [!INCLUDE[wiprlhext](../../../includes/wiprlhext-md.md)] 或 Windows Server 2008 中，您可以使用稽核原則程式 (，從命令列設定更細微的**應用程式產生**原則 `AuditPol.exe)` 。</span><span class="sxs-lookup"><span data-stu-id="398cb-155">In [!INCLUDE[wiprlhext](../../../includes/wiprlhext-md.md)] or Windows Server 2008, you can set the more granular **application generated** policy from the command line by using the audit policy program (`AuditPol.exe)`.</span></span> <span data-ttu-id="398cb-156">如需啟用寫入 Windows 安全性記錄檔之步驟的詳細資訊，請參閱 [將 SQL Server Audit 事件寫入安全性記錄檔](write-sql-server-audit-events-to-the-security-log.md)。</span><span class="sxs-lookup"><span data-stu-id="398cb-156">For more information about the steps to enable writing to the Windows Security log, see [Write SQL Server Audit Events to the Security Log](write-sql-server-audit-events-to-the-security-log.md).</span></span> <span data-ttu-id="398cb-157">如需 Auditpol.exe 程式的詳細資訊，請參閱知識庫文章 921469： [如何使用「群組原則」進行詳細的安全性稽核設定](https://support.microsoft.com/kb/921469/)。</span><span class="sxs-lookup"><span data-stu-id="398cb-157">For more information about the Auditpol.exe program, see Knowledge Base article 921469, [How to use Group Policy to configure detailed security auditing](https://support.microsoft.com/kb/921469/).</span></span> <span data-ttu-id="398cb-158">Windows 事件記錄檔在 Windows 作業系統中為全域的範圍。</span><span class="sxs-lookup"><span data-stu-id="398cb-158">The Windows event logs are global to the Windows operating system.</span></span> <span data-ttu-id="398cb-159">如需 Windows 事件記錄檔的詳細資訊，請參閱 [事件檢視器概觀](https://go.microsoft.com/fwlink/?LinkId=101455)。</span><span class="sxs-lookup"><span data-stu-id="398cb-159">For more information about the Windows event logs, see [Event Viewer Overview](https://go.microsoft.com/fwlink/?LinkId=101455).</span></span> <span data-ttu-id="398cb-160">如果您需要更精確的稽核權限，請使用二進位檔案目標。</span><span class="sxs-lookup"><span data-stu-id="398cb-160">If you need more precise permissions on the audit, use the binary file target.</span></span>  
  
 <span data-ttu-id="398cb-161">當您將稽核資訊儲存到檔案時，為了避免遭到篡改，您可以使用以下方式來限制對檔案位置的存取：</span><span class="sxs-lookup"><span data-stu-id="398cb-161">When you are saving audit information to a file, to help prevent tampering, you can restrict access to the file location in the following ways:</span></span>  
  
-   <span data-ttu-id="398cb-162">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 服務帳戶必須具有讀取和寫入權限。</span><span class="sxs-lookup"><span data-stu-id="398cb-162">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Service Account must have both Read and Write permission.</span></span>  
  
-   <span data-ttu-id="398cb-163">稽核管理員通常需要讀取和寫入權限。</span><span class="sxs-lookup"><span data-stu-id="398cb-163">Audit Administrators typically require Read and Write permission.</span></span> <span data-ttu-id="398cb-164">這會假設稽核管理員為管理稽核檔案的 Windows 帳戶，例如將稽核檔案複製到不同的共用位置、備份稽核檔案等等。</span><span class="sxs-lookup"><span data-stu-id="398cb-164">This assumes that the Audit Administrators are Windows accounts for administration of audit files, such as: copying them to different shares, backing them up, and so on.</span></span>  
  
-   <span data-ttu-id="398cb-165">被授權可讀取稽核檔案的稽核讀取者必須擁有讀取權限。</span><span class="sxs-lookup"><span data-stu-id="398cb-165">Audit Readers that are authorized to read audit files must have Read permission.</span></span>  
  
 <span data-ttu-id="398cb-166">即使當 [!INCLUDE[ssDE](../../../includes/ssde-md.md)] 寫入檔案時，其他擁有權限的 Windows 使用者還是可以讀取稽核檔案。</span><span class="sxs-lookup"><span data-stu-id="398cb-166">Even when the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] is writing to a file, other Windows users can read the audit file if they have permission.</span></span> <span data-ttu-id="398cb-167">[!INCLUDE[ssDE](../../../includes/ssde-md.md)] 不會進行獨佔鎖定來防止讀取作業。</span><span class="sxs-lookup"><span data-stu-id="398cb-167">The [!INCLUDE[ssDE](../../../includes/ssde-md.md)] does not take an exclusive lock that prevents read operations.</span></span>  
  
 <span data-ttu-id="398cb-168">因為 [!INCLUDE[ssDE](../../../includes/ssde-md.md)] 可以存取檔案，所以具有 CONTROL SERVER 權限的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 登入可以使用 [!INCLUDE[ssDE](../../../includes/ssde-md.md)] 來存取稽核檔案。</span><span class="sxs-lookup"><span data-stu-id="398cb-168">Because the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] can access the file, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] logins that have CONTROL SERVER permission can use the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] to access the audit files.</span></span> <span data-ttu-id="398cb-169">若要記錄正在讀取稽核檔案的任何使用者，請在 master.sys.fn_get_audit_file 上定義稽核。</span><span class="sxs-lookup"><span data-stu-id="398cb-169">To record any user that is reading the audit file, define an audit on master.sys.fn_get_audit_file.</span></span> <span data-ttu-id="398cb-170">這樣會記錄具有 CONTROL SERVER 權限的登入，該登入已經透過 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]來存取稽核檔案。</span><span class="sxs-lookup"><span data-stu-id="398cb-170">This records the logins with CONTROL SERVER permission that have accessed the audit file through [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="398cb-171">如果稽核管理員將檔案複製到不同的位置 (基於類似封存的理由)，新位置的 ACL 應該降低為以下權限：</span><span class="sxs-lookup"><span data-stu-id="398cb-171">If an Audit Administrator copies the file to a different location (for archive purposes, and so on), the ACLs on the new location should be reduced to the following permissions:</span></span>  
  
-   <span data-ttu-id="398cb-172">稽核管理員 - 讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="398cb-172">Audit Administrator - Read / Write</span></span>  
  
-   <span data-ttu-id="398cb-173">稽核讀取者 - 讀取</span><span class="sxs-lookup"><span data-stu-id="398cb-173">Audit Reader - Read</span></span>  
  
 <span data-ttu-id="398cb-174">建議您從只有稽核管理員或稽核讀取者可存取的不同 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]執行個體 (例如 [!INCLUDE[ssExpress](../../../includes/ssexpress-md.md)]執行個體) 產生稽核報表。</span><span class="sxs-lookup"><span data-stu-id="398cb-174">We recommend that you generate audit reports from a separate instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], such as an instance of [!INCLUDE[ssExpress](../../../includes/ssexpress-md.md)], to which only Audit Administrators or Audit Readers have access.</span></span> <span data-ttu-id="398cb-175">您可以藉由使用不同的 [!INCLUDE[ssDE](../../../includes/ssde-md.md)] 執行個體進行報告，以防止未經授權的使用者取得稽核記錄的存取權。</span><span class="sxs-lookup"><span data-stu-id="398cb-175">By using a separate instance of the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] for reporting, you can help prevent unauthorized users from obtaining access to the audit record.</span></span>  
  
 <span data-ttu-id="398cb-176">您可以提供額外的防護措施來避免未經授權的人存取，其方式是使用 Windows BitLocker 磁碟機加密或 Windows 加密檔案系統，將用來存放稽核檔案的資料夾加密。</span><span class="sxs-lookup"><span data-stu-id="398cb-176">You can offer additional protection against unauthorized access by encrypting the folder in which the audit file is stored by using Windows BitLocker Drive Encryption or Windows Encrypting File System.</span></span>  
  
 <span data-ttu-id="398cb-177">如需寫入目標之稽核記錄的詳細資訊，請參閱 [SQL Server Audit 記錄](sql-server-audit-records.md)。</span><span class="sxs-lookup"><span data-stu-id="398cb-177">For more information about the audit records that are written to the target, see [SQL Server Audit Records](sql-server-audit-records.md).</span></span>  
  
## <a name="overview-of-using-sql-server-audit"></a><span data-ttu-id="398cb-178">使用 SQL Server Audit 的概觀</span><span class="sxs-lookup"><span data-stu-id="398cb-178">Overview of Using SQL Server Audit</span></span>  
 <span data-ttu-id="398cb-179">您可以使用 [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] 或 [!INCLUDE[tsql](../../../includes/tsql-md.md)] 來定義稽核。</span><span class="sxs-lookup"><span data-stu-id="398cb-179">You can use [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../../includes/tsql-md.md)] to define an audit.</span></span> <span data-ttu-id="398cb-180">在建立及啟用稽核之後，目標將會收到項目。</span><span class="sxs-lookup"><span data-stu-id="398cb-180">After the audit is created and enabled, the target will receive entries.</span></span>  
  
 <span data-ttu-id="398cb-181">您可以使用 Windows 中的 [事件檢視器]  公用程式來閱讀 Windows 事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="398cb-181">You can read the Windows event logs by using the **Event Viewer** utility in Windows.</span></span> <span data-ttu-id="398cb-182">如果是檔案目標，您可以使用 **中的 [記錄檔檢視器]** [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] 或是 [fn_get_audit_file](/sql/relational-databases/system-functions/sys-fn-get-audit-file-transact-sql) 函數來閱讀目標檔案。</span><span class="sxs-lookup"><span data-stu-id="398cb-182">For file targets, you can use either the **Log File Viewer** in [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or the [fn_get_audit_file](/sql/relational-databases/system-functions/sys-fn-get-audit-file-transact-sql) function to read the target file.</span></span>  
  
 <span data-ttu-id="398cb-183">建立及使用稽核的一般程序如下所示。</span><span class="sxs-lookup"><span data-stu-id="398cb-183">The general process for creating and using an audit is as follows.</span></span>  
  
1.  <span data-ttu-id="398cb-184">建立稽核，並定義目標。</span><span class="sxs-lookup"><span data-stu-id="398cb-184">Create an audit and define the target.</span></span>  
  
2.  <span data-ttu-id="398cb-185">建立對應至稽核的伺服器稽核規格或資料庫稽核規格。</span><span class="sxs-lookup"><span data-stu-id="398cb-185">Create either a server audit specification or database audit specification that maps to the audit.</span></span> <span data-ttu-id="398cb-186">啟用該稽核規格。</span><span class="sxs-lookup"><span data-stu-id="398cb-186">Enable the audit specification.</span></span>  
  
3.  <span data-ttu-id="398cb-187">啟用稽核。</span><span class="sxs-lookup"><span data-stu-id="398cb-187">Enable the audit.</span></span>  
  
4.  <span data-ttu-id="398cb-188">使用 Windows [事件檢視器] 、[記錄檔檢視器] 或是 fn_get_audit_file 函數來閱讀稽核事件。</span><span class="sxs-lookup"><span data-stu-id="398cb-188">Read the audit events by using the Windows **Event Viewer**, **Log File Viewe**r, or the fn_get_audit_file function.</span></span>  
  
 <span data-ttu-id="398cb-189">如需詳細資訊，請參閱 [建立伺服器稽核與伺服器稽核規格](create-a-server-audit-and-server-audit-specification.md) 和 [建立伺服器稽核和資料庫稽核規格](create-a-server-audit-and-database-audit-specification.md)。</span><span class="sxs-lookup"><span data-stu-id="398cb-189">For more information, see [Create a Server Audit and Server Audit Specification](create-a-server-audit-and-server-audit-specification.md) and [Create a Server Audit and Database Audit Specification](create-a-server-audit-and-database-audit-specification.md).</span></span>  
  
## <a name="considerations"></a><span data-ttu-id="398cb-190">考量</span><span class="sxs-lookup"><span data-stu-id="398cb-190">Considerations</span></span>  
 <span data-ttu-id="398cb-191">如果在稽核起始期間發生失敗，伺服器將不會啟動。</span><span class="sxs-lookup"><span data-stu-id="398cb-191">In the case of a failure during audit initiation, the server will not start.</span></span> <span data-ttu-id="398cb-192">在此情況下，可以在命令列上使用 **-f** 選項來啟動伺服器。</span><span class="sxs-lookup"><span data-stu-id="398cb-192">In this case, the server can be started by using the **-f** option at the command line.</span></span>  
  
 <span data-ttu-id="398cb-193">當稽核失敗造成伺服器關閉，或是因為已針對稽核指定 ON_FAILURE=SHUTDOWN 而造成伺服器無法啟動時，MSG_AUDIT_FORCED_SHUTDOWN 事件將會寫入記錄檔中。</span><span class="sxs-lookup"><span data-stu-id="398cb-193">When an audit failure causes the server to shut down or not to start because ON_FAILURE=SHUTDOWN is specified for the audit, the MSG_AUDIT_FORCED_SHUTDOWN event will be written to the log.</span></span> <span data-ttu-id="398cb-194">由於關閉將發生在初次遇到此設定時，所以此事件將會寫入一次。</span><span class="sxs-lookup"><span data-stu-id="398cb-194">Because the shutdown will occur on the first encounter of this setting, the event will be written one time.</span></span> <span data-ttu-id="398cb-195">當稽核的失敗訊息造成伺服器關閉之後，將會寫入此事件。</span><span class="sxs-lookup"><span data-stu-id="398cb-195">This event is written after the failure message for the audit causing the shutdown.</span></span> <span data-ttu-id="398cb-196">管理員可藉由使用 **-m** 旗標在單一使用者模式下啟動[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]，以略過稽核所導致的關閉。</span><span class="sxs-lookup"><span data-stu-id="398cb-196">An administrator can bypass audit-induced shutdowns by starting [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] in Single User mode using the **-m** flag.</span></span> <span data-ttu-id="398cb-197">如果您在單一使用者模式下啟動，您會將指定 ON_FAILURE=SHUTDOWN 於該工作階段執行的任何稽核降級為 ON_FAILURE=CONTINUE。</span><span class="sxs-lookup"><span data-stu-id="398cb-197">If you start in Single User mode, you will downgrade any audit where ON_FAILURE=SHUTDOWN is specified to run in that session as ON_FAILURE=CONTINUE.</span></span> <span data-ttu-id="398cb-198">當使用 **-m** 旗標啟動 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 時，MSG_AUDIT_SHUTDOWN_BYPASSED 訊息將會寫入到錯誤記錄檔。</span><span class="sxs-lookup"><span data-stu-id="398cb-198">When [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is started by using the **-m** flag, the MSG_AUDIT_SHUTDOWN_BYPASSED message will be written to the error log.</span></span>  
  
 <span data-ttu-id="398cb-199">如需服務啟動選項的詳細資訊，請參閱 [Database Engine 服務啟動選項](../../../database-engine/configure-windows/database-engine-service-startup-options.md)。</span><span class="sxs-lookup"><span data-stu-id="398cb-199">For more information about service startup options, see [Database Engine Service Startup Options](../../../database-engine/configure-windows/database-engine-service-startup-options.md).</span></span>  
  
### <a name="attaching-a-database-with-an-audit-defined"></a><span data-ttu-id="398cb-200">附加已定義稽核的資料庫</span><span class="sxs-lookup"><span data-stu-id="398cb-200">Attaching a Database with an Audit Defined</span></span>  
 <span data-ttu-id="398cb-201">如果附加的資料庫有稽核規格，而且指定了未存在於伺服器上的 GUID 時，將會造成「孤立的」  稽核規格。</span><span class="sxs-lookup"><span data-stu-id="398cb-201">Attaching a database that has an audit specification and specifies a GUID that does not exist on the server will cause an *orphaned* audit specification.</span></span> <span data-ttu-id="398cb-202">因為具有相符 GUID 的稽核不存在於伺服器執行個體上，所以不會記錄任何稽核事件。</span><span class="sxs-lookup"><span data-stu-id="398cb-202">Because an audit with a matching GUID does not exist on the server instance, no audit events will be recorded.</span></span> <span data-ttu-id="398cb-203">若要更正這個狀況，請使用 ALTER DATABASE AUDIT SPECIFICATION 命令，將被遺棄的稽核規格連接到現有的伺服器稽核。</span><span class="sxs-lookup"><span data-stu-id="398cb-203">To correct this situation, use the ALTER DATABASE AUDIT SPECIFICATION command to connect the orphaned audit specification to an existing server audit.</span></span> <span data-ttu-id="398cb-204">或者，使用 CREATE SERVER AUDIT 命令，建立具有指定之 GUID 的新伺服器稽核。</span><span class="sxs-lookup"><span data-stu-id="398cb-204">Or, use the CREATE SERVER AUDIT command to create a new server audit with the specified GUID.</span></span>  
  
 <span data-ttu-id="398cb-205">您可以將有定義稽核規格的資料庫附加到不支援 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit 的另一個 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 版本 (例如 [!INCLUDE[ssExpress](../../../includes/ssexpress-md.md)] )，但是它不會記錄稽核事件。</span><span class="sxs-lookup"><span data-stu-id="398cb-205">You can attach a database that has an audit specification defined on it to another edition of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that does not support [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit, such as [!INCLUDE[ssExpress](../../../includes/ssexpress-md.md)] but it will not record audit events.</span></span>  
  
### <a name="database-mirroring-and-sql-server-audit"></a><span data-ttu-id="398cb-206">資料庫鏡像和 SQL Server Audit</span><span class="sxs-lookup"><span data-stu-id="398cb-206">Database Mirroring and SQL Server Audit</span></span>  
 <span data-ttu-id="398cb-207">已定義資料庫稽核規格而且使用資料庫鏡像的資料庫將會包含資料庫稽核規格。</span><span class="sxs-lookup"><span data-stu-id="398cb-207">A database that has a database audit specification defined and that uses database mirroring will include the database audit specification.</span></span> <span data-ttu-id="398cb-208">若要在鏡像的 SQL 執行個體上正確運作，必須設定下列項目：</span><span class="sxs-lookup"><span data-stu-id="398cb-208">To work correctly on the mirrored SQL instance, the following items must be configured:</span></span>  
  
-   <span data-ttu-id="398cb-209">鏡像伺服器必須具有相同 GUID 的稽核，才能讓資料庫稽核規格寫入稽核記錄。</span><span class="sxs-lookup"><span data-stu-id="398cb-209">The mirror server must have an audit with the same GUID to enable the database audit specification to write audit records.</span></span> <span data-ttu-id="398cb-210">您可以使用 CREATE AUDIT WITH GUID 命令來設定此項 `=` \* \<GUID from source Server Audit*> 。</span><span class="sxs-lookup"><span data-stu-id="398cb-210">This can be configured by using the command CREATE AUDIT WITH GUID`=`\*\<GUID from source Server Audit*>.</span></span>  
  
-   <span data-ttu-id="398cb-211">如果是二進位檔案目標，鏡像伺服器服務帳戶必須具有寫入稽核記錄之位置的適當權限。</span><span class="sxs-lookup"><span data-stu-id="398cb-211">For binary file targets, the mirror server service account must have appropriate permissions to the location where the audit trail is being written.</span></span>  
  
-   <span data-ttu-id="398cb-212">如果是 Windows 事件記錄檔目標，鏡像伺服器所在之電腦的安全性原則必須允許服務帳戶存取安全性或應用程式事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="398cb-212">For Windows event log targets, the security policy on the computer where the mirror server is located must allow for service account access to the security or application event log.</span></span>  
  
### <a name="auditing-administrators"></a><span data-ttu-id="398cb-213">稽核系統管理員</span><span class="sxs-lookup"><span data-stu-id="398cb-213">Auditing Administrators</span></span>  
 <span data-ttu-id="398cb-214">`sysadmin`系統會將固定伺服器角色的成員識別為每個資料庫中的**dbo**使用者。</span><span class="sxs-lookup"><span data-stu-id="398cb-214">Members of the `sysadmin` fixed server role are identified as the **dbo** user in each database.</span></span> <span data-ttu-id="398cb-215">若要稽核系統管理員的動作，請稽核 **dbo** 使用者的動作。</span><span class="sxs-lookup"><span data-stu-id="398cb-215">To audit actions of the administrators, audit the actions of the **dbo** user.</span></span>  
  
## <a name="creating-and-managing-audits-with-transact-sql"></a><span data-ttu-id="398cb-216">使用 Transact-SQL 建立及管理稽核</span><span class="sxs-lookup"><span data-stu-id="398cb-216">Creating and Managing Audits with Transact-SQL</span></span>  
 <span data-ttu-id="398cb-217">您可以使用 DDL 陳述式、動態管理檢視和函數及目錄檢視來實作 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit 的所有層面。</span><span class="sxs-lookup"><span data-stu-id="398cb-217">You can use DDL statements, dynamic management views and functions, and catalog views to implement all aspects of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit.</span></span>  
  
### <a name="data-definition-language-statements"></a><span data-ttu-id="398cb-218">資料定義語言陳述式</span><span class="sxs-lookup"><span data-stu-id="398cb-218">Data Definition Language Statements</span></span>  
 <span data-ttu-id="398cb-219">您可以使用下列 DDL 陳述式來建立、改變和卸除稽核規格：</span><span class="sxs-lookup"><span data-stu-id="398cb-219">You can use the following DDL statements to create, alter, and drop audit specifications:</span></span>  
  
|||  
|-|-|  
|[<span data-ttu-id="398cb-220">ALTER AUTHORIZATION</span><span class="sxs-lookup"><span data-stu-id="398cb-220">ALTER AUTHORIZATION</span></span>](/sql/t-sql/statements/alter-authorization-transact-sql)|[<span data-ttu-id="398cb-221">CREATE SERVER AUDIT</span><span class="sxs-lookup"><span data-stu-id="398cb-221">CREATE SERVER AUDIT</span></span>](/sql/t-sql/statements/create-server-audit-transact-sql)|  
|[<span data-ttu-id="398cb-222">ALTER DATABASE AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="398cb-222">ALTER DATABASE AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/alter-database-audit-specification-transact-sql)|[<span data-ttu-id="398cb-223">CREATE SERVER AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="398cb-223">CREATE SERVER AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/create-server-audit-specification-transact-sql)|  
|[<span data-ttu-id="398cb-224">ALTER SERVER AUDIT</span><span class="sxs-lookup"><span data-stu-id="398cb-224">ALTER SERVER AUDIT</span></span>](/sql/t-sql/statements/alter-server-audit-specification-transact-sql)|[<span data-ttu-id="398cb-225">DROP DATABASE AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="398cb-225">DROP DATABASE AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/drop-database-encryption-key-transact-sql)|  
|[<span data-ttu-id="398cb-226">ALTER SERVER AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="398cb-226">ALTER SERVER AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/alter-server-audit-transact-sql)|[<span data-ttu-id="398cb-227">DROP SERVER AUDIT</span><span class="sxs-lookup"><span data-stu-id="398cb-227">DROP SERVER AUDIT</span></span>](/sql/t-sql/statements/drop-server-audit-transact-sql)|  
|[<span data-ttu-id="398cb-228">CREATE DATABASE AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="398cb-228">CREATE DATABASE AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/create-database-audit-specification-transact-sql)|[<span data-ttu-id="398cb-229">DROP SERVER AUDIT SPECIFICATION</span><span class="sxs-lookup"><span data-stu-id="398cb-229">DROP SERVER AUDIT SPECIFICATION</span></span>](/sql/t-sql/statements/drop-server-audit-specification-transact-sql)|  
  
### <a name="dynamic-views-and-functions"></a><span data-ttu-id="398cb-230">動態檢視和函數</span><span class="sxs-lookup"><span data-stu-id="398cb-230">Dynamic Views and Functions</span></span>  
 <span data-ttu-id="398cb-231">下表列出可用於 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 稽核的動態檢視和函數。</span><span class="sxs-lookup"><span data-stu-id="398cb-231">The following table lists the dynamic views and function that you can use for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Auditing.</span></span>  
  
|<span data-ttu-id="398cb-232">動態檢視和函數</span><span class="sxs-lookup"><span data-stu-id="398cb-232">Dynamic views and functions</span></span>|<span data-ttu-id="398cb-233">描述</span><span class="sxs-lookup"><span data-stu-id="398cb-233">Description</span></span>|  
|---------------------------------|-----------------|  
|[<span data-ttu-id="398cb-234">sys.dm_audit_actions</span><span class="sxs-lookup"><span data-stu-id="398cb-234">sys.dm_audit_actions</span></span>](/sql/relational-databases/system-dynamic-management-views/sys-dm-audit-actions-transact-sql)|<span data-ttu-id="398cb-235">傳回稽核記錄檔中可報告的每一個稽核動作及 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit 中可設定之每一個稽核動作群組的資料列。</span><span class="sxs-lookup"><span data-stu-id="398cb-235">Returns a row for every audit action that can be reported in the audit log and every audit action group that can be configured as part of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit.</span></span>|  
|[<span data-ttu-id="398cb-236">sys.dm_server_audit_status</span><span class="sxs-lookup"><span data-stu-id="398cb-236">sys.dm_server_audit_status</span></span>](/sql/relational-databases/system-dynamic-management-views/sys-dm-server-audit-status-transact-sql)|<span data-ttu-id="398cb-237">提供有關稽核之目前狀態的資訊。</span><span class="sxs-lookup"><span data-stu-id="398cb-237">Provides information about the current state of the audit.</span></span>|  
|[<span data-ttu-id="398cb-238">sys.dm_audit_class_type_map</span><span class="sxs-lookup"><span data-stu-id="398cb-238">sys.dm_audit_class_type_map</span></span>](/sql/relational-databases/system-dynamic-management-views/sys-dm-audit-class-type-map-transact-sql)|<span data-ttu-id="398cb-239">傳回一個資料表，它會將稽核記錄檔中的 class_type 欄位對應到 sys.dm_audit_actions 中的 class_desc 欄位。</span><span class="sxs-lookup"><span data-stu-id="398cb-239">Returns a table that maps the class_type field in the audit log to the class_desc field in sys.dm_audit_actions.</span></span>|  
|[<span data-ttu-id="398cb-240">fn_get_audit_file</span><span class="sxs-lookup"><span data-stu-id="398cb-240">fn_get_audit_file</span></span>](/sql/relational-databases/system-functions/sys-fn-get-audit-file-transact-sql)|<span data-ttu-id="398cb-241">從伺服器稽核建立的稽核檔案中傳回資訊。</span><span class="sxs-lookup"><span data-stu-id="398cb-241">Returns information from an audit file created by a server audit.</span></span>|  
  
### <a name="catalog-views"></a><span data-ttu-id="398cb-242">目錄檢視</span><span class="sxs-lookup"><span data-stu-id="398cb-242">Catalog Views</span></span>  
 <span data-ttu-id="398cb-243">下表列出可用於 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 稽核的目錄檢視。</span><span class="sxs-lookup"><span data-stu-id="398cb-243">The following table lists the catalog views that you can use for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] auditing.</span></span>  
  
|<span data-ttu-id="398cb-244">目錄檢視</span><span class="sxs-lookup"><span data-stu-id="398cb-244">Catalog views</span></span>|<span data-ttu-id="398cb-245">描述</span><span class="sxs-lookup"><span data-stu-id="398cb-245">Description</span></span>|  
|-------------------|-----------------|  
|[<span data-ttu-id="398cb-246">sys.database_ audit_specifications</span><span class="sxs-lookup"><span data-stu-id="398cb-246">sys.database_ audit_specifications</span></span>](/sql/relational-databases/system-catalog-views/sys-database-audit-specifications-transact-sql)|<span data-ttu-id="398cb-247">包含有關伺服器執行個體上 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 稽核內之資料庫稽核規格的資訊。</span><span class="sxs-lookup"><span data-stu-id="398cb-247">Contains information about the database audit specifications in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance.</span></span>|  
|[<span data-ttu-id="398cb-248">sys.database_audit_specification_details</span><span class="sxs-lookup"><span data-stu-id="398cb-248">sys.database_audit_specification_details</span></span>](/sql/relational-databases/system-catalog-views/sys-database-audit-specification-details-transact-sql)|<span data-ttu-id="398cb-249">包含所有資料庫伺服器執行個體上 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 稽核內之資料庫稽核規格的資訊。</span><span class="sxs-lookup"><span data-stu-id="398cb-249">Contains information about the database audit specifications in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance for all databases.</span></span>|  
|[<span data-ttu-id="398cb-250">sys.server_audits</span><span class="sxs-lookup"><span data-stu-id="398cb-250">sys.server_audits</span></span>](/sql/relational-databases/system-catalog-views/sys-server-audits-transact-sql)|<span data-ttu-id="398cb-251">針對伺服器執行個體中的每一個 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 稽核各包含一個資料列。</span><span class="sxs-lookup"><span data-stu-id="398cb-251">Contains one row for each [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit in a server instance.</span></span>|  
|[<span data-ttu-id="398cb-252">sys.server_audit_specifications</span><span class="sxs-lookup"><span data-stu-id="398cb-252">sys.server_audit_specifications</span></span>](/sql/relational-databases/system-catalog-views/sys-server-audit-specifications-transact-sql)|<span data-ttu-id="398cb-253">包含有關伺服器執行個體上 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 稽核內之伺服器稽核規格的資訊。</span><span class="sxs-lookup"><span data-stu-id="398cb-253">Contains information about the server audit specifications in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance.</span></span>|  
|[<span data-ttu-id="398cb-254">sys.server_audit_specifications_details</span><span class="sxs-lookup"><span data-stu-id="398cb-254">sys.server_audit_specifications_details</span></span>](/sql/relational-databases/system-catalog-views/sys-server-audit-specification-details-transact-sql)|<span data-ttu-id="398cb-255">包含伺服器執行個體上 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 稽核內之伺服器稽核規格詳細資料 (動作) 的資訊。</span><span class="sxs-lookup"><span data-stu-id="398cb-255">Contains information about the server audit specification details (actions) in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance.</span></span>|  
|[<span data-ttu-id="398cb-256">sys.server_file_audits</span><span class="sxs-lookup"><span data-stu-id="398cb-256">sys.server_file_audits</span></span>](/sql/relational-databases/system-catalog-views/sys-server-file-audits-transact-sql)|<span data-ttu-id="398cb-257">包含有關伺服器執行個體上 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 稽核內之檔案稽核類型的存放區擴充資訊。</span><span class="sxs-lookup"><span data-stu-id="398cb-257">Contains stores extended information about the file audit type in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] audit on a server instance.</span></span>|  
  
## <a name="permissions"></a><span data-ttu-id="398cb-258">權限</span><span class="sxs-lookup"><span data-stu-id="398cb-258">Permissions</span></span>  
 <span data-ttu-id="398cb-259">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit 的每一個功能和命令都有個別的權限需求。</span><span class="sxs-lookup"><span data-stu-id="398cb-259">Each feature and command for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Audit has individual permission requirements.</span></span>  
  
 <span data-ttu-id="398cb-260">若要建立、改變或卸除伺服器稽核或伺服器稽核規格，伺服器主體需要 ALTER ANY SERVER AUDIT 或 CONTROL SERVER 權限。</span><span class="sxs-lookup"><span data-stu-id="398cb-260">To create, alter, or drop a Server Audit or Server Audit Specification, server principals require the ALTER ANY SERVER AUDIT or the CONTROL SERVER permission.</span></span> <span data-ttu-id="398cb-261">若要建立、改變或卸除資料庫稽核規格，資料庫主體需要資料庫的 ALTER ANY DATABASE AUDIT 權限或是 ALTER 或 CONTROL 權限。</span><span class="sxs-lookup"><span data-stu-id="398cb-261">To create, alter, or drop a Database Audit Specification, database principals require the ALTER ANY DATABASE AUDIT permission or the ALTER or CONTROL permission on the database.</span></span> <span data-ttu-id="398cb-262">此外，主體還必須擁有連接資料庫的權限，或 ALTER ANY SERVER AUDIT 或 CONTROL SERVER 權限。</span><span class="sxs-lookup"><span data-stu-id="398cb-262">In addition, principals must have permission to connect to the database, or ALTER ANY SERVER AUDIT or CONTROL SERVER permissions.</span></span>  
  
 <span data-ttu-id="398cb-263">除非另外指定，否則檢視目錄檢視需要主體具備下列其中一項：</span><span class="sxs-lookup"><span data-stu-id="398cb-263">Unless otherwise specified, viewing catalog views requires a principal to have one of the following:</span></span>  
  
-   <span data-ttu-id="398cb-264">sysadmin 固定伺服器角色中的成員資格。</span><span class="sxs-lookup"><span data-stu-id="398cb-264">Membership in the sysadmin fixed server role.</span></span>  
  
-   <span data-ttu-id="398cb-265">CONTROL SERVER 權限。</span><span class="sxs-lookup"><span data-stu-id="398cb-265">The CONTROL SERVER permission.</span></span>  
  
-   <span data-ttu-id="398cb-266">VIEW SERVER STATE 權限。</span><span class="sxs-lookup"><span data-stu-id="398cb-266">The VIEW SERVER STATE permission.</span></span>  
  
-   <span data-ttu-id="398cb-267">ALTER ANY AUDIT 權限。</span><span class="sxs-lookup"><span data-stu-id="398cb-267">The ALTER ANY AUDIT permission.</span></span>  
  
-   <span data-ttu-id="398cb-268">VIEW AUDIT STATE 權限 (只提供主體存取 sys.server_audits 目錄檢視的權限)。</span><span class="sxs-lookup"><span data-stu-id="398cb-268">The VIEW AUDIT STATE permission (gives only the principal access to the sys.server_audits catalog view).</span></span>  
  
 <span data-ttu-id="398cb-269">主體必須擁有 VIEW SERVER STATE 或 ALTER ANY AUDIT 權限，才能使用動態管理檢視。</span><span class="sxs-lookup"><span data-stu-id="398cb-269">A principal must have the VIEW SERVER STATE or ALTER ANY AUDIT permission to use the Dynamic Management Views.</span></span>  
  
 <span data-ttu-id="398cb-270">如需如何授與權限的詳細資訊，請參閱 [GRANT &#40;Transact-SQL&#41;](/sql/t-sql/statements/grant-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="398cb-270">For more information about how to grant rights and permissions, see [GRANT &#40;Transact-SQL&#41;](/sql/t-sql/statements/grant-transact-sql).</span></span>  
  
> [!CAUTION]  
>  <span data-ttu-id="398cb-271">系統管理員 (sysadmin) 角色中的主體可以損害任何稽核元件，而 db_owner 角色中的主體可以損害資料庫中的稽核規格。</span><span class="sxs-lookup"><span data-stu-id="398cb-271">Principals in the sysadmin role can tamper with any audit component and those in the db_owner role can tamper with audit specifications in a database.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="398cb-272">Audit 將會驗證建立或改變稽核規格的登入至少要有 ALTER ANY DATABASE AUDIT 權限。</span><span class="sxs-lookup"><span data-stu-id="398cb-272">Audit will validate that a logon that creates or alters an audit specification has at least the ALTER ANY DATABASE AUDIT permission.</span></span> <span data-ttu-id="398cb-273">但是，當您附加資料庫時，它不會進行任何驗證。</span><span class="sxs-lookup"><span data-stu-id="398cb-273">However, it does no validation when you attach a database.</span></span> <span data-ttu-id="398cb-274">您應該假設所有資料庫稽核規格都與系統管理員 (sysadmin) 或 db_owner 角色中的主體一樣值得信任。</span><span class="sxs-lookup"><span data-stu-id="398cb-274">You should assume all Database Audit Specifications are only as trustworthy as those principals in the sysadmin or db_owner role.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="398cb-275">相關工作</span><span class="sxs-lookup"><span data-stu-id="398cb-275">Related Tasks</span></span>  
 [<span data-ttu-id="398cb-276">建立伺服器稽核與伺服器稽核規格</span><span class="sxs-lookup"><span data-stu-id="398cb-276">Create a Server Audit and Server Audit Specification</span></span>](create-a-server-audit-and-server-audit-specification.md)  
  
 [<span data-ttu-id="398cb-277">建立伺服器稽核和資料庫稽核規格</span><span class="sxs-lookup"><span data-stu-id="398cb-277">Create a Server Audit and Database Audit Specification</span></span>](create-a-server-audit-and-database-audit-specification.md)  
  
 [<span data-ttu-id="398cb-278">檢視 SQL Server Audit 記錄</span><span class="sxs-lookup"><span data-stu-id="398cb-278">View a SQL Server Audit Log</span></span>](view-a-sql-server-audit-log.md)  
  
 [<span data-ttu-id="398cb-279">將 SQL Server Audit 事件寫入安全性記錄檔</span><span class="sxs-lookup"><span data-stu-id="398cb-279">Write SQL Server Audit Events to the Security Log</span></span>](write-sql-server-audit-events-to-the-security-log.md)  
  
## <a name="topics-closely-related-to-auditing"></a><span data-ttu-id="398cb-280">與稽核密切相關的主題</span><span class="sxs-lookup"><span data-stu-id="398cb-280">Topics Closely Related to Auditing</span></span>  
 [<span data-ttu-id="398cb-281">伺服器屬性 &#40;安全性頁面&#41;</span><span class="sxs-lookup"><span data-stu-id="398cb-281">Server Properties &#40;Security Page&#41;</span></span>](../../../database-engine/configure-windows/server-properties-security-page.md)  
 <span data-ttu-id="398cb-282">說明如何開啟 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]的登入稽核。</span><span class="sxs-lookup"><span data-stu-id="398cb-282">Explains how to turn on login auditing for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="398cb-283">這些稽核記錄會儲存在 Windows 應用程式記錄檔中。</span><span class="sxs-lookup"><span data-stu-id="398cb-283">The audit records are stored in the Windows application log.</span></span>  
  
 [<span data-ttu-id="398cb-284">C2 稽核模式伺服器組態選項</span><span class="sxs-lookup"><span data-stu-id="398cb-284">c2 audit mode Server Configuration Option</span></span>](../../../database-engine/configure-windows/c2-audit-mode-server-configuration-option.md)  
 <span data-ttu-id="398cb-285">說明 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]中的 C2 安全性規範稽核模式。</span><span class="sxs-lookup"><span data-stu-id="398cb-285">Explains the C2 security compliance auditing mode in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 [<span data-ttu-id="398cb-286">安全性稽核事件類別目錄 &#40;SQL Server Profiler&#41;</span><span class="sxs-lookup"><span data-stu-id="398cb-286">Security Audit Event Category &#40;SQL Server Profiler&#41;</span></span>](../../../relational-databases/event-classes/security-audit-event-category-sql-server-profiler.md)  
 <span data-ttu-id="398cb-287">說明 [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)]中可用的稽核事件。</span><span class="sxs-lookup"><span data-stu-id="398cb-287">Explains the audit events you can use in [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)].</span></span> <span data-ttu-id="398cb-288">如需詳細資訊，請參閱 [SQL Server Profiler](../../../tools/sql-server-profiler/sql-server-profiler.md)。</span><span class="sxs-lookup"><span data-stu-id="398cb-288">For more information, see [SQL Server Profiler](../../../tools/sql-server-profiler/sql-server-profiler.md).</span></span>  
  
 [<span data-ttu-id="398cb-289">SQL 追蹤</span><span class="sxs-lookup"><span data-stu-id="398cb-289">SQL Trace</span></span>](../../sql-trace/sql-trace.md)  
 <span data-ttu-id="398cb-290">說明如何從自己的應用程式中使用 SQL 追蹤來手動建立追蹤，而不是使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Profiler 來建立追蹤。</span><span class="sxs-lookup"><span data-stu-id="398cb-290">Explains how SQL Trace can be used from within your own applications to create traces manually, instead of using [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Profiler.</span></span>  
  
 [<span data-ttu-id="398cb-291">DDL 觸發程序</span><span class="sxs-lookup"><span data-stu-id="398cb-291">DDL Triggers</span></span>](../../triggers/ddl-triggers.md)  
 <span data-ttu-id="398cb-292">說明如何使用資料定義語言 (DDL) 觸發程序來追蹤資料庫的變更。</span><span class="sxs-lookup"><span data-stu-id="398cb-292">Explains how you can use Data Definition Language (DDL) triggers to track changes to your databases.</span></span>  
  
 [<span data-ttu-id="398cb-293">Microsoft TechNet：SQL Server TechCenter：SQL Server 2005 安全性與保護</span><span class="sxs-lookup"><span data-stu-id="398cb-293">Microsoft TechNet: SQL Server TechCenter: SQL Server 2005 Security and Protection</span></span>](https://go.microsoft.com/fwlink/?LinkId=101152)  
 <span data-ttu-id="398cb-294">提供有關 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安全性的最新資訊。</span><span class="sxs-lookup"><span data-stu-id="398cb-294">Provides up-to-date information about [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] security.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="398cb-295">另請參閱</span><span class="sxs-lookup"><span data-stu-id="398cb-295">See Also</span></span>  
 <span data-ttu-id="398cb-296">[SQL Server Audit 動作群組和動作](sql-server-audit-action-groups-and-actions.md) </span><span class="sxs-lookup"><span data-stu-id="398cb-296">[SQL Server Audit Action Groups and Actions](sql-server-audit-action-groups-and-actions.md) </span></span>  
 [<span data-ttu-id="398cb-297">SQL Server Audit 記錄</span><span class="sxs-lookup"><span data-stu-id="398cb-297">SQL Server Audit Records</span></span>](sql-server-audit-records.md)  
  
  
