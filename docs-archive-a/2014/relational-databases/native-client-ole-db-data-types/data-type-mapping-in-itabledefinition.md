---
title: ITableDefinition 中的資料類型對應 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- mapping data types [OLE DB]
- SQL Server Native Client OLE DB provider, data types
- ITableDefinition interface
- DBCOLUMNDESC structure
- data types [OLE DB]
- CreateTable function
- OLE DB, data types
ms.assetid: 13292d1f-c17e-4d11-bf98-3460a10cbb18
author: rothja
ms.author: jroth
ms.openlocfilehash: 2e58f61231f3e2acfdccaa52117d360a7ba261f2
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87591993"
---
# <a name="data-type-mapping-in-itabledefinition"></a><span data-ttu-id="71af5-102">ITableDefinition 中的資料類型對應</span><span class="sxs-lookup"><span data-stu-id="71af5-102">Data Type Mapping in ITableDefinition</span></span>
  <span data-ttu-id="71af5-103">使用**ITableDefinition：： CreateTable**函數來建立資料表時， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者取用者可以 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 在傳遞之 DBCOLUMNDESC 陣列的*pwszTypeName*成員中指定資料類型。</span><span class="sxs-lookup"><span data-stu-id="71af5-103">When creating tables by using the **ITableDefinition::CreateTable** function, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer can specify [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data types in the *pwszTypeName* member of the DBCOLUMNDESC array that is passed.</span></span> <span data-ttu-id="71af5-104">如果取用者依照名稱來指定資料行的資料類型，系統就會忽略 OLE DB 資料對應 (由 DBCOLUMNDESC 結構的 *wType* 成員代表)。</span><span class="sxs-lookup"><span data-stu-id="71af5-104">If the consumer specifies the data type of a column by name, OLE DB data type mapping, represented by the *wType* member of the DBCOLUMNDESC structure, is ignored.</span></span>  
  
 <span data-ttu-id="71af5-105">使用 DBCOLUMNDESC 結構*wType*成員來指定具有 OLE DB 資料類型的新資料行資料類型時， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者會對應 OLE DB 的資料類型，如下所示。</span><span class="sxs-lookup"><span data-stu-id="71af5-105">When specifying new column data types with OLE DB data types using the DBCOLUMNDESC structure *wType* member, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider maps OLE DB data types as follows.</span></span>  
  
|<span data-ttu-id="71af5-106">OLE DB 資料類型</span><span class="sxs-lookup"><span data-stu-id="71af5-106">OLE DB data type</span></span>|<span data-ttu-id="71af5-107">SQL Server</span><span class="sxs-lookup"><span data-stu-id="71af5-107">SQL Server</span></span><br /><br /> <span data-ttu-id="71af5-108">資料類型</span><span class="sxs-lookup"><span data-stu-id="71af5-108">data type</span></span>|<span data-ttu-id="71af5-109">其他資訊</span><span class="sxs-lookup"><span data-stu-id="71af5-109">Additional information</span></span>|  
|----------------------|------------------------------|----------------------------|  
|<span data-ttu-id="71af5-110">DBTYPE_BOOL</span><span class="sxs-lookup"><span data-stu-id="71af5-110">DBTYPE_BOOL</span></span>|<span data-ttu-id="71af5-111">**bit**</span><span class="sxs-lookup"><span data-stu-id="71af5-111">**bit**</span></span>||  
|<span data-ttu-id="71af5-112">DBTYPE_BYTES</span><span class="sxs-lookup"><span data-stu-id="71af5-112">DBTYPE_BYTES</span></span>|<span data-ttu-id="71af5-113">**binary**、**varbinary**、**image** 或 **varbinary(max)**</span><span class="sxs-lookup"><span data-stu-id="71af5-113">**binary**, **varbinary**, **image,** or **varbinary(max)**</span></span>|<span data-ttu-id="71af5-114">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB 提供者會檢查 DBCOLUMNDESC 結構的*ulColumnSize*成員。</span><span class="sxs-lookup"><span data-stu-id="71af5-114">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider inspects the *ulColumnSize* member of the DBCOLUMNDESC structure.</span></span> <span data-ttu-id="71af5-115">根據實例的值和版本 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者會將此類型對應至**影像**。</span><span class="sxs-lookup"><span data-stu-id="71af5-115">Based on the value, and version of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider maps the type to **image**.</span></span><br /><br /> <span data-ttu-id="71af5-116">如果*ulColumnSize*的值小於**binary**資料類型資料行的最大長度，則 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者會檢查 DBCOLUMNDESC *rgPropertySets*成員。</span><span class="sxs-lookup"><span data-stu-id="71af5-116">If the value of *ulColumnSize* is smaller than the maximum length of a **binary** data type column, then the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider inspects the DBCOLUMNDESC *rgPropertySets* member.</span></span> <span data-ttu-id="71af5-117">如果 DBPROP_COL_FIXEDLENGTH 是 VARIANT_TRUE， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者就會將此類型對應至**binary**。</span><span class="sxs-lookup"><span data-stu-id="71af5-117">If DBPROP_COL_FIXEDLENGTH is VARIANT_TRUE, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider maps the type to **binary**.</span></span> <span data-ttu-id="71af5-118">如果屬性的值是 VARIANT_FALSE， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者就會將此類型對應至**Varbinary**。</span><span class="sxs-lookup"><span data-stu-id="71af5-118">If the value of the property is VARIANT_FALSE, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider maps the type to **varbinary**.</span></span> <span data-ttu-id="71af5-119">不論是哪一種情況，DBCOLUMNDESC *ulColumnSize* 成員都會決定所建立之 SQL Server 資料行的寬度。</span><span class="sxs-lookup"><span data-stu-id="71af5-119">In either case, the DBCOLUMNDESC *ulColumnSize* member determines the width of the SQL Server column created.</span></span>|  
|<span data-ttu-id="71af5-120">DBTYPE_CY</span><span class="sxs-lookup"><span data-stu-id="71af5-120">DBTYPE_CY</span></span>|<span data-ttu-id="71af5-121">**money**</span><span class="sxs-lookup"><span data-stu-id="71af5-121">**money**</span></span>||  
|<span data-ttu-id="71af5-122">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="71af5-122">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="71af5-123">**datetime**</span><span class="sxs-lookup"><span data-stu-id="71af5-123">**datetime**</span></span>||  
|<span data-ttu-id="71af5-124">DBTYPE_GUID</span><span class="sxs-lookup"><span data-stu-id="71af5-124">DBTYPE_GUID</span></span>|<span data-ttu-id="71af5-125">**uniqueidentifier**</span><span class="sxs-lookup"><span data-stu-id="71af5-125">**uniqueidentifier**</span></span>||  
|<span data-ttu-id="71af5-126">DBTYPE_I2</span><span class="sxs-lookup"><span data-stu-id="71af5-126">DBTYPE_I2</span></span>|<span data-ttu-id="71af5-127">**smallint**</span><span class="sxs-lookup"><span data-stu-id="71af5-127">**smallint**</span></span>||  
|<span data-ttu-id="71af5-128">DBTYPE_I4</span><span class="sxs-lookup"><span data-stu-id="71af5-128">DBTYPE_I4</span></span>|<span data-ttu-id="71af5-129">**int**</span><span class="sxs-lookup"><span data-stu-id="71af5-129">**int**</span></span>||  
|<span data-ttu-id="71af5-130">DBTYPE_NUMERIC</span><span class="sxs-lookup"><span data-stu-id="71af5-130">DBTYPE_NUMERIC</span></span>|<span data-ttu-id="71af5-131">**numeric**</span><span class="sxs-lookup"><span data-stu-id="71af5-131">**numeric**</span></span>|<span data-ttu-id="71af5-132">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB 提供者會檢查 DBCOLUMDESC *BPrecision*和*bScale*成員，以判斷數值資料行的有效位數和小**數位**數。</span><span class="sxs-lookup"><span data-stu-id="71af5-132">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider inspects the DBCOLUMDESC *bPrecision* and *bScale* members to determine precision and scale for the **numeric** column.</span></span>|  
|<span data-ttu-id="71af5-133">DBTYPE_R4</span><span class="sxs-lookup"><span data-stu-id="71af5-133">DBTYPE_R4</span></span>|<span data-ttu-id="71af5-134">**real**</span><span class="sxs-lookup"><span data-stu-id="71af5-134">**real**</span></span>||  
|<span data-ttu-id="71af5-135">DBTYPE_R8</span><span class="sxs-lookup"><span data-stu-id="71af5-135">DBTYPE_R8</span></span>|<span data-ttu-id="71af5-136">**float**</span><span class="sxs-lookup"><span data-stu-id="71af5-136">**float**</span></span>||  
|<span data-ttu-id="71af5-137">DBTYPE_STR</span><span class="sxs-lookup"><span data-stu-id="71af5-137">DBTYPE_STR</span></span>|<span data-ttu-id="71af5-138">**char**、**varchar**、**text** 或 **varchar(max)**</span><span class="sxs-lookup"><span data-stu-id="71af5-138">**char**, **varchar**, **text,** or **varchar(max)**</span></span>|<span data-ttu-id="71af5-139">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB 提供者會檢查 DBCOLUMNDESC 結構的*ulColumnSize*成員。</span><span class="sxs-lookup"><span data-stu-id="71af5-139">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider inspects the *ulColumnSize* member of the DBCOLUMNDESC structure.</span></span> <span data-ttu-id="71af5-140">根據實例的值和版本 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者會將此類型對應至**文字**。</span><span class="sxs-lookup"><span data-stu-id="71af5-140">Based on the value and version of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider maps the type to **text**.</span></span><br /><br /> <span data-ttu-id="71af5-141">如果*ulColumnSize*的值小於多位元組字元資料類型資料行的最大長度，則 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者會檢查 DBCOLUMNDESC *rgPropertySets*成員。</span><span class="sxs-lookup"><span data-stu-id="71af5-141">If the value of *ulColumnSize* is smaller than the maximum length of a multibyte character data type column, then the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider inspects the DBCOLUMNDESC *rgPropertySets* member.</span></span> <span data-ttu-id="71af5-142">如果 DBPROP_COL_FIXEDLENGTH 是 VARIANT_TRUE， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者就會將此類型對應至**char**。</span><span class="sxs-lookup"><span data-stu-id="71af5-142">If DBPROP_COL_FIXEDLENGTH is VARIANT_TRUE, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider maps the type to **char**.</span></span> <span data-ttu-id="71af5-143">如果屬性的值是 VARIANT_FALSE， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者就會將此類型對應到**Varchar**。</span><span class="sxs-lookup"><span data-stu-id="71af5-143">If the value of the property is VARIANT_FALSE, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider maps the type to **varchar**.</span></span> <span data-ttu-id="71af5-144">不論是哪一種情況，DBCOLUMNDESC *ulColumnSize* 成員都會決定所建立之 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資料行的寬度。</span><span class="sxs-lookup"><span data-stu-id="71af5-144">In either case, the DBCOLUMNDESC *ulColumnSize* member determines the width of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] column created.</span></span>|  
|<span data-ttu-id="71af5-145">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="71af5-145">DBTYPE_UDT</span></span>|<span data-ttu-id="71af5-146">**UDT**</span><span class="sxs-lookup"><span data-stu-id="71af5-146">**UDT**</span></span>|<span data-ttu-id="71af5-147">當需要 UDT 資料行時，下列資訊會在 `DBCOLUMNDESC` **ITableDefinition：： CreateTable**結構中使用：</span><span class="sxs-lookup"><span data-stu-id="71af5-147">The following information is used in `DBCOLUMNDESC` structures by **ITableDefinition::CreateTable** when UDT columns are required:</span></span><br /><br /> <span data-ttu-id="71af5-148">-   已忽略*pwSzTypeName* 。</span><span class="sxs-lookup"><span data-stu-id="71af5-148">-   *pwSzTypeName* is ignored.</span></span><br /><span data-ttu-id="71af5-149">-   *rgPropertySets*必須包含 `DBPROPSET_SQLSERVERCOLUMN` 屬性集 `DBPROPSET_SQLSERVERCOLUMN` ，如[使用使用者定義類型](../native-client/features/using-user-defined-types.md)中的一節中所述。</span><span class="sxs-lookup"><span data-stu-id="71af5-149">-   *rgPropertySets* must include a `DBPROPSET_SQLSERVERCOLUMN` property set as described in the section on `DBPROPSET_SQLSERVERCOLUMN`, in [Using User-Defined Types](../native-client/features/using-user-defined-types.md).</span></span>|  
|<span data-ttu-id="71af5-150">DBTYPE_UI1</span><span class="sxs-lookup"><span data-stu-id="71af5-150">DBTYPE_UI1</span></span>|<span data-ttu-id="71af5-151">**tinyint**</span><span class="sxs-lookup"><span data-stu-id="71af5-151">**tinyint**</span></span>||  
|<span data-ttu-id="71af5-152">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="71af5-152">DBTYPE_WSTR</span></span>|<span data-ttu-id="71af5-153">**nchar**、**nvarchar**、**ntext** 或 **nvarchar(max)**</span><span class="sxs-lookup"><span data-stu-id="71af5-153">**nchar**, **nvarchar**, **ntext,** or **nvarchar(max)**</span></span>|<span data-ttu-id="71af5-154">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB 提供者會檢查 DBCOLUMNDESC 結構的*ulColumnSize*成員。</span><span class="sxs-lookup"><span data-stu-id="71af5-154">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider inspects the *ulColumnSize* member of the DBCOLUMNDESC structure.</span></span> <span data-ttu-id="71af5-155">根據值， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者會將此類型對應至**Ntext**。</span><span class="sxs-lookup"><span data-stu-id="71af5-155">Based on the value, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider maps the type to **ntext**.</span></span><br /><br /> <span data-ttu-id="71af5-156">如果*ulColumnSize*的值小於 Unicode 字元資料類型資料行的最大長度，則 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者會檢查 DBCOLUMNDESC *rgPropertySets*成員。</span><span class="sxs-lookup"><span data-stu-id="71af5-156">If the value of *ulColumnSize* is smaller than the maximum length of a Unicode character data type column, then the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider inspects the DBCOLUMNDESC *rgPropertySets* member.</span></span> <span data-ttu-id="71af5-157">如果 DBPROP_COL_FIXEDLENGTH 是 VARIANT_TRUE， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者就會將此類型對應到**Nchar**。</span><span class="sxs-lookup"><span data-stu-id="71af5-157">If DBPROP_COL_FIXEDLENGTH is VARIANT_TRUE, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider maps the type to **nchar**.</span></span> <span data-ttu-id="71af5-158">如果屬性的值是 VARIANT_FALSE， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者就會將此類型對應至**Nvarchar**。</span><span class="sxs-lookup"><span data-stu-id="71af5-158">If the value of the property is VARIANT_FALSE, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider maps the type to **nvarchar**.</span></span> <span data-ttu-id="71af5-159">不論是哪一種情況，DBCOLUMNDESC *ulColumnSize* 成員都會決定所建立之 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資料行的寬度。</span><span class="sxs-lookup"><span data-stu-id="71af5-159">In either case, the DBCOLUMNDESC *ulColumnSize* member determines the width of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] column created.</span></span>|  
|<span data-ttu-id="71af5-160">DBTYPE_XML</span><span class="sxs-lookup"><span data-stu-id="71af5-160">DBTYPE_XML</span></span>|<span data-ttu-id="71af5-161">**XML**</span><span class="sxs-lookup"><span data-stu-id="71af5-161">**XML**</span></span>||  
  
> [!NOTE]  
>  <span data-ttu-id="71af5-162">建立新的資料表時，[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供者只會對應上表中指定的 OLE DB 資料類型列舉值。</span><span class="sxs-lookup"><span data-stu-id="71af5-162">When creating a new table, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider maps only the OLE DB data type enumeration values specified in the preceding table.</span></span> <span data-ttu-id="71af5-163">嘗試建立含有任何其他 OLE DB 資料類型之資料行的資料表都會產生錯誤。</span><span class="sxs-lookup"><span data-stu-id="71af5-163">Attempting to create a table with a column of any other OLE DB data type generates an error.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="71af5-164">另請參閱</span><span class="sxs-lookup"><span data-stu-id="71af5-164">See Also</span></span>  
 [<span data-ttu-id="71af5-165">資料類型 &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="71af5-165">Data Types &#40;OLE DB&#41;</span></span>](data-types-ole-db.md)  
  
  
