---
title: bcp_setcolfmt |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
api_name:
- bcp_setcolfmt
api_location:
- sqlncli11.dll
topic_type:
- apiref
helpviewer_keywords:
- bcp_setcolfmt function
ms.assetid: afb47987-39e7-4079-ad66-e0abf4d4c72b
author: rothja
ms.author: jroth
ms.openlocfilehash: bb3b1da62ab4e98ed4497dd11fcc20163025058b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87597101"
---
# <a name="bcp_setcolfmt"></a><span data-ttu-id="b4d00-102">bcp_setcolfmt</span><span class="sxs-lookup"><span data-stu-id="b4d00-102">bcp_setcolfmt</span></span>
  <span data-ttu-id="b4d00-103">**Bcp_setcolfmt**函式會取代[bcp_colfmt](bcp-colfmt.md)。</span><span class="sxs-lookup"><span data-stu-id="b4d00-103">The **bcp_setcolfmt** function supersedes the [bcp_colfmt](bcp-colfmt.md).</span></span> <span data-ttu-id="b4d00-104">在指定資料行定序時，必須使用**bcp_setcolfmt**函數。</span><span class="sxs-lookup"><span data-stu-id="b4d00-104">In specifying the column collation, the **bcp_setcolfmt** function must be used.</span></span> <span data-ttu-id="b4d00-105">[bcp_setbulkmode](bcp-setbulkmode.md)可以用來指定一個以上的資料行格式。</span><span class="sxs-lookup"><span data-stu-id="b4d00-105">[bcp_setbulkmode](bcp-setbulkmode.md) can be used to specify more than one column format.</span></span>  
  
 <span data-ttu-id="b4d00-106">此函數會提供彈性的方法來指定大量複製作業中的資料行格式。</span><span class="sxs-lookup"><span data-stu-id="b4d00-106">This function provides a flexible approach to specifying the column format in a bulk copy operation.</span></span> <span data-ttu-id="b4d00-107">它會用來設定個別的資料行格式屬性。</span><span class="sxs-lookup"><span data-stu-id="b4d00-107">It is used to set individual column format attributes.</span></span> <span data-ttu-id="b4d00-108">**Bcp_setcolfmt**的每個呼叫都會設定一個資料行格式屬性。</span><span class="sxs-lookup"><span data-stu-id="b4d00-108">Each call to **bcp_setcolfmt** sets one column format attribute.</span></span>  
  
 <span data-ttu-id="b4d00-109">**Bcp_setcolfmt**函數會指定使用者檔案中資料的來源或目標格式。</span><span class="sxs-lookup"><span data-stu-id="b4d00-109">The **bcp_setcolfmt** function specifies the source or target format of the data in a user file.</span></span> <span data-ttu-id="b4d00-110">當做來源格式使用時， **bcp_setcolfmt**會將當做大量複製中資料來源使用之現有資料檔案的格式，指定為中的資料表 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="b4d00-110">When used as a source format, **bcp_setcolfmt** specifies the format of an existing data file used as a data source of data in a bulk copy to a table in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="b4d00-111">當做目標格式使用時，會使用以**bcp_setcolfmt**指定的資料行格式建立資料檔案。</span><span class="sxs-lookup"><span data-stu-id="b4d00-111">When used as a target format, the data file is created using the column formats specified with **bcp_setcolfmt**.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="b4d00-112">語法</span><span class="sxs-lookup"><span data-stu-id="b4d00-112">Syntax</span></span>  
  
```  
  
RETCODE bcp_setcolfmt (  
HDBC   
hdbc  
,  
INT   
field  
,  
INT   
property  
,  
void*   
pValue  
,  
INT   
cbValue  
);  
  
```  
  
## <a name="arguments"></a><span data-ttu-id="b4d00-113">引數</span><span class="sxs-lookup"><span data-stu-id="b4d00-113">Arguments</span></span>  
 <span data-ttu-id="b4d00-114">*hdbc*</span><span class="sxs-lookup"><span data-stu-id="b4d00-114">*hdbc*</span></span>  
 <span data-ttu-id="b4d00-115">這是已啟用大量複製的 ODBC 連接控制代碼。</span><span class="sxs-lookup"><span data-stu-id="b4d00-115">Is the bulk copy-enabled ODBC connection handle.</span></span>  
  
 <span data-ttu-id="b4d00-116">*欄位*</span><span class="sxs-lookup"><span data-stu-id="b4d00-116">*field*</span></span>  
 <span data-ttu-id="b4d00-117">這是要設定屬性的序數資料行編號。</span><span class="sxs-lookup"><span data-stu-id="b4d00-117">Is the ordinal column number for which the property is being set.</span></span>  
  
 <span data-ttu-id="b4d00-118">*property*</span><span class="sxs-lookup"><span data-stu-id="b4d00-118">*property*</span></span>  
 <span data-ttu-id="b4d00-119">這是其中一個屬性常數。</span><span class="sxs-lookup"><span data-stu-id="b4d00-119">Is one of the property constants.</span></span> <span data-ttu-id="b4d00-120">屬性常數會在這個資料表中定義。</span><span class="sxs-lookup"><span data-stu-id="b4d00-120">Property constants are defined in this table.</span></span>  
  
|<span data-ttu-id="b4d00-121">屬性</span><span class="sxs-lookup"><span data-stu-id="b4d00-121">Property</span></span>|<span data-ttu-id="b4d00-122">值</span><span class="sxs-lookup"><span data-stu-id="b4d00-122">Value</span></span>|<span data-ttu-id="b4d00-123">描述</span><span class="sxs-lookup"><span data-stu-id="b4d00-123">Description</span></span>|  
|--------------|-----------|-----------------|  
|<span data-ttu-id="b4d00-124">BCP_FMT_TYPE</span><span class="sxs-lookup"><span data-stu-id="b4d00-124">BCP_FMT_TYPE</span></span>|<span data-ttu-id="b4d00-125">BYTE</span><span class="sxs-lookup"><span data-stu-id="b4d00-125">BYTE</span></span>|<span data-ttu-id="b4d00-126">這是使用者檔案中，此資料行的資料類型。</span><span class="sxs-lookup"><span data-stu-id="b4d00-126">Is the data type of this column in the user file.</span></span> <span data-ttu-id="b4d00-127">如果與資料庫資料表中，對應資料行的資料類型不同，大量複製就會轉換資料 (如果可能的話)。</span><span class="sxs-lookup"><span data-stu-id="b4d00-127">If different from the data type of the corresponding column in the database table, bulk copy converts the data if possible.</span></span><br /><br /> <span data-ttu-id="b4d00-128">BCP_FMT_TYPE 參數是透過 sqlncli.h 中的 SQL Server 資料類型 Token，而非透過 ODBC C 資料類型列舉值列舉。</span><span class="sxs-lookup"><span data-stu-id="b4d00-128">The BCP_FMT_TYPE parameter is enumerated by the SQL Server data type tokens in sqlncli.h, rather than the ODBC C data type enumerators.</span></span> <span data-ttu-id="b4d00-129">例如，您可以使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 專屬類型 SQLCHARACTER 來指定字元字串 ODBC type SQL_C_CHAR。</span><span class="sxs-lookup"><span data-stu-id="b4d00-129">For example, you can specify a character string, ODBC type SQL_C_CHAR, using the SQLCHARACTER type specific to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span><br /><br /> <span data-ttu-id="b4d00-130">若要指定 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資料類型的預設資料表示法，將此參數設定為 0。</span><span class="sxs-lookup"><span data-stu-id="b4d00-130">To specify the default data representation for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type, set this parameter to 0.</span></span><br /><br /> <span data-ttu-id="b4d00-131">若要從 SQL Server 大量複製到檔案，當 BCP_FMT_TYPE 為 SQLDECIMAL 或 SQLNUMERIC 時：</span><span class="sxs-lookup"><span data-stu-id="b4d00-131">For a bulk copy out of SQL Server into a file, when BCP_FMT_TYPE is SQLDECIMAL or SQLNUMERIC:</span></span><br /><br /> <span data-ttu-id="b4d00-132">-如果來源資料行不是**decimal**或**numeric**，就會使用預設的有效位數和小數位數。</span><span class="sxs-lookup"><span data-stu-id="b4d00-132">-   If the source column is not **decimal** or **numeric**, the default precision and scale are used.</span></span><br /><span data-ttu-id="b4d00-133">-如果來源資料行是**小數**或**數值**，則會使用來源資料行的有效位數和小數位數。</span><span class="sxs-lookup"><span data-stu-id="b4d00-133">-   If the source column is **decimal** or **numeric**, the precision and scale of the source column are used.</span></span>|  
|<span data-ttu-id="b4d00-134">BCP_FMT_INDICATOR_LEN</span><span class="sxs-lookup"><span data-stu-id="b4d00-134">BCP_FMT_INDICATOR_LEN</span></span>|<span data-ttu-id="b4d00-135">INT</span><span class="sxs-lookup"><span data-stu-id="b4d00-135">INT</span></span>|<span data-ttu-id="b4d00-136">這是指標 (前置詞) 的位元組長度。</span><span class="sxs-lookup"><span data-stu-id="b4d00-136">Is the length in bytes of the indicator (prefix).</span></span><br /><br /> <span data-ttu-id="b4d00-137">這是資料行資料內，長度/null 指標的長度 (以位元組為單位)。</span><span class="sxs-lookup"><span data-stu-id="b4d00-137">It is the length, in bytes, of a length/null indicator within the column data.</span></span> <span data-ttu-id="b4d00-138">有效的指標長度值為 0 (不使用指標時)、1、2 或 4。</span><span class="sxs-lookup"><span data-stu-id="b4d00-138">Valid indicator length values are 0 (when using no indicator), 1, 2, or 4.</span></span><br /><br /> <span data-ttu-id="b4d00-139">若要指定預設大量複製指標使用率，將此參數設定為 SQL_VARLEN_DATA。</span><span class="sxs-lookup"><span data-stu-id="b4d00-139">To specify default bulk copy indicator usage, set this parameter to SQL_VARLEN_DATA.</span></span><br /><br /> <span data-ttu-id="b4d00-140">這些指標會出現在任何資料正前方的記憶體中，以及所套用之資料正前方的資料檔案中。</span><span class="sxs-lookup"><span data-stu-id="b4d00-140">Indicators appear in memory directly before any data, and in the data file directly before the data to which they apply.</span></span><br /><br /> <span data-ttu-id="b4d00-141">如果使用多種指定資料檔案資料行長度的方式 (例如指標和最大資料行長度，或指標和結束字元順序)，大量複製會選擇導致複製最少量資料的方式。</span><span class="sxs-lookup"><span data-stu-id="b4d00-141">If more than one means of specifying a data file column length is used (such as an indicator and a maximum column length, or an indicator and a terminator sequence), bulk copy chooses the one that results in the least amount of data being copied.</span></span><br /><br /> <span data-ttu-id="b4d00-142">大量複製在不透過使用者操作來調整資料格式時所產生的資料檔案，會在資料行資料長度可以改變，或資料行可以當做值接受 NULL 時包含指標。</span><span class="sxs-lookup"><span data-stu-id="b4d00-142">Data files generated by bulk copy when no user intervention adjusts the format of the data contain indicators when the column data can vary in length or the column can accept NULL as a value.</span></span>|  
|<span data-ttu-id="b4d00-143">BCP_FMT_DATA_LEN</span><span class="sxs-lookup"><span data-stu-id="b4d00-143">BCP_FMT_DATA_LEN</span></span>|<span data-ttu-id="b4d00-144">DBINT</span><span class="sxs-lookup"><span data-stu-id="b4d00-144">DBINT</span></span>|<span data-ttu-id="b4d00-145">這是資料的位元組長度 (資料行長度)</span><span class="sxs-lookup"><span data-stu-id="b4d00-145">Is the length in bytes of the data (column length)</span></span><br /><br /> <span data-ttu-id="b4d00-146">這是使用者檔案中此資料行之資料的最大長度 (以位元組為單位)，不包括任何長度指標或結束字元的長度。</span><span class="sxs-lookup"><span data-stu-id="b4d00-146">It is the maximum length, in bytes, of this column's data in the user file, not including the length of any length indicator or terminator.</span></span><br /><br /> <span data-ttu-id="b4d00-147">將 BCP_FMT_DATA_LEN 設定為 BCP_FMT_DATA 表示資料檔案資料行中的所有值都會 (或應該) 設定為 NULL。</span><span class="sxs-lookup"><span data-stu-id="b4d00-147">Setting BCP_FMT_DATA_LEN to SQL_NULL_DATA indicates that all values in the data file column are, or should be set to, NULL.</span></span><br /><br /> <span data-ttu-id="b4d00-148">將 BCP_FMT_DATA_LEN 設定為 SQL_VARLEN_DATA 表示系統應該決定每個資料行中的資料長度。</span><span class="sxs-lookup"><span data-stu-id="b4d00-148">Setting BCP_FMT_DATA_LEN to SQL_VARLEN_DATA indicates that the system should determine the length of data in each column.</span></span> <span data-ttu-id="b4d00-149">對於某些資料行，這可能表示長度/null 指標會在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 複本之資料前產生，或者表示該指標應該會在複製到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的資料中出現。</span><span class="sxs-lookup"><span data-stu-id="b4d00-149">For some columns, this could mean that a length/null indicator is generated to precede data on a copy from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], or that the indicator is expected in data copied to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span><br /><br /> <span data-ttu-id="b4d00-150">對於 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 字元和二進位資料類型，BCP_FMT_DATA_LEN 可能是 SQL_VARLEN_DATA、SQL_NULL_DATA、0 或某個正值。</span><span class="sxs-lookup"><span data-stu-id="b4d00-150">For [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] character and binary data types, BCP_FMT_DATA_LEN can be SQL_VARLEN_DATA, SQL_NULL_DATA, 0, or some positive value.</span></span> <span data-ttu-id="b4d00-151">如果 BCP_FMT_DATA_LEN 為 SQL_VARLEN_DATA，系統會使用長度指標 (如果存在) 或結束字元順序來決定資料的長度。</span><span class="sxs-lookup"><span data-stu-id="b4d00-151">If BCP_FMT_DATA_LEN is SQL_VARLEN_DATA, the system uses either the length indicator, if present, or a terminator sequence to determine the length of the data.</span></span> <span data-ttu-id="b4d00-152">如果同時提供長度指標與結束字元順序，大量複製會使用導致複製最少量資料者。</span><span class="sxs-lookup"><span data-stu-id="b4d00-152">If both a length indicator and a terminator sequence are supplied, bulk copy uses the one that results in the least amount of data being copied.</span></span> <span data-ttu-id="b4d00-153">如果 BCP_FMT_DATA_LEN 為 SQL_VARLEN_DATA，資料類型為 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 字元或二進位類型，而且長度指標和結束字元順序都未指定，系統會傳回錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="b4d00-153">If BCP_FMT_DATA_LEN is SQL_VARLEN_DATA, the data type is an [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] character or binary type, and neither a length indicator nor a terminator sequence is specified, the system returns an error message.</span></span><br /><br /> <span data-ttu-id="b4d00-154">如果 BCP_FMT_DATA_LEN 為 0 或正值，則系統會使用 BCP_FMT_DATA_LEN 當做資料長度的最大值。</span><span class="sxs-lookup"><span data-stu-id="b4d00-154">If BCP_FMT_DATA_LEN is 0 or a positive value, the system uses BCP_FMT_DATA_LEN as the maximum data length.</span></span> <span data-ttu-id="b4d00-155">不過，如果除了正數的 BCP_FMT_DATA_LEN 之外，也提供長度指標或結束字元順序，系統會使用導致複製最少量資料的方法來決定資料長度。</span><span class="sxs-lookup"><span data-stu-id="b4d00-155">However, if, in addition to a positive BCP_FMT_DATA_LEN, a length indicator or terminator sequence is provided, the system determines the data length by using the method that results in the least amount of data being copied.</span></span><br /><br /> <span data-ttu-id="b4d00-156">BCP_FMT_DATA_LEN 值表示資料的位元組計數。</span><span class="sxs-lookup"><span data-stu-id="b4d00-156">The BCP_FMT_DATA_LEN value represents the count of bytes of data.</span></span> <span data-ttu-id="b4d00-157">如果字元資料是以 Unicode 寬字元表示，則 BCP_FMT_DATA_LEN 正參數值表示字元數乘以每個字元的大小 (以位元組為單位)。</span><span class="sxs-lookup"><span data-stu-id="b4d00-157">If character data is represented by Unicode wide characters, then a positive BCP_FMT_DATA_LEN parameter value represents the number of characters multiplied by the size, in bytes, of each character.</span></span>|  
|<span data-ttu-id="b4d00-158">BCP_FMT_TERMINATOR</span><span class="sxs-lookup"><span data-stu-id="b4d00-158">BCP_FMT_TERMINATOR</span></span>|<span data-ttu-id="b4d00-159">LPCBYTE</span><span class="sxs-lookup"><span data-stu-id="b4d00-159">LPCBYTE</span></span>|<span data-ttu-id="b4d00-160">用於此資料行之結束字元順序的指標 (ANSI 或 Unicode 中較適合者)。</span><span class="sxs-lookup"><span data-stu-id="b4d00-160">Pointer to the terminator sequence (either ANSI or Unicode as appropriate) to be used for this column.</span></span> <span data-ttu-id="b4d00-161">此參數主要用於字元資料類型，因為其他所有類型都屬固定長度；如果是二進位資料，則需要一個長度指標，才能正確記錄出現的位元組數目。</span><span class="sxs-lookup"><span data-stu-id="b4d00-161">This parameter is useful mainly for character data types because all other types are of fixed length or, in the case of binary data, require an indicator of length to accurately record the number of bytes present.</span></span><br /><br /> <span data-ttu-id="b4d00-162">為避免結束已擷取的資料，或要指出使用者檔案中的資料未結束，將此參數設定為 NULL。</span><span class="sxs-lookup"><span data-stu-id="b4d00-162">To avoid terminating extracted data, or to indicate that data in a user file is not terminated, set this parameter to NULL.</span></span><br /><br /> <span data-ttu-id="b4d00-163">如果使用多種指定使用者檔案資料行長度的方式 (例如結束字元和長度指標，或結束字元和資料行長度最大值)，大量複製會選擇導致複製最少量資料的方式。</span><span class="sxs-lookup"><span data-stu-id="b4d00-163">If more than one means of specifying a user-file column length is used (such as a terminator and a length indicator, or a terminator and a maximum column length), bulk copy chooses the one that results in the least amount of data being copied.</span></span><br /><br /> <span data-ttu-id="b4d00-164">大量複製 API 會視需要執行 Unicode 到 MBCS 的字元轉換。</span><span class="sxs-lookup"><span data-stu-id="b4d00-164">The bulk copy API performs Unicode-to-MBCS character conversion as required.</span></span> <span data-ttu-id="b4d00-165">請務必確認結束字元位元組字串與位元組字串長度的設定正確。</span><span class="sxs-lookup"><span data-stu-id="b4d00-165">Care must be taken to ensure that both the terminator byte string and the length of the byte string are set correctly.</span></span>|  
|<span data-ttu-id="b4d00-166">BCP_FMT_SERVER_COL</span><span class="sxs-lookup"><span data-stu-id="b4d00-166">BCP_FMT_SERVER_COL</span></span>|<span data-ttu-id="b4d00-167">INT</span><span class="sxs-lookup"><span data-stu-id="b4d00-167">INT</span></span>|<span data-ttu-id="b4d00-168">資料行在資料庫中的序數位置。</span><span class="sxs-lookup"><span data-stu-id="b4d00-168">Ordinal position of the column in the database</span></span>|  
|<span data-ttu-id="b4d00-169">BCP_FMT_COLLATION</span><span class="sxs-lookup"><span data-stu-id="b4d00-169">BCP_FMT_COLLATION</span></span>|<span data-ttu-id="b4d00-170">LPCSTR</span><span class="sxs-lookup"><span data-stu-id="b4d00-170">LPCSTR</span></span>|<span data-ttu-id="b4d00-171">定序名稱。</span><span class="sxs-lookup"><span data-stu-id="b4d00-171">Collation name.</span></span>|  
  
 <span data-ttu-id="b4d00-172">*pValue*</span><span class="sxs-lookup"><span data-stu-id="b4d00-172">*pValue*</span></span>  
 <span data-ttu-id="b4d00-173">這是要與*屬性*產生關聯之值的指標。</span><span class="sxs-lookup"><span data-stu-id="b4d00-173">Is the pointer to the value to associate to the *property*.</span></span> <span data-ttu-id="b4d00-174">它允許每個資料行格式屬性個別設定。</span><span class="sxs-lookup"><span data-stu-id="b4d00-174">It allows each column format property to be set individually.</span></span>  
  
 <span data-ttu-id="b4d00-175">*cbvalue*</span><span class="sxs-lookup"><span data-stu-id="b4d00-175">*cbvalue*</span></span>  
 <span data-ttu-id="b4d00-176">這是屬性緩衝區的長度 (以位元組為單位)。</span><span class="sxs-lookup"><span data-stu-id="b4d00-176">Is the length of the property buffer in bytes.</span></span>  
  
## <a name="returns"></a><span data-ttu-id="b4d00-177">傳回</span><span class="sxs-lookup"><span data-stu-id="b4d00-177">Returns</span></span>  
 <span data-ttu-id="b4d00-178">SUCCEED 或 FAIL。</span><span class="sxs-lookup"><span data-stu-id="b4d00-178">SUCCEED or FAIL.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="b4d00-179">備註</span><span class="sxs-lookup"><span data-stu-id="b4d00-179">Remarks</span></span>  
 <span data-ttu-id="b4d00-180">此函式會取代**bcp_colfmt**函數。</span><span class="sxs-lookup"><span data-stu-id="b4d00-180">This function supersedes the **bcp_colfmt** function.</span></span> <span data-ttu-id="b4d00-181">**Bcp_setcolfmt**函式中提供了**bcp_colfmt**的所有功能。</span><span class="sxs-lookup"><span data-stu-id="b4d00-181">All the functionality of **bcp_colfmt** is provided in **bcp_setcolfmt** function.</span></span> <span data-ttu-id="b4d00-182">此外，也提供資料行定序的支援。</span><span class="sxs-lookup"><span data-stu-id="b4d00-182">In addition, support for column collation is also provided.</span></span> <span data-ttu-id="b4d00-183">建議使用以下提供的順序設定下列資料行格式屬性：</span><span class="sxs-lookup"><span data-stu-id="b4d00-183">It is recommended that the following column format attributes be set in the order given below:</span></span>  
  
 <span data-ttu-id="b4d00-184">BCP_FMT_SERVER_COL</span><span class="sxs-lookup"><span data-stu-id="b4d00-184">BCP_FMT_SERVER_COL</span></span>  
  
 <span data-ttu-id="b4d00-185">BCP_FMT_DATA_LEN</span><span class="sxs-lookup"><span data-stu-id="b4d00-185">BCP_FMT_DATA_LEN</span></span>  
  
 <span data-ttu-id="b4d00-186">BCP_FMT_TYPE</span><span class="sxs-lookup"><span data-stu-id="b4d00-186">BCP_FMT_TYPE</span></span>  
  
 <span data-ttu-id="b4d00-187">**Bcp_setcolfmt**函數可讓您指定大量複製的使用者檔案格式。</span><span class="sxs-lookup"><span data-stu-id="b4d00-187">The **bcp_setcolfmt** function allows you to specify the user-file format for bulk copies.</span></span> <span data-ttu-id="b4d00-188">針對大量複製，格式包含下列部分：</span><span class="sxs-lookup"><span data-stu-id="b4d00-188">For bulk copy, a format contains the following parts:</span></span>  
  
-   <span data-ttu-id="b4d00-189">從使用者檔案資料行對應至資料庫資料行。</span><span class="sxs-lookup"><span data-stu-id="b4d00-189">A mapping from user-file columns to database columns.</span></span>  
  
-   <span data-ttu-id="b4d00-190">每個使用者檔案資料行的資料類型。</span><span class="sxs-lookup"><span data-stu-id="b4d00-190">The data type of each user-file column.</span></span>  
  
-   <span data-ttu-id="b4d00-191">每個資料行的選擇性指標長度。</span><span class="sxs-lookup"><span data-stu-id="b4d00-191">The length of the optional indicator for each column.</span></span>  
  
-   <span data-ttu-id="b4d00-192">每個使用者檔案資料行的資料最大長度。</span><span class="sxs-lookup"><span data-stu-id="b4d00-192">The maximum length of data per user-file column.</span></span>  
  
-   <span data-ttu-id="b4d00-193">每個資料行的選擇性結束位元組順序。</span><span class="sxs-lookup"><span data-stu-id="b4d00-193">The optional terminating byte sequence for each column.</span></span>  
  
-   <span data-ttu-id="b4d00-194">選擇性結束位元組順序的長度。</span><span class="sxs-lookup"><span data-stu-id="b4d00-194">The length of the optional terminating byte sequence.</span></span>  
  
 <span data-ttu-id="b4d00-195">**Bcp_setcolfmt**的每個呼叫都會指定一個使用者檔案資料行的格式。</span><span class="sxs-lookup"><span data-stu-id="b4d00-195">Each call to **bcp_setcolfmt** specifies the format for one user-file column.</span></span> <span data-ttu-id="b4d00-196">例如，若要在五個數據行的使用者資料檔案中變更三個數據行的預設設定，請先呼叫[bcp_columns](bcp-columns.md) \*\* (5) **，然後再呼叫**bcp_setcolfmt\*\*五次，其中三個呼叫會設定您的自訂格式。</span><span class="sxs-lookup"><span data-stu-id="b4d00-196">For example, to change the default settings for three columns in a five-column user data file, first call [bcp_columns](bcp-columns.md)**(5)**, and then call **bcp_setcolfmt** five times, with three of those calls setting your custom format.</span></span> <span data-ttu-id="b4d00-197">針對剩餘的兩個呼叫，將 BCP_FMT_TYPE 設定為0，並分別將 BCP_FMT_INDICATOR_LENGTH、BCP_FMT_DATA_LEN 和*cbValue*設定為0、SQL_VARLEN_DATA 和0。</span><span class="sxs-lookup"><span data-stu-id="b4d00-197">For the remaining two calls, set BCP_FMT_TYPE to 0, and set BCP_FMT_INDICATOR_LENGTH, BCP_FMT_DATA_LEN, and *cbValue* to 0, SQL_VARLEN_DATA, and 0 respectively.</span></span> <span data-ttu-id="b4d00-198">此程序會複製全部五個資料行，其中三個為您自訂的格式，而另兩個為預設格式。</span><span class="sxs-lookup"><span data-stu-id="b4d00-198">This procedure copies all five columns, three with your customized format and two with the default format.</span></span>  
  
 <span data-ttu-id="b4d00-199">呼叫**bcp_setcolfmt**之前，必須先呼叫**bcp_columns**函式。</span><span class="sxs-lookup"><span data-stu-id="b4d00-199">The **bcp_columns** function must be called before calling **bcp_setcolfmt**.</span></span>  
  
 <span data-ttu-id="b4d00-200">您必須針對使用者檔案中每個資料行的每個屬性呼叫一次**bcp_setcolfmt** 。</span><span class="sxs-lookup"><span data-stu-id="b4d00-200">You must call **bcp_setcolfmt** once for each property of each column in the user file.</span></span>  
  
 <span data-ttu-id="b4d00-201">您不需要將使用者檔案中的所有資料複製到 SQL Server 資料表。</span><span class="sxs-lookup"><span data-stu-id="b4d00-201">You do not need to copy all data in a user file to the SQL Server table.</span></span> <span data-ttu-id="b4d00-202">若要略過資料行，請指定資料行的資料格式，並將 BCP_FMT_SERVER_COL 參數設定為 0。</span><span class="sxs-lookup"><span data-stu-id="b4d00-202">To skip a column, specify the format of the data for the column, setting the BCP_FMT_SERVER_COL parameter to 0.</span></span> <span data-ttu-id="b4d00-203">如果您要略過資料行，則必須指定其類型。</span><span class="sxs-lookup"><span data-stu-id="b4d00-203">If you want to skip a column, you must specify its type.</span></span>  
  
 <span data-ttu-id="b4d00-204">[Bcp_writefmt](bcp-writefmt.md)函數可以用來保存格式規格。</span><span class="sxs-lookup"><span data-stu-id="b4d00-204">The [bcp_writefmt](bcp-writefmt.md) function can be used to persist the format specification.</span></span>  
  
## <a name="bcp_setcolfmt-support-for-enhanced-date-and-time-features"></a><span data-ttu-id="b4d00-205">bcp_setcolfmt 對於增強型日期和時間功能的支援</span><span class="sxs-lookup"><span data-stu-id="b4d00-205">bcp_setcolfmt Support for Enhanced Date and Time Features</span></span>  
 <span data-ttu-id="b4d00-206">與日期/時間類型的 BCP_FMT_TYPE 屬性搭配使用的類型，會如[針對增強型日期和時間類型的大量複製變更（&#40;OLE DB 和 ODBC&#41;](../native-client-odbc-date-time/bulk-copy-changes-for-enhanced-date-and-time-types-ole-db-and-odbc.md)中所指定）。</span><span class="sxs-lookup"><span data-stu-id="b4d00-206">The types used with the BCP_FMT_TYPE property for date/time types are as specified in [Bulk Copy Changes for Enhanced Date and Time Types &#40;OLE DB and ODBC&#41;](../native-client-odbc-date-time/bulk-copy-changes-for-enhanced-date-and-time-types-ole-db-and-odbc.md).</span></span>  
  
 <span data-ttu-id="b4d00-207">如需詳細資訊，請參閱[ODBC&#41;&#40;的日期和時間改善](../native-client-odbc-date-time/date-and-time-improvements-odbc.md)。</span><span class="sxs-lookup"><span data-stu-id="b4d00-207">For more information, see [Date and Time Improvements &#40;ODBC&#41;](../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b4d00-208">另請參閱</span><span class="sxs-lookup"><span data-stu-id="b4d00-208">See Also</span></span>  
 [<span data-ttu-id="b4d00-209">大量複製函數</span><span class="sxs-lookup"><span data-stu-id="b4d00-209">Bulk Copy Functions</span></span>](sql-server-driver-extensions-bulk-copy-functions.md)  
  
  
