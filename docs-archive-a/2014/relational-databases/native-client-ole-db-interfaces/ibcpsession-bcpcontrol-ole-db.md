---
title: IBCPSession::BCPControl (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
api_name:
- IBCPSession::BCPControl (OLE DB)
topic_type:
- apiref
helpviewer_keywords:
- BCPControl method
ms.assetid: d58f3fe1-45e3-4e46-8e9c-000971829d99
author: rothja
ms.author: jroth
ms.openlocfilehash: a3de4d0a942d29f18752374b4020fbfd19aa15ec
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87707454"
---
# <a name="ibcpsessionbcpcontrol-ole-db"></a><span data-ttu-id="e7e0a-102">IBCPSession::BCPControl (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="e7e0a-102">IBCPSession::BCPControl (OLE DB)</span></span>
  <span data-ttu-id="e7e0a-103">設定大量複製作業的選項。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-103">Sets the options for a bulk-copy operation.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="e7e0a-104">語法</span><span class="sxs-lookup"><span data-stu-id="e7e0a-104">Syntax</span></span>  
  
```  
  
HRESULT BCPControl(   
inteOption,  
void *iValue);  
```  
  
## <a name="remarks"></a><span data-ttu-id="e7e0a-105">備註</span><span class="sxs-lookup"><span data-stu-id="e7e0a-105">Remarks</span></span>  
 <span data-ttu-id="e7e0a-106">**BCPControl** 方法會設定各種大量複製作業的控制參數，包括取消大量複製之前允許出現的錯誤次數、要從資料檔案複製的第一個和最後一個資料列的數目，以及批次大小。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-106">The **BCPControl** method sets various control parameters for bulk-copy operations including the number of errors allowed before canceling a bulk copy, the numbers of the first and last rows to copy from a data file, and the batch size.</span></span>  
  
 <span data-ttu-id="e7e0a-107">當從 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 大量複製資料時，這個方法也可用於指定要使用的 SELECT 陳述式。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-107">This method is also used to specify the SELECT statement to use when bulk copying data out from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="e7e0a-108">您可以將 `eOption` 引數設定為 BCP_OPTION_HINTS 和引數，使其 `iValue` 具有包含 SELECT 語句之寬字元字串的指標。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-108">You can set the `eOption` argument to BCP_OPTION_HINTS and `iValue` argument to have a pointer to a wide character string containing the SELECT statement.</span></span>  
  
 <span data-ttu-id="e7e0a-109">*eOption* 的可能值為：</span><span class="sxs-lookup"><span data-stu-id="e7e0a-109">Possible values for *eOption* are:</span></span>  
  
|<span data-ttu-id="e7e0a-110">選項</span><span class="sxs-lookup"><span data-stu-id="e7e0a-110">Option</span></span>|<span data-ttu-id="e7e0a-111">描述</span><span class="sxs-lookup"><span data-stu-id="e7e0a-111">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="e7e0a-112">BCP_OPTION_ABORT</span><span class="sxs-lookup"><span data-stu-id="e7e0a-112">BCP_OPTION_ABORT</span></span>|<span data-ttu-id="e7e0a-113">停止已經進行的大量複製作業。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-113">Stops a bulk-copy operation that is already in progress.</span></span> <span data-ttu-id="e7e0a-114">您可以用 BCP_OPTION_ABORT 的 *eOption* 引數來呼叫 **BCPControl** 方法，從另一個執行緒停止正在執行的大量複製作業。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-114">You can call the **BCPControl** method with an *eOption* argument of BCP_OPTION_ABORT from another thread to stop a running bulk-copy operation.</span></span> <span data-ttu-id="e7e0a-115">*iValue* 引數會被忽略。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-115">The *iValue* argument is ignored.</span></span>|  
|<span data-ttu-id="e7e0a-116">BCP_OPTION_BATCH</span><span class="sxs-lookup"><span data-stu-id="e7e0a-116">BCP_OPTION_BATCH</span></span>|<span data-ttu-id="e7e0a-117">每一批次中的資料列數目。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-117">The number of rows per batch.</span></span> <span data-ttu-id="e7e0a-118">預設值為 0，表示資料擷取時，會指出資料表中的所有資料列，或資料複製到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 時，會指出使用者資料檔案中的所有資料列。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-118">The default is 0, which indicates all rows in a table when data is being extracted, or all rows in the user data file when data is being copied to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="e7e0a-119">小於 1 的值會將 BCP_OPTION_BATCH 重設為預設值。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-119">A value less than 1 resets BCP_OPTION_BATCH to the default.</span></span>|  
|<span data-ttu-id="e7e0a-120">BCP_OPTION_DELAYREADFMT</span><span class="sxs-lookup"><span data-stu-id="e7e0a-120">BCP_OPTION_DELAYREADFMT</span></span>|<span data-ttu-id="e7e0a-121">這是布林值，如果設定為 true，就會導致 [IBCPSession::BCPReadFmt](ibcpsession-bcpreadfmt-ole-db.md) 在執行時讀取。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-121">A Boolean, if set to true, will cause [IBCPSession::BCPReadFmt](ibcpsession-bcpreadfmt-ole-db.md) to read at execution.</span></span> <span data-ttu-id="e7e0a-122">如果為 false (預設值)，IBCPSession::BCPReadFmt 將會立即讀取格式檔案。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-122">If false (the default), IBCPSession::BCPReadFmt will immediately read the format file.</span></span> <span data-ttu-id="e7e0a-123">如果 `BCP_OPTION_DELAYREADFMT` 為 true，而且您呼叫 IBCPSession：： BCPColumns 或 IBCPSession：： BCPColFmt，將會發生順序錯誤。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-123">A sequence error will occur if `BCP_OPTION_DELAYREADFMT` is true and you call IBCPSession::BCPColumns or IBCPSession::BCPColFmt.</span></span><br /><br /> <span data-ttu-id="e7e0a-124">如果您在呼叫 `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)TRUE)` 和 IBCPSession::BCPWriteFmt 之後呼叫 `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)FALSE))`，也會發生順序錯誤。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-124">A sequence error will also occur if you call `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)FALSE))` after calling `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)TRUE)` and IBCPSession::BCPWriteFmt.</span></span><br /><br /> <span data-ttu-id="e7e0a-125">如需詳細資訊，請參閱[中繼資料探索](../native-client/features/metadata-discovery.md)。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-125">For more information, see [Metadata Discovery](../native-client/features/metadata-discovery.md).</span></span>|  
|<span data-ttu-id="e7e0a-126">BCP_OPTION_FILECP</span><span class="sxs-lookup"><span data-stu-id="e7e0a-126">BCP_OPTION_FILECP</span></span>|<span data-ttu-id="e7e0a-127">*iValue* 引數包含資料檔案的程式碼頁面數目。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-127">The *iValue* argument contains the number of the code page for the data file.</span></span> <span data-ttu-id="e7e0a-128">您可以指定程式碼頁面的數目，例如 1252 或 850，或以下任一個值：</span><span class="sxs-lookup"><span data-stu-id="e7e0a-128">You can specify the number of the code page, such as 1252 or 850, or one of the following values:</span></span><br /><br /> <span data-ttu-id="e7e0a-129">-BCP_FILECP_ACP：檔案中的資料是在 Microsoft Windows 嗎？</span><span class="sxs-lookup"><span data-stu-id="e7e0a-129">-   BCP_FILECP_ACP: data in the file is in the Microsoft Windows??</span></span> <span data-ttu-id="e7e0a-130">用戶端的字碼頁。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-130">code page of the client.</span></span><br /><span data-ttu-id="e7e0a-131">-BCP_FILECP_OEMCP：檔案中的資料位於用戶端 (預設) 的 OEM 字碼頁中。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-131">-   BCP_FILECP_OEMCP: data in the file is in the OEM code page of the client (default).</span></span><br /><span data-ttu-id="e7e0a-132">-BCP_FILECP_RAW：檔案中的資料位於的字碼頁 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-132">-   BCP_FILECP_RAW: data in the file is in the code page of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|  
|<span data-ttu-id="e7e0a-133">BCP_OPTION_FILEFMT</span><span class="sxs-lookup"><span data-stu-id="e7e0a-133">BCP_OPTION_FILEFMT</span></span>|<span data-ttu-id="e7e0a-134">資料檔案格式的版本號碼。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-134">The version number of the data file format.</span></span> <span data-ttu-id="e7e0a-135">這個號碼可以是 80 ([!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)])、90 ([!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)])、100 ([!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 或 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)])、110 ([!INCLUDE[ssSQL11](../../includes/sssql11-md.md)]) 或 120 ([!INCLUDE[ssSQL14](../../includes/sssql14-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-135">This can be 80 ([!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)]), 90 ([!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]), 100 ([!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] or [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]), 110 ([!INCLUDE[ssSQL11](../../includes/sssql11-md.md)]), or 120 ([!INCLUDE[ssSQL14](../../includes/sssql14-md.md)].</span></span> <span data-ttu-id="e7e0a-136">120 是預設值。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-136">120 is the default.</span></span> <span data-ttu-id="e7e0a-137">這個值在使用舊版伺服器支援的格式匯出和匯入資料時非常實用。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-137">This is useful for exporting and importing data in formats that were supported by earlier version of the server.</span></span>  <span data-ttu-id="e7e0a-138">例如，若要將從 [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] 伺服器文字資料行所取得的資料匯入至 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 或更新伺服器的 **varchar(max)** 資料行中，您必須指定版本號碼為 80。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-138">For example, to import data obtained from a text column in a [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] server into a **varchar(max)** column in a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or later server, you should specify 80.</span></span> <span data-ttu-id="e7e0a-139">同樣地，當您從 **varchar(max)** 資料行匯出資料時，如果指定版本號碼為 80，則資料會以 [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] 格式加以儲存，就像儲存文字資料行的格式一樣，並可以匯入至 [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] 伺服器的文字資料行。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-139">Similarly, if you specify 80 while exporting data from a **varchar(max)** column, it will be saved just like text columns are saved in the [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] format, and can be imported into a text column of a [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] server.</span></span>|  
|<span data-ttu-id="e7e0a-140">BCP_OPTION_FIRST</span><span class="sxs-lookup"><span data-stu-id="e7e0a-140">BCP_OPTION_FIRST</span></span>|<span data-ttu-id="e7e0a-141">要複製的檔案或資料表的資料列。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-141">The first row of data of the file or table to copy.</span></span> <span data-ttu-id="e7e0a-142">預設值為 1，小於 1 的值會將這個選項重設為預設。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-142">The default is 1; a value less than 1 resets this option to its default.</span></span>|  
|<span data-ttu-id="e7e0a-143">BCP_OPTION_FIRSTEX</span><span class="sxs-lookup"><span data-stu-id="e7e0a-143">BCP_OPTION_FIRSTEX</span></span>|<span data-ttu-id="e7e0a-144">如果是 BCP Out 作業，則指定將資料庫資料表第一個資料列複製到資料檔案中。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-144">For BCP out operations, specifies the first row of the database table to copy into the data file.</span></span><br /><br /> <span data-ttu-id="e7e0a-145">如果是 BCP In 作業，則指定將資料檔案的第一個資料列複製到資料庫資料表中。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-145">For BCP in operations, specifies the first row of the data file to copy into the database table.</span></span><br /><br /> <span data-ttu-id="e7e0a-146">*iValue* 參數必須是包含值的 64 位元組帶正負號整數之位址。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-146">The *iValue* parameter is expected to be the address of a signed 64-bit integer that contains the value.</span></span> <span data-ttu-id="e7e0a-147">可傳遞至 BCPFIRSTEX 的最大值為 2^63-1。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-147">The maximum value that can be passed to BCPFIRSTEX 2^63-1.</span></span>|  
|<span data-ttu-id="e7e0a-148">BCP_OPTION_FMTXML</span><span class="sxs-lookup"><span data-stu-id="e7e0a-148">BCP_OPTION_FMTXML</span></span>|<span data-ttu-id="e7e0a-149">用於指定所產生的格式檔案應該是 XML 格式。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-149">Used to specify that the format file generated should be in an XML format.</span></span> <span data-ttu-id="e7e0a-150">根據預設，這個選項是關閉的，而且格式檔案會儲存為文字檔案。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-150">It is off by default and by default the format files are saved as text files.</span></span> <span data-ttu-id="e7e0a-151">XML 格式檔案提供更大的彈性，但是有一些條件約束。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-151">The XML format file provides greater flexibility but with some added constraints.</span></span> <span data-ttu-id="e7e0a-152">例如，您不可以同時指定欄位的前置詞和結束字元，即使在更早版本中是可以這麼做的。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-152">For example, you can not specify the prefix and terminator for a field simultaneously which is possible in older format files.</span></span> <span data-ttu-id="e7e0a-153">**注意：** 只有在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安裝工具和 Native Client 時，才支援 XML 格式檔案 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-153">**Note:**  XML format files are only supported when [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tools are installed along with [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span></span>|  
|<span data-ttu-id="e7e0a-154">BCP_OPTION_HINTS</span><span class="sxs-lookup"><span data-stu-id="e7e0a-154">BCP_OPTION_HINTS</span></span>|<span data-ttu-id="e7e0a-155">*iValue* 引數包含寬字元字串指標。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-155">The *iValue* argument contains a wide character string pointer.</span></span> <span data-ttu-id="e7e0a-156">定址的字串會指定處理提示的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 大量複製或傳回結果集的 [!INCLUDE[tsql](../../includes/tsql-md.md)] 陳述式。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-156">The string addressed specifies either [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] bulk-copy processing hints or a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement that returns a result set.</span></span> <span data-ttu-id="e7e0a-157">如果 [!INCLUDE[tsql](../../includes/tsql-md.md)] 陳述式指定為傳回一個以上的結果集，則第一個結果集之後的所有結果集都會被忽略。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-157">If a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement is specified that returns more than one result set, all result sets after the first are ignored.</span></span>|  
|<span data-ttu-id="e7e0a-158">BCP_OPTION_KEEPIDENTITY</span><span class="sxs-lookup"><span data-stu-id="e7e0a-158">BCP_OPTION_KEEPIDENTITY</span></span>|<span data-ttu-id="e7e0a-159">當 *iValue* 引數設定為 TRUE 時，這個選項會指定大量複製方法插入為 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資料行提供的資料值 (這些值是由識別條件約束所定義)。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-159">When the *iValue* argument is set to TRUE, this option specifies that the bulk copy methods insert data values supplied for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] columns defined with an identity constraint.</span></span> <span data-ttu-id="e7e0a-160">輸入檔案必須提供識別資料行的值。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-160">The input file must supply values for the identity columns.</span></span> <span data-ttu-id="e7e0a-161">如果沒有設定，就會為插入的資料列產生新的識別值。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-161">If this is not set, new identity values are generated for the inserted rows.</span></span> <span data-ttu-id="e7e0a-162">檔案中屬於識別欄位的所有資料都會被忽略。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-162">Any data present in the file for the identity columns is ignored.</span></span>|  
|<span data-ttu-id="e7e0a-163">BCP_OPTION_KEEPNULLS</span><span class="sxs-lookup"><span data-stu-id="e7e0a-163">BCP_OPTION_KEEPNULLS</span></span>|<span data-ttu-id="e7e0a-164">指定檔案中的空資料值在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資料表中是否會轉換為 NULL 值。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-164">Specifies whether empty data values in the file will be converted to NULL values in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="e7e0a-165">當 *iValue* 引數設定為 TRUE，空的值在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資料表中會轉換為 NULL。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-165">When the *iValue* argument is set to TRUE, empty values will be converted to NULL in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="e7e0a-166">預設是將空的值轉換為 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資料表中資料行的預設值 (如果有預設值的話)。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-166">The default is for empty values to be converted to a default value for the column in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table if a default exists.</span></span>|  
|<span data-ttu-id="e7e0a-167">BCP_OPTION_LAST</span><span class="sxs-lookup"><span data-stu-id="e7e0a-167">BCP_OPTION_LAST</span></span>|<span data-ttu-id="e7e0a-168">要複製的最後一個資料列。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-168">The last row to copy.</span></span> <span data-ttu-id="e7e0a-169">預設為複製所有資料列。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-169">The default is to copy all rows.</span></span> <span data-ttu-id="e7e0a-170">小於 1 的值會將這個選項重設為預設。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-170">A value less than 1 resets this option to its default.</span></span>|  
|<span data-ttu-id="e7e0a-171">BCP_OPTION_LASTEX</span><span class="sxs-lookup"><span data-stu-id="e7e0a-171">BCP_OPTION_LASTEX</span></span>|<span data-ttu-id="e7e0a-172">如果是 BCP Out 作業，則指定將資料庫資料表最後一個資料列複製到資料檔案中。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-172">For BCP out operations, specifies the last row of the database table to copy into the data file.</span></span><br /><br /> <span data-ttu-id="e7e0a-173">如果是 BCP In 作業，則指定將資料檔案的最後一個資料列複製到資料庫資料表中。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-173">For BCP in operations, specifies the last row of the data file to copy into the database table.</span></span><br /><br /> <span data-ttu-id="e7e0a-174">*iValue* 參數必須是包含值的 64 位元組帶正負號整數之位址。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-174">The *iValue* parameter is expected to be the address of a signed 64-bit integer that contains the value.</span></span> <span data-ttu-id="e7e0a-175">可傳遞至 BCPLASTEX 的最大值是 2^63-1。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-175">The maximum value that can be passed to BCPLASTEX is 2^63-1.</span></span>|  
|<span data-ttu-id="e7e0a-176">BCP_OPTION_MAXERRS</span><span class="sxs-lookup"><span data-stu-id="e7e0a-176">BCP_OPTION_MAXERRS</span></span>|<span data-ttu-id="e7e0a-177">在大量複製作業失敗之前，允許發生錯誤的數目。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-177">The number of errors allowed before the bulk copy operation fails.</span></span> <span data-ttu-id="e7e0a-178">預設值為 10。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-178">The default is 10.</span></span> <span data-ttu-id="e7e0a-179">小於 1 的值會將這個選項重設為預設。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-179">A value less than 1 resets this option to its default.</span></span> <span data-ttu-id="e7e0a-180">大量複製會限制 65,535 個錯誤的上限。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-180">Bulk copy imposes a maximum of 65,535 errors.</span></span> <span data-ttu-id="e7e0a-181">如果嘗試將這個選項設為大於 65,535 的值，則該選項會設定為 65,535。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-181">An attempt to set this option to a value larger than 65,535 results in the option being set to 65,535.</span></span>|  
|<span data-ttu-id="e7e0a-182">BCP_OPTION_ROWCOUNT</span><span class="sxs-lookup"><span data-stu-id="e7e0a-182">BCP_OPTION_ROWCOUNT</span></span>|<span data-ttu-id="e7e0a-183">傳回受到目前 (或最近) BCP 作業影響的資料列數目。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-183">Returns the number of rows affected by the current (or last) BCP operation.</span></span>|  
|<span data-ttu-id="e7e0a-184">BCP_OPTION_TEXTFILE</span><span class="sxs-lookup"><span data-stu-id="e7e0a-184">BCP_OPTION_TEXTFILE</span></span>|<span data-ttu-id="e7e0a-185">資料檔案不是二進位檔案，而是文字檔案</span><span class="sxs-lookup"><span data-stu-id="e7e0a-185">The data file is not a binary file, but is a text file.</span></span> <span data-ttu-id="e7e0a-186">BCP 會藉由檢查資料檔案中前 2 個位元組中的 Unicode 位元組標記，偵測文字檔案是否為 Unicode 檔案格式。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-186">BCP does the detection whether the text file is Unicode or not by checking the Unicode byte marker in the first 2 bytes of the data file.</span></span>|  
|<span data-ttu-id="e7e0a-187">BCP_OPTION_UNICODEFILE</span><span class="sxs-lookup"><span data-stu-id="e7e0a-187">BCP_OPTION_UNICODEFILE</span></span>|<span data-ttu-id="e7e0a-188">當設定為 TRUE 時，這個選項會指定輸入檔案為 Unicode 檔案格式。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-188">When set to TRUE, this option specifies that the input file is a Unicode file format.</span></span>|  
  
## <a name="arguments"></a><span data-ttu-id="e7e0a-189">引數</span><span class="sxs-lookup"><span data-stu-id="e7e0a-189">Arguments</span></span>  
 <span data-ttu-id="e7e0a-190">*eOption*[in]</span><span class="sxs-lookup"><span data-stu-id="e7e0a-190">*eOption*[in]</span></span>  
 <span data-ttu-id="e7e0a-191">設定為上面＜備註＞一節所列的其中一個選項。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-191">Set to one of the options listed in the remarks section above.</span></span>  
  
 <span data-ttu-id="e7e0a-192">*iValue*[in]</span><span class="sxs-lookup"><span data-stu-id="e7e0a-192">*iValue*[in]</span></span>  
 <span data-ttu-id="e7e0a-193">這是所指定 *eOption* 的值。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-193">The value for the specified *eOption*.</span></span> <span data-ttu-id="e7e0a-194">*iValue* 引數是轉換為 Void 指標的整數值，以允許日後擴充為 64 位元值。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-194">The *iValue* argument is an integer value cast to a void pointer to allow for future expansion to 64 bit values.</span></span>  
  
## <a name="return-code-values"></a><span data-ttu-id="e7e0a-195">傳回碼值</span><span class="sxs-lookup"><span data-stu-id="e7e0a-195">Return Code Values</span></span>  
 <span data-ttu-id="e7e0a-196">S_OK</span><span class="sxs-lookup"><span data-stu-id="e7e0a-196">S_OK</span></span>  
 <span data-ttu-id="e7e0a-197">此方法已成功。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-197">The method succeeded.</span></span>  
  
 <span data-ttu-id="e7e0a-198">E_FAIL</span><span class="sxs-lookup"><span data-stu-id="e7e0a-198">E_FAIL</span></span>  
 <span data-ttu-id="e7e0a-199">發生提供者特有的錯誤，如需詳細資訊，請使用 [ISQLServerErrorInfo](../../database-engine/dev-guide/isqlservererrorinfo-ole-db.md) 介面。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-199">A provider-specific error occurred; for detailed information, use the [ISQLServerErrorInfo](../../database-engine/dev-guide/isqlservererrorinfo-ole-db.md) interface.</span></span>  
  
 <span data-ttu-id="e7e0a-200">E_UNEXPECTED</span><span class="sxs-lookup"><span data-stu-id="e7e0a-200">E_UNEXPECTED</span></span>  
 <span data-ttu-id="e7e0a-201">此方法的呼叫是非預期的。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-201">The call to the method was unexpected.</span></span> <span data-ttu-id="e7e0a-202">例如，在呼叫這個函數之前，不會呼叫 [IBCPSession::BCPInit](ibcpsession-bcpinit-ole-db.md) 方法。</span><span class="sxs-lookup"><span data-stu-id="e7e0a-202">For example, the [IBCPSession::BCPInit](ibcpsession-bcpinit-ole-db.md) method was not called before calling this function.</span></span>  
  
 <span data-ttu-id="e7e0a-203">E_OUTOFMEMORY</span><span class="sxs-lookup"><span data-stu-id="e7e0a-203">E_OUTOFMEMORY</span></span>  
 <span data-ttu-id="e7e0a-204">記憶體不足錯誤</span><span class="sxs-lookup"><span data-stu-id="e7e0a-204">Out-of-memory error.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e7e0a-205">另請參閱</span><span class="sxs-lookup"><span data-stu-id="e7e0a-205">See Also</span></span>  
 <span data-ttu-id="e7e0a-206">[IBCPSession &#40;OLE DB&#41;](ibcpsession-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="e7e0a-206">[IBCPSession &#40;OLE DB&#41;](ibcpsession-ole-db.md) </span></span>  
 [<span data-ttu-id="e7e0a-207">執行大量複製作業</span><span class="sxs-lookup"><span data-stu-id="e7e0a-207">Performing Bulk Copy Operations</span></span>](../native-client/features/performing-bulk-copy-operations.md)  
  
  
