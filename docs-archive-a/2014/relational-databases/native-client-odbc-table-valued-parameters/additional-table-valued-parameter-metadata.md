---
title: 其他資料表值參數中繼資料 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), catalog functions to retrieve metadata
- table-valued parameters (ODBC), metadata
ms.assetid: 6c193188-5185-4373-9a0d-76cfc150c828
author: rothja
ms.author: jroth
ms.openlocfilehash: 9907b6bdbabcea427e5feffd14369e8aa718094f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87598864"
---
# <a name="additional-table-valued-parameter-metadata"></a><span data-ttu-id="ea205-102">其他資料表值參數中繼資料</span><span class="sxs-lookup"><span data-stu-id="ea205-102">Additional Table-Valued Parameter Metadata</span></span>
  <span data-ttu-id="ea205-103">為了取得資料表值參數的中繼資料，應用程式會呼叫 SQLProcedureColumns。</span><span class="sxs-lookup"><span data-stu-id="ea205-103">To retrieve metadata for a table-valued parameter, an application calls SQLProcedureColumns.</span></span> <span data-ttu-id="ea205-104">若為數據表值參數，SQLProcedureColumns 會傳回單一資料列。</span><span class="sxs-lookup"><span data-stu-id="ea205-104">For a table-valued parameter, SQLProcedureColumns returns a single row.</span></span> <span data-ttu-id="ea205-105">已加入兩個額外 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的特定資料行 SS_TYPE_CATALOG_NAME 和 SS_TYPE_SCHEMA_NAME，以提供與資料表值參數相關聯之資料表類型的架構和目錄資訊。</span><span class="sxs-lookup"><span data-stu-id="ea205-105">Two additional [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-specific columns, SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME, have been added to provide schema and catalog information for table types associated with table-valued parameters.</span></span> <span data-ttu-id="ea205-106">依照 ODBC 規格規定，SS_TYPE_CATALOG_NAME 和 SS_TYPE_SCHEMA_NAME 會出現在舊版 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 中所加入的所有驅動程式專用資料行之前，以及 ODBC 本身所託管的所有資料行之後。</span><span class="sxs-lookup"><span data-stu-id="ea205-106">In conformance with the ODBC specification, SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME appear before all driver-specific columns added in earlier versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], and after all columns mandated by ODBC itself.</span></span>  
  
 <span data-ttu-id="ea205-107">下表列出對於資料表值參數相當重要的資料行。</span><span class="sxs-lookup"><span data-stu-id="ea205-107">The following table lists columns that are significant for table-valued parameters.</span></span>  
  
|<span data-ttu-id="ea205-108">資料行名稱</span><span class="sxs-lookup"><span data-stu-id="ea205-108">Column name</span></span>|<span data-ttu-id="ea205-109">資料類型</span><span class="sxs-lookup"><span data-stu-id="ea205-109">Data type</span></span>|<span data-ttu-id="ea205-110">值/註解</span><span class="sxs-lookup"><span data-stu-id="ea205-110">Value/comments</span></span>|  
|-----------------|---------------|---------------------|  
|<span data-ttu-id="ea205-111">DATA_TYPE</span><span class="sxs-lookup"><span data-stu-id="ea205-111">DATA_TYPE</span></span>|<span data-ttu-id="ea205-112">Smallint 非 NULL</span><span class="sxs-lookup"><span data-stu-id="ea205-112">Smallint not NULL</span></span>|<span data-ttu-id="ea205-113">SQL_SS_TABLE</span><span class="sxs-lookup"><span data-stu-id="ea205-113">SQL_SS_TABLE</span></span>|  
|<span data-ttu-id="ea205-114">TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="ea205-114">TYPE_NAME</span></span>|<span data-ttu-id="ea205-115">WVarchar(128) 非 NULL</span><span class="sxs-lookup"><span data-stu-id="ea205-115">WVarchar(128) not NULL</span></span>|<span data-ttu-id="ea205-116">資料表值參數的類型名稱。</span><span class="sxs-lookup"><span data-stu-id="ea205-116">The type name of the table-valued parameter.</span></span>|  
|<span data-ttu-id="ea205-117">COLUMN_SIZE</span><span class="sxs-lookup"><span data-stu-id="ea205-117">COLUMN_SIZE</span></span>|<span data-ttu-id="ea205-118">整數</span><span class="sxs-lookup"><span data-stu-id="ea205-118">Integer</span></span>|<span data-ttu-id="ea205-119">NULL</span><span class="sxs-lookup"><span data-stu-id="ea205-119">NULL</span></span>|  
|<span data-ttu-id="ea205-120">BUFFER_LENGTH</span><span class="sxs-lookup"><span data-stu-id="ea205-120">BUFFER_LENGTH</span></span>|<span data-ttu-id="ea205-121">整數</span><span class="sxs-lookup"><span data-stu-id="ea205-121">Integer</span></span>|<span data-ttu-id="ea205-122">0</span><span class="sxs-lookup"><span data-stu-id="ea205-122">0</span></span>|  
|<span data-ttu-id="ea205-123">DECIMAL_DIGITS</span><span class="sxs-lookup"><span data-stu-id="ea205-123">DECIMAL_DIGITS</span></span>|<span data-ttu-id="ea205-124">Smallint</span><span class="sxs-lookup"><span data-stu-id="ea205-124">Smallint</span></span>|<span data-ttu-id="ea205-125">NULL</span><span class="sxs-lookup"><span data-stu-id="ea205-125">NULL</span></span>|  
|<span data-ttu-id="ea205-126">NUM_PREC_RADIX</span><span class="sxs-lookup"><span data-stu-id="ea205-126">NUM_PREC_RADIX</span></span>|<span data-ttu-id="ea205-127">Smallint</span><span class="sxs-lookup"><span data-stu-id="ea205-127">Smallint</span></span>|<span data-ttu-id="ea205-128">NULL</span><span class="sxs-lookup"><span data-stu-id="ea205-128">NULL</span></span>|  
|<span data-ttu-id="ea205-129">NULLABLE</span><span class="sxs-lookup"><span data-stu-id="ea205-129">NULLABLE</span></span>|<span data-ttu-id="ea205-130">Smallint 非 NULL</span><span class="sxs-lookup"><span data-stu-id="ea205-130">Smallint not NULL</span></span>|<span data-ttu-id="ea205-131">SQL_NULLABLE</span><span class="sxs-lookup"><span data-stu-id="ea205-131">SQL_NULLABLE</span></span>|  
|<span data-ttu-id="ea205-132">REMARKS</span><span class="sxs-lookup"><span data-stu-id="ea205-132">REMARKS</span></span>|<span data-ttu-id="ea205-133">Varchar</span><span class="sxs-lookup"><span data-stu-id="ea205-133">Varchar</span></span>|<span data-ttu-id="ea205-134">NULL</span><span class="sxs-lookup"><span data-stu-id="ea205-134">NULL</span></span>|  
|<span data-ttu-id="ea205-135">COLUMN_DEF</span><span class="sxs-lookup"><span data-stu-id="ea205-135">COLUMN_DEF</span></span>|<span data-ttu-id="ea205-136">WVarchar(4000)</span><span class="sxs-lookup"><span data-stu-id="ea205-136">WVarchar(4000)</span></span>|<span data-ttu-id="ea205-137">NULL</span><span class="sxs-lookup"><span data-stu-id="ea205-137">NULL</span></span>|  
|<span data-ttu-id="ea205-138">SQL_DATA_TYPE</span><span class="sxs-lookup"><span data-stu-id="ea205-138">SQL_DATA_TYPE</span></span>|<span data-ttu-id="ea205-139">Smallint 非 NULL</span><span class="sxs-lookup"><span data-stu-id="ea205-139">Smallint not NULL</span></span>|<span data-ttu-id="ea205-140">SQL_SS_TABLE</span><span class="sxs-lookup"><span data-stu-id="ea205-140">SQL_SS_TABLE</span></span>|  
|<span data-ttu-id="ea205-141">SQL_DATETIME_SUB</span><span class="sxs-lookup"><span data-stu-id="ea205-141">SQL_DATETIME_SUB</span></span>|<span data-ttu-id="ea205-142">Smallint</span><span class="sxs-lookup"><span data-stu-id="ea205-142">Smallint</span></span>|<span data-ttu-id="ea205-143">NULL</span><span class="sxs-lookup"><span data-stu-id="ea205-143">NULL</span></span>|  
|<span data-ttu-id="ea205-144">CHAR_OCTET_LENGTH</span><span class="sxs-lookup"><span data-stu-id="ea205-144">CHAR_OCTET_LENGTH</span></span>|<span data-ttu-id="ea205-145">整數</span><span class="sxs-lookup"><span data-stu-id="ea205-145">Integer</span></span>|<span data-ttu-id="ea205-146">NULL</span><span class="sxs-lookup"><span data-stu-id="ea205-146">NULL</span></span>|  
|<span data-ttu-id="ea205-147">ORDINAL_POSITION</span><span class="sxs-lookup"><span data-stu-id="ea205-147">ORDINAL_POSITION</span></span>|<span data-ttu-id="ea205-148">整數不是 NULL</span><span class="sxs-lookup"><span data-stu-id="ea205-148">Integer not NULL</span></span>|<span data-ttu-id="ea205-149">參數的序數位置。</span><span class="sxs-lookup"><span data-stu-id="ea205-149">The ordinal position of the parameter.</span></span>|  
|<span data-ttu-id="ea205-150">IS_NULLABLE</span><span class="sxs-lookup"><span data-stu-id="ea205-150">IS_NULLABLE</span></span>|<span data-ttu-id="ea205-151">Varchar</span><span class="sxs-lookup"><span data-stu-id="ea205-151">Varchar</span></span>|<span data-ttu-id="ea205-152">"YES"</span><span class="sxs-lookup"><span data-stu-id="ea205-152">"YES"</span></span>|  
|<span data-ttu-id="ea205-153">SS_TYPE_CATALOG_NAME</span><span class="sxs-lookup"><span data-stu-id="ea205-153">SS_TYPE_CATALOG_NAME</span></span>|<span data-ttu-id="ea205-154">WVarchar(128) 非 NULL</span><span class="sxs-lookup"><span data-stu-id="ea205-154">WVarchar(128) not NULL</span></span>|<span data-ttu-id="ea205-155">包含資料表值參數資料表類型之類型定義的目錄。</span><span class="sxs-lookup"><span data-stu-id="ea205-155">The catalog that contains the type definition for the table type of the table-valued parameter.</span></span>|  
|<span data-ttu-id="ea205-156">SS_TYPE_SCHEMA_NAME</span><span class="sxs-lookup"><span data-stu-id="ea205-156">SS_TYPE_SCHEMA_NAME</span></span>|<span data-ttu-id="ea205-157">WVarchar(128) 非 NULL</span><span class="sxs-lookup"><span data-stu-id="ea205-157">WVarchar(128) not NULL</span></span>|<span data-ttu-id="ea205-158">包含資料表值參數資料表類型之類型定義的結構描述。</span><span class="sxs-lookup"><span data-stu-id="ea205-158">The schema that contains the type definition for the table type of the table-valued parameter.</span></span>|  
  
 <span data-ttu-id="ea205-159">WVarchar 資料行在 ODBC 規格中定義為 Varchar，但是實際上在所有最新的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ODBC 驅動程式中會傳回為 Wvarchar。</span><span class="sxs-lookup"><span data-stu-id="ea205-159">The WVarchar columns are defined as Varchar in the ODBC specification, but are actually returned as WVarchar in all recent [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ODBC drivers.</span></span> <span data-ttu-id="ea205-160">當 Unicide 支援加入到 ODBC 3.5 規格，但是尚未明確呼叫時，會進行此變更。</span><span class="sxs-lookup"><span data-stu-id="ea205-160">This change was made when Unicide support was added to the ODBC 3.5 specification, but not called out explicitly.</span></span>  
  
 <span data-ttu-id="ea205-161">若要取得資料表值參數的其他中繼資料，應用程式會使用 SQLColumns 和 SQLPrimaryKeys 目錄函數。</span><span class="sxs-lookup"><span data-stu-id="ea205-161">To obtain additional metadata for table-valued parameters, an application uses the catalog functions SQLColumns and SQLPrimaryKeys.</span></span> <span data-ttu-id="ea205-162">針對資料表值參數呼叫這些函數之前，應用程式必須將陳述式屬性 SQL_SOPT_SS_NAME_SCOPE 設定為 SQL_SS_NAME_SCOPE_TABLE_TYPE。</span><span class="sxs-lookup"><span data-stu-id="ea205-162">Before these functions are called for table-valued parameters, the application must set the statement attribute SQL_SOPT_SS_NAME_SCOPE to SQL_SS_NAME_SCOPE_TABLE_TYPE.</span></span> <span data-ttu-id="ea205-163">此值表示應用程式需要資料表類型 (而非實際資料表) 的中繼資料。</span><span class="sxs-lookup"><span data-stu-id="ea205-163">This value indicates that the application requires metadata for a table type rather than an actual table.</span></span> <span data-ttu-id="ea205-164">然後，應用程式會傳遞資料表值參數的 TYPE_NAME 做為*TableName*參數。</span><span class="sxs-lookup"><span data-stu-id="ea205-164">The application then passes the TYPE_NAME of the table-valued parameter as the *TableName* parameter.</span></span> <span data-ttu-id="ea205-165">SS_TYPE_CATALOG_NAME 和 SS_TYPE_SCHEMA_NAME 分別與*CatalogName*和*SchemaName*參數搭配使用，以識別資料表值參數的目錄和架構。</span><span class="sxs-lookup"><span data-stu-id="ea205-165">SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME are used with the *CatalogName* and *SchemaName* parameters, respectively, to identify the catalog and schema for the table-valued parameter.</span></span> <span data-ttu-id="ea205-166">當應用程式完成擷取資料表值參數的中繼資料時，必須將 SQL_SOPT_SS_NAME_SCOPE 社回 SQL_SS_NAME_SCOPE_TABLE 的預設值。</span><span class="sxs-lookup"><span data-stu-id="ea205-166">When an application has finished retrieving metadata for table-valued parameters, it must set SQL_SOPT_SS_NAME_SCOPE back to its default value of SQL_SS_NAME_SCOPE_TABLE.</span></span>  
  
 <span data-ttu-id="ea205-167">當 SQL_SOPT_SS_NAME_SCOPE 設定為 SQL_SS_NAME_SCOPE_TABLE 時，連結伺服器的查詢會失敗。</span><span class="sxs-lookup"><span data-stu-id="ea205-167">When SQL_SOPT_SS_NAME_SCOPE is set to SQL_SS_NAME_SCOPE_TABLE, queries to linked servers fail.</span></span> <span data-ttu-id="ea205-168">使用包含伺服器元件的目錄呼叫 SQLColumns 或 SQLPrimaryKeys 將會失敗。</span><span class="sxs-lookup"><span data-stu-id="ea205-168">Calls to SQLColumns or SQLPrimaryKeys with a catalog that contains a server component will fail.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ea205-169">另請參閱</span><span class="sxs-lookup"><span data-stu-id="ea205-169">See Also</span></span>  
 [<span data-ttu-id="ea205-170">ODBC&#41;&#40;的資料表值參數</span><span class="sxs-lookup"><span data-stu-id="ea205-170">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
