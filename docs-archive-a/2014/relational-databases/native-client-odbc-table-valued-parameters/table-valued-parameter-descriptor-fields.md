---
title: 資料表值參數描述項欄位 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), descriptor fields
ms.assetid: 4e009eff-c156-4d63-abcf-082ddd304de2
author: rothja
ms.author: jroth
ms.openlocfilehash: 5365229aed0bc46315a7e6db5448bee6963b23fc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87698146"
---
# <a name="table-valued-parameter-descriptor-fields"></a><span data-ttu-id="5079a-102">資料表值參數描述項欄位</span><span class="sxs-lookup"><span data-stu-id="5079a-102">Table-Valued Parameter Descriptor Fields</span></span>
  <span data-ttu-id="5079a-103">資料表值參數的支援包含 ODBC 應用程式參數描述項 (APD) 和實作參數描述項 (IPD) 中新增的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 特定欄位。</span><span class="sxs-lookup"><span data-stu-id="5079a-103">Support for table-valued parameters includes new [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-specific fields in ODBC application parameter descriptors (APDs) and implementation parameter descriptors (IPDs).</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="5079a-104">備註</span><span class="sxs-lookup"><span data-stu-id="5079a-104">Remarks</span></span>  
  
|<span data-ttu-id="5079a-105">名稱</span><span class="sxs-lookup"><span data-stu-id="5079a-105">Name</span></span>|<span data-ttu-id="5079a-106">位置</span><span class="sxs-lookup"><span data-stu-id="5079a-106">Location</span></span>|<span data-ttu-id="5079a-107">類型</span><span class="sxs-lookup"><span data-stu-id="5079a-107">Type</span></span>|<span data-ttu-id="5079a-108">描述</span><span class="sxs-lookup"><span data-stu-id="5079a-108">Description</span></span>|  
|----------|--------------|----------|-----------------|  
|<span data-ttu-id="5079a-109">SQL_CA_SS_TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="5079a-109">SQL_CA_SS_TYPE_NAME</span></span>|<span data-ttu-id="5079a-110">IPD</span><span class="sxs-lookup"><span data-stu-id="5079a-110">IPD</span></span>|<span data-ttu-id="5079a-111">SQLTCHAR \*</span><span class="sxs-lookup"><span data-stu-id="5079a-111">SQLTCHAR\*</span></span>|<span data-ttu-id="5079a-112">資料表值參數的伺服器類型名稱。</span><span class="sxs-lookup"><span data-stu-id="5079a-112">The server type name of the table-valued parameter.</span></span><br /><br /> <span data-ttu-id="5079a-113">當資料表值參數類型名稱是在呼叫 SQLBindParameter 時指定時，一定要將它指定為 Unicode 值，即使在以 ANSI 應用程式形式建立的應用程式中也是如此。</span><span class="sxs-lookup"><span data-stu-id="5079a-113">When a table-valued parameter type name is specified on a call to SQLBindParameter, it must always be specified as a Unicode value, even in applications that are built as ANSI applications.</span></span> <span data-ttu-id="5079a-114">參數*StrLen_or_IndPtr*所使用的值應該是 SQL_NTS 或名稱的字串長度乘以 SIZEOF (WCHAR) 。</span><span class="sxs-lookup"><span data-stu-id="5079a-114">The value used for the parameter *StrLen_or_IndPtr* should be either SQL_NTS or the string length of the name multiplied by sizeof(WCHAR).</span></span><br /><br /> <span data-ttu-id="5079a-115">透過 SQLSetDescField 指定資料表值參數類型名稱時，可以使用符合應用程式建立方式的常值來指定。</span><span class="sxs-lookup"><span data-stu-id="5079a-115">When a table-valued parameter type name is specified via SQLSetDescField, it can be specified by using a literal that conforms to the way the application is built.</span></span> <span data-ttu-id="5079a-116">ODBC 驅動程式管理員將會執行所有必要的 Unicode 轉換。</span><span class="sxs-lookup"><span data-stu-id="5079a-116">The ODBC Driver Manager will perform any required Unicode conversion.</span></span>|  
|<span data-ttu-id="5079a-117">SQL_CA_SS_TYPE_CATALOG_NAME (唯讀)</span><span class="sxs-lookup"><span data-stu-id="5079a-117">SQL_CA_SS_TYPE_CATALOG_NAME (read only)</span></span>|<span data-ttu-id="5079a-118">IPD</span><span class="sxs-lookup"><span data-stu-id="5079a-118">IPD</span></span>|<span data-ttu-id="5079a-119">SQLTCHAR \*</span><span class="sxs-lookup"><span data-stu-id="5079a-119">SQLTCHAR\*</span></span>|<span data-ttu-id="5079a-120">類型定義所在的目錄。</span><span class="sxs-lookup"><span data-stu-id="5079a-120">The catalog where the type is defined.</span></span>|  
|<span data-ttu-id="5079a-121">SQL_CA_SS_TYPE_SCHEMA_NAME</span><span class="sxs-lookup"><span data-stu-id="5079a-121">SQL_CA_SS_TYPE_SCHEMA_NAME</span></span>|<span data-ttu-id="5079a-122">IPD</span><span class="sxs-lookup"><span data-stu-id="5079a-122">IPD</span></span>|<span data-ttu-id="5079a-123">SQLTCHAR \*</span><span class="sxs-lookup"><span data-stu-id="5079a-123">SQLTCHAR\*</span></span>|<span data-ttu-id="5079a-124">類型定義所在的結構描述。</span><span class="sxs-lookup"><span data-stu-id="5079a-124">The schema where the type is defined.</span></span>|  
  
 <span data-ttu-id="5079a-125">應用程式不得針對資料表值參數設定 SQL_CA_SS_TYPE_CATALOG_NAME。</span><span class="sxs-lookup"><span data-stu-id="5079a-125">Applications must not set SQL_CA_SS_TYPE_CATALOG_NAME for table-valued parameters.</span></span> <span data-ttu-id="5079a-126">這麼做會傳回 SQL_ERROR，而且會記錄具有 SQLSTATE=HY091 和「無效的描述項欄位識別碼」訊息的診斷記錄。</span><span class="sxs-lookup"><span data-stu-id="5079a-126">Doing so will return a SQL_ERROR and log a diagnostic record with SQLSTATE = HY091 and the message "Invalid descriptor field identifier".</span></span>  
  
 <span data-ttu-id="5079a-127">當參數焦點設定為資料表值參數時，資料表值參數適用下列的陳述式屬性和描述項標頭欄位：</span><span class="sxs-lookup"><span data-stu-id="5079a-127">The following statement attributes and descriptor header fields apply to table-valued parameters when the parameter focus is set to a table-valued parameter:</span></span>  
  
|<span data-ttu-id="5079a-128">名稱</span><span class="sxs-lookup"><span data-stu-id="5079a-128">Name</span></span>|<span data-ttu-id="5079a-129">位置</span><span class="sxs-lookup"><span data-stu-id="5079a-129">Location</span></span>|<span data-ttu-id="5079a-130">類型</span><span class="sxs-lookup"><span data-stu-id="5079a-130">Type</span></span>|<span data-ttu-id="5079a-131">描述</span><span class="sxs-lookup"><span data-stu-id="5079a-131">Description</span></span>|  
|----------|--------------|----------|-----------------|  
|<span data-ttu-id="5079a-132">SQL_ATTR_PARAMSET_SIZE</span><span class="sxs-lookup"><span data-stu-id="5079a-132">SQL_ATTR_PARAMSET_SIZE</span></span><br /><br /> <span data-ttu-id="5079a-133">(這相當於在 APD 中的 SQL_DESC_ARRAY_SIZE)。</span><span class="sxs-lookup"><span data-stu-id="5079a-133">(This is equivalent to SQL_DESC_ARRAY_SIZE in the APD.)</span></span>|<span data-ttu-id="5079a-134">APD</span><span class="sxs-lookup"><span data-stu-id="5079a-134">APD</span></span>|<span data-ttu-id="5079a-135">SQLUINTEGER</span><span class="sxs-lookup"><span data-stu-id="5079a-135">SQLUINTEGER</span></span>|<span data-ttu-id="5079a-136">資料表值參數的緩衝區陣列的陣列大小。</span><span class="sxs-lookup"><span data-stu-id="5079a-136">The array size of the buffer arrays for a table-valued parameter.</span></span> <span data-ttu-id="5079a-137">這是緩衝區可容納的最大資料列數目，或者以資料列表示的緩衝區大小；資料表值參數值本身的資料列可能多於或少於緩衝區所能保存的資料列。</span><span class="sxs-lookup"><span data-stu-id="5079a-137">This is the maximum number of rows the buffers will accommodate or the size of the buffers in rows; the table-valued parameter value itself might have more or fewer rows than the buffers can hold.</span></span> <span data-ttu-id="5079a-138">預設值為 1。</span><span class="sxs-lookup"><span data-stu-id="5079a-138">Default is 1.</span></span> <span data-ttu-id="5079a-139">**注意：** 如果 SQL_SOPT_SS_PARAM_FOCUS 設定為預設值0，SQL_ATTR_PARAMSET_SIZE 會參考語句並指定參數集的數目。</span><span class="sxs-lookup"><span data-stu-id="5079a-139">**Note:**  If SQL_SOPT_SS_PARAM_FOCUS is set to its default value of 0, SQL_ATTR_PARAMSET_SIZE refers to the statement and specifies the number of parameter sets.</span></span> <span data-ttu-id="5079a-140">如果 SQL_SOPT_SS_PARAM_FOCUS 設定為資料表值參數的序數，則它會參考資料表值參數並針對資料表值參數而指定每個參數集的資料列數。</span><span class="sxs-lookup"><span data-stu-id="5079a-140">If SQL_SOPT_SS_PARAM_FOCUS is set to the ordinal of a table-valued parameter, it refers to the table-valued parameter and specifies the number of rows per parameter set for the table-valued parameter.</span></span>|  
|<span data-ttu-id="5079a-141">SQL_ATTR_PARAM _BIND_TYPE</span><span class="sxs-lookup"><span data-stu-id="5079a-141">SQL_ATTR_PARAM _BIND_TYPE</span></span>|<span data-ttu-id="5079a-142">APD</span><span class="sxs-lookup"><span data-stu-id="5079a-142">APD</span></span>|<span data-ttu-id="5079a-143">SQLINTEGER</span><span class="sxs-lookup"><span data-stu-id="5079a-143">SQLINTEGER</span></span>|<span data-ttu-id="5079a-144">預設值為 SQL_PARAM_BIND_BY_COLUMN。</span><span class="sxs-lookup"><span data-stu-id="5079a-144">The default is SQL_PARAM_BIND_BY_COLUMN.</span></span><br /><br /> <span data-ttu-id="5079a-145">若要選取資料列繫結，這個欄位會設定為會繫結到資料表值參數資料列集之結構或緩衝區執行個體的長度。</span><span class="sxs-lookup"><span data-stu-id="5079a-145">To select row-wise binding, this field is set to the length of the structure or an instance of a buffer that will be bound to a set of table-valued parameter rows.</span></span> <span data-ttu-id="5079a-146">這個長度會包含所有繫結資料行以及結構或緩衝區之任何填補的空間。</span><span class="sxs-lookup"><span data-stu-id="5079a-146">This length must include space for all of the bound columns and any padding of the structure or buffer.</span></span> <span data-ttu-id="5079a-147">如此可確保在使用指定長度遞增繫結資料行的位址時，結果會指向下一個資料列中相同資料行的起始處。</span><span class="sxs-lookup"><span data-stu-id="5079a-147">This ensures that when the address of a bound column is incremented with the specified length, the result will point to the beginning of the same column in the next row.</span></span> <span data-ttu-id="5079a-148">在 ANSI C 中使用 `sizeof` 運算子時，可保證此項行為。</span><span class="sxs-lookup"><span data-stu-id="5079a-148">When using the `sizeof` operator in ANSI C, this behavior is guaranteed.</span></span>|  
|<span data-ttu-id="5079a-149">SQL_ATTR_PARAM_BIND_OFFSET_PTR</span><span class="sxs-lookup"><span data-stu-id="5079a-149">SQL_ATTR_PARAM_BIND_OFFSET_PTR</span></span>|<span data-ttu-id="5079a-150">APD</span><span class="sxs-lookup"><span data-stu-id="5079a-150">APD</span></span>|<span data-ttu-id="5079a-151">SQLINTEGER\*</span><span class="sxs-lookup"><span data-stu-id="5079a-151">SQLINTEGER\*</span></span>|<span data-ttu-id="5079a-152">預設值為 Null 指標。</span><span class="sxs-lookup"><span data-stu-id="5079a-152">The default is a null pointer.</span></span><br /><br /> <span data-ttu-id="5079a-153">如果此欄位非 Null，則驅動程式會取消指標的參考、將取消參考的值加入至描述項記錄中的每個延遲欄位 (SQL_DESC_DATA_PTR、SQL_DESC_INDICATOR_PTR 和 SQL_DESC_OCTET_LENGTH_PTR)，然後使用新的指標值來存取資料值。</span><span class="sxs-lookup"><span data-stu-id="5079a-153">If this field is non-null, the driver dereferences the pointer, adds the dereferenced value to each of the deferred fields in the descriptor record (SQL_DESC_DATA_PTR, SQL_DESC_INDICATOR_PTR, and SQL_DESC_OCTET_LENGTH_PTR), and uses the new pointer values to access data values.</span></span>|  
  
 <span data-ttu-id="5079a-154">這些欄位只有在使用資料表值參數時才有效，其他的資料類型會加以忽略。</span><span class="sxs-lookup"><span data-stu-id="5079a-154">These fields are only valid with table-valued parameters, and are ignored for other data types.</span></span>  
  
 <span data-ttu-id="5079a-155">SQL_CA_SS_TYPE_NAME 對預存程序呼叫而言是選擇性的。</span><span class="sxs-lookup"><span data-stu-id="5079a-155">SQL_CA_SS_TYPE_NAME is optional for stored procedure calls.</span></span> <span data-ttu-id="5079a-156">必須針對不是程序呼叫的 SQL 陳述式指定這個欄位，才能讓伺服器判斷資料表值參數的類型。</span><span class="sxs-lookup"><span data-stu-id="5079a-156">It must be specified for SQL statements that are not procedure calls to enable the server to determine the type of the table-valued parameter.</span></span>  
  
 <span data-ttu-id="5079a-157">如果需要類型名稱，且資料表值參數的資料表類型是定義於預存程序以外的結構描述中，則必須在實作參數描述項 (IPD) 中指定 SQL_CA_SS_TYPE_SCHEMA_NAME。</span><span class="sxs-lookup"><span data-stu-id="5079a-157">If the type name is reqired and the table type for the table-valued parameter is defined in a different schema than the stored procedure, SQL_CA_SS_TYPE_SCHEMA_NAME must be specified in the implementation parameter descriptor (IPD).</span></span> <span data-ttu-id="5079a-158">如果沒有指定，伺服器將無法判斷資料表值參數的類型。</span><span class="sxs-lookup"><span data-stu-id="5079a-158">If not, the server will not be able to determine the type of the table-valued parameter.</span></span> <span data-ttu-id="5079a-159">當您呼叫 SQLExecute 或 SQLExecDirect 時，這會導致錯誤。</span><span class="sxs-lookup"><span data-stu-id="5079a-159">This will result in an error when you call SQLExecute or SQLExecDirect.</span></span> <span data-ttu-id="5079a-160">錯誤將具有 SQLSTATE= 07006 和訊息「限制的資料類型屬性違規」。</span><span class="sxs-lookup"><span data-stu-id="5079a-160">The error will have SQLSTATE= 07006 and the message "Restricted data type attribute violation".</span></span>  
  
 <span data-ttu-id="5079a-161">資料表值參數資料行可以使用資料列繫結或資料行繫結。</span><span class="sxs-lookup"><span data-stu-id="5079a-161">Table-valued parameter columns can use either row-wise or column-wise binding.</span></span> <span data-ttu-id="5079a-162">預設為資料行繫結。</span><span class="sxs-lookup"><span data-stu-id="5079a-162">The default is column-wise binding.</span></span> <span data-ttu-id="5079a-163">資料列繫結可以藉由設定 SQL_ATTR_PARAM_BIND_TYPE 和 SQL_ATTR_ PARAM_BIND_OFFSET_PTR 來指定。</span><span class="sxs-lookup"><span data-stu-id="5079a-163">Row-wise binding can be specified by setting SQL_ATTR_PARAM_BIND_TYPE and SQL_ATTR_ PARAM_BIND_OFFSET_PTR.</span></span> <span data-ttu-id="5079a-164">這與資料行和參數的資料列繫結類似。</span><span class="sxs-lookup"><span data-stu-id="5079a-164">This is analogous to row-wise binding of columns and parameters.</span></span>  
  
 <span data-ttu-id="5079a-165">SQL_CA_SS_TYPE_CATALOG_NAME 和 SQL_CA_SS_TYPE_SCHEMA_NAME 也可以用來擷取與 CLR 使用者定義型別參數相關聯的目錄和結構描述。</span><span class="sxs-lookup"><span data-stu-id="5079a-165">SQL_CA_SS_TYPE_CATALOG_NAME and SQL_CA_SS_TYPE_SCHEMA_NAME can also be used to retrieve the catalog and schema associated with CLR user-defined type parameters.</span></span> <span data-ttu-id="5079a-166">這些欄位是這些類型現有之類型特定目錄結構描述屬性的替代項目。</span><span class="sxs-lookup"><span data-stu-id="5079a-166">These are alternatives to the existing type specific catalog schema attributes for these types.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5079a-167">另請參閱</span><span class="sxs-lookup"><span data-stu-id="5079a-167">See Also</span></span>  
 [<span data-ttu-id="5079a-168">ODBC&#41;&#40;的資料表值參數</span><span class="sxs-lookup"><span data-stu-id="5079a-168">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
