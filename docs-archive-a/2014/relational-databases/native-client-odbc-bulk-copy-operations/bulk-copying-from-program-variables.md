---
title: 從程式變數大量複製 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- bulk copy [ODBC], program variables
- bcp_bind function
- mapping data types [ODBC]
- SQL Server Native Client ODBC driver, bulk copy
- data types [ODBC], bulk copying
- ODBC, bulk copy operations
- program variables [ODBC]
ms.assetid: e4284a1b-7534-4b34-8488-b8d05ed67b8c
author: rothja
ms.author: jroth
ms.openlocfilehash: 5a50e8e104d63c63138a1ae14e27104181e6d9fd
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87606830"
---
# <a name="bulk-copying-from-program-variables"></a><span data-ttu-id="455f0-102">從程式變數中大量複製</span><span class="sxs-lookup"><span data-stu-id="455f0-102">Bulk Copying from Program Variables</span></span>
  <span data-ttu-id="455f0-103">您可以直接從程式變數大量複製。</span><span class="sxs-lookup"><span data-stu-id="455f0-103">You can bulk copy directly from program variables.</span></span> <span data-ttu-id="455f0-104">在配置變數來保存資料列的資料及呼叫 [bcp_init](../native-client-odbc-extensions-bulk-copy-functions/bcp-init.md) 開始大量複製之後，請針對每一個資料行呼叫 [bcp_bind](../native-client-odbc-extensions-bulk-copy-functions/bcp-bind.md) ，以指定要與此資料行產生關聯之程式變數的位置與格式。</span><span class="sxs-lookup"><span data-stu-id="455f0-104">After allocating variables to hold the data for a row and calling [bcp_init](../native-client-odbc-extensions-bulk-copy-functions/bcp-init.md) to start the bulk copy, call [bcp_bind](../native-client-odbc-extensions-bulk-copy-functions/bcp-bind.md) for each column to specify the location and format of the program variable to be associated with the column.</span></span> <span data-ttu-id="455f0-105">然後針對每一個包含資料的變數，呼叫 [bcp_sendrow](../native-client-odbc-extensions-bulk-copy-functions/bcp-sendrow.md) 將一個資料列傳送給伺服器。</span><span class="sxs-lookup"><span data-stu-id="455f0-105">Fill each variable with data, then call [bcp_sendrow](../native-client-odbc-extensions-bulk-copy-functions/bcp-sendrow.md) to send one row of data to the server.</span></span> <span data-ttu-id="455f0-106">重複填入變數及呼叫 **bcp_sendrow** 的程序，直到所有資料列都已傳送給伺服器為止，然後呼叫 [bcp_done](../native-client-odbc-extensions-bulk-copy-functions/bcp-done.md) 來指定此作業已完成。</span><span class="sxs-lookup"><span data-stu-id="455f0-106">Repeat the process of filling the variables and calling **bcp_sendrow** until all the rows have been sent to the server, then call [bcp_done](../native-client-odbc-extensions-bulk-copy-functions/bcp-done.md) to specify that the operation is complete.</span></span>  
  
 <span data-ttu-id="455f0-107">**bcp_bind**_pData_ 參數包含了繫結至資料行之變數的位址。</span><span class="sxs-lookup"><span data-stu-id="455f0-107">The **bcp_bind**_pData_ parameter contains the address of the variable being bound to the column.</span></span> <span data-ttu-id="455f0-108">每一個資料行的資料都可以透過以下兩種方式的其中一種來儲存：</span><span class="sxs-lookup"><span data-stu-id="455f0-108">The data for each column can be stored in one of two ways:</span></span>  
  
-   <span data-ttu-id="455f0-109">配置一個變數來保存資料。</span><span class="sxs-lookup"><span data-stu-id="455f0-109">Allocate one variable to hold the data.</span></span>  
  
-   <span data-ttu-id="455f0-110">配置指標變數，後面緊接著資料變數。</span><span class="sxs-lookup"><span data-stu-id="455f0-110">Allocate an indicator variable followed immediately by the data variable.</span></span>  
  
 <span data-ttu-id="455f0-111">此指標變數指出變動長度資料行之資料的長度，也會在此資料行允許 NULL 時指出 NULL 值。</span><span class="sxs-lookup"><span data-stu-id="455f0-111">The indicator variable indicates the length of the data for variable-length columns, and also indicates NULL values if the column allows NULLs.</span></span> <span data-ttu-id="455f0-112">如果只使用資料變數，則會將這個變數的位址儲存在 **bcp_bind**_pData_ 參數中。</span><span class="sxs-lookup"><span data-stu-id="455f0-112">If only a data variable is used, then the address of this variable is stored in the **bcp_bind**_pData_ parameter.</span></span> <span data-ttu-id="455f0-113">如果使用了指標變數，則會將這個指標變數的位址儲存在 **bcp_bind**_pData_ 參數中。</span><span class="sxs-lookup"><span data-stu-id="455f0-113">If an indicator variable is used, the address of the indicator variable is stored in the **bcp_bind**_pData_ parameter.</span></span> <span data-ttu-id="455f0-114">大量複製函數會計算此資料變數的位置，其方式是加入 **bcp_bind**_cbIndicator_ 和 *pData* 參數。</span><span class="sxs-lookup"><span data-stu-id="455f0-114">The bulk copy functions calculate the location of the data variable by adding the **bcp_bind**_cbIndicator_ and *pData* parameters.</span></span>  
  
 <span data-ttu-id="455f0-115">**bcp_bind** 可支援用來處理變動長度資料的三個方法：</span><span class="sxs-lookup"><span data-stu-id="455f0-115">**bcp_bind** supports three methods for dealing with variable-length data:</span></span>  
  
-   <span data-ttu-id="455f0-116">只搭配資料變數使用 *cbData* 。</span><span class="sxs-lookup"><span data-stu-id="455f0-116">Use *cbData* with only a data variable.</span></span> <span data-ttu-id="455f0-117">將資料的長度放在 *cbData*中。</span><span class="sxs-lookup"><span data-stu-id="455f0-117">Place the length of the data in *cbData*.</span></span> <span data-ttu-id="455f0-118">每次要大量複製的資料長度變更時，請呼叫[bcp_collen](../native-client-odbc-extensions-bulk-copy-functions/bcp-collen.md)以重設*cbData*。</span><span class="sxs-lookup"><span data-stu-id="455f0-118">Each time the length of the data to be bulk copied changes, call [bcp_collen](../native-client-odbc-extensions-bulk-copy-functions/bcp-collen.md)to reset *cbData*.</span></span> <span data-ttu-id="455f0-119">如果使用了其他兩個方法的其中一種，請針對 *cbData*指定 SQL_VARLEN_DATA。</span><span class="sxs-lookup"><span data-stu-id="455f0-119">If one of the other two methods is being used, specify SQL_VARLEN_DATA for *cbData*.</span></span> <span data-ttu-id="455f0-120">如果為資料行提供的所有資料值都是 NULL，請針對 *cbData*指定 SQL_NULL_DATA。</span><span class="sxs-lookup"><span data-stu-id="455f0-120">If all the data values being supplied for a column are NULL, specify SQL_NULL_DATA for *cbData*.</span></span>  
  
-   <span data-ttu-id="455f0-121">使用指標變數。</span><span class="sxs-lookup"><span data-stu-id="455f0-121">Use indicator variables.</span></span> <span data-ttu-id="455f0-122">當每一個新的資料值移到資料變數內時，請將該值的長度儲存在指標變數中。</span><span class="sxs-lookup"><span data-stu-id="455f0-122">As each new data value is moved into the data variable, store the length of the value in the indicator variable.</span></span> <span data-ttu-id="455f0-123">如果使用了其他兩個方法的其中一種，請針對 *cbIndicator*指定 0。</span><span class="sxs-lookup"><span data-stu-id="455f0-123">If one of the other two methods is being used, specify 0 for *cbIndicator*.</span></span>  
  
-   <span data-ttu-id="455f0-124">使用結束字元指標。</span><span class="sxs-lookup"><span data-stu-id="455f0-124">Use terminator pointers.</span></span> <span data-ttu-id="455f0-125">使用可結束資料之位元模式的位址來尋找 **bcp_bind**_pTerm_ 參數。</span><span class="sxs-lookup"><span data-stu-id="455f0-125">Load the **bcp_bind**_pTerm_ parameter with the address of the bit pattern that terminates the data.</span></span> <span data-ttu-id="455f0-126">如果使用了其他兩個方法的其中一種，請針對 *pTerm*指定 NULL。</span><span class="sxs-lookup"><span data-stu-id="455f0-126">If one of the other two methods is being used, specify NULL for *pTerm*.</span></span>  
  
 <span data-ttu-id="455f0-127">這三種方法全都可以在相同的 **bcp_bind** 呼叫上使用，在此情況下會使用產生最少量複製資料的規格。</span><span class="sxs-lookup"><span data-stu-id="455f0-127">All three of these methods can be used on the same **bcp_bind** call, in which case the specification that results in the smallest amount of data being copied is used.</span></span>  
  
 <span data-ttu-id="455f0-128">**bcp_bind**_type_ 參數會使用 DB-Library 資料類型識別碼，而不是 ODBC 資料類型識別碼。</span><span class="sxs-lookup"><span data-stu-id="455f0-128">The **bcp_bind**_type_ parameter uses DB-Library data type identifiers, not ODBC data type identifiers.</span></span> <span data-ttu-id="455f0-129">DB-Library 資料類型識別碼定義在 sqlncli.h 中，可搭配 ODBC **bcp_bind** 函數使用。</span><span class="sxs-lookup"><span data-stu-id="455f0-129">DB-Library data type identifiers are defined in sqlncli.h for use with the ODBC **bcp_bind** function.</span></span>  
  
 <span data-ttu-id="455f0-130">大量複製函數並非所有 ODBC C 資料類型都有支援。</span><span class="sxs-lookup"><span data-stu-id="455f0-130">Bulk copy functions do not support all ODBC C data types.</span></span> <span data-ttu-id="455f0-131">例如，大量複製函數不支援 ODBC SQL_C_TYPE_TIMESTAMP 結構，所以請使用 [SQLBindCol](../native-client-odbc-api/sqlbindcol.md) 或 [SQLGetData](../native-client-odbc-api/sqlgetdata.md) 將 ODBC SQL_TYPE_TIMESTAMP 資料轉換成 SQL_C_CHAR 變數。</span><span class="sxs-lookup"><span data-stu-id="455f0-131">For example, the bulk copy functions do not support the ODBC SQL_C_TYPE_TIMESTAMP structure, so use [SQLBindCol](../native-client-odbc-api/sqlbindcol.md) or [SQLGetData](../native-client-odbc-api/sqlgetdata.md) to convert ODBC SQL_TYPE_TIMESTAMP data to a SQL_C_CHAR variable.</span></span> <span data-ttu-id="455f0-132">如果您之後搭配 SQLCHARACTER 的 **bcp_bind** 參數使用 *bcp_bind* ，將此變數繫結至 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **datetime** 資料行，則大量複製函數會將字元變數中的時間戳記逸出子句轉換成適當的日期時間格式。</span><span class="sxs-lookup"><span data-stu-id="455f0-132">If you then use **bcp_bind** with a *type* parameter of SQLCHARACTER to bind the variable to a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **datetime** column, the bulk copy functions convert the timestamp escape clause in the character variable to the proper datetime format.</span></span>  
  
 <span data-ttu-id="455f0-133">下表列出當從 ODBC SQL 資料類型對應至 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資料類型時所建議使用的資料類型。</span><span class="sxs-lookup"><span data-stu-id="455f0-133">The following table lists the recommended data types to use in mapping from an ODBC SQL data type to a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type.</span></span>  
  
|<span data-ttu-id="455f0-134">ODBC SQL 資料類型</span><span class="sxs-lookup"><span data-stu-id="455f0-134">ODBC SQLdata type</span></span>|<span data-ttu-id="455f0-135">ODBC C 資料類型</span><span class="sxs-lookup"><span data-stu-id="455f0-135">ODBC C data type</span></span>|<span data-ttu-id="455f0-136">bcp_bind *type* 參數</span><span class="sxs-lookup"><span data-stu-id="455f0-136">bcp_bind *type* parameter</span></span>|<span data-ttu-id="455f0-137">SQL Server 資料類型</span><span class="sxs-lookup"><span data-stu-id="455f0-137">SQL Server data type</span></span>|  
|-----------------------|----------------------|--------------------------------|--------------------------|  
|<span data-ttu-id="455f0-138">SQL_CHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-138">SQL_CHAR</span></span>|<span data-ttu-id="455f0-139">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-139">SQL_C_CHAR</span></span>|<span data-ttu-id="455f0-140">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="455f0-140">SQLCHARACTER</span></span>|<span data-ttu-id="455f0-141">**字母**</span><span class="sxs-lookup"><span data-stu-id="455f0-141">**character**</span></span><br /><br /> <span data-ttu-id="455f0-142">**char**</span><span class="sxs-lookup"><span data-stu-id="455f0-142">**char**</span></span>|  
|<span data-ttu-id="455f0-143">SQL_VARCHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-143">SQL_VARCHAR</span></span>|<span data-ttu-id="455f0-144">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-144">SQL_C_CHAR</span></span>|<span data-ttu-id="455f0-145">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="455f0-145">SQLCHARACTER</span></span>|<span data-ttu-id="455f0-146">**varchar**</span><span class="sxs-lookup"><span data-stu-id="455f0-146">**varchar**</span></span><br /><br /> <span data-ttu-id="455f0-147">**character varying**</span><span class="sxs-lookup"><span data-stu-id="455f0-147">**character varying**</span></span><br /><br /> <span data-ttu-id="455f0-148">**char varying**</span><span class="sxs-lookup"><span data-stu-id="455f0-148">**char varying**</span></span><br /><br /> <span data-ttu-id="455f0-149">**sysname**</span><span class="sxs-lookup"><span data-stu-id="455f0-149">**sysname**</span></span>|  
|<span data-ttu-id="455f0-150">SQL_LONGVARCHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-150">SQL_LONGVARCHAR</span></span>|<span data-ttu-id="455f0-151">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-151">SQL_C_CHAR</span></span>|<span data-ttu-id="455f0-152">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="455f0-152">SQLCHARACTER</span></span>|<span data-ttu-id="455f0-153">**text**</span><span class="sxs-lookup"><span data-stu-id="455f0-153">**text**</span></span>|  
|<span data-ttu-id="455f0-154">SQL_WCHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-154">SQL_WCHAR</span></span>|<span data-ttu-id="455f0-155">SQL_C_WCHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-155">SQL_C_WCHAR</span></span>|<span data-ttu-id="455f0-156">SQLNCHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-156">SQLNCHAR</span></span>|<span data-ttu-id="455f0-157">**nchar**</span><span class="sxs-lookup"><span data-stu-id="455f0-157">**nchar**</span></span>|  
|<span data-ttu-id="455f0-158">SQL_WVARCHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-158">SQL_WVARCHAR</span></span>|<span data-ttu-id="455f0-159">SQL_C_WCHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-159">SQL_C_WCHAR</span></span>|<span data-ttu-id="455f0-160">SQLNVARCHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-160">SQLNVARCHAR</span></span>|<span data-ttu-id="455f0-161">**nvarchar**</span><span class="sxs-lookup"><span data-stu-id="455f0-161">**nvarchar**</span></span>|  
|<span data-ttu-id="455f0-162">SQL_WLONGVARCHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-162">SQL_WLONGVARCHAR</span></span>|<span data-ttu-id="455f0-163">SQL_C_WCHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-163">SQL_C_WCHAR</span></span>|<span data-ttu-id="455f0-164">SQLNTEXT</span><span class="sxs-lookup"><span data-stu-id="455f0-164">SQLNTEXT</span></span>|<span data-ttu-id="455f0-165">**ntext**</span><span class="sxs-lookup"><span data-stu-id="455f0-165">**ntext**</span></span>|  
|<span data-ttu-id="455f0-166">SQL_DECIMAL</span><span class="sxs-lookup"><span data-stu-id="455f0-166">SQL_DECIMAL</span></span>|<span data-ttu-id="455f0-167">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-167">SQL_C_CHAR</span></span>|<span data-ttu-id="455f0-168">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="455f0-168">SQLCHARACTER</span></span>|<span data-ttu-id="455f0-169">**decimal**</span><span class="sxs-lookup"><span data-stu-id="455f0-169">**decimal**</span></span><br /><br /> <span data-ttu-id="455f0-170">**十進位**</span><span class="sxs-lookup"><span data-stu-id="455f0-170">**dec**</span></span><br /><br /> <span data-ttu-id="455f0-171">**money**</span><span class="sxs-lookup"><span data-stu-id="455f0-171">**money**</span></span><br /><br /> <span data-ttu-id="455f0-172">**smallmoney**</span><span class="sxs-lookup"><span data-stu-id="455f0-172">**smallmoney**</span></span>|  
|<span data-ttu-id="455f0-173">SQL_NUMERIC</span><span class="sxs-lookup"><span data-stu-id="455f0-173">SQL_NUMERIC</span></span>|<span data-ttu-id="455f0-174">SQL_C_NUMERIC</span><span class="sxs-lookup"><span data-stu-id="455f0-174">SQL_C_NUMERIC</span></span>|<span data-ttu-id="455f0-175">SQLNUMERICN</span><span class="sxs-lookup"><span data-stu-id="455f0-175">SQLNUMERICN</span></span>|<span data-ttu-id="455f0-176">**numeric**</span><span class="sxs-lookup"><span data-stu-id="455f0-176">**numeric**</span></span>|  
|<span data-ttu-id="455f0-177">SQL_BIT</span><span class="sxs-lookup"><span data-stu-id="455f0-177">SQL_BIT</span></span>|<span data-ttu-id="455f0-178">SQL_C_BIT</span><span class="sxs-lookup"><span data-stu-id="455f0-178">SQL_C_BIT</span></span>|<span data-ttu-id="455f0-179">SQLBIT</span><span class="sxs-lookup"><span data-stu-id="455f0-179">SQLBIT</span></span>|<span data-ttu-id="455f0-180">**bit**</span><span class="sxs-lookup"><span data-stu-id="455f0-180">**bit**</span></span>|  
|<span data-ttu-id="455f0-181">SQL_TINYINT (帶正負號)</span><span class="sxs-lookup"><span data-stu-id="455f0-181">SQL_TINYINT (signed)</span></span>|<span data-ttu-id="455f0-182">SQL_C_SSHORT</span><span class="sxs-lookup"><span data-stu-id="455f0-182">SQL_C_SSHORT</span></span>|<span data-ttu-id="455f0-183">SQLINT2</span><span class="sxs-lookup"><span data-stu-id="455f0-183">SQLINT2</span></span>|<span data-ttu-id="455f0-184">**smallint**</span><span class="sxs-lookup"><span data-stu-id="455f0-184">**smallint**</span></span>|  
|<span data-ttu-id="455f0-185">SQL_TINYINT (不帶正負號)</span><span class="sxs-lookup"><span data-stu-id="455f0-185">SQL_TINYINT (unsigned)</span></span>|<span data-ttu-id="455f0-186">SQL_C_UTINYINT</span><span class="sxs-lookup"><span data-stu-id="455f0-186">SQL_C_UTINYINT</span></span>|<span data-ttu-id="455f0-187">SQLINT1</span><span class="sxs-lookup"><span data-stu-id="455f0-187">SQLINT1</span></span>|<span data-ttu-id="455f0-188">**tinyint**</span><span class="sxs-lookup"><span data-stu-id="455f0-188">**tinyint**</span></span>|  
|<span data-ttu-id="455f0-189">SQL_SMALL_INT (帶正負號)</span><span class="sxs-lookup"><span data-stu-id="455f0-189">SQL_SMALL_INT (signed)</span></span>|<span data-ttu-id="455f0-190">SQL_C_SSHORT</span><span class="sxs-lookup"><span data-stu-id="455f0-190">SQL_C_SSHORT</span></span>|<span data-ttu-id="455f0-191">SQLINT2</span><span class="sxs-lookup"><span data-stu-id="455f0-191">SQLINT2</span></span>|<span data-ttu-id="455f0-192">**smallint**</span><span class="sxs-lookup"><span data-stu-id="455f0-192">**smallint**</span></span>|  
|<span data-ttu-id="455f0-193">SQL_SMALL_INT (不帶正負號)</span><span class="sxs-lookup"><span data-stu-id="455f0-193">SQL_SMALL_INT (unsigned)</span></span>|<span data-ttu-id="455f0-194">SQL_C_SLONG</span><span class="sxs-lookup"><span data-stu-id="455f0-194">SQL_C_SLONG</span></span>|<span data-ttu-id="455f0-195">SQLINT4</span><span class="sxs-lookup"><span data-stu-id="455f0-195">SQLINT4</span></span>|<span data-ttu-id="455f0-196">**int**</span><span class="sxs-lookup"><span data-stu-id="455f0-196">**int**</span></span><br /><br /> <span data-ttu-id="455f0-197">**integer**</span><span class="sxs-lookup"><span data-stu-id="455f0-197">**integer**</span></span>|  
|<span data-ttu-id="455f0-198">SQL_INTEGER (帶正負號)</span><span class="sxs-lookup"><span data-stu-id="455f0-198">SQL_INTEGER (signed)</span></span>|<span data-ttu-id="455f0-199">SQL_C_SLONG</span><span class="sxs-lookup"><span data-stu-id="455f0-199">SQL_C_SLONG</span></span>|<span data-ttu-id="455f0-200">SQLINT4</span><span class="sxs-lookup"><span data-stu-id="455f0-200">SQLINT4</span></span>|<span data-ttu-id="455f0-201">**int**</span><span class="sxs-lookup"><span data-stu-id="455f0-201">**int**</span></span><br /><br /> <span data-ttu-id="455f0-202">**integer**</span><span class="sxs-lookup"><span data-stu-id="455f0-202">**integer**</span></span>|  
|<span data-ttu-id="455f0-203">SQL_INTEGER (不帶正負號)</span><span class="sxs-lookup"><span data-stu-id="455f0-203">SQL_INTEGER (unsigned)</span></span>|<span data-ttu-id="455f0-204">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-204">SQL_C_CHAR</span></span>|<span data-ttu-id="455f0-205">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="455f0-205">SQLCHARACTER</span></span>|<span data-ttu-id="455f0-206">**decimal**</span><span class="sxs-lookup"><span data-stu-id="455f0-206">**decimal**</span></span><br /><br /> <span data-ttu-id="455f0-207">**十進位**</span><span class="sxs-lookup"><span data-stu-id="455f0-207">**dec**</span></span>|  
|<span data-ttu-id="455f0-208">SQL_BIGINT (帶正負號和不帶正負號)</span><span class="sxs-lookup"><span data-stu-id="455f0-208">SQL_BIGINT (signed and unsigned)</span></span>|<span data-ttu-id="455f0-209">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-209">SQL_C_CHAR</span></span>|<span data-ttu-id="455f0-210">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="455f0-210">SQLCHARACTER</span></span>|<span data-ttu-id="455f0-211">**bigint**</span><span class="sxs-lookup"><span data-stu-id="455f0-211">**bigint**</span></span>|  
|<span data-ttu-id="455f0-212">SQL_REAL</span><span class="sxs-lookup"><span data-stu-id="455f0-212">SQL_REAL</span></span>|<span data-ttu-id="455f0-213">SQL_C_FLOAT</span><span class="sxs-lookup"><span data-stu-id="455f0-213">SQL_C_FLOAT</span></span>|<span data-ttu-id="455f0-214">SQLFLT4</span><span class="sxs-lookup"><span data-stu-id="455f0-214">SQLFLT4</span></span>|<span data-ttu-id="455f0-215">**real**</span><span class="sxs-lookup"><span data-stu-id="455f0-215">**real**</span></span>|  
|<span data-ttu-id="455f0-216">SQL_FLOAT</span><span class="sxs-lookup"><span data-stu-id="455f0-216">SQL_FLOAT</span></span>|<span data-ttu-id="455f0-217">SQL_C_DOUBLE</span><span class="sxs-lookup"><span data-stu-id="455f0-217">SQL_C_DOUBLE</span></span>|<span data-ttu-id="455f0-218">SQLFLT8</span><span class="sxs-lookup"><span data-stu-id="455f0-218">SQLFLT8</span></span>|<span data-ttu-id="455f0-219">**float**</span><span class="sxs-lookup"><span data-stu-id="455f0-219">**float**</span></span>|  
|<span data-ttu-id="455f0-220">SQL_DOUBLE</span><span class="sxs-lookup"><span data-stu-id="455f0-220">SQL_DOUBLE</span></span>|<span data-ttu-id="455f0-221">SQL_C_DOUBLE</span><span class="sxs-lookup"><span data-stu-id="455f0-221">SQL_C_DOUBLE</span></span>|<span data-ttu-id="455f0-222">SQLFLT8</span><span class="sxs-lookup"><span data-stu-id="455f0-222">SQLFLT8</span></span>|<span data-ttu-id="455f0-223">**float**</span><span class="sxs-lookup"><span data-stu-id="455f0-223">**float**</span></span>|  
|<span data-ttu-id="455f0-224">SQL_BINARY</span><span class="sxs-lookup"><span data-stu-id="455f0-224">SQL_BINARY</span></span>|<span data-ttu-id="455f0-225">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="455f0-225">SQL_C_BINARY</span></span>|<span data-ttu-id="455f0-226">SQLBINARY</span><span class="sxs-lookup"><span data-stu-id="455f0-226">SQLBINARY</span></span>|<span data-ttu-id="455f0-227">**binary**</span><span class="sxs-lookup"><span data-stu-id="455f0-227">**binary**</span></span><br /><br /> <span data-ttu-id="455f0-228">**timestamp**</span><span class="sxs-lookup"><span data-stu-id="455f0-228">**timestamp**</span></span>|  
|<span data-ttu-id="455f0-229">SQL_VARBINARY</span><span class="sxs-lookup"><span data-stu-id="455f0-229">SQL_VARBINARY</span></span>|<span data-ttu-id="455f0-230">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="455f0-230">SQL_C_BINARY</span></span>|<span data-ttu-id="455f0-231">SQLBINARY</span><span class="sxs-lookup"><span data-stu-id="455f0-231">SQLBINARY</span></span>|<span data-ttu-id="455f0-232">**varbinary**</span><span class="sxs-lookup"><span data-stu-id="455f0-232">**varbinary**</span></span><br /><br /> <span data-ttu-id="455f0-233">**binary varying**</span><span class="sxs-lookup"><span data-stu-id="455f0-233">**binary varying**</span></span>|  
|<span data-ttu-id="455f0-234">SQL_LONGVARBINARY</span><span class="sxs-lookup"><span data-stu-id="455f0-234">SQL_LONGVARBINARY</span></span>|<span data-ttu-id="455f0-235">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="455f0-235">SQL_C_BINARY</span></span>|<span data-ttu-id="455f0-236">SQLBINARY</span><span class="sxs-lookup"><span data-stu-id="455f0-236">SQLBINARY</span></span>|<span data-ttu-id="455f0-237">**image**</span><span class="sxs-lookup"><span data-stu-id="455f0-237">**image**</span></span>|  
|<span data-ttu-id="455f0-238">SQL_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="455f0-238">SQL_TYPE_DATE</span></span>|<span data-ttu-id="455f0-239">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-239">SQL_C_CHAR</span></span>|<span data-ttu-id="455f0-240">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="455f0-240">SQLCHARACTER</span></span>|<span data-ttu-id="455f0-241">**datetime**</span><span class="sxs-lookup"><span data-stu-id="455f0-241">**datetime**</span></span><br /><br /> <span data-ttu-id="455f0-242">**smalldatetime**</span><span class="sxs-lookup"><span data-stu-id="455f0-242">**smalldatetime**</span></span>|  
|<span data-ttu-id="455f0-243">SQL_TYPE_TIME</span><span class="sxs-lookup"><span data-stu-id="455f0-243">SQL_TYPE_TIME</span></span>|<span data-ttu-id="455f0-244">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-244">SQL_C_CHAR</span></span>|<span data-ttu-id="455f0-245">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="455f0-245">SQLCHARACTER</span></span>|<span data-ttu-id="455f0-246">**datetime**</span><span class="sxs-lookup"><span data-stu-id="455f0-246">**datetime**</span></span><br /><br /> <span data-ttu-id="455f0-247">**smalldatetime**</span><span class="sxs-lookup"><span data-stu-id="455f0-247">**smalldatetime**</span></span>|  
|<span data-ttu-id="455f0-248">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="455f0-248">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="455f0-249">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-249">SQL_C_CHAR</span></span>|<span data-ttu-id="455f0-250">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="455f0-250">SQLCHARACTER</span></span>|<span data-ttu-id="455f0-251">**datetime**</span><span class="sxs-lookup"><span data-stu-id="455f0-251">**datetime**</span></span><br /><br /> <span data-ttu-id="455f0-252">**smalldatetime**</span><span class="sxs-lookup"><span data-stu-id="455f0-252">**smalldatetime**</span></span>|  
|<span data-ttu-id="455f0-253">SQL_GUID</span><span class="sxs-lookup"><span data-stu-id="455f0-253">SQL_GUID</span></span>|<span data-ttu-id="455f0-254">SQL_C_GUID</span><span class="sxs-lookup"><span data-stu-id="455f0-254">SQL_C_GUID</span></span>|<span data-ttu-id="455f0-255">SQLUNIQUEID</span><span class="sxs-lookup"><span data-stu-id="455f0-255">SQLUNIQUEID</span></span>|<span data-ttu-id="455f0-256">**uniqueidentifier**</span><span class="sxs-lookup"><span data-stu-id="455f0-256">**uniqueidentifier**</span></span>|  
|<span data-ttu-id="455f0-257">SQL_INTERVAL_</span><span class="sxs-lookup"><span data-stu-id="455f0-257">SQL_INTERVAL_</span></span>|<span data-ttu-id="455f0-258">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="455f0-258">SQL_C_CHAR</span></span>|<span data-ttu-id="455f0-259">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="455f0-259">SQLCHARACTER</span></span>|<span data-ttu-id="455f0-260">**char**</span><span class="sxs-lookup"><span data-stu-id="455f0-260">**char**</span></span>|  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="455f0-261">沒有帶正負號的**Tinyint**、不帶正負號的**Smallint**或不帶正負號的**int**資料類型。</span><span class="sxs-lookup"><span data-stu-id="455f0-261">does not have signed **tinyint**, unsigned **smallint**, or unsigned **int** data types.</span></span> <span data-ttu-id="455f0-262">若要避免在移轉這些資料類型時發生資料值遺失的情況，請使用次大的整數資料類型來建立 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資料表。</span><span class="sxs-lookup"><span data-stu-id="455f0-262">To prevent the loss of data values when migrating these data types, create the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table with the next largest integer data type.</span></span> <span data-ttu-id="455f0-263">若要避免使用者之後加入原始資料類型所允許之範圍以外的值，請將規則套用到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資料行，將可允許的值限制為原始來源中受到該資料類型所支援的範圍：</span><span class="sxs-lookup"><span data-stu-id="455f0-263">To prevent users from later adding values outside the range allowed by the original data type, apply a rule to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] column to restrict the allowable values to the range supported by the data type in the original source:</span></span>  
  
```  
CREATE TABLE Sample_Ints(STinyIntCol   SMALLINT,  
USmallIntCol INT)  
GO  
CREATE RULE STinyInt_Rule  
AS   
@range >= -128 AND @range <= 127  
GO  
CREATE RULE USmallInt_Rule  
AS   
@range >= 0 AND @range <= 65535  
GO  
sp_bindrule STinyInt_Rule, 'Sample_Ints.STinyIntCol'  
GO  
sp_bindrule USmallInt_Rule, 'Sample_Ints.USmallIntCol'  
GO  
```  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="455f0-264">不直接支援間隔資料類型。</span><span class="sxs-lookup"><span data-stu-id="455f0-264">does not support interval data types directly.</span></span> <span data-ttu-id="455f0-265">但是，應用程式可以將間隔逸出序列當做字元字串儲存在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 字元資料行中。</span><span class="sxs-lookup"><span data-stu-id="455f0-265">An application can, however, store interval escape sequences as character strings in a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] character column.</span></span> <span data-ttu-id="455f0-266">應用程式可以讀取它們供日後使用，但是它們不能在 [!INCLUDE[tsql](../../includes/tsql-md.md)] 陳述式中使用。</span><span class="sxs-lookup"><span data-stu-id="455f0-266">The application can read them for later use, but they cannot be used in [!INCLUDE[tsql](../../includes/tsql-md.md)] statements.</span></span>  
  
 <span data-ttu-id="455f0-267">大量複製函數可用來將資料快速載入 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 中 (該資料是從 ODBC 資料來源讀取)。</span><span class="sxs-lookup"><span data-stu-id="455f0-267">The bulk copy functions can be used to quickly load data into [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that has been read from an ODBC data source.</span></span> <span data-ttu-id="455f0-268">只搭配資料變數使用 [SQLBindCol](../native-client-odbc-api/sqlbindcol.md) 可將結果集的資料行繫結至程式變數，然後使用 **bcp_bind** 可將相同程式變數繫結至大量複製作業。</span><span class="sxs-lookup"><span data-stu-id="455f0-268">Use [SQLBindCol](../native-client-odbc-api/sqlbindcol.md) to bind the columns of a result set to program variables, then use **bcp_bind** to bind the same program variables to a bulk copy operation.</span></span> <span data-ttu-id="455f0-269">呼叫[SQLFetchScroll](../native-client-odbc-api/sqlfetchscroll.md)或**SQLFetch**會接著從 ODBC 資料來源將資料列提取到程式變數中，而呼叫[bcp_sendrow](../native-client-odbc-extensions-bulk-copy-functions/bcp-sendrow.md)會從程式變數大量複製資料至 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="455f0-269">Calling [SQLFetchScroll](../native-client-odbc-api/sqlfetchscroll.md) or **SQLFetch** then fetches a row of data from the ODBC data source into the program variables, and calling [bcp_sendrow](../native-client-odbc-extensions-bulk-copy-functions/bcp-sendrow.md) bulk copies the data from the program variables to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span></span>  
  
 <span data-ttu-id="455f0-270">每當應用程式需要變更原本在**bcp_bind** _pData_參數中指定之資料變數的位址時，都可以使用[bcp_colptr](../native-client-odbc-extensions-bulk-copy-functions/bcp-colptr.md)函數。</span><span class="sxs-lookup"><span data-stu-id="455f0-270">An application can use the [bcp_colptr](../native-client-odbc-extensions-bulk-copy-functions/bcp-colptr.md) function anytime it needs to change the address of the data variable originally specified in the **bcp_bind** _pData_ parameter.</span></span> <span data-ttu-id="455f0-271">每當應用程式需要變更原本在 [bcp_bind](../native-client-odbc-extensions-bulk-copy-functions/bcp-collen.md) cbData **參數中指定的資料長度時，可以隨時使用**_bcp_collen_ 函數。</span><span class="sxs-lookup"><span data-stu-id="455f0-271">An application can use the [bcp_collen](../native-client-odbc-extensions-bulk-copy-functions/bcp-collen.md) function anytime it needs to change the data length originally specified in the **bcp_bind**_cbData_ parameter.</span></span>  
  
 <span data-ttu-id="455f0-272">您無法使用大量複製將 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 中的資料讀入程式變數中；因為並沒有類似 "bcp_readrow" 函數的項目。</span><span class="sxs-lookup"><span data-stu-id="455f0-272">You cannot read data from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] into program variables using bulk copy; there is nothing like a "bcp_readrow" function.</span></span> <span data-ttu-id="455f0-273">您只能將應用程式中的資料傳送到伺服器。</span><span class="sxs-lookup"><span data-stu-id="455f0-273">You can only send data from the application to the server.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="455f0-274">另請參閱</span><span class="sxs-lookup"><span data-stu-id="455f0-274">See Also</span></span>  
 [<span data-ttu-id="455f0-275">&#40;ODBC&#41;執行大量複製作業</span><span class="sxs-lookup"><span data-stu-id="455f0-275">Performing Bulk Copy Operations &#40;ODBC&#41;</span></span>](performing-bulk-copy-operations-odbc.md)  
  
  
