---
title: 決定性與非決定性函式 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- built-in functions [SQL Server]
- nondeterministic functions
- extended stored procedures [SQL Server], functions that call
- deterministic functions
- user-defined functions [SQL Server], deterministic
ms.assetid: 2f3ce5f5-c81c-4470-8141-8144d4f218dd
author: rothja
ms.author: jroth
ms.openlocfilehash: 9e755532e06d64e273408c7e81936a1c2d370697
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87708141"
---
# <a name="deterministic-and-nondeterministic-functions"></a><span data-ttu-id="362fc-102">決定性與非決定性函數</span><span class="sxs-lookup"><span data-stu-id="362fc-102">Deterministic and Nondeterministic Functions</span></span>
  <span data-ttu-id="362fc-103">假設資料庫狀態相同，任何時候以特定的輸入值集來呼叫決定性函數時，一律會傳回相同的結果。</span><span class="sxs-lookup"><span data-stu-id="362fc-103">Deterministic functions always return the same result any time they are called with a specific set of input values and given the same state of the database.</span></span> <span data-ttu-id="362fc-104">即使所存取的資料庫維持在相同的狀態，每次以特定的輸入值集來呼叫非決定性函數時，都會傳回不同的結果。</span><span class="sxs-lookup"><span data-stu-id="362fc-104">Nondeterministic functions may return different results each time they are called with a specific set of input values even if the database state that they access remains the same.</span></span> <span data-ttu-id="362fc-105">例如，在上述限定情況下，AVG 函數一律傳回相同的結果，而傳回目前日期時間值的 GETDATE 函數則一律傳回不同的結果。</span><span class="sxs-lookup"><span data-stu-id="362fc-105">For example, the function AVG always returns the same result given the qualifications stated above, but the GETDATE function, which returns the current datetime value, always returns a different result.</span></span>  
  
 <span data-ttu-id="362fc-106">無論是透過呼叫函數之計算資料行上的索引，還是透過參考函數的索引檢視，使用者自訂函數都有幾項屬性可決定 [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] 為函數的結果編製索引的能力。</span><span class="sxs-lookup"><span data-stu-id="362fc-106">There are several properties of user-defined functions that determine the ability of the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] to index the results of the function, either through indexes on computed columns that call the function, or through indexed views that reference the function.</span></span> <span data-ttu-id="362fc-107">函數的決定性是這類屬性的一種。</span><span class="sxs-lookup"><span data-stu-id="362fc-107">The determinism of a function is one such property.</span></span> <span data-ttu-id="362fc-108">例如，如果檢視參考任何不具決定性的函數，則無法在檢視上建立叢集索引。</span><span class="sxs-lookup"><span data-stu-id="362fc-108">For example, a clustered index cannot be created on a view if the view references any nondeterministic functions.</span></span> <span data-ttu-id="362fc-109">如需函數屬性 (包括決定性) 的詳細資訊，請參閱 [使用者定義函數](user-defined-functions.md)。</span><span class="sxs-lookup"><span data-stu-id="362fc-109">For more information about the properties of functions, including determinism, see [User-Defined Functions](user-defined-functions.md).</span></span>  
  
 <span data-ttu-id="362fc-110">此主題會識別內建系統函數的決定性，以及當使用者自訂函數的具決定性屬性包含擴充預存程序的呼叫時，所造成的影響。</span><span class="sxs-lookup"><span data-stu-id="362fc-110">This topic identifies the determinism of built-in system functions and the effect on the deterministic property of user-defined functions when it contains a call to extended stored procedures.</span></span>  
  
## <a name="built-in-function-determinism"></a><span data-ttu-id="362fc-111">內建函數決定性</span><span class="sxs-lookup"><span data-stu-id="362fc-111">Built-in Function Determinism</span></span>  
 <span data-ttu-id="362fc-112">您無法影響任何內建函數的決定論。</span><span class="sxs-lookup"><span data-stu-id="362fc-112">You cannot influence the determinism of any built-in function.</span></span> <span data-ttu-id="362fc-113">每個內建函數屬於具決定性或不具決定性，主要取決於 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]實作函數的方式。</span><span class="sxs-lookup"><span data-stu-id="362fc-113">Each built-in function is deterministic or nondeterministic based on how the function is implemented by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="362fc-114">例如，在查詢中指定 ORDER BY 子句不會變更該查詢所使用之函數的決定性。</span><span class="sxs-lookup"><span data-stu-id="362fc-114">For example, specifying an ORDER BY clause in a query does not change the determinism of a function that used in that query.</span></span>  
  
 <span data-ttu-id="362fc-115">所有的字串內建函數都具有決定性。</span><span class="sxs-lookup"><span data-stu-id="362fc-115">All of the string built-in functions are deterministic.</span></span> <span data-ttu-id="362fc-116">如需這些函數的清單，請參閱[字串函數 &#40;Transact-SQL&#41;](/sql/t-sql/functions/string-functions-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="362fc-116">For a list of these functions, see [String Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/string-functions-transact-sql).</span></span>  
  
 <span data-ttu-id="362fc-117">在下列內建函數類別目錄中，不屬於字串函數的內建函數一律會視為具有決定性。</span><span class="sxs-lookup"><span data-stu-id="362fc-117">The following built-in functions from categories of built-in functions other than string functions are always deterministic.</span></span>  
  
||||  
|-|-|-|  
|<span data-ttu-id="362fc-118">ABS</span><span class="sxs-lookup"><span data-stu-id="362fc-118">ABS</span></span>|<span data-ttu-id="362fc-119">DATEDIFF</span><span class="sxs-lookup"><span data-stu-id="362fc-119">DATEDIFF</span></span>|<span data-ttu-id="362fc-120">POWER</span><span class="sxs-lookup"><span data-stu-id="362fc-120">POWER</span></span>|  
|<span data-ttu-id="362fc-121">ACOS</span><span class="sxs-lookup"><span data-stu-id="362fc-121">ACOS</span></span>|<span data-ttu-id="362fc-122">DAY</span><span class="sxs-lookup"><span data-stu-id="362fc-122">DAY</span></span>|<span data-ttu-id="362fc-123">RADIANS</span><span class="sxs-lookup"><span data-stu-id="362fc-123">RADIANS</span></span>|  
|<span data-ttu-id="362fc-124">ASIN</span><span class="sxs-lookup"><span data-stu-id="362fc-124">ASIN</span></span>|<span data-ttu-id="362fc-125">DEGREES</span><span class="sxs-lookup"><span data-stu-id="362fc-125">DEGREES</span></span>|<span data-ttu-id="362fc-126">ROUND</span><span class="sxs-lookup"><span data-stu-id="362fc-126">ROUND</span></span>|  
|<span data-ttu-id="362fc-127">ATAN</span><span class="sxs-lookup"><span data-stu-id="362fc-127">ATAN</span></span>|<span data-ttu-id="362fc-128">EXP</span><span class="sxs-lookup"><span data-stu-id="362fc-128">EXP</span></span>|<span data-ttu-id="362fc-129">SIGN</span><span class="sxs-lookup"><span data-stu-id="362fc-129">SIGN</span></span>|  
|<span data-ttu-id="362fc-130">ATN2</span><span class="sxs-lookup"><span data-stu-id="362fc-130">ATN2</span></span>|<span data-ttu-id="362fc-131">FLOOR</span><span class="sxs-lookup"><span data-stu-id="362fc-131">FLOOR</span></span>|<span data-ttu-id="362fc-132">SIN</span><span class="sxs-lookup"><span data-stu-id="362fc-132">SIN</span></span>|  
|<span data-ttu-id="362fc-133">CEILING</span><span class="sxs-lookup"><span data-stu-id="362fc-133">CEILING</span></span>|<span data-ttu-id="362fc-134">ISNULL</span><span class="sxs-lookup"><span data-stu-id="362fc-134">ISNULL</span></span>|<span data-ttu-id="362fc-135">SQUARE</span><span class="sxs-lookup"><span data-stu-id="362fc-135">SQUARE</span></span>|  
|<span data-ttu-id="362fc-136">COALESCE</span><span class="sxs-lookup"><span data-stu-id="362fc-136">COALESCE</span></span>|<span data-ttu-id="362fc-137">ISNUMERIC</span><span class="sxs-lookup"><span data-stu-id="362fc-137">ISNUMERIC</span></span>|<span data-ttu-id="362fc-138">SQRT</span><span class="sxs-lookup"><span data-stu-id="362fc-138">SQRT</span></span>|  
|<span data-ttu-id="362fc-139">COS</span><span class="sxs-lookup"><span data-stu-id="362fc-139">COS</span></span>|<span data-ttu-id="362fc-140">記錄</span><span class="sxs-lookup"><span data-stu-id="362fc-140">LOG</span></span>|<span data-ttu-id="362fc-141">TAN</span><span class="sxs-lookup"><span data-stu-id="362fc-141">TAN</span></span>|  
|<span data-ttu-id="362fc-142">COT</span><span class="sxs-lookup"><span data-stu-id="362fc-142">COT</span></span>|<span data-ttu-id="362fc-143">LOG10</span><span class="sxs-lookup"><span data-stu-id="362fc-143">LOG10</span></span>|<span data-ttu-id="362fc-144">年</span><span class="sxs-lookup"><span data-stu-id="362fc-144">YEAR</span></span>|  
|<span data-ttu-id="362fc-145">DATALENGTH</span><span class="sxs-lookup"><span data-stu-id="362fc-145">DATALENGTH</span></span>|<span data-ttu-id="362fc-146">月</span><span class="sxs-lookup"><span data-stu-id="362fc-146">MONTH</span></span>||  
|<span data-ttu-id="362fc-147">DATEADD</span><span class="sxs-lookup"><span data-stu-id="362fc-147">DATEADD</span></span>|<span data-ttu-id="362fc-148">NULLIF</span><span class="sxs-lookup"><span data-stu-id="362fc-148">NULLIF</span></span>||  
  
 <span data-ttu-id="362fc-149">下列函數並非永遠是具決定性函數，但若是以決定性的方式來指定，則可用於索引檢視表或計算資料行的索引。</span><span class="sxs-lookup"><span data-stu-id="362fc-149">The following functions are not always deterministic, but can be used in indexed views or indexes on computed columns when they are specified in a deterministic manner.</span></span>  
  
|<span data-ttu-id="362fc-150">函式</span><span class="sxs-lookup"><span data-stu-id="362fc-150">Function</span></span>|<span data-ttu-id="362fc-151">註解</span><span class="sxs-lookup"><span data-stu-id="362fc-151">Comments</span></span>|  
|--------------|--------------|  
|<span data-ttu-id="362fc-152">所有彙總函式</span><span class="sxs-lookup"><span data-stu-id="362fc-152">all aggregate functions</span></span>|<span data-ttu-id="362fc-153">除非為 OVER 與 ORDER BY 子句所指定，否則所有彙總函式都具有決定性。</span><span class="sxs-lookup"><span data-stu-id="362fc-153">All aggregate functions are deterministic unless they are specified with the OVER and ORDER BY clauses.</span></span> <span data-ttu-id="362fc-154">如需這些函數的清單，請參閱[彙總函數 &#40;Transact-SQL&#41;](/sql/t-sql/functions/aggregate-functions-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="362fc-154">For a list of these functions, see [Aggregate Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/aggregate-functions-transact-sql).</span></span>|  
|<span data-ttu-id="362fc-155">CAST</span><span class="sxs-lookup"><span data-stu-id="362fc-155">CAST</span></span>|<span data-ttu-id="362fc-156">除非搭配 `datetime`、`smalldatetime` 或 `sql_variant` 使用，否則為決定性函數。</span><span class="sxs-lookup"><span data-stu-id="362fc-156">Deterministic unless used with `datetime`, `smalldatetime`, or `sql_variant`.</span></span>|  
|<span data-ttu-id="362fc-157">CONVERT</span><span class="sxs-lookup"><span data-stu-id="362fc-157">CONVERT</span></span>|<span data-ttu-id="362fc-158">除非存在這些條件之一，否則為具決定性函數：</span><span class="sxs-lookup"><span data-stu-id="362fc-158">Deterministic unless one of these conditions exists:</span></span><br /><br /> <span data-ttu-id="362fc-159">來源類型為 `sql_variant`。</span><span class="sxs-lookup"><span data-stu-id="362fc-159">Source type is `sql_variant`.</span></span><br /><br /> <span data-ttu-id="362fc-160">目標類型為 `sql_variant`，且其來源類型為非決定性函數。</span><span class="sxs-lookup"><span data-stu-id="362fc-160">Target type is `sql_variant` and its source type is nondeterministic.</span></span><br /><br /> <span data-ttu-id="362fc-161">來源或目標類型為 `datetime` 或 `smalldatetime`；其他來源或目標類型為字元字串，而且指定了非決定性的樣式。</span><span class="sxs-lookup"><span data-stu-id="362fc-161">Source or target type is `datetime` or `smalldatetime`, the other source or target type is a character string, and a nondeterministic style is specified.</span></span> <span data-ttu-id="362fc-162">若要具有決定性，樣式參數必須是常數。</span><span class="sxs-lookup"><span data-stu-id="362fc-162">To be deterministic, the style parameter must be a constant.</span></span> <span data-ttu-id="362fc-163">此外，小於或等於 100 的樣式不具決定性，但樣式 20 和 21 除外。</span><span class="sxs-lookup"><span data-stu-id="362fc-163">Additionally, styles less than or equal to 100 are nondeterministic, except for styles 20 and 21.</span></span> <span data-ttu-id="362fc-164">大於 100 的樣式具決定性，但樣式 106、107、109 和 113 除外。</span><span class="sxs-lookup"><span data-stu-id="362fc-164">Styles greater than 100 are deterministic, except for styles 106, 107, 109 and 113.</span></span>|  
|<span data-ttu-id="362fc-165">CHECKSUM</span><span class="sxs-lookup"><span data-stu-id="362fc-165">CHECKSUM</span></span>|<span data-ttu-id="362fc-166">具決定性，但 CHECKSUM(\*) 除外。</span><span class="sxs-lookup"><span data-stu-id="362fc-166">Deterministic, with the exception of CHECKSUM(\*).</span></span>|  
|<span data-ttu-id="362fc-167">ISDATE</span><span class="sxs-lookup"><span data-stu-id="362fc-167">ISDATE</span></span>|<span data-ttu-id="362fc-168">若與 CONVERT 函數一併使用，只有在指定 CONVERT 樣式參數，且樣式不等於 0、100、9 或 109 時，才是具決定性的。</span><span class="sxs-lookup"><span data-stu-id="362fc-168">Deterministic only if used with the CONVERT function, the CONVERT style parameter is specified and style is not equal to 0, 100, 9, or 109.</span></span>|  
|<span data-ttu-id="362fc-169">RAND</span><span class="sxs-lookup"><span data-stu-id="362fc-169">RAND</span></span>|<span data-ttu-id="362fc-170">RAND 只有在指定 *seed* 參數時才是具決定性的。</span><span class="sxs-lookup"><span data-stu-id="362fc-170">RAND is deterministic only when a *seed* parameter is specified.</span></span>|  
  
 <span data-ttu-id="362fc-171">所有的組態、資料指標、中繼資料、安全性及系統統計函數都是不具決定性的。</span><span class="sxs-lookup"><span data-stu-id="362fc-171">All the configuration, cursor, metadata, security, and system statistical functions are nondeterministic.</span></span> <span data-ttu-id="362fc-172">如需這些函數的清單，請參閱[組態函數 &#40;Transact-SQL&#41;](/sql/t-sql/functions/configuration-functions-transact-sql)、[游標函數 &#40;Transact-SQL&#41;](/sql/t-sql/functions/cursor-functions-transact-sql)、[中繼資料函數 &#40;Transact-SQL&#41;](/sql/t-sql/functions/metadata-functions-transact-sql)、[安全性函數 &#40;Transact-SQL&#41;](/sql/t-sql/functions/security-functions-transact-sql) 和[系統統計函數 &#40;Transact-SQL&#41;](/sql/t-sql/functions/system-statistical-functions-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="362fc-172">For a list of these functions, see [Configuration Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/configuration-functions-transact-sql), [Cursor Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/cursor-functions-transact-sql), [Metadata Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/metadata-functions-transact-sql), [Security Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/security-functions-transact-sql), and [System Statistical Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/system-statistical-functions-transact-sql).</span></span>  
  
 <span data-ttu-id="362fc-173">下列屬於其他類別的內建函數，一律是不具決定性的。</span><span class="sxs-lookup"><span data-stu-id="362fc-173">The following built-in functions from other categories are always nondeterministic.</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="362fc-174">@@CONNECTIONS</span><span class="sxs-lookup"><span data-stu-id="362fc-174">@@CONNECTIONS</span></span>|<span data-ttu-id="362fc-175">GETDATE</span><span class="sxs-lookup"><span data-stu-id="362fc-175">GETDATE</span></span>|  
|<span data-ttu-id="362fc-176">@@CPU_BUSY</span><span class="sxs-lookup"><span data-stu-id="362fc-176">@@CPU_BUSY</span></span>|<span data-ttu-id="362fc-177">GETUTCDATE</span><span class="sxs-lookup"><span data-stu-id="362fc-177">GETUTCDATE</span></span>|  
|<span data-ttu-id="362fc-178">@@DBTS</span><span class="sxs-lookup"><span data-stu-id="362fc-178">@@DBTS</span></span>|<span data-ttu-id="362fc-179">GET_TRANSMISSION_STATUS</span><span class="sxs-lookup"><span data-stu-id="362fc-179">GET_TRANSMISSION_STATUS</span></span>|  
|<span data-ttu-id="362fc-180">@@IDLE</span><span class="sxs-lookup"><span data-stu-id="362fc-180">@@IDLE</span></span>|<span data-ttu-id="362fc-181">LAG</span><span class="sxs-lookup"><span data-stu-id="362fc-181">LAG</span></span>|  
|<span data-ttu-id="362fc-182">@@IO_BUSY</span><span class="sxs-lookup"><span data-stu-id="362fc-182">@@IO_BUSY</span></span>|<span data-ttu-id="362fc-183">LAST_VALUE</span><span class="sxs-lookup"><span data-stu-id="362fc-183">LAST_VALUE</span></span>|  
|<span data-ttu-id="362fc-184">@@MAX_CONNECTIONS</span><span class="sxs-lookup"><span data-stu-id="362fc-184">@@MAX_CONNECTIONS</span></span>|<span data-ttu-id="362fc-185">LEAD</span><span class="sxs-lookup"><span data-stu-id="362fc-185">LEAD</span></span>|  
|<span data-ttu-id="362fc-186">@@PACK_RECEIVED</span><span class="sxs-lookup"><span data-stu-id="362fc-186">@@PACK_RECEIVED</span></span>|<span data-ttu-id="362fc-187">MIN_ACTIVE_ROWVERSION</span><span class="sxs-lookup"><span data-stu-id="362fc-187">MIN_ACTIVE_ROWVERSION</span></span>|  
|<span data-ttu-id="362fc-188">@@PACK_SENT</span><span class="sxs-lookup"><span data-stu-id="362fc-188">@@PACK_SENT</span></span>|<span data-ttu-id="362fc-189">NEWID</span><span class="sxs-lookup"><span data-stu-id="362fc-189">NEWID</span></span>|  
|<span data-ttu-id="362fc-190">@@PACKET_ERRORS</span><span class="sxs-lookup"><span data-stu-id="362fc-190">@@PACKET_ERRORS</span></span>|<span data-ttu-id="362fc-191">NEWSEQUENTIALID</span><span class="sxs-lookup"><span data-stu-id="362fc-191">NEWSEQUENTIALID</span></span>|  
|<span data-ttu-id="362fc-192">@@TIMETICKS</span><span class="sxs-lookup"><span data-stu-id="362fc-192">@@TIMETICKS</span></span>|<span data-ttu-id="362fc-193">NEXT VALUE FOR</span><span class="sxs-lookup"><span data-stu-id="362fc-193">NEXT VALUE FOR</span></span>|  
|<span data-ttu-id="362fc-194">@@TOTAL_ERRORS</span><span class="sxs-lookup"><span data-stu-id="362fc-194">@@TOTAL_ERRORS</span></span>|<span data-ttu-id="362fc-195">NTILE</span><span class="sxs-lookup"><span data-stu-id="362fc-195">NTILE</span></span>|  
|<span data-ttu-id="362fc-196">@@TOTAL_READ</span><span class="sxs-lookup"><span data-stu-id="362fc-196">@@TOTAL_READ</span></span>|<span data-ttu-id="362fc-197">PARSENAME</span><span class="sxs-lookup"><span data-stu-id="362fc-197">PARSENAME</span></span>|  
|<span data-ttu-id="362fc-198">@@TOTAL_WRITE</span><span class="sxs-lookup"><span data-stu-id="362fc-198">@@TOTAL_WRITE</span></span>|<span data-ttu-id="362fc-199">PERCENTILE_CONT</span><span class="sxs-lookup"><span data-stu-id="362fc-199">PERCENTILE_CONT</span></span>|  
|<span data-ttu-id="362fc-200">CUME_DIST</span><span class="sxs-lookup"><span data-stu-id="362fc-200">CUME_DIST</span></span>|<span data-ttu-id="362fc-201">PERCENTILE_DISC</span><span class="sxs-lookup"><span data-stu-id="362fc-201">PERCENTILE_DISC</span></span>|  
|<span data-ttu-id="362fc-202">CURRENT_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="362fc-202">CURRENT_TIMESTAMP</span></span>|<span data-ttu-id="362fc-203">PERCENT_RANK</span><span class="sxs-lookup"><span data-stu-id="362fc-203">PERCENT_RANK</span></span>|  
|<span data-ttu-id="362fc-204">DENSE_RANK</span><span class="sxs-lookup"><span data-stu-id="362fc-204">DENSE_RANK</span></span>|<span data-ttu-id="362fc-205">RAND</span><span class="sxs-lookup"><span data-stu-id="362fc-205">RAND</span></span>|  
|<span data-ttu-id="362fc-206">FIRST_VALUE</span><span class="sxs-lookup"><span data-stu-id="362fc-206">FIRST_VALUE</span></span>|<span data-ttu-id="362fc-207">RANK</span><span class="sxs-lookup"><span data-stu-id="362fc-207">RANK</span></span>|  
||<span data-ttu-id="362fc-208">ROW_NUMBER</span><span class="sxs-lookup"><span data-stu-id="362fc-208">ROW_NUMBER</span></span>|  
||<span data-ttu-id="362fc-209">TEXTPTR</span><span class="sxs-lookup"><span data-stu-id="362fc-209">TEXTPTR</span></span>|  
  
## <a name="calling-extended-stored-procedures-from-functions"></a><span data-ttu-id="362fc-210">從函數呼叫擴充預存程序</span><span class="sxs-lookup"><span data-stu-id="362fc-210">Calling Extended Stored Procedures from Functions</span></span>  
 <span data-ttu-id="362fc-211">呼叫擴充預存程序的函數是不具決定性的，因為擴充預存程序可能對資料庫造成副作用。</span><span class="sxs-lookup"><span data-stu-id="362fc-211">Functions that call extended stored procedures are nondeterministic, because the extended stored procedures can cause side effects on the database.</span></span> <span data-ttu-id="362fc-212">副作用是變更資料庫的全域狀態 (例如更新資料表)，或變更檔案或網路這類外部資源 (例如修改檔案或傳送電子郵件訊息)。</span><span class="sxs-lookup"><span data-stu-id="362fc-212">Side effects are changes to a global state of the database, such as an update to a table, or to an external resource, such as a file or the network; for example, modifying a file or sending an e-mail message.</span></span> <span data-ttu-id="362fc-213">從使用者自訂函數執行擴充預存程序時不應該依靠傳回一致的結果集。</span><span class="sxs-lookup"><span data-stu-id="362fc-213">You should not rely on returning a consistent result set when executing an extended stored procedure from a user-defined function.</span></span> <span data-ttu-id="362fc-214">不建議您使用會對資料庫造成副作用的使用者自訂函數。</span><span class="sxs-lookup"><span data-stu-id="362fc-214">User-defined functions that create side effects on the database are not recommended.</span></span>  
  
 <span data-ttu-id="362fc-215">從函數內部呼叫時，擴充預存程序無法傳回結果集給用戶端。</span><span class="sxs-lookup"><span data-stu-id="362fc-215">When called from inside a function, the extended stored procedure cannot return result sets to the client.</span></span> <span data-ttu-id="362fc-216">傳回結果集給用戶端的任何開放式資料服務 (Open Data Services) API 都會收到 FAIL 的傳回碼。</span><span class="sxs-lookup"><span data-stu-id="362fc-216">Any Open Data Services API that returns result sets to the client will have a return code of FAIL.</span></span>  
  
 <span data-ttu-id="362fc-217">擴充預存程序不得連回 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="362fc-217">The extended stored procedure can connect back to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="362fc-218">而且，程序都無法加入相同的交易成為呼叫擴充預存程序的原始函數。</span><span class="sxs-lookup"><span data-stu-id="362fc-218">However, the procedure cannot join the same transaction as the original function that invoked the extended stored procedure.</span></span>  
  
 <span data-ttu-id="362fc-219">類似從批次或預存程序的引動過程，擴充預存程序是在執行 [!INCLUDE[msCoName](../../includes/msconame-md.md)] 的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Windows 安全帳戶內容中執行。</span><span class="sxs-lookup"><span data-stu-id="362fc-219">Similar to invocations from a batch or stored procedure, the extended stored procedure is executed in the context of the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows security account under which [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is running.</span></span> <span data-ttu-id="362fc-220">擴充預存程序的擁有者在授權讓其他使用者可以執行該程序時應該考慮到這一點。</span><span class="sxs-lookup"><span data-stu-id="362fc-220">The owner of the extended stored procedure should consider this when granting permissions to other users to execute the procedure.</span></span>  
  
  
