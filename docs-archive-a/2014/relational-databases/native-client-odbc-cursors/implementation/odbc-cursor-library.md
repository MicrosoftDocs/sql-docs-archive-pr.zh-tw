---
title: ODBC 資料指標程式庫 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- cursors [ODBC], library
- SQL_CUR_USE_DRIVER option
- ODBC applications, cursors
- ODBC cursors, library
- SQL_CUR_USE_IF_NEEDED option
- SQLSetConnectAttr function
- SQL_CUR_USE_ODBC option
ms.assetid: 3c610d3d-6e06-49cf-9a40-05b6a1c83a32
author: rothja
ms.author: jroth
ms.openlocfilehash: b0f0ad049c6b9e77f9888d582ab0cda2f5a5e0f7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87594069"
---
# <a name="odbc-cursor-library"></a><span data-ttu-id="31a8c-102">ODBC 資料指標程式庫</span><span class="sxs-lookup"><span data-stu-id="31a8c-102">ODBC Cursor Library</span></span>
  <span data-ttu-id="31a8c-103">某些 ODBC 驅動程式只支援預設的資料指標設定;這些驅動程式也不支援定位的資料指標作業，例如**SQLSetPos**。</span><span class="sxs-lookup"><span data-stu-id="31a8c-103">Some ODBC drivers only support the default cursor settings; these drivers also do not support positioned cursor operations, such as **SQLSetPos**.</span></span> <span data-ttu-id="31a8c-104">ODBC 資料指標程式庫是 Microsoft 資料存取元件 (MDAC) 的元件，可用來在一般並不支援區塊或靜態資料指標的驅動程式上實作這些項目。</span><span class="sxs-lookup"><span data-stu-id="31a8c-104">The ODBC cursor library is a component of the Microsoft Data Access Components (MDAC) used to implement block or static cursors on a driver that normally does not support them.</span></span> <span data-ttu-id="31a8c-105">資料指標程式庫也會針對它所建立的資料指標，執行定位的 UPDATE 和 DELETE 子句和**SQLSetPos** 。</span><span class="sxs-lookup"><span data-stu-id="31a8c-105">The cursor library also implements positioned UPDATE and DELETE statements and **SQLSetPos** for the cursors it creates.</span></span>  
  
 <span data-ttu-id="31a8c-106">ODBC 資料指標程式庫會實作為 ODBC 驅動程式管理員和 ODBC 驅動程式之間的層級。</span><span class="sxs-lookup"><span data-stu-id="31a8c-106">The ODBC cursor library is implemented as a layer between the ODBC Driver Manager and an ODBC driver.</span></span> <span data-ttu-id="31a8c-107">如果 ODBC 資料指標程式庫已載入，則 ODBC 驅動程式管理員會將所有與資料指標相關的命令路由到資料指標程式庫，而不是驅動程式。</span><span class="sxs-lookup"><span data-stu-id="31a8c-107">If the ODBC cursor library is loaded, the ODBC Driver Manager routes all cursor-related commands to the cursor library instead of the driver.</span></span> <span data-ttu-id="31a8c-108">資料指標程式庫會從基礎驅動程式提取整個結果集，並將結果集快取在用戶端上來實作資料指標。</span><span class="sxs-lookup"><span data-stu-id="31a8c-108">The cursor library implements a cursor by fetching the entire result set from the underlying driver and caching the result set on the client.</span></span> <span data-ttu-id="31a8c-109">使用 ODBC 資料指標程式庫時，應用程式只限於使用資料指標程式庫的資料指標功能，而無法使用基礎驅動程式中任何其他資料指標功能的支援。</span><span class="sxs-lookup"><span data-stu-id="31a8c-109">When using the ODBC cursor library, the application is limited to the cursor functionality of the cursor library; any support for additional cursor functionality in the underlying driver is not available to the application.</span></span>  
  
 <span data-ttu-id="31a8c-110">您幾乎不需要藉由 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC 驅動程式來使用 ODBC 資料指標程式庫，因為驅動程式本身所支援的資料指標功能就比 ODBC 資料指標程式庫來得多。</span><span class="sxs-lookup"><span data-stu-id="31a8c-110">There is little need to use the ODBC cursor library with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver because the driver itself supports more cursor functionality than the ODBC cursor library.</span></span> <span data-ttu-id="31a8c-111">使用 ODBC 資料指標程式庫搭配 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native CLIENT ODBC 驅動程式的唯一理由是，驅動程式會透過伺服器資料指標來執行其資料指標支援，而伺服器資料指標並不支援所有的 SQL 語句。</span><span class="sxs-lookup"><span data-stu-id="31a8c-111">The only reason to use the ODBC cursor library with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver is because the driver implements its cursor support through server cursors, and server cursors do not support all SQL statements.</span></span> <span data-ttu-id="31a8c-112">任何時候如果需要具有預存程序、批次或 SQL 陳述式 (包含 COMPUTE、COMPUTE BY、FOR BROWSE 或 INTO) 的靜態資料指標，請考慮使用 ODBC 資料指標程式庫。</span><span class="sxs-lookup"><span data-stu-id="31a8c-112">Any time there is a need to have a static cursor with stored procedures, batches, or SQL statements containing COMPUTE, COMPUTE BY, FOR BROWSE, or INTO, consider using the ODBC cursor library.</span></span> <span data-ttu-id="31a8c-113">不過，使用資料指標程式庫時必須小心，因為它會將整個結果集都快取在用戶端上，這可能會耗用大量的記憶體並使效能降低。</span><span class="sxs-lookup"><span data-stu-id="31a8c-113">However, care must be used with the cursor library because it caches the entire result set on the client, which can use large amounts of memory and slow performance.</span></span>  
  
 <span data-ttu-id="31a8c-114">應用程式會在連接到資料來源之前，使用[SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md)來設定 SQL_ATTR_ODBC_CURSORS 連接屬性，藉以依連接叫用游標程式庫。</span><span class="sxs-lookup"><span data-stu-id="31a8c-114">An application invokes the cursor library on a connection-by-connection basis by using [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to set the SQL_ATTR_ODBC_CURSORS connection attribute before connecting to a data source.</span></span> <span data-ttu-id="31a8c-115">SQL_ATTR_ODBC_CURSORS 會設定為下列三個值之一：</span><span class="sxs-lookup"><span data-stu-id="31a8c-115">SQL_ATTR_ODBC_CURSORS is set to one of three values:</span></span>  
  
 <span data-ttu-id="31a8c-116">SQL_CUR_USE_ODBC</span><span class="sxs-lookup"><span data-stu-id="31a8c-116">SQL_CUR_USE_ODBC</span></span>  
 <span data-ttu-id="31a8c-117">當此選項設定為 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native CLIENT odbc 驅動程式時，ODBC 資料指標程式庫會覆寫 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] NATIVE client odbc 驅動程式的原生資料指標支援。</span><span class="sxs-lookup"><span data-stu-id="31a8c-117">When this option is set with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, the ODBC cursor library overrides the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver's native cursor support.</span></span> <span data-ttu-id="31a8c-118">連接只能使用資料指標程式庫所支援的資料指標類型，而不能使用伺服器資料指標。</span><span class="sxs-lookup"><span data-stu-id="31a8c-118">Only the cursor types supported by the cursor library can be used for the connection; server cursors cannot be used.</span></span>  
  
 <span data-ttu-id="31a8c-119">SQL_CUR_USE_DRIVER</span><span class="sxs-lookup"><span data-stu-id="31a8c-119">SQL_CUR_USE_DRIVER</span></span>  
 <span data-ttu-id="31a8c-120">當設定這個選項時，native Client ODBC 驅動程式的原生支援的所有資料指標都 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 可以用於連接。</span><span class="sxs-lookup"><span data-stu-id="31a8c-120">When this option is set, all of the cursor support native to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver can be used for the connection.</span></span> <span data-ttu-id="31a8c-121">而不能使用 ODBC 資料指標程式庫。</span><span class="sxs-lookup"><span data-stu-id="31a8c-121">The ODBC cursor library cannot be used.</span></span> <span data-ttu-id="31a8c-122">所有的資料指標都會實作為伺服器資料指標。</span><span class="sxs-lookup"><span data-stu-id="31a8c-122">All cursors are implemented as server cursors.</span></span>  
  
 <span data-ttu-id="31a8c-123">SQL_CUR_USE_IF_NEEDED</span><span class="sxs-lookup"><span data-stu-id="31a8c-123">SQL_CUR_USE_IF_NEEDED</span></span>  
 <span data-ttu-id="31a8c-124">當設定這個選項時，與 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native CLIENT ODBC 驅動程式搭配使用時，效果會與 SQL_CUR_USE_DRIVER 相同。</span><span class="sxs-lookup"><span data-stu-id="31a8c-124">When this option is set, the effect is the same as SQL_CUR_USE_DRIVER when used with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver.</span></span> <span data-ttu-id="31a8c-125">在連線時間，ODBC 驅動程式管理員會測試是否已連接 ODBC 驅動程式，以支援[SQLFetchScroll](../../native-client-odbc-api/sqlfetchscroll.md)的 SQL_FETCH_PRIOR 選項。</span><span class="sxs-lookup"><span data-stu-id="31a8c-125">At connect time, the ODBC Driver Manager tests to see if the ODBC driver being connected to supports the SQL_FETCH_PRIOR option of [SQLFetchScroll](../../native-client-odbc-api/sqlfetchscroll.md).</span></span> <span data-ttu-id="31a8c-126">如果驅動程式不支援這個選項，則 ODBC 驅動程式管理員會載入 ODBC 資料指標程式庫。</span><span class="sxs-lookup"><span data-stu-id="31a8c-126">If the driver does not support the option, the ODBC Driver Manager loads the ODBC cursor library.</span></span> <span data-ttu-id="31a8c-127">如果驅動程式支援這個選項，則 ODBC 驅動程式管理員不會載入 ODBC 資料指標程式庫，而應用程式會使用該驅動程式的原生支援。</span><span class="sxs-lookup"><span data-stu-id="31a8c-127">If the driver does support the option, the ODBC Driver Manager does not load the ODBC cursor library and the application uses the native support of the driver.</span></span> <span data-ttu-id="31a8c-128">因為 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native CLIENT ODBC 驅動程式支援 SQL_FETCH_PRIOR，所以 Odbc 驅動程式管理員不會載入 odbc 資料指標程式庫。</span><span class="sxs-lookup"><span data-stu-id="31a8c-128">Because the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports SQL_FETCH_PRIOR, the ODBC Driver Manager does not load the ODBC cursor library.</span></span>  
  
 <span data-ttu-id="31a8c-129">資料指標程式庫可以讓應用程式在連接上使用多個作用中陳述式，以及可捲動且可更新的資料指標。</span><span class="sxs-lookup"><span data-stu-id="31a8c-129">The cursor library allows applications to use multiple active statements on a connection, as well as scrollable, updatable cursors.</span></span> <span data-ttu-id="31a8c-130">資料指標程式庫必須載入，才能支援這項功能。</span><span class="sxs-lookup"><span data-stu-id="31a8c-130">The cursor library must be loaded to support this functionality.</span></span> <span data-ttu-id="31a8c-131">使用[SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md)來指定資料指標程式庫的使用方式，並[SQLSetStmtAttr](../../native-client-odbc-api/sqlsetstmtattr.md)以指定資料指標類型、並行和資料列集大小。</span><span class="sxs-lookup"><span data-stu-id="31a8c-131">Use [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to specify how the cursor library should be used and [SQLSetStmtAttr](../../native-client-odbc-api/sqlsetstmtattr.md) to specify the cursor type, concurrency, and rowset size.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="31a8c-132">另請參閱</span><span class="sxs-lookup"><span data-stu-id="31a8c-132">See Also</span></span>  
 [<span data-ttu-id="31a8c-133">如何實作資料指標</span><span class="sxs-lookup"><span data-stu-id="31a8c-133">How Cursors Are Implemented</span></span>](how-cursors-are-implemented.md)  
  
  
