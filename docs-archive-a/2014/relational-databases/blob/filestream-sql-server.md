---
title: FILESTREAM (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: filestream
ms.topic: conceptual
helpviewer_keywords:
- FILESTREAM [SQL Server]
- FILESTREAM [SQL Server], about
- FILESTREAM [SQL Server], overview
ms.assetid: 9a5a8166-bcbe-4680-916c-26276253eafa
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 971f45fd69f381a8997bb2f8f08444f4d9c107c4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/04/2020
ms.locfileid: "87707622"
---
# <a name="filestream-sql-server"></a><span data-ttu-id="e51b1-102">FILESTREAM (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="e51b1-102">FILESTREAM (SQL Server)</span></span>
  <span data-ttu-id="e51b1-103">FILESTREAM 可讓 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]架構應用程式在檔案系統上儲存非結構化的資料，例如文件和影像。</span><span class="sxs-lookup"><span data-stu-id="e51b1-103">FILESTREAM enables [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-based applications to store unstructured data, such as documents and images, on the file system.</span></span> <span data-ttu-id="e51b1-104">應用程式可以利用檔案系統的豐富資料流 API 和效能，並同時維護非結構化資料與對應結構化資料之間的交易一致性。</span><span class="sxs-lookup"><span data-stu-id="e51b1-104">Applications can leverage the rich streaming APIs and performance of the file system and at the same time maintain transactional consistency between the unstructured data and corresponding structured data.</span></span>  
  
 <span data-ttu-id="e51b1-105">FILESTREAM 將 [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] 與 NTFS 檔案系統整合，方法是 `varbinary(max)` 將二進位大型物件 (BLOB) 資料儲存為檔案系統上的檔案。</span><span class="sxs-lookup"><span data-stu-id="e51b1-105">FILESTREAM integrates the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] with an NTFS file system by storing `varbinary(max)` binary large object (BLOB) data as files on the file system.</span></span> [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="e51b1-106">陳述式可以插入、更新、查詢、搜尋和備份 FILESTREAM 資料。</span><span class="sxs-lookup"><span data-stu-id="e51b1-106">statements can insert, update, query, search, and back up FILESTREAM data.</span></span> <span data-ttu-id="e51b1-107">Win32 檔案系統介面提供了資料的資料流方式存取。</span><span class="sxs-lookup"><span data-stu-id="e51b1-107">Win32 file system interfaces provide streaming access to the data.</span></span>  
  
 <span data-ttu-id="e51b1-108">FILESTREAM 會使用 NT 系統快取來儲存檔案資料。</span><span class="sxs-lookup"><span data-stu-id="e51b1-108">FILESTREAM uses the NT system cache for caching file data.</span></span> <span data-ttu-id="e51b1-109">如此可減少 FILESTREAM 資料可能對 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 效能產生的任何影響。</span><span class="sxs-lookup"><span data-stu-id="e51b1-109">This helps reduce any effect that FILESTREAM data might have on [!INCLUDE[ssDE](../../includes/ssde-md.md)] performance.</span></span> <span data-ttu-id="e51b1-110">並不會使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 緩衝集區；因此，此記憶體可用於查詢處理。</span><span class="sxs-lookup"><span data-stu-id="e51b1-110">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] buffer pool is not used; therefore, this memory is available for query processing.</span></span>  
  
 <span data-ttu-id="e51b1-111">當您安裝或升級 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]時，並不會自動啟用 FILESTREAM。</span><span class="sxs-lookup"><span data-stu-id="e51b1-111">FILESTREAM is not automatically enabled when you install or upgrade [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="e51b1-112">您必須使用 SQL Server 組態管理員和 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]來啟用 FILESTREAM。</span><span class="sxs-lookup"><span data-stu-id="e51b1-112">You must enable FILESTREAM by using SQL Server Configuration Manager and [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="e51b1-113">若要使用 FILESTREAM，您必須建立或修改資料庫，以便包含特殊類型的檔案群組。</span><span class="sxs-lookup"><span data-stu-id="e51b1-113">To use FILESTREAM, you must create or modify a database to contain a special type of filegroup.</span></span> <span data-ttu-id="e51b1-114">然後，請建立或修改資料表，讓它包含具有 FILESTREAM 屬性的 `varbinary(max)` 資料行。</span><span class="sxs-lookup"><span data-stu-id="e51b1-114">Then, create or modify a table so that it contains a `varbinary(max)` column with the FILESTREAM attribute.</span></span> <span data-ttu-id="e51b1-115">完成這些工作之後，您就可以使用 [!INCLUDE[tsql](../../includes/tsql-md.md)] 和 Win32 來管理 FILESTREAM 資料。</span><span class="sxs-lookup"><span data-stu-id="e51b1-115">After you complete these tasks, you can use [!INCLUDE[tsql](../../includes/tsql-md.md)] and Win32 to manage the FILESTREAM data.</span></span>  
  
 <span data-ttu-id="e51b1-116">如需安裝和使用 FILESTREAM 的詳細資訊，請參閱[相關](#reltasks)工作清單。</span><span class="sxs-lookup"><span data-stu-id="e51b1-116">For more information about installing and using FILESTREAM, see the list of [Related Tasks](#reltasks).</span></span>  
  
##  <a name="when-to-use-filestream"></a><a name="whentouse"></a><span data-ttu-id="e51b1-117">使用 FILESTREAM 的時機</span><span class="sxs-lookup"><span data-stu-id="e51b1-117">When to Use FILESTREAM</span></span>  
 <span data-ttu-id="e51b1-118">在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 中，BLOB 可以是將資料儲存在資料表中的標準 `varbinary(max)` 資料，或是將資料儲存在檔案系統中的 FILESTREAM `varbinary(max)` 物件。</span><span class="sxs-lookup"><span data-stu-id="e51b1-118">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], BLOBs can be standard `varbinary(max)` data that stores the data in tables, or FILESTREAM `varbinary(max)` objects that store the data in the file system.</span></span> <span data-ttu-id="e51b1-119">資料的大小和使用情況可決定您是應該使用資料庫儲存體還是檔案系統儲存體。</span><span class="sxs-lookup"><span data-stu-id="e51b1-119">The size and use of the data determines whether you should use database storage or file system storage.</span></span> <span data-ttu-id="e51b1-120">如果下列條件成立，您應該考慮使用 FILESTREAM：</span><span class="sxs-lookup"><span data-stu-id="e51b1-120">If the following conditions are true, you should consider using FILESTREAM:</span></span>  
  
-   <span data-ttu-id="e51b1-121">平均來說，儲存的物件大於 1 MB。</span><span class="sxs-lookup"><span data-stu-id="e51b1-121">Objects that are being stored are, on average, larger than 1 MB.</span></span>  
  
-   <span data-ttu-id="e51b1-122">快速讀取權非常重要。</span><span class="sxs-lookup"><span data-stu-id="e51b1-122">Fast read access is important.</span></span>  
  
-   <span data-ttu-id="e51b1-123">您正在開發將中介層用於應用程式邏輯的應用程式。</span><span class="sxs-lookup"><span data-stu-id="e51b1-123">You are developing applications that use a middle tier for application logic.</span></span>  
  
 <span data-ttu-id="e51b1-124">如果是較小的物件，將 `varbinary(max)` BLOB 儲存在資料庫中通常會提供更好的資料流處理效能。</span><span class="sxs-lookup"><span data-stu-id="e51b1-124">For smaller objects, storing `varbinary(max)` BLOBs in the database often provides better streaming performance.</span></span>  
  
  
##  <a name="filestream-storage"></a><a name="storage"></a><span data-ttu-id="e51b1-125">FILESTREAM 儲存體</span><span class="sxs-lookup"><span data-stu-id="e51b1-125">FILESTREAM Storage</span></span>  
 <span data-ttu-id="e51b1-126">FILESTREAM 儲存體會實作為 `varbinary(max)` 資料行，該資料行中的資料會當做 BLOB 儲存在檔案系統上。</span><span class="sxs-lookup"><span data-stu-id="e51b1-126">FILESTREAM storage is implemented as a `varbinary(max)` column in which the data is stored as BLOBs in the file system.</span></span> <span data-ttu-id="e51b1-127">BLOB 的大小只受到檔案系統磁碟區大小的限制。</span><span class="sxs-lookup"><span data-stu-id="e51b1-127">The sizes of the BLOBs are limited only by the volume size of the file system.</span></span> <span data-ttu-id="e51b1-128">標準 `varbinary(max)` 限制 (2-GB 檔案大小) 不適用於檔案系統中所儲存的 BLOB。</span><span class="sxs-lookup"><span data-stu-id="e51b1-128">The standard `varbinary(max)` limitation of 2-GB file sizes does not apply to BLOBs that are stored in the file system.</span></span>  
  
 <span data-ttu-id="e51b1-129">若要指定資料行應該將資料儲存在檔案系統上，請在 `varbinary(max)` 資料行上指定 FILESTREAM 屬性。</span><span class="sxs-lookup"><span data-stu-id="e51b1-129">To specify that a column should store data on the file system, specify the FILESTREAM attribute on a `varbinary(max)` column.</span></span> <span data-ttu-id="e51b1-130">如此會讓 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 將該資料行的所有資料都儲存在檔案系統上，而不是儲存在資料庫檔案中。</span><span class="sxs-lookup"><span data-stu-id="e51b1-130">This causes the [!INCLUDE[ssDE](../../includes/ssde-md.md)] to store all data for that column on the file system, but not in the database file.</span></span>  
  
 <span data-ttu-id="e51b1-131">FILESTREAM 資料必須儲存在 FILESTREAM 檔案群組中。</span><span class="sxs-lookup"><span data-stu-id="e51b1-131">FILESTREAM data must be stored in FILESTREAM filegroups.</span></span> <span data-ttu-id="e51b1-132">FILESTREAM 檔案群組是包含檔案系統目錄 (而非檔案本身) 的特殊檔案群組，</span><span class="sxs-lookup"><span data-stu-id="e51b1-132">A FILESTREAM filegroup is a special filegroup that contains file system directories instead of the files themselves.</span></span> <span data-ttu-id="e51b1-133">這些檔案系統目錄稱為「資料容器」。</span><span class="sxs-lookup"><span data-stu-id="e51b1-133">These file system directories are called *data containers*.</span></span> <span data-ttu-id="e51b1-134">資料容器是 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 儲存體與檔案系統儲存體之間的介面。</span><span class="sxs-lookup"><span data-stu-id="e51b1-134">Data containers are the interface between [!INCLUDE[ssDE](../../includes/ssde-md.md)] storage and file system storage.</span></span>  
  
 <span data-ttu-id="e51b1-135">當您使用 FILESTREAM 儲存體時，請考慮以下事項：</span><span class="sxs-lookup"><span data-stu-id="e51b1-135">When you use FILESTREAM storage, consider the following:</span></span>  
  
-   <span data-ttu-id="e51b1-136">當資料表包含 FILESTREAM 資料行時，每一個資料列都必須有唯一的非 Null 資料列識別碼。</span><span class="sxs-lookup"><span data-stu-id="e51b1-136">When a table contains a FILESTREAM column, each row must have a nonnull unique row ID.</span></span>  
  
-   <span data-ttu-id="e51b1-137">您可以將多個資料容器加入至 FILESTREAM 檔案群組。</span><span class="sxs-lookup"><span data-stu-id="e51b1-137">Multiple data containers can be added to a FILESTREAM filegroup.</span></span>  
  
-   <span data-ttu-id="e51b1-138">FILESTREAM 資料容器無法巢狀化。</span><span class="sxs-lookup"><span data-stu-id="e51b1-138">FILESTREAM data containers cannot be nested.</span></span>  
  
-   <span data-ttu-id="e51b1-139">當您正在使用容錯移轉叢集時，FILESTREAM 檔案群組必須在共用磁碟資源上。</span><span class="sxs-lookup"><span data-stu-id="e51b1-139">When you are using failover clustering, the FILESTREAM filegroups must be on shared disk resources.</span></span>  
  
-   <span data-ttu-id="e51b1-140">FILESTREAM 檔案群組可以在壓縮的磁碟區上。</span><span class="sxs-lookup"><span data-stu-id="e51b1-140">FILESTREAM filegroups can be on compressed volumes.</span></span>  
  
### <a name="integrated-management"></a><span data-ttu-id="e51b1-141">整合式管理</span><span class="sxs-lookup"><span data-stu-id="e51b1-141">Integrated Management</span></span>  
 <span data-ttu-id="e51b1-142">由於 FILESTREAM 會實作為 `varbinary(max)` 資料行，並直接整合到 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 中，所以大多數的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 管理工具和功能不需要修改 FILESTREAM 資料即可運作。</span><span class="sxs-lookup"><span data-stu-id="e51b1-142">Because FILESTREAM is implemented as a `varbinary(max)` column and integrated directly into the [!INCLUDE[ssDE](../../includes/ssde-md.md)], most [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] management tools and functions work without modification for FILESTREAM data.</span></span> <span data-ttu-id="e51b1-143">例如，您可以搭配 FILESTREAM 資料使用所有的備份和復原模型，而且 FILESTREAM 資料會與資料庫中的結構化資料一起備份。</span><span class="sxs-lookup"><span data-stu-id="e51b1-143">For example, you can use all backup and recovery models with FILESTREAM data, and the FILESTREAM data is backed up with the structured data in the database.</span></span> <span data-ttu-id="e51b1-144">如果您不想要將 FILESTREAM 資料與關聯式資料一起備份，您可以使用部分備份來排除 FILESTREAM 檔案群組。</span><span class="sxs-lookup"><span data-stu-id="e51b1-144">If you do not want to back up FILESTREAM data with relational data, you can use a partial backup to exclude FILESTREAM filegroups.</span></span>  

  
### <a name="integrated-security"></a><span data-ttu-id="e51b1-145">整合式安全性</span><span class="sxs-lookup"><span data-stu-id="e51b1-145">Integrated Security</span></span>  
 <span data-ttu-id="e51b1-146">在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]中，系統會維護 FILESTREAM 資料的安全性，就像是維護其他資料的安全性一樣：在資料表或資料行層級上授與權限。</span><span class="sxs-lookup"><span data-stu-id="e51b1-146">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], FILESTREAM data is secured just like other data is secured: by granting permissions at the table or column levels.</span></span> <span data-ttu-id="e51b1-147">如果使用者具有資料表中 FILESTREAM 資料行的權限，該使用者便可開啟關聯的檔案。</span><span class="sxs-lookup"><span data-stu-id="e51b1-147">If a user has permission to the FILESTREAM column in a table, the user can open the associated files.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e51b1-148">FILESTREAM 資料上不支援加密。</span><span class="sxs-lookup"><span data-stu-id="e51b1-148">Encryption is not supported on FILESTREAM data.</span></span>  
  
 <span data-ttu-id="e51b1-149">只有執行 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 服務帳戶所使用的帳戶會被授與 FILESTREAM 容器的 NTFS 權限。</span><span class="sxs-lookup"><span data-stu-id="e51b1-149">Only the account under which the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service account runs is granted NTFS permissions to the FILESTREAM container.</span></span> <span data-ttu-id="e51b1-150">我們建議您不要將資料容器的權限授與其他帳戶。</span><span class="sxs-lookup"><span data-stu-id="e51b1-150">We recommend that no other account be granted permissions on the data container.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e51b1-151">SQL 登入不會使用 FILESTREAM 容器。</span><span class="sxs-lookup"><span data-stu-id="e51b1-151">SQL logins will not work with FILESTREAM containers.</span></span> <span data-ttu-id="e51b1-152">只有 NTFS 驗證會使用 FILESTREAM 容器。</span><span class="sxs-lookup"><span data-stu-id="e51b1-152">Only NTFS authentication will work with FILESTREAM containers.</span></span>  
  
##  <a name="accessing-blob-data-with-transact-sql-and-file-system-streaming-access"></a><a name="dual"></a> <span data-ttu-id="e51b1-153">使用 Transact-SQL 和檔案系統資料流存取來存取 BLOB 資料</span><span class="sxs-lookup"><span data-stu-id="e51b1-153">Accessing BLOB Data with Transact-SQL and File System Streaming Access</span></span>  
 <span data-ttu-id="e51b1-154">在您將資料儲存在 FILESTREAM 資料行中以後，可以使用 [!INCLUDE[tsql](../../includes/tsql-md.md)] 交易或 Win32 API 來存取檔案。</span><span class="sxs-lookup"><span data-stu-id="e51b1-154">After you store data in a FILESTREAM column, you can access the files by using [!INCLUDE[tsql](../../includes/tsql-md.md)] transactions or by using Win32 APIs.</span></span>  
  
### <a name="transact-sql-access"></a><span data-ttu-id="e51b1-155">Transact-SQL 存取</span><span class="sxs-lookup"><span data-stu-id="e51b1-155">Transact-SQL Access</span></span>  
 <span data-ttu-id="e51b1-156">您可以藉由使用 [!INCLUDE[tsql](../../includes/tsql-md.md)]來插入、更新和刪除 FILESTREAM 資料：</span><span class="sxs-lookup"><span data-stu-id="e51b1-156">By using [!INCLUDE[tsql](../../includes/tsql-md.md)], you can insert, update, and delete FILESTREAM data:</span></span>  
  
-   <span data-ttu-id="e51b1-157">您可以使用插入作業，在 FILESTREAM 欄位中預先填入 null 值、空白值，或是相當簡短的內嵌資料。</span><span class="sxs-lookup"><span data-stu-id="e51b1-157">You can use an insert operation to prepopulate a FILESTREAM field with a null value, empty value, or relatively short inline data.</span></span> <span data-ttu-id="e51b1-158">但是，將大量的資料當做資料流處理成使用 Win32 介面的檔案時，會比較有效率。</span><span class="sxs-lookup"><span data-stu-id="e51b1-158">However, a large amount of data is more efficiently streamed into a file that uses Win32 interfaces.</span></span>  
  
-   <span data-ttu-id="e51b1-159">當您更新 FILESTREAM 欄位時，您會修改檔案系統中的基礎 BLOB 資料。</span><span class="sxs-lookup"><span data-stu-id="e51b1-159">When you update a FILESTREAM field, you modify the underlying BLOB data in the file system.</span></span> <span data-ttu-id="e51b1-160">當 FILESTREAM 欄位設定為 NULL 時，與此欄位有關聯的 BLOB 資料會遭到刪除。</span><span class="sxs-lookup"><span data-stu-id="e51b1-160">When a FILESTREAM field is set to NULL, the BLOB data associated with the field is deleted.</span></span> <span data-ttu-id="e51b1-161">您無法使用實作為 UPDATE [!INCLUDE[tsql](../../includes/tsql-md.md)] .**Write() 的**區塊更新來執行資料的部分更新。</span><span class="sxs-lookup"><span data-stu-id="e51b1-161">You cannot use a [!INCLUDE[tsql](../../includes/tsql-md.md)] chunked update, implemented as UPDATE **.** Write(), to perform partial updates to the data.</span></span>  
  
-   <span data-ttu-id="e51b1-162">當您刪除資料列，或是刪除或截斷包含 FILESTREAM 資料的資料表時，您會刪除檔案系統中的基礎 BLOB 資料。</span><span class="sxs-lookup"><span data-stu-id="e51b1-162">When you delete a row or delete or truncate a table that contains FILESTREAM data, you delete the underlying BLOB data in the file system.</span></span>  
  
### <a name="file-system-streaming-access"></a><span data-ttu-id="e51b1-163">檔案系統資料流存取</span><span class="sxs-lookup"><span data-stu-id="e51b1-163">File System Streaming Access</span></span>  
 <span data-ttu-id="e51b1-164">Win32 資料流支援可在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 交易的內容中運作。</span><span class="sxs-lookup"><span data-stu-id="e51b1-164">The Win32 streaming support works in the context of a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] transaction.</span></span> <span data-ttu-id="e51b1-165">在交易內時，您可以使用 FILESTREAM 函數來取得檔案的邏輯 UNC 檔案系統路徑。</span><span class="sxs-lookup"><span data-stu-id="e51b1-165">Within a transaction, you can use FILESTREAM functions to obtain a logical UNC file system path of a file.</span></span> <span data-ttu-id="e51b1-166">然後，您可使用 OpenSqlFilestream API 取得檔案控制代碼。</span><span class="sxs-lookup"><span data-stu-id="e51b1-166">You then use the OpenSqlFilestream API to obtain a file handle.</span></span> <span data-ttu-id="e51b1-167">之後，此控制代碼可由 Win32 檔案資料流介面 (如 ReadFile() 和 WriteFile()) 所使用，以透過檔案系統來存取及更新檔案。</span><span class="sxs-lookup"><span data-stu-id="e51b1-167">This handle can then be used by Win32 file streaming interfaces, such as ReadFile() and WriteFile(), to access and update the file by way of the file system.</span></span>  
  
 <span data-ttu-id="e51b1-168">由於檔案作業是交易式，所以您無法透過檔案系統來刪除或重新命名 FILESTREAM 檔案。</span><span class="sxs-lookup"><span data-stu-id="e51b1-168">Because file operations are transactional, you cannot delete or rename FILESTREAM files through the file system.</span></span>  
  
 <span data-ttu-id="e51b1-169">**陳述式模型**</span><span class="sxs-lookup"><span data-stu-id="e51b1-169">**Statement Model**</span></span>  
  
 <span data-ttu-id="e51b1-170">FILESTREAM 檔案系統存取會使用檔案的開啟和關閉來建立 [!INCLUDE[tsql](../../includes/tsql-md.md)] 陳述式的模型。</span><span class="sxs-lookup"><span data-stu-id="e51b1-170">The FILESTREAM file system access models a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement by using file open and close.</span></span> <span data-ttu-id="e51b1-171">當檔案控制代碼開啟時，此陳述式便會開始，而當此控制代碼關閉時，此陳述式就會結束。</span><span class="sxs-lookup"><span data-stu-id="e51b1-171">The statement starts when a file handle is opened and ends when the handle is closed.</span></span> <span data-ttu-id="e51b1-172">例如，當寫入控制代碼關閉時，在資料表上註冊之任何可能的 AFTER 觸發程序便會引發，就像是 UPDATE 陳述式已完成一樣。</span><span class="sxs-lookup"><span data-stu-id="e51b1-172">For example, when a write handle is closed, any possible AFTER trigger that is registered on the table fires as if an UPDATE statement is completed.</span></span>  
  
 <span data-ttu-id="e51b1-173">**儲存體命名空間**</span><span class="sxs-lookup"><span data-stu-id="e51b1-173">**Storage Namespace**</span></span>  
  
 <span data-ttu-id="e51b1-174">在 FILESTREAM 中， [!INCLUDE[ssDE](../../includes/ssde-md.md)] 會控制 BLOB 實體檔案系統命名空間。</span><span class="sxs-lookup"><span data-stu-id="e51b1-174">In FILESTREAM, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] controls the BLOB physical file system namespace.</span></span> <span data-ttu-id="e51b1-175">有一個新的內建函數 [PathName](/sql/relational-databases/system-functions/pathname-transact-sql)提供了對應至資料表內每一個 FILESTREAM 資料格之 BLOB 的邏輯 UNC 路徑。</span><span class="sxs-lookup"><span data-stu-id="e51b1-175">A new intrinsic function, [PathName](/sql/relational-databases/system-functions/pathname-transact-sql), provides the logical UNC path of the BLOB that corresponds to each FILESTREAM cell in the table.</span></span> <span data-ttu-id="e51b1-176">應用程式會使用此邏輯路徑來取得 Win32 控制代碼，並在 BLOB 資料上運作 (透過一般 Win32 檔案系統介面)。</span><span class="sxs-lookup"><span data-stu-id="e51b1-176">The application uses this logical path to obtain the Win32 handle and operate on the BLOB data by using regular Win32 file system interfaces.</span></span> <span data-ttu-id="e51b1-177">如果 FILESTREAM 資料行的值為 NULL，此函數就會傳回 NULL。</span><span class="sxs-lookup"><span data-stu-id="e51b1-177">The function returns NULL if the value of the FILESTREAM column is NULL.</span></span>  
  
 <span data-ttu-id="e51b1-178">**交易檔案系統存取**</span><span class="sxs-lookup"><span data-stu-id="e51b1-178">**Transacted File System Access**</span></span>  
  
 <span data-ttu-id="e51b1-179">有一個新的內建函數 [GET_FILESTREAM_TRANSACTION_CONTEXT()](/sql/t-sql/functions/get-filestream-transaction-context-transact-sql)提供了一個 Token，它代表與工作階段有關聯的目前交易。</span><span class="sxs-lookup"><span data-stu-id="e51b1-179">A new intrinsic function, [GET_FILESTREAM_TRANSACTION_CONTEXT()](/sql/t-sql/functions/get-filestream-transaction-context-transact-sql), provides the token that represents the current transaction that the session is associated with.</span></span> <span data-ttu-id="e51b1-180">此交易必須已經開始，而且尚未中止或認可。</span><span class="sxs-lookup"><span data-stu-id="e51b1-180">The transaction must have been started and not yet aborted or committed.</span></span> <span data-ttu-id="e51b1-181">應用程式會藉由取得 Token，將 FILESTREAM 檔案系統資料流作業與開始的交易繫結。</span><span class="sxs-lookup"><span data-stu-id="e51b1-181">By obtaining a token, the application binds the FILESTREAM file system streaming operations with a started transaction.</span></span> <span data-ttu-id="e51b1-182">如果沒有任何明確開始的交易，此函數就會傳回 NULL。</span><span class="sxs-lookup"><span data-stu-id="e51b1-182">The function returns NULL in case of no explicitly started transaction.</span></span>  
  
 <span data-ttu-id="e51b1-183">在認可或中止此交易之前，所有的檔案控制代碼都必須先關閉。</span><span class="sxs-lookup"><span data-stu-id="e51b1-183">All file handles must be closed before the transaction commits or aborts.</span></span> <span data-ttu-id="e51b1-184">如果有控制代碼在交易範圍之外仍然為開啟狀態，針對此控制代碼的其他讀取將會造成失敗；對此控制代碼的其他寫入將會成功，因為實際資料將不會寫入磁碟中。</span><span class="sxs-lookup"><span data-stu-id="e51b1-184">If a handle is left open beyond the transaction scope, additional reads against the handle will cause a failure; additional writes against the handle will succeed, but the actual data will not be written to disk.</span></span> <span data-ttu-id="e51b1-185">同樣地，如果關閉了 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 的資料庫或執行個體，則所有開啟的控制代碼都將會失效。</span><span class="sxs-lookup"><span data-stu-id="e51b1-185">Similarly, if the database or instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] shuts down, all open handles are invalidated.</span></span>  
  
 <span data-ttu-id="e51b1-186">**交易持久性**</span><span class="sxs-lookup"><span data-stu-id="e51b1-186">**Transactional Durability**</span></span>  
  
 <span data-ttu-id="e51b1-187">使用 FILESTREAM 時， [!INCLUDE[ssDE](../../includes/ssde-md.md)] 會在交易認可之後確保從檔案系統資料流存取修改之 FILESTREAM BLOB 資料的交易持續性。</span><span class="sxs-lookup"><span data-stu-id="e51b1-187">With FILESTREAM, upon transaction commit, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] ensures transaction durability for FILESTREAM BLOB data that is modified from the file system streaming access.</span></span>  
  
 <span data-ttu-id="e51b1-188">**隔離語意**</span><span class="sxs-lookup"><span data-stu-id="e51b1-188">**Isolation Semantics**</span></span>  
  
 <span data-ttu-id="e51b1-189">隔離語意受到 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 交易隔離等級的管制。</span><span class="sxs-lookup"><span data-stu-id="e51b1-189">The isolation semantics are governed by [!INCLUDE[ssDE](../../includes/ssde-md.md)] transaction isolation levels.</span></span> <span data-ttu-id="e51b1-190">讀取認可的隔離等級支援 [!INCLUDE[tsql](../../includes/tsql-md.md)] 和檔案系統存取。</span><span class="sxs-lookup"><span data-stu-id="e51b1-190">Read-committed isolation level is supported for [!INCLUDE[tsql](../../includes/tsql-md.md)] and file system access.</span></span> <span data-ttu-id="e51b1-191">可重複的讀取作業以及可序列化和快照集隔離均受到支援。</span><span class="sxs-lookup"><span data-stu-id="e51b1-191">Repeatable read operations, and also serializable and snapshot isolations, are supported.</span></span> <span data-ttu-id="e51b1-192">中途讀取則不受到支援。</span><span class="sxs-lookup"><span data-stu-id="e51b1-192">Dirty read is not supported.</span></span>  
  
 <span data-ttu-id="e51b1-193">檔案系統存取的開啟作業不會等候任何鎖定。</span><span class="sxs-lookup"><span data-stu-id="e51b1-193">The file system access open operations do not wait for any locks.</span></span> <span data-ttu-id="e51b1-194">如果開啟作業因為交易隔離而無法存取資料，開啟作業就會立即失敗。</span><span class="sxs-lookup"><span data-stu-id="e51b1-194">Instead, the open operations fail immediately if they cannot access the data because of transaction isolation.</span></span> <span data-ttu-id="e51b1-195">如果開啟作業因為隔離違規而無法繼續，則資料流 API 呼叫會因為 ERROR_SHARING_VIOLATION 而失敗。</span><span class="sxs-lookup"><span data-stu-id="e51b1-195">The streaming API calls fail with ERROR_SHARING_VIOLATION if the open operation cannot continue because of isolation violation.</span></span>  
  
 <span data-ttu-id="e51b1-196">若要允許進行部分更新，應用程式可以發出裝置 FS 控制項 (FSCTL_SQL_FILESTREAM_FETCH_OLD_CONTENT)，以便將舊的內容提取到開啟之控制代碼所參考的檔案。</span><span class="sxs-lookup"><span data-stu-id="e51b1-196">To allow for partial updates to be made, the application can issue a device FS control (FSCTL_SQL_FILESTREAM_FETCH_OLD_CONTENT) to fetch the old content into the file that the opened handle references.</span></span> <span data-ttu-id="e51b1-197">如此將會觸發伺服器端的舊內容複本。</span><span class="sxs-lookup"><span data-stu-id="e51b1-197">This will trigger a server-side old content copy.</span></span> <span data-ttu-id="e51b1-198">為了在處理極大型的檔案時取得更好的應用程式效能及避免可能的逾時，我們建議您使用非同步 I/O。</span><span class="sxs-lookup"><span data-stu-id="e51b1-198">For better application performance and to avoid running into potential time-outs when you are working with very large files, we recommend that you use asynchronous I/O.</span></span>  
  
 <span data-ttu-id="e51b1-199">如果在寫入此控制代碼之後發出 FSCTL，則最後一個寫入作業將會保存下來，而之前對此控制代碼的寫入將會遺失。</span><span class="sxs-lookup"><span data-stu-id="e51b1-199">If the FSCTL is issued after the handle has been written to, the last write operation will persist, and prior writes that were made to the handle are lost.</span></span>  
  
 <span data-ttu-id="e51b1-200">**檔案系統 API 和支援的隔離等級**</span><span class="sxs-lookup"><span data-stu-id="e51b1-200">**File System APIs and Supported Isolation Levels**</span></span>  
  
 <span data-ttu-id="e51b1-201">當檔案系統 API 由於隔離違規而無法開啟檔案時，系統就會傳回 ERROR_SHARING_VIOLATION 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="e51b1-201">When a file system API cannot open a file because of an isolation violation, an ERROR_SHARING_VIOLATION exception is returned.</span></span> <span data-ttu-id="e51b1-202">當兩筆交易嘗試存取相同的檔案時，就會發生這種隔離違規。</span><span class="sxs-lookup"><span data-stu-id="e51b1-202">This isolation violation occurs when two transactions try to access the same file.</span></span> <span data-ttu-id="e51b1-203">存取作業的結果主要取決於用來開啟檔案的模式，以及執行交易的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 版本。</span><span class="sxs-lookup"><span data-stu-id="e51b1-203">The outcome of the access operation depends on the mode the file was opened in and the version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that the transaction is running on.</span></span> <span data-ttu-id="e51b1-204">下表概述了兩筆存取相同檔案之交易的可能結果。</span><span class="sxs-lookup"><span data-stu-id="e51b1-204">The following table outlines the possibly outcomes for two transactions that are accessing the same file.</span></span>  
  
|<span data-ttu-id="e51b1-205">交易 1</span><span class="sxs-lookup"><span data-stu-id="e51b1-205">Transaction 1</span></span>|<span data-ttu-id="e51b1-206">交易 2</span><span class="sxs-lookup"><span data-stu-id="e51b1-206">Transaction 2</span></span>|<span data-ttu-id="e51b1-207">在 SQL Server 2008 上的結果</span><span class="sxs-lookup"><span data-stu-id="e51b1-207">Outcome on SQL Server 2008</span></span>|<span data-ttu-id="e51b1-208">在 SQL Server 2008 R2 和更新版本上的結果</span><span class="sxs-lookup"><span data-stu-id="e51b1-208">Outcome on SQL Server 2008 R2 and later versions</span></span>|  
|-------------------|-------------------|--------------------------------|------------------------------------------------------|  
|<span data-ttu-id="e51b1-209">開啟以便讀取。</span><span class="sxs-lookup"><span data-stu-id="e51b1-209">Open for read.</span></span>|<span data-ttu-id="e51b1-210">開啟以便讀取。</span><span class="sxs-lookup"><span data-stu-id="e51b1-210">Open for read.</span></span>|<span data-ttu-id="e51b1-211">兩筆交易都成功。</span><span class="sxs-lookup"><span data-stu-id="e51b1-211">Both succeed.</span></span>|<span data-ttu-id="e51b1-212">兩筆交易都成功。</span><span class="sxs-lookup"><span data-stu-id="e51b1-212">Both succeed.</span></span>|  
|<span data-ttu-id="e51b1-213">開啟以便讀取。</span><span class="sxs-lookup"><span data-stu-id="e51b1-213">Open for read.</span></span>|<span data-ttu-id="e51b1-214">開啟以便寫入。</span><span class="sxs-lookup"><span data-stu-id="e51b1-214">Open for write.</span></span>|<span data-ttu-id="e51b1-215">兩筆交易都成功。</span><span class="sxs-lookup"><span data-stu-id="e51b1-215">Both succeed.</span></span> <span data-ttu-id="e51b1-216">交易 2 底下的寫入作業不會影響在交易 1 中執行的讀取作業。</span><span class="sxs-lookup"><span data-stu-id="e51b1-216">Write operations under transaction 2 do not affect read operations performed in transaction 1.</span></span>|<span data-ttu-id="e51b1-217">兩筆交易都成功。</span><span class="sxs-lookup"><span data-stu-id="e51b1-217">Both succeed.</span></span> <span data-ttu-id="e51b1-218">交易 2 底下的寫入作業不會影響在交易 1 中執行的讀取作業。</span><span class="sxs-lookup"><span data-stu-id="e51b1-218">Write operations under transaction 2 do not affect read operations performed in transaction 1.</span></span>|  
|<span data-ttu-id="e51b1-219">開啟以便寫入。</span><span class="sxs-lookup"><span data-stu-id="e51b1-219">Open for write.</span></span>|<span data-ttu-id="e51b1-220">開啟以便讀取。</span><span class="sxs-lookup"><span data-stu-id="e51b1-220">Open for read.</span></span>|<span data-ttu-id="e51b1-221">交易 2 的開啟作業失敗，並傳回 ERROR_SHARING_VIOLATION 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="e51b1-221">Open for transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|<span data-ttu-id="e51b1-222">兩筆交易都成功。</span><span class="sxs-lookup"><span data-stu-id="e51b1-222">Both succeed.</span></span>|  
|<span data-ttu-id="e51b1-223">開啟以便寫入。</span><span class="sxs-lookup"><span data-stu-id="e51b1-223">Open for write.</span></span>|<span data-ttu-id="e51b1-224">開啟以便寫入。</span><span class="sxs-lookup"><span data-stu-id="e51b1-224">Open for write.</span></span>|<span data-ttu-id="e51b1-225">交易 2 的開啟作業失敗，並傳回 ERROR_SHARING_VIOLATION 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="e51b1-225">Open for transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|<span data-ttu-id="e51b1-226">交易 2 的開啟作業失敗，並傳回 ERROR_SHARING_VIOLATION 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="e51b1-226">Open for transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|  
|<span data-ttu-id="e51b1-227">開啟以便讀取。</span><span class="sxs-lookup"><span data-stu-id="e51b1-227">Open for read.</span></span>|<span data-ttu-id="e51b1-228">開啟以便進行 SELECT。</span><span class="sxs-lookup"><span data-stu-id="e51b1-228">Open for SELECT.</span></span>|<span data-ttu-id="e51b1-229">兩筆交易都成功。</span><span class="sxs-lookup"><span data-stu-id="e51b1-229">Both succeed.</span></span>|<span data-ttu-id="e51b1-230">兩筆交易都成功。</span><span class="sxs-lookup"><span data-stu-id="e51b1-230">Both succeed.</span></span>|  
|<span data-ttu-id="e51b1-231">開啟以便讀取。</span><span class="sxs-lookup"><span data-stu-id="e51b1-231">Open for read.</span></span>|<span data-ttu-id="e51b1-232">開啟以便進行 UPDATE 或 DELETE。</span><span class="sxs-lookup"><span data-stu-id="e51b1-232">Open for UPDATE or DELETE.</span></span>|<span data-ttu-id="e51b1-233">兩筆交易都成功。</span><span class="sxs-lookup"><span data-stu-id="e51b1-233">Both succeed.</span></span> <span data-ttu-id="e51b1-234">交易 2 底下的寫入作業不會影響在交易 1 中執行的讀取作業。</span><span class="sxs-lookup"><span data-stu-id="e51b1-234">Write operations under transaction 2 do not affect read operations performed in transaction 1.</span></span>|<span data-ttu-id="e51b1-235">兩筆交易都成功。</span><span class="sxs-lookup"><span data-stu-id="e51b1-235">Both succeed.</span></span> <span data-ttu-id="e51b1-236">交易 2 底下的寫入作業不會影響在交易 1 中執行的讀取作業。</span><span class="sxs-lookup"><span data-stu-id="e51b1-236">Write operations under transaction 2 do not affect read operations performed in transaction 1.</span></span>|  
|<span data-ttu-id="e51b1-237">開啟以便寫入。</span><span class="sxs-lookup"><span data-stu-id="e51b1-237">Open for write.</span></span>|<span data-ttu-id="e51b1-238">開啟以便進行 SELECT。</span><span class="sxs-lookup"><span data-stu-id="e51b1-238">open for SELECT.</span></span>|<span data-ttu-id="e51b1-239">交易 2 會封鎖直到交易 1 認可或結束交易，或者交易鎖定逾時為止。</span><span class="sxs-lookup"><span data-stu-id="e51b1-239">Transaction 2 blocks until transaction 1 commits or ends the transaction, or the transaction lock times out.</span></span>|<span data-ttu-id="e51b1-240">兩筆交易都成功。</span><span class="sxs-lookup"><span data-stu-id="e51b1-240">Both succeed.</span></span>|  
|<span data-ttu-id="e51b1-241">開啟以便寫入。</span><span class="sxs-lookup"><span data-stu-id="e51b1-241">Open for write.</span></span>|<span data-ttu-id="e51b1-242">開啟以便進行 UPDATE 或 DELETE。</span><span class="sxs-lookup"><span data-stu-id="e51b1-242">Open for UPDATE or DELETE.</span></span>|<span data-ttu-id="e51b1-243">交易 2 會封鎖直到交易 1 認可或結束交易，或者交易鎖定逾時為止。</span><span class="sxs-lookup"><span data-stu-id="e51b1-243">Transaction 2 blocks until transaction 1 commits or ends the transaction, or the transaction lock times out.</span></span>|<span data-ttu-id="e51b1-244">交易 2 會封鎖直到交易 1 認可或結束交易，或者交易鎖定逾時為止。</span><span class="sxs-lookup"><span data-stu-id="e51b1-244">Transaction 2 blocks until transaction 1 commits or ends the transaction, or the transaction lock times out.</span></span>|  
|<span data-ttu-id="e51b1-245">開啟以便進行 SELECT。</span><span class="sxs-lookup"><span data-stu-id="e51b1-245">Open for SELECT.</span></span>|<span data-ttu-id="e51b1-246">開啟以便讀取。</span><span class="sxs-lookup"><span data-stu-id="e51b1-246">Open for read.</span></span>|<span data-ttu-id="e51b1-247">兩筆交易都成功。</span><span class="sxs-lookup"><span data-stu-id="e51b1-247">Both succeed.</span></span>|<span data-ttu-id="e51b1-248">兩筆交易都成功。</span><span class="sxs-lookup"><span data-stu-id="e51b1-248">Both succeed.</span></span>|  
|<span data-ttu-id="e51b1-249">開啟以便進行 SELECT。</span><span class="sxs-lookup"><span data-stu-id="e51b1-249">Open for SELECT.</span></span>|<span data-ttu-id="e51b1-250">開啟以便寫入。</span><span class="sxs-lookup"><span data-stu-id="e51b1-250">Open for write.</span></span>|<span data-ttu-id="e51b1-251">兩筆交易都成功。</span><span class="sxs-lookup"><span data-stu-id="e51b1-251">Both succeed.</span></span> <span data-ttu-id="e51b1-252">交易 2 底下的寫入作業不會影響交易 1。</span><span class="sxs-lookup"><span data-stu-id="e51b1-252">Write operations under transaction 2 do not affect transaction 1.</span></span>|<span data-ttu-id="e51b1-253">兩筆交易都成功。</span><span class="sxs-lookup"><span data-stu-id="e51b1-253">Both succeed.</span></span> <span data-ttu-id="e51b1-254">交易 2 底下的寫入作業不會影響交易 1。</span><span class="sxs-lookup"><span data-stu-id="e51b1-254">Write operations under transaction 2 do not affect transaction 1.</span></span>|  
|<span data-ttu-id="e51b1-255">開啟以便進行 UPDATE 或 DELETE。</span><span class="sxs-lookup"><span data-stu-id="e51b1-255">Open for UPDATE or DELETE.</span></span>|<span data-ttu-id="e51b1-256">開啟以便讀取。</span><span class="sxs-lookup"><span data-stu-id="e51b1-256">Open for read.</span></span>|<span data-ttu-id="e51b1-257">交易 2 的開啟作業失敗，並傳回 ERROR_SHARING_VIOLATION 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="e51b1-257">The open operation on transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|<span data-ttu-id="e51b1-258">兩筆交易都成功。</span><span class="sxs-lookup"><span data-stu-id="e51b1-258">Both succeed.</span></span>|  
|<span data-ttu-id="e51b1-259">開啟以便進行 UPDATE 或 DELETE。</span><span class="sxs-lookup"><span data-stu-id="e51b1-259">Open for UPDATE or DELETE.</span></span>|<span data-ttu-id="e51b1-260">開啟以便寫入。</span><span class="sxs-lookup"><span data-stu-id="e51b1-260">Open for write.</span></span>|<span data-ttu-id="e51b1-261">交易 2 的開啟作業失敗，並傳回 ERROR_SHARING_VIOLATION 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="e51b1-261">The open operation on transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|<span data-ttu-id="e51b1-262">交易 2 的開啟作業失敗，並傳回 ERROR_SHARING_VIOLATION 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="e51b1-262">The open operation on transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|  
|<span data-ttu-id="e51b1-263">開啟以便進行可重複讀取的 SELECT。</span><span class="sxs-lookup"><span data-stu-id="e51b1-263">Open for SELECT with repeatable read.</span></span>|<span data-ttu-id="e51b1-264">開啟以便讀取。</span><span class="sxs-lookup"><span data-stu-id="e51b1-264">Open for read.</span></span>|<span data-ttu-id="e51b1-265">兩筆交易都成功。</span><span class="sxs-lookup"><span data-stu-id="e51b1-265">Both succeed.</span></span>|<span data-ttu-id="e51b1-266">兩筆交易都成功。</span><span class="sxs-lookup"><span data-stu-id="e51b1-266">Both succeed.</span></span>|  
|<span data-ttu-id="e51b1-267">開啟以便進行可重複讀取的 SELECT。</span><span class="sxs-lookup"><span data-stu-id="e51b1-267">Open for SELECT with repeatable read.</span></span>|<span data-ttu-id="e51b1-268">開啟以便寫入。</span><span class="sxs-lookup"><span data-stu-id="e51b1-268">Open for write.</span></span>|<span data-ttu-id="e51b1-269">交易 2 的開啟作業失敗，並傳回 ERROR_SHARING_VIOLATION 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="e51b1-269">The open operation on transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|<span data-ttu-id="e51b1-270">交易 2 的開啟作業失敗，並傳回 ERROR_SHARING_VIOLATION 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="e51b1-270">The open operation on transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|  
  
 <span data-ttu-id="e51b1-271">**從遠端用戶端寫出**</span><span class="sxs-lookup"><span data-stu-id="e51b1-271">**Write-Through from Remote Clients**</span></span>  
  
 <span data-ttu-id="e51b1-272">遠端檔案系統對 FILESTREAM 資料的存取，是透過伺服器訊息區塊 (SMB) 通訊協定來啟用。</span><span class="sxs-lookup"><span data-stu-id="e51b1-272">Remote file system access to FILESTREAM data is enabled over the Server Message Block (SMB) protocol.</span></span> <span data-ttu-id="e51b1-273">如果用戶端在遠端，則用戶端不會快取任何寫入作業。</span><span class="sxs-lookup"><span data-stu-id="e51b1-273">If the client is remote, no write operations are cached by the client side.</span></span> <span data-ttu-id="e51b1-274">寫入作業一定會傳送給伺服器，</span><span class="sxs-lookup"><span data-stu-id="e51b1-274">The write operations will always be sent to the server.</span></span> <span data-ttu-id="e51b1-275">資料可以在伺服器端快取。</span><span class="sxs-lookup"><span data-stu-id="e51b1-275">The data can be cached on the server side.</span></span> <span data-ttu-id="e51b1-276">我們建議您將在遠端用戶端上執行的應用程式合併小型寫入作業，以便使用較多的資料來減少寫入作業。</span><span class="sxs-lookup"><span data-stu-id="e51b1-276">We recommend that applications that are running on remote clients consolidate small write operations to make fewer write operations using larger data size.</span></span>  
  
 <span data-ttu-id="e51b1-277">使用 FILESTREAM 控制代碼來建立記憶體對應檢視 (記憶體對應 I/O) 不受到支援。</span><span class="sxs-lookup"><span data-stu-id="e51b1-277">Creating memory mapped views (memory mapped I/O) by using a FILESTREAM handle is not supported.</span></span> <span data-ttu-id="e51b1-278">如果將記憶體對應用於 FILESTREAM 資料， [!INCLUDE[ssDE](../../includes/ssde-md.md)] 將無法保證資料的一致性與持續性或是資料庫的完整性。</span><span class="sxs-lookup"><span data-stu-id="e51b1-278">If memory mapping is used for FILESTREAM data, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] cannot guarantee consistency and durability of the data or the integrity of the database.</span></span>  
  
##  <a name="related-tasks"></a><a name="reltasks"></a> <span data-ttu-id="e51b1-279">相關工作</span><span class="sxs-lookup"><span data-stu-id="e51b1-279">Related Tasks</span></span>  
 [<span data-ttu-id="e51b1-280">啟用及設定 FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="e51b1-280">Enable and Configure FILESTREAM</span></span>](enable-and-configure-filestream.md)  
  [<span data-ttu-id="e51b1-281">建立啟用 FILESTREAM 的資料庫</span><span class="sxs-lookup"><span data-stu-id="e51b1-281">Create a FILESTREAM-Enabled Database</span></span>](create-a-filestream-enabled-database.md)  
  [<span data-ttu-id="e51b1-282">建立儲存 FILESTREAM 資料的資料表</span><span class="sxs-lookup"><span data-stu-id="e51b1-282">Create a Table for Storing FILESTREAM Data</span></span>](create-a-table-for-storing-filestream-data.md)  
  [<span data-ttu-id="e51b1-283">使用 Transact-SQL 存取 FILESTREAM 資料</span><span class="sxs-lookup"><span data-stu-id="e51b1-283">Access FILESTREAM Data with Transact-SQL</span></span>](access-filestream-data-with-transact-sql.md)  
  [<span data-ttu-id="e51b1-284">建立 FILESTREAM 資料的用戶端應用程式</span><span class="sxs-lookup"><span data-stu-id="e51b1-284">Create Client Applications for FILESTREAM Data</span></span>](create-client-applications-for-filestream-data.md)  
  [<span data-ttu-id="e51b1-285">使用 OpenSqlFilestream 存取 FILESTREAM 資料</span><span class="sxs-lookup"><span data-stu-id="e51b1-285">Access FILESTREAM Data with OpenSqlFilestream</span></span>](access-filestream-data-with-opensqlfilestream.md)  
  [<span data-ttu-id="e51b1-286">對 FILESTREAM 資料進行部分更新</span><span class="sxs-lookup"><span data-stu-id="e51b1-286">Make Partial Updates to FILESTREAM Data</span></span>](make-partial-updates-to-filestream-data.md)  
  [<span data-ttu-id="e51b1-287">避免與 FILESTREAM 應用程式中的資料庫作業相衝突</span><span class="sxs-lookup"><span data-stu-id="e51b1-287">Avoid Conflicts with Database Operations in FILESTREAM Applications</span></span>](avoid-conflicts-with-database-operations-in-filestream-applications.md)  
  [<span data-ttu-id="e51b1-288">移動啟用 FILESTREAM 功能的資料庫</span><span class="sxs-lookup"><span data-stu-id="e51b1-288">Move a FILESTREAM-Enabled Database</span></span>](move-a-filestream-enabled-database.md)  
  [<span data-ttu-id="e51b1-289">設定容錯移轉叢集上的 FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="e51b1-289">Set Up FILESTREAM on a Failover Cluster</span></span>](set-up-filestream-on-a-failover-cluster.md)  
  [<span data-ttu-id="e51b1-290">為 FILESTREAM 存取設定防火牆</span><span class="sxs-lookup"><span data-stu-id="e51b1-290">Configure a Firewall for FILESTREAM Access</span></span>](configure-a-firewall-for-filestream-access.md)  
  
##  <a name="related-content"></a><a name="relcontent"></a> <span data-ttu-id="e51b1-291">相關內容</span><span class="sxs-lookup"><span data-stu-id="e51b1-291">Related Content</span></span>  
 [<span data-ttu-id="e51b1-292">FILESTREAM 與其他 SQL Server 功能的相容性</span><span class="sxs-lookup"><span data-stu-id="e51b1-292">FILESTREAM Compatibility with Other SQL Server Features</span></span>](filestream-compatibility-with-other-sql-server-features.md)  
  
